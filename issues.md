This file is a structured collection of GitHub issues and their respective comments, extracted from a public repository. It is designed to be easily consumable by AI systems for analysis, triage, research, or automated workflows.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a serialized snapshot of GitHub issues and their discussions.
It is intended to provide AI systems with structured, contextual input from real-world issue reports,
including bug reports, feature requests, and developer conversations.
</purpose>

<file_format>
The content is organized as follows:
- This summary section
- Multiple issue entries, each delimited by XML-style tags:
  <issue_{number}_{sanitized_title}>
    Issue body text (may be empty)
    >> Coment√°rio de {usuario}:
    Coment√°rio 1
    >> Coment√°rio de {usuario}:
    Coment√°rio 2
  </issue_{number}_{sanitized_title}>

Notes:
- Tags are uniquely formatted to support parsing with LLMs.
- The issue title is sanitized (newlines removed, special characters simplified).
- Comments are ordered as returned by the GitHub API.
</file_format>

<usage_guidelines>
- This file should be treated as read-only.
- Use the issue number and title tag to identify the topic.
- Use indentation or tag nesting to extract contextual chains of conversation.
- When parsing, treat everything between matching <issue_...> and </issue_...> as a single unit.
- If processing via LLMs, consider chunking by tag block.
</usage_guidelines>

<notes>
- Pull requests were excluded from this dataset.
- The file may contain incomplete or malformed issues if interrupted.
- The dataset respects GitHub rate limits and is collected progressively.
- No security filtering or redaction was performed ‚Äî handle with care.
</notes>
</file_summary>

<issue_1_Inception do projeto>
# Origem da necessidade
N√≥s produzimos uma [newsletter di√°ria](https://filipedeschamps.com.br/newsletter) que tem o objetivo principal de **economizar o tempo do leitor** ao sintetizar em um √∫nico par√°grafo uma not√≠cia (o que internamente apelidamos de *"sushi de not√≠cia"* porque √© uma *"unidade de comida para o c√©rebro"*, pequena e que tem in√≠cio, meio e fim) e por isso que a chamada principal √© "Not√≠cias de Tecnologia para quem n√£o tem tempo de ler not√≠cias".

Isto d√° muito trabalho, principalmente para o @gustavodeschamps (Guga, meu irm√£o), ainda mais considerado o filtro que usamos para selecionar as milhares de not√≠cias que s√£o geradas no mundo todos os dias. E apesar de que este modelo est√° funcionando muito bem, ainda temos **dificuldades** na entrega do material por email.

N√≥s adoramos o formato do email, porque voc√™ fica com uma "c√≥pia pessoal" do que foi enviado, mas ao mesmo tempo ficamos **extremamente frustrados** quando algum provedor de email arbitrariamente escolhe n√£o entregar este material para uma pessoa que passou por um **double opt-in** (se inscreveu **e** confirmou a inscri√ß√£o).

Dado a isso, surgiu a id√©ia de publicar esse material (e v√°rios outros que n√£o entram no filtro da newsletter) em um site chamado **TabNews**.

# Origem do nome
Quem deu a id√©ia do nome foi o @gustavodeschamps porque a usabilidade que gostar√≠amos no site √© o usu√°rio deixar ele aberto numa **Aba** (Tab) e automaticamente as **Not√≠cias** (News) v√£o entrando, por isso do nome TabNews.

# Mas a origem da necessidade √© fraca
Claro que √© importante endere√ßar o problema de entregabilidade dos emails, e o que eu vou falar agora parece besta, mas tem um ponto importante: **isso √© um problema apenas para quem tem esse problema**. O que eu quero dizer √© que um site n√£o deveria existir para resolver apenas isso... principalmente se considerarmos que Site e Email v√£o ser dois p√∫blicos diferentes e um Site **n√£o vai resolver** o problema de quem quer receber as informa√ß√µes por Email. Ent√£o fica a pergunta:

# Por qu√™ esse site existe?
Qual o real objetivo dele? Uma das coisas que o @gustavodeschamps especulou √© que, diferente da Newsletter onde ela cont√©m a s√≠ntese de not√≠cias para quem n√£o tem tempo de ler not√≠cias, o TabNews poderia ser justamente o contr√°rio, not√≠cias para quem tem tempo e quer se aprofundar nos assuntos, propor discuss√µes e fazer novas perguntas a respeito.

Mas as pessoas querem isso? Quem quer isso? Vai ter uma grande despropor√ß√£o entre quem vai produzir essas novas informa√ß√µes e quem vai consumir. Como ser recompensador para os dois lados? Por exemplo, no lado de quem produz ter a possibilidade de um **revenue share**? No lado de quem consome conseguir destacar as melhores informa√ß√µes.

E se for isso, como podemos sintetizar tudo o que eu escrevi nessa issue at√© agora em uma √∫nica frase, assim como fizemos na chamada principal da Newsletter? Na Newsletter se algu√©m me perguntar o que ela √©, fica f√°cil, √© economizar o tempo do leitor... e o site?

>> Coment√°rio de vitordevsp:
N√£o sei se √© interessante fazer esse coment√°rio aqui, mas eu estou muito animado com esse projeto e queria deixar isso registrado em algum lugar. Acabei de ler o Di√°rio e as issues e estou achando a ideia incr√≠vel, abrir o projeto dessa maneira para que n√≥s possamos fazer parte da cria√ß√£o e de todo o processo √© simplesmente sensacional, a maioria das pessoas pensam muito no dinheiro e esse projeto n√£o √© assim.

Eu tenho ideias de projetos que j√° comentei com outras pessoas, e o objetivo sempre foi fazer esses projetos de uma maneira open source, e as pessoas sempre criticam e algumas ate te acha tolo por querer criar um projeto e deixar o c√≥digo dele aberto pra qualquer um "roubar" a sua ideia, quando na verdade essa n√£o √© a ess√™ncia de um projeto open source, a ideia √© dar mais vida para o projeto e n√£o matar ele fazendo ele ser open source.

Ver esse projeto nascendo e participando dele de alguma forma, s√≥ fomenta mais a minha vontade de criar sim projetos open source, e n√£o s√≥ projetos mas a criar conte√∫do tamb√©m. Eu estou num processo de cria√ß√£o de conte√∫do mas sou muito perfeccionista, queria que os primeiros conte√∫dos j√° sa√≠ssem de maneira profissional e n√£o √© assim que funciona, e esse projeto esta me inspirando muito a ir pra cima.

Eu s√≥ queria sinalizar para o @filipedeschamps o qu√£o importante esse tipo de iniciativa √©, n√£o s√≥ pelo projeto em si, mas o principal √© a inspira√ß√£o que isso tr√°s para as pessoas. Filipe acho que voc√™ n√£o tem no√ß√£o do quanto voc√™ inspira as pessoas, pode ter certeza que √© muito muito mais do que voc√™ imagina.

E claro que eu n√£o poderia deixar de citar o @gustavodeschamps, tenho certeza que nada disso seria poss√≠vel sem o apoio do Gustavo, o trabalho de voc√™s √© incr√≠vel e inspirador e com certeza esta ajudando a transformar o nosso pais, nem que seja em um pequeno nicho comparado ao tamanho dele, mas isso gera um efeito cascata enorme.

Muito SHOW Turma, vamos fazer esse projeto ser cada vez mais especial.

>> Coment√°rio de marcios:
Ol√° pessoal, tudo certo?
Estive pensando em um recurso que talvez fa√ßa sentindo que √© no projeto al√©m das notifica√ß√µes por e-mail ter tambem "Web Push Notifications" algo como o "OneSignal" implemneta muito bem e de maneira simples este seria mais um recurso de delivery do tabnews que pode ajudar a aumentar o alcance.

>> Coment√°rio de filipedeschamps:
> as pessoas sempre criticam e algumas ate te acha tolo por querer criar um projeto e deixar o c√≥digo dele aberto pra qualquer um "roubar" a sua ideia

@vitordevsp  Entendo perfeitamente a rea√ß√£o das pessoas. No meu caso, eu **nunca me arrependi** de colocar um projeto open source, ele sempre ficou mais forte, conheci pessoas fant√°sticas como voc√™, e o saldo final sempre foi positivo. Eu penso que, se uma ideia √© t√£o f√°cil quanto roubar ela, ou roubar o c√≥digo, depois que voc√™ lan√ßar o seu projeto, em qualquer momento depois de ele pode ser clonado.

No mais, muito obrigado pela mensagem e dou apoio total para voc√™ fazer seus projetos open source (ou n√£o, fica na sua escolha), mas fa√ßa projetos, chame pessoas, voc√™ vai sair **sempre muito mais forte** dessa experi√™ncia ü§ù

>> Coment√°rio de filipedeschamps:
> al√©m das notifica√ß√µes por e-mail ter tambem "Web Push Notifications"

@marcios que massa meu caro, muito obrigado pela sugest√£o! Eu n√£o tinha nem pensado nisso e de fato algumas pessoas v√£o optar por isso e vai ser uma √≥tima adi√ß√£o. E isso j√° foi um exemplo claro de como open source e unir pessoas √≥timas, fortalece um produto ou servi√ßo ü§ù

>> Coment√°rio de danwhat:
Cara! Acabei consumir tudo que voc√™s postaram nas **issues** e no **repo** como um todo. Voc√™s s√£o sensacionais!

Vou tentar contribuir um pouquinho: talvez seja maluquice, mas a gente n√£o consegue reter tanto os usu√°rios da newsletter quanto os do site n√£o? Eu enxergo 2 tipos de usu√°rios: "usu√°rios que consomem" e "usu√°rios que consomem e contribuem"

N√£o sei o quanto eficiente seria, mas acredito que conseguimos criar um √∫nico site que atenda ambos.
1. Eu imagino o **layout default** o mais limpo poss√≠vel, pois a maior parte dos usu√°rios querem apenas entrar e consumir assim como fazem no email, e para estes, n√£o faz sentido outras features.
2. E em algum lugar no site poderia ter um bot√£o de **show/hide** para os usu√°rios que querem uma experi√™ncia "mais completa" e "tudo bem" ter um passo a mais para acessar esses recursos j√° que seriam usu√°rios que j√° est√£o dispostos a interagir e contribuir para o site.

Rabisquei no figma o que eu imagino. N√£o se prendam nos detalhes mas sim na ideia como um todo: https://www.figma.com/file/rovD0eecxO0264VseLCcMZ/Untitled?node-id=1%3A2

Coloquei essa ideia aqui, pois faz parte da estrutura do projeto e n√£o apenas uma feature.

<img src="https://i.imgur.com/yBMMOfz.png" width="640" height="360">
<img src="https://i.imgur.com/1zDa1Ap.png" width="640" height="360">

>> Coment√°rio de daniloster:
Oi @danwhat , muito bacana a ideia minimalista. Torna a experiencia muito agradavel. üéâ  Parabens pela proposta!

Gostaria de sugerir de mover o comentario para uma issue separada, se voc√™ concordar. Eu acabei criando uma label "design-proposal" que voc√™ pode associar ao novo issue. Assim, fica facil de localizar as propostas de design e n√£o misturamos conteudos de dominios diferentes. O que voc√™ acha disso?

Se voc√™ concordar, eh soh deletar este comentario daqui depois de criar a issue.

Obrigado pela contribuicao üòâ

>> Coment√°rio de danwhat:
Faz sentido @daniloster. Ainda estou pegando o jeito com o fluxo do github e n√£o percebi que o coment√°rio tinha peso para virar uma issue separada. Mas n√£o coloquei a label **design-proposal** para n√£o focarmos no design e sim na proposta de estrutura em 2 estapas.

Obrigado pelo toque!
</issue_1_Inception do projeto>

<issue_3_Extens√£o do tabnews para navegador>
Pessoal, sei que ainda √© cedo para pensar em algo do tipo, mas desde que o Filipe divulgou o projeto eu n√£o paro de pensar nessa ideia. J√° viram um site chamado [Dailly Dev](https://daily.dev/)? Ele basicamente agrega not√≠cias de diversas fontes e disponibiliza de uma forma acess√≠vel cada vez que o usu√°rio abre uma nova aba no navegador; isso na minha opini√£o √© fant√°stico! Que tal n√≥s trabalhar numa ideia semelhante a essa? üòÑ

>> Coment√°rio de wcarugatti:
Um detalhe que eu acrescentaria s√≥ √© que esse dailly dev tamb√©m √© open source https://github.com/dailydotdev/daily ent√£o da pra **se inspirar** bastante.

>> Coment√°rio de brunofamiliar:
> Um detalhe que eu acrescentaria s√≥ √© que esse dailly dev tamb√©m √© open source https://github.com/dailydotdev/daily ent√£o da pra **se inspirar** bastante.

Verdade! Ajuda muito üòÑ

>> Coment√°rio de filipedeschamps:
Que sensacional @brunofamiliar obrigado por abrir essa issue com essa ideia!

Uma das coisas que eu j√° tinha conversado com o @gustavodeschamps √© que o TabNews dever√° fornecer APIs para que **qualquer pessoa possa desenvolver o que quiser com as informa√ß√µes do site** ü§ù . Um exemplo que a gente pira seria fazer uma vers√£o do TabNews pelo terminal üòÇ  bom de qualquer forma, essa API vai ser usada tanto para fazer o site, quanto para qualquer outra solu√ß√£o como essa sua ideia üëç

>> Coment√°rio de Judahh:
> Que sensacional @brunofamiliar obrigado por abrir essa issue com essa ideia!
> 
> Uma das coisas que eu j√° tinha conversado com o @gustavodeschamps √© que o TabNews dever√° fornecer APIs para que **qualquer pessoa possa desenvolver o que quiser com as informa√ß√µes do site**  . Um exemplo que a gente pira seria fazer uma vers√£o do TabNews pelo terminal  bom de qualquer forma, essa API vai ser usada tanto para fazer o site, quanto para qualquer outra solu√ß√£o como essa sua ideia

Ent√£o n√£o seria interessante , reestruturar a arquitetura (separando o site da API, projetos/reposit√≥rios diferentes) para o site, e extens√µes utilizarem a API?

>> Coment√°rio de brunofamiliar:
> > Que sensacional @brunofamiliar obrigado por abrir essa issue com essa ideia!
> > Uma das coisas que eu j√° tinha conversado com o @gustavodeschamps √© que o TabNews dever√° fornecer APIs para que **qualquer pessoa possa desenvolver o que quiser com as informa√ß√µes do site**  . Um exemplo que a gente pira seria fazer uma vers√£o do TabNews pelo terminal  bom de qualquer forma, essa API vai ser usada tanto para fazer o site, quanto para qualquer outra solu√ß√£o como essa sua ideia
> 
> Ent√£o n√£o seria interessante , reestruturar a arquitetura (separando o site da API, projetos/reposit√≥rios diferentes) para o site, e extens√µes utilizarem a API?

kk que coincid√™ncia, fiz a mesma pergunta na sua Issue #4 üòÇüòÇ

>> Coment√°rio de daniloster:
Boa tarde!

Posso sugerir abordarmos o projeto sempre como MVP (minimum viable product)?

A gente sabe que a idea eh ter uma forma de consumo da informacao independente, como API. Para comecar podemos utilizar o modelo de API do next.

>> Coment√°rio de filipedeschamps:
√â *muuuuuito* bom ver esse reposit√≥rio com os coment√°rios de voc√™s üòç 

Sobre separar a interface da API, por hora estou pensando em ser o mais KISS poss√≠vel e, num mesmo reposit√≥rio entregar estes dois componentes com o Next.js porque vai ser muito mais r√°pido iterar e juntar a comunidade em um √∫nico lugar (aumentar a densidade ao inv√©s de diminuir, se voc√™ parar para pensar, √© um tradeoff que traz benef√≠cios importantes para o in√≠cio de um projeto).

Ent√£o sim, sugiro seguir com a vis√£o do @daniloster porque vai acelerar no come√ßo, e n√£o vai impactar muito (vai impactar o suficiente) quando precisar separar.

Agora, mais para frente, d√° para separar sim e fica bem simples de fazer. Da√≠ nesse ponto sugiro inclusive criar uma Org caso as pessoas queiram participar (porque fica a crit√©rio da pessoa trazer o projeto para a Org ou n√£o, dado que o uso da API vai ser livre para qualquer pessoa explorar individualmente)

>> Coment√°rio de jorge-lba:
Como estamos falando de API, queria deixar uma ideia mais para o futuro. 

Acho que seria interessante ter uma op√ß√£o de webhooks, possibilitaria fazer algumas integra√ß√µes interessante sem a necessidade de ficarmos fazendo solicita√ß√µes frequentes para atualizar as noticias. 

Coloquei esse ponto tamb√©m porque hoje estou trabalhando em alguns bots para discord/twitch e webhooks facilitam a integra√ß√£o para enviar msgs que n√£o precisam de comandos dentro dos chats.

>> Coment√°rio de filipedeschamps:
Total @jorge-lba excelente ideia!!! üëç

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù

>> Coment√°rio de Rafatcb:
Estou removendo a label `repescar` do issue e criando esse coment√°rio para termos um hist√≥rico do motivo dessa decis√£o.

Conforme o projeto andou, acabamos optando por utilizar este reposit√≥rio apenas para a API e para a "interface oficial" (o site https://www.tabnews.com.br/), permitindo que outras pessoas criem interfaces alternativas como aplicativos e extens√µes.
</issue_3_Extens√£o do tabnews para navegador>

<issue_4_Existe um padr√£o definido para contribui√ß√£o?>
Como vai funcionar o trabalho feito aqui?

- Vai existir um Kanban (podendo usar at√© o pr√≥prio Projects desse repo) com backlog e andamento das tarefas com um gitflow (e se for esse o caso, seria baseado em features ou CI)? 
- Ou ser√° totalmente descentralizado a ponto em que todas as novas funcionalidades vir√£o atrav√©s de pull requests vindo de forks?

>> Coment√°rio de brunofamiliar:
Seria interessante essas defini√ß√µes. Aproveitando a Issue, o projeto vai ser monorepo ou vai ser fragmentado em projetos diferentes backend / frontend?

>> Coment√°rio de wcarugatti:
> * Ou ser√° totalmente descentralizado a ponto em que todas as novas funcionalidades vir√£o atrav√©s de pull requests vindo de forks?

Eu imagino que siga nessa linha, j√° que n√£o tem porque ter um fluxo diferente do qual ele disse que vai implementar quando ele deixar a api publica e tirar o acesso de todos n√≥s.

Mas ainda assim fica o questionamento de como sabemos o que precisa fazer? Onde teria um back-log com instru√ß√µes ou discuss√£o das novas features OU user stories? 

O modelo de user stories √© muito bom.

>> Coment√°rio de filipedeschamps:
@Judahh excelentes peruntas!

1. Vai sim, e pretendo de fato usar o Projects aqui por dentro do reposit√≥rio üëç  mas n√£o pretendo usar Gitflow, sugiro fazermos "short lived branches" e fazer o merge na master o mais r√°pido poss√≠vel. S√≥ tem um fator que talvez me faz aproximar de um Gitflow, que √© a incapacidade do Github rodar Actions de PR vindos de Forks (pelo menos no passado). Da√≠ seria interessante ter uma branch Development para fazer o merge contra ela e rodar as Actions. Mas novamente, de in√≠cio, sugiro sermos o mais simples poss√≠vel ü§ù 
2. Por enquanto que todos tem acesso de escrita, sugiro evitar o Fork, vai ficar mais f√°cil para voc√™s e a ```main``` est√° protegida. E mais para frente como antecipado pelo @wcarugatti sugiro transformarmos o fluxo para Fork-based, como √© mais comum em projetos p√∫blicos open source.

>> Coment√°rio de filipedeschamps:
@brunofamiliar respondi numa outra issue, mas vou replicar aqui: sugiro por enquanto ser o mais KISS poss√≠vel e manter tudo nesse reposit√≥rio üëç mais para frente, se sentirmos a necessidade e os tradeoffs se pagarem, a gente pode criar uma Org e separar as camadas/projetos ü§ù

>> Coment√°rio de filipedeschamps:
@wcarugatti e respondendo diretamente sua d√∫vida, mais para frente na semana (depois que eu conseguir gravar e editar o pr√≥ximo v√≠deo do canal) eu quero fazer uma organiza√ß√£o no Projects aqui do Github mesmo üëç

>> Coment√°rio de thenriquedb:
Um padr√£o que venho utilizando em meus projetos √© o [Conventional Commits
](https://www.conventionalcommits.org/en/v1.0.0/) que auxila bastante na cria√ß√£o de um bom hist√≥rico de commits. 

Uma outra recomenda√ß√£o interessante seria utilizar o [husky](https://github.com/typicode/husky) e o [lint-staged](https://github.com/okonet/lint-staged) para garantir que nenhum commit errado v√° para o reposit√≥rio. O Diego da Rocketseat postou um [v√≠deo](https://www.youtube.com/watch?v=-c57D2kQffQ) h√° algum tempo atr√°s detalhando melhor o funcionamento e configura√ß√£o destas ferramentas.

>> Coment√°rio de filipedeschamps:
@thenriquedb depois de fazer o merge [desse PR](https://github.com/filipedeschamps/tabnews.com.br/pull/34), topa implementar isso no projeto?

>> Coment√°rio de thenriquedb:
@filipedeschamps opa com certeza!

>> Coment√°rio de rodrigoKulb:
Essa issues pode ser finalizada? Conforme mencionado pelo @CarlosZiegler #42 outros assuntos sendo abordados tamb√©m em #63
Sim üëçÔ∏è
N√£o üëéÔ∏è

>> Coment√°rio de rodrigoKulb:
Finalizando a issue confirme vota√ß√£o 4 a 0.
</issue_4_Existe um padr√£o definido para contribui√ß√£o?>

<issue_6_Proposta de design>
Elaborei uma proposta para design e junto com ela diversas fun√ß√µes interessantes

**Link da proposta:** [https://www.figma.com/file/YbgVm2pLpCxhb5XcFIM7hI/TabNews](https://www.figma.com/file/YbgVm2pLpCxhb5XcFIM7hI/TabNews)

Existem coment√°rios no arquivo, por√©m n√£o tenho ci√™ncia que ser√° poss√≠vel o p√∫blico ver, ent√£o farei os mesmos aqui

## Propostas

- Home com as publica√ß√µes em destaque. Usu√°rio experi√™ntes podem adicionar imagens.
- Card de not√≠cia possuir√£o uma borda lateral indicando o qu√£o em destaque est√° o assunto sendo uma varia√ß√£o de um tom de cor
- An√∫ncios ter√£o design padronizado para f√°cil cria√ß√£o
- Ser√° poss√≠vel criar uma playlist para um player que faz text to speech
- Ao logar usu√°rio poder√° conferir uma barra lateral com suas moedas e atividades que geram pontua√ß√£o

![Home (1)](https://user-images.githubusercontent.com/10868900/120227036-ce3f6280-c21e-11eb-9090-3d5fc01dceaa.png)

>> Coment√°rio de filipedeschamps:
√â MUITO MASSAAAA ter voc√™s aqui dentro do reposit√≥rio üòç 

E gostei da quest√£o da cor do "qu√£o quente √© a not√≠cia" ser um degrad√™  üëç a id√©ia so text to speech tamb√©m muito boa, e sobre a atividade que est√° gerando moeda, eu n√£o tinha pensado nisso, muito interessante, me deixou pensando bastante ü§ù

>> Coment√°rio de LuanEdCosta:
Genial a ideia do text to speech e o layout ficou excelente. Os an√∫ncios com layout padr√£o e um abaixo do outro ao lado dos posts ficou muito massa tamb√©m.

**üí° Agora para contribuir eu pensei o seguinte:**
- Os usu√°rios podem adicionar tags de busca nas not√≠cias e elas aparecer√£o nos itens da tela principal
- Os usu√°rios podem buscar not√≠cias por tags
- Apenas usu√°rios experientes poder√£o adicionar imagem de perfil. Para os n√£o experientes podemos usar as iniciais do nome ou deixar ele escolher uma imagem entre algumas imagens padr√£o
- As imagens dos an√∫ncios tamb√©m s√£o coisas a se pensar. D√° pra usar o logo do canal do Youtube, avatar da conta do GitHub e at√© uma imagem qualquer que o usu√°rio fizer upload (s√≥ experientes)
- A API do Unsplash pode fornecer imagens que n√£o precisam de atribui√ß√µes ao fot√≥grafo e com menos risco de terem conte√∫do impr√≥prio

ü§î Eu estava vendo aqui e me parece que o Text to Speech √© algo n√£o t√£o complicado de fazer, vejam:
https://dev.to/asaoluelijah/text-to-speech-in-3-lines-of-javascript-b8h
https://developer.mozilla.org/pt-BR/docs/Web/API/SpeechSynthesis

>> Coment√°rio de brunofamiliar:
> Genial a ideia do text to speech e o layout ficou excelente. Os an√∫ncios com layout padr√£o e um abaixo do outro ao lado dos posts ficou muito massa tamb√©m.
> 
> **üí° Agora para contribuir eu pensei o seguinte:**
> 
> * Os usu√°rios podem adicionar tags de busca nas not√≠cias e elas aparecer√£o nos itens da tela principal
> * Os usu√°rios podem buscar not√≠cias por tags
> * Apenas usu√°rios experientes poder√£o adicionar imagem de perfil. Para os n√£o experientes podemos usar as iniciais do nome ou deixar ele escolher uma imagem entre algumas imagens padr√£o
> * As imagens dos an√∫ncios tamb√©m s√£o coisas a se pensar. D√° pra usar o logo do canal do Youtube, avatar da conta do GitHub e at√© uma imagem qualquer que o usu√°rio fizer upload (s√≥ experientes)
> * A API do Unsplash pode fornecer imagens que n√£o precisam de atribui√ß√µes ao fot√≥grafo e com menos risco de terem conte√∫do impr√≥prio
> 
> ü§î Eu estava vendo aqui e me parece que o Text to Speech √© algo n√£o t√£o complicado de fazer, vejam:
> https://dev.to/asaoluelijah/text-to-speech-in-3-lines-of-javascript-b8h
> https://developer.mozilla.org/pt-BR/docs/Web/API/SpeechSynthesis

Curti tamb√©m essa ideia do Text to Speech, parece ser algo interessante de se implementar para ir ouvindo estilo podcast

>> Coment√°rio de luantoningalvan:
Pensando no v√≠deo publicado hoje fiz uma adi√ß√£o de um modal para a personaliza√ß√£o do site podendo alterar tema, cor e home page. √â importante destacar que por mais que o design apresente uma home o foco principal est√° no LAYOUT, aquele que permanece igual em todas as p√°ginas

>> Coment√°rio de daniloster:
Oi @luantoningalvan  , muito bacana a sugest√£o de player. Muita gente pode se beneficiar dessa feature. Estava pensando no sentido de accessibilidade, o que acha de adicionarmos um bot√£o-icone play / pause na noticia tbm? Isso tornaria o player acess√≠vel pelo teclado. Alguns usuarios podem ser impossibilitados de usar o mouse, isso ajudaria muito eles.

(ps: desculpa a falta de acentuacao, meu teclado n√£o estah configurado, soh o corretor ajuda em alguns casos)

>> Coment√°rio de brunofamiliar:
Pessoal, tenho notado o surgimento de diversas propostas de layout; estou achando tudo muito fant√°stico! Parab√©ns a todos pelo trabalho que tiveram em transformar suas inspira√ß√µes em interfaces belas e intuitivas para o bem da comunidade üòÑ.
Como sugest√£o, o usu√°rio poderia escolher qual interface ele deseja utilizar (conforme o @filipedeschamps comentou no √∫ltimo v√≠deo), num seria interessante adicionar um ponto comum de f√°cil acesso para realizar a escolha do template? Tipo um bot√£o flutuante, igual demonstro nas imagens abaixo:

<img src="https://user-images.githubusercontent.com/32016729/120892005-4670a400-c5e2-11eb-83d9-c5134ffd4c6e.png" height="300"/>

Ao clicar na engregagem, abre as op√ß√µes para configurar aquele tema em espec√≠fico, ou mesmo selecionar outro que desejar, de forma simplificada.

<img src="https://user-images.githubusercontent.com/32016729/120892011-55575680-c5e2-11eb-9426-ff480228f60e.png" height="500"/>

>> Coment√°rio de filipedeschamps:
Massa @brunofamiliar ! Eu tava pensando sobre a mesma coisa, e talvez eu centralizaria tudo dentro do *Perfil* da pessoa, que poderia ficar no canto superior direito (como fica geralmente, aquela bolinha com um avatar, sabe?)

>> Coment√°rio de brunofamiliar:
> Massa @brunofamiliar ! Eu tava pensando sobre a mesma coisa, e talvez eu centralizaria tudo dentro do *Perfil* da pessoa, que poderia ficar no canto superior direito (como fica geralmente, aquela bolinha com um avatar, sabe?)

Realmente faz mas sentido, porque se tiver essa engrenagem flutuante pode quebrar outros designs que tenham conte√∫do na lateral. Sendo no perfil, teria maior flexibilidade em estruturar a UI

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù

>> Coment√°rio de Rafatcb:
Estou removendo a label `repescar` do issue e criando esse coment√°rio para termos um hist√≥rico do motivo dessa decis√£o.

Na fase em que estamos do TabNews, j√° n√£o faz sentido um "redesign total", primeiro porque seria um grande esfor√ßo direcionado para algo est√©tico, enquanto que temos v√°rias coisas legais a serem implementadas (veja o Milestone 7 que estamos agora https://github.com/filipedeschamps/tabnews.com.br/issues/1490); e segundo que a est√©tica √© algo bem pessoal e com certeza teremos pessoas que ir√£o preferir a nova e pessoas que preferir√£o a antiga, ent√£o haveria uma divis√£o do p√∫blico.

Acredito que a interface que temos hoje tem servido bem o p√∫blico do TabNews, e fazemos melhorias incrementais nela conforme necessitamos.
</issue_6_Proposta de design>

<issue_8_Proposta de estrutura para 2 tipos de clientes.>
Cara! Acabei consumir tudo que voc√™s postaram nas **issues** e no **repo** como um todo. Voc√™s s√£o sensacionais!

Vou tentar contribuir um pouquinho: talvez seja maluquice, mas a gente n√£o consegue reter tanto os usu√°rios da newsletter quanto os do site n√£o? Eu enxergo 2 tipos de usu√°rios: "usu√°rios que consomem" e "usu√°rios que consomem e contribuem"

N√£o sei o quanto eficiente seria, mas acredito que conseguimos criar um √∫nico site que atenda ambos.
1. Eu imagino o **layout default** o mais limpo poss√≠vel, pois a maior parte dos usu√°rios querem apenas entrar e consumir assim como fazem no email, e para estes, n√£o faz sentido outras features.
2. E em algum lugar no site poderia ter um bot√£o de **show/hide** para os usu√°rios que querem uma experi√™ncia "mais completa" e "tudo bem" ter um passo a mais para acessar esses recursos j√° que seriam usu√°rios que j√° est√£o dispostos a interagir e contribuir para o site.

Rabisquei no figma o que eu imagino. N√£o se prendam nos detalhes mas sim na ideia como um todo: https://www.figma.com/file/rovD0eecxO0264VseLCcMZ/Untitled?node-id=1%3A2

Coloquei essa ideia aqui, pois faz parte da estrutura do projeto e n√£o apenas uma feature.

<img src="https://i.imgur.com/yBMMOfz.png" width="640" height="360">
<img src="https://i.imgur.com/1zDa1Ap.png" width="640" height="360">

_Originally posted by @danwhat in https://github.com/filipedeschamps/tabnews.com.br/issues/1#issuecomment-855058308_

>> Coment√°rio de danwhat:
Criei uma issue separada como o @daniloster sugeriu, mas n√£o adicionei a label **design-proposal** pois o foco aqui n√£o √© o design em si, mas sim a proposta de estrutura em duas etapas. O importante √© debatermos se existe uma forma eficiente de retermos 2 p√∫blicos diferentes.

>> Coment√°rio de dhanielsales:
Muito bom cara! 

Acho uma vis√£o muito correta de "2 tipos de usu√°rios: 'usu√°rios que consomem' e 'usu√°rios que consomem e contribuem'", n√£o sei se inicialmente faz muito sentido separarmos os layouts, mas √© com certeza uma ideia muito boa e bem pertinente.

Complementando ao seu pensamento de dois tipos de usu√°rios, acredito que inclusive j√° de in√≠cio devemos conseguir medir quais s√£o os "tipos" de cada um dos usu√°rios, com intuito de fazer uma "gamifica√ß√£o" das intera√ß√µes, curtidas, etc e sabermos a dire√ß√£o de quais features devem ser feitas primeiros do que outras.

Parab√©ns, √≥tima Issue! üòÑ

>> Coment√°rio de filipedeschamps:
Sensacional @danwhat obrigado pela contribui√ß√£o üòç 

Concordo 100% que vai existir dois p√∫blicos, o que produz e o que consome, sendo que o que consome vai ser muito maior do que o que produz, naturalmente üëç 

Uma abordagem que eu gosto √© do Google, voc√™ entra no buscador ele √© simples para todo mundo, mas serve para usu√°rios iniciantes e avan√ßados. Usu√°rios iniciantes v√£o s√≥ buscar termos, onde avan√ßados v√£o usar como conversor, consultar pre√ßo de a√ß√µes, calculadora, etc. Acho que isso n√£o se aplica na sua proposta de layout, mas o princ√≠pio por tr√°s √© que n√£o h√° um switch no Google para esses recursos.

N√£o sei onde li, mas me marcou, que √©: num layout, as coisas simples devem ser simples, e as avan√ßadas devem ser poss√≠veis. N√£o era exatamente isso, mas era por a√≠ üòÇ 

Agora, s√≥ um ponto que eu vejo de outra forma no seu argumento √© que, na minha vis√£o, as pessoas querem saber o qu√£o popular uma not√≠cia √© (seja pela quantidade de coment√°rios, ou tabcoins) üëç  e at√© relativamente uma not√≠cia a outra... ou estou errado? De qualquer forma, entendo a beleza de ler algo mais limpo ü§ù  eu meio tava que tentando fazer [nessa vers√£o do layout, mas sem sucesso üòÇ ](https://tabnews.vercel.app/home-02)

>> Coment√°rio de danwhat:
@dhanielsales Acho a ideia de gamifica√ß√£o muito boa para os usu√°rios avan√ßados. Mais para frente podemos ter uma thread s√≥ para ela. J√° para usu√°rios casuais n√£o deve fazer muita diferen√ßa j√° que a maioria nem logado estar√°.

---

@filipedeschamps ent√£o... o meu foco era a divis√£o entre os dois layouts e n√£o o que eu coloquei em cada no exemplo. Quais features estar√£o presentes em cada layout pode ser discutido futuramente.

Dificilmente a gente acertar√° de primeira o que cara tipo de usu√°rio usar√°. Vai ter muito ajuste antes.

Agora a parte do *bot√£o switch* eu super concordo. √â feio e eu tamb√©m nunca vi sendo usado em algum site grande, mas n√£o consegui pensar em nada e por isso coloquei ele ali.

S√≥ que agora que voc√™ citou o google, eu fui parar para refletir. O pr√≥prio google usar, s√≥ que de forma mais suave. O "Mais..." ou "Ferramentas" que ao clicar aparece mais op√ß√µes √© um *bot√£o switch*. A gente s√≥ n√£o precisa fazer de forma t√£o descarada como eu coloquei. ü§£

>> Coment√°rio de danwhat:
Gente, eu me expressei mal. Todos que interagiram na thread falaram sobre o **designer** e essa n√£o foi minha ideia inicial. N√£o deveria ter detalhado tando as imagens de exemplo. ü§ê

>> Coment√°rio de filipedeschamps:
@danwhat showww, entendi seu ponto ü§ù e √© √≥timo discutir essas coisas, pois lendo sua resposta me veio em mente aqueles tipos de recursos que n√£o s√£o mostrados na tela, mas quando voc√™ passa o mouse em cima eles aparecem, sabe? √â um misto do que discutimos at√© agora üëç

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù

>> Coment√°rio de Rafatcb:
Estou removendo a label `repescar` do issue e criando esse coment√°rio para termos um hist√≥rico do motivo dessa decis√£o.

Na fase em que estamos do TabNews, j√° n√£o faz sentido um "redesign total", primeiro porque seria um grande esfor√ßo direcionado para algo est√©tico, enquanto que temos v√°rias coisas legais a serem implementadas (veja o Milestone 7 que estamos agora https://github.com/filipedeschamps/tabnews.com.br/issues/1490); e segundo que a est√©tica √© algo bem pessoal e com certeza teremos pessoas que ir√£o preferir a nova e pessoas que preferir√£o a antiga, ent√£o haveria uma divis√£o do p√∫blico.

Acredito que a interface que temos hoje tem servido bem o p√∫blico do TabNews, e fazemos melhorias incrementais nela conforme necessitamos. Inclusive, tivemos alguns esfor√ßos para melhorar o site no modo de Leitura que os navegadores possuem, e que funciona melhor no Edge, se n√£o me engano.
</issue_8_Proposta de estrutura para 2 tipos de clientes.>

<issue_11_Sistema de TabCoins>
Sim, eu sei que esta um pouco cedo para pensarmos na implementa√ß√£o. Mas nada impede a gente de debater como o sistema ser√°.

Pensando aqui eu cheguei a um sistema que julgo legal. O meu foco foi:
- Deixar o mais simples poss√≠vel. Se voc√™ n√£o conseguir explicar para seu pet n√£o vale.
- Resolve o problema de como as TabCoins s√£o geradas.
- Incentiva a intera√ß√£o ao mesmo tempo que impede o flood

Lembrando que o importante √© seu funcionamento. Por isso coloquei as vari√°veis em colchetes.  Sintam-se livres para ler com os n√∫meros que julgarem mais justos.

## TabCoins (TC) √© TabCoin Bonus (TCB)

A TabCoin ser√° usada para sinalizar valor. Quando voc√™ "curte" uma not√≠cia ou coment√°rio, voc√™ estar√° sinalizando para a comunidade que esse conte√∫do tem valor.

TabCoins:

-  Cada "curtida" gastar√° [1] TC (ou TCB, se tiver), e adicionar√° [1] TC ao saldo de que gerou o conte√∫do.

- Sem TC voc√™ n√£o poder√° curtir

TabCoins Bonus:

- A cada [30 min] voc√™ ganhar√° [1] TCB.

- O m√°ximo de TCB acumuladas ser√£o [3] e seu saldo aparecer√° junto do saldo de TC.
Ex.: Total de TabCoins: 357+3

- Ao curtir algum conte√∫do, as TCB ser√£o usadas antes das TC. Com isso incentiva quem √© "p√£o duro" a sinalizar valor enquanto impede quem quiser **flodar** curtidas, j√° que ap√≥s as TCB, voc√™ gastar√° suas TC para curtir.

- Ao ser usada, a TCB passa para o gerador de conte√∫do como uma TC "comum". 

- Daqui que vem todas as TC do sistema. 

---

Gostei desse sistema pois o montante de TabCoins no sistema cresce conforme a comunidade cresce. Ent√£o se algu√©m tiver muito a mais que a m√©dia voc√™ sabe que essa pessoa acrescentou MUUUUITO valor a comunidade.

Pronto. O que acharam? Eu sei que tem falhas, mas como estou encantado n√£o consigo ver. Ent√£o podem ir! Vai! Quebrem meu encanto! ü§£

>> Coment√°rio de wcarugatti:
Achei a ideia genial, resolve bem os dois problemas.

O grande "por√©m" √© que isso pode gerar infla√ß√£o de tabcoins dependendo de como vai funcionar o sistema de ads que de acordo com o Deschamps ser√£o comprados com tabcoins.

Vale muito a pena ver como funciona o leil√£o do google ads pra se inspirar.

>> Coment√°rio de danwhat:
Eu imaginei um pre√ßo din√¢mico para as features escassas.

O pre√ßo de features como criar noticias, destaques etc se adaptaria conforme a demanda.
Ai cairia naquele loop:
- O Conte√∫do foi relevante? Ent√£o ele se pagar√°, j√° que as pessoas "devolveriam" o valor em TC investido atrav√©s das "curtidas".
- O Conte√∫do foi raso? Ent√£o ele n√£o se pagar√° e o criador ter√° que gerar mais valor e juntar mais TC para tentar uma pr√≥xima vez.

J√° os ads apenas tiraria TC do sistema e o sistema.
Eu dei uma pesquisada sobre o leil√£o do google ads e achei √≥tima a ideia.

S√≥ me preocupo do sistema ficar justo para novos usu√°rios. As coisas n√£o podem ser caras ao pontos dos primeros gerarem tantos TC que impe√ßam nossos usu√°rios de juntarem TC para criar noticias e tamb√©m entrarem no jogo. Talvez um pre√ßo fixo na cria√ß√£o de post? N√£o sei.

>> Coment√°rio de dhanielsales:
> Achei a ideia genial, resolve bem os dois problemas.
> 
> O grande "por√©m" √© que isso pode gerar infla√ß√£o de tabcoins dependendo de como vai funcionar o sistema de ads que de acordo com o Deschamps ser√£o comprados com tabcoins.
> 
> Vale muito a pena ver como funciona o leil√£o do google ads pra se inspirar.

Os an√∫ncios n√£o seriam "comprados" com experi√™ncia?  Essa parte eu ainda estou assimilando :sweat_smile:

>> Coment√°rio de danwhat:
Pelo o que eu entendi nada foi definido ainda. Est√° tudo no campo das ideias e "comprar an√∫ncios com experi√™ncia" √© apenas mais uma dessas ideias. Outra ideia foi "liberar novas features tamb√©m com experi√™ncia", por exemplo.

Coloquei essa proposta de tentarmos fazer tudo com apenas uma moeda, pois, a meu ver, seria um sistema mais simples e eficaz. Mas √© claro que nem sempre mais simples √© melhor. Se essa simplicidade atrapalhar a usabilidade teremos que ter mais de um recurso mesmo. Estamos aqui para debater isso.

>> Coment√°rio de dhanielsales:
Entendo e concordo contigo sobre se tornar mais simples e eficaz, mas gera aquele problema que pra mim tem um peso grande, que √© o fato de que se eu compro an√∫ncios com TabCoins, eu vou quere manter elas para essa finalidade, j√° que vai ser o fim da jornada. Al√©m disso, se eu centralizo em uma s√≥ moeda, com essa inje√ß√£o sazonal da moeda, gera uma infla√ß√£o que prejudica a 
estabilidade da precifica√ß√£o dos an√∫ncios, porque com uma crescente de usu√°rios, seria exponencial a crescente de moeda em circula√ß√£o, trazendo a necessidade inflacionar os pre√ßos gerais. Talvez inclusive tenha que aumentar os pre√ßos das a√ß√µes simples, como curtir e tal. Eu n√£o sou nenhum entendedor aprofundado nisso, mas me parece arriscado.

Fora esses poss√≠veis problemas, vejo uma ideia muito promissora essa gera√ß√£o b√¥nus de Tabcoins. Talvez se dermos um jeito de controlar a quantidade de moeda em circula√ß√£o, ou separar em outras "moedas", seja um √≥timo agregador como incentivo a intera√ß√£o.

>> Coment√°rio de danwhat:
A ideia da TCB foi justamente para controlar essa inje√ß√£o desenfreada de TC no sistema.
Pensa comigo:
- Se algu√©m cria uma conta e recebe as 3 TCB mas n√£o usa para nada, essa pessoa  continuar√° eternamente com as 3 TCB. Ou seja: O montante de TC no sistema n√£o aumentar√°.
- Agora, se ao inv√©s disso ela gasta as 3 TCB sinalizando valor e interagindo na comunidade, ela recebe mais TCB para continuar interagindo. Ou seja: O montante de TC no sistema n√£o aumentar√° gradualmente.

O que eu acho valido como ajuste fino √© o tempo que as TCB ser√£o entregues. No post inicial eu coloquei que elas voltariam a cada 30min. Talvez fosse melhor um tempo mais logo como algumas horas ou at√© mesmo um dia. No final de cada dia as TCB de todos voltariam a 3 unidades. √â uma ideia.

Uma outra forma de controlar a inje√ß√£o de TC no sistema poderia ser a necessidade de alguma autentica√ß√£o nas contas. Eu li um dia desses sobre um sistema de autentica√ß√£o por pix: Voc√™ envia um pix de 1 centavo para o sistema e com isso ele confirma que "voc√™ √© voc√™". Se s√≥ contas autenticadas pudessem receber TCB, a injec√£o de TC seria mais controlada e impediria contas fakes criadas s√≥ para gerar TC.

---

Essa √© minha forma de ver o problema e de como eu enxergo que a comunidade se comportaria.
Mas eu to ciente que tem uma grande chance de meus c√°lculos estarem errados ü§£.
Ningu√©m consegue definir com exatid√£o o comportamento de um grupo de pessoas.

>> Coment√°rio de dhanielsales:
Opa, ol√° novamente Dan.

Ent√£o, eu entendo tua proposta e inclusive n√£o inviabilizo ela n√£o, mas acho importante avaliar os riscos que as moedas b√¥nus trariam, pq ao meu ver ainda iriam inflacionar a moeda geral, porque ela ao serem usadas elas ser√£o convertidas em moeda corrente normal, fazendo com que os usu√°rios como um todo no sistema, possuam mais "poder de compra".

Se houver mais poder de comprar, h√° uma necessidade de regulagem dos pre√ßos saca? Porque se h√° essa inje√ß√£o de moeda sem crescentes de pre√ßo, no futuro uma grande quantidade de tabcoins ser√° comum entre usu√°rios, fazendo com que curtir ou interagir gastando moedas, seja com custo irrelevante. 

Bom, n√£o sou especialista, mas √© isso que me vem na cabe√ßa. De qualquer forma estou disposto a fazer alguns testes com vc e ouvir mais da sua opini√£o e da galera toda na elabora√ß√£o do projeto. üòÅ

>> Coment√°rio de danwhat:
Eita. Estava com o pensamento "viciado" e demorei para absorver a sua mensagem. Agora lendo com mais calma entendi sua preocupa√ß√£o.

Realmente, dessa forma √© inevit√°vel o aumento de TC no sistema e a infla√ß√£o da moeda. Mas ser√° que existe uma maneira de se evitar isso? Qualquer sistema que gere TC atrav√©s de X atividade pode ser explorado. Eu pelo menos n√£o consigo imaginar.

E, assim como no mundo real, alguma infla√ß√£o √© saud√°vel para a economia do sistema, ela s√≥ n√£o pode ser descontrolada. S√≥ n√£o podemos nos esquecer da facilidade de acesso as features para novos usu√°rios.

Quem sabe se todos os pre√ßos fossem din√¢micos? Podemos nos inspirar at√© nos joguinho IDLE's.
Assim uma pessoa "rica de TC" em um sistema que gere 1TC por a√ß√£o/tempo teria que continuar gerando valor pois depois de X meses essa taxa seria de 3TC e ai por diante. (e claro, o pre√ßo da cria√ß√£o de noticias, curtidas etc acompanharia essa crescente).
Com isso:
- Novos usu√°rios sempre teriam acesso as features basicas.
- Usu√°rios influentes precisariam sempre estar agregando valor a comunidade para se manterem influentes. Caso contrario, mesmo com uma quantidade grande de TC guardada, o tempo faria essa influencia diminuir.

--- 

No mais, at√© agora s√≥ debatemos sobre uma forma de gerar TC. Deve existir N formas melhores. Basta esperar o pessoal interagir.
At√© porque estou sentindo que a gente vai come√ßar a entrar em loop. Precisamos de mais material para interagir e debater.

**PS.:** Obrigado pelo papo @dhanielsales! Esta sendo demais interagir com voc√™ e pensar em todos os pontos que voc√™ esta apontando. Puta exerc√≠cio mental! üòÅ

>> Coment√°rio de filipedeschamps:
Galera, QUE **INSANO DE BOM DEMAIS** ter voc√™s aqui participando, s√©rio, eu to emocionado aqui, falei com a Renata e @gustavodeschamps muito muito muito massa mesmo!!!

Ent√£o, eu e o @gustavodeschamps fizemos uma call insana sobre como tentar resolver **tudo** somente usando TabCoins, e infelizmente para o ecossistema parar em p√©, √© preciso de duas m√©tricas por conta de **incentivos invertidos**. O @dhanielsales matou a charada: se voc√™ usar um valor compartilhado entre **qualificar** posts e **comprar an√∫ncios** que √© o endgame, as pessoas v√£o guardar para o endgame.

E independente do nome ```TabCoins``` ser parecido ```TabCoin Bonus``` para parecer que √© a mesma m√©trica e resolver com uma *"√∫nica coisa"*, n√£o √©. S√£o duas coisas separadas, e foi isso que eu e o @gustavodeschamps ficamos batendo a cabe√ßa no call. Na nossa tentativa de resolver tudo com a mesma coisa, a gente tentou metrificar as TabCoins que a pessoa tem, e as TabCoins que a pessoa j√° investiu em outros posts. E usar essas TabCoins investidas como m√©trica para ter maior participa√ß√£o nos an√∫ncios, ent√£o incentivaria a pessoa a gastar as TabCoins, para somar e aumentar o n√∫mero de TabCoins investidas... mas novamente, s√£o m√©tricas diferentes e a gente acabou concluindo que seria melhor separar em dois nomes diferentes, pois elas tem objetivos diferentes.

üî• E pra corrigir uma d√∫vida do @wcarugatti , os an√∫ncios n√£o ser√£o comprados com TabCoins, e para clarear outra d√∫vida do @dhanielsales tamb√©m n√£o ser√£o comprados com XP üëç 

Pensa comigo: √© um trabalho a mais para quem cria conte√∫do ter que tamb√©m ficar comprando an√∫ncio e gerenciando isso, correto? Ent√£o a id√©ia n√£o √© ter a **compra** e sim ter a **participa√ß√£o** nos espa√ßos... e esta participa√ß√£o (a probabilidade de aparecer um an√∫ncio seu) √© calculada pela sua quantidade de experi√™ncia (XP) no site. Voc√™ cadastra uma √∫nica vez qual ou quais an√∫ncios voc√™ possui, e quanto maior seu XP, maior a probabilidade deles aparecerem no site. Ent√£o basicamente o fluxo de contribui√ß√£o √© criar conte√∫dos com valor concreto para receber TabCoins (seja por not√≠cias/posts), e qualificar outros conte√∫dos. E com isso seu XP vai aumentando, o que vai resultar em uma maior participa√ß√£o no *share* dos an√∫ncios e tamb√©m vai habilitando novas features.

# Mas essa estrat√©gia ainda tem um furo/abuso üòÇ 
Quero ver se voc√™s adivinham qual √© e o que fazer a respeito considerando que: de in√≠cio, voc√™ pode doar quantas TabCoins quiser para um mesmo post. Como abusar?

>> Coment√°rio de dhanielsales:
@filipedeschamps 
Criar um post pr√≥prio e ficar se "auto" curtindo?  kkkkkkkk isso que me veio a mente de imediato, vc tem moedas infinitas assim e vc pode ganhar pontos infinitos. mas √© "facilmente" resolvivel.

>> Coment√°rio de filipedeschamps:
@dhanielsales show, ent√£o supondo que um usu√°rio n√£o pode se auto curtir. O que voc√™ exploraria, como e porque?

>> Coment√°rio de wcarugatti:
@filipedeschamps eu posso combinar com um amigo ou amigos (mais conhecido como proxy/bot) pra um dar muita tabcoin pro outro ou todo mundo dar tabcoin pra um s√≥ e etc, coisa do tipo?

>> Coment√°rio de danwhat:
Vamos l√°, em um sistema onde a quantidade de contas influenciasse na origem das TabCoins, o mais obvio seria criar varias contas. Por isso que eu falei sobre a autentica√ß√£o. Acho que √© o jeito mais simples de minimizarmos pessoas mal-intencionadas.

Outro problema seria contas hackeadas, mas isso √© mais simples de detectar.

E um terceiro, que acredito que seja quase "natural" de acontecer, √© poucos criadores dominarem quase todas as TabCoins do sistema. Que por um lado precisamos impedir, mas por outro √© justificavel  caso estes poucos criadores estiverem gerando MUUUUITO valor (apesar de n√£o ser legal para novos colaboradores).

Deixei passar algo que voc√™s j√° perceberam?

>> Coment√°rio de rodrigoKulb:
Uma d√∫vida. Quando voc√™ "curte" uma publica√ß√£o com as TCs essas TCs ficam com o usu√°rio que postou, certo? Se ele utilizar o saldo "ganho" para "curtir" outro post ele gasta o saldo do post original que ganhou as TCs? Assim poderia ter um prazo para a publica√ß√£o original perder as TCs, ele poderia gastar sem ter medo de perder o ranking da publica√ß√£o.

>> Coment√°rio de danwhat:
@wcarugatti lendo o seu coment√°rio pensei na possibilidade de ter um log de cada "transa√ß√£o" de TCs para futuramente criar um validador para que antes de ser poss√≠vel participar do Revenue Share.

Assim quando uma conta fake fosse identificada, todo TC gerado por ela poderia ser exclu√≠do da plataforma. S√≥ n√£o sei o quando pesado seria um sistema para guardar essas informa√ß√µes.

---

@rodrigoKulb na minha ideia inicial as TCs iriam diretamente para o saldo de quem recebeu as curtidas. E se essa pessoa n√£o tivesse TCBs ela gastaria as TCs sim. S√≥ n√£o consegui pensar em algo que fizesse o gasto de TCs gerar mais TCs do que simplesmente guard√°-las e usar apenas as TCBs

>> Coment√°rio de filipedeschamps:
> @filipedeschamps eu posso combinar com um amigo ou amigos (mais conhecido como proxy/bot) pra um dar muita tabcoin pro outro ou todo mundo dar tabcoin pra um s√≥ e etc, coisa do tipo?

Bingo @wcarugatti e com isso, inflacionar o meu XP tendo apenas 1 tabcoin sendo passado para l√° e para c√°.

E existe um **outro efeito colateral/abuso** no sistema de qualifica√ß√£o. Voc√™s conseguem adivinhar qual √©?

E bom ponto @danwhat isso tem a ver com um dos abusos que d√° para fazer. A dica que dou √©: `manipula√ß√£o`. Voc√™s conseguem adivinhar o que √©?

E @rodrigoKulb voc√™ est√° arranhando o problema. E respondendo a sua pergunta, quando voc√™ ganha tabcoins atrav√©s de um post, esse valor vai para o seu saldo e n√£o tem mais v√≠nculo com o post (a n√£o ser que o post seja deletado, da√≠ nesse caso as coins deveriam ser deletadas do saldo do autor).

## Mas algu√©m consegue descrever qual vai ser o abuso por `manipula√ß√£o`?
√â bem massinha, e tenho algumas solu√ß√µes que quero discutir com voc√™s.

>> Coment√°rio de danwhat:
N√£o sei se √© isso, mas dois poss√≠veis problemas para acrescentar a lista s√£o:

- Algu√©m com acesso a v√°rias contas em um sistema pequeno consegue manipular as curtidas para definir quais apareceram como destaque para ai sim ter um crescimento "org√¢nico-artificial" privilegiado.

- Outro problema que eu enxergo √© que na maioria dos sistemas voc√™ n√£o perde XP, apenas ganha. Se for assim, n√£o faz muito sentido a XP servir como m√©trica para participar do Revenue Share, j√° que, uma vez participando, voc√™ n√£o sairia (a n√£o ser perdendo % conforme outras pessoas fossem entrando), e o ideal seria participar apenas enquanto gera valor para a comunidade.

>> Coment√°rio de RodriguesCosta:
Bom lendo toda essa conversa tive uma ideia, talvez n√£o seja a melhor (nem a mais f√°cil de implementar üòÖ), mas vou deixar ela registrada.

Para o problema de amigos ficarem gastando TabCoins entre eles de maneira infinita, e assim gerando XP infinito o sistema poderia controlar as TabCoins como um saldo banc√°rio e assim como todo saldo banc√°rio gerar um extrato de cada movimenta√ß√£o daquela pessoa, e para gerar XP seria verificado no extrato se as TabCoins que ele est√° gastando vem de maneira direta ou indireta daquele amigo dele, eu sei ficou meio confuso, mas vamos tentar colocar isso e um exemplo.

Temos 2 amigos eles est√£o trocando TabCoins entre si, cada "transfer√™ncia" de TabCoins vai gerar uma entrada e uma sa√≠da no extrato associando aquela "transfer√™ncia" ao amigo dele e a ele, quando um amigo for transferir para o outro amigo o sistema transferir normalmente, mas o XP sempre seria gerado em forma de fila, onde seria verificado se nas √∫ltimas X transfer√™ncias ele j√° recebeu TabCoins daquele amigo que ele esta enviando TabCoins, caso fosse a primeira intera√ß√£o entre os 2 nas √∫ltimas X intera√ß√µes o XP seria atribu√≠do caso contrario seria ignorado.

Isso resolve o problema entre 2 amigos, mas quando fosse 3 ou mais? Nesse caso a fila de atribui√ß√£o de XP teria que verificar a profundidade e essa profundidade de verifica√ß√£o iria verificar as √∫ltimas X transa√ß√µes e para cada transa√ß√£o seria verificado as √∫ltimas Y transa√ß√µes de cada pessoa X.

Eu sei que ficou meio confuso mas podemos ir debatendo gradualmente e arrumando isso.

>> Coment√°rio de rodrigoKulb:
Existem 2 algor√≠timos legais que podemos utilizar tamb√©m:

**Waze**
Para colocar ou remover um bloqueio na pista ele utiliza uma quantidade "x" de avisos semelhantes, podendo ter um m√≠nimo de TabCoins de diferentes usu√°rios para ganhar XP. E n√£o criar uma l√≥gica 1 pra 1.

**Google**
Sistema de pageraking, primeiro algor√≠timo do Google, onde ele verificava a quantidade de links para um determinado site, quanto mais links maior o peso do pageraking, mesmo sistema de popularidade da escola. 
Podendo tamb√©m ter PESO de XP ganho do usu√°rio mais popular e menos popular.
 Conforme imagem abaixo:
![image](https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/PageRank-hi-res.png/300px-PageRank-hi-res.png)

>> Coment√°rio de danwhat:
@RodriguesCosta eu achei a explica√ß√£o meio confusa üòû

Mas ficou claro que precisariamos guarda informa√ß√µes de cada transa√ß√£o.

Com essas informa√ß√µes em m√£os poder√≠amos pensar em como tratar os dados para identificar comportamentos suspeitas, al√©m de eliminar do sistema TCs e XT geradas pelas contas deletadas.

O problema que cada curtida seria um insert no banco de dados. Me falta experi√™ncia para saber se isso seria muito custoso e se teria formas de otimizar esses inserts.

---

@rodrigoKulb que coment√°rio v√°lido! 
Procurar refer√™ncia √© que sempre melhor que tentar criar solu√ß√£o do zero.

Pesos diferente para gerar XP √© uma √≥tima ideia! Contas n√£o autenticadas poderiam ter menor peso. Contas com mais reputa√ß√£o poderia ter maior peso.  √â assim por diante.

>> Coment√°rio de RodriguesCosta:
@danwhat entendo e concordo que ficou meio confuso, mas basicamente e isso que falou vamos ter que armazenar isso no banco de dados, e analisar essas transa√ß√µes para gerar o XP.

Em rela√ß√£o √†s pessoas n√£o autenticadas conseguirem comentar / interagir penso que n√£o e uma boa ideia, visto que abre margem para spam.

>> Coment√°rio de filipedeschamps:
> * Algu√©m com acesso a v√°rias contas em um sistema pequeno consegue manipular as curtidas para definir quais apareceram como destaque para ai sim ter um crescimento "org√¢nico-artificial" privilegiado.

@danwhat perfeito! Imagine **uma √∫nica pessoa** possui duas contas, onde a `Conta1` est√° com 1.000 tabcoins e a `Conta2` zerada. Ele pode assim sempre manipular uma not√≠cia. Ele utiliza a `Conta2` para criar a not√≠cia, e pela `Conta1` injeta todo o saldo nessa not√≠cia, levantando ela para o topo. Depois disso, com a `Conta2` agora com 1.000 tabcoins, ele pode levantar outra not√≠cia criada pela `Conta1` e assim vai.

O que eu pensei e que vejo ser a forma mais f√°cil de implementar: **um imposto a cada doa√ß√£o**. E esse imposto √© um buraco negro que faz o tabcoin ir para lugar algum, e este √© o segredo dessa estrat√©gia. Quando a pessoa faz uma doa√ß√£o, chega apenas `50%` do valor do outro lado. Ent√£o se a pessoa quiser ficar rotacionando tabcoins, ela vai destruir rapidamente todo seu valor.

> * Outro problema que eu enxergo √© que na maioria dos sistemas voc√™ n√£o perde XP, apenas ganha. Se for assim, n√£o faz muito sentido a XP servir como m√©trica para participar do Revenue Share, j√° que, uma vez participando, voc√™ n√£o sairia (a n√£o ser perdendo % conforme outras pessoas fossem entrando), e o ideal seria participar apenas enquanto gera valor para a comunidade.

E sim, para o XP definir o Revenue Share, precisaria ser a % de todos os XPs e eu vejo como justo, porque se a pessoa j√° participou, √© um incentivo ela continuar participando, mas se decidir parar, automaticamente vai perdendo espa√ßo para outras pessoas que continuaram trazendo conte√∫dos relevantes e atualizados.  E n√£o √© uma elasticidade abrupta, e isso √© bom, pois d√° espa√ßo para a pessoa respirar, tirar f√©rias do tabnews quando quiser/precisar üòÇ

>> Coment√°rio de filipedeschamps:
> Para o problema de amigos ficarem gastando TabCoins entre eles de maneira infinita, e assim gerando XP infinito o sistema poderia controlar as TabCoins como um saldo banc√°rio e assim como todo saldo banc√°rio gerar um extrato de cada movimenta√ß√£o daquela pessoa, e para gerar XP seria verificado no extrato se as TabCoins que ele est√° gastando vem de maneira direta ou indireta daquele amigo dele...

@RodriguesCosta sensacional, eu tinha tamb√©m pensado em algo dessa natureza, mas controlando pelo `id` de cada tabcoin. N√£o fui muito afundo, mas voc√™ receberia XP apenas se recebesse tabcoin nova, mas a implementa√ß√£o t√©cnica pesaria bastante, fora que n√£o sei se seria uma experi√™ncia muito boa o ganho de XP n√£o ser determin√≠stico na vis√£o de quem est√° qualificando os posts (para completar o fluxo de contribui√ß√£o e assim receber XP).

>> Coment√°rio de filipedeschamps:
> Existem 2 algor√≠timos legais que podemos utilizar tamb√©m:
> 
> **Waze**
> **Google**

Interessant√≠ssimo @rodrigoKulb ! A participa√ß√£o no Revenue Share ser determinado pelo peso da rede que est√° qualificando os posts ü§ù

>> Coment√°rio de RodriguesCosta:
Nossa sensacional! Isso realmente resolveria o problema de maneira bem simples.
> O que eu pensei e que vejo ser a forma mais f√°cil de implementar: um imposto a cada doa√ß√£o. E esse imposto √© um buraco negro que faz o tabcoin ir para lugar algum, e este √© o segredo dessa estrat√©gia. Quando a pessoa faz uma doa√ß√£o, chega apenas 50% do valor do outro lado. Ent√£o se a pessoa quiser ficar rotacionando tabcoins, ela vai destruir rapidamente todo seu valor.

>> Coment√°rio de filipedeschamps:
# Sugest√£o para um primeiro passo:
Deixa tudo liberado, n√£o precisamos nos preocupar agora nesse est√°gio do projeto, mas vamos implementar um log solto de todas as transa√ß√µes, e com isso seria um **excelente** projeto algu√©m programar um algoritmo/modelo que identifica abusos. E pode identificar v√°rios tipos de abusos, desde estourando algum rate limit (para pegar bots), ou trocando tabcoins entre sempre as mesmas contas e com certeza vai ter outras formas de identificar e penalizar/banir essas contas.

Seria legal tentar trazer at√© algu√©m que trabalha no Risco do Pagar.me, porque na √©poca que eu trabalhava l√° o pessoal fazia um trabalho **muito** massa. Era um tradeoff entre liberar/barrar transa√ß√µes, tentando evitar fraudes, mas ao mesmo tempo tentando **penalizar no m√≠nimo** a experi√™ncia de quem estava tentando comprar de forma genu√≠na (que sempre vai ser a maioria).

Ent√£o talvez ao inv√©s de complicarmos a experi√™ncia e compreens√£o de quem quer e vai participar de forma construtiva, a gente implementa mecanismos invis√≠veis para visualizar e banir quem t√° ali para abusar (e d√° para fazer tudo automatizado).

O que acham?

>> Coment√°rio de danwhat:
> E sim, para o XP definir o Revenue Share, precisaria ser a % de todos os XPs e eu vejo como justo, porque se a pessoa j√° participou, √© um incentivo ela continuar participando, mas se decidir parar, automaticamente vai perdendo espa√ßo para outras pessoas que continuaram trazendo conte√∫dos relevantes e atualizados. E n√£o √© uma elasticidade abrupta, e isso √© bom, pois d√° espa√ßo para a pessoa respirar, tirar f√©rias do tabnews quando quiser/precisar.

@filipedeschamps , eu entendo a sua preocupa√ß√£o... mas vamos pensar em outra hip√≥tese: O tabnews √© um sucesso e est√° a 3 anos no ar. Ser√° quase imposs√≠vel um novo usu√°rio criar conte√∫do suficiente para consegui uma % relevante do Revenue Share.
Ser√° que n√£o conseguimos pensar em um meio termo? Ao mesmo tempo que resguarde o usu√°rios antigos tamb√©m seja amig√°vel para novos usu√°rios.

> Sugest√£o para um primeiro passo...

Perfeito. Podemos come√ßar a guardar as transa√ß√µes (idTabCoin, quemEnviou, quemRecebeu, quando), e seguir o barco. Mais para frente quando estivermos implementando o  Revenue Share a gente pensa em como  tratar os dados das transa√ß√µes para limpar as fraldes.

>> Coment√°rio de filipedeschamps:
> @filipedeschamps , eu entendo a sua preocupa√ß√£o... mas vamos pensar em outra hip√≥tese: O tabnews √© um sucesso e est√° a 3 anos no ar. Ser√° quase imposs√≠vel um novo usu√°rio criar conte√∫do suficiente para consegui uma % relevante do Revenue Share.
> Ser√° que n√£o conseguimos pensar em um meio termo? Ao mesmo tempo que resguarde o usu√°rios antigos tamb√©m seja amig√°vel para novos usu√°rios.

Perfeito! O que acha de talvez aplicar uma curva onde ela reduz a probabilidade de participa√ß√£o para quem tem muito XP, e aumenta para quem tem pouco?

> Perfeito. Podemos come√ßar a guardar as transa√ß√µes (idTabCoin, quemEnviou, quemRecebeu, quando), e seguir o barco. Mais para frente quando estivermos implementando o Revenue Share a gente pensa em como tratar os dados das transa√ß√µes para limpar as fraldes.

Show!!! ü§ù 

E sugiro deixar a issue aberta para mais pessoas lerem, digo isso pois mais gente ta pedindo invite pro repo üòç

>> Coment√°rio de danwhat:
> Perfeito! O que acha de talvez aplicar uma curva onde ela reduz a probabilidade de participa√ß√£o para quem tem muito XP, e aumenta para quem tem pouco?

√â uma boa. Mas me preocupo de isso desincentive os criadores em algum ponto. Isso faria o criador parar de gerar valor... ou pior: criar outra conta para continuar gerando valor.
"Eu j√° cheguei em uma % razo√°vel na participa√ß√£o do Revenue Share. Para conquistar mais que isso eu precisarei criar tanto conte√∫do que n√£o compensa."

Ser√° que pesos diferentes na participa√ß√£o dependendo do tempo de postagem n√£o seria melhor?
Uma not√≠cia de um m√™s rende 100% de participa√ß√£o. quando essa not√≠cia tiver 2 meses ela render√° 80%. 3 meses? 70%... E ai por diante. N√£o se prenda aos n√∫meros mais sim ao conceito proposto.

> E sugiro deixar a issue aberta para mais pessoas lerem, digo isso pois mais gente ta pedindo invite pro repo üòç

Foi mal. Ainda estou me acostumando com o conceito. Achei que era para fechar üôÉ

>> Coment√°rio de filipedeschamps:
> "Eu j√° cheguei em uma % razo√°vel na participa√ß√£o do Revenue Share. Para conquistar mais que isso eu precisarei criar tanto conte√∫do que n√£o compensa."

**Genial** eu n√£o tinha pensado nisso!

> Ser√° que pesos diferentes na participa√ß√£o dependendo do tempo de postagem n√£o seria melhor?
> Uma not√≠cia de um m√™s rende 100% de participa√ß√£o. quando essa not√≠cia tiver 2 meses ela render√° 80%. 3 meses? 70%... E ai por diante. N√£o se prenda aos n√∫meros mais sim ao conceito proposto.

Entendi!! Interessant√≠ssimo! S√≥ tem um detalhe: o XP s√≥ √© gerado no momento que a pessoa finalizar o fluxo de contribui√ß√£o, que √© qualificando outros posts (esse √© o incentivo para ganhar XP). Ent√£o n√£o √© no ato da cria√ß√£o da not√≠cia/coment√°rio ou recebimento. Mas seguindo o seu racioc√≠nio, talvez ent√£o posts novos d√£o mais tabcoins do que posts antigos, e que de uma forma ou outra isso vai se refletir em XP no final das contas. O que acha?

>> Coment√°rio de rodrigoKulb:
J√° que est√° f√°cil o assunto "TabCoins " Vou gerar um pouco mais de confus√£o kkkk... Penso que nem sempre o que √© "importante" para uma pessoa √© para outra. Como exemplo a timeline de uma rede social, Ela acaba virando uma vitrine personalizada para cada usu√°rio. Talvez seria interessante adicionar esse atributo no algor√≠timo de ordena√ß√£o.
01 - Tempo (quanto tempo foi postado)
02 - TabCoins (likes que recebeu)
03 - Interesse no assunto (j√° curti mat√©rias com esse assunto)

>> Coment√°rio de filipedeschamps:
Excelente @rodrigoKulb isso √© uma coisa que conversei bastante com o Guga, n√£o sei se voc√™s concordam mas numa rede social atual, ela apresenta o que √© mais **interessante** para voc√™, mas n√£o necessariamente o que √© mais **importante** para voc√™. E apesar de que *import√¢ncia* pode ser t√£o relativo quanto *interesse*, eu acredito que deixar o grupo de pessoas tabnews definir o que √© importante acaba trazendo um valor diferente do que as redes est√£o fazendo, que √© "o que o coletivo est√° dizendo que √© importante, mesmo que voc√™ n√£o goste do assunto". Faz sentido? De qualquer forma, tudo isso pode ser alterado, zero escrito em pedra üëç

>> Coment√°rio de rodrigoKulb:
> ela apresenta o que √© mais interessante para voc√™, mas n√£o necessariamente o que √© mais importante.

Matou a pau, com certeza!

>> Coment√°rio de danwhat:
> Entendi!! Interessant√≠ssimo! S√≥ tem um detalhe: o XP s√≥ √© gerado no momento que a pessoa finalizar o fluxo de contribui√ß√£o, que √© qualificando outros posts (esse √© o incentivo para ganhar XP). Ent√£o n√£o √© no ato da cria√ß√£o da not√≠cia/coment√°rio ou recebimento. Mas seguindo o seu racioc√≠nio, talvez ent√£o posts novos d√£o mais tabcoins do que posts antigos, e que de uma forma ou outra isso vai se refletir em XP no final das contas. O que acha?

@filipedeschamps Ou eu n√£o expliquei o problema direito ou eu n√£o captei a solu√ß√£o fornecida. Mas para mim o problema n√£o s√£o as not√≠cias antigas continuarem gerando XP e sim o XP antigo continuar a ser relevante para o Revenue Share.

Vamos supor que com 3 meses de TabNews tenha 10 criadores de conte√∫do e cada um faz uma m√©dia de 100XP/m√™s. Com isso teremos 90k XP no sistema. Quem come√ßar a criar conte√∫do depois dos 3 meses vai ter dificuldade de chegar a uma porcentagem de XP relevante para o Revenue Share, mas at√© ai tudo bem. √â claramente justo.

Mas agora vamos estender isso para um ano.  Nesse segundo cen√°rio um usu√°rio novo al√©m de precisar competir com outros usu√°rios (que por si s√≥ j√° ser√° mais dif√≠cil, visto que a tend√™ncia √© sempre aumentar a quantidade de usu√°rios com o passar do tempo), tamb√©m precisar√° competir com a XP dos meses passados que esses usu√°rios conquistaram.

Eu vejo esse sistema sendo quase proibitivo para novos usu√°rios depois de algum tempo. Estou certo ou eu deixei passar algo?

>> Coment√°rio de danwhat:
> ela apresenta o que √© mais interessante para voc√™, mas n√£o necessariamente o que √© mais importante.

Tenho tanta coisa na cabe√ßa que nem me atrevo a pensar em mais um sistema. Mas em rela√ß√£o a que tipo de conte√∫do o TabNews ir√° entregar, eu acho que deveria ser um meio-termo do que os usu√°rios querem e o que √© importante.

Se decidirmos entregar apensas o que √© importante, n√£o reteremos usu√°rios e isso pode at√© dificultar manter a plataforma com an√∫ncios. Agora se colocarmos apenas o que entret√™m, ser√° apenas mais um site com conte√∫do superficial e f√°cil de consumir mais que n√£o agrega muito a vida das pessoas.

Mas foi um √≥timo ponto voc√™ levantou isso @rodrigoKulb . √â importante saber como o conte√∫do ser√° distribu√≠do. E a ideia de ser personalizado para cada tipo de usu√°rio √© super v√°lida.

>> Coment√°rio de brunofamiliar:
Nossa, essa thread aqui ta bem interessante hen. Venho acompanhando essa discuss√£o h√° alguns dias, realmente essa quest√£o de possibilitar que o usu√°rio personalize seus interesses √© super v√°lido, falo isso por experi√™ncia pr√≥pria. Em um site de noticias comum eu pulo quase 70% do conte√∫do at√© encontrar algo relevante, ent√£o se "for√ßamos" as pessoas a consumir somente as noticias que forem relevante para o coletivo, pode afetar diretamente no engajamento e na reten√ß√£o do p√∫blico no site. Ent√£o concerteza aquilo que era pra ser legal e atender minhas necessidades de informa√ß√£o (supondo que sou apenas um p√∫blico que ir√° consumir conte√∫do), passa ser um incomodo e enjoativo.

>> Coment√°rio de SysDaemon:
> O problema que cada curtida seria um insert no banco de dados. Me falta experi√™ncia para saber se isso seria muito custoso e se teria formas de otimizar esses inserts.
> 

No come√ßo, o volume de inserts pode at√© ser pequeno. 
Mas ap√≥s isso, podemos guardar blocos na mem√≥ria e realizar um Bulk-Insert para cada 5k de curtidas.
Se dimensionarmos bem as tabelas, fazendo uma rela√ß√£o do "Id" das not√≠cias, "id" dos usu√°rios e com um campo num√©rico, isso n√£o seria custoso para o SGDB.

>> Coment√°rio de wcarugatti:
Pessoal, como somos programadores e n√£o gostamos de reinventar taanto a roda.

Acho que vale muito de inspira√ß√£o isso aqui:

https://steemit.com
https://steemit.com/faq.html
https://steem.com/steem-bluepaper.pdf
https://steem.com/SteemWhitePaper.pdf

Eu sei que n√£o vamos usar blockchain, mas o steemit/steem √© uma rede social/blockchain com uma proposta **MUITO** parecida com a do tabnews de premiar conte√∫dos/posts relevantes e ao mesmo tempo ter o sistema a prova de abusos.

Eles resolvem a maioria dos problemas citados nessa issue com essa blockchain pr√≥pria deles. O que vale de inspira√ß√£o ai √© o whitepaper e o bluepaper deles que explica muito bem que l√≥gica eles usaram pra resolver esses problemas como por exemplo:

> Steem operates on the basis of one-STEEM, one-vote. Under this model, individuals who have
contributed the most to the platform, as measured by their account balance, have the most
influence over how contributions are scored

@rodrigoKulb da uma olhada, acho que voc√™ vai gostar.

>> Coment√°rio de rodrigoKulb:
> @rodrigoKulb da uma olhada, acho que voc√™ vai gostar.

@wcarugatti muito legal, como o @filipedeschamps comentou nada est√° escrito em pedras, gostei muito da op√ß√£o de downvote, uma forma de conseguir reduzir spam's e noticias sem contexto de tecnologia.

Acredito que a ordena√ß√£o das not√≠cias ser√° um resultado de um **algor√≠timo** que vamos construir trocando informa√ß√µes e experi√™ncias. 

Objetivo do algor√≠timo √© obter um ranking com todo an√°lise de XPs, TCs, DATA, sistema anti fraudes etc...

Muito parecido com o algor√≠timo do Google, n√£o √© algo simples que qualquer um consegue burlar facilmente, mas precisa ser claro para que o resultado seja r√°pido.

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù
</issue_11_Sistema de TabCoins>

<issue_12_Proposta de Arquitetura>
Ol√° a todos.

Pensando em um crescimento mais saud√°vel do projeto, mas sem trazer complica√ß√µes e Overengineering, pensei em trazer um modelo de arquitetura para o frontend do projeto. 

Indo direto ao ponto, esse √© o modelo:

```sh
src
‚îú‚îÄ‚îÄ components   # Componentes globais de uso geral do projeto.
‚îú‚îÄ‚îÄ layout       # Wrappers padr√µes para componentes ou p√°ginas.
‚îú‚îÄ‚îÄ hooks        # Hooks globais de uso geral do projeto.
‚îú‚îÄ‚îÄ contexts     # Contexts para gerenciamento de estado global do projeto.
‚îú‚îÄ‚îÄ modules      # M√≥dulos. Um para cada p√°gina, com a l√≥gica de neg√≥cio.
‚îÇ      ‚îî‚îÄ‚îÄ   example-module
‚îÇ              ‚îú‚îÄ‚îÄ  index.js/ts  # Ponto de partida desse m√≥dulo. Esse arquivo ser√° importado na p√°gina pertinente.
‚îÇ              ‚îú‚îÄ‚îÄ  hooks        # Hooks globais de uso exclusivo desse m√≥dulo.
‚îÇ              ‚îú‚îÄ‚îÄ  components   # Componentes de uso exclusivo desse m√≥dulo.
‚îÇ              ‚îú‚îÄ‚îÄ  service      # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica de uso exclusivo desse m√≥dulo.
‚îÇ              ‚îî‚îÄ‚îÄ  utils        # Componentes de uso exclusivo desse m√≥dulo.
‚îú‚îÄ‚îÄ pages        # Cada p√°gina associada com uma rota e um m√≥dulo. 
‚îú‚îÄ‚îÄ services     # L√≥gica de comunica√ß√£o com o backend.
‚îú‚îÄ‚îÄ shared       # Tudo que for compartilh√°vel entre m√≥dulos. Sendo configura√ß√£o de temas, etc.
‚îî‚îÄ‚îÄ utils        # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica.
```

Essa estrutura interna aos _M√≥dulos_ √© opcional e pode ser criada mediante necessidade, precisando inicialmente s√≥ do `index.js/ts`

Caso queiram agregar em algo, criticar ou propor melhorias, por favor coloquem aqui nessa **Issue**. Sei que queremos manter KISS, mas acredito que isso n√£o seja distante do simples e intuitivo, mas agregue muito a longo prazo na manutenibilidade do projeto.

Um forte abra√ßo pessoal.

>> Coment√°rio de pscruzzz:
Fala, Dhaniel! Tudo certo?

Concordo 100% que √© necess√°rio, at√© mesmo no curto prazo, tem sido complicado sempre recomponentizar para iniciar o desenvolvimento. Daria at√© mesmo para botar essa estrutura sugerida por voc√™ dentro da pasta 'pages' se quisesse, atrav√©s do page-extensions como sugerido na [doc](https://nextjs.org/docs/api-reference/next.config.js/custom-page-extensions).

Inserindo um pageExtension como `['page.jsx', 'page.js']` daria para ter componentes que n√£o s√£o p√°ginas dentro da pasta pages.

> Note: configuring pageExtensions also affects _document.js, _app.js as well as files under pages/api/. For example, setting pageExtensions: ['page.tsx', 'page.ts'] means the following files: _document.tsx, _app.tsx, pages/users.tsx and pages/api/users.ts will have to be renamed to _document.page.tsx, _app.page.tsx, pages/users.page.tsx and pages/api/users.page.ts respectively.

Podendo ficar algo como (enxuguei um pouco s√≥ pra exemplificar):

```sh
src
‚îú‚îÄ‚îÄ pages # M√≥dulos. Um para cada p√°gina, com a l√≥gica de neg√≥cio.
‚îÇ      ‚îî‚îÄ‚îÄ home-01
‚îÇ              ‚îú‚îÄ‚îÄ  index.page.js/ts 
‚îÇ              ‚îú‚îÄ‚îÄ  hooks
‚îÇ              ‚îú‚îÄ‚îÄ  components
‚îÇ              ‚îú‚îÄ‚îÄ  service
‚îÇ              ‚îî‚îÄ‚îÄ  utils
‚îÇ      ‚îî‚îÄ‚îÄ home-02
‚îÇ              ‚îú‚îÄ‚îÄ  index.page.js/ts
‚îÇ              ‚îú‚îÄ‚îÄ  hooks
‚îÇ              ‚îú‚îÄ‚îÄ  components
‚îÇ              ‚îú‚îÄ‚îÄ  service
‚îÇ              ‚îî‚îÄ‚îÄ  utils
```
Isso at√© o momento em que uma home oficial seja escolhida.

>> Coment√°rio de dhanielsales:
Muito interessante! N√£o conhecia essa feature do `next.config.js`. Pode ser tranquilamente dentro da pasta _pages_ de fato. 

Ap√≥s ter postado aqui, me recordei que a proposta do TabNews √© de ser monorepo, com backend acoplado, ent√£o acredito que sua solu√ß√£o proposta, possa at√© fazer mais sentido realmente, tentando enxugar mais a pastas, j√° que haver√£o pastas tamb√©m para o backend.

Vou colocar outro mapa abaixo do que eu entendi, para termos em mente algo e irmos evoluindo. üòÑ

```sh
src
‚îú‚îÄ‚îÄ components   # Componentes globais de uso geral do projeto.
‚îú‚îÄ‚îÄ layout       # Wrappers padr√µes para componentes ou p√°ginas.
‚îú‚îÄ‚îÄ hooks        # Hooks globais de uso geral do projeto.
‚îú‚îÄ‚îÄ contexts     # Contexts para gerenciamento de estado global do projeto.
‚îú‚îÄ‚îÄ pages        # Cada p√°gina associada com uma rota e com a l√≥gica de neg√≥cio. 
‚îÇ      ‚îú‚îÄ‚îÄ example-page
‚îÇ      ‚îÇ      ‚îú‚îÄ‚îÄ  index.page.js/ts  # Ponto de partida dessa rota.
‚îÇ      ‚îÇ      ‚îú‚îÄ‚îÄ  hooks        # Hooks globais de uso exclusivo desse m√≥dulo.
‚îÇ      ‚îÇ      ‚îú‚îÄ‚îÄ  components   # Componentes de uso exclusivo desse m√≥dulo.
‚îÇ      ‚îÇ      ‚îú‚îÄ‚îÄ  service      # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica de uso exclusivo desse m√≥dulo.
‚îÇ      ‚îÇ      ‚îî‚îÄ‚îÄ  utils        # Componentes de uso exclusivo desse m√≥dulo.
‚îÇ      ‚îî‚îÄ‚îÄ api
‚îÇ             ‚îî‚îÄ‚îÄ  example-api-route.page.js/ts
‚îú‚îÄ‚îÄ services     # L√≥gica de comunica√ß√£o com o backend.
‚îú‚îÄ‚îÄ shared       # Tudo que for compartilh√°vel entre m√≥dulos. Sendo configura√ß√£o de temas, etc.
‚îî‚îÄ‚îÄ utils        # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica.
```
 
Gostei bastante dessa ideia! :satisfied:

>> Coment√°rio de filipedeschamps:
Ahhh que issue importante üòç  vou precisar de bastante ante ajuda nisso ü§ù 

Algo l√° no fundo da minha cabe√ßa diz que a gente deveria se isolar ao m√°ximo do Next.js, por exemplo programar o m√°ximo que der tudo de funcionalidade numa pasta `core` que √© cega ao que √© implementado dentro da vis√£o do Next.js... isso inclui desde os models, acesso ao banco, mas a minha vis√£o come√ßa a se quebrar quando se √© ou n√£o certo colocar os componentes em React, pois eu vejo que eles n√£o s√£o o framework Next.js, eles s√£o usados por ele. Em resumo, para mim o Next.js √© um grande `controller` de p√°ginas e endpoint de APIs. Mas como eu nunca construi uma aplica√ß√£o Next.js grande na minha vida, eu **provavelmente estou redondamente enganado** e eu vou estudar mais para poder contribuir com essa discuss√£o.

Em paralelo, o que facilitaria √© a gente olhar para os layouts e tentar entender o que s√£o os componentes, e o que eles v√£o precisar de dados e de onde eles vem. O que acham? ü§ù

>> Coment√°rio de dhanielsales:
Gosto muito da ideia de utilizar do NextJs como um grande Router com seus "Controllers" pro frontend e backend, nunca havia pensado nele dessa maneira. :thinking:
Vou tentar pensar em algo hoje a noite e coloco aqui amanh√£ :smile:

>> Coment√°rio de filipedeschamps:
Show! Eu sempre tento ao m√°ximo visualizar quem √© o "controller" de um sistema, para mim √© uma camada t√£o interessante quanto o core/l√≥gica de neg√≥cio, pois √© quem leva as informa√ß√µes pra l√° e pra c√°.

De qualquer forma, n√£o sei o quanto a minha sugest√£o se sustenta, dado ao modelo proposto pelo @pscruzzz com o `pageExtension` üëç

>> Coment√°rio de huogerac:
Fala pessoal,
Nunca fiz um projeto frontend com React do zero, tenho trabalhado √∫ltimamente com VueJS, vou compartilhar a estrutura que utilizo nos projetos VueJS, mais para compara√ß√£o mesmo. Quem sabe tem algo √∫til para projetos React:

```MEU-PROJETO                üëâ Estrutura VUEJS
‚îú‚îÄ‚îÄ devops                 üëâ Ansible para deploy
‚îú‚îÄ‚îÄ public
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ img
‚îÇ   favicon.ico
‚îÇ   manifest.json          üëâ Para tornar o App Web PWA
‚îî‚îÄ‚îÄ src
    ‚îú‚îÄ‚îÄ router             üëâ #1 - Rotas da aplica√ß√£o
    ‚îú‚îÄ‚îÄ views              üëâ #2
    ‚îÇ   ‚îú‚îÄ‚îÄ external       üëâ P√°ginas p√∫blicas referente a uma rota
    ‚îÇ   ‚îÇ                     Tem Componentes, chamadas para API e chamadas a STORE
    ‚îÇ   ‚îî‚îÄ‚îÄ internal       üëâ P√°ginas privadas referente a uma rota
    ‚îú‚îÄ‚îÄ components         üëâ #3 - Componentes puros, uma p√°gina (view) pode ter N componentes
    ‚îÇ                         Componentes podem enviar eventos (click, acaoX etc...)
    ‚îú‚îÄ‚îÄ api                üëâ #4 - Camada para chamar o backend usando AXIOS
    ‚îú‚îÄ‚îÄ store              üëâ #5 - Camada VueX (Igual Redux no React)
    ‚îú‚îÄ‚îÄ assets             üëâ Imagens
    ‚îú‚îÄ‚îÄ filters            üëâ Permite usar `| formataFone` no template (HTML)
    ‚îú‚îÄ‚îÄ layouts            üëâ Base para o #2
    ‚îÇ   ‚îú‚îÄ‚îÄ Internal.vue   üëâ Layout base com menu suporior para usuarios logados
    ‚îÇ   ‚îî‚îÄ‚îÄ External.vue   üëâ Layout base para usuarios sem login
    ‚îú‚îÄ‚îÄ mixins             üëâ C√≥digo comum entre p√°ginas (VIEW, ex: carregarUsuarioLogado)
    ‚îú‚îÄ‚îÄ plugins            üëâ Conf. do VueJS
    ‚îú‚îÄ‚îÄ styles             üëâ Estilos comuns (usando SCSS)
```

Um ponto de aten√ß√£o, v√™ se faz sentido pra voces no contexto do React:  
√â a separa√ß√£o em camadas, onde cada camada tem sua responsabilidade. Por exemplo, imagina que a apenas a camada da API faz comunica√ß√£o com o backend, que apenas p√°ginas podem chamar a API (assim n√£o temos regras de neg√≥cio dentro dos componentes)

Tem este video curto mostrando um pouco do c√≥digo acima:
https://www.youtube.com/watch?v=OJBHV2o5xuw

Abra√ßo

>> Coment√°rio de filipedeschamps:
@huogerac muito massa vir trazer sua experi√™ncia com VueJS ü§ù excelente poder analisar o problema sob √¢ngulos diferentes üëç

>> Coment√°rio de rodrigoKulb:
Achei esse artigo bem completo e simples:
https://medium.com/nerd-for-tech/building-solid-next-js-architecture-a8c6702dc67d

Utilizaremos Redux?

>> Coment√°rio de renant:
Muito bom o artigo @rodrigoKulb 

Sobre se vamos utilizar Redux, eu particularmente n√£o gosto muito (pode ter sido experi√™ncias frustrantes minhas), eu acredito que ele adiciona uma super complexidade onde geralmente nem √© necess√°ria, como estamos usando next e acredito eu que algumas coisas vamos manter est√°ticas e outras renderizando do lado do server. N√£o sei se precisamos mas √© um bom questionamento para discutirmos.

Ps: usei Mobx no flutter, n√£o sei se √© exatamente igual mas eu achei mais "pratico" do que o Redux

>> Coment√°rio de brunofamiliar:
> Fala pessoal,
> Nunca fiz um projeto frontend com React do zero, tenho trabalhado √∫ltimamente com VueJS, vou compartilhar a estrutura que utilizo nos projetos VueJS, mais para compara√ß√£o mesmo. Quem sabe tem algo √∫til para projetos React:
> 
> ```
> ‚îú‚îÄ‚îÄ devops                 üëâ Ansible para deploy
> ‚îú‚îÄ‚îÄ public
> ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ img
> ‚îÇ   favicon.ico
> ‚îÇ   manifest.json          üëâ Para tornar o App Web PWA
> ‚îî‚îÄ‚îÄ src
>     ‚îú‚îÄ‚îÄ router             üëâ #1 - Rotas da aplica√ß√£o
>     ‚îú‚îÄ‚îÄ views              üëâ #2
>     ‚îÇ   ‚îú‚îÄ‚îÄ external       üëâ P√°ginas p√∫blicas referente a uma rota
>     ‚îÇ   ‚îÇ                     Tem Componentes, chamadas para API e chamadas a STORE
>     ‚îÇ   ‚îî‚îÄ‚îÄ internal       üëâ P√°ginas privadas referente a uma rota
>     ‚îú‚îÄ‚îÄ components         üëâ #3 - Componentes puros, uma p√°gina (view) pode ter N componentes
>     ‚îÇ                         Componentes podem enviar eventos (click, acaoX etc...)
>     ‚îú‚îÄ‚îÄ api                üëâ #4 - Camada para chamar o backend usando AXIOS
>     ‚îú‚îÄ‚îÄ store              üëâ #5 - Camada VueX (Igual Redux no React)
>     ‚îú‚îÄ‚îÄ assets             üëâ Imagens
>     ‚îú‚îÄ‚îÄ filters            üëâ Permite usar `| formataFone` no template (HTML)
>     ‚îú‚îÄ‚îÄ layouts            üëâ Base para o #2
>     ‚îÇ   ‚îú‚îÄ‚îÄ Internal.vue   üëâ Layout base com menu suporior para usuarios logados
>     ‚îÇ   ‚îî‚îÄ‚îÄ External.vue   üëâ Layout base para usuarios sem login
>     ‚îú‚îÄ‚îÄ mixins             üëâ C√≥digo comum entre p√°ginas (VIEW, ex: carregarUsuarioLogado)
>     ‚îú‚îÄ‚îÄ plugins            üëâ Conf. do VueJS
>     ‚îú‚îÄ‚îÄ styles             üëâ Estilos comuns (usando SCSS)
> ```
> 
> Um ponto de aten√ß√£o, v√™ se faz sentido pra voces no contexto do React:
> √â a separa√ß√£o em camadas, onde cada camada tem sua responsabilidade. Por exemplo, imagina que a apenas a camada da API faz comunica√ß√£o com o backend, que apenas p√°ginas podem chamar a API (assim n√£o temos regras de neg√≥cio dentro dos componentes)
> 
> Tem este video curto mostrando um pouco do c√≥digo acima:
> https://www.youtube.com/watch?v=OJBHV2o5xuw
> 
> Abra√ßo

Hoje parei pra ler melhor sobre essa arquitetura, vai me ajudar bastante! Estava em busca de algo que pudesse me auxiliar em um projeto vuejs que venho atuando üòÑ

>> Coment√°rio de rodrigoKulb:
> Sobre se vamos utilizar Redux, eu particularmente n√£o gosto muito (pode ter sido experi√™ncias frustrantes minhas), eu acredito...

Concordo, nunca trabalhei com Redux estava lendo que ele centraliza o comportamento / intera√ß√µes entre os componentes. Mas acredito que em projeto de pequeno / m√©dio porte n√£o seja t√£o necess√°rio.

>> Coment√°rio de victorbiasibetti:
> Ol√° a todos.
> 
> Pensando em um crescimento mais saud√°vel do projeto, mas sem trazer complica√ß√µes e Overengineering, pensei em trazer um modelo de arquitetura para o frontend do projeto.
> 
> Indo direto ao ponto, esse √© o modelo:
> 
> ```shell
> src
> ‚îú‚îÄ‚îÄ components   # Componentes globais de uso geral do projeto.
> ‚îú‚îÄ‚îÄ layout       # Wrappers padr√µes para componentes ou p√°ginas.
> ‚îú‚îÄ‚îÄ hooks        # Hooks globais de uso geral do projeto.
> ‚îú‚îÄ‚îÄ contexts     # Contexts para gerenciamento de estado global do projeto.
> ‚îú‚îÄ‚îÄ modules      # M√≥dulos. Um para cada p√°gina, com a l√≥gica de neg√≥cio.
> ‚îÇ      ‚îî‚îÄ‚îÄ   example-module
> ‚îÇ              ‚îú‚îÄ‚îÄ  index.js/ts  # Ponto de partida desse m√≥dulo. Esse arquivo ser√° importado na p√°gina pertinente.
> ‚îÇ              ‚îú‚îÄ‚îÄ  hooks        # Hooks globais de uso exclusivo desse m√≥dulo.
> ‚îÇ              ‚îú‚îÄ‚îÄ  components   # Componentes de uso exclusivo desse m√≥dulo.
> ‚îÇ              ‚îú‚îÄ‚îÄ  service      # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica de uso exclusivo desse m√≥dulo.
> ‚îÇ              ‚îî‚îÄ‚îÄ  utils        # Componentes de uso exclusivo desse m√≥dulo.
> ‚îú‚îÄ‚îÄ pages        # Cada p√°gina associada com uma rota e um m√≥dulo. 
> ‚îú‚îÄ‚îÄ services     # L√≥gica de comunica√ß√£o com o backend.
> ‚îú‚îÄ‚îÄ shared       # Tudo que for compartilh√°vel entre m√≥dulos. Sendo configura√ß√£o de temas, etc.
> ‚îî‚îÄ‚îÄ utils        # Fun√ß√µes e l√≥gicas de utiliza√ß√£o geral e gen√©rica.
> ```
> 
> Essa estrutura interna aos _M√≥dulos_ √© opcional e pode ser criada mediante necessidade, precisando inicialmente s√≥ do `index.js/ts`
> 
> Caso queiram agregar em algo, criticar ou propor melhorias, por favor coloquem aqui nessa **Issue**. Sei que queremos manter KISS, mas acredito que isso n√£o seja distante do simples e intuitivo, mas agregue muito a longo prazo na manutenibilidade do projeto.
> 
> Um forte abra√ßo pessoal.

Particularmente eu gostei bastante desta arquitetura, pois com ela daria para isolar a parte de server-side no _pages/page.js(ts)_ e o m√≥dulo tratar apenas os dados, sem se preocupar de onde eles est√£o vindo.

>> Coment√°rio de brunofamiliar:
> Muito bom o artigo @rodrigoKulb
> 
> Sobre se vamos utilizar Redux, eu particularmente n√£o gosto muito (pode ter sido experi√™ncias frustrantes minhas), eu acredito que ele adiciona uma super complexidade onde geralmente nem √© necess√°ria, como estamos usando next e acredito eu que algumas coisas vamos manter est√°ticas e outras renderizando do lado do server. N√£o sei se precisamos mas √© um bom questionamento para discutirmos.
> 
> Ps: usei Mobx no flutter, n√£o sei se √© exatamente igual mas eu achei mais "pratico" do que o Redux

J√° usei o Mobx em um projeto react, achei tamb√©m mais pr√°tico que o Redux. Acredito que para uma constru√ß√£o r√°pida, o mobx deve ser a melhor op√ß√£o. Agora se parar pra pensar em escalabilidade, o Redux √© melhor por se trabalhar com fun√ß√µes puras; isso torna a aplica√ß√£o mais f√°cil de escalonar.

>> Coment√°rio de wcarugatti:
Eu voto no redux ou contextAPI por serem duas libs muito usadas, de conhecimento geral. J√° que √© um projeto open source, muita gente j√° tem exp com redux, e quem n√£o tem vai se beneficiar de aprender redux que √© muito pedido no mercado.

>> Coment√°rio de huogerac:
Oi pessoal,

1)
Vejo nos projetos a separa√ß√£o em 2 estruturas (frontend e backend), independente se √© no mesmo reposit√≥rio ou em reposit√≥rios diferentes.
Minha d√∫vidia aqui √©: embora eu vi que o Next.js √© server side rendering, mas como n√£o conhe√ßo, gostaria de entender se a ideia √© um repo mesmo? ou se faz sentido fazer uma separa√ß√£o bem clara (via repo ou via pastas) do backend e suas responsabilidades.
Em outras palavras, estas estruturas de pastas me parecem focarem mais na camada do frontend apenas, talvez precisamos tambem pensar na estrutura do backend (que ir√° no m√≠nimo ter uma camada de API e outra de acesso ao banco/ORM/Migrations), faz sentido?

2)
Posso estar enganado, mas as vezes parece que os devs backend  acham que 80% √© do backend e no frontend √© s√≥ "uma pagininha" e os devs frontend acham que 80% √© no front e o backend √© s√≥ acesso ao banco..rs
Meu ponto √© que os 2 lados tem complexidades, vai ter milestone que 100% do trabalho vai ser no backend e outro no frontend, acredito que ambos precisam de aten√ß√£o (estrutura de pastas/camadas/separa√ß√£o de responsabilidade etc..)
E da a impress√£o que o Next.js trata que o "server side" √© a parte mais simples...e ele faz a m√°gica pra gente

Enfim, s√≥ para entender e confirmar que vai ser apenas um reposit√≥rio mesmo, onde o tabnews vai utilizar o SSR e recursos server side. Me parece bem interessante isto, mas ao mesmo tempo, tendo a separar em 2 projetos/repos, onde cada um segue sua vida independente...voces que j√° trabalham Next.js neste modelo de server side, quais mais vantagens temos?
Valeu e []'s

>> Coment√°rio de marcostaborda:
Ol√° pessoal, conforme a live de hj, eu mencionei um tipo Design System para front-end que acho v√°lido dar uma olhada, se chama Atomic Design.

Foi criada por [Brad Frost](https://twitter.com/brad_frost). Eu acho bacana pois n√£o estamos projetando p√°ginas e sim um sistema com v√°rios componentes, e esse design system cai como luva para o projeto.

Fica um v√≠deo do Rodrigo Branas sobre o assunto  - https://www.youtube.com/watch?v=d_zG_KrXiLo

N√£o sei o que acham, comentem  üòÖ

>> Coment√°rio de filipedeschamps:
> Minha d√∫vidia aqui √©: embora eu vi que o Next.js √© server side rendering, mas como n√£o conhe√ßo, gostaria de entender se a ideia √© um repo mesmo? ou se faz sentido fazer uma separa√ß√£o bem clara (via repo ou via pastas) do backend e suas responsabilidades.

Fala @huogerac a ideia √© resolver toda a parte web (tanto as p√°ginas quanto a api) pelo mesmo reposit√≥rio. Ent√£o sim, vamos por enquanto usar o combo backend+frontend fornecido pelo Next.js üëç

>> Coment√°rio de filipedeschamps:
Fala turma! To h√° **alguns bons dias** remoendo esse assunto, e confesso que n√£o estou conseguindo avan√ßar muito. Arquitetura √© como jogar xadrez, e no meu caso n√£o estou conseguindo visualizar muitas jogadas para frente üòÇ  ent√£o eu vou soltar aqui um **blob** de informa√ß√£o para avalia√ß√£o de voc√™s.

Mas antes, eu estou a caminho de me educar melhor no assunto e terminei de ler o livro Clean Architecture (n√£o gostei como a obra foi escrita), em paralelo comprei um curso do Rodrigo Branas que ele fala [nesse v√≠deo](https://youtu.be/oZaZfR9CrRk) e que vai come√ßar semana que vem, e tamb√©m quero assistir [essa playlist](https://www.youtube.com/playlist?list=PL9aKtVrF05DyEwK5kdvzrYXFdpZfj1dsG) e [essa aqui tamb√©m](https://www.youtube.com/playlist?list=PL9aKtVrF05DxIrtD3CuXGnzq8Q0IZ-t8J) do @rmanguinho.

Mas nada disso vai caber dentro do prazo da Milestone, ent√£o minha sugest√£o vai juntar o que voc√™s discutiram aqui nessa issue, com minhas experi√™ncias passadas, come√ßando pelo o que eu vi acontecendo no Pagar.me:

## Pagar.me
Aconteceu uma coisa interessante l√°, porque de todas as empresas na qual eu tinha trabalhado at√© ent√£o, as arquiteturas eram basicamente _amebas_ no sentido de que n√£o tinha arquitetura, o neg√≥cio s√≥ foi acontecendo e talvez pior que a falta de arquitetura era a falta de modelagem. Sem essa modelagem, as coisas n√£o tinham come√ßo nem fim, era uma responsabilidade invadindo o terreno da outra, e trabalhar em algo assim misturado √© dif√≠cil porque voc√™ n√£o sabe no que voc√™ est√° mexendo exatamente. E quando eu entrei no Pagar.me (que na √©poca era altas empresa hype), eu pensei: _"puts, aqui vai ter a arquitetura mais sensacional e sofisticada que eu vou presenciar na minha vida"_... e turma, n√£o, era extremamente simples, pelo menos na camada da API.

Essa camada, analisando de forma grosseira, n√£o passava de um MVC simples, voc√™ tinha os `Models` muito bem modelados (muito bem mesmo, pouqu√≠ssimos eram muito grandes), os `Controllers` n√£o tinham regras de neg√≥cio, eram apenas controladores de fluxo mesmo (e que colavam a parte de autentica√ß√£o/autoriza√ß√£o) e as `Views` nesse caso eram a renderiza√ß√£o do retorno da API (um JSON). E era impressionante como que uma arquitetura t√£o simples poderia sustentar uma empresa que estava faturando milh√µes e milh√µes.

## Onde isso quebrava?
Eu n√£o quero entrar em muitos detalhes, pois nem sei se eu poderia estar falando essas coisas, mas a manuten√ß√£o come√ßava a ficar complicada quando esses Models eram compartilhados entre outros servi√ßos, e tamb√©m acabava sendo uma luta constante a quantidade de testes E2E para garantir o comportamento final da aplica√ß√£o (por conta das in√∫meras regras financeiras). Fintech √© algo realmente arriscado, e tem muita coisa sens√≠vel, muita regra de neg√≥cio estranha, muitos detalhes e que muitas vezes nem estavam documentados e voc√™ s√≥ encontrava as informa√ß√µes que queria ou lendo a implementa√ß√£o, ou lendo os testes. Ent√£o o _bolol√¥_ real come√ßava nas pr√≥prias regras financeiras... elas por si s√≥, sem implementa√ß√£o alguma, j√° eram um inferno üòÇ 

## No final das contas, o que isso me mostrou?
Uma arquitetura simples, com uma √≥tima modelagem, faz voc√™ ir longe, e longe **mesmo**, tanto em aguentar pancada de tr√°fego, quanto na parte financeira. Qualquer pessoa consegue embarcar em algo assim simples e repetitivo, e a dificuldade vem quando voc√™ cresceu tanto, que a "obra" toda √© complexa, independente de como ela foi aplicada. Ent√£o **eu n√£o tenho medo de arquitetura simples**, eu tenho mais medo de **modelagem mal feita**. E claro que para tudo tem um limite e nenhuma arquitetura simples aguenta a press√£o que vai se criando ao passar do tempo, principalmente quando o escopo do seu problema vai mudando.

## Minha vis√£o sobre o contexto que estamos inseridos no TabNews
O Next.js, querendo ou n√£o, toma por voc√™ algumas decis√µes de arquitetura e que na minha vis√£o raspam um pouco no MVC, por exemplo: ele resolve automaticamente para voc√™ as rotas e j√° te joga ou numa View representado pelo que est√° dentro do `/pages` ou num Controller representado pelo que est√° dentro de `/pages/api`. Por√©m ele n√£o resolve nada do Model, o que √© √≥timo. Mas numa vis√£o ainda mais macro, como eu j√° falei dentro dessa issue, eu vejo ele como um grandiss√≠simo Controller e **quase tudo** pode ser programado fora dele, incluindo os componentes em React, deixado o Next.js realmente como o controlador do que mostrar em qual "acesso" que o framework receber, seja acesso numa P√°gina, ou numa rota de API. Tirando essa parte de Controller mais tradicional, ele tamb√©m √© respons√°vel por ser um Controller N√£o Tradicional, ao trazer funcionalidades como o `getStaticProps` ou `getStaticPaths` por exemplo. E eu chamo de Controller N√£o Tradicional, porque tamb√©m √© s√≥ uma forma de coletar dados e jogar dentro de uma View (que √© o componente final React).

E a palavra Controller em todas essas situa√ß√µes √© importante, porque isso for√ßa a pensarmos sempre que **n√£o devemos programar regras de neg√≥cio nessa camada**. E isso s√≥ refor√ßa minha vis√£o de que o Next.js √© um grande Controller, e tudo de importante deve ser programado **fora** dele, deixando ao framework a responsabilidade de orquestrar o fluxo da requisi√ß√£o, conforme a rea√ß√£o de cada regra de neg√≥cio.

## Onde respeitar essa ideia se torna contra-produtivo?
Antes de eu desenvolver essa parte, deixa eu mostrar em estrutura de pastas o que escrevi at√© agora:

```
üì¶ root
 ‚î£ üìÇ core     # Tudo o que √© de nossa responsabilidade
 ‚îó üìÇ web      # Tudo o que √© responsabilidade do Next.js
```

Entenda o `core` onde tudo que n√≥s vamos programar do zero, e que independe do Next.js, e que inclusive pode ser reaproveitado para qualquer outro Framework ou codebase teoricamente falando. J√° a pasta `web` √© o que vamos expor para a internet como web mesmo, como website, e que √© o root do Next.js. Expandindo ela ficaria assim, e eu j√° volto aqui, porque tem um ponto que vai atrapalhar, mas por enquanto segue o jogo:

```
üì¶ root
 ‚î£ üìÇ core
 ‚î£ üìÇ web
 ‚îÉ ‚î£ üìÇ pages
 ‚îÉ ‚îÉ ‚î£ üìÇ api
 ‚îÉ ‚îÉ ‚îÉ ‚îó üìÇ news
 ‚îÉ ‚îÉ ‚îÉ ‚îÉ ‚îó üìú index.js
 ‚îÉ ‚îÉ ‚î£ üìÇ noticia
 ‚îÉ ‚îÉ ‚îÉ ‚îó üìú [slug].js
 ‚îÉ ‚îÉ ‚îó üìú index.js
```

E tudo o que est√° aqui, s√£o apenas Controllers que usam o que est√° no `core`:

```
üì¶ root
 ‚î£ üìÇ core
 ‚îÉ ‚î£ üìÇ components
 ‚îÉ ‚î£ üìÇ database
 ‚îÉ ‚îÉ ‚î£ üìÇ migrations
 ‚îÉ ‚îÉ ‚îó üìú index.js
 ‚îÉ ‚îó üìÇ models
 ‚îÉ ‚îÉ ‚î£ üìú post.js
 ‚îÉ ‚îÉ ‚îó üìú user.js
 ‚î£ üìÇ web
 ‚îÉ ‚î£ üìÇ pages
 ‚îÉ ‚îÉ ‚î£ üìÇ api
 ‚îÉ ‚îÉ ‚îÉ ‚îó üìÇ news
 ‚îÉ ‚îÉ ‚îÉ ‚îÉ ‚îó üìú index.js
 ‚îÉ ‚îÉ ‚î£ üìÇ noticia
 ‚îÉ ‚îÉ ‚îÉ ‚îó üìú [slug].js
 ‚îÉ ‚îÉ ‚îó üìú index.js
```

E √© nesse ponto que eu acho que fica um pouco impratic√°vel jogarmos **tudo** para o `core`, mesmo sabendo que **Componentes React** n√£o s√£o exclusivos do Next.js... voc√™ pode usar eles em qualquer lugar. Mas ao mesmo tempo, acho pouco produtivo ter que sempre ir no `core` para criar uma p√°gina, um componente, e da√≠ grudar isso no Next.js. Ent√£o minha sugest√£o √© deixar a pasta root do Next.js (`web`) abra√ßar a responsabilidade do que √© React, e usar a estrutura de pastas por feature proposta l√° em cima (e que se beneficia do [custom page extensions](https://nextjs.org/docs/api-reference/next.config.js/custom-page-extensions) e que j√° est√° configurado no projeto).

Ent√£o a pasta `componentes` que est√° dentro do `core` deixa de existir, e se transforma em p√°ginas e componentes dentro da estrutura do Next.js. E se algum dia num futuro maluco chegue a necessidade de sair do Next.js, o `core` fica protegido e se o novo framework usar React n√≥s podemos migrar os componentes, ou se n√£o usar e nem tiver compatibilidade com as rotas da API, `rm -rf web` üòÇ 

## E testes?

N√£o pensei muito al√©m, mas os testes podem estar numa posi√ß√£o global, testando o `core` (mais unit√°rio) ou `web` (mais e2e):

```
üì¶ root
 ‚î£ üìÇ core
 ‚î£ üìÇ web
 ‚î£ üìÇ tests
```

Ou at√© colocar uma pasta de testes dentro do `core`, e outra pasta de testes dentro do `web`, cada uma com sua abordagem e com o seu pr√≥prio setup.

```
üì¶ root
 ‚î£ üìÇ core
 ‚îÉ ‚î£ üìÇ tests
 ‚î£ üìÇ web
 ‚îÉ ‚î£ üìÇ tests
```

Ou at√© "ao lado do arquivo", eu nunca fiz isso, mas acho massa para saber o que tem arquivo de testes, apesar de deixar um pouco mais de ru√≠do nas pastas e ainda assim precisar de pastas num escopo superior para certos utilit√°rios de testes.

```
üì¶ root
 ‚î£ üìÇ core
 ‚îÉ ‚î£ üìÇ models
 ‚îÉ ‚îÉ ‚îó üìú post.js
 ‚îÉ ‚îÉ ‚îó üìú post.test.js
 ‚î£ üìÇ web
```

## E tem mais coisas
Mas como falei, precisava fazer um download desse blob de informa√ß√µes para avalia√ß√£o de voc√™s e o racioc√≠nio inicial que proponho √©: O que eu vou implementar √© algo que poderia ser usado fora do Next.js? Se sim, provavelmente deveria ficar dentro da pasta `core`, se n√£o, deveria ficar dentro da pasta `web`.

E conforme vamos avan√ßando na conversa, vou tamb√©m come√ßar a fazer PRs com as implementa√ß√µes para vermos as ideias se concretizando e entendendo se deu certo ou n√£o.

E por favor, se poss√≠vel, coloquem seus coment√°rios tamb√©m  nesses PRs üëç . E mesmo que algum seja merged, √© software, d√° pra mudar, sempre d√° para mudar, principalmente no est√°gio atual do projeto e o mais importante √© n√£o parar de avan√ßar e ir "vendo com os pr√≥prios olhos" os passos que estamos dando ü§ù

>> Coment√°rio de cezarmezzalira:
Super apoiado essa estrutura! Vamos estudar juntos no curso do Branas e ver o que d√° pra gente mudar, porque estou curioso sobre v√°rios pontos, principalmente o que j√° estamos discutindo na issue #61, que t√° bem interessanteüòÅ

PS: quando tu entrar no grupo do telegram do curso do Branas, tem muita coisa l√° que t√° alinhada com o momento do projeto. O curso veio na hora certa pra mim pelo menos.

>> Coment√°rio de filipedeschamps:
Ahhhh que massaaaa @cezarmzz üòç e sobre o Telegram do curso, caramba s√≥ vi o acesso disso agora üòÇ to entrando l√° üëç

>> Coment√°rio de cezarmezzalira:
Vai ser massa demais! O mango vai fazer o curso tamb√©m! 
Eu t√¥ estudando o curso javascript masterclass e aprendendo muita coisa da linguagem que nem fazia ideia que existia! 
Ser√° um divisor de √°guas esse curso, ainda mais com tanta gente diferente e com as experi√™ncias aqui e l√°, vai ser delicinha üòÇüòÇ

>> Coment√°rio de rodrigoKulb:
Sou novato na utiliza√ß√£o Next.js, n√£o tenho uma opini√£o formada sobre qual a melhor Arquitetura.
Olhando a estrutura sugerida pelo @filipedeschamps achei simples e muito l√≥gica. A final para o servidor n√£o faz diferen√ßa em qual pasta est√° o que. A Arquitetura ser√° 100% para nossa organiza√ß√£o e facilidade nas manuten√ß√µes.
![sem_titulo](https://user-images.githubusercontent.com/5334261/125828797-0f48412e-389a-47a6-9fea-3cb39d8b7549.jpg)
PS. Bora fazer o curso do Branas e ver se podemos alterar algo!

>> Coment√°rio de filipedeschamps:
Pessoal, acho que n√£o vamos conseguir colocar o Next.js para rodar dentro de uma pasta `web`, n√£o sem talvez abrir margem para dor de cabe√ßa. [Tem uma discuss√£o antiga](https://github.com/vercel/next.js/issues/4789#issuecomment-405594382), mas que foi evoluindo e chegou ao ponto de criarem uma [configura√ß√£o](https://nextjs.org/docs/advanced-features/src-directory) para poder colocar dentro da pasta `src` que √© um dos padr√µes adotados em projetos Node.js. Vou pensar mais a respeito e come√ßar a mandar PRs e da√≠ a gente vai vendo como est√° ficando üëç

>> Coment√°rio de marcostaborda:
@filipedeschamps ent√£o, eu estou acompanhando a discuss√£o e  eu acho que teria que ter uma API para o projeto separada do front, para talvez no futuro fazer um app mobile. Dai ficaria uma API Node.js e um Next.js para front-end.

Teriamos que ver dai a arquitetura do back e do front, eu tenho alguns projetos que fiz que utilizei o TDD e SOLID em Node.js e para front utilizei diversas abordagens üòÖ

>> Coment√°rio de brunofamiliar:
@filipedeschamps essa arquitetura parece ser algo bem clean na minha vis√£o. Talvez adicionaria uma pasta de mixins desde o in√≠cio para evitar redund√¢ncia de c√≥digo. S√≥ que lendo [a discuss√£o](https://github.com/vercel/next.js/issues/4789#issuecomment-405594382), observei que eles n√£o tem o intuito de permitir a configura√ß√£o do caminho relativo dos m√≥dulos web; tanto √© que a comunidade criou uma [bifurca√ß√£o](https://github.com/vercel/next.js/discussions/23640) e adicionaram esse suporte ü§îü§î. Ent√£o nesse caso, para seguir a linha que voc√™ prop√¥s, acredito que a melhor forma seria criar a camada do back a parte; por√©m perderia o prop√≥sito de n√≥s juntos sentirmos a "dor" do p√¥rque n√£o utilizar o api routes do nextjs por exemplo. De qualquer forma achei interessante sua abordagem, e vou continuar na pesquisa se √© poss√≠vel contornar esse problema; ou trazer uma sugest√£o üòâ

>> Coment√°rio de filipedeschamps:
> @filipedeschamps ent√£o, eu estou acompanhando a discuss√£o e eu acho que teria que ter uma API para o projeto separada do front, para talvez no futuro fazer um app mobile. Dai ficaria uma API Node.js e um Next.js para front-end.

@marcostaborda show meu caro!!! Muito obrigado pela contribui√ß√£o ü§ù  De fato, o Front e o Back devem estar desacoplados no sentido de que, n√£o √© o back quem _renderiza_ uma p√°gina no Front, ela s√≥ recebe os dados e se renderiza. Como estamos usando Next.js, ganhamos isso dentro do mesmo projeto, ent√£o agora no come√ßo eu vejo ele resolvendo muito bem toda a parte `web/http` e isso inclui as p√°ginas e as rotas da API (que pode e vai ser usada por qualquer outro `client` como a pr√≥pria p√°gina web, aplicativo mobile, aplicativo no command line, etc... √© uma API `http`).

Ent√£o para simplificar, eu altamente sugiro come√ßarmos resolvendo tudo isso no mesmo reposit√≥rio, e ter cuidado total para n√£o desenvolver nossas regras de neg√≥cio dentro dessas camadas üëç

>> Coment√°rio de filipedeschamps:
> @filipedeschamps essa arquitetura parece ser algo bem clean na minha vis√£o. Talvez adicionaria uma pasta de mixins desde o in√≠cio para evitar redund√¢ncia de c√≥digo. S√≥ que lendo [a discuss√£o](https://github.com/vercel/next.js/issues/4789#issuecomment-405594382), observei que eles n√£o tem o intuito de permitir a configura√ß√£o do caminho relativo dos m√≥dulos web; tanto √© que a comunidade criou uma [bifurca√ß√£o](https://github.com/vercel/next.js/discussions/23640) e adicionaram esse suporte ü§îü§î. Ent√£o nesse caso, para seguir a linha que voc√™ prop√¥s, acredito que a melhor forma seria criar a camada do back a parte; por√©m perderia o prop√≥sito de n√≥s juntos sentirmos a "dor" do p√¥rque n√£o utilizar o api routes do nextjs por exemplo. De qualquer forma achei interessante sua abordagem, e vou continuar na pesquisa se √© poss√≠vel contornar esse problema; ou trazer uma sugest√£o üòâ

@brunofamiliar √≥timo coment√°rio e eu vou ser sincero, n√£o sei se nesse momento vale a pena **comprar essa d√≠vida com o Framework** pela simples necessidade de separar arquivos em pastas. As pastas, por mais que ajudem a organizar o projeto, n√£o s√£o mais importantes do que como vamos modelar a aplica√ß√£o.

Ent√£o dado que a gente n√£o vai conseguir organizar de uma forma mais limpa como antes, minha sugest√£o para avan√ßarmos nesse ponto √© ir meio que para o **outro extremo**: vamos deixar o Next.js abra√ßar o projeto, vamos explodir a pasta `core` e fazer o que der o mais pr√≥ximo do `root`. O que acaba se assemelhando bastante com o resultado da soma das propostas feitas pelo @dhanielsales @pscruzzz e @huogerac.

Ent√£o isso aqui √© o come√ßo de um projeto Next.js, correto?

```
üì¶ root
 ‚î£ üìÇ pages        // P√°ginas Web + API
```

Importante notar que hoje o projeto tem uma pasta `css` na raiz, mas como estamos usando o `custom page extensions`, podemos mover para `pages` tudo que √© relacionado a p√°ginas mesmo:

```
üì¶ root
 ‚î£ üìÇ pages
 ‚îÉ ‚î£ üìÇ css      // Arquivos de estiliza√ß√£o
```

E querendo ou n√£o, para arquivos est√°ticos e p√∫blicos, a √∫nica forma padr√£o atualmente fornecida pelo Next.js √© criar uma pasta `public` no `root` do projeto, ent√£o, l√° vai mais uma pasta na raiz:

```
üì¶ root
 ‚î£ üìÇ pages
 ‚î£ üìÇ public        // Arquivos est√°ticos e p√∫blicos, como `robot.txt`
```

O projeto j√° conta com uma pasta de scripts soltos, ent√£o fica aqui ela representada tamb√©m:

```
üì¶ root
 ‚î£ üìÇ pages
 ‚î£ üìÇ public
 ‚î£ üìÇ scripts        // Scripts do tipo que usamos para baixar avatares
```

Os nossos Models ou Entities (at√© hoje n√£o entendo a diferen√ßa, mas estou a caminho de aprender, principalmente a parte de _"use cases"_), podem ficar na raiz tamb√©m para f√°cil acesso (fora que podemos usar os alias do Framework):

```
üì¶ root
 ‚î£ üìÇ pages
 ‚î£ üìÇ public
 ‚î£ üìÇ scripts
 ‚î£ üìÇ models        // Principais regras de neg√≥cio
 ‚îÉ ‚î£ üìú post.js
 ‚îÉ ‚î£ üìú post.test.js
 ‚îÉ ‚î£ üìú user.js
 ‚îÉ ‚îó üìú user.test.js
```

E nota que os testes est√£o junto destas unidades de funcionalidade e sugiro fazer a mesma coisa para o `pages`, mas mesmo assim iremos precisar de alguns utilit√°rios de testes, talvez dados mockados, e que poder√£o ficar numa pasta separada `tests`.

```
üì¶ root
 ‚î£ üìÇ pages
 ‚î£ üìÇ public
 ‚î£ üìÇ scripts
 ‚î£ üìÇ models
 ‚î£ üìÇ tests        // Arquivos auxiliares dos testes
```

De qualquer forma, o assunto **testes** √© algo gigantesco, e muitas vezes vale a pena separar tudo numa pasta `tests` e organizar l√°, pois ao inv√©s de consolidar todos os testes em um √∫nico arquivo, por exemplo `post.test.js`, fica mais completo separar em v√°rios arquivos de teste, e cada um explorando as condi√ß√µes por um √¢ngulo.

Outra pasta importante √© a que vai tocar diretamente em pontos da infraestrutura, como persist√™ncia atrav√©s do conector de um banco de dados, cache atrav√©s do conector de um Redis, Migrations, ou at√© uma pasta para automa√ß√µes da infraestrutura (baseando no que o @huogerac est√° fazendo em outra issue)

```
üì¶ root
 ‚î£ üìÇ pages
 ‚î£ üìÇ public
 ‚î£ üìÇ scripts
 ‚î£ üìÇ models
 ‚î£ üìÇ tests
 ‚î£ üìÇ infra        // Conectores, migra√ß√µes e automa√ß√µes da Infraestrutura
 ‚îÉ ‚î£ üìÇ devops
 ‚îÉ ‚î£ üìÇ migrations
 ‚îÉ ‚îó üìú postgres.js
```

E turma, d√° pra ir jogando esse xadrez e tentando pensar em mais movimentos para frente, mas n√£o sei se vale a pena. Acho que vale a pena irmos concretizando essas coisas e vendo se nossas ideias cabem nessa organiza√ß√£o e ir mudando e sentindo para onde o projeto ir√° nos levar.

## Vota√ß√£o

Ent√£o, para quem teve paci√™ncia e esfor√ßo em ler essa resposta, pe√ßo que fa√ßa seu voto com üëç  para darmos como "encerrado" esse assunto e deixar a realidade do projeto nos guiar, ou vote com üëé  e responda a issue com sua sugest√£o e que ser√° muito bem vinda ü§ù ü§ù ü§ù ü§ù

>> Coment√°rio de marcostaborda:
Vi um artigo do medium, n√£o sei se ajuda, mas tem uma configura√ß√£o para reescrever algo dentro do Next.js.

https://medium.com/geekculture/how-to-use-nodejs-backend-for-your-next-js-project-or-both-b36d9dc9ab0a
</issue_12_Proposta de Arquitetura>

<issue_14_RSS>
Pessoa, com o intuito de conquistar mais notabilidade, tenho como proposta a cria√ß√£o de um gerador para RSS. 
Pode parecer um pouco defasado esta tecnologia, mas existem sites e apps que tem uma not√°vel contribui√ß√£o para que esta tecnologia continue funcionando. Como o [Feddly](https://feedly.com/i/my), [Inoreader.](https://www.inoreader.com/), e por ai vai.
Com os seus feedbacks, eu posso vir com uma proposta atrav√©s de um pull request. 
#KISS

>> Coment√°rio de SysDaemon:
Pessoal, acabei de ver que o reposit√≥rio do @filipedeschamps  tem o [RSS Feed Emitter](https://github.com/filipedeschamps/rss-feed-emitter), achei super bacana. Tamb√©m √© uma boa op√ß√£o para integrar o TabNews nele.

>> Coment√°rio de brunofamiliar:
@SysDaemon ia dar essa sugest√£o tamb√©m. Eu tinha notado esse projeto que o @filipedeschamps criou, pode ser uma boa integra-lo, mas acredito que n√£o misturado com os conte√∫dos que os usu√°rios do tabnews v√£o gerar. As vezes poderia ter uma se√ß√£o do site que liste outras fontes de not√≠cias.

>> Coment√°rio de filipedeschamps:
Show @SysDaemon tem que ter RSS sim ü§ù ali√°s, se n√£o tiver o @gustavodeschamps vai ficar super desapontado, ele √© o maior f√£ de RSS do mundo üòÇ 

E sim, o ```rss-feed-emitter``` tem um outro objetivo, que no caso seria o consumidor desse feed, e o TabNews o fornecedor üëç 

J√° tomei nota da requisi√ß√£o para colocar no roadmap üëç

>> Coment√°rio de filipedeschamps:
E @SysDaemon quando tivermos o backend mais estruturado, seria uma honra receber um PR seu trazendo esse recurso üëç

>> Coment√°rio de SysDaemon:
Ser√° um prazer enorme.

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù
</issue_14_RSS>

<issue_15_Op√ß√£o para compartilhar / share as news>
Vendo o layout n√£o localizei a op√ß√£o para compartilhar nas Rede Social (sugest√£o: linkedin, twitter, facebook), podendo incluir tamb√©m a op√ß√£o de salvar para ler depois.

>> Coment√°rio de brunofamiliar:
Concordo, isso seria interessante. As vezes, daria at√© pra identificar se existe algum usu√°rio logado ao copiar esse link de compartilhamento, dessa forma o usu√°rio da rede ganha pontos de experi√™ncia / tabcoins por cada indica√ß√£o/compartilhamento que ele realizar em suas redes.

>> Coment√°rio de filipedeschamps:
Show de bola, tem que ter mesmo üëç inclusive j√° tomei nota aqui para encaixar no roadmap ü§ù

>> Coment√°rio de rodrigoKulb:
Show!
</issue_15_Op√ß√£o para compartilhar / share as news>

<issue_17_RFC: Marcos hist√≥ricos do projeto (Milestones)>
Pessoal, fiz um rascunho das Milestones (Marcos Hist√≥ricos) do TabNews para cadastrar aqui no Github e come√ßar a organizar as issues. Com isso vamos ter uma no√ß√£o de progresso do projeto e **nada** disso est√° escrito em pedra, inclusive preciso de **muita** ajuda, pois faz tempo que n√£o organizo um projeto dessa natureza. E com certeza quanto mais avan√ßarmos nas tarefas, mais s√£o reveladas e mais precis√£o vamos tendo ao longo do caminho.

Mas por enquanto, o jeito que organizei foi MPVs funcionais, onde de pouco em pouco vamos comemorando as conquistas e chegando nas features extras e algumas delas n√£o precisam ser executadas nessa ordem que eu coloquei (principalmente as que est√£o na Milestone 6, podem ser antecipadas sem problemas üëç )

### Milestone 0: Em constru√ß√£o
- Merge ou Close dos PRs sobre POCs ainda em aberto
- Home cl√°ssica "em constru√ß√£o" com foto de todo mundo que quiser aparecer nesse momento hist√≥rico do projeto üòç 
- Colocar em produ√ß√£o no dom√≠nio tabnews.com.br

### Milestone 1: Funda√ß√£o
- Manuten√ß√£o das issues (quais fechar?)
- Tipo da Licen√ßa
- Falar sobre Arquitetura e definir padr√£o de pastas
- Definir padr√£o de commits/linter
- Definir padr√£o de code style/linter/code formatter
- Conex√£o com banco de dados
- Migration
- Rodar testes local e CI

### Milestone 2: Auth e Usu√°rios
- Separar entradas do Di√°rio em arquivos isolados
- Atualizar README com instru√ß√µes sobre como instalar, rodar ou testar o projeto (incluindo usando `act`)
- Avaliar transformar o Database em um Singleton para reutiliza√ß√£o do Pool
- Criar um `.prettierrc`
- Remover do package.json o "test:ci" e mover para Action
- Definir quem ser√° o "Guia de Acessibilidade"
- Padr√£o nos controllers usando `next-connect`
- Padr√£o de retorno das APIs (Dados e Erros)
- Sistema de Autentica√ß√£o
- Sistema de Autoriza√ß√£o (ACL)
- CRUD de Usu√°rios

### Milestone 3: Not√≠cias e Coment√°rios
- CRUD de Not√≠cias
- L√≥gica de ordena√ß√£o das Not√≠cias V1: pela mais recente (e mais nada)
- CRUD de Coment√°rios e sub-coment√°rios
- P√°gina de Status mostrando todos os n√∫meros do projeto

### Milestone 4: TabCoins
- Sistema de TabCoins
- Sistema de Auditoria
- L√≥gica de ordena√ß√£o das Not√≠cias V2: (TabCoins - Tempo de Publica√ß√£o)

### Milestone 5: XP (ou outro modelo)
- Sistema de XP

### Milestone 6: Revenue Share
- Sistema de Revenue Share

### Milestone 7: Recursos Cereja do Bolo
- @pscruzzz - DarkMode
- @SysDaemon - RSS
- @rodrigoKulb - Bot√£o de compartilhar not√≠cia em redes sociais
- @brunofamiliar - Extens√£o para Navegador (j√° fez PR)
- @luantoningalvan - text-to-speech
- @LuanEdCosta - Integra√ß√£o com Unsplash
- @lucasbaccan - PWA
- Atualiza√ß√µes em tempo-real

# Considera√ß√µes
- Tudo pode mudar (e vai mudar üòÇ )
- Itens podem ser antecipados, por exemplo os que est√£o na Milestone 6

>> Coment√°rio de wcarugatti:
P√¥, uma **livezinha** s√≥ de pontap√© inicial cairia bem pra discutir o Milestone 0, definir arquitetura, quais libs usar e etc. O que acha @filipedeschamps ?

Porque tem muita coisa pra discutir/decidir como: Qual vai ser a estrutura/modelagem do banco? o back vai ser s√≥ o nextjs na vercel + o banco de dados ou vai ter um/varios servidores nodejs? Vai usar cloud pra alguma coisa? J√° cogitou serverless? O auth vai usar JWT ou Oauth2? Entre outras perguntas que eu me fa√ßo.

>> Coment√°rio de SysDaemon:
Concordo. 
Talvez um brainstorm para definirmos o back e estrutura do projeto.
√â com um prazer enorme que vou participar de um projeto como esse.
Ultimamente, estou estudando spring boot para back, mas sou suspeito de falar. 
Vamos que vamos pessoal. Estou muito crente que todos n√≥s gostar√≠amos de ver esse projeto sendo o maior portal de not√≠cias de tecnologia do Brasil. 
Estou MUITO empolgado.

**Edit1:** Como eu estou DBA (SQL Server), e desenvolvedor em BD no momento, creio que serei √∫til na parte dos desenvolvimento das queries e/ou no banco em si.

>> Coment√°rio de filipedeschamps:
Show @wcarugatti eu topo live sim! Tinha at√© comentado que seria legal fazer lives, quem sabe nessa sexta? Em paralelo tava pensando aqui, uma coisa que lives podem atrapalhar √© que nem sempre vai casar com a agenda de todo mundo, ser√° a mesma dificuldade de marcar uma reuni√£o com muita gente e isso com certeza vai trancar um pouco o progresso do projeto.

Ent√£o talvez o ideal seria conseguir ir resolvendo e propondo as coisas aqui pelo Github mesmo, de forma ass√≠ncrona, acompanhando o projeto, do que depender de lives. Talvez uma live seria legal para explicar o que foi decidido, ou quase decidido.

E no di√°rio que est√° no README do projeto e tamb√©m [nesse v√≠deo dos membros](https://www.youtube.com/watch?v=8Rx-TSLbN-Q) eu dou uma pincelada nas prov√°veis tecnologias üëç

>> Coment√°rio de filipedeschamps:
> **Edit1:** Como eu estou DBA (SQL Server), e desenvolvedor em BD no momento, creio que serei √∫til na parte dos desenvolvimento das queries e/ou no banco em si.

@SysDaemon que show!!! Vai ser de grande ajuda com certeza üòç

>> Coment√°rio de wcarugatti:
@filipedeschamps concordo 100% que n√£o da pra depender de live, mas uma s√≥ pra dar esse empurr√£o inicial seria interessante, to vendo eu e uma galera levemente perdidos em como contribuir por conta dessas quest√µes que eu citei anteriormente. 

Acredito que seja esse o motivo pelo qual o milestone 6 est√° cheio de ideias da galera que foram surgindo nas issues que s√£o √≥timas por√©m tangenciam um pouco o core do projeto indo um pouco na dire√ß√£o oposta ao kiss eu diria. 

(Novamente, s√£o ideias √≥timas, por√©m justamente para uma fase 6 do projeto)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps voc√™ acha que vale acrescentar no Milestone 1: Auth, Usu√°rios e Not√≠cias

-  CRUD de Not√≠cias
- a) L√≥gica sobre a ordena√ß√£o das Not√≠cias ?

>> Coment√°rio de filipedeschamps:
@wcarugatti show, vamos fazer uma live sim üòç bora ent√£o fazer nessa sexta ü§ù 

> @filipedeschamps voc√™ acha que vale acrescentar no Milestone 1: Auth, Usu√°rios e Not√≠cias
> 
> * CRUD de Not√≠cias
> * a) L√≥gica sobre a ordena√ß√£o das Not√≠cias ?

E @rodrigoKulb total! Vejo que na verdade vamos precisar fazer duas vers√µes dessa l√≥gica:
- V1: Ordenar pela mais recente (e mais nada)
- V2: Com as TabCoins implementadas na Milestone 3, fazer a vers√£o final

O que acha?

>> Coment√°rio de brunofamiliar:
@filipedeschamps , acha que num seria interessante ter um bot√£o para que a comunidade doe recursos financeiros para o site? Acredito que, se o projeto agregar valor para seus usu√°rios, concerteza seria uma forma de garantir um renda passiva para a manuten√ß√£o da plataforma.

>> Coment√°rio de rodrigoKulb:
> @filipedeschamps , acha que num seria interessante ter um bot√£o para que a comunidade doe recursos financeiros...

@brunofamiliar nunca foi muito fan do bot√£o doa√ß√£o, vemos o exemplo do wikipedia sempre precisando de recursos para n√£o sair do ar. Ainda acredito que o ideal seria abrir um espa√ßo exclusivo para publicidade paga, com certeza teriam grandes empresas querendo colocar sua marca l√°! Mas ai √© com o @filipedeschamps haha!

>> Coment√°rio de filipedeschamps:
@rodrigoKulb inseri nas milestones a V1 e V2 do algoritmo de ordena√ß√£o de not√≠cias ü§ù  e a gente pode obviamente ir criando outros algoritmos conforme o comportamento do ecossistema.

E aproveitei para separar a Milestone 0 em duas, pois eu realmente acredito que cada milestone deve ser uma comemora√ß√£o. A gente devia inclusive comemorar em live cada conclus√£o de milestone, e colocando a √∫ltima feature em produ√ß√£o e marcando a issue em quest√£o como Done, na live digo. Seria bem emocionante üòÇ

>> Coment√°rio de filipedeschamps:
@brunofamiliar show! Se voc√™ analisar, isso est√° acontecendo pelo `üëë Membros` de forma indireta, correto? üòÇ üëç  e sobre se sustentar, do meu lado eu aposto naquela parte **residual** dos an√∫ncios, porque a maioria deles deve precisar sustentar quem cria conte√∫do com valor concreto (seja por not√≠cias ou coment√°rios). E esta √∫ltima parte que falei √© a mais importante, por isso que no come√ßo nem eu, nem o @gustavodeschamps , vamos estar acima do sistema, vamos participar normalmente do revenue share como todo mundo, e somente quando isso funcionar pra todo mundo que a gente pensa no modelo residual, por exemplo `20%` da probabilidade de aparecer algo que a gente escolher, e os `80%` s√£o da comunidade.

N√£o tem como inverter essa ordem e eu ficaria **MUITO** feliz em criar um ecossistema para criadores/participante brasileiros conseguirem colocar seus pr√≥prios an√∫ncios, seja de cursos afiliados, seus projetinhos, reposit√≥rios no github, seu curr√≠culo, etc. Daria um tom realmente muito especial ao site todo ver que os an√∫ncios s√£o nossos e n√£o de empresas (n√£o que elas n√£o possam participar, elas podem se finalizarem o fluxo de contribui√ß√£o).

E @rodrigoKulb eu tenho certeza absoluta que tem grandes empresas que iriam anunciar, inclusive eu j√° tenho em queue empresas que me deram um cheque em branco pra participar de qualquer projeto que eu fizer, mas isso n√£o me deixa mais feliz. Sabe o que realmente me deixa feliz? Ver a turma gerando conte√∫do com valor concreto e sendo valorizada por isso. Isso √© infinitamente muito mais massa na minha cabe√ßa. √â muito mais dif√≠cil, e √© por isso que √© muito mais massa.

Agora, como falei num dos v√≠deos do canal, eu sim me preocupo na viabilidade financeira das coisas e se patroc√≠nio for a √∫nica forma, eu entendo. N√£o quero banir empresas, ainda mais se encontrarmos um modelo n√£o tradicional e que beneficie o ecossistema, mas que vai ser zero o foco agora... agora o foco √© na gente dar certo ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps sim com certeza! O √∫nico "custo real" do projeto, seria a infra n√£o fa√ßo ideia de custo necess√°rio para um projeto corporativo desse porte na Vercel. Esse realmente seria um investimento necess√°rio quando chegar no limite do tr√°fico gratuito. Ou procurar algum parceiro de infra.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show! Eu especulo que o maior custo vai ser DB, uma vez que um dos princ√≠pios que quero adotar para o tabnews √© ele ser 99% static pages.

>> Coment√°rio de brunofamiliar:
Aaata, perfeito! Sugeri essa forma apenas como uma alternativa de captar recursos para a plataforma, ou at√© para projetos futuros, sem comprometer 100% outras fontes. Poderia ser at√© interessante usar essas doa√ß√µes como forma de promover uma competi√ß√£o saud√°vel na rede e incentivar os principais produtores de conte√∫do kk. Mas entendo que hoje o pr√≥posito tabnews n√£o √© seguir por essa linha üòâ

>> Coment√°rio de filipedeschamps:
Show! E lendo sua mensagem de fato daria para fazer algo legal com algum parceiro, fazer algo diferente e conseguir distribuir isso pelos pesos do Revenue Share üëç

>> Coment√°rio de tiagovilasboas:
@filipedeschamps primeiramente muito obrigado por permitir minha participa√ß√£o nesse projeto (acabo de chegar), lendo a conversa acima de voc√™s sobre os an√∫ncios eu tenho uma dica que gostaria de complementar ao projeto:

- Se tratando de an√∫ncios, acredito que podemos considerar depois do lan√ßamento do mvp, o uso de alguma ferramenta para coletarmos m√©tricas do site, pois com as m√©tricas necess√°rias podemos executar testes A/B para melhorarmos a rentabilidade e convers√£o dos an√∫ncios e at√© da experi√™ncia do usu√°rio. Comento isso porque tenho cases de sucesso sobre isso no meu projeto atual e gostaria de colaborar com minha experi√™ncia aqui tamb√©m. ;) O que voc√™ acha?

>> Coment√°rio de francopan:
> @filipedeschamps primeiramente muito obrigado por permitir minha participa√ß√£o nesse projeto (acabo de chegar), lendo a conversa acima de voc√™s sobre os an√∫ncios eu tenho uma dica que gostaria de complementar ao projeto:
> 
> - Se tratando de an√∫ncios, acredito que podemos considerar depois do lan√ßamento do mvp, o uso de alguma ferramenta para coletarmos m√©tricas do site, pois com as m√©tricas necess√°rias podemos executar testes A/B para melhorarmos a rentabilidade e convers√£o dos an√∫ncios e at√© da experi√™ncia do usu√°rio. Comento isso porque tenho cases de sucesso sobre isso no meu projeto atual e gostaria de colaborar com minha experi√™ncia aqui tamb√©m. ;) O que voc√™ acha?

@tiagovilasboas Agora fa√ßo uma provoca√ß√£o...precisa mesmo? Considerando a proposta do site e o modelo adotado?
 A web est√° se tornando um lugar hostil para os usu√°rios com pixels de rastreamento, cookies, fingerprinting,... Ser√° que por o site dizer que o foco est√° no usu√°rio n√£o seria interessante que seu comportamento demonstre isso, evitando o uso de rastreadores sempre que poss√≠vel?

>> Coment√°rio de filipedeschamps:
> Se tratando de an√∫ncios, acredito que podemos considerar depois do lan√ßamento do mvp, o uso de alguma ferramenta para coletarmos m√©tricas do site, pois com as m√©tricas necess√°rias podemos executar testes A/B para melhorarmos a rentabilidade e convers√£o dos an√∫ncios e at√© da experi√™ncia do usu√°rio. Comento isso porque tenho cases de sucesso sobre isso no meu projeto atual e gostaria de colaborar com minha experi√™ncia aqui tamb√©m. ;) O que voc√™ acha?

@tiagovilasboas eu acho uma ideia excelente fazer testes A/B para entender o que funciona melhor, e **muito** obrigado a se disponibilizar a ajudar nisso. Avan√ßando mais no projeto, iremos saber como encaixar isso nas milestones. E um detalhe importante √© que eu pessoalmente n√£o gosto √© quando acaba sendo feito o tracking individual dos usu√°rios, ou √© enviado esses tipos de dados para plataformas terceiras. Uma coisa que esse site **n√£o pode ter** √© aqueles banners de cookies terceiros üëç  como podemos fazer isso?

> @tiagovilasboas Agora fa√ßo uma provoca√ß√£o...precisa mesmo? Considerando a proposta do site e o modelo adotado?
> A web est√° se tornando um lugar hostil para os usu√°rios com pixels de rastreamento, cookies, fingerprinting,... Ser√° que por o site dizer que o foco est√° no usu√°rio n√£o seria interessante que seu comportamento demonstre isso, evitando o uso de rastreadores sempre que poss√≠vel?

@francopan excelente provoca√ß√£o e concordo com ela, tanto que destaquei minhas preocupa√ß√µes acima. Ent√£o refor√ßo aqui: eu gosto da ideia de entender o que funciona melhor, e n√£o gosto da ideia de rastreamento individual e cookies terceiros.

Essa solu√ß√£o aqui parece ser interessante: https://umami.is/

>> Coment√°rio de brunofamiliar:
@filipedeschamps s√≥ para contribuir com esse tema de analytics, hoje uso um sistema open source para alguns servi√ßos meus, √© v√°lido tamb√©m para esse contexto https://matomo.org/

>> Coment√°rio de huogerac:
Oi pessoal,
Pensando na [pr√≥xima milestone - 1 Funda√ß√£o ](https://github.com/filipedeschamps/tabnews.com.br/milestone/2), oq voces acham de discutir os assuntos atrav√©s destas issues aqui:
- [Arquitetura](https://github.com/filipedeschamps/tabnews.com.br/issues/12)
- [Linter/code style](https://github.com/filipedeschamps/tabnews.com.br/issues/60)
- [Banco e migrations](https://github.com/filipedeschamps/tabnews.com.br/issues/61)
- [Padr√µes de commits](https://github.com/filipedeschamps/tabnews.com.br/issues/42)
- [Testes e CI](https://github.com/filipedeschamps/tabnews.com.br/issues/62)

>> Coment√°rio de filipedeschamps:
@huogerac muito obrigado pela ajuda, matou a pau e j√° deixou essa parte pronta para Live amanh√£ üòç 

Em paralelo, adicionei **dois novos itens** ali no topo que s√£o importantes:

- Manuten√ß√£o das issues (quais fechar?)
Isso para n√£o perdermos controle sobre a quantidade de issue aberta.

- Tipo da Licen√ßa
Depois da bagun√ßa causada pelo Github Copilot, vamos entender se estamos com a licen√ßa certa.

Vou criar essas issues e atrelar¬†√† milestone tamb√©m üëç

>> Coment√°rio de filipedeschamps:
Essa semana me veio uma ideia que acho importante puxarmos cedo no projeto, que √© uma **p√°gina p√∫blica** mostrando todos os n√∫meros do site, e isso engloba a quantidade de views, usu√°rios cadastrados, conte√∫dos criados, coment√°rios, contribui√ß√µes e tamb√©m o status do servi√ßo ou qualquer outra m√©trica que seja interessante acompanharmos.

Isso vai ser extremamente importante para visualizarmos o progresso concreto do projeto, ainda mais se conseguirmos plotar um gr√°fico hist√≥rico. Ent√£o alterei a Milestone 3 para isso:

### Milestone 3: Coment√°rios e Status
- CRUD de Coment√°rios e sub-coment√°rios
- P√°gina de Status mostrando todos os n√∫meros do projeto

Garanto que vai ser bastante animador para todos acompanharmos essas m√©tricas evoluindo ao longo do tempo e ao longo das implementa√ß√µes que iremos fazendo üëç

>> Coment√°rio de filipedeschamps:
Como reflexo da issue #43, eu editei a Milestone 2 para definirmos um Guia no assunto acessibilidade, ficou assim:

### Milestone 2: Auth, Usu√°rios e Not√≠cias
- Definir quem ser√° o "Guia de Acessibilidade"

O timing desse assunto nessa Milestone em quest√£o √© √≥timo, pois vai ser a primeira vez que iremos devolver conte√∫dos com valor concreto para internet üëç

>> Coment√°rio de filipedeschamps:
Adicionei na Milestone 2 o seguinte item:

### Milestone 2: Auth, Usu√°rios e Not√≠cias
- Padr√£o de retorno das APIs (Dados e Erros)

>> Coment√°rio de huogerac:
Fala pessoal,

**Pensando na Milestone 2**, o que voces acham se a gente tentar alguns dos itens abaixo? isto se fizer sentido para aumentar ainda mais a colabora√ßao:

- **Criar labels para as Issues** (talvez seguindo o mesmo padrao de commits do cz), desta forma, sabemos se a issue √© uma nova funcionalidade, melhoria, bugfix, documentacao, UX, RFC, d√©bito t√©cnico
- **Tentar criar Issues mais at√¥micas**, ou seja, tentar dividir as tarefas em unidades um pouco menores de trabalho.Desta forma, alem de contribuir para ajudar na descricao da tarefa (oq muita vezes nao √© facil), pode tambem ajudar a ter mais pessoas contribuindo na tarefa macro, ou seja, enquanto uma pessoa faz o cadastro, outra faz o atualizar em um 'CRUD'.
- **Usar a ordena√ß√£o nas issues para indicar prioridade**, ao filtrar por milestones, o GH permite mudar a ordem das issues, isto pode ajudar a deixar mais explic√≠to as tarefas que podem ser executadas primeiro
- **Adicionar o que faz a issue ser conclu√≠da (DONE)**, talvez ao tentar descrever oq precisa ser feito para concluir a tarefa, podemos chegar na conclusao que tem muita coisa dentro de uma √∫nica issue, oq pode ajudar a quebrar em tarefas menores (item 2), ou as vezes o inverso acontece, uma descricao destes pontos ajuda a tornar mais proximo do codigo, em outras palavras, as vezes s√≥ titulo pode parecer que √© mais dif√≠cil de fazer que parece...

>> Coment√°rio de filipedeschamps:
Sensacionaaaaal @huogerac !!!

1. **Labels:** interessant√≠ssimo, talvez a gente poderia separar pelo interesse das pessoas em `frontend`, `backend` ou `infra` de in√≠cio. Pois da√≠ a pessoa pode filtrar pelo o que ela tem mais experi√™ncia, o que acha?
2. **Issues at√¥micas:** perfeito! Nessa Milestone ainda mais do que nunca √© preciso fazer isso de fato üëç 
3. **Ordena√ß√£o nas issues:** nossa eu n√£o sabia disso, vou investigar e fazer, que show!!! üëç 
4. **Done**: sensacional, vou fazer!!!! üòç

>> Coment√°rio de huogerac:
Legal @filipedeschamps 

Dai seguindo esta linha das Issues na Milestone 2, queria ver o que voces acham se fosse possivel criar tarefas seguindo um caso de uso que gere valor para o neg√≥cio (imagine que o cliente quer ver algo), exemplo:

> "Como membro, eu gostaria de poder cadastrar uma Not√≠cia (mesmo que via POST na API diretamente) e assim qualquer visitante consiga v√™-la na p√°gina do tabnews (listagem ordenada por mais recentes)".

Se a gente conseguisse listar todas tarefas para concluir este caso de uso, talvez na primeira vers√£o, totalmente sem controle de permiss√£o, olha quanta discuss√£o saud√°vel poderia surgir, desde detalhes da p√°gina da listagem, qual poc vai ser utilizado, detalhes de usuabilidade/acessibilidade at√© campos da API e do model.
D√∫vidas de neg√≥cio, por exemplo, um usu√°rio vai poder apagar uma not√≠cia? alter√°-la?

Sem falar que poderiamos ter contribui√ß√µes de frontend e backend ao mesmo tempo.
Imagina que com varios membros criando Tabnews, podemos identificar que API deveria ter pagina√ß√£o ou sei l√° que pode surgir...

Paralelo a isto, daria para ir tocando a parte de autentica√ß√£o/autoriza√ß√£o que envolve mais pesquisa. E quando tudo estiver rodando mais "seguro", dai podemos limpar a base e iniciar novamente

>> Coment√°rio de filipedeschamps:
Interessant√≠ssimo @huogerac eu sou p√©ssimo com essas descri√ß√µes, mas vou aproveitar para treinar üòÇ 

Ent√£o vou juntar esse tipo de descri√ß√£o, com a sugest√£o das issues at√¥micas, pois da√≠ eu quero tentar colocar elas numa ordem de depend√™ncia. E adorei sua sugest√£o de primeiro fazer a API sem precisar de credencial, pois isso gera dados para o frontend poder trabalhar melhor ü§ù

>> Coment√°rio de sr2ds:
@filipedeschamps j√° temos em algum lugar um TODO LIST?
Se tivermos um todo list com as features que j√° est√£o na sua cabe√ßa e algum resumo de como voc√™ est√° pensando, podemos contribuir programando no ritmo das suas id√©ias. Algo como o trello ou at√© um kanban aqui mesmo.

>> Coment√°rio de filipedeschamps:
Fala @sr2ds ! O controle est√° sendo feito atrav√©s das Milestones, olha s√≥:

Milestones que j√° foram completadas (abra cada uma para ver as issues): https://github.com/filipedeschamps/tabnews.com.br/milestones?direction=asc&sort=title&state=closed

Milestones que ainda n√£o foram detalhadas nem abertas: https://github.com/filipedeschamps/tabnews.com.br/milestones?direction=asc&sort=title&state=open

>> Coment√°rio de rodrigoKulb:
@filipedeschamps bom dia! Esse escopo est√° 100% atualizado?

>> Coment√°rio de filipedeschamps:
0% atualizado üòÇ  vou fechar a issue por enquanto, pois estamos sempre fazendo uma vers√£o mais atualizada no draft da milestone que est√° rodando de fato ü§ù
</issue_17_RFC: Marcos hist√≥ricos do projeto (Milestones)>

<issue_19_Revenue Share - L√≥gica>
Sei que n√£o √© algo que ser√° definido agora no inicio do projeto, mas j√° gostaria de abrir o assunto para come√ßar a lapidar a l√≥gica e ferramentas que vamos utilizar.

Estou estudando algumas grandes sacadas do Google, e a _principal_ alavanca para o sucesso dos an√∫ncios foi a exibi√ß√£o personalizada por "categoria" das buscas efetuadas.

Acredito que podemos seguir a mesma l√≥gica para o Revenue Share, Se o usu√°rio clicar em uma noticia sobre Bitcoin, dar prioridade para exibi√ß√£o de "An√∫ncios" sobre o assunto: cursos, v√≠deos. Desta forma teremos mais sucesso em visitas para os "parceiros".

**Sugest√£o de como fazer:**
01 - Criar palavras-chaves quando um usu√°rio criar um Revenue Share, com um certo limite parecido com o Youtube.
02 - Procurar as palavras dentro das noticias e apresentar os Revenue com similaridade sobre assunto.

>> Coment√°rio de brunofamiliar:
Bom tema pra n√≥s debater =). S√≥ ressaltando, devemos tamb√©m levar em conta al√©m desses dois pontos √© o 'leil√£o', al√©m de atender essas pontos que voc√™ destacou, um crit√©rio de desempate em rela√ß√£o a relev√™ncia dos Revenues seria o valor que √© ofertado para a disponibiliza√ß√£o do espa√ßo; no caso at√© onde entendi, o valor considerado seria os pontos de experi√™ncia certo!?

>> Coment√°rio de rodrigoKulb:
> devemos tamb√©m levar em conta al√©m desses dois pontos √© o 'leil√£o',

Exatamente @brunofamiliar faltou colocar o crit√©rio de desempate:

**Crit√©rios para exibi√ß√£o do Revenue Share**
01 - Similaridade com o conte√∫do exibido.
02 - Sistema de Desempate, por XP (ainda em estudo no #11)

>> Coment√°rio de filipedeschamps:
Show @rodrigoKulb muito legal! Isso poderia casar com um incentivo de que, se a pessoa preencher keywords ao criar um conte√∫do, ela ganha mais tabcoins. E agora esse conte√∫do pode ter esse cruzamento.

E a gente com certeza deveria ter a mesma abordagem de V1, V2, dos algoritmos e ir refinando.

>> Coment√°rio de rodrigoKulb:
Olhando a News de hoje, vejo que a publicidade fica no mesmo layout que as not√≠cias, o Google atualmente faz isso com os links patrocinados. Acredito que podemos seguir o mesmo padr√£o para o _Revenue Share_, o que acham?

**Exemplo:**
![img](https://raw.githubusercontent.com/rodrigoKulb/rodrigoKulb/main/Captura%20de%20tela%20em%202021-06-11%2011-11-27.png)

>> Coment√°rio de filipedeschamps:
Acho massa @rodrigoKulb eu prefiro muito mais an√∫ncio integrado, do que um an√∫ncio que pisca, se mexe e atrapalha aten√ß√£o da leitura üëç

>> Coment√°rio de danwhat:
Como a gente vai debater sobre o Revenue Share, eu queria levantar um ponto que n√£o ficou muito claro para mim.

> E algo extremamente importante de deixar expl√≠cito, √© que com isso empresas n√£o v√£o poder comprar an√∫ncios dentro do site. Se elas quiserem ter um espa√ßo, v√£o precisar participar do fluxo completo de contribui√ß√£o.

Eu entendo a ideia de "n√£o ser apenas mais um site com o mesmo modelo de neg√≥cio que os outros.", mas um ponto negativo disso √© que cada criador ter√° que ter seus pr√≥prios produtos ou procurar seus pr√≥prios anunciantes. E isso me preocupa.

Provavelmente essa ideia j√° passou na cabe√ßa de voc√™s, mas e se os an√∫ncios pudessem ser comprados pelo site e o valor gerado fosse dividido entre os criadores, a equipe do site (respons√°vel justamente por manter esse sistema), e os custos do servidor?

Poderia ter uma equipe que fizesse o papel do "google" no TabNews: gerenciando o leil√£o que a gente tanto fala, filtrando anunciantes fora do perfil do TabNews e outros detalhes necess√°rios. Eu falo isso pois acho muito dif√≠cil a gente criar um sistema que n√£o precise de uma equipe gerenciando.

E essas ideias n√£o s√£o mutuamente excludentes. Al√©m dessa equipe, pode ter uma facilidade consider√°vel para os produtores que querem trazer seus pr√≥prios anunciantes eu divulgar os seus pr√≥prios produtos.

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù
</issue_19_Revenue Share - L√≥gica>

<issue_23_Ideias para p√°gina de "Em constru√ß√£o">
Gostaria de usar essa issue para propor a discuss√£o acerca da p√°gina "Em constru√ß√£o"

Eu tive uma ideia interessante.
Uma ilustra√ß√£o [Parallax](https://en.wikipedia.org/wiki/Parallax_scrolling) com pessoas trabalhando (desenhos) e na cara de cada pessoa ficaria o avatar de quem participa. Ao passar o mouse pelo avatar pausa a anima√ß√£o e aparece o nome com o link do github.

Isso ficaria ocupando 1/3 da tela na parte de baixo e o restante acima um texto com os dizeres "Em constru√ß√£o" e algum subt√≠tulo

Exemplo de um site usando um fundo que eu imagino: 
[https://www.drugtreatment.com/](https://www.drugtreatment.com/)

>> Coment√°rio de rodrigoKulb:
@luantoningalvan acho bem legal, uma outra ideia √© colocar um campo para cadastrar na newsletter do @filipedeschamps nessa p√°gina avisando que receber√° um aviso assim que o site subir!

>> Coment√°rio de filipedeschamps:
Show de bola @luantoningalvan ! Permiss√£o: alterar o t√≠tulo da sua issue para `Ideias para p√°gina de "Em constru√ß√£o"` pois gostaria de fazer refer√™ncia dela na milestone üëç

>> Coment√°rio de luantoningalvan:
Poder√≠amos usar imagens do freepik https://www.freepik.com/search?dates=any&format=search&page=1&query=builders&sort=popular&type=vector

depois bastaria registrar as coordenadas de cada imagem para inserir o rosto e exibir-las de forma rand√¥mica

>> Coment√°rio de filipedeschamps:
@luantoningalvan que r√°pido üòÇ ü§ù üëç 

Minha sugest√£o: uma p√°gina simples, com um backgroud de [blueprint pattern](https://www.google.com/search?q=blueprint+pattern) e em cima escrito TabNews e que estamos em constru√ß√£o. Abaixo colocar as fotos e elas serem organizadas usando [algo como aquele estilo de organizar as fotos do Pinterest](https://www.kindacode.com/article/reactjs-code-an-image-portfolio-gallery-like-pinterest/)

>> Coment√°rio de rodrigoKulb:
Nossa bem legal, a ideia √© ficar alterando as imagens de constru√ß√£o com os rostos da galera?
![4886718](https://user-images.githubusercontent.com/5334261/121940228-3bc1b780-cd24-11eb-9819-5da0e82e709e.jpg)

>> Coment√°rio de rodrigoKulb:
Acho legal a ideia de colocar n√∫meros e etapas conclu√≠das: 

![Captura de tela em 2021-06-14 17-24-01](https://user-images.githubusercontent.com/5334261/121954682-6d8f4a00-cd35-11eb-9683-1e1eb381e3db.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show!!!

Sobre as stats, como essa p√°gina vai ter um tempo curto de vida, n√£o sei se para ela seria interessante, **mas** lembra que num v√≠deo comentei que gostaria de fazer uma p√°gina /sobre ou /stats pra mostrar as estat√≠sticas do site e enternizar l√° quem contribuiu? A√≠ seria massa üëç 

J√° essa de "Em constru√ß√£o" vai ficar no ar s√≥ at√© a Milestone 1 üëç  *[edit] Milestone 2*

>> Coment√°rio de filipedeschamps:
**Outra ideia que tive:** para conseguir caber **todo mundo** num mesmo print hist√≥rico, aproveitar a ideia de extrair s√≥ o rosto das pessoas (em formato de bolinha) e fazer todos esses rostos preencherem a p√°gina. A gente pode preencher de v√°rias formas:

1. Pattern circular do centro para fora
2. Simula√ß√£o f√≠sica, das bolinhas caindo para a base da p√°gina
3. Um pattern rand√¥mico, mas que cada bolinha/rosto seja um *node* elas ficam conectadas entre s√≠.

Em resumo: fazer um formato que, em apenas uma tela, apare√ßa todo mundo.

>> Coment√°rio de thenriquedb:
> **Outra ideia que tive:** para conseguir caber **todo mundo** num mesmo print hist√≥rico, aproveitar a ideia de extrair s√≥ o rosto das pessoas (em formato de bolinha) e fazer todos esses rostos preencherem a p√°gina. A gente pode preencher de v√°rias formas:
> 
> 1. Pattern circular do centro para fora
> 2. Simula√ß√£o f√≠sica, das bolinhas caindo para a base da p√°gina
> 3. Um pattern rand√¥mico, mas que cada bolinha/rosto seja um _node_ elas ficam conectadas entre s√≠.
> 
> Em resumo: fazer um formato que, em apenas uma tela, apare√ßa todo mundo.

Show @filipedeschamps! Criei um prot√≥tipo bem simples utilizando o Figma utilizando com base na sua ideia. Voc√™ tinha imaginado algo mais ou menos assim?

![image](https://user-images.githubusercontent.com/39653866/121980601-9843c780-cd62-11eb-9005-8d007c51abc5.png)

>> Coment√°rio de filipedeschamps:
Ahhhh que sensacional @thenriquedb isso a√≠ üòç

>> Coment√°rio de danwhat:
- Acho legal ter o mesmo tamanho para cada participante e distribuir de forma aleat√≥ria o posicionamento de cada um a cada F5.
- Ao inv√©s de guardamos a informa√ß√£o de cada colaborador, poder√≠amos fazer um script para buscar pelo nome de usu√°rio github, assim mesmo se voc√™ mudar a imagem a pagina se atualizaria.
- E por mais que seja uma pagina tempor√°ria, que tal mantermos ela em um dom√≠nio separado? Algo como `/fundacao`

Rabisquei aqui a minha ideia e tem mais coisas no figma.
https://www.figma.com/file/AFoDdH5EtySP0mk8LLTnDc/Untitled?node-id=0%3A1

- Podemos alterar o tamanho final de cada card dependendo da quantidade de pessoas que forem participar.
- Pensei r√°pido no Header, mas tamb√©m podemos mudar o texto e adicionar o input como o @rodrigoKulb sugeriu.

![Imgur](https://i.imgur.com/8yqQXeA.png)

Espero que tenha conseguido condensar o meu pensamento pois estou no meio da live do Filipe enquanto escrevo ü§£

>> Coment√°rio de thenriquedb:
@danwhat Show! O que acha em utilizar grafo com os avatares conectados como o Filipe tinha sugerido ali em cima. Dessa forma ficaria massa que daria pra adicionar muita gente em uma mesma tela. 

![image](https://user-images.githubusercontent.com/39653866/122101253-72fa9c00-cdea-11eb-920a-94506ed05a6f.png)

>> Coment√°rio de danwhat:
>  Show! O que acha em utilizar grafo com os avatares conectados como o Filipe tinha sugerido ali em cima. Dessa forma ficaria massa que daria pra adicionar muita gente em uma mesma tela.

- Precisamos saber se tem uma lib que entregue isso para a gente, pois fazer do zero para algo tempor√°rio ficaria bem desgastante. A n√£o ser que  a pagina permanecer em algum outro lugar como sugeri, ai sim eu me empolgaria de fazer ou de contribuir para quem fosse criar.
- Outro ponto tamb√©m √© sobre a necessidade do scroll j√° que ser√£o uns 170 n√≥s.

Coloquei apenas dois pontos que precisamos nos atentar, mas eu super curti a ideia @thenriquedb.

>> Coment√°rio de Davidsouza20:
Uma sugest√£o simples, mas que tem um visual bacana seria essa que tirei do site laracasts 
![image](https://user-images.githubusercontent.com/42478191/122103230-c2da6280-cdec-11eb-9215-445df286ffef.png)


Fica como id√©ia √© bem simples, mas tem um visual minimalista e elegante.

>> Coment√°rio de aismaniotto:
Eu gosto da id√©ia de que a p√°gina fique em algum outro lugar, como numa p√°gina "Sobre" ou algo assim depois da publica√ß√£o.
Acho que a ideia de ficar tudo numa p√°gina s√≥ seria por causa do print de registro, mas mesmo com o scroll, tem algumas configura√ß√µes que da para programar para o "imprimir p√°gina", que substituiria o printscreen e mostraria todos. Um registro t√£o bom quanto

>> Coment√°rio de danwhat:
> Uma sugest√£o simples, mas que tem um visual bacana seria essa que tirei do site laracasts

√â outra ideia bacana, e no **mouseover** poderia mostrar o @ de cada um.
S√≥ me preocupo se caberia todo mundo de maneira satisfat√≥ria.

---

Relendo a thread eu entendi sobre a sugest√£o de  "apare√ßa todo mundo em apenas uma tela".
Eu acho complicado n√£o usamos scroll na p√°gina, pois s√£o 170 pessoas (e aumentando). Mas se for algo bem minimalista como o @Davidsouza20 sugeriu pode ficar legal.

>> Coment√°rio de danwhat:
Como acabamos de sair da Live do Filipe e estamos todos empolgados, acredito que ainda vai aparecer novas ideias.
Podemos debater sobre as diferentes propostas e fazermos uma vota√ß√£o com as melhores. Assim evita de a gente ficar debatendo eternamente sem chegar a uma conclus√£o.

@filipedeschamps voc√™ esta dando muita liberdade para a gente e isso √© muito bom, mas ao mesmo tempo voc√™ que d√° a palavra final. Como inda n√£o me acostumei com o fluxo do github, sugeri a vota√ß√£o. Se em algum momento come√ßar a sair do escopo que voc√™ est√° planejando √© s√≥ falar.

>> Coment√°rio de filipedeschamps:
> @filipedeschamps voc√™ esta dando muita liberdade para a gente e isso √© muito bom, mas ao mesmo tempo voc√™ que d√° a palavra final. Como inda n√£o me acostumei com o fluxo do github, sugeri a vota√ß√£o. Se em algum momento come√ßar a sair do escopo que voc√™ est√° planejando √© s√≥ falar.

Super tranquilo @danwhat ta sendo uma experi√™ncia **SENSACIONAL** toda essa energia vindo de voc√™s e pode deixar que vamos afunilar numa decis√£o. E toda ideia tem o balan√ßo da execu√ß√£o, mas agora que definimos um primeiro prazo para a Milestone 0, fica melhor saber balancear essas coisas.

>> Coment√°rio de filipedeschamps:
E juntando a sugest√£o de layout do @Davidsouza20 com a do @aismaniotto sobre a p√°gina permanecer para sempre em algum lugar, acho que estamos nos aproximando de algo execut√°vel e permanente.

E temos o script do @thenriquedb (com a lapida√ß√£o do @francopan) proposto nesse PR https://github.com/filipedeschamps/tabnews.com.br/pull/26 ent√£o fica tudo algo muito *gerenci√°vel* no ponto de atualizar de √∫ltima hora antes do print final.

S√©rio, voc√™s s√£o a melhor comunidade com quem eu poderia trabalhar, eu fico sinceramente emocionado ü§ù

>> Coment√°rio de JuniorUbarana:
> Eu gosto da id√©ia de que a p√°gina fique em algum outro lugar, como numa p√°gina "Sobre" ou algo assim depois da publica√ß√£o.
> Acho que a ideia de ficar tudo numa p√°gina s√≥ seria por causa do print de registro, mas mesmo com o scroll, tem algumas configura√ß√µes que da para programar para o "imprimir p√°gina", que substituiria o printscreen e mostraria todos. Um registro t√£o bom quanto

Isso... Poderia at√© ficar como um _easter egg_  do TabNews...  üòÑ üòÑ

>> Coment√°rio de francopan:
> Uma sugest√£o simples, mas que tem um visual bacana seria essa que tirei do site laracasts
> ![image](https://user-images.githubusercontent.com/42478191/122103230-c2da6280-cdec-11eb-9215-445df286ffef.png)
> 
> Fica como id√©ia √© bem simples, mas tem um visual minimalista e elegante.

Eu curto mais essa pois todos ficam com igual protagonismo. Acho legal a ideia dos que tem anima√ß√µes de grafos e coisas do tipo, mas pra hora do "print" uns ficam grande e outros pequenos. Se isso for de acordo com o n√∫mero de intera√ß√µes em issues e commits, at√© √© aceit√°vel, mas acho que a contribui√ß√£o de todos, por menor que seja √© importante.

>> Coment√°rio de fernandofreamunde:
> ![image](https://user-images.githubusercontent.com/39653866/121980601-9843c780-cd62-11eb-9005-8d007c51abc5.png)

Gosto muito desta imagem, passa a mensagem e tem espa√ßo para para adicionar bastantes avatars, talvez os pusesse com o mesmo tamanho em vez de aumentar os avatars a medida vao ficando mais longe do centro... contudo, esse efeito fica muito bom tamb√©m :)

>> Coment√°rio de brunofamiliar:
> > Uma sugest√£o simples, mas que tem um visual bacana seria essa que tirei do site laracasts
> > ![image](https://user-images.githubusercontent.com/42478191/122103230-c2da6280-cdec-11eb-9215-445df286ffef.png)
> > Fica como id√©ia √© bem simples, mas tem um visual minimalista e elegante.
> 
> Eu curto mais essa pois todos ficam com igual protagonismo. Acho legal a ideia dos que tem anima√ß√µes de grafos e coisas do tipo, mas pra hora do "print" uns ficam grande e outros pequenos. Se isso for de acordo com o n√∫mero de intera√ß√µes em issues e commits, at√© √© aceit√°vel, mas acho que a contribui√ß√£o de todos, por menor que seja √© importante.

As vezes seria interessante ter isso na tela inicial, e criar uma anima√ß√£o pra ir trocando aleatoriamente cada um dos contribuidores. Ai quando clicar no bot√£o roxo por exemplo, abrir a lista completa com todos.

>> Coment√°rio de fernandofreamunde:
> As vezes seria interessante ter isso na tela inicial, e criar uma anima√ß√£o pra ir trocando aleatoriamente cada um dos contribuidores. Ai quando clicar no bot√£o roxo por exemplo, abrir a lista completa com todos.

Boa idea, acho que uma coisa destas no rodape da homepage, ou da pagina about

>> Coment√°rio de thenriquedb:
> As vezes seria interessante ter isso na tela inicial, e criar uma anima√ß√£o pra ir trocando aleatoriamente cada um dos contribuidores. Ai quando clicar no bot√£o roxo por exemplo, abrir a lista completa com todos.

Esse bot√£o roxo n√£o √© fixo do layout e sim um card com detalhes do usu√°rio que √© mostrado quando est√° com o mouse sob o avatar. Caso queira conferir diretamente na [pag√≠na](https://laracasts.com/) mecionado pelo @Davidsouza20

>> Coment√°rio de brunofamiliar:
Boa noite pessoal, gostaria de deixar aqui minha contribui√ß√£o: https://www.figma.com/file/EyrhPbrkmMVE4J8XqLPnMf/Tabnew-POC?node-id=0%3A1

N√£o sou expert em design, ent√£o me desculpem se feri alguma boa pr√°tica de design ux/ui. A ideia, √© que os contribuidores sejam exibidos de forma din√¢mica, sendo alterados a cada tempo x. E se clicar em ver todos, mostra a lista com todos os contribuintes.

![image](https://user-images.githubusercontent.com/32016729/122309499-c81ad880-cee4-11eb-9636-98e747af05fa.png)

>> Coment√°rio de brunodmsi:
Ol√°, boa noite. Gostaria de deixar uma contribui√ß√£o tamb√©m, usei como base o site de projetos [Open Source da Google](https://opensource.google/projects/explore/featured). 

Quando tiver a a√ß√£o do mouseover sobre a imagem de um contribuidor, poderia aparecer o coment√°rio feito pelo dev assim como no site do [Laracasts](https://laracasts.com/) que foi enviado pelo @Davidsouza20 , s√≥ que o coment√°rio do dev funcionaria da mesma forma quando se faz um mouseover no site da Google linkado acima. 

Essa ideia une um pouco da ideia do @thenriquedb e do @fernandofreamunde e aproveitando pra comentar um pouco sobre o ponto do @danwhat eu acredito que uma tela (ou se√ß√£o) de contribuidores poderia ser de bom agrado para permanecer no site, exaltando sempre os desenvolvedores que contribuirem de alguma forma ao projeto, e tamb√©m ao apertar o bot√£o de "VER TODOS CONTRIBUIDORES" poderia abrir um modal com a lista completa de contribuidores (o mesmo que no Laracasts)

A imagem n√£o ficou √≥tima, mas √© apenas um conceito. Copiei tamb√©m o texto do @brunofamiliar porque achei bom hehe

![Desktop - 1](https://user-images.githubusercontent.com/26263398/122316252-e89d5f80-cef1-11eb-9c2f-a14b5b46ee08.jpg)

edit: adicionando link pro [figma](https://www.figma.com/file/cXhFuI850XxckKbVPzmQPn/TabNews-Construcao?node-id=0%3A1)

>> Coment√°rio de brunofamiliar:
> Ol√°, boa noite. Gostaria de deixar uma contribui√ß√£o tamb√©m, usei como base o site de projetos [Open Source da Google](https://opensource.google/projects/explore/featured).
> 
> Quando tiver a a√ß√£o do mouseover sobre a imagem de um contribuidor, poderia aparecer o coment√°rio feito pelo dev assim como no site do [Laracasts](https://laracasts.com/) que foi enviado pelo @Davidsouza20 , s√≥ que o coment√°rio do dev funcionaria da mesma forma quando se faz um mouseover no site da Google linkado acima.
> 
> Essa ideia une um pouco da ideia do @thenriquedb e do @fernandofreamunde e aproveitando pra comentar um pouco sobre o ponto do @danwhat eu acredito que uma tela (ou se√ß√£o) de contribuidores poderia ser de bom agrado para permanecer no site, exaltando sempre os desenvolvedores que contribuirem de alguma forma ao projeto, e tamb√©m ao apertar o bot√£o de "VER TODOS CONTRIBUIDORES" poderia abrir um modal com a lista completa de contribuidores (o mesmo que no Laracasts)
> 
> A imagem n√£o ficou √≥tima, mas √© apenas um conceito. Copiei tamb√©m o texto do @brunofamiliar porque achei bom hehe
> 
> ![Desktop - 1](https://user-images.githubusercontent.com/26263398/122316252-e89d5f80-cef1-11eb-9c2f-a14b5b46ee08.jpg)
> 
> edit: adicionando link pro [figma](https://www.figma.com/file/cXhFuI850XxckKbVPzmQPn/TabNews-Construcao?node-id=0%3A1)

Gostei da proposta =) a √∫nica coisa que me preocupa √© em rela√ß√£o a esse grafo, tipo, na complexidade em constru√≠-lo kk voc√™s conhecem alguma lib que facilite esse trabalho??

Analisando a minha primeira proposta, vi que pode ter um probleminha em rela√ß√£o √† captura de email (devido ao tempo de se implementar, e tamb√©m devido ao entendimento se seria interessante nesse momento); e outro problema √© a quantidade de contribuintes que apareceriam na p√°gina incial ( j√° que a proposta √© ele ser din√¢mico e o espa√ßo onde coloquei √© na lateral). Criei uma outra proposta baseando um pouco na ideia dos grafos propostos por @brunodmsi e @thenriquedb. Link para visualiza√ß√£o: https://www.figma.com/file/EyrhPbrkmMVE4J8XqLPnMf/Tabnew-POC?node-id=0%3A1

![image](https://user-images.githubusercontent.com/32016729/122398022-dd791c80-cf4f-11eb-9da7-6ee9d17acbd2.png)


A ideia √© que no fundo seja exibido os contribuidores, e vai "caminhando" para a lateral, permitindo assim exibir uma quantidade maior de pessoas.

>> Coment√°rio de felipe-ds-lima:
> Ol√°, boa noite. Gostaria de deixar uma contribui√ß√£o tamb√©m, usei como base o site de projetos [Open Source da Google](https://opensource.google/projects/explore/featured). 
> 
> Quando tiver a a√ß√£o do mouseover sobre a imagem de um contribuidor, poderia aparecer o coment√°rio feito pelo dev assim como no site do [Laracasts](https://laracasts.com/) que foi enviado pelo @Davidsouza20 , s√≥ que o coment√°rio do dev funcionaria da mesma forma quando se faz um mouseover no site da Google linkado acima. 
> 
> Essa ideia une um pouco da ideia do @thenriquedb e do @fernandofreamunde e aproveitando pra comentar um pouco sobre o ponto do @danwhat eu acredito que uma tela (ou se√ß√£o) de contribuidores poderia ser de bom agrado para permanecer no site, exaltando sempre os desenvolvedores que contribuirem de alguma forma ao projeto, e tamb√©m ao apertar o bot√£o de "VER TODOS CONTRIBUIDORES" poderia abrir um modal com a lista completa de contribuidores (o mesmo que no Laracasts)
> 
> A imagem n√£o ficou √≥tima, mas √© apenas um conceito. Copiei tamb√©m o texto do @brunofamiliar porque achei bom hehe
> 
> ![Desktop - 1](https://user-images.githubusercontent.com/26263398/122316252-e89d5f80-cef1-11eb-9c2f-a14b5b46ee08.jpg)
> 
> edit: adicionando link pro [figma](https://www.figma.com/file/cXhFuI850XxckKbVPzmQPn/TabNews-Construcao?node-id=0%3A1)

J√° fiz esse tipo de coisa antes, me ofere√ßo para fazer a tela dessa forma

>> Coment√°rio de carlosrocha-dev:
Bom dia, Pessoal, como est√£o?

Estava pensando aqui, e se a p√°gina de em constru√ß√£o for algo na linha desde script de js (https://codepen.io/laradurrant/pen/mdyLmrW) substituindo os pontos pelos avatares e mantendo o logo centralizado do TabNews.
![image](https://user-images.githubusercontent.com/3737837/122422697-bb899500-cf63-11eb-8f47-19b58e0520cd.png)

Seria algo semelhante a proposta do @thenriquedb, que achei bem bacana. 
![image](https://user-images.githubusercontent.com/3737837/122422342-72d1dc00-cf63-11eb-8184-0e2ace5ab903.png)
Com esse movimento espiral seria pos√≠vel ver aleatoriamete diversos menbros na tela.

O que acham?

[update] poderiamos usar a api do github para integrar os avatares no script

>> Coment√°rio de fernandofreamunde:
Eu gosto muito da ideia do @brunofamiliar porque tr√°s um call to action para os poss√≠veis interessados passarem um email. Da para vermos e quantificar o interesse no projecto. :)

>> Coment√°rio de regiskensy:
Gosto da ideia de aparecer todos os membros (ou pelo menos a maior parte), sendo as fotos com tamanhos variados. Para isso poderia haver um algor√≠tmo que sorteasse quais membros ser√£o exibidos a cada _refresh_, bem como os tamanhos das respectivas fotos. Poderia haver uma "query string" na URI para indicar o membro que dever√° obrigatoriamente ser exibido em tamanho grande, assim cada pessoa pode acessar a p√°gina e dar um _print_ com seu avatar em destaque. Ex.: tabnews.com.br?spotlight=regiskensy

>> Coment√°rio de rodrigoKulb:
Pensando em um formato responsivo a solu√ß√£o de listagem acaba sendo a mais simples de adaptar.
Gostei muito da op√ß√£o sugerida pelo @brunofamiliar simples e intuitiva.
Sobre a "pagina√ß√£o" para exibir todos os membros poderia ser rand√¥mica e animada alterando os rostos a cada 5 segundos.

>> Coment√°rio de rodrigoKulb:
Fiz uma vers√£o do layout sugerido pelo @brunofamiliar .
PS: Tamb√©m n√£o sou expert em design, ent√£o me desculpem se feri alguma boa pr√°tica de design ux/ui.

![Captura de tela em 2021-06-17 14-09-52](https://user-images.githubusercontent.com/5334261/122443321-d9f88c00-cf75-11eb-90b5-2a445f83f297.png)

https://www.figma.com/file/tawgMewBuDinLogsaAzGMj/Tabnew-v2-POC?node-id=0%3A1

>> Coment√°rio de carlosdavid0:
Opa. Desculpa por fazer close and reopen. Acabei me atrapalhando todoüòÖüòÖ.

>> Coment√°rio de carlosdavid0:
Eu adorei a ultima vers√£o criada pelo @rodrigoKulb e acredito que seria interessante desenvolver uma "Dark Mode" tanto por acessibilidade quanto por gosto.

>> Coment√°rio de vitoropereira:
> Fiz uma vers√£o do layout sugerido pelo @brunofamiliar .
> PS: Tamb√©m n√£o sou expert em design, ent√£o me desculpem se feri alguma boa pr√°tica de design ux/ui.
> 
> ![Captura de tela em 2021-06-17 14-09-52](https://user-images.githubusercontent.com/5334261/122443321-d9f88c00-cf75-11eb-90b5-2a445f83f297.png)
> 
> https://www.figma.com/file/tawgMewBuDinLogsaAzGMj/Tabnew-v2-POC?node-id=0%3A1

Ent√£o perfeita a coloca√ß√£o do nosso amigo @rodrigoKulb. Para responsividade e simplicidade, creio essa ser a melhor op√ß√£o.

>> Coment√°rio de danwhat:
> Fiz uma vers√£o do layout sugerido pelo @brunofamiliar .
PS: Tamb√©m n√£o sou expert em design, ent√£o me desculpem se feri alguma boa pr√°tica de design ux/ui.

Meu Deus! Lindimais. E com essa pagina√ß√£o embutida n√£o fica com a sensa√ß√£o sobrecarregada de muitos avatares ao mesmo tempo que n√£o obriga  o usu√°rio a passar por varias p√°ginas. Por mim a gente j√° tem nossa pagina em constru√ß√£o :)

Eu s√≥ aumentaria o espa√ßamento horizontal de todos os itens, est√° bem colado.

>> Coment√°rio de rhandrade:
E se fiz√©ssemos algo parecido com essa imagem, n√£o porque √© da Apple üòÑ, mas acho que casa bem com que o Filipe estava falando de deixar o m√°ximo poss√≠vel de pessoas na home. 

Assim poder√≠amos reservar o m√≠nimo do topo para fazer um bloco com a logo do projeto e um campo pra newsletter, e o restante da p√°gina ser focado nos avatares de todo mundo que contribui com o projeto, e ao passar o mouse sobre mostra um card contente as informa√ß√µes dispon√≠veis aqui no perfil do Github, assim como o @danwhat sugeriu. 

Ai depois do site no ar podemos colocar essa p√°gina como sendo um mural dentro da p√°gina sobre, como o @aismaniotto sugeriu acima.

![image](https://user-images.githubusercontent.com/4511733/122794001-2acbf580-d292-11eb-9ef8-eb07367244f8.png)

>> Coment√°rio de filipedeschamps:
J√° falei e vou falar de novo: **melhores pessoas est√£o nesse reposit√≥rio** üéâ

Eu sozinho nunca teria tantas ideias e mesmo que a gente precise afunilar na hora da execu√ß√£o, √© **muito bom** ter um respiro de outros √¢ngulos, seja desde uma p√°gina totalmente diferente, ou at√© pequenos peda√ßos de ideia.

Essa semana vou fazer minha implementa√ß√£o e vai tamb√©m seguir na linha do @brunofamiliar misturado com [esse PR](https://github.com/filipedeschamps/tabnews.com.br/pull/37) do @rodrigoKulb e tamb√©m com esse print do @rhandrade ü§ù 

Tudo indica que vamos comemorar o fechamento da Milestone 0 ao vivo, nessa sexta-feira, conforme previsto! Vamo pra cima!!!!

>> Coment√°rio de filipedeschamps:
Fala turma, acabei de abrir o PR https://github.com/filipedeschamps/tabnews.com.br/pull/45 com minha sugest√£o, e l√° eu levanto **8 pontos** explicando essa sugest√£o üëç 

E j√° adiantando, aqui segue o link para visualizar a p√°gina: https://tabnews-git-construction-filipe-filipedeschamps.vercel.app/pocs/construction-02

>> Coment√°rio de vladimiremi:
Caramba! Por que eu n√£o participei disso? Eu n√£o sabia como funcionava essa din√¢mica de milestones. Aprendi agora no curso.dev, estou fascinado com tudo isso. D√° pra ver dos prim√≥rdios como tudo aconteceu.

>> Coment√°rio de aprendendofelipe:
> Caramba! Por que eu n√£o participei disso? Eu n√£o sabia como funcionava essa din√¢mica de milestones. Aprendi agora no curso.dev, estou fascinado com tudo isso. D√° pra ver dos prim√≥rdios como tudo aconteceu.

√â relativo, voc√™ pode come√ßar agora e, daqui alguns anos, poder dizer que estava aqui desde os prim√≥rdios. üí™

>> Coment√°rio de vladimiremi:
Pois √© isso que vou fazer. N√£o consigo parar de ler o que est√° nas issues.

>> Coment√°rio de afqbrito:
Temb√©m estou chegando agora, via 'curso.dev'.

Sensacional poder vislumbrar tudo isso!

Parab√©ns a toda a galera que tem participado dessa constru√ß√£o!

>> Coment√°rio de grecoww:
Chegando aqui pelo curso.dev, e √© como entrar no modo espectador do minecraft e ver a "hist√≥ria sendo feita" üòÜ
</issue_23_Ideias para p√°gina de "Em constru√ß√£o">

<issue_27_Datas, fontes e fakenews. O que fazer?>
Estive lendo o di√°rio e as discuss√µes do projeto e, pelo menos at√© onde pude acompanhar, acho que ainda n√£o foi discutido alguns pontos que, pelo menos eu, acho relevante quando se trata de consumir conte√∫dos na internet. 

**O primeiro problema:** informa√ß√£o sem data pode confundir as pessoas. 

Imagine o seguinte cen√°rio: voc√™ l√™ a not√≠cia de que um bug cr√≠tico foi encontrado no Windows. Voc√™ n√£o sabia disso. S√≥ que essa not√≠cia j√° tem alguns meses e o bug j√° foi corrigido. Isso pode te causar uma sensa√ß√£o de urg√™ncia desnecess√°ria.  Sendo assim, eu gostaria de levantar algumas quest√µes.

Eu vi que nos layouts testados existe o tempo em que aquela not√≠cia foi postada. Mas n√£o informa de quando √© aquela not√≠cia. 

- Se uma pessoa, por engano, postar uma not√≠cia antiga, como ela (a not√≠cia) ser√° tratada? 
- Ficar√° esperando que algu√©m note que ela √© antiga e avisar√° ao autor?
- O procedimento padr√£o ser√° apagar a not√≠cia ou deixar que ela v√° perdendo relev√¢ncia na medida que recebe poucos ou nenhum tabcoins?

**Segundo problema:** as fakenews. 

- O que acontece se uma not√≠cia se mostrar falsa? 
- S√≥ o autor poder√° apagar a publica√ß√£o ou existir√° alguma tipo de modera√ß√£o?
- A not√≠cia receber√° alguma tag de "fakenews" como o Facebook anda fazendo? 

Isso me leva tamb√©m a pensar na fonte da not√≠cia. Uma not√≠cia pode ter mais de uma fonte. √Äs vezes uma fonte possui mais informa√ß√µes do que a outra. E √†s vezes as fontes s√£o at√© conflitantes. 

- Existir√° alguma forma de agrupar as mesmas not√≠cias de fontes diferentes como acontece no Google Not√≠cias? 
- Existir√° algum rank de fontes confi√°veis? 

Resolvi levantar essas quest√µes porque esse √© o tipo de coisa que me preocupa bastante quando estou consumindo informa√ß√£o na internet. E para que o TabNews se torne um ve√≠culo importante na comunidade de TI acho  importante que o conte√∫do dele seja extremamente confi√°vel ou que pelo menos ele mostre que tem o compromisso de oferecer conte√∫do relevante e confi√°vel ao ter ferramentas que evitem os problemas que apontei. 

E para ficar claro, n√£o estou esperando que as pessoas postem conte√∫dos duvidosos por m√° inten√ß√£o. Estou considerando o engano mesmo. Acho que todos n√≥s, alguma vez na vida, postou nas redes sociais algum conte√∫do desatualizado ou que era fakenews. A gente se engana. √â normal.

>> Coment√°rio de rodrigoKulb:
@geovani-brito √≥timos pontos! 

Acredito que poder√≠amos criar um campo data da not√≠cia junto ao campo fonte da not√≠cia. Claro que nem sempre os usu√°rio ter√£o essa informa√ß√£o, mas pode ajudar no rankeamento da noticia.

Sobre as fakenews, talvez seguir com a mesma l√≥gica do Waze. Quando um acidente n√£o existe mais na pista, ter a op√ß√£o dos usu√°rios clicarem em um bot√£o "Reportar" => Fakenews, Not√≠cia sem contexto ou outras op√ß√µes. Desta forma podendo "perder" rankeamento ou at√© mesmo ser exclu√≠da devido a quantidade de cliques.

>> Coment√°rio de geovani-brito:
Gosto da ideia do bot√£o "Reportar", @rodrigoKulb. Pode at√© mesmo servir para outros tipos de abusos na plataforma. Por√©m, temos que nos atentar que no momento que algu√©m marca uma not√≠cia como "fakenews" ela precisa estar certa de que √© fake mesmo e de certa forma ela precisa provar isso. Ent√£o talvez seja necess√°rio ter a op√ß√£o de colocar outra not√≠cia desmentindo a not√≠cia sinalizada. 

Isso me faz pensar no que o Filipe falou no √∫ltimo v√≠deo. Como √© dif√≠cil manter as coisas simples. E √© dif√≠cil manter simples porque o mundo √© complexo, ca√≥tico. Podemos at√© deixar para resolver depois esses problemas que eu listei. Mas eventualmente eles v√£o aparecer com o crescimento do site.  

Eu fique preocupado com a qualidade dos conte√∫dos que ser√£o postados no Tabnews, mas tamb√©m n√£o quero criar complexidade. Pelo menos n√£o nesse primeiro momento. E como resolver esses problemas da maneira mais simples poss√≠vel √© um enorme desafio.

>> Coment√°rio de rodrigoKulb:
@geovani-brito concordo 100%. Pelo que eu entendi a op√ß√£o para publicar not√≠cia s√≥ ser√° liberada ap√≥s o usu√°rio chegar ao n√≠vel de XP necess√°rio.

Nos projetos que trabalho, sempre separo em fases, acredito que podemos seguir com uma parte b√°sica de inicio. Com um simples bot√£o, talvez at√© um campo URL de "prova", mas ser√° necess√°rio um membro qualificado do portal para homologar e a noticia √© fake ou n√£o.

At√© podemos definir um XP necess√°rio para aprovar ou n√£o uma fakenews. Tamb√©m quantos usu√°rios precisam aprovar para excluir a not√≠cia.

>> Coment√°rio de filipedeschamps:
@geovani-brito excelentes questionamentos!!! √â por isso que voc√™s s√£o sensacionais e isso me d√° total confian√ßa que o TabNews vai dar certo, porque enquanto algumas pessoas est√£o cuidando de certos temas, outras pessoas est√£o cuidando de outros. Isso me lembra muito a Lei de Linus: ***Dados olhos suficientes, todos os erros s√£o √≥bvios"*** üòç 

N√£o tenho respostas concretas para as suas perguntas, mas tenho algumas sugest√µes:

**Not√≠cia antiga:** fazer igual ao Hackernews, onde se a not√≠cia n√£o for do ano que foi postada, prefixar no t√≠tulo o ano dela. Por exemplo: *"Microsoft lan√ßa nova vers√£o do Windows (2015)"*. No caso do Hackernews, se algu√©m n√£o colocou datada, a modera√ß√£o vai l√° e coloca. E eu n√£o penalizaria not√≠cias antigas, pois as vezes √© realmente muito legal revisitar certas postagens (principalmente as atemporais).

**Not√≠cia falsa:** estou com o @rodrigoKulb nessa, gosto da op√ß√£o de reportar, onde al√©m de ser penalizado no ranking  podemos colocar um limite que, depois de X reports, a not√≠cia ou coment√°rio s√£o arquivados.

E novamente, obrigado por levantar esses questionamentos, gostaria muito que voc√™ acompanhasse o projeto para pensar o que iremos aplicar de fato, e em quais est√°gios.

>> Coment√°rio de geovani-brito:
Beleza, @filipedeschamps! Vou continuar acompanhando esse tema a medida que o sistema for sendo desenvolvido. No momento oportuno vamos pensar com mais detalhes como fica a implementa√ß√£o da ideia do bot√£o Reportar dada pelo @rodrigoKulb. 

E vamos para o Milestone Zero. J√° t√¥ ansioso pra ver a live!

>> Coment√°rio de brunofamiliar:
Acredito que uma forma de amenizar a dissemina√ß√£o de not√≠cias falsa, √© levar em considera√ß√£o o n√∫mero de reports. Nesse contexto, pode ser definido um n√∫mero x de reports, se esse post alcan√ßar esse n√∫mero, ele √© desativado at√© os moderadores avaliar esse post. Podemos tamb√©m avaliar o total de intera√ß√µes no post (curtidas, coment√°rios, compartilhamentos, etc..), geralmente fake news tem muita intera√ß√£o, sendo assim, essa regra de reports se aplicaria √†s postagens que tiverem uma ascen√ß√£o muito alta no menor per√≠odo de tempo (em rela√ß√£o a data de postagem).

>> Coment√°rio de joao-gabriel-gois:
Talvez fosse interessante criar alguns sistemas de vota√ß√£o s√≥ dispon√≠veis pra certos n√≠veis de xp com dura√ß√£o pr√©-definida. Quem tem poder de decis√£o receberia a notifica√ß√£o e poderia votar o que, dos conte√∫dos reportados, realmente representa algo que fira a pol√≠tica e proposta primeira do TabNews. De alguma maneira sinto que seria legal isso dar XP tamb√©m, para incentivar o trabalho s√©rio, o filtro de mais de uma pessoa sempre e etc. O n√∫mero de reports n√£o s√≥ tornaria a vota√ß√£o mais importante, como com prazo menor e o qu√≥rum m√≠nimo e recompensa maiores. Seria legal garantir que de alguma maneira as provas foram revisadas pela pessoa antes de declarar o voto.

Acredito que existir√° um filtro enorme at√© a pessoa realmente ter a XP para publicar a not√≠cia, o que diminui as chances de problemas realmente graves como fakenews absurdas publicadas e circulando com relev√¢ncia. Por√©m quanto a necessidade de modera√ß√£o, membros com mais alta XP - a n√≠vel de poder publicar not√≠cia, moderar fakenews e etc - n√£o necessariamente precisariam enquadrar isso como uma "tarefa extra".  Isso poderia ser parte mesma do sistema como um todo, mesmo que s√≥ para determinados caso de uso (como as fake news), integrando com os outros sistemas e recompensando por prezar a qualidade do conte√∫do e sua revis√£o.

Outras decis√µes ou consultas que interesse participa√ß√£o dos membros e da comunidade de produtores e consumidores de conte√∫do poderiam seguir a mesma l√≥gica, mas com vota√ß√µes que atingissem mais membros para assuntos que assim interessasse, assuntos onde a delicadeza e n√≠vel de acesso n√£o fossem como no caso da modera√ß√£o de fake news.

>> Coment√°rio de joao-gabriel-gois:
Inclusive quem publicou a fake news poderia tamb√©m ter um preju√≠zo consider√°vel em sua experi√™ncia, aproveitando XP como conceito gameficado para criar uma maneira de perd√™-la, assim como se perde ao "morrer" num jogo de MMO, por exemplo. Assim se ajusta o sistema de recompensa e puni√ß√£o, dependendo da gravidade. A XP permite muita interven√ß√£o antes de coisas mais dr√°sticas como banir o usu√°rio, por exemplo.

>> Coment√°rio de geovani-brito:
Obrigado por pensar nesse assunto tamb√©m, @joao-gabriel-gois.

Eu acredito que o sistema de s√≥ ser poss√≠vel postar not√≠cias quando a pessoa tiver um determinado n√≠vel de XP j√° ajudaria muito a evitar que not√≠cias fakes acabem sendo postadas, j√° que a gente estaria selecionando os usu√°rios mais criteriosos e comprometidos com a plataforma. 

Tamb√©m acho que a not√≠cia poderia ser penalizada com X reports como o Filipe j√° falou mais acima. Por√©m, acho que a pessoa que postou n√£o deveria ser penalizada. Primeiro porque, como falei, o sistema de XP estaria selecionando as pessoas mais criteriosas e comprometidas com a plataforma, ent√£o dificilmente algu√©m faria uma postagem fakenews por m√° f√©. E isso me leva ao segundo ponto. A pessoa pode simplesmente ter se equivocado ou ela mesma ter sido enganada pela not√≠cia.  Ent√£o acho complicado penalizar quem postou, pois criaria um desincentivo injusto. A not√≠cia sim poderia ser penalizar para perder rank ou at√© mesmo ser deletada pelo autor assim que ele for informado do erro. 

Dificilmente vamos ver esses problemas no come√ßo do Tabnews. Provavelmente eles v√£o aparecer quando o n√∫mero de usu√°rios for muito grande e tiver muita gente postando not√≠cias. Acredito que podemos ainda discutir muito esse assunto at√© amadurecer uma ideia. Eu acho que √© bastante relevante pelos motivos que dei na abertura da issue, mas tamb√©m sei que essa parte pode entrar como melhorias do sistema mais adiante. Ent√£o nada do que eu disse aqui √© certeza, muita √°gua ainda vai rolar. rs

>> Coment√°rio de danwhat:
Aaaah porque as coisas n√£o podem ser simples? üò´
Mas brincadeira a parte, √≥timos pontos @geovani-brito! Conforme eu lia a thread eu fui chegando a algumas conclus√µes e o @joao-gabriel-gois postou quase tudo que eu havia pensado. Estamos bem alinhados em pensamento xD

Sobre a vota√ß√£o nos reports: poderia existir uma esp√©cie de reputa√ß√£o. Onde o peso dos votos dos usu√°rios com melhor reputa√ß√£o fosse maior para que as noticias erradas/fakes saissem da plataforma mais r√°pido, nem que seja de forma tempor√°ria. E n√£o precisamo criar maaais um sistema. Pode ser feito atrav√©s da XP de cada usu√°rio mesmo.

>> Coment√°rio de thenriquedb:
> Talvez fosse interessante criar alguns sistemas de vota√ß√£o s√≥ dispon√≠veis pra certos n√≠veis de xp com dura√ß√£o pr√©-definida.

Uma ideia seria utilizar um sistema semelhante ao que o Stack Overflow utiliza, onde respostas com quantidade maior de votos s√£o mostradas primeiras, enquanto as que possuem um alto n√∫mero de votos negativos s√£o mostradas no final e com uma opacidade menor ~~(n√£o consegui encontrar nenhum exemplo)~~.

E outra funcionalidade que acho bacana do Stack Overflow s√£o os privil√©gios que determinam o que voc√™ pode fazer na plataforma. Quanto maior sua reputa√ß√£o, mais privil√©gios voc√™ ter√°. Desta forma ajuda a evitar _trolls_  que podem repostar uma noticia apenas para prejudicar. 

![image](https://user-images.githubusercontent.com/39653866/123193163-a8525a00-d47a-11eb-8a95-b2b5362dea58.png)

**Ref√™rencia**: https://pt.stackoverflow.com/help/privileges

>> Coment√°rio de geovani-brito:
Legal, pessoal. Eu t√¥ vendo que as solu√ß√µes est√£o convergindo.

No caso das datas antigas a solu√ß√£o dada pelo @filipedeschamps parece que t√° sendo bem aceita j√° que ningu√©m mais retocou a ideia. 

J√° no caso das not√≠cias falsas voc√™s basicamente est√£o concordando com a vota√ß√£o, cada um colocando seus crit√©rios de como ela funcionaria.

>> Coment√°rio de joao-gabriel-gois:
@geovani-brito 
> Dificilmente vamos ver esses problemas no come√ßo do Tabnews. Provavelmente eles v√£o aparecer quando o n√∫mero de usu√°rios for muito grande e tiver muita gente postando not√≠cias. Acredito que podemos ainda discutir muito esse assunto at√© amadurecer uma ideia. Eu acho que √© bastante relevante pelos motivos que dei na abertura da issue, mas tamb√©m sei que essa parte pode entrar como melhorias do sistema mais adiante. Ent√£o nada do que eu disse aqui √© certeza, muita √°gua ainda vai rolar. 

Sim, concordo. Eu tinha acabado de receber acesso √† repo e ainda n√£o tinha entendido o fluxo inteiro de contribui√ß√£o, mesmo tendo lido boa parte das discuss√µes at√© ent√£o...

Agora vejo que dificilmente a pessoa chega ao ponto de subir uma not√≠cia sem comprar a id√©ia toda da "experi√™ncia" (n√£o s√≥ um produto, rs). Mesmo j√° tendo visto sobre a XP e as TabCoins, a live foi bem esclarecedora nesse sentido. Mas realmente, um sistema pensado para n√£o banalizar likes ou formatos virais, dificilmente seria de interesse dos produtores de fake news, que procuram conte√∫dos n√£o validados e plataformas virais. A chance da pessoa ter cometido um erro √© muito maior e quem tem que cair √© a publica√ß√£o, vc tem toda a raz√£o. Se pessoas realmente mal intencionados chegassem ao ponto de publicar, iam sofrer com relev√¢ncia, ainda assim. A√≠, em √∫ltimo caso, os reports...

Pro simples (a meta), basta (memo que seja por enquanto, at√© algo real mostrar outra necessidade). Pro tanto que a discuss√£o andou X o ponto do projeto, n√£o vejo muito porque esquentar a cabe√ßa ainda com apura√ß√µes mais "pente fino".



PS: _Seria bacana afunilar nisso s√≥ quando outras j√° estiverem validadas e avaliadas, como, por exemplo, o quanto o pr√≥prio fluxo de contribui√ß√£o repele fake news organicamente. Mantendo s√≥ os reports por exemplo, quantos % das publica√ß√µes realmente cai - e o quanto isso muda com o aumento / avan√ßo de n√≠vel dos usu√°rios - j√° ajudaria a responder. Se todas as m√©tricas mostrarem algo acima do que a gente acreditava que o pr√≥prio fluxo de contribui√ß√£o evitaria, a√≠ eu acho que seria a hora certa para testar o sistema do StackOverflow ou a valida√ß√£o por revis√£o + voto com qu√≥rum m√≠nimo e tempo de vota√ß√£o baseados urg√™ncia do ponto votado (meu pen√∫ltimo coment√°rio), enfim, discutir, fazer umas pocs e p√¥r isso como uma necessidade real (Milestone 10¬≥, rs, e eu aqui empolgad√£o 15 dias atr√°s, antes da 0, pondo o cora√ß√£o pra fora, rs - foca no simpleeees)_

>> Coment√°rio de geovani-brito:
√â isso a√≠, @joao-gabriel-gois! Voc√™ pegou o esp√≠rito do projeto tamb√©m.  \o/

Mas n√£o perca o ponto dessa discuss√£o. Quando abri esse issue eu j√° sabia que era uma preocupa√ß√£o de longo prazo. Mas eu estou mesmo curioso em saber como esses problemas poder√£o ser resolvidos quando come√ßarem a acontecer. E minha motiva√ß√£o vem do meu lado de consumidor do produto (ou consumidor da experi√™ncia rsrs). Eu, como usu√°rio, gostaria de entrar em um site desse tipo e ter confian√ßa de que estou vendo uma informa√ß√£o segura. Imagina no futuro voc√™ comentar uma not√≠cia com algu√©m e a pessoa dizer "mas ser√° que isso √© verdade?".  E na sequ√™ncia voc√™ poder dizer com seguran√ßa "√â sim, eu li no Tabnews".  Seria muito diferente de hoje em dia quando voc√™ fala "Eu li no Facebook." ou "Eu li no WhatsApp.". Embora os dois n√£o sejam meios de informa√ß√£o especializados, eles certamente viraram meios de informa√ß√£o para muita gente. No entanto, meios n√£o conf√°veis. Eu gostaria de olhar para o Tabnews e sentir justamente o contr√°rio, sabendo que aquele servi√ßo √© uma refer√™ncia na √°rea. 

Ent√£o vamos l√°! Anda tem um caminh√£o de coisas b√°sicas para construir, mas vamos sempre manter em mente que o site precisa dessa excel√™ncia.

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù

>> Coment√°rio de Rafatcb:
Estou removendo a label `repescar` do issue e criando esse coment√°rio para termos um hist√≥rico do motivo dessa decis√£o.

Como esse issue j√° foi mencionado no #877, podemos tratar os casos extremos por meio de sinaliza√ß√µes ap√≥s elas serem implementadas. Para os casos mais simples, os votos negativos por meio dos TabCoins tem funcionado bem at√© hoje, al√©m de coment√°rios que apontam algo espec√≠fico.
</issue_27_Datas, fontes e fakenews. O que fazer?>

<issue_29_Merge ou Close dos PRs sobre POCs ainda em aberto>
Criando essa issue para colocar dentro da Milestone 0 e come√ßar o trabalho de fazer merge ou fechar os PRs de POCs, incluindo mover tudo para dentro de uma pasta `poc`.

>> Coment√°rio de filipedeschamps:
Pessoal, tudo feito e com essa issue fechada chegamos a 50% da Milestone 0! Let's gooooooo!!!!
</issue_29_Merge ou Close dos PRs sobre POCs ainda em aberto>

<issue_30_Programa√ß√£o da p√°gina de "Em constru√ß√£o">
Ap√≥s definida a [ideia de como ser√° a p√°gina de "Em Constru√ß√£o"](https://github.com/filipedeschamps/tabnews.com.br/issues/23), essa issue √© respons√°vel por definir como ser√° programada essa ideia.

>> Coment√°rio de filipedeschamps:
Essa issue avan√ßou de 3 formas:

1. O @thenriquedb iniciou nesse PR https://github.com/filipedeschamps/tabnews.com.br/pull/26 um script para baixar os avatares dos colaboradores, que da√≠ recebeu uma contribui√ß√£o do @francopan e por √∫ltimo foi finalizado nesse PR https://github.com/filipedeschamps/tabnews.com.br/pull/38
2. O @rodrigoKulb fez esse PR https://github.com/filipedeschamps/tabnews.com.br/pull/37 implementando uma sugest√£o de layout
3. Eu fiz esse outro PR https://github.com/filipedeschamps/tabnews.com.br/pull/45 com sugest√£o de outro layout

>> Coment√°rio de LuizCorrea-Dev:
Est√° ficando incr√≠vel! √© inevit√°vel n√£o ficar extremamente empolgado !
</issue_30_Programa√ß√£o da p√°gina de "Em constru√ß√£o">

<issue_31_Colocar site em produ√ß√£o no dom√≠nio tabnews.com.br>
Sem muito mist√©rio, basicamente redirecionar o DNS para Vercel, adicionar o dom√≠nio tabnews.com.br l√° e fazer uma nova publica√ß√£o. Inclusive, j√° vou apontar o DNS para ele j√° estar propagado.

>> Coment√°rio de filipedeschamps:
Pessoal, como discutimos na Live, precisamos escolher entre usar ou n√£o o `www` no dom√≠nio ```tabnews.com.br```. A princ√≠pio, a maioria tinha escolhido sem `www`, mas a Vercel recomenda o dom√≠nio com ele, segue os prints:

![image](https://user-images.githubusercontent.com/4248081/122107045-7fbdc680-cdcf-11eb-91a3-b88a35c66439.png)

![image](https://user-images.githubusercontent.com/4248081/122107073-877d6b00-cdcf-11eb-93f4-89d99884f76d.png)

[A documenta√ß√£o est√° nesse link](https://vercel.com/docs/custom-domains#redirecting-www-domains)

>> Coment√°rio de filipedeschamps:
# Vota√ß√£o

Seguindo a sugest√£o dada na Live, usar as reactions desse post aqui para votar:

üëç  - com `www` -> `www.tabnews.com.br`
üëé - sem `www` -> `tabnews.com.br`

>> Coment√°rio de vitoropereira:
Melhor com o 'www' e redirecionando, pois como diz a documenta√ß√£o da VERCEL em ambos os casos conseguiremos o acesso.
![image](https://user-images.githubusercontent.com/47868559/122107717-c3292c80-cdf1-11eb-9739-3e17f531a5b8.png)

>> Coment√°rio de geovani-brito:
Votei com www. Se a Vercel recomenda, ent√£o acho melhor usar. At√© porque, a princ√≠pio n√£o vi diferen√ßa nenhuma em termos pr√°ticos. Quando digitei www.tabnews.com.br ele abre o site e na barra de endere√ßos fica tabnews.com.br. Quando digitei s√≥ tabnews.com.br ele abre tamb√©m o site e continua tabnews.com.br na barra de endere√ßos. Ou seja, para o usu√°rio o www √© retirado de qualquer jeito. Pelo menos assim n√£o corre o risco de cair em um 404 se por acaso a pessoa digitar com o www.

Esse teste eu fiz no Brave.

>> Coment√°rio de filipedeschamps:
Show @VOP1234 em quest√£o de redirecionamento, voc√™ consegue fazer em ambos os casos üëç 

@geovani-brito o que est√° em produ√ß√£o no momento est√° redirecionamento de www para sem www üëç 

E uma coisa que me chama aten√ß√£o e que vimos na live, √© que ambos Github e Vercel usam sem www.

>> Coment√°rio de geovani-brito:
> E uma coisa que me chama aten√ß√£o e que vimos na live, √© que ambos Github e Vercel usam sem www.

Realmente, nos dois n√£o aparece o www. Mas quando eu digitei www.github.com e www.vercel.com ambos foram direcionados para o endere√ßo sem o www.  Ou seja, √© um neg√≥cio meio esquisito. J√° n√£o est√£o dando muita import√¢ncia para o www, mas ele ainda √© considerado caso a pessoa digite com www na frente.  

Ainda n√£o entendi como ele √© importante para as CDNs, mas... se a Vercel recomenda....

>> Coment√°rio de aismaniotto:
@filipedeschamps pelo que entendi, a Vercel recomenda sem o www por causa de "protocolos" e permissionamento que ela consegue melhor gerenciar, mas que n√£o s√£o aceitos quando ele n√£o tem o www.
Como acredito que o Github n√£o usa o Vercel, n√£o cai nessa recomenda√ß√£o. No caso da Vercel, talvez por ser o pr√≥prio gerenciador, tenha todos os acessos poss√≠veis ou n√£o usa p√°ginas est√°ticas (dai n√£o tenho certeza)

>> Coment√°rio de rodrigoKulb:
"www" logo cai por √°gua, se os browser j√° est√£o ocultando! üòÖÔ∏è

>> Coment√°rio de filipedeschamps:
Por enquanto a vota√ß√£o est√° assim (e duvido que o placar ir√° virar):

![image](https://user-images.githubusercontent.com/4248081/122126403-87d53080-cde6-11eb-8981-84cc8d4f5895.png)

>> Coment√°rio de Dgdiniz:
Ol√°, por mim no momento eu voto com www por ser o recomendado e assim ficar com uma vari√°vel a menos pra ficar pensando. No futuro se algu√©m ver que isso n√£o influencia em nada no caso deste projeto, seria s√≥ mudar a configura√ß√£o como o Filipe fez na live, certo? Ou mudar depois do projeto mais avan√ßado traria alguma consequ√™ncia?

>> Coment√°rio de rodrigoKulb:
@Dgdiniz acredito que a altera√ß√£o seja simples! Igual feito na live mesmo. O www vai vencer! ü§£Ô∏è

>> Coment√°rio de filipedeschamps:
> No futuro se algu√©m ver que isso n√£o influencia em nada no caso deste projeto, seria s√≥ mudar a configura√ß√£o como o Filipe fez na live, certo? Ou mudar depois do projeto mais avan√ßado traria alguma consequ√™ncia?

@Dgdiniz na verdade traria sim, por conta do SEO: o redirecionamento entre um e outro √© um `308`, ou seja, √© permanente. E invalidar todo conte√∫do de um tipo de URL e substituir por um redirect com certeza vai bagun√ßar a percep√ß√£o dos buscadores. Vota√ß√£o ta 8x3 ent√£o realmente vamos de `www` üëç

>> Coment√°rio de milhodroid:
Eu votei no www, por causa de um detalhe que foi pulado na live, justamente onde explica o motivo da recomenda√ß√£o... L√° diz, por volta dos 50 minutos, no par√°grafo do meio, que a especifica√ß√£o DNS pro√≠be o uso do CNAME em dom√≠nios apex como "exemplo.com", por√©m permite nos dom√≠nios como "www.exemplo.com". Da√≠ a recomenda√ß√£o deles em usar o endere√ßo completo.

>> Coment√°rio de filipedeschamps:
Turma, ganhou de lavada a op√ß√£o com `www` üòç ent√£o partiu fazer essa altera√ß√£o agora e avan√ßar com a Milestone 0 ü§ù üëç 

![image](https://user-images.githubusercontent.com/4248081/122247779-763e6800-ce7c-11eb-8191-84f95e33dbf9.png)

>> Coment√°rio de filipedeschamps:
Feito! ü§ù

E aproveitei pra remover aquela URL que a Vercel d√° automaticamente para nos focarmos apenas no dom√≠nio `.com.br` üëç 

![image](https://user-images.githubusercontent.com/4248081/122248111-b43b8c00-ce7c-11eb-9310-7754cdc76902.png)

Let's gooooo!!!
</issue_31_Colocar site em produ√ß√£o no dom√≠nio tabnews.com.br>

<issue_35_Proposta de Internacionaliza√ß√£o>
Ola pessoal, primeiro me desculpe a falta de acentos (teclado alemao).

Sempre comentei que esse conteudo e muito rico e precisa ser disseminado para mais pessoas e claro mais linguagens (ingles, alemao, japones ... ). Alem de mais pessoas beneficiadas com essa leitura, tambem teriamos a oportunidade de trabalhar com essa feature que com toda certeza vai nos fazer crescer profissionalmente.

*Internacionaliza√ß√£o*

**Por que Internacionaliza√ß√£o e Localiza√ß√£o importam?**
Se voc√™ trabalha desenvolvendo um produto voltado ao mercado nacional, j√° deve estar habituado ou habituada a escrever todas as strings em Portugu√™s, pelo menos aquelas vistas pelos usu√°rios. O que aconteceria se o seu cliente quisesse expandir o mercado e passar a vender o produto em outro pa√≠s? O qu√£o trabalhoso seria fazer com que uma pessoa mexicana, por exemplo, utilizasse sua aplica√ß√£o de forma correta e com uma boa experi√™ncia de usu√°rio?

**Localiza√ß√£o vs Internacionaliza√ß√£o**
Localiza√ß√£o (l10n1) √© o processo de adaptar uma aplica√ß√£o, produto ou at√© mesmo um documento para ser mais agrad√°vel para clientes de pa√≠ses e culturas diferentes.

Por outro lado, internacionaliza√ß√£o (i18n) √© o processo de tornar a localiza√ß√£o do produto poss√≠vel. Implementar o software para que este possa saber quando e como mostrar conte√∫dos diferentes dependendo da localidade da pessoa usu√°ria.

Como a documenta√ß√£o do Django resume perfeitamente: localiza√ß√£o √© feita por pessoas tradutoras, enquanto internacionaliza√ß√£o √© feita por pessoas desenvolvedoras2.

Contudo, essa defini√ß√£o resumida de internacionaliza√ß√£o e localiza√ß√£o pode dar a impress√£o errada de que se trata apenas de uma tradu√ß√£o de idiomas. Na verdade, esse processo envolve v√°rias outras adapta√ß√µes necess√°rias para fazer com que pessoas de diferentes culturas se sintam mais confort√°veis usando o produto, como por exemplo:

- Formata√ß√£o de datas e moedas
- Convers√£o de c√¢mbio
- Convers√£o de unidade de medidas
- Caracteres especiais e texto bidirecional (ver exemplo abaixo)
- Fuso hor√°rio e feriados

**Ressources**

- https://nextjs.org/docs/advanced-features/i18n-routing
- https://labcodes.com.br/blog/pt-br/development/por-que-internacionalizacao-e-localizacao-importam/

>> Coment√°rio de francopan:
Fala Carlos, tudo bem! Obrigado pela sua contribui√ß√£o!

Eu estava pensando a mesma coisa que voc√™! A ideia do TabNews √© muito boa e escalaria f√°cil. Tanto que se pegar tra√ß√£o, pode ser replicada no mundo inteiro. Isso tr√°s, como sempre, riscos e oportunidades (os dois quase sempre s√£o a mesma coisa).

- Oportunidades:
    - Ampliar base de usu√°rios (maior renda?)
    - Mais Not√≠cias e not√≠cias cada vez mais relevantes
    - Networking com usu√°rios de diferentes pa√≠ses e culturas
- Riscos:
    - Custo de servidores
    - Necessidade de criar workspaces para l√≠nguas diferentes ou usu√°rios selecionarem o(s) idioma(s) que sabem usar.
    - Copycats do TabNews poderiam surgir em outros idiomas caso n√£o sejam implementados ou o TabNews demore para implementar (concorrencia). - Sendo open-source j√° teriam um c√≥digo completo de partida üò®
    - Left-to-right precisaria ser convertido para UI que aceite right-to-left (para idiomas √°rabes e asi√°ticos, por exemplo)
    - Lidar com diferentes timezones (salva-se tudo em UTC, mas precisa apresentar as informa√ß√µes no hor√°rio do usu√°rio). Se uma newsletter matinal for criada futuramente, precisar√° considerar isso.

Considerando as milestones do projeto e os itens listados cima, diria que essa feature √© necess√°ria, mas poderia ser encarada como "cereja no bolo". Pois antes de atingirmos um p√∫blico internacional, precisamos primeiro conquistar o p√∫blico nacional.

>> Coment√°rio de danwhat:
Muito Bacana! Eu sou bem cr√∫ nesse assunto e n√£o sabia dessa diferen√ßa.
A efetiva **Internacionaliza√ß√£o** seria implementada bem mais pra frente, mas precisamos pensar nela a partir de agora para diminuirmos os custos da implementa√ß√£o no futuro.

Meu questionamento √©: existe algum padr√£o ou check list de coisas que seriam legais serem implementadas agora para que la na frente n√£o tenhamos que reconstruir tudo do zero?

>> Coment√°rio de wcarugatti:
Pessoal, por que est√£o afirmando que internacionalizar hoje tr√°s custos maiores?

O principal custo que vem na minha cabe√ßa seria tradu√ß√£o mas j√° que √© open source meio que isso se anula.

Servidor e etc o custo por usu√°rio acredito se manter o mesmo.

E pra fechar apesar de eu n√£o fazer ideia ainda sobre como a plataforma vai se monetizar, o publico internacional "vale" mais por conta do dolar x real e etc. 

Por conta desses motivos eu levanto a bola de se internacionalizar desde o inicio. 

Num projeto de startup meu inclusive pretendo fazer o oposto, come√ßar l√° fora e s√≥ depois trazer pro Brasil, j√° que a aws custa igual e l√° fora √© mais rent√°vel.

>> Coment√°rio de tom-rb:
Fala pessoal, como tudo em engenharia de software, temos um belo compromisso a ser feito. Eu tendo a preferir um design mais cauteloso da funda√ß√£o para prevenir grandes retrabalhos no futuro, como questionado pelo @danwhat, mas temos que avaliar direito o custo benef√≠cio. Trago um gr√°fico que ilustra essa ideia (da lenda Martin Fowler, https://martinfowler.com/bliki/DesignStaminaHypothesis.html):
![image](https://user-images.githubusercontent.com/11632081/122666905-4c54b080-d1b0-11eb-9c43-e6f734e4bc3a.png)


N√£o tenho experi√™ncia com React, mas imagino o qu√£o simples de usar deveria ser um sistema que permita localiza√ß√£o. Vai incluir uma data no rodap√©? Usa um `<LocalizedDate date={createdAtUtc}></LocalizedDate>` da vida. Vai mostrar um n√∫mero? `<LocalizedNumber value={coinsCount}></LocalizedNumber>`. E por a√≠ vai. J√° a tradu√ß√£o de strings (fora das not√≠cias em si, mas a√≠ seria outra responsabilidade no sistema), eu imagino ser um pouco mais chatinha de manter e usar.

Com isso, ter um conjunto de componentes afinado assim, e todo o gerenciamento de rotas necess√°rio (tipo tabnews.com/pt-br/), n√£o √© pouca coisa. √â bem f√°cil que um esquema desses acabe atrasando mais as itera√ß√µes iniciais e demore para se pagar. Acho mais prov√°vel que o "retrabalho" necess√°rio para incluir essas features valha a pena se implementado um pouco mais pra frente (milestone 7?) do que nas etapas iniciais.

Dito isso, _armazenar datas no banco de dados em formato UTC_ √© uma boa pr√°tica que n√£o dever√≠amos abrir m√£o. O custo inicial √© baixo (converter de UTC para o locale do navegador √© simples), previne diversos bugs em rela√ß√£o a fuso hor√°rio (s√≥ o Brasil tem 4!), e tomar essa decis√£o depois do sistema estar rodando exige uma migra√ß√£o de timestamps que √© um problem√£o que pode ser evitado.

>> Coment√°rio de danwhat:
Desculpe a demora na resposta.
O @tom-rb pegou bem minha preocupa√ß√£o. O custo que eu estava falando n√£o era apenas financeiro, mas principalmente o retrabalho futuro. Acredito que exista algumas diretrizes que podemos seguir para que seja mais f√°cil a efetiva implementa√ß√£o l√° na frente. Esse que foi o eu pedido da "check list". O pr√≥prio  formato UTC √© um exemplo simples de algo super simples de implementar agora, mas que vai economizar muita dor de cabe√ßa no futuro.

---

Sobre o React, eu tenho experiencia e √© **lindimais** usar ele; sou super a favor. Mas n√£o sei o que o @filipedeschamps est√° planejando sobre isso.

>> Coment√°rio de CarlosZiegler:
Ola pessoal, descupe o Delay, mas estava corrido aqui. Acho que pegaram muito bem o problema, acredito que o custo de "preparar o terreno" seria menor agora do que implementar isso em um futuro. Talvez nao precisariamos implementar mais idiomas de inicio mas deixar ele pronto e configurado para que em um futuro possa trabalhar sem ter que reescrever metade da aplicacao.

>> Coment√°rio de valdirmendesdev:
Galera, estou passando pelo processo de internacionaliza√ß√£o/localiza√ß√£o neste momento do produto que trabalho. Realmente √© muito trabalhoso e arriscado depois que j√° existe uma estrutura funcionando.

Se houver alguma m√≠nima chance de escalarmos globalmente o Tabnews (que acredito muito que ser√°), acho que seria muito interessante j√° deixarmos a estrutura preparada, mesmo que inicialmente utilizemos apenas pt-BR. O retrabalho no futuro vai ser minimizado.

>> Coment√°rio de filipedeschamps:
Eu acho a ideia do TabNews internacional simplesmente sensacional, sinceramente seria um **sonho** ter um ecossistema **saud√°vel** na internet que pode ter a participa√ß√£o de pessoas inteligentes vindas de qualquer parte do mundo. Mas a natureza n√£o vai deixar isso barato... nunca uma oportunidade realmente boa sai barato e os motivos sempre s√£o inimagin√°veis üòÇ 

> √â bem f√°cil que um esquema desses acabe atrasando mais as itera√ß√µes iniciais e demore para se pagar. Acho mais prov√°vel que o "retrabalho" necess√°rio para incluir essas features valha a pena se implementado um pouco mais pra frente (milestone 7?) do que nas etapas iniciais.

Ent√£o pegando o gancho do @tom-rb , o que essa issue prop√µe √© a maior batalha que pessoas de tecnologia tem no in√≠cio de um projeto üòÇ 

Minha opini√£o sobre internacionalizar o TabNews (e pode ser falta de vis√£o minha e estou super aberto a corre√ß√£o), √© que n√£o ser√° f√°cil lan√ßar um projeto internacional e n√£o tem nada a ver com a quest√£o t√©cnica (nem se fizer agora ou depois tanto faz), tem a ver com **penetra√ß√£o do produto no mercado**. O principal ativo do TabNews n√£o √© a tecnologia, e nem como estamos usando ela para aplicar nossas ideias (TabCoins, Xp, etc...), o principal ativo √© a participa√ß√£o das pessoas aqui no reposit√≥rio, depois participando criando not√≠cias, comentando coisas com valor concreto e participando do fluxo completo de contribui√ß√£o. E a vers√£o brasileira √© a que est√° mais pr√≥xima dessa realidade, pelo fato das pessoas sensacionais que se reuniram ao redor do canal, se tornaram membros e est√£o aqui nesse reposit√≥rio discutindo isso ‚ù§Ô∏è  n√£o tem nada disso constru√≠do no ambiente internacional, e construir isso √© um longo caminho, **longo mesmo**, e um mar vermelho.

Ent√£o como a gente est√° tratando de um benef√≠cio que _pode_ ser coletado somente num futuro distante (novamente, posso estar com a vis√£o limitada), n√£o me parece que esse recurso ir√° ajudar a garantir o sucesso da vers√£o brasileira. E se n√£o conseguirmos o sucesso dessa vers√£o, n√£o vai ter valido implementar internacionaliza√ß√£o, mas o contr√°rio vale. Minha cabe√ßa faz um xadrez maluco de combina√ß√µes quando penso a respeito, mas segue aqui apenas os dois **extremos**:

**1. Implementamos internacionaliza√ß√£o, mas a vers√£o brasileira n√£o funcionou muito bem:**
  - Ela era que estava mais pr√≥xima de poder funcionar, problem√°tico.
  - N√£o valeu o custo de implementa√ß√£o de internacionaliza√ß√£o (aumentou a complexidade, mesmo que levemente, mas n√£o tiramos benef√≠cio).
  - E apesar dessa vers√£o n√£o ter dado certo, n√£o teve muito a ver com internacionaliza√ß√£o, at√© porque o recurso foi implementado, mas n√£o foi usado.
  - Ent√£o isso n√£o bloqueia o projeto de ser relan√ßado em ingl√™s.
  - Mas como criar p√∫blico internacional? Come√ßando com um canal no YouTube em ingl√™s?
  - S√≥ que novamente, se n√£o funcionou no Brasil onde estava mais pr√≥ximo de funcionar, porque funcionaria internacional?
 
**2. N√£o implementamos internacionaliza√ß√£o e a vers√£o brasileira funcionou:**
 - √ìtimo, se engatou e √© economicamente vi√°vel, d√° para pagar qualquer custo de outras implementa√ß√µes, principalmente porque o projeto n√£o vai ser desenvolvido de forma chutada.
 - De qualquer forma, com certeza vai ser mais caro implementar internacionaliza√ß√£o.
 - Mas antes, isso continua n√£o garantindo nossa penetra√ß√£o no mercado internacional.
 - Reunir p√∫blico bom internacional ainda √© um mist√©rio.
 - Como ter tempo para injetar energia nas m√∫ltiplas linguagens, principalmente em fomentar e moderar o p√∫blico de cada uma?

Enfim, me gera uma sensa√ß√£o estranha n√≥s colocarmos agora no presente um _"imposto"_ ou _"ped√°gio"_ a cada intera√ß√£o com o c√≥digo (seja em algu√©m que est√° aprendendo a code base pela primeira vez, ou implementando algo novo), para estarmos melhores preparados para um benef√≠cio que pode ou n√£o ser acessado num futuro, num tempo indeterminado (que eu especulei ser bem longo). Meu cora√ß√£o est√° me dizendo para **primeiro garanta  vers√£o brasileira**, que depois tudo vai valer a pena. E principalmente me sinto estranho em implementar algo agora sendo o principal motivo ter menos trabalho depois (Eu adoro a parte t√©cnica, mas me preocupa isso ser discutido mais do que o crit√©rio "produto realmente sendo usado"). Mas, agora pela terceira vez üòÇ , meu c√©rebro pode estar com pouca vis√£o do futuro.

Qual a vis√£o de voc√™s sobre esses pontos?

PS: diferente de internacionaliza√ß√£o, mas com o mesmo princ√≠pio sobre "fazer agora ou" n√£o, √© o assunto `acessibilidade`, que tem um benef√≠cio real imediato e foi discutido na issue #43

>> Coment√°rio de filipemoraes:
O que o @filipedeschamps escreveu √© uma excelente an√°lise e n√£o acredito que seja falta de vis√£o, muito pelo contr√°rio. Isso me faz lembrar os antigos marinheiros que em meio a tempestade retiravam do navio tudo o que n√£o era essencial para manter o navio na superf√≠cie, e isso inclu√≠a a comida.

As ideias s√£o boas mas precisamos manter o Tabnews na superf√≠cie e para isso precisamos ter em mente 2 coisas:

1.  √â um MVP.
2. Tal como qualquer MVP, precisa ser validado.

### Um passo de cada vez
A internacionaliza√ß√£o √© algo importante mas na hora certa. Acredito que temos que tratar o Tabnews tal como ele √©, ou seja, um MVP.  Acredito que fazer bem feito a vers√£o para o Brasil e validar o produto √© o primeiro passo.

### N√£o √© apenas uma quest√£o t√©cnica
A internacionaliza√ß√£o n√£o √© apenas uma quest√£o t√©cnica, existe toda uma log√≠stica para fazer com que o produto seja bem recebido por outras comunidades e isso consome muita energia que hoje acredito ser essencial para finalizar o MVP.
N√£o podemos simplesmente resolver o problema t√©cnico e esperar que o fato de termos o produto em outro idioma seja suficiente para dar certo.

Primeiro precisamos fortalecer a nossa comunidade, ela precisa crescer e acreditar no Tabnews, sem ela n√£o h√° motivos para continuar. Uma comunidade engajada √© um pilar essencial do projeto e √© nesse ponto que dever√≠amos gastar energia numa primeira fase. 

### H√° espa√ßo para evoluir
A internacionaliza√ß√£o √© o futuro prov√°vel mas que n√£o precisamos necessariamente projetar j√°. O que estamos a construir n√£o est√° imune a mudan√ßas profundas no futuro, ao negar isso estamos fadados ao fracasso, mas isso n√£o quer dizer que temos que pensar em tudo por causa de um prov√°vel cen√°rio, √© melhor fazer bem o que temos por agora. A nossa estrutura tem que servir muito bem ao nosso prop√≥sito atual.

Os nossos objetivos podem e devem mudar ao logo do tempo. Se chegarmos ao ponto de internacionalizar o Tabnews, isso significa que ultrapassamos muitas fases do projeto com sucesso e agora o nosso objetivo mudou e nossa estrutura mais uma vez deve ser adaptada a fim de atender ao novo prop√≥sito. Com uma base muito forte e consolidada, por mais trabalhoso que seja, ser√° um passo dado no momento certo.

>> Coment√°rio de filipedeschamps:
Outro ponto que eu adicionaria √© que (eu espero) que o core/interface do TabNews n√£o seja algo extremamente complexo, ao menos quando comparado a um sistema legado de 15 anos, sem testes, e com partes que ningu√©m sabe como funciona. Quanto mais enxuto formos, mais f√°cil fica encaixar essas necessidades (e outras que a gente ainda n√£o pensou, mas que v√£o se tornar necess√°rias).

>> Coment√°rio de tcarreira:
Sugiro fazer uma limpeza das issues, e deixar abertas apenas aquelas que sejam √∫teis ter abertas.
Para issues deste tipo, que s√£o √≥timas ideias, mas que sabemos que n√£o queremos seguir neste momento, sugiro criar um t√≥pico na wiki, onde possa ser consultado mais tarde, mas que n√£o esteja poluindo a lista de issues.

O que voc√™s acham?

>> Coment√°rio de filipedeschamps:
A gente poderia mover discuss√µes para aba de discuss√µes (n√£o lembro se esse recurso est√° dispon√≠vel para todos os repos j√°) e deixar nas issues as tarefas mesmo.

E de qualquer forma, a gente poderia taggear essa issue aqui como repescar, para depois.

>> Coment√°rio de filipedeschamps:
Pessoal, adicionei a tag `repescar` e estou fechando ela at√© que seja o momento certo de voltarmos com o assunto üëç
</issue_35_Proposta de Internacionaliza√ß√£o>

<issue_42_Padr√µes de commits e/ou PR>
Bom dia, pessoal.

Como na Milestone 1 tem como uma das metas a padroniza√ß√£o de commits, venho propor algumas regras que uso para contribuir em projetos com outros programadores. Costumo colocar essa regras no arquivo [CONTRIBUTING.md](https://github.com/filipedeschamps/tabnews.com.br/files/6694494/CONTRIBUTING.md).

Caso seja interessante, podemos ver uma adapta√ß√£o desse arquivo, ou a cria√ß√£o de um novo que seja mais coerente com a pol√≠tica do projeto.

>> Coment√°rio de CarlosZiegler:
Ola @JohnAzedo acredito que outra boa padronizacao seria de BUG reportadas, colocar padrao como:

Descreva o bug
.....

Reproduzir
Passos para reproduzir o comportamento:
....

Link Codesandbox ( caso necessario )
....

Comportamento esperado
....

Capturas de tela
....

Contexto adicional
...

Acredito que se desde o inicio adotar-mos um padrao e documentar ficara mais facil a compreensao de todos os envolvidos.

>> Coment√°rio de CarlosZiegler:
Encontei isso aqui na outra Issue acho que vale a pena trocar uma ideia sobre isso.  @thenriquedb 
https://github.com/filipedeschamps/tabnews.com.br/issues/4#issuecomment-862745118

>> Coment√°rio de johnazedo:
Boa, n√£o tinha pensado nesse caso. Vou refatorar o arquivo e volto a postar aqui.

>> Coment√°rio de johnazedo:
## Reportando Bugs

Na hora da cria√ß√£o de reporte de bugs, √© importante descrever com detalhes o erro e onde voc√™ o encontrou, para isso voc√™ ter√° que informar alguns infoma√ß√µes importantes, como:


| T√≥pico | Descri√ß√£o | Opcional |
|----|----|---|
|Resumo | Tente resumir em uma frase o problema com o bug para ser usado no t√≠tulo. | :x: |
|Descri√ß√£o | Na descri√ß√£o tente ser o mais detalhado poss√≠vel sobre o erro. | :x: |
|Reprodu√ß√£o | Tente informar o caminho que voc√™ seguiu para chegar no erro, isso √© importante pois facilitar√° outros desenvolvedores a identificarem o bug e resolver. | :x: | 
|Comportamento esperado| Detalhe o que voc√™ esperava acontecer quando o erro apareceu. | :x: |
|Captura de tela| Para ficar mais f√°cil, voc√™ pode enviar capturas de sua tela para apresentar melhor o problema encontrado | :heavy_check_mark: |
| Solu√ßao | Voc√™ pode descrever uma poss√≠vel solu√ß√£o para o problema | :heavy_check_mark: | 

### Exemplo de uso

```md

# Problema na cria√ß√£o do usu√°rio

Quando vou cadastrar um usu√°rio e erro algum campo, √© apontado um erro no topo do formul√°rio mas n√£o especifica em qual campo o erro aconteceu.

## Como reproduzir?

- Acesse tabnews.com.br/cadastro;
- Preencha todo o formul√°rio mas deixe um campo errado;
- Envie o formul√°rio.

## Comportamento esperado?

Estava esperando que o formul√°rio mostrasse qual campo eu errei deixando ele em vermelho e o porqu√™ que eu errei, informando a mensagem do problema.

```

>> Coment√°rio de johnazedo:
@CarlosZiegler aqui est√° o arquivo completo [CONTRIBUTING.md](https://github.com/filipedeschamps/tabnews.com.br/files/6718220/CONTRIBUTING.md)

>> Coment√°rio de devinvestidor:
O que acham de adicionarmos o [commitlint](https://github.com/conventional-changelog/commitlint) + [husky](https://github.com/typicode/husky) + [commitizen](https://github.com/commitizen/cz-cli) para nos ajudar nessa tarefa?

>> Coment√°rio de johnazedo:
## Branchs

As branchs que deve-se criar tem que conter um prefixo apontando qual classifica√ß√£o principal da mesma.

| Prefixo | Descri√ß√£o|
|----|----|
|feature|Implementa√ß√£o de nova funcionalidade no sistema.|
|fix|Conserto de erros apresentados pelo software ou melhoria no c√µdigo.|
|docs|Modifica√ß√£o nos documentos do programa.|
|style|Branch destinada apenas para mudan√ßas no template.|
|test|Branch destinada para cria√ß√£o de testes nas novas features.

Al√©m disso, deve-se sempre destinar uma branch a uma ou mais issues, ou seja, para que uma branch ser criada precisa de criar uma isseu com um problema a solucionar. 
Lembre-se que sempre se deve colocar o n√∫mero da issue na t√≠tulo da branch.

### Exemplo de uso

```sh
feature/#12
feature-create-users-28
fix-23
...
```

>> Coment√°rio de johnazedo:
## Commits

Esses marcadores s√£o importantes para diminuir a quantidade de arquivos de cada commit, permitindo ao gestor ou programador-chefe a r√°pida verifica√ß√£o na mudan√ßa do c√≥digo.

| Prefixo | Descri√ß√£o|
|----|----|
|feature|Arquivos com implementa√ß√£o de nova funcionalidade no sistema.|
|fix|Conserto de erros apresentados pelo software ou melhoria no c√µdigo.|
|docs|Modifica√ß√£o nos documentos do programa, removendo ou adicionando coment√°rios no c√≥digo.|
|style|Modifica√ß√µes principais nos templates do site.|
|test|Cria√ß√£o de testes nas novas features.

Deve-se sempre colocar os marcadores na descri√ß√£o do commit.

### Exemplo de uso

```sh
git commit -m "feature: Create user"
git commit -m "fix: Fixing DNS error"
git commit -m "test: Creating tests to profile views"
```

>> Coment√°rio de johnazedo:
## Pull Request

Todos os pull requests ser√£o feitos pela interface web do github. Deve-se sempre destinar a algum review, ou seja, sempre marcar outra pessoa do time para verificar seu c√≥digo. 

A estrutura do pull request deve ter como t√≠tulo a modifica√ß√£o mais relevante feita naquela branch, a issue referente apontada no corpo do PR, uma descri√ß√£o mais aprofundada das modifica√ß√µes e sugest√µes de poss√≠veis melhorias.

### Exemplo de uso

```md
# Cria√ß√£o de usu√°rio finalizada

A funcionalidade de cria√ß√£o de usu√°rio est√° completa, juntamente com testes e a documenta√ß√£o da feature.

Resolved #12

## O que foi feito?
- P√°gina de cadastro;
- Middleware para salvar logs de visitantes;
- Documenta√ß√£o de caso de uso e de fluxo feitos;
- Testes E2E feitos para essa funcionalidade.

## Sugest√µes
- Modificar banco de dados para incluir CPF na pr√≥xima vers√£o
```

>> Coment√°rio de filipedeschamps:
Que thread sensacional!!!!! üòç Eu n√£o tinha nem considerado os padr√µes de templates para Issues ou Branches üòÇ 

Uma sugest√£o para avan√ßarmos: separar uma das coisas propostas por essa issue (padr√£o de commits) e atacar primeiro ela com as solu√ß√µes propostas pelo @karanalpe para j√° pegar erros no `pre-commit` hook, e engatar tamb√©m essas coisas nos checks aqui do Github. Isso nos vai dar a garantia que navegar pelo hist√≥rico de commits vai ser algo sano.

Das outras sugest√µes, lendo a thread me veio uma sensa√ß√£o que, para o est√°gio **atual** do projeto (que est√° em super beta privado e num ambiente controlado), o saldo de toda essa padroniza√ß√£o n√£o vai ser positivo. Ent√£o minha sugest√£o √© fazermos isso num timing melhor, que pode ser logo antes de abrirmos o reposit√≥rio de forma **p√∫blica** para a comunidade. O que acham? Da√≠ a gente traz todas essas regras de contribui√ß√µes atrav√©s de templates para Issues e PRs e que com certeza v√£o fazer toda diferen√ßa quando o projeto receber o ru√≠do do mund√£o l√° fora.

E quem pode nos ajudar a implementar no reposit√≥rio as regras de commit, junto aos hooks e checks aqui do Github?

>> Coment√°rio de rodrigoKulb:
@filipedeschamps e @JohnAzedo o que acham de criar um (rules.md ou good-habits.md) Com algumas boas pr√°ticas de Commits, Branchs etc...?
Assim podemos sempre atualizar esse arquivo "padr√£o" conforme evolu√ß√£o do projeto, finalizando essa Issues.

>> Coment√°rio de johnazedo:
@rodrigoKulb e @filipedeschamps  Acho a ideia √≥tima, deixamos isso com sugest√µes at√© o reposit√≥rio ir para sua forma p√∫blica. Posso escrever um documento para servir como modelo e n√£o como regra em si.

>> Coment√°rio de brunofamiliar:
> ## Reportando Bugs
> Na hora da cria√ß√£o de reporte de bugs, √© importante descrever com detalhes o erro e onde voc√™ o encontrou, para isso voc√™ ter√° que informar alguns infoma√ß√µes importantes, como:
> 
> T√≥pico	Descri√ß√£o	Opcional
> Resumo	Tente resumir em uma frase o problema com o bug para ser usado no t√≠tulo.	‚ùå
> Descri√ß√£o	Na descri√ß√£o tente ser o mais detalhado poss√≠vel sobre o erro.	‚ùå
> Reprodu√ß√£o	Tente informar o caminho que voc√™ seguiu para chegar no erro, isso √© importante pois facilitar√° outros desenvolvedores a identificarem o bug e resolver.	‚ùå
> Comportamento esperado	Detalhe o que voc√™ esperava acontecer quando o erro apareceu.	‚ùå
> Captura de tela	Para ficar mais f√°cil, voc√™ pode enviar capturas de sua tela para apresentar melhor o problema encontrado	‚úîÔ∏è
> Solu√ßao	Voc√™ pode descrever uma poss√≠vel solu√ß√£o para o problema	‚úîÔ∏è
> ### Exemplo de uso
> ```lisp
> # Problema na cria√ß√£o do usu√°rio
> 
> Quando vou cadastrar um usu√°rio e erro algum campo, √© apontado um erro no topo do formul√°rio mas n√£o especifica em qual campo o erro aconteceu.
> 
> ## Como reproduzir?
> 
> - Acesse tabnews.com.br/cadastro;
> - Preencha todo o formul√°rio mas deixe um campo errado;
> - Envie o formul√°rio.
> 
> ## Comportamento esperado?
> 
> Estava esperando que o formul√°rio mostrasse qual campo eu errei deixando ele em vermelho e o porqu√™ que eu errei, informando a mensagem do problema.
> ```

Em rela√ß√£o a isso, o que voc√™s acham de adicionar mais duas descri√ß√µes?

## Ambiente
Descrever qual ambiente ocorre o erro (navegador chrome, opera, firefox, edge..., servidor).

## URL da fonte
Informar endpoint onde foi identificado o erro

>> Coment√°rio de brunofamiliar:
> ## Pull Request
> Todos os pull requests ser√£o feitos pela interface web do github. Deve-se sempre destinar a algum review, ou seja, sempre marcar outra pessoa do time para verificar seu c√≥digo.
> 
> A estrutura do pull request deve ter como t√≠tulo a modifica√ß√£o mais relevante feita naquela branch, a issue referente apontada no corpo do PR, uma descri√ß√£o mais aprofundada das modifica√ß√µes e sugest√µes de poss√≠veis melhorias.
> 
> ### Exemplo de uso
> ```lisp
> # Cria√ß√£o de usu√°rio finalizada
> 
> A funcionalidade de cria√ß√£o de usu√°rio est√° completa, juntamente com testes e a documenta√ß√£o da feature.
> 
> Resolved #12
> 
> ## O que foi feito?
> - P√°gina de cadastro;
> - Middleware para salvar logs de visitantes;
> - Documenta√ß√£o de caso de uso e de fluxo feitos;
> - Testes E2E feitos para essa funcionalidade.
> 
> ## Sugest√µes
> - Modificar banco de dados para incluir CPF na pr√≥xima vers√£o
> ```

Essa quest√£o eu acho sensacional e fundamental para o projeto. Com o code review, al√©m de manter o c√≥digo "bem codado", teremos uma grandiosa oportunidade de aprender com outras pessoas, e olhar pra nossas entregas em diferentes pontos de vista. Isso vai dar um UP em nosso conhecimento concerteza

>> Coment√°rio de rodrigoKulb:
@JohnAzedo acredito que pode criar essa PR com o arquivo CONTRIBUTING.md com uma pequena introdu√ß√£o informando que o objetivo desse arquivo √© deixar um modelo de boas pr√°ticas para melhorar a interatividade e organiza√ß√£o entre os colaboradores do projeto.

Assim j√° podemos ir evoluindo esse arquivo at√© liberar ao publico externo.

Edit: Se o @filipedeschamps achar melhor deixar para o futuro, devemos finalizar essa Issue e adicionar no grupo **repescar**

>> Coment√°rio de filipedeschamps:
Turma, fiz o PR #80 que implementa parcialmente o que foi descrito nessa issue üëç  eu marquei ela com a tag `repescar`, pois sugiro reduzir o escopo apenas para as mensagens de commit e deixar a padroniza√ß√£o de outros conte√∫dos para quando formos abrir o reposit√≥rio publicamente üëç
</issue_42_Padr√µes de commits e/ou PR>

<issue_43_Implementacao de Acessibilidade Web>
Ola Pessoal, trazendo uma outra proposta aqui. Vejo que o @filipedeschamps tem sempre o objetivo de trazer todo seu conteudo de forma a deixar isso acessivel para todos os niveis de programadores/ apaixonados por TI. E acho que quando estamos implementando um projeto como esse, o ideal seria se atentar na implementacao de acessibilidade digital, para ajudar na inclusao de todos.
 
**O que √© a acessibilidade web?**
A Acessibilidade web envolve uma s√©rie de recursos que possibilitam a navega√ß√£o, a compreens√£o e a intera√ß√£o de todas as pessoa na internet, independentemente de suas dificuldades ou limita√ß√µes.
Isso significa que sites, ferramentas e tecnologias s√£o projetados, desenvolvidos e codificados adequadamente para que pessoas com defici√™ncias permanentes ou com incapacidades moment√¢neas possam us√°-los. Dessa forma as pessoas, independentemente de suas limita√ß√µes, podem perceber, entender, navegar, interagir e contribuir para o ambiente em que aquela p√°gina ou programa √© disponibilizado na web.

**Publico Alvo**
***Pessoas cegas***
Usu√°rios cegos utilizam sites por meio de um leitor de tela, que √© navegado exclusivamente pelo teclado. Para fazer esse teste, considere navegar em seu site com a tecla TAB. Verifique se voc√™ consegue chegar em todos os inputs e bot√µes poss√≠veis, realizar a√ß√µes com eles de forma sequencial.

***Pessoas com baixa vis√£o ou dalt√¥nicas***
Usu√°rios com daltonismo ou baixa vis√£o utilizam fun√ß√µes de alto contraste ou adapta√ß√µes de cores para imagens e textos. Sua p√°gina possui alguma destas op√ß√µes?

***Pessoas surdas ou com audi√ß√£o comprometida***
Pessoas surdas fazem uso do transcritor de texto em l√≠ngua de sinais integrado ao site e tamb√©m, de descri√ß√µes em v√≠deos. Seu site possui alguma op√ß√£o de tradu√ß√£o livre em l√≠ngua de sinais?

***Dislexia e outras defici√™ncias intelectuais***
Esse grupo de pessoas possui dificuldade em interagir com elementos da tela muito pequenos ou de acesso complexo, como menus em navbars ou bot√µes mal posicionados.

**Web Content Accessibility Guidelines (WCAG)**

- Navega√ß√£o limpa
- Ordem de tabula√ß√£o
- Marcos e mapas do site
- Estrutura do HTML
- T√≠tulos expressivos
- Cabe√ßalhos bem inseridos e definidos
- Listas de conte√∫do
- Texto
- Contraste
- Cor
- Imagens descritivas

Referencia: https://dev.to/aryclenio/um-guia-pratico-da-acessibilidade-web-parte-1-meu-site-e-acessivel-39do

>> Coment√°rio de thenriquedb:
Coincidentemente este √© um assunto que venho estudando bastante ultimamente, com isso gostaria de indicar algumas referencias  caso algu√©m queira se aprofundar e mais sobre o assunto!.

- [Acessibilidade na Web: Boas pr√°ticas para construir sites e aplica√ß√µes acess√≠veis](https://www.amazon.com.br/Acessibilidade-Web-construir-aplica%C3%A7%C3%B5es-acess%C3%ADveis-ebook/dp/B0882KDCHK)
- [Acessibilidade web ‚Äì Hipsters #21](https://hipsters.tech/acessibilidade-web-hipsters-21/)
- [Programar sem enxergar ‚Äì Hipsters #82
](https://hipsters.tech/programar-sem-enxergar-hipsters-82/)
- [Reposit√≥rio com links relacionados a diversos assuntos.](https://github.com/liviagabos/bookmark)
- [Hipsters Ponto Talks #8 - Acessibilidade Web](https://youtu.be/6ghtETGFKxw)

>> Coment√°rio de filipedeschamps:
Que issue sensacional @CarlosZiegler üòç 

E @thenriquedb muito obrigado pela curadoria do material üëç 

Voc√™s topam serem os guardi√µes desse assunto? Como voc√™s possuem mais experi√™ncia, poder√£o nos guiar ao longo das implementa√ß√µes/PRs e entender se estamos atendendo a esses crit√©rios. Seria uma experi√™ncia maravilhosa ir aprendendo mais sobre acessibilidade ao longo dos PRs, e ir ajustando os itens em tempo de execu√ß√£o. Tenho certeza que **muita** gente vai aprender s√≥ de acompanhar essas trocas de informa√ß√£o ü§ù

>> Coment√°rio de CarlosZiegler:
@filipedeschamps agradeco mas acredito que so levantei a bola e o @thenriquedb cortou ahah. Vou acompanhar o projeto e me aprofundar mais sobre o assunto com os links que foram passados.

>> Coment√°rio de Dgdiniz:
Ol√°, isso tem a ver com ARIA (Accessible Rich Internet Applications), certo? Lembro que quando criei um site pro meu canal do Youtube comecei a estudar sobre isso mas acabei n√£o avan√ßando. Vi o b√°sico apenas, principalmente do link abaixo, que tem bastante coisa:

https://developer.mozilla.org/pt-BR/docs/Web/Accessibility/ARIA

>> Coment√°rio de filipedeschamps:
Turma, acessibilidade √© uma feature que precisa estar no projeto desde o dia zero. Assim como eu pedi a permiss√£o para ser o Guia que vai tentar deixar as coisas o _suficientemente simples_, vamos elencar um Guia para os assuntos de acessibilidade? E temos uma √≥tima chance de fazer isso, que √© na Milestone 2 (a pr√≥xima) onde ser√° a primeira onde iremos disponibilizar conte√∫dos de valor concreto para internet.

Ent√£o para n√£o ter chance disso acabar sendo esquecido, eu acabei de editar o primeiro coment√°rio l√° da issue RFC das Milestones, e adicionei um item espec√≠fico para definirmos quem ser√° esse Guia (ou como iremos abordar isso) ü§ù

>> Coment√°rio de filipedeschamps:
Turma, como eu j√° adicionei isso no RFC da Milestone 2, e vou criar uma issue espec√≠fica para definirmos quem vai querer ser o Guia desse assunto, eu vou fechar essa issue e fazer refer√™ncia a ela (at√© porque ela lista materiais sensacionais), combinado? ü§ù
</issue_43_Implementacao de Acessibilidade Web>

<issue_51_Bug: Alguns avatares quando no modo Zoom n√£o s√£o ajustados>
Pessoal, o √∫ltimo PR https://github.com/filipedeschamps/tabnews.com.br/pull/49 adicionou uma feature sensacional de passar o mouse em cima e o avatar dar zoom, mas cada imagem que vem do Github pode vir com um tamanho diferente e algumas situa√ß√µes fica estranho.

![image](https://user-images.githubusercontent.com/4248081/123323507-724cbe80-d4ea-11eb-9602-6664bca2978a.png)

![image](https://user-images.githubusercontent.com/4248081/123323542-7bd62680-d4ea-11eb-9629-665f8cbcaf1d.png)

**Link com o bug: https://www.tabnews.com.br/pocs/construction-02**

**Algu√©m tem alguma sugest√£o de como consertar? Como fo√ßar a imagem ocupar o espa√ßo inteiro, sem crop** üëç

>> Coment√°rio de geovani-brito:
Pelo que entendi n√£o √© no tamanho da imagem que vem do Github que t√° o problema. Mas sim porque o zoom d√° um corte na foto pegando a partir do centro. Talvez isso se revolva fazendo o zoom ser na foto inteira.

>> Coment√°rio de MichelSilvas:
Fiz o PR #52 pra ajustar:
https://tabnews-git-vop1234-filipedeschamps.vercel.app/pocs/construction-02

>> Coment√°rio de geovani-brito:
![image](https://user-images.githubusercontent.com/3690366/123327001-4b08e800-d510-11eb-9709-ea64df548832.png)

Agora sim, @MichelSilvas!

Acho que ficaria legal tamb√©m uma borda em volta da foto pra n√£o confundir com o fundo.

>> Coment√°rio de filipedeschamps:
Voc√™s s√£o MUITO massa!!!!! To contando aqui pra Renata e comemorando como ta sendo massa juntar for√ßas com voc√™s ü§ù
</issue_51_Bug: Alguns avatares quando no modo Zoom n√£o s√£o ajustados>

<issue_57_Fix: A Tab do Tabnews est√° sem favicon>
Esquecemos de colocar o favicon, acreditam ser muito importante?

![Captura de tela em 2021-06-25 19-59-21](https://user-images.githubusercontent.com/5334261/123492471-f472db00-d5ef-11eb-9640-0fac1304d0f6.png)

>> Coment√°rio de filipedeschamps:
Acho show colocar @rodrigoKulb üëç mas topo mais ainda nessa p√°gina em espec√≠fico deixar sem, inclusive n√£o tocar mais nela para ela de fato "envelhecer" e l√° no futuro vermos como evolu√≠mos üòÇ 

De qualquer forma, quando fizermos o layout final, n√£o podemos esquecer disso üëç

>> Coment√°rio de geovani-brito:
O Filipe quer que essa p√°gina seja como aquela foto que voc√™ tirou de um momento importante da vida, usando uma m√°quina Kodaq de filme onde voc√™ saiu com os olhos fechados ou fazendo uma careta esquisita. Por√©m, o dia foi especial, ficou na sua mem√≥ria mas tudo que voc√™ tem pra mostrar √© essa foto imperfeita de um dia perfeito.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps e @geovani-brito com certeza! 
Vou finalizar esse Issues, fica como lembrete para o site final!

>> Coment√°rio de filipedeschamps:
> mas tudo que voc√™ tem pra mostrar √© essa foto imperfeita de um dia perfeito.

hahahahah que frase **SENSACIONAAAAL** üòÇ üòÇ üòÇ üòÇ üòÇ enquanto isso na live temos que "o TabNews n√£o √© um produto..." üòÇ üòÇ üòÇ üëç

>> Coment√°rio de brunofamiliar:
Pior de tudo √© que eu descobri um bugzinho no commit que fiz hoje ü§¶üèΩ‚Äç‚ôÇÔ∏èü§¶üèΩ‚Äç‚ôÇÔ∏è

>> Coment√°rio de filipedeschamps:
Hahaha qual?

On Fri, Jun 25, 2021 at 5:01 PM Edson Bruno ***@***.***>
wrote:

> Pior de tudo √© que eu descobri um bugzinho no commit que fiz hoje
> ü§¶üèΩ‚Äç‚ôÇÔ∏èü§¶üèΩ‚Äç‚ôÇÔ∏è
>
> ‚Äî
> You are receiving this because you were mentioned.
>
>
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/57#issuecomment-868889557>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ABANEEPIANOCDJLUB2E575DTUUKFDANCNFSM47KWBHNQ>
> .
>

>> Coment√°rio de rodrigoKulb:
@brunofamiliar acho que eu sei hahahaha!!
A div azul n√£o some nos √≠cones da borda, acertei? Isso √© um **easter egg** hahaha!!
![Captura de tela em 2021-06-25 21-11-56](https://user-images.githubusercontent.com/5334261/123495426-0d808980-d5fa-11eb-9a03-62133ff34975.png)

>> Coment√°rio de filipedeschamps:
Um que eu peguei agora √© pelo celular, quando d√° o zoom, ele esmaga a grid/pagina e fica um padding direito üòÇüëç

![90D80A43-D509-4920-951F-87D8D17C9629](https://user-images.githubusercontent.com/4248081/123495579-2f1d4900-d5d9-11eb-9e07-c159c9ead922.png)

>> Coment√°rio de brunofamiliar:
> @brunofamiliar acho que eu sei hahahaha!!
> A div azul n√£o some nos √≠cones da borda, acertei? Isso √© um **easter egg** hahaha!!
> ![Captura de tela em 2021-06-25 21-11-56](https://user-images.githubusercontent.com/5334261/123495426-0d808980-d5fa-11eb-9a03-62133ff34975.png)

Concerteza kk isso mesmo, mas foi besteira minha, commitei uma linha de codigo que n√£o era pra ter commitado kkkk

![image](https://user-images.githubusercontent.com/32016729/123495953-2427e000-d5fc-11eb-9897-bf5abc54fe68.png)

Era pra ser um objeto vazio ai nessa linha üòÇüòÇ

>> Coment√°rio de brunofamiliar:
> Um que eu peguei agora √© pelo celular, quando d√° o zoom, ele esmaga a grid/pagina e fica um padding direito üòÇüëç
> 
> ![90D80A43-D509-4920-951F-87D8D17C9629](https://user-images.githubusercontent.com/4248081/123495579-2f1d4900-d5d9-11eb-9e07-c159c9ead922.png)
> 

Complementando essa incid√™ncia kkkk se voc√™ segurar a imagem e arrastar pra cima (no mobile), ele n√£o vai apresentar o username, apenas d√° o zoom. O zoom foi implementado com evento de hover, j√° o que eu fiz eu usei o mouse enter/leave kkk n√£o sei se foi uma boa abordagem que eu fiz ü§îü§î


![Screenshot_20210625-212933.png](https://user-images.githubusercontent.com/32016729/123496067-ab755380-d5fc-11eb-8f73-6f467ac10280.png)

>> Coment√°rio de rodrigoKulb:
> Era pra ser um objeto vazio ai nessa linha ü§£Ô∏è

Nos 45 min do segundo tempo na sexta-feira, ficou pra hist√≥ria!

TabNews n√£o √© um produto √© uma experi√™ncia ü§£Ô∏èü§£Ô∏è

>> Coment√°rio de geovani-brito:
![image](https://user-images.githubusercontent.com/3690366/123496120-0313bf00-d5fd-11eb-9256-a7034e5ddfb5.png)

Tamb√©m achei um imperfei√ß√£ozinha. No computador as fotos do canto ficam com os username cortados. O bom √© que isso n√£o tem import√¢ncia j√° que d√° pra clicar e ir para o perfil da pessoa onde tem mais que o username. √â s√≥ um erro est√©tico.
</issue_57_Fix: A Tab do Tabnews est√° sem favicon>

<issue_59_Proposta de design>
Criei uma proposta de layout para o TabNews, envolvendo outras telas e intera√ß√µes conforme verifiquei que o pessoal foi comentando e dando sugest√µes na outra issue #6 pelo @luantoningalvan.

Segue os links para a proje√ß√£o e para a prototipa√ß√£o no figma. Mals as inconsist√™ncias, sou um desenvolvedor que tenta criar boas interfaces üòÜ.

**Proje√ß√£o**
https://www.figma.com/file/aSjqvEUZYSQwYFIQ0KO4Fp/TabNews?node-id=43%3A673

**Prototipa√ß√£o**
https://www.figma.com/proto/aSjqvEUZYSQwYFIQ0KO4Fp/TabNews?node-id=43%3A673&scaling=min-zoom&page-id=0%3A1&hide-ui=1


## Proposta
- Layout pensado no conte√∫do
- Todo o site acess√≠vel pelo teclado
- Tabcoins e pontos de experi√™ncia dispon√≠vel na barra superior
- Link para o projeto no Github
- Central de notifica√ß√µes
- Tags em posts
- Acionar Text to Speech em cada post como sugerido pelo @daniloster
- Pesquisar por tags como sugerido pelo @LuanEdCosta. 
- Pesquisar por voz
- Menu do usu√°rio no avatar como sugerido pelo @filipedeschamps. 
- Accent color configur√°vel dentro do menu do usu√°rio, como sugerido pelo @brunofamiliar e pelo @filipedeschamps
- Adi√ß√£o de espa√ßo de ads para custear o projeto (mais sobre na se√ß√£o abaixo)
- Adi√ß√£o de um "footer" sobre a cria√ß√£o do projeto
- Post completo abrindo diretamente na p√°gina principal como um overlay
- Sistema de vota√ß√£o dos coment√°rios como o Stack Overflow ou Disqus
- Link para reportar a postagem caso for identificado uma fake news ou postagens desrespeitosa

### An√∫ncios
Coloquei um espa√ßo de anuncio reservado para custear o projeto, tipo custo com os servidores, como o @filipedeschamps comentou em algum dos v√≠deos do membro. Coloquei o Carbon como exemplo devido ser um √≥timo sistema de ads para projetos de tecnologia. A ideia n√£o seria abrir espa√ßos comprados nem nada disso. O Carbon, por exemplo, seria o √∫nico sistema de ads externo apenas para custear o projeto.

### Imagens

**Home**
![home](https://user-images.githubusercontent.com/4511733/124396955-2f0cff80-dce3-11eb-86d3-6fd5e9b4167d.jpg)

**Post**
![Post](https://user-images.githubusercontent.com/4511733/124397162-a68f5e80-dce4-11eb-8026-61e7db789f1c.jpg)

>> Coment√°rio de filipedeschamps:
Caramba que massa @rhandrade **muito** obrigado pela colabora√ß√£o e excelentes pontos levantados na parte da proposta!!! Isso ajuda a pensar na ideia por v√°rios √¢ngulos ü§ù üëç

>> Coment√°rio de rodrigoKulb:
@rhandrade ficou bem legal, adorei a ideia de utilizar **Tags em posts**!

>> Coment√°rio de filipedeschamps:
Atendendo ao objetivo da issue #63 da atual Milestone, estou fechando essa issue, **mas isso n√£o significa** que essa conversa foi descartada ou deve ser interrompida, muito pelo contr√°rio, esta issue pode ser reaberta a qualquer momento que necess√°rio. Estou marcando ela tamb√©m com a label `repescar` para ser mais f√°cil de encontrar caso chegue o momento certo de voltarmos a discutir sobre ela ü§ù

>> Coment√°rio de Ryannnkl:
> Muito bonito @rhandrade 

algo que me fez pensar, a gente utiliza os componentes do Prime do github e por mais que sejam excelentes faltam coisas que eles n√£o implementam ou n√£o faz parte da ideia deles.

Penso que seria muito vantajoso seria criar um fork do prime para a comunidade criar componentes ou modificar a estiliza√ß√£o de algumas partes e criar um Design System do Tabnews baseado no Prime, sinto falta de coisas como:

- hidden and show password no pr√≥prio campo de input caso seja um input de senha
- alerta personaliz√°vel
- componente de calend√°rio
- Dropdown
- Select (o select do prime n√£o √© nada de mais)
- Table (apesar do componente Box resolver, n√£o √© bem o esperado)

enfim, sei que criar um design system √© algo desafiador, mas √© algo que vai valer bastante a pena.

>> Coment√°rio de Rafatcb:
Estou removendo a label `repescar` do issue e criando esse coment√°rio para termos um hist√≥rico do motivo dessa decis√£o.

Na fase em que estamos do TabNews, j√° n√£o faz sentido um "redesign total", primeiro porque seria um grande esfor√ßo direcionado para algo est√©tico, enquanto que temos v√°rias coisas legais a serem implementadas (veja o Milestone 7 que estamos agora https://github.com/filipedeschamps/tabnews.com.br/issues/1490); e segundo que a est√©tica √© algo bem pessoal e com certeza teremos pessoas que preferir√£o a nova e pessoas que preferir√£o a antiga, ent√£o haveria uma divis√£o do p√∫blico.

Acredito que a interface que temos hoje tem servido bem o p√∫blico do TabNews, e fazemos melhorias incrementais nela conforme necessitamos.

Um coment√°rio adicional: @Ryannnkl criar um fork do Primer tem mais pontos negativos do que positivos, porque seria um projeto a mais para cuidar, o que seria invi√°vel. Apesar disso, nada impede que criemos algumas varia√ß√µes ou novos componentes aqui no pr√≥prio reposit√≥rio do TabNews, conforme necess√°rio, ao mesmo tempo que fazemos uso dos esfor√ßos empenhados pela equipe do Primer.

Faz total sentido termos cuidado com os nossos componentes :+1:
</issue_59_Proposta de design>

<issue_60_Padr√µes de linter/code style>
Oi pessoal,
Como ainda n√£o vi sugest√£o desta parte na milestone da funda√ß√£o, vim compartilhar oq tenho utilizado, se alguem tiver algo diferente, mais interessante, ou talvez algo mais padronizado para projetos Next.js. Fica a vontade para compartilhar.

1)
Independente do linter (apesar de usar o eslint), o que tem ajudado muito, muito mesmo √© utilizar o https://prettier.io e um arquivo de configura√ß√£o com o "padr√£o", tambem utilizo um plugin do VSCODE que ao salvar os arquivos, tudo √© formatado para o padr√£o, desta forma, meu lint acaba nunca falhando...

2)
Segue o padr√£o que tenho utilizado nos projetos Javascripts:

```
# .prettierrc.js

module.exports = {
  semi: false,              // N√£o precisa de ; no final das linhas
  singleQuote: true,
  tabWidth: 2,
  useTabs: false,          // n√£o usa tabs no lugar de espa√ßo
  trailingComma: 'es5',    // https://prettier.io/docs/en/options.html#trailing-commas
  arrowParens: 'always',   // mantem o () nas arrow functions
}

```

Resumo:
- o eslint ou qualquer outro no package.json, dai no CI tem a valida√ß√£o autom√°tica para ver se tudo est√° no formato corretamente anes do deploy. Pega erro de sintaxe tambem
- um arquivo .rc para deixar expl√≠cito qual o padr√£o de formata√ß√£o, assim as pessoas tambem ficam livres para utilizar outros plugins/formatadores
- um plugin (no editor) para ajudar no trabalho de formata√ß√£o/verifica√ß√£o ao mesmo tempo que estamos codando.

Abra√ßo

>> Coment√°rio de huogerac:
Issue relacionada: #42

>> Coment√°rio de filipedeschamps:
@huogerac topo 100% e tamb√©m uso o Prettier e √© fant√°stico, eu uso tudo no default mesmo e nunca mais me preocupei com formata√ß√£o. Independente de qual configura√ß√£o dentro do Prettier usar, acho muito massa sugerir as pessoas usarem esse modulo e impor isso nos checks de um PR.

E da sua configura√ß√£o, a √∫nica coisa que eu mudaria √© o `semi` para ele colocar `;` ao final dos statements. Eu pessoalmente adoro programar sem, mas a maioria das pessoas se sentem distra√≠das por isso que chega a ser contraprodutivo üòÇ 

Topa fazer um PR trazendo essa implementa√ß√£o pro projeto? ü§ù

>> Coment√°rio de brunofamiliar:
Eu j√° utilizei o Prettier em um projeto react e achei fant√°stico o qu√£o auxila na padroniza√ß√£o do formato do c√≥digo. Eu tamb√©m programo sem o `;`, mas hoje algumas empresas de refer√™ncia no mercado, como a google por exemplo; recomenda que cada instru√ß√£o seja finalizada com o `;`. Acredito que por uma quest√£o de est√©tica, seria interessante manter.

>> Coment√°rio de huogerac:
Pessoal que usa VSCODE,

Se adicionar o conte√∫do abaixo no .vscode/settings.json, ele salva com formata√ß√£o (linter):
```
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true
}
```

>> Coment√°rio de filipedeschamps:
Show! E temos que ter algo como um `.prettierrc` para o editor saber que √© um projeto que deve ser formatado por ele üëç
</issue_60_Padr√µes de linter/code style>

<issue_61_Conex√£o com o banco & Migrations>
Ol√° pessoal,

Acredito que a funda√ß√£o deste tema est√° dividido em 3 partes:
- Conex√£o com o banco de dados
- Migra√ß√µes para criar/alterar as tabelas de forma program√°tica
- Consulta ao banco (que pode ou n√£o utilizar um ORM)

Me parece que no Next.js tem o https://www.prisma.io/ e https://github.com/typeorm/typeorm.
Aparentemente resolvem os 3 pontos acima. Talvez uma desvantagens √© ter que instalar typescript (j√° que o projeto inicialmente n√£o vai us√°-lo)

Uma alternativa que acredito interessante e n√£o sei se no NodeJS/Javascript tem, √© algo que j√° utilizei no Python, algo nesta linha aqui: https://nackjicholson.github.io/aiosql/

√â bem minimalista, ou seja, temos que resolver a conex√£o e migrations com outras bibliotecas,
mas √© muito mais simples, n√£o tem um ORM (e defini√ß√µes de Models)

Obs: ORM √© bem legal, tem diversas vantagens, mas a maior desvantagem pode ser que quando voce precisa fazer uma consulta um pouquinho mais complicada, coisa q no SQL puro √© bem simples e direto, no ORM pode ser dificil

Tem isto em varias linguagens, onde temos o SQL puro, mas ainda separado e com uma abstra√ß√£o bem pequena

```
## No c√≥digo:
queries.get_all_greetings(conn)

## Na camada do banco:
-- name: get_all_greetings
-- Get all the greetings in the database
select greeting_id, greeting from greetings;
```

Bom, o que voces j√° trabalharam para resolver isto no nodejs/next.js?

Abra√ßo

>> Coment√°rio de herculesgabriel:
Massa, @huogerac! Das op√ß√µes que voc√™ trouxe eu j√° utilizei o TypeORM, sempre com TypeScript. Por√©m, √© poss√≠vel utiliz√°-lo com JavaScript tamb√©m, tanto puro quanto utilizando Babel para utilizar recursos experimentais da linguagem.

Exemplos na documenta√ß√£o do TypeORM:
https://github.com/typeorm/javascript-example
https://github.com/typeorm/babel-example

 O mesmo serve para o Prisma. Aqui na documenta√ß√£o tem o _getting started_ com JS:
https://www.prisma.io/docs/getting-started/setup-prisma/start-from-scratch-node-postgres

Esse √∫ltimo eu nunca cheguei a utilizar. Mas dei uma olhada na documenta√ß√£o e me pareceu interessante. Gostei da forma como √© feita a configura√ß√£o, me parece mais simples de entender.

Al√©m disso, tem tamb√©m o famoso [Sequelize](https://sequelize.org/master/), op√ß√£o madura tamb√©m.

Confesso que fiquei um pouco animado para testar o Prisma, mas n√£o tenho experi√™ncia para dizer se √© uma op√ß√£o segura, sendo que acredito ser o mais novo dos aqui citados.
https://www.prisma.io/nextjs

Quem conhecer o funcionamento dessas bibliotecas especificamente com o Next.js, caso exista alguma diferen√ßa significativa, pode contestar haha

>> Coment√°rio de rhandrade:
A grande desvantagem que eu vejo em n√£o usar um ORM √© se precisar migrar o banco de dados. J√° tive que fazer isso no passado e foi um trampo gigante, pois era tudo na m√£o e existiam comandos que n√£o eram compat√≠veis entre os bancos. 

Na minha opini√£o o ORM ajuda nisso, e caso precisar fazer alguma query mais complexa que o ORM complique ou n√£o de suporte, essas sim seriam feitas em SQL puro.

Acredito que aqui tamb√©m entraria aquela quest√£o que o @filipedeschamps pontuou, no qual o MySQL est√° mais preparado para um ambiente serveless do que o Postgres, por exemplo. Se quisermos come√ßar com um e depois mudar para outro poder√≠amos ter um grande retrabalho.

>> Coment√°rio de cezarmezzalira:
Opa pessoal, tudo certo?
J√° tive experi√™ncia com o Sequelize e com o TypeORM, que s√£o √≥timos ORM.
Como o foco do projeto por hora √© de utilizar apenas JS, na minha opini√£o eu iria com o Sequelize.
Ele √© muito massa para quest√£o de migrations e n√£o exige muita configura√ß√£o e nem a utiliza√ß√£o de notations para defini√ß√£o de tipos.
Quanto ao uso do banco de dados, s√≥ tenho experiencia em utilizar o postgres rodando em um container docker e a API rodando na mesma m√°quina no Digital Ocean. 
Mas acredito que daria para usar uma solu√ß√£o de banco em AWS, conforme a documenta√ß√£o da pr√≥pria Vercel : https://vercel.com/docs/solutions/databases

Um exemplo de aplica√ß√£o que usa o que o projeto j√° tem especificado est√° nesse post: 
https://javascript.plainenglish.io/next-js-with-sequelize-web-application-a-full-stack-web-development-a0051074e998

>> Coment√°rio de rodrigoKulb:
Pessoal ficou definido se vamos de MySQL üéâÔ∏è ou PostgreSQL üöÄÔ∏è ?

>> Coment√°rio de cezarmezzalira:
O @filipedeschamps tinha comentado sobre usar Postgres (PG), pois j√° era um banco que ele tinha usado na pagar.me com um √≥timo desempenho. Ele tamb√©m pontuou a quest√£o de que gostaria de explorar o m√°ximo do PG.
Na minha opini√£o, o PG √© um banco de dados maduro, tem a possibilidade de gravar dados em colunas JSON muito semelhante ao MongoDB, bem como √© open source üòÑ
Na AWS existe um plano gratuito de at√© 750h/m√™s no Amazon RDS, que poderia servir para come√ßarmos.

>> Coment√°rio de filipedeschamps:
# Voc√™s topam sofrer comigo? üòÇ 

Vamos implementar na ra√ßa nossas entidades e escrever na unha o SQL? De ORM eu j√° usei o Sequelize e **adoro** ele, de fato fazer todo o CRUD sai de gra√ßa, e como apontado pelo @rhandrade na hora de mudar de banco de dados, um ORM facilita bastante. E sempre d√° para fugir dele escrevendo as queries de forma `raw`.

Mas novamente eu pergunto, **voc√™s topam sofrer comigo?** Vamos para esse projeto fazer as coisas na m√£o, para realmente aprender um pouco mais sobre modelagem e principalmente SQL? Eu me sinto muito mais _future proof_ ou a _prova de balas_ dando um upgrade nas minhas habilidades sobre isso.

Claro que a gente n√£o precisa tirar todas as abstra√ß√µes ao ponto de implementar nosso pr√≥prio conector üòÇ mas sugiro usar algo como o m√≥dulo [pg](https://www.npmjs.com/package/pg). E eu vejo que independente do vai e volta de ORMs ou Query Builders, **a base fica ali s√≥lida**, nesse caso o conector com o banco de dados, e d√° pra ver no n√∫mero de downloads desse m√≥dulo. E √© super simples usar ele, olha s√≥ um trecho de c√≥digo (simplificado, tinha mais coisas) que fiz em outro projeto:

```js
// database.js

import { Pool } from "pg";
const pool = new Pool();

async function query(query) {
  const results = await pool.query(query);
  return results;
}

export default {
  query
};
```

Ele usa o `Pool` para reaproveitar as conex√µes. Nesse caso n√£o tem l√≥gica embutida para retry, mas d√° para fazer tamb√©m. E usar dentro do c√≥digo √© bem simple:

```js
// qualquer-dado.js

import database from "database.js";

async function QualquerDado(request, response) {
  const query = {
    text: `
    select *
    from tabela
    where coluna = $1;
    `,
    values: ["turma"],
  };

  const result = await database.query(query);

  return response.json({
    count: result.rows.length,
    dados: result.rows,
  });
}

export default QualquerDado;
```

## Quanto a Migration

Tem um m√≥dulo chamado [node-pg-migrate](https://www.npmjs.com/package/node-pg-migrate) que √© muito simples de usar, e aceita o Client criado pelo `pg`, ent√£o reaproveita e mesma conex√£o.

## Conclus√£o?

Como estamos em um ambiente novo, _super serveless_ eu diria üòÇ , me sinto muito mais seguro ter um pouco mais controle nessa camada. N√£o que isso v√° nos dar menos problemas, iclusive dever√≠amos colocar nossa expectativa que inicialmente teremos mais problemas, mas tamb√©m mais conhecimentos sobre o que est√° acontecendo, e pra mim isso tem valor infinito. Fora que, novamente, independente das novas abstra√ß√µes que criarem, a nossa base vai continuar s√≥lida. Topam?

>> Coment√°rio de brunofamiliar:
Sobre esse tema, j√° utilizei o Sequelize tamb√©m, minha experi√™ncia com essa lib foi das melhores üòÑ. Acredito que SQL n√£o √© um assunto trivial, e utilizando um ORM, perdemos um pouco dessa ess√™ncia de entender a fundo o comportamento de cada comando e o quanto isso pode refletir possitivamente / negativamente em nossa aplica√ß√£o. @filipedeschamps , analisei sua sugest√£o, acredito que podemos ter uma grande evolu√ß√£o nesse quesito. A √∫nica coisa que ainda eu me perguntaria √©: Ser√° que devemos nos preocupar nesse momento com a possibilidade de mudar o banco de dados? Porque se esse for o caso, vamos ter que ficar cientes que futuramente teremos um "trabalho" maior ao realizar a migra√ß√£o ( coloquei em aspas porque tudo coopera para nosso crescimento ).

>> Coment√°rio de filipedeschamps:
> A √∫nica coisa que ainda eu me perguntaria √©: Ser√° que devemos nos preocupar nesse momento com a possibilidade de mudar o banco de dados? Porque se esse for o caso, vamos ter que ficar cientes que futuramente teremos um "trabalho" maior ao realizar a migra√ß√£o ( coloquei em aspas porque tudo coopera para nosso crescimento ).

Excelente pergunta @brunofamiliar pensando aqui, sempre existe essa possibilidade e se ela vier a se tornar realidade, o que prevejo de impacto tirando a parte de infraestrutura √© o seguinte:

1. Conector com o banco: precisaremos trocar e reimplementar, mas essa √© a parte mais f√°cil.
2. Queries simples: n√£o vejo quase nenhum impacto nisso, e se tiver, vai ser simples consertar.
3. Queries complexas: imagino que j√° estar√≠amos usando diretamente queries raw, fora do ORM.
4. Migrations: apesar de ser algo simples, talvez nesse caso fosse mais f√°cil consolidar tudo numa √∫nica migration inicial e come√ßar tudo do zero, dado que para a nova vers√£o do c√≥digo n√£o interessa o que foi migrado no passado.

E como **qualquer previs√£o em tecnologia**, o que realmente vai acabar acontecendo √© a soma dos problemas previstos vezes 10 üòÇ mas √© o que √© üëç

>> Coment√°rio de brunofamiliar:
Show! Eu topo encarar esse desafio üòÑ

>> Coment√°rio de cezarmezzalira:
Vou contar uma coisa caras: sou viciado em escrever queries SQL ü§£ü§£

CHALLENGE ACCEPTEDüòé

>> Coment√°rio de rhandrade:
Show @filipedeschamps seguindo essa linha de racioc√≠nio faz sentido seguir com algo mais m√£o na massa. Topo encarar esse desafio.  üòÑ

>> Coment√°rio de boemekeld:
Super apoio a escolha de usar SQL! Inclusive, dando prefer√™ncia para SQL Standard sempre que poss√≠vel. 

Uma coisa que pode ajudar na transi√ß√£o para outro banco de dados √© documentar quais queries utilizam fun√ß√µes espec√≠ficas do banco de dados atual.

Quanto ao futuro, que √© serverless, voc√™m sabem n√©? üòÜ acredito que os serverless databases ir√£o evoluir para suportar SQL direto no Edge (possivelmente a partir do SQLite, que at√© j√° √© poss√≠vel execut√°-lo em Lambda ou Worker). Ent√£o, usando SQL, estaremos sempre bem preparados üòâ

>> Coment√°rio de rodrigoKulb:
SELECT * FROM membros-da-turma WHERE challenge LIKE "ACCEPTED"

Bora!!!

>> Coment√°rio de filipedeschamps:
Sensacionaaaal turma üòç 

Ent√£o sobre onde hospedar o banco de dados, [lendo uma discussion l√° no repo da Vercel](https://github.com/vercel/vercel/discussions/5696), o Digital Ocean se demonstrou uma excelente solu√ß√£o para um banco Postgres, pois com um clique voc√™ consegue colocar na frente da inst√¢ncia o `pg-bouncer` e que vai ajudar muito em gerenciar o limite de conex√µes com o banco (e isso pode acabar sendo o maior inimigo num ambiente serverless).

**Por√©m voc√™s aceitaram sofrer junto comigo** üòÇ  e o que acham de subir uma inst√¢ncia **primeiro sem o `pg-bouncer`** para visualizarmos na **pr√°tica** nossa aplica√ß√£o estourando por falta de conex√£o? Para realmente vivermos a elasticidade e limite desse tipo de situa√ß√£o, principalmente para lapidarmos nossa aplica√ß√£o a se comportar da forma certa em cen√°rios ruins (inclusive, quando tivermos conte√∫dos reais no site em forma est√°tica, ver o que fica em p√© de fato mesmo com o banco de dados fora).

E isso me fez entender que teremos que configurar um √≥timo **Log Drain** e configurar algum tipo de alerta em algum lugar. Acham v√°lido adicionarmos isso na pr√≥xima Milestone? N√£o temos nada sobre logs em nenhum lugar.

>> Coment√°rio de cezarmezzalira:
Pessoal, uma das minhas principais preocupa√ß√µes sobre usar SQL diretamente √© o SQL Injection, que √© algo que foi levantado nessa thread [aqui](https://github.com/dwyl/learn-postgresql/issues/64).
Dando uma olhada na [documenta√ß√£o ](https://node-postgres.com/features/queries#Parameterized%20query) do pg, encontrei uma parte sobre Queries bem bacana, onde explica que em situa√ß√µes de tabelas din√¢micas, √© recomendado usar o [pg-format](https://www.npmjs.com/package/pg-format).
Para esses casos, o melhor cen√°rio para queries de Inclus√£o, Altera√ß√£o e Exclus√£o seria passando os par√¢metros via par√¢metro `values`, como no exemplo abaixo, retirado desse [repo](https://github.com/rodrigobranas/youtube/blob/master/rest_api_4/server/data/postsData.js) do Rodrigo Branas:

```js
const database = require('../infra/database');

exports.getPosts = function () {
	return database.query('select * from blog.post');
};

exports.getPost = function (id) {
	return database.oneOrNone('select * from blog.post where id = $1', [id]);
};

exports.getPostByTitle = function (title) {
	return database.oneOrNone('select * from blog.post where title = $1', [title]);
};

exports.savePost = function (post) {
	return database.one('insert into blog.post (title, content) values ($1, $2) returning *', [post.title, post.content]);
};

exports.updatePost = function (id, post) {
	return database.none('update blog.post set title = $1, content = $2 where id = $3', [post.title, post.content, id]);
};

exports.deletePost = function (id) {
	return database.none('delete from blog.post where id = $1', [id]);
};
```

Talvez seja por ai que a gente deve come√ßar :)

>> Coment√°rio de boemekeld:
Sobre onde hospedar, a Amazon possui um banco de dados SQL voltado para serverless, √© o Amazon Aurora Serverless. Na pr√°tica, √© um MySQL otimizado para trabalhar com um n√∫mero grande de conex√µes e com recursos auto escal√°veis. Existe o V1 e o V2 (que em breve deve sair do Preview).

Uma vantagem que vejo, √© o back-end estar mais pr√≥ximo ao banco de dados (assumindo que a estrutura de back-end da Vercel esteja na AWS).

Outra vantagem √© o custo, que deve ser menor quando o projeto ganhar propor√ß√µes maiores (mas talvez n√£o agora no in√≠cio, onde um custo m√≠nimo fica por volta de R$ 300 por m√™s).

Existe ainda um outro servi√ßo, chamado AWS RDS Proxy, que serve justamente para intermediar as conex√µes entre o back-end serverless e o banco de dados.

>> Coment√°rio de filipedeschamps:
Ahhh que massa @boemekeld eu lembro que tinha visto isso no passado, achei fant√°stico, mas acabei n√£o me aprofundando por ser MySQL (e mais uma vez, MySQL na frente no mundo serverless, interessante n√©?) e tamb√©m vi que n√£o era poss√≠vel expor ele para o mundo (pelo menos na √©poca), a conex√£o tinha que ser por dentro de uma VPC, da√≠ o backend da Vercel n√£o vai conseguir entrar. Mas talvez daria para expor o Proxy? E usar a AWS facilitaria o billing aqui do meu lado, ficaria tudo num √∫nico lugar, porque j√° uso o Glacier para fazer backup dos v√≠deos. E sobre custo, me surpreendeu esses R$ 300 por m√™s m√≠nimos, dado que eles batem bastante na tecla do custo üëç  

Bom, de qualquer forma, sugiro continuar no caminho da gente presenciar o comportamento das conex√µes estourando üòÇ

>> Coment√°rio de boemekeld:
@filipedeschamps sim, eles prometem compatibilidade com PostgreSQL, mas na pr√°tica o MySQL est√° na frente!

Sobre a conectividade com mundo externo, sim, voc√™ precisa usar uma VPC, por√©m, sua VPC pode ter conex√£o externa, para isso ela precisar√° de um Internet Gateway configurado (a desvantagem √© que o VPC tamb√©m ter√° um custo, #malditos).

No caso do RDS proxy, acredito que seja poss√≠vel conectar de fora sem VPC.

De qualquer maneira, tamb√©m apoio a ideia de testar o limite das conex√µes üòâ

>> Coment√°rio de rodrigoKulb:
Tenho um servidor (host) na AWS, √© possivel criar um banco de dados a partir de $15, N√£o utilizo o plano de banco de dados, pois tenho um host l√° j√° com banco. Mas parece ser legal.

![Captura de tela em 2021-07-15 14-57-56](https://user-images.githubusercontent.com/5334261/125835795-090d1470-29ef-4791-b53d-58c5f9f0fe90.png)

>> Coment√°rio de huogerac:
Hey pessoal,

O que voces acham desta ideia aqui: Usar um droplet de **$5** na Digital Ocean e instalar o Postgres. Eu fiz isto algumas vezes, teve projeto que decolou e migramos para a AWS com backup e tudo mais, o servi√ßo **RDS da AWS √© fant√°stico. Sem palavras.**

MAS, mas para in√≠cio, e digo mais, da para aguentar muita coisa com este droplet de 5 doletas. E na linha do @filipedeschamps  de ver os problemas acontecerem...

Enfim, se gostarem desta ideia, consigo fazer instala√ß√£o automatizada via ansible (para facilitar replica√ß√£o) e deixar um postgres rodando na D.O. de forma que fica f√°cil migrar, seja para outro droplet com mais mem√≥ria ou outro servidor em outra cloud.

>> Coment√°rio de cezarmezzalira:
@huogerac eu uso DO e acho muito barato para come√ßar.
Acho muito legal a possibilidade de voc√™ ir migrando para droplets mais parrudos de forma transparente.
Por mim, dava pra mandar ver, s√≥ compartilhar conosco os dados para podermos acessar :)

>> Coment√°rio de filipedeschamps:
@huogerac detona!!! Vai ser muito massa ter essa automa√ß√£o!

>> Coment√°rio de brunofamiliar:
Eu n√£o entendo muito bem sobre parte de infra pessoal, mas est√° sendo muito massa aprender com voc√™s üòÑ. Sobre o DO droplets, at√© onde eu li, eles ainda n√£o fornece CDN e o backup de banco √© algo cobrado a parte. Mas acredito que nesse momento deve ser uma boa op√ß√£o a ser adota pelo projeto visto que, conforme mencionado pelo @huogerac; a transi√ß√£o para outra base no futuro pode acontecer de forma flu√≠da, e os recursos existentes v√£o comportar muito bem a aplica√ß√£o.

>> Coment√°rio de huogerac:
### Resumo:

Temos um postgres 11 rodando e aberto para o mundo (MEDO), instalei para validar em um servidorzinho que tenho na D.O. (chamei de ambiente dev).

![image](https://user-images.githubusercontent.com/962233/125881197-e2c500a9-b002-49bf-a7e3-dd8da4f5f753.png)

Notas:
- scripts ansibles geralmente tem dados sens√≠veis como o acesso ao banco, secrets de api, variaveis de ambiente. Logo √© uma boa pr√°tica usar o ansible-vault para fazer o encrypt.
- Voces v√£o precisar da chave para ver os dados de acesso, podem me enviar email: huogerac [arroba] gmail [ponto] com, ou definir um lugar onde posso colocar (ver Issue #68 )
- Este ambiente que criei √© para testes (devops/ansible/hosts/development), a ideia √© replicar oq fiz no servidor oficial que o @filipedeschamps dever√° criar (vamos chamar de devops/ansible/hosts/production)
- Geralmente eu deixo o servidor onde instalo o postgres fechado (porta 5432 n√£o acess√≠vel via internet), apenas aberto para a rede interna. Mas para permitir que voces acessem, tive que abrir esta porta no firewall e no pg_hba.conf, ou seja, no m√≠nimo vamos ter que estudar um pouco como proteger melhor um postgres aberto na internet...

### Qual a ideia:
- Podemos utilizar o ip `178.62.218.219` para testar, mas devemos ter um servidor de produ√ß√£o com o banco do tabnews.com.br
- Criar um droplet na digital ocean com ubuntu 20 e seguir os passos abaixo para instalar o postgres usando ansible (para facilitar replica√ß√£o)

### Passo a Passo para instala√ß√£o

- Criar droplet usando ubuntu 20
- Seguir os passos 1,2,3 e 4 [deste post aqui](https://huogerac.hashnode.dev/add-wildcard-https-on-digital-ocean-using-certbot-ubuntu-20-nginx-cko511nxv04in83s15uxxbeea) onde instala o b√°sico do b√°sico no ubuntu para rodar oq precisamos
- instalar o ansible localmente, como √© python, quem usa linux ou mac, basicamente √© fazer um `pip install ansible`. Eu recomendo fazer isto dentro de um virtualenv
- Dai √© basicamente 2 comandos **(dentro da pasta `devops/ansible`)**
- Criar o arquivo `devops/ansible/.vault_pass` com a chave q preciso compartilhar
- Rodar: `ansible-playbook -i hosts/development --tags postgres playbook.yml --vault-password-file .vault_pass`
- No servidor podemos utilizar `sudo service postgresql status` para ver q o postgres est√° rodando
- No servidor podemos utilizar `netstat -nlt` para ver as portas abertas e podemos ver `:::5432` = aberta para o mundo (mas o firewall ainda n√£o vai deixar)
- por √∫ltimo, temos que liberar o firewall com `sudo ufw allow 5432`
- done!

### Como ver o arquivo de configura√ß√£o?

- Entrando na pasta `devops/ansible`
- Digitando o comando `ansible-vault decrypt --vault-password-file .vault_pass group_vars/development.yml`
- dai conseguimos ver user/pwd e nome do banco

### Pr√≥ximos passos
- Criar droplet de produ√ß√£o na D.O 
- Criar o arquivo `hosts/production` com o IP do droplet (seguindo o development)
- Criar o arquivo `group_vars/production.yml` (seguindo o development.yml):
```
---
environment: production

database_name: tabnews
database_user: tabnews
database_password: xXXXXXx

```

Pessoal, acho que √© isto, espero que n√£o tenha ficado complicado demais. Tem meu email ai no post, se tiver algo que n√£o esteja muito claro.

Todos arquivos do ansible est√£o na branch: 
https://github.com/filipedeschamps/tabnews.com.br/tree/Task61_instala_postgres (pasta devops)

N√£o abri PR ainda, para esperar avalia√ß√£o de voces.

>> Coment√°rio de filipedeschamps:
Show de bola @huogerac! **Muito obrigado por colocar a m√£o na massa dessa forma!!!!** Ent√£o ultra-resum√£o foi subir um droplet de Ubuntu, configurar ele, e da√≠ instalar e configurar o Postgres. Como efeito colateral, √© preciso gerenciar as chaves, segredos e manter o OS atualizado (e o banco).

Voc√™ j√° testou o Postgres gerenciado da DigitalOcean? Eu nunca testei, s√≥ usei o Postgres no RDS na AWS e era muito bom. Vou fazer um teste aqui para sentir se ele abstrair parte desse trabalho, e ver se talvez ele consegue nos entregar na m√£o a url de conex√£o e credenciais, porque da√≠ √© s√≥ quest√£o de cadastrar isso nas vari√°veis de ambiente da Vercel e a aplica√ß√£o em prod ou staging podem usar diretamente. Acredito que vai ser mais caro que um droplet, mas o tradeoff √© que n√£o iremos precisar nos preocupar com os patches de seguran√ßa da m√°quina.

Vou fazer uma conta aqui e assim que fizer retorno aqui com os resultados.

_PS: Desculpa a demora para interagir com as issues, essa semana o Oliver pegou pesado aqui em casa üòÇ_

>> Coment√°rio de filipedeschamps:
## Turma, esse foi o resultado

Depois de configurar o billing da nova conta que criei (acabei ganhando $100 d√≥lares de cr√©dito), escolhi a op√ß√£o de criar um banco de dados gerenciado e essa tela abaixo √© basicamente o que se precisa escolher pra criar o banco, e como voc√™s podem ver, a inst√¢ncia m√≠nima √© mais cara e custa **$15 d√≥lares**.

![image](https://user-images.githubusercontent.com/4248081/126013945-8f0a18e5-466f-4358-b30d-9bbd3159ff8b.png)

## Config
Depois ele ajuda voc√™ a fazer algumas configura√ß√µes, onde o segundo passo √© ele pedindo para voc√™ fechar o banco de dados para internet, e deixar dispon√≠vel s√≥ pra rede interna.

![image](https://user-images.githubusercontent.com/4248081/126014031-b19b4663-8459-4c0d-9b8e-04bdb33033f1.png)

## Credenciais
Pulei essa etapa, pois precisamos expor ele pros servidores da Vercel, e ele j√° retorna url de acesso e credenciais (eu alterei antes do print):

![image](https://user-images.githubusercontent.com/4248081/126016068-99a9927b-d2f8-43d1-ae94-dc7b12ee801a.png)

## Pool e Patches de Seguran√ßa

O legal √© que ele j√° fornece uma op√ß√£o para voc√™ configurar o `pg-pool` e tamb√©m j√° habilitou patches de seguran√ßa (minors) por padr√£o:

![image](https://user-images.githubusercontent.com/4248081/126014881-0e239909-1c7b-44bc-917b-8a78d2d9e963.png)

## Backups
N√£o encontrei onde ficam os backups, s√≥ encontrei isso (e to confuso):

![image](https://user-images.githubusercontent.com/4248081/126016841-4af2c477-be02-4def-bb6a-f5efdce4efb5.png)


## Tela do Pool

O que achei legal √© que ele mostra que nossa atual inst√¢ncia s√≥ suporta **22 conex√µes simult√¢neas**, mas j√° oferece uma forma f√°cil de configurar o pool. Eu n√£o vou fazer agora, para realmente enfrentarmos esse problema e deixar nossa aplica√ß√£o mais robusta, mas achei bem legal a interface.

![image](https://user-images.githubusercontent.com/4248081/126015419-995feb25-40a3-4f4d-8f0a-0be46500ff9c.png)

## Conclus√£o

Achei bem interessante, foi um pouquinho mais caro que pensei que seria para a inst√¢ncia m√≠nima, mas bastante conveniente, principalmente para n√£o se preocupar com patches de seguran√ßa do OS (que √© transparente) e minors do Postgres e imagino que fazer upgrade major do Postgres ou aumentar a inst√¢ncia imagino ser f√°cil tamb√©m. Por outro lado, o que fiz n√£o √© Devops, porque foi tudo no bra√ßo üòÇ 

Talvez o que podemos fazer √© come√ßar assim, e depois quando o projeto estiver parando em p√© economicamente falando, fazer todo esse setup de novo na AWS e usando um Terraform da vida (porque eu acho que eventualmente a gente vai usar outros servi√ßos de l√° como S3).

E essa migra√ß√£o tamb√©m vai gerar bastante conhecimento.

**Qual a impress√£o de voc√™s?**

>> Coment√°rio de huogerac:
Massa que $15 doletas da para ser uma op√ß√£o j√° para este projeto! Tem varias vantagens sim!

- Eu diria, que vi alguns projetos iniciando sem problema na abordagem da branch com ansible, mesmo sem ficar se preocupando com os updates (ou fazendo a cada 3 meses apenas). Em outras palavras, postgres √© do c*r*alhor! hehhe, mesmo usando a vers√£o 11 ou 12
- Outra coisa que vi indo para est√° dire√ß√£o, √© que com instala√ß√£o pr√≥pria, conseguimos instalar 2 bases (dev e prod) na mesma instancia ($5), ou seja, da medo rodar as migrations das novas features diretamente em produ√ß√£o, sempre tenho no m√≠nimo outro ambiente com a c√≥pia de produ√ß√£o.
- Acho que eu poderia ter simplificado um pouco mais, pelo menos removendo o ansible-vault e aquele setup inicial da instancia que fiz referencia para outro post (vou tentar melhorar isto em breve)

Enfim, se $15 conto n√£o √© problema! Massa! este servi√ßo da D.O. √© bom sim! e o backup/restore √© tranquilo, tenho ansible pra isto, a gente faz em outra issue na hora q precisar

>> Coment√°rio de filipedeschamps:
Show @huogerac bom ponto sobre os dois ambientes e de fato eles gerenciados ficar√£o **bem** mais caros que em 1 droplet. Mas dois cuidados que eu tomaria em unir esses dois ambientes √© em **disponibilidade** (por exemplo o banco dev consumir todo recurso da m√°quina por um erro, afetando o banco de prod), e **seguran√ßa**, pois fica f√°cil escalar acesso de dev para prod üëç 

Bom, eu to colocando a m√£o na massa aqui para fazer essas coisas rodarem em ambiente local com `docker-compose`, que vai servir para os testes tamb√©m, e um pouco mais pra frente fazer duas inst√¢ncias do banco, uma para `Preview` e outra para `Production` ü§ù  estamos avan√ßando üéâ

>> Coment√°rio de rodrigoKulb:
Bem legal o banco de dados gerenciado, voc√™ consegue abstrair todos os poss√≠veis problemas de OS, com uma diferen√ßa bem baixa no valor.

Acabou que ficou o mesmo pre√ßo do Banco gerenciado na AWS ambos s√£o $ 15,00. 

**Digital Ocean**
PostgreSQL 13
1GB Memoria
1vCPU
10 GB Disk
Transfer√™ncia (N√£o achei no print)
Pre√ßo $ 15,00 (cr√©dito de $100,00)

**AWS**
PostgreSQL 12.7
1GB Memoria
1vCPU
40 GB Disk
100 GB transfer√™ncia
Pre√ßo $ 15,00 (primeiro m√™s gr√°tis)

Sobre o bkp achei esse link informando que n√£o existe um custo adicional para o mesmo, e o bkp √© di√°rio.
https://www.digitalocean.com/community/questions/what-is-the-recommended-way-to-backup-my-managed-postgresql-database

>> Coment√°rio de huogerac:
Pessoal,

Apenas para referencia e para complementar a branch que instala um Postgres na D.O usando Ansible.
Se algum dia alguem precisar!
https://huogerac.hashnode.dev/install-postgres-13-on-ubuntu-20-using-ansible-ckrcv6i520704a2s1ga5bedko

>> Coment√°rio de huogerac:
Hey @filipedeschamps 
No v√≠deo#90 desta semana voc√™ disse que est√° usando Terraform. Legal fazer infra as code. Se ajudar, segue um script que usei para subir Postgres na AWS...Espero que ajude

https://github.com/huogerac/devops-tools/tree/main/devops/terraform/aws/rds

>> Coment√°rio de filipedeschamps:
@huogerac show!! Como preciso deixar o banco p√∫blico para a Vercel conseguir se conectar, tive que dar um bal√£o maior, olha s√≥:

```tf
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 3.0"
    }
  }
}

provider "aws" {
  region  = "us-east-1"
  profile = "tabnews"
}

# Criar uma nova VPC que resolva DNS
# e consiga fazer acesso a internet.
# Esse recurso vai ser usado por:
# 1. Internet Gateway
resource "aws_vpc" "staging" {
  cidr_block           = "10.0.0.0/16"
  enable_dns_support   = true
  enable_dns_hostnames = true

  tags = {
    Name = "staging"
  }
}

# Criar um internet gateway que se
# conecta com a VPC ali de cima.
resource "aws_internet_gateway" "staging" {
  vpc_id = aws_vpc.staging.id

  tags = {
    Name = "staging"
  }
}

# Pega todas as Availability Zones que est√£o
# dispon√≠veis na "region" declarado no provider "aws"
data "aws_availability_zones" "available" {
  state = "available"
}

# Faz um loop para criar um subnet por cada
# availability zone. O RDS tem um requisito
# de ter no m√≠nimo 2 subnets. Que nesse caso,
# vai ser criado 2 subnets p√∫blicas.
resource "aws_subnet" "database_staging_public" {
  count                   = 2
  vpc_id                  = aws_vpc.staging.id
  cidr_block              = cidrsubnet(aws_vpc.staging.cidr_block, 8, count.index)
  availability_zone       = data.aws_availability_zones.available.names[count.index]
  map_public_ip_on_launch = true

  tags = {
    Name = "database_staging_public"
  }
}

# O RDS tamb√©m tem um requisito de ter um
# subnet group, que nesse caso vai pegar dinamicamente
# todos os subnets criados acima.
resource "aws_db_subnet_group" "staging_public" {
  name       = "database_staging_public"
  subnet_ids = aws_subnet.database_staging_public.*.id

  tags = {
    Name = "database_staging_public"
  }
}

# Como vamos expor o banco de dados de forma p√∫blica
# eu precisei criar um Route Table que mapeia o caminho
# entre a VPC e o Internet Gateway e que vai ser
# usado por todas as subnets logo ali em baixo.
resource "aws_route_table" "staging_public" {
  vpc_id = aws_vpc.staging.id

  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.staging.id
  }

  tags = {
    Name = "staging_public"
  }
}

# Nesse ponto a gente faz a associa√ß√£o entre o Route Table
# criado acima e todas as subnets p√∫blicas dispon√≠veis.
# Assim elas conseguem acessar a internet.
resource "aws_route_table_association" "staging_public" {
  count          = length(aws_subnet.database_staging_public)
  subnet_id      = aws_subnet.database_staging_public[count.index].id
  route_table_id = aws_route_table.staging_public.id
}

# Pelo que lembro, esse n√£o foi um ponto necess√°rio para dar
# acesso p√∫blico ao RDS, mas quando ele era criado sem definir
# um Security Group, ele usava um padr√£o dispon√≠vel na conta
# e que liberava tudo. Preferi criar um espec√≠fico para o
# tipo de acesso e porta do banco.
resource "aws_security_group" "postgres_staging" {
  name   = "postgres-staging"
  vpc_id = aws_vpc.staging.id

  ingress {
    from_port        = 3297
    to_port          = 3297
    protocol         = "tcp"
    cidr_blocks      = ["0.0.0.0/0"]
    ipv6_cidr_blocks = ["::/0"]
  }

  egress {
    from_port        = 0
    to_port          = 0
    protocol         = "-1"
    cidr_blocks      = ["0.0.0.0/0"]
    ipv6_cidr_blocks = ["::/0"]
  }
}

# Isso gera uma nova senha rand√¥mica, e que vai
# ser usada no banco de dados.
# ATEN√á√ÉO: por enquanto n√£o estou utilizando,
# mas √© s√≥ para facilitar nos testes.
resource "random_password" "password" {
  length           = 32
  special          = true
  override_special = "!#$%&*()-_=+[]{}<>:?"
}

# Criar um RDS de PostgreSQL.
# Tem v√°rios par√¢metros comentados e hardcoded, porque
# estou estudando e testando tudo ainda. E a ideia √© exportar
# v√°rios desses valores para algo como um Secret Manager da AWS.
# Eu quero fazer o commit desse arquivo aqui no reposit√≥rio
# do TabNews e n√£o quero expor nada, nem a porta que foi utilizada.
resource "aws_db_instance" "postgres_staging" {
  identifier        = "postgres-staging"
  storage_type      = "gp2"
  allocated_storage = 20
  engine            = "postgres"
  engine_version    = "13.3"
  # engine_version    = "14.1"
  instance_class = "db.t4g.micro"
  name           = "test1234"
  username       = "test1234"
  password       = "test1234"
  # password                    = random_password.password.result
  port                        = 3297
  publicly_accessible         = true
  multi_az                    = false
  max_allocated_storage       = 20
  allow_major_version_upgrade = false
  auto_minor_version_upgrade  = true

  db_subnet_group_name   = aws_db_subnet_group.staging_public.name
  vpc_security_group_ids = [aws_security_group.postgres_staging.id]

  apply_immediately       = true
  backup_retention_period = 0

  skip_final_snapshot = true

  # final_snapshot_identifier = "test" # N√£o vou usar, pois fa√ßo skip_final_snapshot = true
  # timezone = "" # Preciso disso?
  # backup_window = "03:00-04:00" # Em qual timezone isso funciona?
  # delete_automated_backups = true # Pesquisar mais sobre isso.
  # maintenance_window = "wed:03:00-wed:04:00" # Em qual timezone isso funciona?
  # availability_zone # Preciso definir isso?
  # license_model = "license-included" # O que √© isso?
  # monitoring_interval = "5" # O que isso faz?
  # performance_insights_enabled = true # O que isso faz?
  # replicas = 1 # Vamos precisar? Muito caro?

  tags = {
    Name = "postgres_staging"
  }
}


output "postgres_staging_username" {
  value = aws_db_instance.postgres_staging.username
}

output "postgres_staging_password" {
  value     = aws_db_instance.postgres_staging.password
  sensitive = true
}

output "postgres_staging_endpoint" {
  value = aws_db_instance.postgres_staging.endpoint
}
```

>> Coment√°rio de huogerac:
Que massa, vou olhar com calma mais tarde! massa que tem tudo comentado!

>> Coment√°rio de boemekeld:
Oi @filipedeschamps, chegou a dar uma olhada no PlanetScale? √© uma op√ß√£o interessante, tenho escolhido ele ao inv√©s do RDS. Fica tudo muito mais simples, sem a necessidade de configurar RDS e VPC. E tem uma funcionalidade de branch e pull request em altera√ß√µes do banco de dados, delicinha! üòÜ
Quanto ao migrations / ORM, apoio o Prisma.io.
Abs.

>> Coment√°rio de filipedeschamps:
@huogerac show! Fiz alguns ajustes legais (principalmente pra ficar tudo 100% na hora do destroy) e agora estou modularizando para conseguirmos ter a infra de staging e production "iguais", e por iguais eu digo que a topologia vai ser a mesma, mas √© importante ter a flexibilidade de na de staging poder escolher um banco mais fraco, sem backup e em `us-east-1` e em production ter um banco mais forte, etc. e em S√£o Paulo se quisermos. E resolvi a parte das credenciais de um jeito interessante que ao criar o recurso, tudo √© gerado de forma rand√¥mica (incluindo a porta), usando o m√°ximo do length em usu√°rio e senha. Ta bem massa üëç 

@boemekeld show! Cheguei a avaliar o PlanetScale e √© uma solu√ß√£o **sensacional**. A escolha de usar o Postgres foi literalmente para se ferrar. E eu n√£o digo isso brincando n√£o, era realmente pra conseguir se virar e aprender mais a respeito. Incluindo n√£o usar ORM e fazer as queries na unha. N√£o est√° sendo nada produtivo no quesito velocidade de desenvolvimento, mas est√° sendo muito proveitoso no quesito conhecimento ü§ù

>> Coment√°rio de huogerac:
Hey pessoal!
Sei que j√° est√° fechado este asssunto do DB, e que a solu√ß√£o com Terraform ficou linda!

Mas olha o que apareceu na minha timeline! achei legal compartilhar! me pareceu um neg√≥cio legal de fazer uma POC.

Abra√ßo

https://github.com/nhost/nhost

>> Coment√°rio de filipedeschamps:
Que massa essa solu√ß√£o @huogerac üòç  topa fazer um post l√° no TabNews para turma conhecer?
</issue_61_Conex√£o com o banco & Migrations>

<issue_62_Rodar testes local e CI>
Framework de teste no Next.js: ?
Postgres rodando local: um docker-compose √© bem simples e resolve
CI: Github actions √© muito bom, √© facil instanciar um DB postgres para os testes

>> Coment√°rio de brunofamiliar:
Eu sou bem leigo nesse assunto üòÇüòÇ. Mas antes de defirmos alguns frameworks, num seria interessante definirmos se inciamos com testes unit√°rios ou e2e? Ou √© mais produtivo utilizar o melhor dos dois cen√°rios?

>> Coment√°rio de filipedeschamps:
Nossa @brunofamiliar agora que vi essa resposta aqui, porque estava fazendo uma limpa nos meus emails, atropelei :(

E a sua pergunta faz **total** sentido, numa das lives chegamos a comentar mas n√£o chegamos a conclus√£o nenhuma üòÇ  acho que iremos ver na vida real o que vai acontecer üëç
</issue_62_Rodar testes local e CI>

<issue_63_Manuten√ß√£o das issues (quais fechar?)>
Para n√£o perdermos controle sobre a quantidade de issue aberta, proponho que j√° logo no in√≠cio dessa Milestone a gente fa√ßa um fechamento da maioria das issues que ficaram `stale`. Isso n√£o significa que o assunto foi encerrado, e muito menos que n√£o pode ser repescado (inclusive, o que √© importante geralmente √© repescado naturalmente). Mas √© muito de fazermos a manuten√ß√£o do reposit√≥rio aqui no Github, tanto quanto fazemos em c√≥digo. Eu vejo que nem todas as issues valem a pena fechar, mas algumas valem üëç

>> Coment√°rio de rodrigoKulb:
Concordo! 
Alem dos 2 status das Inssues, poderia existir um "in coming" para conversar sobre assuntos futuros.
Mas se analisar com calma existem Inssues com assuntos duplicados que poderiam ser unificadas.

@filipedeschamps o que acha de criar uma Inssues chamada "in coming" colocando link para todas Inssues de propostas futuras, finalizando todas elas? N√£o sei se √© a melhor forma sou novato no Github.

>> Coment√°rio de geovani-brito:
Bom... acho que posso falar pela issue #27 que eu abri. Por mim, ela pode ser fechada e esse assunto pode ser retomado quando o sistema todo j√° estiver em produ√ß√£o e com usu√°rios ativos. Vai ser a oportunidade de analisar melhor o comportamento das postagens. 

Ou ent√£o, se usar a ideia do @rodrigoKulb ela pode ficar na "in coming". 

Eu j√° me perguntava se essa issue poderia ficar na Milestone 7. Mas se entrar na milestone e ficar fechada, fica parecendo que ela j√° foi conclu√≠da. Talvez, fazendo uma sugest√£o, fosse uma boa hora para usar a guia Projects do Github com um quadro Kanban. Ent√£o as issues que ser√£o pensadas depois, podem ficar em um backlog. Enquanto as tarefas efetivas podem ficar em um To Do. 

Pode parecer meio redundante j√° que de certa forma as milestones est√£o a√≠ para organizar o que ser√° feito e em qual ordem. Por√©m, elas sinalizam mais os marcos hist√≥ricos (com aquelas lives delicinhas rs) enquanto os quadros Kaban v√£o indicando o que precisa ser feito, o que est√° sendo feito e o que foi conclu√≠do. 

S√£o as minhas sugest√µes e, como sempre, estou aberto para todo tipo de ideias e cr√≠ticas.

>> Coment√°rio de rodrigoKulb:
@geovani-brito estava pesquisando aqui, acabei achando o [Zube](https://zube.io/) (curti a ferramenta) para organizar issues.
S√≥ precisa entender como compartilhar o quadro:
![Captura de tela em 2021-07-09 12-51-10](https://user-images.githubusercontent.com/5334261/125105033-65b49280-e0b4-11eb-8885-4db4c910571d.png)

>> Coment√°rio de rodrigoKulb:
Outra possibilidade √© abrir a aba [Projects](https://github.com/filipedeschamps/tabnews.com.br/projects) do Github j√° possui o tema Kanban.

>> Coment√°rio de rhandrade:
@rodrigoKulb curti a ideia o "in coming"... Compartilho da mesma ideia do @geovani-brito, as vezes por ver que ele est√° fechada pode indicar que o assunto foi discutido e n√£o ser√° retomado mais.

Acredito que o Projects do Github ou mesmo a nova vers√£o das issues que o Github lan√ßou (n√£o sei ela j√° est√° dispon√≠vel) ficaria bem maneira no projeto, pois centraliza todos em um √∫nico lugar.

https://github.com/features/issues
![image](https://user-images.githubusercontent.com/4511733/125127846-87714200-e0d3-11eb-9e62-79254721dfb1.png)

>> Coment√°rio de filipedeschamps:
Sensacional pessoal!!! Lendo o que voc√™s conversaram, tentei sintetizar duas trajet√≥rias, e uma b√¥nus:

1. Criar um board de trabalho com as colunas inspiradas pelo exemplo ali em cima:
    - `RFC` de "Request for Comments"
    - `To do`
    - `Doing`
    - `Done`
2. Marcar as issues estagnadas com uma label do tipo `repescar` e fechar elas, porque assim fica muito f√°cil de fato repescar elas.

A op√ß√£o `2` √© mais simples, pois resolve tudo na aba Issues. A op√ß√£o `1` precisa de mais manuten√ß√£o, mas talvez d√™ uma organizada melhor no que est√° sendo feito.

A ideia b√¥nus, seria um board geral, onde cada coluna √© uma Milestone, e uma coluna especial para RFC. As issues ficariam paradas em cada coluna, mas daria uma vis√£o macro do projeto.

Algo me diz que, para a atual complexidade do projeto, a op√ß√£o `2` √© super vi√°vel e vai entregar o que queremos: manter sob controle a quantidade das issues, sem se perder onde est√£o aquelas que discutiram coisas valiosas, mas estagnaram pelo timing do projeto.

Talvez podemos tentar o mais simples e entender o que vai acontecer com nossa percep√ß√£o, e se ficar ruim, vamos aumentando a sofistica√ß√£o da solu√ß√£o. O que acham?

>> Coment√°rio de rodrigoKulb:
Concordo com a op√ß√£o `2`, a **manuten√ß√£o** da `1` ser√° um novo problema para o projeto.

>> Coment√°rio de geovani-brito:
Minha preocupa√ß√£o era mais com a ideia de fechar as issues que n√£o foram conclu√≠das. Mais adiante isso poderia criar uma certa confus√£o, principalmente para os pr√≥ximos que podem entrar no projeto quando o reposit√≥rio se tornar p√∫blico. Por isso, eu tamb√©m concordo que usar uma tag `repescar` da op√ß√£o `2` parece a solu√ß√£o mais simples no momento.

>> Coment√°rio de rhandrade:
Concordo com a op√ß√£o 2 tamb√©m.

>> Coment√°rio de filipedeschamps:
Pessoal, se a minha mem√≥ria n√£o falha, a gente saiu de `18` issues abertas para `10` (que incluem as `6` issues da pr√≥pria Milestone). Dado a isso, vou fechar essa issue e sempre poderemos fazer esse tipo de manuten√ß√£o no reposit√≥rio, inclusive colocar uma Action para auto-fechar issues que perderam tra√ß√£o por, por exemplo, 30 dias ü§ù 

Let's gooooo!!!!!!

>> Coment√°rio de filipedeschamps:
S√≥ para deixar documentado, o Github j√° fornece um bot para issues que ficaram stale: https://github.com/marketplace/stale
</issue_63_Manuten√ß√£o das issues (quais fechar?)>

<issue_64_Tipo da Licen√ßa (qual licen√ßa usar e porque?)>
Depois da bagun√ßa causada pelo Github Copilot, vamos entender se estamos com a licen√ßa certa. Eu sempre assumo a licen√ßa MIT, e nem sei mais porque. O intuito dessa issue n√£o √© necessariamente sair da MIT, mas de entender os motivos caso continuarmos com ela e tamb√©m quais alternativas temos e porque.

>> Coment√°rio de rodrigoKulb:
Achei essa imagem muito auto-explicativa:
![Captura de tela em 2021-07-08 16-32-25](https://user-images.githubusercontent.com/5334261/124979951-2598d580-e00a-11eb-87dc-3d0a36748ba5.png)

Fonte:
https://pt.wikipedia.org/wiki/Licen%C3%A7a_de_software_livre#cite_note-31

>> Coment√°rio de huogerac:
https://choosealicense.com/

>> Coment√°rio de rhandrade:
√ìtima contribui√ß√£o @rodrigoKulb e @huogerac. Acredito que precisar√≠amos primeiramente definir quais pontos gostar√≠amos para o projeto.

Na minha vis√£o a principal quest√£o seria se desejamos que esse projeto e qualquer derivado se mantenha sempre livre ou n√£o. A licen√ßa MIT √© bem abrangente em permitir que projetos derivados possam sem lan√ßados em outras licen√ßas e sem ter o c√≥digo disponibilizado.

Acredito que desde o inicio do projeto o @filipedeschamps sugeriu criar um produto no qual podemos arriscar e entender decis√µes que as vezes tomamos, mas n√£o sabemos o porque, e aprender com essas decis√µes na pr√°tica. Ent√£o para mim faria sentido usar uma licen√ßa que permita que essa cultura continue, de modo que trabalhos derivados tamb√©m estejam acess√≠veis a comunidade e todos possam aprender com eles. Talvez a GPLv3 possa ser uma boa op√ß√£o para isso.

>> Coment√°rio de rodrigoKulb:
@rhandrade matou a pau, nesse fluxograma ficou bem claro sua explica√ß√£o, concordo em utilizar GPLv2 ou GPLv3.
Assim garantimos que sempre que algu√©m seguir com um possivel fork do projeto continue obrigatoriamente utilizando a licen√ßa de software livre.
![Mecanismo_de_sele√ß√£o_3 (1)](https://user-images.githubusercontent.com/5334261/125140953-15f0be00-e0ea-11eb-9b6f-4fc424c64c11.png)

>> Coment√°rio de pauloboare:
Acredito que a GPLv3 seja a op√ß√£o mais interessante para o TabNews, embora seja mais restritiva que a MIT, ela n√£o anula a liberdade da comunidade.  Essa licen√ßa vai estimular (por livre e espont√¢nea obriga√ß√£o) que outras pessoas mantenham o c√≥digo aberto em poss√≠veis redistribui√ß√µes e sem que utilizem para seu lucro. Qualquer modifica√ß√£o da distribui√ß√£o ser√° feita sempre sob a mesma licen√ßa e altera√ß√µes no c√≥digo fonte ser√£o frequentemente documentadas.

Pelo que sei, a GPLv2 tem algumas quest√µes chatinhas, caso o TabNews utilize alguma library com uma licen√ßa que tenha algum conflito. J√° na vers√£o 3 isso ocorre mais tranquilamente. 

Desculpem a superficialidade no meu argumento, acho bem complexo. Fiquem a vontade para corrigir ou complementar.

>> Coment√°rio de rhandrade:
> Assim garantimos que sempre que algu√©m seguir com um possivel fork do projeto continue obrigatoriamente utilizando a a licen√ßa de software livre.

Exatamente isso @rodrigoKulb. 

@olamundoph √â bem isso mesmo que voc√™ falou. A GPLv2 tem alguns pontos que geram debates e poss√≠veis problemas quando existem bibliotecas e outras partes licenciadas sobre outras licen√ßas.

> ... que outras pessoas mantenham o c√≥digo aberto em poss√≠veis redistribui√ß√µes e sem que utilizem para seu lucro. 

Sobre a quest√£o comercial, pelo que eu entendi a GPLv3 at√© permiti e acho que pode gerar gerar receita sobre isso para quem o fizer, mas a obrigatoriedade de estar licenciada com a mesma licen√ßa e ter o c√≥digo fonte dispon√≠vel da uma transpar√™ncia muito grande.

>> Coment√°rio de rodrigoKulb:
Neste link consegui achar um resumo bem completo entre as duas:
https://qastack.com.br/programming/41460/what-are-the-differences-between-gpl-v2-and-gpl-v3-licenses

**S√£o eles:**
1. internacionaliza√ß√£o: usaram nova terminologia, em vez de usar linguagem vinculada aos conceitos legais dos EUA.

2. patentes: eles tratam especificamente de patentes (incluindo o problema da Microsoft / Novell mencionado em outra resposta).

3. ‚ÄúTivoiza√ß√£o‚Äù: abordam as restri√ß√µes (como as da Tivo) em produtos de consumo que tiram, por meio de hardware, a capacidade de modificar o software.

4. DRM: eles tratam do gerenciamento de direitos digitais (que eles chamam de gerenciamento de restri√ß√µes digitais).

5. compatibilidade: eles abordam a compatibilidade com algumas outras licen√ßas de c√≥digo aberto.

6. rescis√£o: abordam especificamente o que acontece se a licen√ßa for violada e a cura de viola√ß√µes.

Tamb√©m acredito que a **GPLv3** acaba sendo mais "livre".

@filipedeschamps s√≥ fiquei com uma d√∫vida. Hoje o tabnews segue fechado entre os membros da turma, a ideia futuramente √© abrir para todo o publico? Em qual momento isso ir√° acontecer?

>> Coment√°rio de geovani-brito:
> Hoje o tabnews segue fechado entre os membros da turma, a ideia futuramente √© abrir para todo o publico? Em qual momento isso ir√° acontecer?

Tamb√©m tenho essa d√∫vida e acho que √© importante para escolha da licen√ßa. Temos a certeza de que √© um projeto de c√≥digo aberto. Ent√£o quando o reposit√≥rio se tornar p√∫blico √© poss√≠vel que outras pessoas criem trabalhos paralelos ou at√© mesmo c√≥pias. Ent√£o o que se espera desses trabalhos? O c√≥digo criado aqui poder√° ser usado em outros trabalhos com outras licen√ßas? Por exemplo, a solu√ß√£o que a turma criar para o Revenue Share poder√° ser usada em projetos com outras licen√ßas? Nesse caso estamos falando em usar a MIT, certo? Ou ent√£o a ideia √© que o que for criado aqui seja mais restrito for√ßando sempre o compartilhamento do c√≥digo em trabalhos derivados. Nesse caso estamos falando de alguma vers√£o da GPL. 

Acho que j√° ficou bem definido o objetivo do projeto. Mas vamos ent√£o tentar responder: qual o objetivo de ter o c√≥digo aberto?

>> Coment√°rio de rhandrade:
> Acho que j√° ficou bem definido o objetivo do projeto. Mas vamos ent√£o tentar responder: qual o objetivo de ter o c√≥digo aberto?

Na minha opini√£o @geovani-brito o maior benef√≠cio de manter o c√≥digo aberto √© permitir que a comunidade aprenda com o que est√° sendo desenvolvido e entenda na pr√°tica o que as decis√µes levam. Ex: se fizer X, que teoricamente muitos falam para n√£o fazer porque acontece Y, ser√° que vai realmente acontecer Y? Se acontecer, realmente a teoria √© posta em pr√°tica e todos aprendem com ela.

Acredito que ao manter a mesma licen√ßa a ideia do projeto ser√° mantida.

>> Coment√°rio de sembug:
> √ìtima contribui√ß√£o @rodrigoKulb e @huogerac. Acredito que precisar√≠amos primeiramente definir quais pontos gostar√≠amos para o projeto.
> 
> Na minha vis√£o a principal quest√£o seria se desejamos que esse projeto e qualquer derivado se mantenha sempre livre ou n√£o. A licen√ßa MIT √© bem abrangente em permitir que projetos derivados possam sem lan√ßados em outras licen√ßas e sem ter o c√≥digo disponibilizado.
> 
> Acredito que desde o inicio do projeto o @filipedeschamps sugeriu criar um produto no qual podemos arriscar e entender decis√µes que as vezes tomamos, mas n√£o sabemos o porque, e aprender com essas decis√µes na pr√°tica. Ent√£o para mim faria sentido usar uma licen√ßa que permita que essa cultura continue, de modo que trabalhos derivados tamb√©m estejam acess√≠veis a comunidade e todos possam aprender com eles. Talvez a GPLv3 possa ser uma boa op√ß√£o para isso.

>> Coment√°rio de sembug:
Socorro!!! @filipedeschamps 
Desculpe, fui comentar e fiz uma trapalhada aqui na hora de comentar e fechei a issue (nooobie!!!). 

Gostei do site que ajuda a escolher a licen√ßa.
Concordo com @rhandrade. Primeiro temos que definir as premissas do que esperamos que a licen√ßa vai proteger o projeto.
Qualquer pessoa poder√° utilizar o projeto, fazendo uma c√≥pia e lan√ßando comercialmente, por exemplo?

>> Coment√°rio de sembug:
Ufa! reabir a issue!

>> Coment√°rio de filipedeschamps:
Antes de tudo, j√° falei em outra issue mas vou falar de novo: ter voc√™s aqui no reposit√≥rio √© algo simplesmente **sensacional**. Olha o n√≠vel da conversa e conhecimento que voc√™s desenvolveram em t√£o pouco tempo nessa issue. √â conhecimento que se leva pro resto da vida e pra v√°rios outros projetos ou situa√ß√µes. Muito muito obrigado por estarem aqui ü§ù 

Sobre as d√∫vidas:

> @filipedeschamps s√≥ fiquei com uma d√∫vida. Hoje o tabnews segue fechado entre os membros da turma, a ideia futuramente √© abrir para todo o publico? Em qual momento isso ir√° acontecer?

@rodrigoKulb sim total! Eu especulo que o momento certo para tornarmos o reposit√≥rio p√∫blico para a comunidade e fazer o lan√ßamento do projeto (com um v√≠deo no canal) √© quando atingirmos a Milestone que implementa a feature de `XP` ou `Revenue Share`.

> Acho que j√° ficou bem definido o objetivo do projeto. Mas vamos ent√£o tentar responder: qual o objetivo de ter o c√≥digo aberto?

@geovani-brito eu n√£o poderia ter respondido melhor que o @rhandrade √© isso a√≠ üëç 


> Qualquer pessoa poder√° utilizar o projeto, fazendo uma c√≥pia e lan√ßando comercialmente, por exemplo?

@sembug n√£o vejo problema algum, desde que essa nova iniciativa devolva para a comunidade os c√≥digos e conhecimento, assim como estamos fazendo.

>> Coment√°rio de filipedeschamps:
# Vota√ß√£o para usarmos `GPLv3`

üëç  - Se voc√™ concorda em usarmos `GPLv3`
üëé  - Se voc√™ n√£o concorda

# Resumo dos motivos
Encontrado [nesse gist](https://gist.github.com/kn9ts/cbe95340d29fc1aaeaa5dd5c059d2e60):

1. Qualquer pessoa pode copiar, modificar e distribuir este software.
2. Voc√™ deve incluir a licen√ßa e o aviso de copyright em cada distribui√ß√£o.
3. Voc√™ pode usar este software de forma privada.
4. Voc√™ pode usar este software para fins comerciais.
5. Se voc√™ ousar construir seu neg√≥cio exclusivamente a partir deste c√≥digo, voc√™ corre o risco de _open-source_ toda base de c√≥digo.
6. Se voc√™ modific√°-lo, dever√° indicar as altera√ß√µes feitas no c√≥digo.
7. Quaisquer modifica√ß√µes nesta base de c√≥digo DEVEM ser distribu√≠das com a mesma licen√ßa, GPLv3.
8. Este software √© fornecido sem garantia.
9. O autor ou licen√ßa do software n√£o pode ser responsabilizado por quaisquer danos causados pelo software.

>> Coment√°rio de filipedeschamps:
Turma, tirando o meu voto de placeholder (para os √≠cones das duas op√ß√µes aparecerem), s√£o `5` votos üëç  contra `0` üëé

Como eu concordo tamb√©m em usar a GPLv3, s√£o `6` votos contra `0`. N√£o vejo esse resultado virando, ent√£o vou dar essa issue como conclu√≠da e vou alterar a licen√ßa do projeto.

![image](https://user-images.githubusercontent.com/4248081/125330458-a6eab380-e2fb-11eb-9c3e-bf916f7f11a3.png)

**Importante:** Sabendo que, tudo que foi feito at√© agora est√° sob a licen√ßa `MIT`, somente o que vai ser feito a partir de agora est√° sob a licen√ßa `GPLv3` üëç 

E novamente, o mais importante √© que estou saindo dessa issue com **certeza total** que qualquer coisa que discutirmos, desde c√≥digo, infraestrutura e agora **licen√ßa**, estou discutindo com pessoas que tem as melhores inten√ß√µes e isso aumenta **muito** as chances de sucesso desse projeto. Muito obrigado por estarem aqui e se eu estivesse sozinho aqui dentro desse reposit√≥rio, **nada disso estaria acontecendo** ü§ù  _(sintam-se abra√ßados virtualmente, de verdade)_

>> Coment√°rio de filipedeschamps:
Ali√°s, reabrindo a issue e s√≥ vou fechar quando fizer o merge do PR üëç
</issue_64_Tipo da Licen√ßa (qual licen√ßa usar e porque?)>

<issue_65_Defini√ß√µes do profile/pages>
Ol√°, pessoal! Queria utilizar o espa√ßo aqui para as ideias a respeito do **perfil** do usu√°rio.

O usu√°rio em si, deveria ter um **perfil √∫nico** por cadastro como no Instagram ou Twitter, ou deveria expandir para a possibilidade de ter **suas p√°ginas** como no Facebook, LinkedIn ou at√© mesmo como o pr√≥prio GitHub aqui com suas p√°ginas de organiza√ß√µes/empresas.

Caso, tenhamos as _pages_, acredito que elas deveriam ter algumas funcionalidades espec√≠ficas. E as TabCoins das suas p√°ginas seriam independentes dos usu√°rios ou o engajamento da p√°gina influenciaria nos TabCoins do usu√°rio? (imagino que n√£o deveria influenciar, haja visto que uma p√°gina pudesse ter apenas um administrador tempor√°rio).

Ou ser√° que essa ideia de _page_ poderia ser negativa para a proposta do TabNews que √© focar no **valor** das publica√ß√µes e talvez n√£o necessariamente nas marcas por tr√°s delas?



E o que mais √© relevante levantarmos aqui?

>> Coment√°rio de rhandrade:
√ìtima coloca√ß√£o @olamundoph. Na minha opini√£o, acho que esse primeiro momento seja mais interessante focarmos em um **perfil √∫nico** para o usu√°rio, pois entendi que o foco s√£o as noticias que ser√£o cadastradas.

Poder√≠amos depois criar algo como Organiza√ß√µes, que seria somente uma maneira de mostrar para quem faz parte quem s√£o os usu√°rios que fazem parte daquela organiza√ß√£o, **mas os conte√∫dos em si seriam vinculados sempre a uma pessoa.**

Minha preocupa√ß√£o em ter um perfil de uma empresa, que teria o mesmo n√≠vel de um usu√°rio, √© que s√≥ de ver que uma noticia foi postada por essa empresa ela gere muito mais coment√°rios e curtidas do que se fosse por uma pessoa dessa empresa.

Aqui vai um exemplo:
_Obs: peguei o Diego da Rocketseat para exemplo por ser de uma empresa que acredito que todos conhecem_

**Prefer√≠vel:**
> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus eget dui nec felis eleifend lobortis quis et nibh. Nulla a cursus quam. Mauris malesuada maximus porta.
> **Postado por Diego Fernandes**


**Acho n√£o interessante:**
> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus eget dui nec felis eleifend lobortis quis et nibh. Nulla a cursus quam. Mauris malesuada maximus porta.
> **Postado por Rocketseat**

>> Coment√°rio de filipedeschamps:
Interessant√≠ssima essa discuss√£o! Eu acho legal, mais para frente, um usu√°rio ter sua pr√≥pria p√°gina como √© aqui no Github, e da√≠ pode listar suas publica√ß√µes ou outras coisas, como o @olamundoph comentou.

Sobre empresas postando, eu j√° me peguei v√°rias vezes pensando se isso √© bom ou ruim, e ao final apesar de que eu acho **muito** mais interessante uma pessoa real postando (gosto pessoal, como o do @rhandrade ), seria uma pena inibir uma empresa de postar, ela no final das contas teria publicado conte√∫dos com valor concreto, e com uma abordagem que a gente n√£o pensou.

Ent√£o eu voto por deixar o espa√ßo aberto para quem quiser vir contribuir com valor concreto, seja o que for. E se der errado, a gente avisa, coloca nas regras e reduz esse espa√ßo. E eu acredito que dificilmente a gente vai fazer isso, pois se o conte√∫do gerado pela empresa n√£o tiver valor concreto, naturalmente as pessoas n√£o v√£o avaliar positivamente, n√£o vai ter tra√ß√£o e vai perder momentum (n√£o vai ter incentivo suficiente para continuar). E se trouxer valor concreto e as pessoas avaliarem positivamente, **show de bola**! Eu vejo empresas que possuem um perfil legal para entender e lidar positivamente com o ecossistema do site, seja a pr√≥pria Rocketseat, Alura, e outras onde a empresa √© o nome da pessoa at√© üëç

>> Coment√°rio de filipedeschamps:
Pessoal, estou fechando essa issue com a tag `repescar` ü§ù
</issue_65_Defini√ß√µes do profile/pages>

<issue_68_Onde armazenar dados sens√≠veis do projeto?>
Pessoal,

Geralmente precisamos compartilhar segredos entre a gente, onde podemos armazen√°-los para compartilhar?

Por exemplo, no script do ansible que adicionei para instalar o postgres (issue #61 ), tem o arquivo `devops/ansible/group_vars/development.yml` que tem a pwd do banco de dados.
Mas este arquivo est√° criptografado usando o ansible-vault.

para voces saberem o user/pwd do banco, precisa usar o `ansible-vault decrypt` e passar a chave que usei para encriptar, como passo esta chave para voces?

>> Coment√°rio de rhandrade:
Acho que poder√≠amos criar deixar os dados sens√≠veis dentro das vari√°veis de ambiente do github e da vercel. Ai para desenvolvimento local, poder√≠amos criar algum esquema que monta os dados fakes s√≥ para podermos acompanhar como anda as novas modifica√ß√µes, como uma factory ou algo parecido. Ai os dados n√£o precisariam ser divulgados com todos no projeto.

>> Coment√°rio de rodrigoKulb:
Concordo com o @rhandrade atualmente o projeto √© fechado somente para membros, mas assim que abrir para toda internet n√£o seria legal deixar o acesso ao banco de dados de produ√ß√£o. Manter somente no servidor da vercel essa chave. No Git colocar um acesso exemplo para testes locais.

>> Coment√°rio de filipedeschamps:
Show, por enquanto estamos caminhando para isso mesmo, onde para o banco local e testes voc√™ vai encontrar uma `.env` com dados que se conectam apenas banco local, mas em ambiente de produ√ß√£o a Vercel est√° injetando as vari√°veis de ambiente (que eu peguei diretamente da DigitalOcean). Ent√£o por enquanto n√£o foi preciso de um intermedi√°rio para guardar as chaves (saiu direto da DigitalOcean para Vercel).

Mas de qualquer forma, no futuro e com a complexidade do projeto provavelmente precisaremos alguma forma de trocar segredos de forma segura sim üëç  minha sugest√£o √© que para o escopo atual do projeto a gente se esforce para n√£o precisar disso o m√°ximo poss√≠vel ü§ù

>> Coment√°rio de huogerac:
Entendido! Valeu e bora fechar esta issue aqui

>> Coment√°rio de filipedeschamps:
Estamos a 90% da Milestone 1 üòç üëç
</issue_68_Onde armazenar dados sens√≠veis do projeto?>

<issue_69_NFT do dia 0 (isso n√£o devia ser uma issue, mas foi como pensei em mostrar s√≥ para voc√™s)>
Oi, galerinha... Por meio da issue √© que eu pensei em como expor isso diretamente para os envolvidos de forma fechada. Por√©m no futuro acho poss√≠vel estarmos falando seriamente at√© em incluir um sistema de colecion√°veis no pr√≥prio TabNews, n√£o necessariamente de compras e  vendas, mas talvez colecion√°veis de conquistas...

Queria mostrar o NFT que criei do **Dia 0 do TabNews**.

![image](https://user-images.githubusercontent.com/79285536/125888839-9205b09a-8c50-49cb-b9e9-90c6c2abcb8e.png)
Dispon√≠vel no marketplace JGN da rede Binance Smart Chain: https://jgnnft.com/assets/0x3E31F70912c00AEa971A8b2045bd568D738C31Dc/2764?owner=0x55aca363fafd420e7630c55685d949d1bc45c0d2

√â um gif  animado com nossas carinhas maravilhosas em hover rapidamente.

Fiz mais para na posterioridade lembrarmos que esse dia foi "registrado em pedra", ou melhor, em blockchain, e NUNCA ser√° deletado, do que propriamente achar que as pessoas deveriam comprar. **Simbolicamente** foram geradas 262 c√≥pias e foi aplicado o pre√ßo de 0.00262 BNB, que na cota√ß√£o de hoje est√° em torno de $0.84 USD. 

CALMA. N√£o sou o chat√£o que t√° tentando vender coisas para a comunidade n√£o, relaxem... N√£o estou esperando que comprem, minha satisfa√ß√£o est√° no REGISTRO e a maior satisfa√ß√£o ainda ser√° o dia que o TabNews possa ser uma grande refer√™ncia em not√≠cias tecnol√≥gicas e olharmos para tr√°s e ver que em sua constru√ß√£o ele j√° teve sua presen√ßa marcada de alguma forma em blockchain. Afinal, a tecnologia est√° no nosso DNA (ainda bem que n√£o √© uma comunidade de profissionais da sa√∫de e n√£o v√£o me corrigir nisso).

Para quem n√£o sabe ainda do que se trata NFT's, s√£o colecion√°veis registrados em blockchain e o intuito √© certificar a originalidade de um arquivo digital e torn√°-lo limitado. Como todo inicio de algum recurso tecnol√≥gico, a ideia parece bastante abstrata para muita gente ainda, com o hype do momento a tend√™ncia √© que apare√ßam muita coisa in√∫til (um gif de uma homepage talvez fosse um exemplo?) no processo. Por√©m, eu vejo MUITA utilidade para isso no futuro, no p√≥s-hype, at√© que o dia que ser√° essencial em alguns cen√°rios espec√≠ficos.

No caso do marketplace da JGN √© necess√°rio ter uma carteira digital da Metamask, ou da BinanceChain ou da WalletConnect para transacionar.

Eu achei massa fazer isso.

>> Coment√°rio de filipedeschamps:
hahahahah que massa @olamundoph obrigado por criar essa issue!!! ü§ù 

Nem tinha passado pela minha cabe√ßa NFT para esse momento, mas isso s√≥ mostra que a decis√£o de trazer os membros para esse projeto foi a decis√£o certa. Independente de uma ideia funcionar ou n√£o, √© muito legal poder experimentar ela üëç 

E o dia que esse NFT valer 1 bilh√£o, compartilha com n√≥s um pouco po üòÇ üëç

>> Coment√°rio de pauloboare:
Boa @filipedeschamps , acho at√© que n√£o √© o momento, mas acho plaus√≠vel que em algum momento seja...
> Nem tinha passado pela minha cabe√ßa NFT para esse momento, mas isso s√≥ mostra que a decis√£o de trazer os membros para esse projeto foi a decis√£o certa. Independente de uma ideia funcionar ou n√£o, √© muito legal poder experimentar ela üëç 
> 
Imagina que louco, o dia que chegasse nesse valor, provavelmente eu j√° n√£o teria mais posse de nenhuma das 262 muito tempo antes hahaha
> E o dia que esse NFT valer 1 bilh√£o, compartilha com n√≥s um pouco po üòÇ üëç

>> Coment√°rio de filipedeschamps:
@olamundoph por hora vou fechar essa issue, mas n√£o deixe de nos trazer as novidades no assunto caso tenha üòç ü§ù
</issue_69_NFT do dia 0 (isso n√£o devia ser uma issue, mas foi como pensei em mostrar s√≥ para voc√™s)>

<issue_72_Aviso: Erro nos Deploy Previews>
Turma, durante essa semana a nossa conta gratuita na Vercel estourou um dos limites e eu precisei fazer o upgrade para a conta Pro. Inicialmente pensei que isso n√£o teria nenhum impacto (ainda mais por estar numa conta paga agora), mas eu estava enganado. Como estou pagando por 1 assento apenas, todos os Preview Deployments vindos de outras contas ir√£o dar problema.

![image](https://user-images.githubusercontent.com/4248081/126056477-3fcdaa16-0293-483e-a063-087d2210144f.png)

# Solu√ß√£o

N√£o sei e estou pensando aqui como resolver isso. Por exemplo, se o PR for aprovado, eu fazer o merge contra uma branch de `release candidate`, pois da√≠ vai ser criado o Preview com o meu assento. √â um saco e perde a din√¢mica de todo mundo conseguir rapidamente gerar URLs de Preview.

Bom, se algu√©m tiver alguma sugest√£o sobre como n√£o perder essa din√¢mica seria show üëç

>> Coment√°rio de rhandrade:
Talvez poder√≠amos usar essa ideia junto com o Github actions para permitir que se um PR tiver uma tag espec√≠fica, por exemplo `need-preview`, o merge possa ocorrer da branch solicitada para a `preview` e assim verificar se a integra√ß√£o da Vercel entenderia esse processo como sendo proveniente do autor da conta e fizesse o deploy dentro da estrutura deles.

Somente as PR com essa tag teriam esse tratamento e n√£o afetariam a branch principal. Qualquer outra PR que n√£o tivesse essa tag seria desconsiderada. Isso garantiria tamb√©m que somente as PR que realmente precisassem ser feitas o deploy fossem processadas. Talvez isso garantia que os limites da conta, mesmo da PRO, n√£o sejam estourados.

Existem algumas actions que fazem essa automa√ß√£o pelo que pesquisei.
https://github.com/pascalgn/automerge-action
https://github.com/marketplace/actions/branch-merge

Talvez seja um modo de manter essa dinamica que temos hoje de criar URLs de preview. Ser√° que isso daria certo @filipedeschamps?

>> Coment√°rio de huogerac:
1) No relat√≥rio tem mais detalhes do que est√° fazendo estourar? ser√° que √© a parte do frontend (p√°ginas, nro de acesso), a parte server side? ou a parte de CI/Devops, muitos commits, cada um gerando uma "versao" da aplica√ß√£o rodando?

Desculpa, mas pra mim n√£o est√° claro oq exatamente est√° fazendo estourar o limite, pq nesta fase aparentemente n√£o tem muito acessos, nem muito PRs gerando diversas vers√µes, tirando  a parte server side (que n√£o sei muito como a Vercel faz a m√°gica), acredito que o restante da aplica√ß√£o n√£o deveria chegar no limite

2) Vi que a Vercel, tem upgrade do FREE para o PRO por $20 e depois s√≥ enterprice, certo? n√£o √© como Heroku que vai crescendo CPU/Mem√≥ria conforme precisa.
Ser√° que Vercel para o backend √© a melhor op√ß√£o mesmo? Fiquei surpreso j√° ter chego no limite, bem antes do que eu estava imaginando

Enfim, se conseguirem mais detalhes da causa, dai vamos pensar juntos nas op√ß√µes, qual dos itens abaixo est√° no limite:

![image](https://user-images.githubusercontent.com/962233/128609537-f114c9cc-c8fc-47c3-ad0c-9fe50d3f7e71.png)


Abra√ßo

>> Coment√°rio de rhandrade:
Pelo que eu entendi da imagem que o @filipedeschamps postou o que est√° estourando √© a otimiza√ß√£o das imagens usadas no projeto. Esse limite de otimiza√ß√£o tamb√©m est√° na doc da Versel.
![image](https://user-images.githubusercontent.com/4511733/128612157-5b8c3ad3-617b-4c54-8e3a-4701c43cbda0.png)

Dando uma olhada na documenta√ß√£o da Versel [nesse item](https://vercel.com/docs/next.js/image-optimization#edge-network-optimization), ela fala que todas as imagens usando o componente `next/image`  ser√£o otimizados pela estrutura deles. 

Nesse [outro trecho](https://vercel.com/docs/next.js/image-optimization#limits) fala que se n√£o tiver setado o valor `max-age` no header `Cache-control` a versel aplicar√° um cache padr√£o de 60s, mas que se um novo deploy for realizado a Versel ir√° otimizar novamente as imagens para garantir que a vers√£o mais atual est√° sendo exibida para o usu√°rio.

![image](https://user-images.githubusercontent.com/4511733/128612029-8dd7dd1a-e009-4051-9fc9-c583cfdb3a59.png)

Acredito que como temos muitas imagens dos membros que participaram do init e quando estava na conta free qualquer membro poderia fazer um deploy preview via Git, isso estava estourando os limites de otimiza√ß√£o da conta, e provavelmente voltar√£o a ocorrer se fizermos v√°rios deploys em um √∫nico m√™s.

[Nessa p√°gina](https://vercel.com/docs/next.js/image-optimization#usage) (print abaixo) a Versel da um exemplo de como usar a chamada do componente e reparei que n√≥s no momento n√£o especificamos o width e height. Talvez isso ajudaria tamb√©m. Outro ponto seria estabelecer esse `max-age` no `Cache-control` ao obter o path para a imagem do colaborador. Como a ideia √© ser algo de lembran√ßa, podemos deixar um cache grande at√©.

Eu n√£o manjo de React, mas quem souber pode fazer essas altera√ß√µes para ver se normaliza os limites da conta.
![image](https://user-images.githubusercontent.com/4511733/128611920-ac6acf37-809d-4cef-adcf-f0d454f7f0fc.png)

>> Coment√°rio de filipedeschamps:
> Talvez poder√≠amos usar essa ideia junto com o Github actions para permitir que se um PR tiver uma tag espec√≠fica, por exemplo `need-preview`, o merge possa ocorrer da branch solicitada para a `preview` e assim verificar se a integra√ß√£o da Vercel entenderia esse processo como sendo proveniente do autor da conta e fizesse o deploy dentro da estrutura deles.

Excelente essa ideia @rhandrade ! E voc√™ tamb√©m apontou de forma precisa o que estourou no limite da conta `Hobby` e o que me surpreendeu ao fazer o upgrade para a conta `Pro` √© o n√∫mero de assentos para pessoas conseguirem fazer o deploy l√° na infra de Preview (e por consequ√™ncia, Production).

E vendo aqui, o business da Vercel gira principalmente ao redor de quantas pessoas podem fazer o deploy, ent√£o se "arranjarmos" um jeito automatizado de burlar isso, provavelmente estaremos indo contra algum termo ou naturalmente contra o que o business deles se prop√µe, e isso n√£o √© legal nem sustent√°vel.

Ent√£o por hora, vamos respeitar esse limite e entender at√© que ponto o fluxo de eu fazer o merge manual para uma outra branch (apenas se o PR for de fato aprovado) se sustenta.

Vou fechar a issue, mas podemos ir conversando, combinado? ü§ù üëç
</issue_72_Aviso: Erro nos Deploy Previews>

<issue_81_Lembretes b√°sicos ao projeto>
Objetivo dessa Inssue √© unificar todos detalhes b√°sicos evitando o esquecimento futuro. Ficar√° dentro do label (repescar):

1. Adicionar um favicon ao projeto.
2. Customizar as p√°ginas de erro (404, 405, etc..).
</issue_81_Lembretes b√°sicos ao projeto>

<issue_83_Configurar e conectar no Banco de Produ√ß√£o>
Estou adicionando mais essa issue, pois √© ela que deveremos fechar na live da pr√≥xima sexta-feira dia 30/07 üéâüéâüéâ üòç

>> Coment√°rio de huogerac:
![image](https://user-images.githubusercontent.com/962233/127698742-aef39b64-8719-4802-994b-bc2c62724e5b.png)

>> Coment√°rio de filipedeschamps:
hahahah sensacional @huogerac muito massa que foi voc√™ quem conseguiu rodar a primeira migra√ß√£o em produ√ß√£o üòç 

Fechando essa issue com chave de ouro depois dessa ü§ù üëç
</issue_83_Configurar e conectar no Banco de Produ√ß√£o>

<issue_84_Configurar e conectar no Banco de Staging (Ambiente de Preview da Vercel)>
Conectado com a issue #83 (porque se a gente resolve essa, a outra ta garantida), eu tentei conectar a nossa aplica√ß√£o no ambiente de Preview da Vercel e deu problema, isso ap√≥s configurar as vari√°veis de ambiente.

Olha o erro que est√° acontecendo:

```
error: no pg_hba.conf entry for host "3.238.132.189", user "doadmin", database "defaultdb", SSL off
    at Parser.parseErrorMessage (/var/task/node_modules/pg-protocol/dist/parser.js:287:98)
    at Parser.handlePacket (/var/task/node_modules/pg-protocol/dist/parser.js:126:29)
    at Parser.parse (/var/task/node_modules/pg-protocol/dist/parser.js:39:38)
    at Socket.<anonymous> (/var/task/node_modules/pg-protocol/dist/index.js:11:42)
    at Socket.emit (events.js:375:28)
    at addChunk (internal/streams/readable.js:290:12)
    at readableAddChunk (internal/streams/readable.js:265:9)
    at Socket.Readable.push (internal/streams/readable.js:204:10)
    at TCP.onStreamRead (internal/stream_base_commons.js:188:23) {
  length: 155,
  severity: 'FATAL',
  code: '28000',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'auth.c',
  line: '496',
  routine: 'ClientAuthentication'
}
```

Por se tratar de um teste r√°pido, eu estou usando o banco e usu√°rio padr√£o que a DigitalOcean retornou. Eu vi que se trata de `SSL` e pesquisei aqui e s√≥ fiquei ainda mais confuso, mas um detalhe importante, na URL de conex√£o do banco, tem isso no final:

```
...ondigitalocean.com:xxx/defaultdb?sslmode=require
```

`sslmode=require` ent√£o talvez o banco local funcione, pois est√° sem SSL, e em produ√ß√£o ele continua tentando conectar sem SSL e d√° problema?

Algu√©m j√° passou por isso?

>> Coment√°rio de rodrigoKulb:
Fala Felipe, ainda n√£o fiz o teste, mas dei uma olhada achei isso:
postgres://user:pass@host:port/database?ssl=true
Veja se funciona!

>> Coment√°rio de filipedeschamps:
Show Rodrig√£o! O detalhe √© que estamos usando o `pg`:
https://github.com/filipedeschamps/tabnews.com.br/blob/main/infra/database.js#L4

Nessa parte ele abre um pool de conex√£o, ent√£o meu chute √© que vai ser preciso passar alguma esp√©cie flag para evitar SSL se estamos em ambiente local, ou usar se estamos em produ√ß√£o. Daqui a pouco vou gravar o v√≠deo dos Membros e vou falar dessa issue, √© o √∫ltimo blocker üòÇ üëç

>> Coment√°rio de rodrigoKulb:
Ahh entendi vamos precisar deixar a op√ß√£o de SSL vari√°vel conforme o ambiente, tipo assim?
```JS
const pool = new Pool({
    user: process.env.POSTGRES_USER,
    host: process.env.POSTGRES_HOST,
    database: process.env.POSTGRES_DB,
    password: process.env.POSTGRES_PASSWORD,
    port: process.env.POSTGRES_PORT,
    ssl: process.env.POSTGRES_SSL,
  });
```

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show, quase isso! Olha s√≥: https://node-postgres.com/announcements#2020-02-25

Ent√£o nosso pool tem que se conectar dessa forma:

```
  const pool = new Pool({
    user: process.env.POSTGRES_USER,
    host: process.env.POSTGRES_HOST,
    database: process.env.POSTGRES_DB,
    password: process.env.POSTGRES_PASSWORD,
    port: process.env.POSTGRES_PORT,
    ssl: {
      rejectUnauthorized: false
    },
  });
```

**[edit]** na verdade isso quebra em ambiente local, tem que fazer um if maluco üëç 

E avan√ßamos üòç mas agora tomando esse erro: `must be owner of schema public`

>> Coment√°rio de filipedeschamps:
Avan√ßamos! Esse erro ta acontecendo, porque pra testar eu to rodando os testes automatizados contra o banco de Preview/Staging, e ele  dropa todas as tabelas de um jeito meio grosseiro, que √© dropando o schema:

```js
  async function dropAllTables() {
    const database = databaseFactory();
    await database.query("drop schema public cascade; create schema public;");
    await database.pool.end();
  }
```

Em ambiente Local n√£o tem problema, mas como o banco de Staging/Prod √© um servi√ßo gerenciado pela DigitalOcean, eles n√£o deixam. Da√≠ [encontrei isso](https://estl.tech/dropping-all-the-tables-d24676f67737)

> Trying the top answer on StackOverflow DROP SCHEMA public CASCADE; resulted in ERROR: must be owner of schema public . Since this is a managed database service, I won‚Äôt be able to do that. Thus the use of the alternate answer, repeated here for convenience:
> 
```
DO $$ DECLARE
    r RECORD;
BEGIN
    -- if the schema you operate on is not "current", you will want to
    -- replace current_schema() in query with 'schematodeletetablesfrom'
    -- *and* update the generate 'DROP...' accordingly.
    FOR r IN (SELECT tablename FROM pg_tables WHERE schemaname = current_schema()) LOOP
        EXECUTE 'DROP TABLE IF EXISTS ' || quote_ident(r.tablename) || ' CASCADE';
    END LOOP;
END $$;
```

Mas n√£o vou alterar, pois em condi√ß√µes normais a gente n√£o vai dropar isso em stag/produ√ß√£o (ou n√£o, ou a gente uma hora vai querer resetar tudo). Mas deixa vir esse momento üëç 

Vou programar aqui o novo `if` no pool e vamos ver se todos os ambientes funcionam üëç

>> Coment√°rio de filipedeschamps:
Empurrei um novo commit para o PR #82 e funcionou üòç  est√° se conectando no banco em todos os ambientes, mas a Vercel n√£o est√° encontrando os arquivos na pasta de migration (deve estar se perdendo na resolu√ß√£o do caminho).

```
{
  "error": "Can't get migration files: Error: ENOENT: no such file or directory, scandir './infra/migrations/'"
}
```

Investigando...

>> Coment√°rio de filipedeschamps:
Ent√£o, procurar sobre resolu√ß√£o de `paths` no Next.js traz um hist√≥rico de bastante atrito no assunto üòÇ 

De documenta√ß√£o oficial, o mais relacionado que encontrei [foi isso](https://vercel.com/docs/runtimes#advanced-usage/technical-details/including-additional-files). Mas como eu n√£o acreditava que era isso, me inspirei em [outra solu√ß√£o](https://medium.com/@boris.poehland.business/next-js-api-routes-how-to-read-files-from-directory-compatible-with-vercel-5fb5837694b9) e fiz a resolu√ß√£o do caminho (e que acredito que vai ficar mais compat√≠vel com usu√°rios que usam Windows inclusive):

```js
const { join, resolve } = require("path");
//...

export default function Migrator() {
  const defaultConfigurations = {
    dir: join(resolve("."), "infra", "migrations"),  // <---
    direction: "up",
    migrationsTable: "migrations",
    verbose: false,
  };
```

E testei aqui e funcionou em todos os ambientes: `development`, `test`, `ci` e `preview`. O `production` eu vou deixar para live üëç

>> Coment√°rio de filipedeschamps:
O PR que conserta isso foi merged üëç üòç
</issue_84_Configurar e conectar no Banco de Staging (Ambiente de Preview da Vercel)>

<issue_87_Erro ao rodar "NPM RUN DEV">
Por gentileza algu√©m pode me auxiliar neste erro?

![image](https://user-images.githubusercontent.com/47868559/127788663-8ebe4be9-8e79-47e9-b0cd-e74f50ab8689.png)

Config do meu note:
docker-compose version 1.29.2, build 5becea4c
Docker version 20.10.7, build f0df350
Windows 10 Home Single Language
Intel(R) Core(TM) i5-10210U CPU @ 1.60GHz   2.11 GHz
RAM 8,00 GB (utiliz√°vel: 7,72 GB)
Sistema operacional de 64 bits, processador baseado em x64

>> Coment√°rio de geovani-brito:
Parece que voc√™ t√° com algum problema no seu Docker-compose. N√£o parece ser nas configura√ß√µes do projeto. 
J√° tentou rodar outro container? Qualquer coisa que possa usar o Docker-compose.

Tenta rodar s√≥ o container pra ver se o servidor com o Postgres sobe.

`docker-compose -f infra/docker-compose.development.yml up -d`

>> Coment√°rio de filipedeschamps:
Fala @VOP1234 pelo que eu entendi procurando na internet, o servi√ßo do Docker n√£o est√° rodando, e com isso o docker-compose n√£o consegue se conectar nele.

Para se certificar que est√° rodando, digite esse comando e se retornar erro, o servi√ßo do Docker n√£o est√° rodando:

```
docker ps -a
```

Olha essas refer√™ncias:
- https://www.koskila.net/docker-compose-fails-on-windows-with-error-while-fetching-server-api-version-2-createfile-the-system-cannot-find-the-file-specified/
- https://stackoverflow.com/a/64953813
- https://stackoverflow.com/a/65347214

>> Coment√°rio de vitoropereira:
@filipedeschamps Obrigado pelos links. Quando rodava o "docker ps -a" retornava esse erro.

"error during connect: This error may indicate that the docker daemon is not running.: Get "http://%2F%2F.%2Fpipe%2Fdocker_engine/v1.24/containers/json?all=1": open //./pipe/docker_engine: O sistema n√£o pode encontrar o arquivo especificado."

Lendo esta [issue](https://github.com/docker/for-win/issues/1825) encontrei o c√≥digo abaixo que solucionou meu problema.

`cd "C:\Program Files\Docker\Docker"
./DockerCli.exe -SwitchDaemon
`

Que pelo que eu entendi ele troca o OSType do Docker. 


![image](https://user-images.githubusercontent.com/47868559/127861278-6cdb272a-5622-4075-9af8-168d827fffea.png)


Bom agora esta tudo 100% aqui.
</issue_87_Erro ao rodar "NPM RUN DEV">

<issue_88_Sugest√£o para o di√°rio>
O Filipe falou, no √∫ltimo v√≠deo, que o di√°rio estava ficando gigante e que era preciso pensar melhor como trabalhar essa ideia de documentar a evolu√ß√£o do projeto. E de fato j√° t√° ficando dif√≠cil rolar a p√°gina ou procurar alguma coisa l√°. E cada nova entrada tem um texto cada vez mais longo, o que j√° era esperado pois a complexidade do projeto continua aumentando. 

Por isso quero fazer uma sugest√£o ao @filipedeschamps.

1. Colocar o di√°rio na pasta `init` com um arquivo para cada dia registrado (em uma pasta pr√≥pria, claro).  
2. Colocar no README.md apenas um √≠ndice com os dias e os t√≠tulos, linkando para o arquivo correspondente. Por exemplo:

> #### Di√°rio
> 
> Antes de 17/10/20 - Um grande problema  
> 17/10/20 - Registro do dom√≠nio  
> 25/12/20 - Cria√ß√£o do reposit√≥rio

3. Ao fim de cada arquivo, colocar um link para o pr√≥ximo dia registrado assim que ele for redigido. Dessa maneira, pra quem estiver lendo na sequ√™ncia, evita ter que ficar voltando ao √≠ndice. 

O que acham? Tem algum problema de praticidade ou t√©cnico que eu n√£o tenha notado?

>> Coment√°rio de gabrielgmrs:
Legal, @geovani-brito. N√£o sei se existe outro padr√£o legal pra separar esses .md's, mas seguindo a sua linha eu apenas daria a sugest√£o de usar a data no formato ISO. Assim a ordena√ß√£o fica sempre certinha com a data :)

> 2020-17-10: Um grande problema
> 2020-10-17: Registro do dom√≠nio
> 2020-12-25: Cria√ß√£o do reposit√≥rio

>> Coment√°rio de geovani-brito:
Perfeito, @gbrlgmrs. Eu n√£o falei sobre os nomes que esses arquivos teriam justamente porque eu n√£o sabia qual padr√£o adotar. Pala praticidade da ordena√ß√£o, acho que a sua sugest√£o √© muito boa.

>> Coment√°rio de filipedeschamps:
@geovani-brito que ideia sensacional, gostei bastante üëç se puder me ajudar organizando isso, pois vou organizar agora a abertura da pr√≥xima Milestone ü§ù

>> Coment√°rio de geovani-brito:
Tranquilo, @filipedeschamps! Eu vou organizar isso. 

E se algu√©m tiver alguma sugest√£o, vamos conversando aqui ou depois na revis√£o do pull request.
</issue_88_Sugest√£o para o di√°rio>

<issue_90_Separar entradas do Di√°rio em arquivos isolados>
### Descri√ß√£o
Como leitor do reposit√≥rio, eu gostaria de poder ter um **√≠ndice** com cada entrada do di√°rio de desenvolvimento, e que ao clicar num item desse √≠ndice me levasse para o conte√∫do completo sobre o que aconteceu naquele dia, ao inv√©s de ter todas as entradas expostas no README principal.

### Motivo
O README est√° ficando extremamente grande e pesado, e vai ficar cada vez mais.

### Execu√ß√£o
Isto j√° est√° sendo executado por @geovani-brito no PR #89
</issue_90_Separar entradas do Di√°rio em arquivos isolados>

<issue_91_Instru√ß√µes de como instalar e rodar o projeto (e como commitar)>
### Descri√ß√£o
Como leitor do reposit√≥rio, eu gostaria de ver no in√≠cio do README os passos necess√°rios para rodar o projeto na minha m√°quina local, e tamb√©m como commitar minhas contribui√ß√µes, e isso inclui:
1. Como rodar em modo de desenvolvimento, incluindo como configurar o docker-compose nos sistemas operacionais (ou apenas apontando para outros tutoriais).
2. Como rodar os testes com `npm test`
3. Como dar watch nos testes com `npm run test:watch`
4. Como rodar as Actions usando o `act`
5. Qual padr√£o de commits usamos (e para ajudar, indicar o script `npm run commit`)

### Motivo
Mostrar como √© realmente simples rodar o projeto em ambiente local e como consequ√™ncia aumentar as contribui√ß√µes.

### Depend√™ncias
Primeiro fazer o merge do PR #89 que est√° refatorando o di√°rio.

>> Coment√°rio de geovani-brito:
Para essa issue, primeiro acho melhor resolver o PR #109 do Tiago porque ele faz outras altera√ß√µes no README.

Mas aproveitando o momento, quero saber se voc√™ pensa em criar um arquivo `CONTRIBUTING.md` para informar as regras de contribui√ß√£o no projeto.

>> Coment√°rio de rhandrade:
Curti a ideia do @geovani-brito, pois ai podemos levar para um arquivo com mais detalhes e deixar o readme mais organizado.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps 
Apenas para deixar a documenta√ß√£o completa acabei de tentar fazer um commit npm run commit me retornou o erro 

`sh: 1: cz: not found `

Minha d√∫vida n√£o deveria instalar esse pacote no npm install?

Para resolver tive que instalar na m√£o:  npm install cz

abs.

>> Coment√°rio de filipedeschamps:
Interessant√≠ssimo @rodrigoKulb e sim, com um simples `npm install` deveria funcionar.

Verifiquei aqui se a depend√™ncia `cz` estava instalada globalmente na minha m√°quina, e n√£o estava:

```
‚ùØ cz
zsh: command not found: cz
```

Depois fiz um `rm -rf node_modules` e `npm i` e o `npm run commit` rodou como esperado.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps acabei de descobri o problema foi apos rodar o `npm i` recebi a informa√ß√£o de `vulnerabilities` ent√£o como de costume segui a dica do terminal para resolver ` npm audit fix --force` acredito que o pacote CZ tenha alguma vulnerabilidade identificada recentemente. Conforme imagem abaixo:

![Captura de tela em 2022-04-07 15-20-04](https://user-images.githubusercontent.com/5334261/162271080-202382c8-ec6d-428b-bcbd-98f84eebbd41.png)
</issue_91_Instru√ß√µes de como instalar e rodar o projeto (e como commitar)>

<issue_92_Transformar a Factory "database" em um Singleton>
### Descri√ß√£o
Como desenvolvedor do sistema, eu gostaria de importar o m√≥dulo do banco de dados e us√°-lo diretamente, sem precisar rodar a Factory que cria e me devolve uma inst√¢ncia do banco.

Ent√£o ao inv√©s de:

```js
import databaseFactory from "infra/database.js";
const database = databaseFactory();
await database.query("SELECT...");
```

Ser assim:

```js
import database from "infra/database.js";
await database.query("SELECT...");
```

### Motivo
Uma das estrat√©gias mais b√°sicas quando se lida com banco de dados √© a utiliza√ß√£o de um `Pool` que vai gerenciar as conex√µes ao banco, e isso inclui abrir novas conex√µes, reutiliz√°-las quando necess√°rio, ou fechar quando ficaram paradas por muito tempo.

A vers√£o atual da codebase j√° est√° utilizando o `Pool` fornecido pelo m√≥dulo `pg`, por√©m pelo fato de estar dentro de uma Factory acaba perdendo o sentido, porque toda vez que √© criada uma inst√¢ncia, √© criado consigo um novo Pool... e idealmente voc√™ deveria ter apenas um √∫nico Pool para todo o backend. Infelizmente esse √© um cen√°rio imposs√≠vel para n√≥s, porque atualmente estamos rodando em um ambiente serverless na Vercel, ent√£o isso vai agravar o problema de consumo de conex√µes ao banco porque as [Serverless Functions s√£o stateless](https://vercel.com/docs/solutions/databases#connecting-to-your-database), o que nos vai levar para o futuro j√° previsto de usar o [PgBouncer](https://www.pgbouncer.org/).

De qualquer forma, sugiro usar o Pool do jeito que ele √© feito para ser usado, [edit] at√© porque eu acho que apesar da fun√ß√£o ser stateless, eles reutilizam o contexto que est√° fora do handler. Talvez o @paulogdm possa confirmar isso.

### Alternativas

Todo m√≥dulo num ambiente Node √© um Singleton por natureza, e √© apenas executado uma √∫nica vez independente de quantas vezes for importado, ent√£o uma das estrat√©gias poderia ser mover a inicializa√ß√£o do Pool para fora da Factory, mas da√≠ na minha vis√£o fica confuso, pois quando uso uma Factory quero ter a garantia que recebo como retorno uma inst√¢ncia sem re√∫so de estado. Ent√£o sugiro assumirmos que o m√≥dulo database √© um Singleton de fato, pois estrategicamente queremos reaproveitar o Pool do jeito que foi arquitetado para ser usado, independente de qual servidor est√° hospedando nosso sistema.

>> Coment√°rio de paulogdm:
>  eles reutilizam o contexto que est√° fora do handler

Correto üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps e @brunofamiliar essa Inssue n√£o foi finalizada no #98 ?

>> Coment√°rio de filipedeschamps:
Totaaaal!! Fechando ela, valeu pelo toque @rodrigoKulb ü§ù üòç
</issue_92_Transformar a Factory "database" em um Singleton>

<issue_93_Criar um .prettierrc>
### Descri√ß√£o
Como desenvolvedor do sistema, eu gostaria que o meu editor de c√≥digo carregasse automaticamente as regras de code style sobre o Prettier, vindo do arquivo de configura√ß√£o `.prettierrc`.

### Motivo
Pelo que foi informado na √∫ltima Live e que faz total sentido, sem esse arquivo os editores n√£o possuem nenhuma pista que deveriam respeitar esse padr√£o de formata√ß√£o.

### Mais detalhes
As regras usadas hoje s√£o as padr√µes do Prettier, ent√£o eu n√£o sei exatamente o que colocar dentro desse arquivo.

>> Coment√°rio de FilippeMafra:
A configura√ß√£o mais simples que utilizo hoje no meu projeto √©:
```
{
  "semi": false,
  "trailingComma": "all",
  "singleQuote": true,
  "printWidth": 120,
  "bracketSpacing": true,
  "jsxBracketSameLine": true
}
```

Essas op√ß√µes est√£o descritas na documenta√ß√£o em  [Op√ß√µes Prettier](https://prettier.io/docs/en/options.html), para configurar o seu editor de c√≥digo tamb√©m tem um passo a passo na documenta√ß√£o: "[Configurar Prettier no seu Editor](https://prettier.io/docs/en/editors.html)".

A respeito do tamanho m√°ximo da linha eu utilizo 120, pois utilizo uma letra pequena no editor; o padr√£o do Prettier √© 80, da√≠ tem que ver com o pessoal qual √© o melhor para esse caso.

Pessoal, s√≥ comentando que sou iniciante na utiliza√ß√£o do prettier, se algu√©m achar uma maneira melhor, ou quiser que eu explique o porqu√™ utilizo essa configura√ß√£o especificamente √© s√≥ me avisar. Vamos nos ajudando aqui :D .

>> Coment√°rio de rhandrade:
Muito bacana @FilippeMafra... Eu tamb√©m to iniciando com o Prettier, ent√£o to aprendendo usando ü§£. Uma coisa que eu vi em algum tutorial quando estava procurando como configurar e achei legal √© usar o arquivo e configura√ß√£o do Prettier junto com o `.editorconfig`, pois por padr√£o o Prettier respeita as configura√ß√µes dele, e a maioria das IDEs o suportam tamb√©m.

**Meu prettier eu deixo assim**
```
{
    "printWidth": 120,
    "singleQuote": true
}
```

**E no .editorconfig assim**
```
root = true

[*]
indent_style = space
indent_size = 4
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true
```

O que podemos fazer tamb√©m √©, ao inv√©s de criar um arquivo separado, realizar a configura√ß√£o diretamente no `package.json`, como [mostra aqui](https://prettier.io/docs/en/configuration.html) na documenta√ß√£o do Prettier. Assim √© mais garantido que quem baixar o projeto ter√° as regras para a formata√ß√£o. E se algu√©m remover os dados do package.json, bem ai n√£o tem muito o que fazer üòï.

>> Coment√°rio de filipedeschamps:
Show, muito obrigado pelas sugest√µes!!! üòç 

E optei por criar o arquivo `.prettierrc` pois j√° temos na raiz o `.prettierignore` üëç 

E o PR implementando esta aqui: #113
</issue_93_Criar um .prettierrc>

<issue_94_Remover o script "test:ci" do package.json e mover para dentro da Action>
### Descri√ß√£o
Como mantenedor da infraestrutura de testes, eu gostaria de tirar do `package.json` scripts que n√£o agregam em nada, como o `test:ci` e repassar o comando do `jest` de dentro desse script diretamente para a Action/Workflow `tests.yml`.

### Motivo
Me parece uma abstra√ß√£o completamente desnecess√°ria ter um comando que √© usado exclusivamente pela Action, que no final das contas roda apenas `jest --runInBand`. Sugiro economizar essa linha dentro do `package.json` e n√£o ter que fazer a pessoa que est√° lendo a Action ter que voltar para o `package.json` para entender o que o comando faz.

>> Coment√°rio de geovani-brito:
Essa issue √© simples de resolver, certo?

Eu tentei mas n√£o sou autorizado a alterar um workflow do Actions. Acho que s√≥ voc√™ vai poder resolver essa. 

>`refusing to allow a Personal Access Token to create or update workflow .github/workflows/tests.yml without workflow scope`

>> Coment√°rio de filipedeschamps:
@geovani-brito √© bem simples, correto!

E estranho, eu n√£o entendi exatamente onde est√° recebendo esse erro. Voc√™ est√° usando um token para alterar o workflow?

**Sugest√£o:** fa√ßa um clone desse reposit√≥rio aqui (e n√£o um fork), altere o package.json e a Action, e envie um PR aqui para esse reposit√≥rio. Ele deveria rodar a Action com as novas condi√ß√µes j√° ü§ù üëç

>> Coment√°rio de geovani-brito:
>Sugest√£o: fa√ßa um clone desse reposit√≥rio aqui (e n√£o um fork), altere o package.json e a Action, e envie um PR aqui para esse reposit√≥rio. Ele deveria rodar a Action com as novas condi√ß√µes j√° 

Eu j√° tava trabalhando assim. Eu nunca fiz um fork desse reposit√≥rio. 
Ent√£o eu pensei o seguinte: j√° que eu j√° tava trabalhando com um clone vamos tentar com um fork.  

Bem... fiz com o fork e recusou. Pensei que pudesse ser por alguma raz√£o com a branch que criei. Ent√£o mesclei a branch na main e tentei dar o push. Mesmo erro. 

Voltei para o clone e fiz o mesmo procedimento.  Mesclei a branch do trabalho na main. Como a main aqui √© protegida imagino que dando um push vai ser solicitado um pull request. Tentei. Mesmo erro. 

A mensagem muda um pouco caso eu tenha feito com o fork ou com a branch ou com o clone direto... seja como for, aquela mensagem `refusing to allow a Personal Access Token to create or update workflow '.github/workflows/tests.yml' without 'workflow' scope` sempre aparece.

`Counting objects: 9, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (8/8), done.
Writing objects: 100% (9/9), 943 bytes | 943.00 KiB/s, done.
Total 9 (delta 6), reused 0 (delta 0)
remote: Resolving deltas: 100% (6/6), completed with 4 local objects.
To https://github.com/filipedeschamps/tabnews.com.br.git
 ! [remote rejected] main -> main (refusing to allow a Personal Access Token to create or update workflow '.github/workflows/tests.yml' without 'workflow' scope)
error: failed to push some refs to 'https://geovani-brito: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@github.com/filipedeschamps/tabnews.com.br.git'`

Depois de falhar tudo, fui por outra estrat√©gia. Fiz as altera√ß√µes aqui mesmo no Github. Pelo menos aqui eu consegui criar a branch o que possibilitou rodar os testes. S√≥ que dessa vez o que aconteceu √© que ele n√£o encontrou o `Jest` como mostra a mensagem de sa√≠da do CI:

`Run npm start & jest --runInBand
  npm start & jest --runInBand
  shell: /usr/bin/bash -e {0}
/home/runner/work/_temp/7a9f98f8-7b70-41da-89a8-6f3c4568efde.sh: line 1: jest: command not found`

Eu n√£o sei porque isso acontece mas j√° tive esse problema. Eu s√≥ conseguia rodar `Jest` usando o `npm run`. Escrever o comando `jest` diretamente no terminal dava "comando n√£o encontrado".  Se algu√©m me explicar porque isso acontece eu prometo guardar em uma gaveta especial no meu c√©rebro. üòÜ

>> Coment√°rio de filipedeschamps:
Sensacional @geovani-brito acho que entendi o que aconteceu:

> Voltei para o clone e fiz o mesmo procedimento. Mesclei a branch do trabalho na main. Como a main aqui √© protegida imagino que dando um push vai ser solicitado um pull request. Tentei. Mesmo erro.

Na verdade n√£o, voc√™ n√£o deve mesclar sua branch de trabalho na main. O que voc√™ deve empurrar para o `origin` √© a sua branch de trabalho, assim como fez com a branch `issue_94`.

> Eu n√£o sei porque isso acontece mas j√° tive esse problema. Eu s√≥ conseguia rodar Jest usando o npm run. Escrever o comando jest diretamente no terminal dava "comando n√£o encontrado". Se algu√©m me explicar porque isso acontece eu prometo guardar em uma gaveta especial no meu c√©rebro. üòÜ

Perfeito, faz sentido dar esse erro, pois de fato o `jest` n√£o √© instalado globalmente e n√£o vai estar dispon√≠vel diretamente na linha de comando. E ao rodar com o `npm`, pelo fato dele saber resolver o local da depend√™ncia dentro do `node_modules` ele consegue rodar sem problemas.

Ent√£o para n√£o precisar instalar globalmente o pacote, e nem resolver na unha onde est√° o bin√°rio do jest, vamos usar o `npx`, porque ele vai saber resolver isso para n√≥s.

L√° na Action dever√° ficar algo como:

```
- run: npm start & npx jest --runInBand
```

>> Coment√°rio de geovani-brito:
>Na verdade n√£o, voc√™ n√£o deve mesclar sua branch de trabalho na main. O que voc√™ deve empurrar para o origin √© a sua branch de trabalho, assim como fez com a branch issue_94.

N√£o se preocupe, esse sempre foi o meu procedimento padr√£o. Qualquer altera√ß√£o que fa√ßo em um projeto eu crio uma branch pra isso. Eu tentei essa lamban√ßa a√≠ porque eu n√£o tava conseguindo nem mesmo enviar a branch a partir do meu computador e porque imaginei que o Github n√£o deixaria fazer esse merge e for√ßaria a cria√ß√£o de uma branch como ele faz em algumas situa√ß√µes colocando o nome do usu√°rio seguido da palavra "patch". 

>Ent√£o para n√£o precisar instalar globalmente o pacote, e nem resolver na unha onde est√° o bin√°rio do jest, vamos usar o npx, porque ele vai saber resolver isso para n√≥s.

A maravilha √© essa mesmo.  Fiz a altera√ß√£o e os testes passaram. S√≥ falta voc√™ verificar l√° se t√° tudo certinho. Eu n√£o sabia que o npx resolveria isso.  Mais um aprendizado pra guardar em uma gavetinha especial do c√©rebro. Valeu!!

>> Coment√°rio de filipedeschamps:
Sensacionaaaal meu caro!!! Feito o merge! ü§ù üëç
</issue_94_Remover o script "test:ci" do package.json e mover para dentro da Action>

<issue_95_Definir quem ser√° o "Guia de Acessibilidade">
### Descri√ß√£o
Como desenvolvedor e leitor do site, eu gostaria de saber que temos uma ou mais pessoas respons√°veis pelo assunto acessibilidade para nos ajudarem a manter o site o mais acess√≠vel poss√≠vel em suas implementa√ß√µes, seja nos educando no assunto, ou at√© apontando falhas de acessibilidade no que j√° foi implementado ou que est√° em revis√£o.

### Motivo
O @CarlosZiegler trouxe na issue #43 muitas informa√ß√µes importantes e eu fico feliz que isso tenha sido levantado j√° agora no in√≠cio, pois isso d√° a chance do assunto entrar no DNA do projeto.

>> Coment√°rio de gabrielgmrs:
Pessoal, acho que n√£o tenho autoridade no assunto pra ser guia, mas al√©m de gostar do tema tive experi√™ncias bacanas implementando melhorias do tipo pra algumas empresas grandes (CBN e TIM). Na primeira, inclusive, fiz pair com uma consultora deficiente visual por alguns meses üòÉ 

Coloco meu conhecimento √† disposi√ß√£o ao lado de quem mais quiser ajudar nessa frente!

>> Coment√°rio de filipedeschamps:
Que sensacionaaaaaal @gbrlgmrs üòç muito muito massa e obrigado por ficar antenado aqui nas issues ü§ù 

E sobre n√£o ter autoridade, n√£o se preocupe, pois a escolha do termo **guia** foi planejada e n√£o herda as caracter√≠sticas de um **guru**. Um guru sabe tudo a princ√≠pio, mas fica de longe e n√£o participa das situa√ß√µes no dia a dia. J√° um guia √© aquela pessoa que n√£o necessariamente sabe tudo como um guru, mas ta ali no jogo, na vida real, com quem tamb√©m est√° no meio da trilha.

Numas das primeiras lives eu pedi permiss√£o para ser o "guia da simplicidade" do projeto pra ajudar a manter ele num estado simples o m√°ximo poss√≠vel, e estou aqui no reposit√≥rio com a turma, trocando ideias, vendo as coisas por v√°rios √¢ngulos, aprendendo e tendo que escolher um dos caminhos no final das contas. Com certeza eu vou ser o chato do reposit√≥rio, mas prefiro muito mais ser o guia e me lambuzar com a turma do que ter a autoridade de um guru e ficar afastado üëç

>> Coment√°rio de CarlosZiegler:
Ola pessoal, cara primeiro dizer que ler as issues e coment√°rios aqui no repo ( na comunidade do YouTube tamb√©m ) √© muito massa, da para pegar diversos cases e feedbacks e crescer muito profissionalmente. Parab√©ns aos envolvidos. Sobre o tema eu n√£o tenho experi√™ncia mas espero em algum ponto estar contribuindo aqui tambem.

>> Coment√°rio de filipedeschamps:
Sensacional @CarlosZiegler !!! Inclusive, a minha expectativa √© dessa experi√™ncia eu me sentir pronto para um dia ser um guia nesse assunto no futuro ü§ù

>> Coment√°rio de gabrielgmrs:
Excelente, @filipedeschamps! Contem comigo, ent√£o, pra ser uma das cabe√ßas no desenvolvimento desse tema. Como come√ßamos?

>> Coment√°rio de filipedeschamps:
@gbrlgmrs dando continuidade, eu vou fechar essa issue por hora, uma vez que os trabalhos de fato sobre esse t√≥pico ir√£o come√ßar a acontecer na pr√≥xima milestone, que √© quando iremos trabalhar na interface ü§ù  Era para ser nessa milestone, mas como precisei voltar a dar mais peso na produ√ß√£o dos v√≠deos (e com isso desacelerar um pouco a velocidade aqui no reposit√≥rio), ficou melhor rebalancear as milestones üòç üëç
</issue_95_Definir quem ser√° o "Guia de Acessibilidade">

<issue_96_Usar `next-connect` nos controllers>
### Descri√ß√£o
Como desenvolvedor do sistema, gostaria de encontrar um padr√£o nos controllers da API.

### Motivo
O m√≥dulo [next-connect](https://www.npmjs.com/package/next-connect) parece estar se tornando quase que um padr√£o para quem desenvolve uma aplica√ß√£o mais elaborada com Next.js. Fora que ele √© extremamente similar com a forma `Express` de se declarar rotas/controllers.

Com ele poderemos de forma mais organizada usar middlewares de autentica√ß√£o, autoriza√ß√£o e tratamento de erros de forma centralizada.

>> Coment√°rio de filipedeschamps:
Closed by: https://github.com/filipedeschamps/tabnews.com.br/pull/119 ü§ù
</issue_96_Usar `next-connect` nos controllers>

<issue_97_Padr√£o no retorno de Erros>
### Descri√ß√£o
Como desenvolvedor do sistema ou consumidor da API, eu gostaria de contar com um padr√£o de erros, tanto na implementa√ß√£o de erros customizados, quanto no retorno da API.

### Motivo
Consultas com sucesso v√£o acabar n√£o tendo um padr√£o no seu retorno, pois hora um endpoint pode retornar um objeto, hora pode retornar uma lista, mas retornos com erro podem ter um padr√£o. Isso √© extremamente importante, pois o "caminho feliz" de uma aplica√ß√£o √© geralmente muito discutido, mas o "caminho infeliz" pode fugir do nosso controle e um padr√£o no objeto de retorno pode ajudar muito a mostrar esse erro de uma forma legal numa interface com o usu√°rio, ou programaticamente quando consultado por um outro programa.

### Execu√ß√£o
Tem uma [talk que fiz no Pagar.me Talks](https://youtu.be/ZgWyha2d6iY) sobre como fazer erros customizados e de uma forma padronizada, n√£o sei se esse assunto evoluiu ao ponto de mudar alguma coisa, √© preciso avaliar.

De qualquer forma, segue aqui uma sugest√£o da estrutura do objeto de retorno (e sempre super aberto a discuss√£o):

```json
{
    "message": "Mensagem curta sobre o erro.",
    "action": "Uma sugest√£o, para quem recebeu esse erro, do que fazer para consertar ele.",
    "type": "tipo_do_erro_para_ser_consultado_de_forma_programatica",
    "traceid": "2525ef6e-fa2e-11eb-9a03-0242ac130003",
    "errors": [{
      "field": "username",
      "message": "O nome de usu√°rio deve ser preenchido."
    }, {
      "field": "password",
      "message": "A senha deve ser preenchida."
    }]
}
```

### Depend√™ncia
Seria interessante primeiro executar a issue #96 e padronizar os controllers.

>> Coment√°rio de rhandrade:
Show @filipedeschamps... Pelo que entendi identificar√≠amos os erros pelo status code da requisi√ß√£o. Ai fiquei com uma d√∫vida.

No exemplo que voc√™ deu o erro ocorreu devido a uma regra da aplica√ß√£o. Nesses casos devemos responder com um status 200, indicando que o servidor processou a requisi√ß√£o e por algum motivo deu erro e incluir uma flag dentro da resposta mostrando que teve um erro (tipo um `"success": false`), ou usamos os status 4xx para indicar isso, como um 400, por exemplo? 

Sempre fico em d√∫vida nessa parte, porque fico tentado encontrar o melhor status code para descrever o problema retornado. No exemplo que voc√™ deu e olhando a defini√ß√£o do http status code, talvez o status 400 n√£o seria a melhor op√ß√£o, visto que o servidor conseguiu entender a requisi√ß√£o. ü§î

>> Coment√°rio de filipedeschamps:
Excelente pergunta @rhandrade ! N√≥s devemos usar os status code sim ao retornar a request no controller üëç  ent√£o como voc√™ j√° pode deduzir pelo status code se a request teve sucesso ou n√£o, acho redundante colocar uma propriedade/flag a mais na resposta. Incusive a maioria das bibliotecas que consomem endpoints http v√£o escolher continuar ou jogar um erro dependendo do status code retornado.

O exemplo que coloquei √© meio mock, mas sobre a parte de faltar alguns campos ali, a gente poderia usar o `400 Bad Request` que √© o mais comum... ou o `422 Unprocessable Entity` que n√£o √© t√£o comum, mas √© bem espec√≠fico nessa condi√ß√£o, olha a descri√ß√£o que legal:

> The 422 (Unprocessable Entity) status code means the server
   understands the content type of the request entity (hence a
   415(Unsupported Media Type) status code is inappropriate), and the
   syntax of the request entity is correct (thus a 400 (Bad Request)
   status code is inappropriate) but was unable to process the contained
   instructions.  For example, this error condition may occur if an XML
   request body contains well-formed (i.e., syntactically correct), but
   semantically erroneous, XML instructions.

>> Coment√°rio de rhandrade:
Show @filipedeschamps, agora consegui entender melhor essa quest√£o. Vlw üëç

>> Coment√°rio de huogerac:
Bem legal, ter esta tarefa para padronizar! criar algo inicial para ir modelando o lan√ßamento e tratamento de erros. 

Eu gostaria de apresentar aqui uma linha um pouco relacionado com isto, mas √© mais abrangente, √© o OpenAPI que tambem tem seu estilo de exibir os erros.

Por exemplo,
Vamos dizer que ao tentar obter uma Not√≠cia via ID. E que este ID n√£o existe na base:
- A camada de servi√ßo pode lan√ßar um DoesntExistError
- A camada de API captura e transforma em um 404 como uma mensagem amig√°vel.

```
{
  "detail": "Tabnews ID: 42 not found!",
  "status": 404,
  "title": "Not Found",
  "type": "...."
}
```

Eu tentei criar uma vers√£o bem inicial do OpenAPI para o tabnews, pensando mais nos status_code e input/output.
Segue abaixo:

- [ ] Vers√£o para visualiza√ß√£o (HEROKU): https://tabnewspy.herokuapp.com/api/ üöÄ
- [ ] Tem os endpoints para milestone 2/3

```
## Validate it at: https://apitools.dev/swagger-parser/online/

openapi: 3.0.2

info:
  version: 0.1.0
  title: Tabnews (side project) API Backend
  description: API and database for auth, users and news
  contact:
    name: Tabnews
    email: api@tabnews.com.br
    url: https://tabnews-web.vercel.app/

servers:
  - url: https://tabnewspy.herokuapp.com/api/
    description: Development

paths:
  /api/version:
    get:
      operationId: api.api_version
      summary: Returns the API version
      tags:
        - Status
      responses:
        200:
          description: Success

  /api/auth/login:
    post:
      operationId: api.auth.login
      summary: User login to get a JWT Token
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  example: john@doe.com
                password:
                  type: string
                  example: "@bC1234"
      responses:
        200:
          description: JWT Access Token
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/User"
                  token:
                    type: string
                    example: Encripted.JWT.Token
                  refresh_token:
                    type: string
                    example: Another.Encripted.JWT.Token.With.Long.Expiration
        400:
          description: Bad request. You must send an email and password
        401:
          description: Email or password is not valid

  /api/auth/github/login:
    get:
      operationId: api.auth.github_login
      description: Login github
      tags:
        - Auth
      responses:
        302:
          description: Redirect to the authorization

  /api/auth/github/authorize:
    get:
      operationId: api.auth.github_authorize
      description: Token
      tags:
        - Auth
      responses:
        302:
          description: Redirect to the frontend

  /api/tabnews:
    get:
      operationId: api.tabnews.list_tabnews
      summary: Returns the latest tabnews
      tags:
        - Tabnews

      responses:
        200:
          description: The lastest Tabnews
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Tabnews"

    post:
      operationId: api.tabnews.create_tabnews
      summary: Create a new Tabnews
      tags:
        - Tabnews
      security:
        - jwtAuth: [tabnews:create]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              required:
                - title
              properties:
                title:
                  type: string
                  example: 101 facts that prove the Earth is flat
                  minLength: 12
                description:
                  type: string
                  example: Despite being a maiority, in absolute terms, few people know the real truth...

      responses:
        201:
          description: Tabnews created succesfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Tabnews"
        400:
          description: Invalid data to create a Tabnews
        401:
          description: No Authorization
        403:
          description: No Permission

components:
  securitySchemes:
    jwtAuth:
      type: oauth2
      x-tokenInfoFunc: services.token.check_token_info
      flows:
        authorizationCode:
          tokenUrl: "url"
          authorizationUrl: "url"

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: John Doe
        email:
          type: string
          example: john@doe.com

    Author:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: John Doe
        avatar:
          type: string
          example: http://example.com/img/avatar/jose_thumb.png
          nullable: true

    Tabnews:
      type: object
      properties:
        id:
          type: integer
          example: 42
        title:
          type: string
          example: Python is a great option for backend and APIs
        description:
          type: string
          nullable: true
        author:
          $ref: "#/components/schemas/Author"
        created_at:
          type: string
          format: date-time
          example: 2021-01-11T11:32:28Z

```

p.s:
- Este YAML pode ser alterado online com este editor: https://editor.swagger.io/
- Sei que a sugest√£o √© n√£o usar JWT, este YAML est√° com JWT, mas deve ser uma altera√ß√£o pequena para usar autentica√ß√£o via session/cookie
- Pode notar que as permiss√µes s√£o com base em recursos ao inv√©s de role

Tamb√©m tentei integrar no Next-JS o OpenAPI, mas falhei miseravelmente:
https://github.com/jellydn/next-swagger-doc üòû

Dai acabei fazendo com uma stack que tenho mais conhecimento, ent√£o esta vers√£o rodando no Heroku foi feita com Python/Flask

>> Coment√°rio de rhandrade:
Que maneiro @huogerac. Achei a ideia de usar a OpenAPI sensacional por ela j√° ser um padr√£o para descrever APIs bem difundido. Quanto ao exemplo que voc√™ deu talvez n√£o seria necess√°rio colocar o status code dentro do objeto, como o @filipedeschamps tinha comentado na minha d√∫vida...

Esses dias tava fu√ßando na API beta do OpenAI e curti o modo como eles retornam os erros, deixo um exemplo abaixo. A requisi√ß√£o nesse caso retornou um status code 404 com o seguinte objeto:
```
{
  "error": {
    "code": null,
    "message": "Engine not found",
    "param": null,
    "type": "invalid_request_error"
  }
}
```

>> Coment√°rio de filipedeschamps:
Show pessoal, estou voltando nessa thread :)

Sobre um objeto de erro singular, como √© feito no caso onde √© preciso retornar m√∫ltiplos erros? Por exemplo numa valida√ß√£o de um formul√°rio em que mais de 1 campo pode n√£o passar na valida√ß√£o?

Mas sobre o OpenAPI num geral, ele √© uma descri√ß√£o de como a API funciona, e tamb√©m define os padr√µes de resposta, e com isso consegue gerar documenta√ß√£o, correto? To pesquisando a respeito. Quem usa, fala muito bem, mas n√£o to conseguindo achar uma ado√ß√£o massiva ao ponto de me sentir confort√°vel em colocar essa abstra√ß√£o em cima das respostas. Mas vou estudar mais a respeito üëç 

Em paralelo, vejo tamb√©m que √© uma camada que d√° para colocar por cima depois, e no est√°gio atual do projeto, podemos mudar qualquer interface p√∫blica que quisermos ü§ù

>> Coment√°rio de liverday:
Criei um PR https://github.com/filipedeschamps/tabnews.com.br/pull/129 como proposta da padroniza√ß√£o dos erros utilizando o `onErrorHandler` do `next-connect`. Creio que a sugest√£o que o @filipedeschamps funciona muito bem, tanto nos casos de erros singulares, como nos erros m√∫ltiplos.

>> Coment√°rio de rhandrade:
@filipedeschamps Acredito que quando forem muitos erros poder√≠amos retornar um array contendo v√°rios objetos erros, cada qual com o erro que aconteceu. 

O Laravel tem uma proposta semelhante se n√£o estou enganado, no qual temos um objeto errors, no qual cada propriedade √© um campo que causou o erro e o valor √© um array contendo com todos os erros de valida√ß√£o para aquele campo.

Sobre a OpenAPI eu entendi isso ai tbm.

>> Coment√°rio de brunofamiliar:
Ol√° pessoal! Essa issue foi resolvida no PR #131 certo? o que acham de fecharmos para focar nas pend√™ncias ainda existentes?

>> Coment√°rio de filipedeschamps:
Show @rhandrade o custom error consegue esperar um array de erros e retornar no `errors` um array üëç 

@brunofamiliar corret√≠ssimo e valeu pelo toque! Fechando a issue üòç
</issue_97_Padr√£o no retorno de Erros>

<issue_99_Aviso importante sobre a Milestone 2 ü§ù>
Fala turma, como est√£o todos?

Caso voc√™ esteja dando `watch` no projeto, percebeu que as issues para a [Milestone 2](https://github.com/filipedeschamps/tabnews.com.br/milestone/3) est√£o sendo criadas com bem mais carinho, depois da sugest√£o do @huogerac, ao ponto de ser poss√≠vel j√° implementar algumas at√© ao final, como j√° est√° sendo feito inclusive.

![image](https://user-images.githubusercontent.com/4248081/129055549-35b2b3be-5e03-4161-8840-05f7655e24d5.png)

E fazer as issues dessa forma est√° sendo **muito** melhor, tanto porque d√° para pensar de uma forma mais profunda no que deve ser feito, quanto possibilita qualquer pessoa conseguir contribuir dado que as explica√ß√µes est√£o mais detalhadas... mas como a natureza n√£o deixa nada de gra√ßa, d√° muito mais trabalho. Eu pensei que conseguiria terminar tudo at√© ontem, mas foi imposs√≠vel dado a din√¢mica aqui de casa e talvez n√£o consiga terminar hoje tamb√©m.

Em paralelo, a OpenAI lan√ßou o Codex e eu **realmente** gostaria de fazer um v√≠deo sobre isso porque eu fiquei maravilhado, a parte de ir descrevendo um jogo e ele ir sendo feito pelo computador **√© um sonho meu de inf√¢ncia** e eu gostaria muito de cobrir isso no canal e me botei o desafio de conseguir fazer esse v√≠deo at√© segunda **(inclusive, eu quero conversar sexta-feira no v√≠deo dos Membros sobre a din√¢mica entre o Canal e TabNews)**.

# Ent√£o o que eu proponho aqui √©:
Como j√° temos v√°rias issues bem formatadas para execu√ß√£o direta ou para discuss√£o, a ideia √© empurrar a abertura da Milestone alguns dias pra frente para eu conseguir produzir esse v√≠deo.

Se voc√™s toparem, eu ficaria muito feliz e em seguida eu volto a criar o restante das issues continuando com o mesmo carinho dessas primeiras issues üòç

>> Coment√°rio de geovani-brito:
Eu acho que nem h√° d√∫vidas entre os envolvidos aqui de que esse projeto n√£o tem pressa e de que estamos prezando mais pelo trabalho bem feito do que pela velocidade de desenvolvimento. 

Eu achei bem interessante quando voc√™ come√ßou a abrir issues nessa forma de casos de uso. Pode ser mais trabalhoso, mas fica realmente f√°cil de entender a tarefa.  Por mim, n√£o tem problema nenhum continuar isso depois. Anda mais se o motivo √© a cria√ß√£o de v√≠deo para o canal. Acho que todos aqui s√≥ tem a ganhar.  Manda bala!

>> Coment√°rio de cezarmezzalira:
Filipe, √© uma satisfa√ß√£o estar em um projeto contigo e tantas outras pessoas legais e que tenho certeza que tamb√©m sentem sua falta nos v√≠deos de segunda do canal.
Eu mesmo todas as segundas tinha um encontro marcado contigo pelo v√≠deo, tanto que chegava 11h eu j√° sabia que teria um v√≠deo novo.
Eu imagino que n√£o est√° sendo f√°cil conciliar essa nova rotina e tamb√©m n√£o quero que se sinta pressionado em fazer os v√≠deos.
Acredito que todos aqui est√£o dispostos a entender tudo isso, da mesma forma que ajudam por aqui :)
Sendo assim, manda ver no v√≠deo de segunda e vamos trabalhando por async/await kkkkkkkkk

Abra√ßo meu caro!

>> Coment√°rio de filipedeschamps:
Vai ter v√≠deo segunda üòç segue pequeno spoiler pra voc√™s:

![frames_1 8 1](https://user-images.githubusercontent.com/4248081/129271930-7dcc8a9a-6a17-4b2f-94b7-2a3b3518dba4.jpg)

>> Coment√°rio de filipedeschamps:
Pessoal, mais uma movimenta√ß√£o sobre a Milestone 2 que acredito valer a pena: como vou voltar a tentar publicar v√≠deos toda segunda (sem garantias, mas √© o objetivo, inclusive essa **pr√≥xima segunda tem v√≠deo novo** üòç ), minha sugest√£o √© o seguinte:

1. Reduzir o tamanho dessa milestone para conseguirmos come√ßar e concluir ela mais r√°pido.
2. Mover o escopo de CRUD de Not√≠cias e a listagem delas para a pr√≥xima Milestone.
3. Deixar na Milestone 2 o foco na Autoriza√ß√£o, Autentica√ß√£o e Usu√°rios.

### Ent√£o o que era antes:

- Milestone 2: Auth, Usu√°rios e Not√≠cias
- Milestone 3: Coment√°rios e Status

### Vai ficar:

- Milestone 2: Auth e Usu√°rios
- Milestone 3: Not√≠cias e Coment√°rios

### Live de abertura
Se tudo der certo, com isso vamos conseguir ter um v√≠deo editado na segunda, e a live de abertura da Milestone 2 nessa sexta-feira. E vai ser bom reduzir o escopo da Milestone 2, pois nas lives poderemos ter mais tempo para discutir sobre Autentica√ß√£o e Autoriza√ß√£o üëç

>> Coment√°rio de filipedeschamps:
Para encerrar essa issue, tentei fazer live, mas o YouTube estava com bug e n√£o notificou ningu√©m :( aqui est√° o link da live falida üòÇ https://youtu.be/0OVy0WxMj90

Em paralelo e seguindo o que foi proposto nessa issue de dar mais peso para v√≠deos, vai ter um v√≠deo novo nessa segunda-feira, o tema vai ser sobre iniciantes e segue a thumbnail:

![sentado-escuro_1 6 1](https://user-images.githubusercontent.com/4248081/130264294-427b76c9-e714-4c9e-a34f-c8e7afec329e.jpg)

>> Coment√°rio de rodrigoKulb:
> Em paralelo e seguindo o que foi proposto nessa issue de dar mais peso para v√≠deos, vai ter um v√≠deo novo nessa segunda-feira, o tema vai ser sobre iniciantes e segue a thumbnail:

Ficou animal essa thumb, realmente n√£o notificou!! :(
</issue_99_Aviso importante sobre a Milestone 2 ü§ù>

<issue_102_Endpoint para consultar status do sistema>
### Descri√ß√£o
Como respons√°vel pelo `SRE` do site, eu gostaria de ter dispon√≠vel um endpoint `/status` que ao ser feito um `GET` retorna a sa√∫de do sistema e dos servi√ßos dependentes, em formato `JSON`.

### Execu√ß√£o
Eu tentei procurar se existe algum padr√£o de retorno em APIs REST, e n√£o encontrei nada, meio que cada um implementa da forma que quiser. O que achei de padr√£o foram endpoints para gerenciar a sa√∫de e readiness num contexto Kubernetes, mas da√≠ meio que acaba tendo uma fun√ß√£o que vai mais pro lado de gerenciar o cluster (e tamb√©m pra mensurar a sa√∫de). Talvez o que seria mais interessante √© pesquisar se existe padr√µes no contexto de microsservi√ßos, procurei aqui e n√£o achei muita coisa.

De qualquer forma, o que sugiro √© implementarmos o endpoint `/api/v1/status` (ou `/health` confira ali em baixo) e o retorno pode depender de como o servi√ßo de monitoria que utilizarmos funciona (se ele vai conseguir interpretar um JSON). 

Por exemplo podemos retornar `200 OK` se tudo estiver saud√°vel e `503 Service Unavailable` se algum servi√ßo n√£o estiver saud√°vel, como por exemplo o banco de dados que √© a √∫nica depend√™ncia atual do site.

```js
{
    "updated_at": "2021-08-13T18:36:35.138Z",
    "dependencies": {
        "database": {
            "status": "healthy",        // "healthy", "degraded", "unhealthy"
            "opened_connections": 30
        }
    }
}
```

Ou at√© podemos retornar `200` mesmo com uma depend√™ncia n√£o saud√°vel, dado que o endpoint fez com sucesso o que deveria fazer. E deixa o `5xx` se der algum problema inesperado na consulta. O que acham? Novamente, vai depender de como as ferramentas de monitoria conseguem interpretar o cabe√ßalho ou objeto retornado.

### Status ou Health?
Me pergunto isso, porque seria interessante mais para frente ter um endpoint que retorna as **estat√≠sticas** do site, por exemplo, quantidade de cadastros, views, etc... me preocupo do nome desse endpoint ser muito parecido com "status"). Ent√£o por isso penso que talvez o nome do endpoint que retorna a `sa√∫de` dos sistemas deva ser `/health`. Por outro lado, √© comum se usar a nomenclatura "status page" para procurar a p√°gina de status de um servi√ßo. Inclusive o subdom√≠nio de muitos servi√ßos √© `status.dominio.com`.

Algu√©m tem alguma opini√£o?

### Servi√ßos de monitoria
Esbarrei faz pouco tempo atr√°s com esse https://updown.io/ e achei bem barato.

Algu√©m tem sugest√µes sobre que tipo de servi√ßo usar para monitoramento?

### Depend√™ncia
Existe a issue #96 que poderia ser executada antes, mas essa aqui pode ser executada em paralelo sem problemas, porque a √∫nica coisa que daria conflito seria no `package.json`.

Agora o que realmente tem de depend√™ncia √© o PR #98 do @brunofamiliar , nada muito grave, pois s√≥ vai alterar a interface do m√≥dulo do banco de factory para singleton.

>> Coment√°rio de eduprog:
@filipedeschamps  pelo que coloquei testando aqui o https://uptimerobot.com/ √© totalmente free se quiser o b√°sico.  Achei interessante, apesar de n√£o dar para mudar muito a p√°gina de monitoramento com os temas e tudo mais, nem usar um dom√≠nio pr√≥prio a n√£o ser no pro. Mas achei bem legal. 

A esquerda a p√°gina de monitoramento que pode ter v√°rios servi√ßos

A direita a p√°gina de dashboard dentro do site da UptimeRobot.

PS: Criei apenas um endpoint get retornando um ok. Em uma api aqui para poder testar e deixei ativo, bem interessante, segue o [link p√∫blico da p√°gina da esquerda](https://stats.uptimerobot.com/1pD54CpQwk).  

![image](https://user-images.githubusercontent.com/3284954/129425637-17922ee6-51c3-4a34-a88d-f47001c18072.png)

>> Coment√°rio de tcarreira:
O termo status √© health (ou healthcheck) costuma ser usado como sin√≥nimo.
A minha prefer√™ncia pessoal √© status (o termo healthcheck me soa demasiado direto a sa√∫de do site) 


E como sugeriu o @eduprog, a maioria dos servi√ßos de monitora√ß√£o levam em conta o status code da resposta. Ou seja, 50x se queremos ter um "alarme", 20x se est√° tudo bem. 

Por outro lado, se vc quer obter estat√≠sticas, isso significa m√©tricas, o que normalmente √© no endpoint /metrics
Tem o padr√£o de prometheus que √© muito usado e liga bem com o grafana para dashboards, mas isso √© outra issue.

>> Coment√°rio de rhandrade:
Eu prefiro o termo status tamb√©m seguindo a mesmo linha de pensamento do @tcarreira.

Para servi√ßos de monitoramento, na empresa que trabalho j√° usamos o https://www.pingdom.com e funcionava muito bem para as nossas necessidades de monitorar alguns sites complexos de clientes.

Sobre ferramentas para p√°gina de status, n√£o conhecia a uptimerobot que o @eduprog mencionou, mas j√° vi v√°rios sites usando a Status Page da Atlassian e acho ele bem legal tamb√©m.

Segue imagem do [Reddit](https://www.redditstatus.com/)
![image](https://user-images.githubusercontent.com/4511733/130304996-c130c331-4b8b-4aeb-83c5-4052b3b0e26e.png)

>> Coment√°rio de liverday:
A combina√ß√£o de Grafana + Prometheus √© extremamente poderosa! S√£o Open Source e tem in√∫meras funcionalidades para conseguirmos ter um bom ambiente de monitoramento do TN.

Mas pensando numa pequena entrega, criei um PR https://github.com/filipedeschamps/tabnews.com.br/pull/130 com o endpoint `/status` criado. Se tiverem alguma sugest√£o ou tiverem algo pra adicionar ou retirar nele, fico a disposi√ß√£o.

>> Coment√°rio de filipedeschamps:
Pessoal, endpoint est√° criado e em produ√ß√£o: https://www.tabnews.com.br/api/v1/status

No PR #137 apontei um detalhe para isolarmos o escopo do n√∫mero de conex√µes do banco. Com isso feito, podemos fechar essa issue, pois o restante do trabalho vai ser ir adaptando o endpoint para entender se ele consegue ser usado pelos servi√ßos de health check üëç

>> Coment√°rio de liverday:
@filipedeschamps aproveitei que estava em casa e fiz a mudan√ßa: https://github.com/filipedeschamps/tabnews.com.br/pull/138

>> Coment√°rio de filipedeschamps:
Estamos bem avan√ßados nessa Milestone ü§ù 

![image](https://user-images.githubusercontent.com/4248081/147595844-4f91499c-d0f4-4cd8-af4f-9d94af55c4df.png)
</issue_102_Endpoint para consultar status do sistema>

<issue_105_CRUD de Usu√°rios (Sem Autentica√ß√£o)>
### Descri√ß√£o
Como desenvolvedor do site (ou usu√°rio avan√ßado), atrav√©s de um endpoint na API eu gostaria de poder criar, ler, atualizar ou deletar usu√°rios, sem inicialmente precisar de autoriza√ß√£o, autentica√ß√£o e nem confirma√ß√£o por email.

### Execu√ß√£o
Sugiro come√ßarmos da forma mais simples poss√≠vel, que √© fazer todos o CRUD do usu√°rio e isso envolve:
- Rotas
- Controllers
- Model
- Migration / Tabela no Banco
- Testes (incluindo uma nova fun√ß√£o no orquestrador para deixar o banco num estado zerado, mas com as migrations rodadas)

E o objeto sugiro que seja o mais simples poss√≠vel, sem especularmos campos, s√≥ o necess√°rio para o que est√° dentro dessa Milestone, que acredito ser:
- id
- username (√∫nico dado p√∫blico)
- password
- email

[edit]
- features / credentials (algo relacionado √†s habilidades dele no site)
- status
- created_at
- updated_at

Se n√£o for isso, me avisem üëç 

### Depend√™ncia
Seria bom ter resolvido essas tr√™s issues:
- #92 
- #96 
- #97 

### Pr√≥ximo passo
Depois iremos engatar isso no sistema de autentica√ß√£o e autoriza√ß√£o para, por exemplo, somente o pr√≥prio usu√°rio poder ler ou alterar seus dados, ou algum outro usu√°rio admin que tenha a permiss√£o para fazer isso.

>> Coment√°rio de huogerac:
Talvez 2 campos adicionais: avatar e created_at

```
class User(db.Model):

    __tablename__ = "users"

    id = sa.Column(sa.Integer, primary_key=True, autoincrement=True)
    name = sa.Column(sa.String(128), nullable=False)
    email = sa.Column(sa.String(255), nullable=True, unique=True)
    password = sa.Column(sa.String(128), nullable=True)
    avatar = sa.Column(sa.UnicodeText(), nullable=True)
    created_at = sa.Column(
        sa.DateTime(timezone=True), default=lambda: datetime.now(timezone.utc)
    )
```

>> Coment√°rio de brunofamiliar:
Acredito que poderia ter um interface com algumas propriedades que poderia se repetir entre as outras classes futuras, como por exemplo o id, created_at e acredito que √© interessante ter um updated_at tamb√©m para controlar a √∫ltima atualiza√ß√£o de registro daquela model

>> Coment√°rio de joaobracaioli:
√â interessante ter um campo booleano active, outro ponto que experiencias passadas √© ter um campo de language e timezone mesmo que principio usamos um valor padr√£o, mas facilita bastante no futuro problemas com timezone e internacionaliza√ß√£o, ent√£o minha sugest√£o seria:

- id
- username (√∫nico dado p√∫blico)
- name
- password ( n√£o gosto muito de pessword junto na mesma tabela de users, mas ok)
- email
- avatar
- language
- timezone
- created_at
- updated_at

>> Coment√°rio de rodrigoKulb:
Algu√©m sabe como ficar√° a migration para criar a tabela usu√°rios?

Queria iniciar mas fiquei um pouco confuso com a estrutura correta, com ela criada podemos iniciar as brincadeiras com o CRUD.

>> Coment√°rio de rodrigoKulb:
Criei um PR #118 **Update: Script para pg-migrate dentro da pasta**  como sugest√£o de padronizar e facilitar a cria√ß√£o de migrate.

>> Coment√°rio de filipedeschamps:
Dando um ping aqui tamb√©m, seguindo o trabalho do @rodrigoKulb no PR #118 eu criei o PR #127 üëç 

E @joaobracaioli fiquei curioso sobre o seu coment√°rio da senha n√£o estar na mesma tabela de users. Se poss√≠vel, voc√™ poderia expandir um pouco mais essa ideia? ü§ù

>> Coment√°rio de rodrigoKulb:
Fala galera, como voc√™s est√£o por ai?
Uma d√∫vida que fiquei com o CRUD do usu√°rio, vamos criar uma pasta "contexts" ? 
Principalmente para a parte da autentica√ß√£o
Vamos utilizar a Context API do Next?
abs.

Edit: Agora que verifiquei que vamos fazer (Sem Autentica√ß√£o) no in√≠cio. üòÖÔ∏è

>> Coment√°rio de rodrigoKulb:
Fala pessoal para n√£o deixar o projeto parado, resolvi tentar iniciar o CRUD de usu√°rios, acredito que pode servir como base para o desenvolvimento do CRUD final. #133 

**Ajustes necess√°rios:**
- [x] Valida√ß√£o dos campos obrigat√≥rios.
- [x] Criptografia da senha. (finalizado pois utilizaremos passwordless)
- [x] Adicionar uma valida√ß√£o de e-mail.
- [x] Verificar todos os custom erros necess√°rios.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb h√° dois itens em aberto ali na sua lista, mas n√£o ser√£o mais necess√°rios dado a conversa de passwordless que tivemos no √∫ltimo PR. Na verdade a valida√ß√£o do email ainda continua, mas n√£o faz mais parte do fluxo do usu√°rio, e sim somente da autentica√ß√£o (pelo que eu especulo).

Ent√£o vou dar como conclu√≠da essa issue aqui e novamente avan√ßamos mais um pouco na Milestone üòç  foi maravilhoso implementar o model na m√£o, sem ORM.

Para o fluxo de autentica√ß√£o passwordless a gente vai ter que remover algumas coisas que foram programadas (e que esperavam por uma senha), mas √© isso a√≠, vamos refatorando ü§ù üëç

>> Coment√°rio de rodrigoKulb:
> @rodrigoKulb h√° dois itens em aberto ali na sua lista, mas n√£o ser√£o mais necess√°rios dado a conversa de passwordless que tivemos no √∫ltimo PR. Na verdade a valida√ß√£o do email ainda continua, mas n√£o faz mais parte do fluxo do usu√°rio, e sim somente da autentica√ß√£o (pelo que eu especulo).

Show, sobre a **valida√ß√£o** e-mail foi feita utilizando o Joi, era sobre ser um e-mail v√°lido com @ etc...
Vamos em frente!

>> Coment√°rio de filipedeschamps:
Ahh show!! Pensei que era a valida√ß√£o de email existente, do tipo receber email na caixa de entrada e clicar no link de ativa√ß√£o üòÇ üëç
</issue_105_CRUD de Usu√°rios (Sem Autentica√ß√£o)>

<issue_106_Sistema de Autentica√ß√£o>
### Descri√ß√£o
Eu como usu√°rio avan√ßado do site, atrav√©s de uma API eu gostaria de poder usar os dados de acesso do meu usu√°rio (username/email e password) para me autenticar no sistema, criar uma sess√£o ativa e a resposta desta requisi√ß√£o marcar nos cookies o token da sess√£o.

### Execu√ß√£o
A execu√ß√£o n√£o deve fugir muito de:

- Rotas
- Controllers
- Model
- Migration / Tabela no Banco
- Testes

Sugiro seguirmos o modelo cl√°ssico de autentica√ß√£o com cookies, e de in√≠cio armazenar as sess√µes no Postgres (o que n√£o √© recomendado, mas como discutimos em live, vamos testar o limite antes de adicionar um outro servi√ßo como Redis).

### Sugiro n√£o usarmos JWT
Eu sugiro n√£o utilizarmos JWT, pois vejo que um dos principais motivos de se usar essa tecnologia √© ter um sistema de autentica√ß√£o sem a necessidade de uma m√°quina de estado (um backend que de forma persistente guarda as sess√µes), porque isso de fato tem v√°rias vantagens, principalmente na escalabilidade (por n√£o ter o gargalo da persist√™ncia que √© dif√≠cil de escalar horizontalmente).

E tamb√©m como iremos depender bastante de autoriza√ß√£o, iremos precisar colocar isso no token que vai para o client, e eu n√£o fico confort√°vel com o client poder decidir isso no payload, mesmo que para ter qualquer efeito ele precise quebrar a assinatura (o que hoje √© algo ainda impratic√°vel caso seja usado uma chave forte, mas procure por `brute forcing jwt token`).

Outro ponto que vejo um pouco de confus√£o ao usar essa tecnologia √© na hora de precisar invalidar/banir manualmente algum token em espec√≠fico, que sem a m√°quina de estado fica impratic√°vel, e com isso as pessoas come√ßam a usar m√°quina de estado junto com JWT. Acho isso muito estranho, pois voc√™ est√° usando uma tecnologia projetada para n√£o ter estado no backend (e assim conseguir facilidade de implementa√ß√£o e escalabilidade) e no final adiciona estado. √â confuso, pois na minha vis√£o fica muito mais limpo voc√™ decidir ou ir para o modelo full JWT sem estado, ou full tradicional com estado e cookies... ou eu to enganado?

Por favor, qualquer discuss√£o nesse ponto √© **super bem vinda**, principalmente pelo fato de nunca ter implementado autentica√ß√£o JWT, apenas estudei a respeito e fiquei **muito frustrado** com esses pontos.

### Depend√™ncia
- #105

>> Coment√°rio de huogerac:
Legal, vou olhar com mais calma os seus pontos contra o uso do JWT! 
Se voc√™ entende que ser√° mais simples ir sem JWT agora, acho interessante! A implementa√ß√£o mais simples de inicio √© um ponto bem forte!

Sobre o banir, concordo que √© um ponto fraco sim, mas tem op√ß√µes bem faceis para resolver:
- o mecanismo pra isto √© o refresh_token, mas se vc entregar um token tem uma expira√ß√£o curta (10 ou 30min), vai ficar batendo na API o tempo todo para pegar outro token...
- outra sa√≠da interessante √© continuar com um token longo, e os endpoints sens√≠veis (como inserir tabnews), fazer uma consulta no banco para ver se o usu√°rio est√° ativo antes de inserir uma tabnews...a vantagem com isto √© que no geral no login usu√°rios ganham um token com dias ou semanas de expira√ß√£o e apenas alguns endpoint precisam fazer select na base usu√°rio para ver se √© ativo...

Enfim, talvez nem precisa ficar descutindo isto! Bora sem JWT, eu entendo que √© uma tabela de sess√£o no backend e cookies no frontend. Se alguem sabe algo diferente disto! queria saber tambem.
Valeu

>> Coment√°rio de rodrigoKulb:
No meu entendimento. Se a API n√£o for ficar dispon√≠vel para utiliza√ß√£o externa, exemplo outros servidores utilizar o backend, podemos seguir sem JWT, pois a session (cookies) precisa de um browser para armazenar.

Achei esse v√≠deo bem simples com a explica√ß√£o: https://www.youtube.com/watch?v=UBUNrFtufWo

>> Coment√°rio de joaobracaioli:
O uso do JWT √© interessante quando voc√™ tem a necessidade de trafegar informa√ß√µes junto com a autoriza√ß√£o, como identificador do usu√°rio, email, roles ou algo desse tipo, assim evita term que bater novamente em algum servi√ßo para recuperar essas informa√ß√µes. Mas acredito que a principio o melhor caminho seja mesmo ir sem o JWT, se n√£o tem essa necessidade.

Eu sugiro fazer um teste integrando com o keycloak se quiser "externalizar" essa atribui√ß√£o de autoriza√ß√£o e n√£o ter que perder muito tempo com isso. 

Um ponto de seguran√ßa seria j√° pensar em deixar o Cookie de credencial httponly.

>> Coment√°rio de flanunes:
Estou trabalhando em um projeto na empresa para a implementa√ß√£o do JWT em uma API bem cr√≠tica. 

Cogitamos utilizar OAuth2, mas, no nosso caso, por quest√£o de simplicidade na implementa√ß√£o e desempenho, acabamos adotando JWS, que √© a vers√£o "assinada" do JWT.

Antes de tocar a implementa√ß√£o do projeto me deparei com esse [artigo](https://research.securitum.com/jwt-json-web-token-security/). Sugiro dar uma olhada nele, pode ajudar a enterrar de vez a possiblidade de uso do JWT ou n√£o. Confesso que fiquei bem receoso pelos pontos levantados, mas pesamos os pr√≥s e contras e os cuidados a serem tomados na implementa√ß√£o.

Ao efetuar a autentica√ß√£o do usu√°rio devolvemos no payload os recursos que podem ser consumidos e inclusive pode-se adotar um tempo vari√°vel de expira√ß√£o do token a depender da criticidade do recurso ou perfil do usu√°rio. Estamos ainda em testes e por enquanto os resultados t√™m sido bem satisfat√≥rios.

>> Coment√°rio de liverday:
Oi, boa tarde! Primeiramente quero me apresentar, eu mal olhei o projeto e j√° vim correndo nessa discuss√£o delicinha! Por isso, me perdoem caso eu esteja falando besteira ou n√£o tenha me interado melhor no assunto.

Muito legal o artigo @flanunes! Aqui na empresa onde eu trabalho seguimos a ado√ß√£o de um modelo OAuth/JWT utilizando [Keycloak](https://www.keycloak.org/). N√£o vejo necessidade de utilizar o [Keycloak](https://www.keycloak.org/) neste momento, pois mais confundiria a cabe√ßa da gente do que ajudaria, MAS, existe uma t√©cnica muito legal para utilizarmos que resolveria os problemas de acesso que o @filipedeschamps mencionou.

A t√©cnica [Refresh Token](https://www.tutorialspoint.com/oauth2.0/refresh_token.htm), conforme o @huogerac falou, resolve esse problema! A vantagem √© que nessa estrat√©gia talvez nem precisaremos armazenar os tokens em um banco de dados/redis mantendo o principio stateless na nossa autentica√ß√£o.

Refresh Token + JWS j√° resolve a maioria dos problemas que poderiamos ter com uma autentica√ß√£o stateless.

Fiz um desenho no [Excalidraw](https://excalidraw.com/) para ilustrar melhor esse fluxo:

![Refresh Token Excalidraw](https://user-images.githubusercontent.com/9805744/133298469-4a6708d7-a15e-4de2-8eaf-66f760d8881f.png)

Dessa forma, a valida√ß√£o para saber se o usu√°rio ainda √© apto para utilizar o sistema acontecer√° a cada 5 minutos, toda vez que um novo Access Token for requisitado.

No pior dos casos, caso o @filipedeschamps queira banir algu√©m, esse algu√©m s√≥ ter√° seu acesso "liberado" pelos pr√≥ximos 5 minutos.

>> Coment√°rio de gabrielgmrs:
E a√≠, pessoal! Nessa thread tenho mais a aprender do que colaborar, mas perguntinha: consideramos um identity manager externo como o AWS Cognito ou Auth0? Alguns benef√≠cios: o Cognito fica gratuito para at√© 50.000 usu√°rios ativos mensalmente, ambos contam com login passwordless out-of-the-box, ambos tem op√ß√£o de OTP (one-time password) via SMS, logins sociais, integram com facilidade via next-auth e por a√≠ vai...

At√© onde vejo os 2 grandes argumentos para esse tipo de op√ß√£o s√£o:
- Menor complexidade para os engenheiros
- Seguran√ßa maior contra ataques

Imagino que n√£o seja uma op√ß√£o para empresas maiores, mas achei que seria algo legal de considerar pro TN. üòÉ

>> Coment√°rio de liverday:
> E a√≠, pessoal! Nessa thread tenho mais a aprender do que colaborar, mas perguntinha: consideramos um identity manager externo como o AWS Cognito ou Auth0? Alguns benef√≠cios: o Cognito fica gratuito para at√© 50.000 usu√°rios ativos mensalmente, ambos contam com login passwordless out-of-the-box, ambos tem op√ß√£o de OTP (one-time password) via SMS, logins sociais, integram com facilidade via next-auth e por a√≠ vai...
> 
> At√© onde vejo os 2 grandes argumentos para esse tipo de op√ß√£o s√£o:
> 
> * Menor complexidade para os engenheiros
> * Seguran√ßa maior contra ataques
> 
> Imagino que n√£o seja uma op√ß√£o para empresas maiores, mas achei que seria algo legal de considerar pro TN.

Eu gosto da id√©ia de ter um ferramental, mas teriamos que adotar a ideia de jogar todos os usu√°rios para o banco de dados dispon√≠vel por essa ferramenta. Se n√£o for um problema ter que replicar os dados dos usu√°rios na ferramenta, tamb√©m √© uma boa id√©ia.

>> Coment√°rio de francopan:
>  jogar todos os usu√°rios para o banco de dados dispon√≠vel por essa ferramenta

At√© onde eu saiba o Auth0 permite voc√™ usar sua pr√≥pria base de dados. O problema mesmo √© o custo. De quem sai o dinheiro? Se o @filipedeschamps vai investir ou criar um catarse √≥timo. 
Outro problema √© tornar-se ref√©m de uma ferramenta desse tipo. Ou seja, para isso n√£o ocorrer ainda seria necess√°rio criar uma estrtura que possa ser adaptada para outras ferramentas de maneira simples, caso seja necess√°ria a mudan√ßa.

>> Coment√°rio de gabrielgmrs:
@francopan Sim, Auth0 √© relativamente caro (depois dos 7k ativos/m√™s). Recomendo a pesquisada no Cognito, que √© free at√© 50k/m√™s, e depois disso cobra uma fra√ß√£o bem pequena de d√≥lar pelos seguintes (n√£o passa a cobrar os primeiros 50k). Nesse ponto certamente o projeto j√° vai ter um modelo de monetiza√ß√£o e o custo √© razo√°vel.

Sobre vendor lock-in, √© uma decis√£o, de fato. Hoje eu tenho mais confian√ßa na estabilidade em m√©dio/longo prazo de um AWS, por exemplo, mas √© um bom ponto a ser considerado üëç

>> Coment√°rio de rodrigoKulb:
Seguindo a ideia do @filipedeschamps √© criar o MVP, sentir e identificar poss√≠veis problemas, para evoluir com aprendizado.

Minha sugest√£o √© iniciar com uma simples session, avaliar os riscos e poss√≠veis falhas para ir evoluindo.

O que voc√™s acham?

>> Coment√°rio de wcarugatti:
O problema de se utilizar AWS Cognito √© o vendor locking. Al√©m disso o pre√ßo dele depois de 50 mil usu√°rios me parece caro comparado a uma solu√ß√£o pr√≥pria.

>> Coment√°rio de rhandrade:
√ìtima discuss√£o pessoal üëè 
Concordo com o @rodrigoKulb que seria legal iniciarmos com algo bem simples e ir validando a necessidade, at√© chegar no dia que nossa aplica√ß√£o n√£o estiver aguentando e ai abrimos uma live com o @filipedeschamps para avaliarmos o que da pra ser feito, como ele mesmo j√° comentou.

>> Coment√°rio de rodrigoKulb:
Voltando a conversar sobre esse assunto, verifiquei no di√°rio que o @filipedeschamps levantou a problem√°tica sobre utilizar o "passwordless" devido ao problema de perder acesso ao e-mail o usu√°rio ficaria sem acesso ao portal.

Vejo que temos 3 op√ß√µes de autentica√ß√£o:

**01 - Passwordless**
Beneficio: N√£o teremos nenhuma informa√ß√£o de seguran√ßa armazenada no nosso banco da dados.
Problema: Se o usu√°rio perder o acesso ao e-mail o processo de recupera√ß√£o dever√° ser manual.

**02 - API de auth**
Beneficio: Toda seguran√ßa dos dados fica por parte da API, mesmo se o usu√°rio perder o acesso no e-mail o provedor j√° possui sistemas para recupera√ß√£o das informa√ß√µes.
Problema: Nem todos possuem uma conta no Google, Facebook ou Github.

**03 - Senha dentro do TabNews**
Beneficio: Teremos total controle na recupera√ß√£o da senha e possivel altera√ß√£o na conta de e-mai.
Problema: Seguran√ßa de dados sens√≠veis ser√° total responsabilidade dos desenvolvedores do tabnews 

Gostaria saber de voc√™s o que acham e se existe mais alguma alternativa para ser analisada?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb eu vejo essas alternativas mesmo ü§ù 

Em paralelo, a discuss√£o nessa issue aqui est√° fant√°stica e √© um recurso educacional da vida real que eu n√£o vejo a hora de deixar tudo p√∫blico üòç 

Bom, comecei a implementar a parte da infraestrutura bruta que manda os emails e que pode ser compartilhada pelas duas estrat√©gias (password tradicional ou passwordless). Assim que conseguir voltar com mais tempo para o computador fa√ßo o PR junto com o di√°rio de desenvolvimento e parto para as outras camadas da autentica√ß√£o e sess√£o ü§ù

>> Coment√°rio de rodrigoKulb:
Exemplo de autentica√ß√£o na Decolar, eles utilizam as 2 op√ß√µes:
01 - Passwordless
02 - API de auth
![Captura de tela em 2022-01-27 10-00-34](https://user-images.githubusercontent.com/5334261/151363923-b6440aaa-521e-4a27-9d7d-7122548c154d.png)

>> Coment√°rio de filipedeschamps:
Turma, j√° podemos fechar essa issue, faltando apenas a issue de **Autoriza√ß√£o** #107  (e pra fechar essa eu vou propor um desafio no v√≠deo tutorial que vou gravar).

Mas apesar do escopo dessa issue aqui ter sido conclu√≠do, o assunto **Autentica√ß√£o** n√£o terminou e est√° continuando na issue #171 

Um dos t√≥picos l√° √© trocar autentica√ß√£o do `username` por `email`. Quem quiser participar √© super bem vindo ü§ù 

Em paralelo, issue closed! Let's gooooo üòç
</issue_106_Sistema de Autentica√ß√£o>

<issue_107_Sistema de Autoriza√ß√£o>
### Descri√ß√£o
Eu como desenvolvedor do sistema, gostaria de poder ter um sistema de autoriza√ß√£o que controlasse o acesso aos recursos. O sistema n√£o deveria ser `Role-based Access Control (RBAC)` e sim ser `Resource-based Access Control`. Ent√£o ao inv√©s de um usu√°rio ter o papel (role) de `admin` ou `moderator` que agrega uma variedade de permiss√µes, no caso de controle de acesso por **recurso** o usu√°rio possui um controle muito mais refinado, por exemplo, qualquer usu√°rio pode receber a permiss√£o para `rodar as migrations`, ou `deletar posts`, `fazer upload de imagens`, `criar an√∫ncios` ou o que seja de funcionalidade no sistema.

### Execu√ß√£o
A evolu√ß√£o de um usu√°rio dentro do TabNews (no quesito de o que ele pode fazer) vai se basear muito em dois pilares: **A√ß√µes** e **Recursos**. Inicialmente um usu√°rio vai poder apenas **criar coment√°rios**, por exemplo. Depois de um tempo, ele vai poder **criar not√≠cias na home**, e depois **criar coment√°rios usando formata√ß√£o em markdown**, depois **enviar imagens**... ou o que seja. Tudo isso √© uma combina√ß√£o de **a√ß√£o** contra um **recurso**. Voc√™ pode ler mais sobre isso nesse artigo: [The New RBAC: Resource-Based Access Control](https://stormpath.com/blog/new-rbac-resource-based-access-control). Tem um outro tipo de m√©todo que √© `Attribute Based Access Control (ABAC)`, que parece ser bem standard, assim como o RBAC, mas traz uma granularidade ainda maior, s√≥ que eu acho desnecess√°rio para o nosso contexto. De qualquer forma, **como sempre**, tudo est√° aberto a discuss√£o ü§ù 

Sobre a implementa√ß√£o de fato, n√£o vou me prolongar aqui porque s√≥ vou conseguir visualizar algo concreto implementando, mas a primeira dire√ß√£o que vou tomar para testar deve ir nessa linha:

```js
// s√≥ um rabisco de uma rota da API

import routes from "next-connect";
import authentication from "models/authentication.js";
import authorization from "models/authorization.js";

export default routes()
  .use(authentication())
  .use((req, res) => {
    const user = req.user;
    const resource = req.query.resource;
    const action = req.method;

    if (!authorization.can(user, action, resource) {
      throw new Error('Acesso negado');
    }
  })
```

Esse rascunho ta bem bagun√ßado, middleware dentro de models, o nome das coisas de forma estranha, mas independente disso, como falei preciso por a m√£o no c√≥digo para visualizar melhor as *moving parts* envolvidas üëç 

No mais, altera√ß√µes em:

- Model de Autoriza√ß√£o
- Modificar Controllers que precisam de autoriza√ß√£o
- Modificar User para ter um array de permiss√µes
- Testes

### Depend√™ncia
- #106

>> Coment√°rio de huogerac:
@filipedeschamps enviei um exemplo rodando para voc√™ dar uma olhada, mesmo tem uma stack bem diferente...talvez tenha algo √∫til!
Para n√£o deixar o projeto sair do trilho, deixei privado, se e somente se voc√™ ver algo √∫til ou possa agregar para o andamento do tabnews. Enfim se puder ver: https://github.com/huogerac/tabnews-web/invitations
Valeu

>> Coment√°rio de filipedeschamps:
@huogerac nossa eu s√≥ vi essa resposta agora que voltei na issue para comentar algo :/  cliquei no invite mas ele expirou, se ainda estiver dispon√≠vel gostaria total de dar uma olhada ü§ù

>> Coment√°rio de filipedeschamps:
Estou precisando de ajuda na parte de Autoriza√ß√£o, pois n√£o consegui ainda pensar em uma abstra√ß√£o que fa√ßa duas coisas (na verdade n√£o sei se ela deveria fazer duas coisas, mas elas est√£o interligadas). Essas duas coisas s√£o:

1. Entender se o usu√°rio tem permiss√£o/feature para uma a√ß√£o em um objeto (ou propriedade de um objeto)
2. Retornar propriedades conforme n√≠vel de acesso/feature

## Sobre o Ponto 1
Implementar isso sem estar abstra√≠do num componente n√£o √© muito complicado, at√© colocando dentro de um componente n√£o √© complicado, mas n√£o consegui fazer de uma forma que fique sofisticada, principalmente tentando juntar com o Ponto 2.

## Sobre o Ponto 2
Por exemplo: um usu√°rio pode pedir para ver seu objeto de perfil e com isso retornar o seu pr√≥prio email (ele pode ver seu pr√≥prio email). Agora um outro usu√°rio pedindo o mesmo objeto pode ver as informa√ß√µes menos o email.

## Abstra√ß√£o

As √∫nicas solu√ß√µes que eu encontrei ou implementavam com arquivos de configura√ß√£o muito bizonhos, ou era tudo espalhado no controller. Ent√£o n√£o d√° para fazer algo t√£o simples quanto:

```js
...
  .use(authorizationHandler)
  .get(getHandler)
  .post(postHandler);
```

Primeiro porque a Autoriza√ß√£o n√£o vai ser compartilhada entre o POST e GET, fora que muitas vezes voc√™ precisa do objeto retornado dentro do `getHandler` para tomar alguma decis√£o (por exemplo ver se o objeto de usu√°rio que est√° sendo requisitado √© do usu√°rio autenticado), mas da√≠ j√° passou da camada de Autoriza√ß√£o.

Eu vou continuar rabiscando aqui sem ter abstra√≠do o c√≥digo para entender se consigo visualizar as abstra√ß√µes certas. Mas qualquer sugest√£o ou experi√™ncia nisso √© super bem vinda ü§ù

>> Coment√°rio de rodrigoKulb:
Realmente a autoriza√ß√£o √© total regra de neg√≥cio, se for pensar em Orienta√ß√£o Objeto a responsabilidade fica com a class Usu√°rio de controle de quem tem acesso.

Podemos criar categorias de usu√°rios exemplo:
- Administrador (ver todos usu√°rios e editar)
- Membro ( editar somente os pr√≥prios dados)

E dentro de cada categoria definir as permiss√µes.

Achei esse v√≠deo da Dani que fala exatamente a estrutura de permiss√£o e regra, achei bem completo:
https://www.youtube.com/watch?v=TGCwB9oMR0o 


Basicamente precisamos criar 2 tabelas :
- Permission 
- Role

>> Coment√°rio de filipedeschamps:
√önico problema de autoriza√ß√£o baseada em Role na minha opini√£o √© que voc√™ espera que um usu√°rio n√£o tenha dois Roles simult√¢neos no sistema. Ent√£o isso dificulta um pouco a parte de *features* do site, de por exemplo:
1. Inicialmente usu√°rio pode comentar (mas n√£o pode criar posts).
2. Depois tamb√©m ganha permiss√£o de criar posts.
3. Depois tamb√©m ganha permiss√£o de fazer upload de imagens.
4. Etc...

E assim vai indo para qualquer outra feature, por exemplo, dar permiss√£o de um usu√°rio que contribui aqui no c√≥digo do TabNews para ele poder rodar as migrations, mas sem ser Admin, e isso tamb√©m n√£o interferir no acesso a outras features.

Mas de qualquer forma sensacional a sugest√£o do v√≠deo @rodrigoKulb e vou ver com certeza üëç üëç üëç

>> Coment√°rio de tcarreira:
S√≥ deixando um coment√°rio, que eu acho que vc tem presente, mas talvez n√£o seja √≥bvio para os outros.

Mesmo que a utiliza√ß√£o do sistema seja adicionando "roles" e dando umas permiss√µes mais granulares para "resources", para que isso funcione bem, temos de abstrair esse conceito em "actions" e "resources".
Ou seja, vc pode continuar pensando em Administradores e Membros, mas tendo uma implementa√ß√£o de RBAC pura.

((ainda) n√£o sei como fazer bonito üòÖ )

>> Coment√°rio de tcarreira:
E j√° agora, para eu que n√£o entendo assim tanto de JS, qual √© a limita√ß√£o de usar este pacote? https://www.npmjs.com/package/rbac

>> Coment√°rio de huogerac:
> @huogerac nossa eu s√≥ vi essa resposta agora que voltei na issue para comentar algo :/ cliquei no invite mas ele expirou, se ainda estiver dispon√≠vel gostaria total de dar uma olhada handshake

Hey @filipedeschamps 
Nossa! achei que tinha ignorado total (o que n√£o tinha problema dado a solu√ß√£o que estava mostrando...hehehe)
Bom, vou precisar subir tudo novamente e te passo um novo link/invite! Deixei privado, pq o tabnews √© privado e queria respeitar isto!

>> Coment√°rio de huogerac:
Hey @filipedeschamps, 
fiz o invite novamente: https://github.com/huogerac/tabnews-web/invitations
e coloquei no ar a authenticacao utilizando o OAUTH do Github, ou seja, quais seriam as vantagens/desvantagem da versao incial utilizar apenas o login via Github? nao teriamos que ficar lidando com envio de email, reset de senha etc....
E claro, alguem sem Github nao conseguiria criar conta, mas para a versao inicial, talvez isto nao seria um problema...

- [https://tabnews.vercel.app/](https://tabnews.vercel.app/)
- [https://tabnewsapi.herokuapp.com/api/](https://tabnewsapi.herokuapp.com/api/)

Pessoal, nao deixei o repo publico, principalmente pq o tabnews esta privado e tambem pq ele esta utilizando algumas tecnologias (como JWT) que ja foi decidido nao utilizar (e que faz sentido)...eu so utilizei pq foi mais simples para este POC para validar o Autorizacao via recursos (Resource-Based Access Control)

p.s: As permissoes dentro de um token (pode comentar e criar noticas, mas nao pode usar markdown nem imagens) fica muito legal, a propria camada da API valida isto tudo, mas em teoria podemos ter o melhor dos 2 mundos, ou seja, usar o modelo "mais seguro" via sessoes para autenticar e ter a autorizacao via token tambem, certo? talvez isto seja possivel, nao acham?

p.s.s.: desculpa a falta de acentos.

>> Coment√°rio de ItanuRomero:
Fala pessoal, estou lendo os coment√°rios nessa issue e tenho uma sugest√£o:
√â bem claro que o @filipedeschamps quer evitar roles de usu√°rio, ent√£o pensando em encontrar uma estrutura que permitisse o usu√°rio a ir ranqueando seu n√≠vel de acesso como dito [na se√ß√£o 8 do di√°rio de desenvolvimento](https://github.com/filipedeschamps/tabnews.com.br/wiki/008.-XP), poderia ser poss√≠vel a cria√ß√£o de algo semelhante ao usado no sistema Salesforce, as [Permission Sets](https://help.salesforce.com/s/articleView?id=sf.perm_sets_overview.htm&type=5).

Digamos que um usu√°rio acabou de chegar na plataforma, ele pode ser ranqueado como an√¥nimo, pode ver apenas as not√≠cias mas n√£o os coment√°rios e para subir de ranking ele deve logar no sistema.
A partir desse momento ele pode ver as not√≠cias e os coment√°rios, por exemplo, e a partir de um certo tempo poder√° fazer coment√°rios, criar not√≠cias, e por a√≠ vai.
Seguindo nessa ideia, podemos criar grupos de permiss√µes que acompanham o usu√°rio e v√£o sendo somadas atrav√©s de sua jornada pelo portal, como por exemplo:
An√¥nimo > Leitor > Comentarista > Escritor > Mantenedor > Administrador

Nesse approach o Leitor possui as permiss√µes de an√¥nimo + likes e visualizar coment√°rios, j√° o comentarista possui tudo dos anteriores + poder criar coment√°rios, ou algo nesse modo.

Outro ponto a se considerar: O usu√°rio, independente de seu n√≠vel de permiss√£o, deve estar habilitado a editar e remover apenas conte√∫do pr√≥prio, e remover itens n√£o deveria fazer parte das listas de permiss√£o abaixo de Mantenedores ou Moderadores...

Enfim, o que acham que daria certo e errado nessa abordagem? Isso faz sentido ou n√£o?
√â minha primeira contribui√ß√£o aqui ent√£o se eu estiver falando besteira eu super vou entender os feedbacks :)

>> Coment√°rio de tcarreira:
@ItanuRomero Antes de mais, bem vindo √†s contribui√ß√µes :) 

Eu entendi que o que vc descreveu √© um modelo de roles, em que cada usu√°rio possui um conjunto de permiss√µes. Entendi correto?

Esse modelo funciona bem para estruturas simples, em que existe uma escada clara de roles (existe uma ordem), e o role seguinte tem mais permiss√µes que o anterior.

O problema √© que esse modelo n√£o escala para situa√ß√µes mais complexas.   
Por exemplo, imaginemos que existem dois usu√°rios, ambos com role de Escritor, mas eles n√£o podem escrever em todos os t√≥picos (inventei este requisito, s√≥ para o exemplo): 

- Escritor1 s√≥ pode publicar nos T√≥picos A e B
- Escritor2 s√≥ pode publicar nos T√≥picos B, C e D

Neste tipo de cen√°rios, um esquema de permiss√µes role based n√£o funciona bem (mas h√° montes de gambiarras em cima do modelo, o wordpress tem muitos exemplos), enquanto um esquema RBAC tem isto na base:

- User1: {writer: {TopicA,TopicB}}
- User2: {writer: {TopicB,TopicC,TopicD}}


Faz sentido o exemplo? Ajudou?

>> Coment√°rio de ItanuRomero:
@tcarreira brigad√£o pelas boas vindas!

Quanto ao exemplo, faz todo o sentido, n√£o tenho muita experi√™ncia com RBAC, mas me interessei no assunto!

Vou ficar ligado por aqui e ver se consigo dar uma estudada no tema pra poder ajudar

>> Coment√°rio de rodrigoKulb:
Bom dia pessoal!

Nossa que conversa legal, quando eu falo que esse projeto √© melhor que qualquer 'curso" ningu√©m acredita! üöÄÔ∏è

@ItanuRomero achei sensacional o sistema de permiss√£o em escala An√¥nimo > Leitor > Comentarista > Escritor > Mantenedor > Administrador.  Quem trabalha dessa forma √© o Stack Overflow. Gosto muito dessa linha!

@tcarreira realmente existe a limita√ß√£o de definir permiss√£o por postagem, mas se misturar a hierarquia no exemplo do @ItanuRomero onde somente pessoas com n√≠vel acima pode editar postagens de usu√°rios abaixo dela?

N√£o consigo ver alguma necessidade de definir uma postagem especifica para somente alguns usu√°rios. E como ficaria a gest√£o dessas permiss√µes?

>> Coment√°rio de tcarreira:
> @tcarreira realmente existe a limita√ß√£o de definir permiss√£o por postagem, mas se misturar a hierarquia no exemplo do @ItanuRomero onde somente pessoas com n√≠vel acima pode editar postagens de usu√°rios abaixo dela?

Realmente n√£o √© f√°cil enxergar exemplos quando o projeto ainda est√° t√£o abstrato. 
Mas por exemplo, digamos que vamos ter mantenedores que n√£o podem ser escrever artigos? Como se pode mapear isso apenas com roles, e n√£o ficar uma confus√£o? 

Mas pod√≠amos continuar o projeto s√≥ com roles? Com os requisitos atuais, n√£o vejo problema. 
Ser√° que o melhor caminho √© fazer o mais simples e refatorar no futuro? 

Pessoalmente tendo a querer implementar coisas mais robustas no in√≠cio, mas isso tem um pre√ßo, que √© aumento de complexidade e tempo.

@filipedeschamps vc consegue dar mais contextos concretos de onde um role based n√£o √© suficiente?

>> Coment√°rio de ItanuRomero:
Fala pessoal!

Estudei um pouco sobre o tema, principalmente lendo o artigo que o @filipedeschamps indicou na issue, e pensei numa abordagem que seria a seguinte:

Em vez de roles, adicionar cada uma das permiss√µes no objeto do usu√°rio, pensemos assim, usu√°rio √© criado com um nome e com um objeto permiss√µes vazio:
``` JavaScript
const user = {name: 'doesnt matter', permissions: {}}
```

Esse usu√°rio n√£o possui nenhuma permiss√£o, vamos popular o objeto permissions dele, primeiro criando uma chave de leitura que possui como valor um array vazio:
``` JavaScript
user.permissions.read = []
```

Inicializamos o usu√°rio como novo membro do site, e damos a ele o acesso de *leitura* para *posts*:
``` JavaScript
user.permissions.read.push('posts')
```

Agora, as permiss√µes de leitura do usu√°rio possuem 'posts', show, vamos criar os objetos de **post** e **comments** ent√£o:
``` JavaScript
const post = {title: 'doesnt matter', neededPermission: {read: 'posts'}}
const comment = {title: 'doesnt matter', neededPermission: {read: 'comments'}}
```

Ent√£o, agora para saber se um usu√°rio tem acesso de leitura a um post usaremos:
``` JavaScript
const userPermittedToReadPost = user.permissions.read.includes(post.neededPermission.read)
```
que retorna `true`

E o mesmo para coment√°rios:
``` JavaScript
const userPermittedToReadComment = user.permissions.read.includes(comment.neededPermission.read)
```
que retorna `false`

Agora, o objeto coment√°rio pode ter uma fun√ß√£o que recebe o objeto de usu√°rio e procura se ele possui acesso para leitura, edi√ß√£o ou remo√ß√£o.

Sei que a abordagem acima est√° bem simplificada e que deveria ser muito refatorada, mas quero saber se isso que escrevi acima se aproxima ou se afasta do que queremos fazer aqui, o que acham?

Teoricamente, segue a ideia de que:
- O coment√°rio em si possui a regra de neg√≥cio que define se o usu√°rio pode v√™-lo ou n√£o
- O usu√°rio deve receber novas permiss√µes e isso pode ocorrer com o sistema em produ√ß√£o
- At√© podemos criar um sistema de role, e esses roles s√£o respons√°veis por adicionar as permiss√µes √∫nicas no usu√°rio, mas isso agora n√£o implica em problemas para um usu√°rio com 2 roles de uma s√≥ vez.

Pra finalizar, a implementa√ß√£o do rabisco que o Filipe colocou acima (`if (!authorization.can(user, action, resource)`) ficaria assim:
``` JavaScript
function can(user, action, resource) {
    return user.permissions[action].includes(resource.neededPermission[action])
}
```

Faz sentido?

>> Coment√°rio de huogerac:
Fala pessoal,

Primeiramente, desculpa que n√£o estou indo ao n√≠vel de c√≥digo...s√≥ em fluxo de execu√ß√£o 

## 1) Tentando responder o @tcarreira & pq talvez o modelo de Role Based pode dar mais trabalho

Eu entendi um pouco sua explica√ß√£o, mas o conceito de "T√≥pico" n√£o sei se entendi corretamente, vou "tentar" colocar o exemplo do tabnews:

Imagine que de um lado temos as Roles:
```
// Role e os recursos (endpoint da api) com acesso
Visitante aka sem login: ['tabnews:list']
Escritor-Inicial: ['tabnews:list', 'comments:create']
Escritor-Intermidiario: ['tabnews:list','comments:create', 'tabnews:create']
Escritor-Premium: ['tabnews:list','comments:create', 'tabnews:create', 'image:upload']
Escritor-Mantenedor: ['tabnews:list','comments:create', 'tabnews:create', 'image:upload', 'tabnews:delete', 'comments:delete']
```

Desta forma, um usu√°rio novo come√ßa como 'Escritor-Inicial', depois de atingir certo n√∫mero de pontos (fazendo coment√°rios), ele passa para uma nova role 'Intermediario' e assim por diante...

Ent√£o, acredito que sim o modelo de Role Based pode ser adaptado e conseguir atender os requisitos, mas talvez pode ter formas mais interessantes ou menos trabalhosa...
Imagine ter que ficar criando v√°rias roles, Escritor-Premium2-q-tb-pode-deletar, saca sempre vai ter novas regras e exce√ß√µes das regras, que complica a cria√ß√£o de Roles.


## 2) Permiss√µes baseada em Recursos

Primeiramente, n√£o importa se a 'Autentica√ß√£o' √© via login usando OAUTH, usu√°rio e senha ou passwordless
Vai ganhar um acesso que pode ser um sessionID ou um Token (tanto faz), s√≥ diz que este usu√°rio foi autenticado..

Dai temos os recursos protegidos ou relacionados pela API:

```
GET /api/tabnews         security: [tabnews:list]
POST /api/tabnews         security: [tabnews:create]
POST /api/comments         security: [comments:create]
POST /api/tabnews/image         security: [image:upload]
...

```

Assim, imagine que ap√≥s o login (novamente independente da forma de autenticacao), o usu√°rio vai ganhar uma sess√£o a qual √© ligada a um usu√°rio (USER_ID: 100)

Dai toda vez que ele fizer uma requisi√ß√£o, no lado do backend, vamos:
- Pegar o usu√°rio da sess√£o
- Descubrir sua pontua√ß√£o que vai gerar a lista de recursos com acesso.

Assim vamos ter 2 possibilidades:
- Est√° tentando fazer uma requisi√ß√£o que ainda n√£o ter permiss√£o (exemplo: s√≥ pode inserir coment√°rio, mas est√° tentando inserir tabnews)
- Est√° tetando fazer uma requisi√ß√£o que √© permitida, dado que sua pontua√ß√£o retornou uma lista de recursos que cont√©m a security da requisi√ß√£o

Assim ao inves de uma tabela de Role & permissions
Vamos ter uma tabela de ENDPOINT (ou service) vs permission
Exemplo: `POST /api/tabnews/image         security: [image:upload]`

assim a implementa√ß√£o da camada de servi√ßos, pode ter um middleware que sabe:
Obter o usu√°rio da sess√£o, calcular seus pontos que por sua vez ir√° retornar a lista de recursos que ele tem permiss√£o.

Ahhh, mas se o usu√°rio pode fazer upload de imagem, mas s√≥ para o tabnews criado por ele (que √© o caso)
Esta segunda regra, vai estar dentro do servi√ßo, ele passou na primeira valida√ß√£o (middleware) que o permite fazer upload de imagem, dai o servi√ßo espec√≠fico de upload de imagem vai validar se ele √© o dono da tabnews para concluir a requisi√ß√£o com sucesso, caso contr√°rio vai retornar um 403

## 3) Implementa√ß√£o POC

Nos links que passei acima, tem uma implementa√ß√£o bem inicial desta forma de valida√ß√£o, infelizmente n√£o conhe√ßo React e NextJS o suficiente e fiz usando Python para validar o conceito!

Eu acabei utilizando JWT (@filipedeschamps  n√£o fique bravo), porque esta tecnlogia me parece que ataca exatamente este problema (Resource-based Access Control) e com pouco c√≥digo, todo este controle est√° resolvido.
[1] e [2]

Mas tranquilamente √© poss√≠vel tirar o JWT da jogada e manter o mesmo comportamento ou quem sabe pegar o melhor dos 2 mundos: o modelo tradicional de sess√£o usando token apenas para centralizar o middleware

Ufa, ficou um pouco longo, espero n√£o ter confundido mais pessoal

[1]
https://tabnewsapi.herokuapp.com/openapi.yaml

[2]
https://tabnewsapi.herokuapp.com/api/

>> Coment√°rio de filipedeschamps:
Turma que thread SENSACIONAL essa daqui se tornou üòç ü§ù 

@huogerac muito obrigado pelo invite acabei de aceitar e vou com certeza dar uma olhada na POC.

Em paralelo, vou tentar gravar um v√≠deo com a implementa√ß√£o que fiz e que pode esclarecer alguns pontos dessa discuss√£o 
 e tenho certeza que vai abrir margem para mais discuss√£o ü§ù

>> Coment√°rio de filipedeschamps:
Turma, ta aqui o v√≠deo: https://youtu.be/U7a85J8oSmw üòç 

Gravei na paulera, ve se d√° para entender ü§ù

>> Coment√°rio de tcarreira:
> Turma, ta aqui o v√≠deo: https://youtu.be/U7a85J8oSmw üòç 

Fant√°stico que vc resolveu implementar e explicar tudo com o v√≠deo. Sensacional! Acho que este tipo de permiss√µes ficam mais f√°ceis de gerir a m√©dio prazo. E como vc disse, mesmo que na cabe√ßa fique aquela ideia de role, isso basicamente √© apenas um conjunto de permiss√µes de template. 

S√≥ acho que tem um bug que quando vc voltar a abrir novamente o link de ativa√ß√£o, vai receber o 'usu√°rio n√£o pode ler token' em vez do 'usu√°rio j√° est√° ativo' ([minuto 16:38](https://youtu.be/U7a85J8oSmw?t=998)) . Porque vc remove as permiss√µes de ler token ap√≥s ativa√ß√£o. 


Deixo ainda uma pergunta. 
Ser√° que n√£o existe algum pacote externo que implementa aquela valida√ß√£o? Se n√£o existe, acho que faria sentido criar a funcionalidade como um pacote separado (talvez um pouco mais √† frente no tempo) 


Parab√©ns üéâ

>> Coment√°rio de ItanuRomero:
Rapaz, sensacional, que experi√™ncia.
Muito bom o v√≠deo e a implementa√ß√£o, mas estou me sentindo que nem o Filipe lendo pela primeira vez o artigo do menino que hackeou o Github.

No mais, acho que est√° bem explicado, consegui entender boa parte mesmo nos meus limites t√©cnicos!

@tcarreira No minuto [19:23](https://youtu.be/U7a85J8oSmw?t=1163) ele mostra a mensagem que aparece pro usu√°rio e ela fala que o usu√°rio pode j√° estar ativo, mas pode ser uma boa revisar se faz sentido aquela mensagem super t√©cnica para o usu√°rio final.

Valeu pessoal!

>> Coment√°rio de filipedeschamps:
> S√≥ acho que tem um bug que quando vc voltar a abrir novamente o link de ativa√ß√£o, vai receber o 'usu√°rio n√£o pode ler token' em vez do 'usu√°rio j√° est√° ativo' ([minuto 16:38](https://youtu.be/U7a85J8oSmw?t=998)) . Porque vc remove as permiss√µes de ler token ap√≥s ativa√ß√£o.

@tcarreira seguindo o que o @ItanuRomero colocou na resposta dele, esse √© o comportamento esperado porque algu√©m n√£o pode ativar a conta duas vezes, mas concordo que a mensagem est√° muito t√©cnica. O c√≥digo est√° assim:

```js
  if (!authorization.can(userToActivate, 'read:activation_token')) {
    throw new ForbiddenError({
      message: `O usu√°rio "${userToActivate.username}" n√£o pode ler o token de ativa√ß√£o.`,
      action:
        'Verifique se voc√™ est√° tentando ativar o usu√°rio correto, se ele possui a feature "read:activation_token", ou se ele j√° est√° ativo.',
      stack: new Error().stack,
    });
  }
```

O `message` diz o que aconteceu, e o `action` √© uma sugest√£o do que fazer, mas lembro agora, ta um pouco embaralhado mesmo üòÇ

>> Coment√°rio de tcarreira:
> > S√≥ acho que tem um bug que quando vc voltar a abrir novamente o link de ativa√ß√£o, vai receber o 'usu√°rio n√£o pode ler token' em vez do 'usu√°rio j√° est√° ativo' ([minuto 16:38](https://youtu.be/U7a85J8oSmw?t=998)) . Porque vc remove as permiss√µes de ler token ap√≥s ativa√ß√£o.
> 
> @tcarreira seguindo o que o @ItanuRomero colocou na resposta dele, esse √© o comportamento esperado porque algu√©m n√£o pode ativar a conta duas vezes, mas concordo que a mensagem est√° muito t√©cnica. O c√≥digo est√° assim:
> 
> ```js
>   if (!authorization.can(userToActivate, 'read:activation_token')) {
>     throw new ForbiddenError({
>       message: `O usu√°rio "${userToActivate.username}" n√£o pode ler o token de ativa√ß√£o.`,
>       action:
>         'Verifique se voc√™ est√° tentando ativar o usu√°rio correto, se ele possui a feature "read:activation_token", ou se ele j√° est√° ativo.',
>       stack: new Error().stack,
>     });
>   }
> ```
> 
> O `message` diz o que aconteceu, e o `action` √© uma sugest√£o do que fazer, mas lembro agora, ta um pouco embaralhado mesmo üòÇ 

N√£o √© esse if, √© o if seguinte :D
Acho que s√£o mutuamente exclusivos (devido a regras de neg√≥cio), ent√£o o segundo if nunca √© alcan√ßado :)

Mas n√£o devia ter falado disso aqui üòÖ
Estou tirando foco do fant√°stico trabalho que foi feito. Bug ou n√£o, √© f√°cil mudar depois.

>> Coment√°rio de filipedeschamps:
> N√£o √© esse if, √© o if seguinte :D

Ahhh interessant√≠ssimo, voc√™ est√° certo @tcarreira ! Vou colocar as informa√ß√µes aqui para todo mundo estar no mesmo barco, esse √© o if em quest√£o:

```js
  if (authorization.can(userToActivate, 'create:session')) {
    throw new ForbiddenError({
      message: `O usu√°rio "${userToActivate.username}" j√° est√° ativo.`,
      action: 'Voc√™ j√° pode fazer login por possuir a feature "create:session".',
      stack: new Error().stack,
    });
  }
```

E juntando tudo, a sequ√™ncia √© essa:

```js
// GET /api/v1/activate/:token

if (!authorization.can(userToActivate, 'read:activation_token')) {
    throw...
}

if (authorization.can(userToActivate, 'create:session')) {
    throw...
}
```
Os fluxos poss√≠veis:

1) Usu√°rio com conta que acabou de criar recebe o link de ativa√ß√£o, clica nele e n√£o vai entrar na primeira condi√ß√£o nem na segunda, pois ele possui **somente** a feature `read:activation_token`.
2) Com o token usado, o usu√°rio agora n√£o possui mais `read:activation_token`. J√° a√≠ ele vai ser barrado na primeira condi√ß√£o (vai entrar nela), pois ele n√£o pode mais ler tokens de ativa√ß√£o. N√£o importa se ele tem ou n√£o a feature `create:session`.
3) N√£o consigo mais imaginar (como eu imaginei no momento da implementa√ß√£o) que o usu√°rio possa ter a feature `read:activation_token` ao mesmo tempo que `create:session`. A n√£o ser por manipula√ß√£o manual dos dados das features.

Correto?

>> Coment√°rio de filipedeschamps:
Em paralelo, o que acham de mudarmos a nomenclatura de `create` para `write`? Acho que faz um par melhor entre `read` e `write` e combina mais com permiss√µes de banco de dados e sistemas operacionais. O racioc√≠nio √© que a pessoa tem a permiss√£o de "escrever" em tal local/objeto e casaria melhor num ato de "update", onde n√£o √© "create" e sim "write".

üëç - se faz sentido
üëé - se n√£o faz sentido

>> Coment√°rio de rodrigoKulb:
> Rapaz, sensacional, que experi√™ncia. Muito bom o v√≠deo e a implementa√ß√£o, mas estou me sentindo que nem o Filipe lendo pela primeira vez o artigo do menino que hackeou o Github.

@ItanuRomero totalmente, agora que j√° assisti 3 vezes o v√≠deo ficou um pouco mais claro!

Eu nunca tinha visto esse tipo de permiss√£o, achei incr√≠vel trabalhar a permiss√£o user a user, mas aqui pensando n√£o consegui enxergar como voc√™ daria uma permiss√£o "inicial" para o adm do site? Isso ficaria em outra flag?

@filipedeschamps se voc√™ lan√ßar um curso, eu j√° estou inscrito!!! hahaha!!

>> Coment√°rio de filipedeschamps:
> n√£o consegui enxergar como voc√™ daria uma permiss√£o "inicial" para o adm do site? Isso ficaria em outra flag?

Excelente pergunta e hoje n√£o tem como e seria s√≥ atrav√©s de marretar diretamente o banco de dado üòÇ  mas mais pra frente d√° para fazer um fluxo de "setup" e que identifica se n√£o h√° nenhum usu√°rio com certas features necess√°rias para moderar üëç

>> Coment√°rio de tcarreira:
> Em paralelo, o que acham de mudarmos a nomenclatura de `create` para `write`? Acho que faz um par melhor entre `read` e `write` e combina mais com permiss√µes de banco de dados e sistemas operacionais. O racioc√≠nio √© que a pessoa tem a permiss√£o de "escrever" em tal local/objeto e casaria melhor num ato de "update", onde n√£o √© "create" e sim "write".
> 
> üëç - se faz sentido
> üëé - se n√£o faz sentido

Se me permite acrescentar, acho que as permiss√µes normais (e padr√£o) s√£o crud:
- create
- read
- update
- delete

Esse write √© um equivalente de todas as op√ß√µes de crud?

Acho boa ideia manter um padr√£o, para que n√£o haja d√∫vidas mais a frente

>> Coment√°rio de filipedeschamps:
Hmmm interessant√≠ssimo @tcarreira . O `write` seria acesso de escrita (create / update / delete), n√£o contempla o `read`.

Mas como estamos 100% em REST, faz sentido estar colado nisso tamb√©m. Quando eu refatorar o c√≥digo para commitar eu vou levar tudo isso em considera√ß√£o ü§ù 

Essa thread ta MUITO massa üòç

>> Coment√°rio de gabrielew:
Ap√≥s ver o v√≠deo/c√≥digo vi que est√° sendo utilizado as permiss√µes hard coded em v√°rios arquivos, n√£o seria melhor ter isso em um enum/const? "Levando em considera√ß√£o a qualidade/refatora√ß√£o do c√≥digo no futuro"
ex: Centralizar a informa√ß√£o em apenas um lugar.
`const readPermissions = {
   ACTIVATION_TOKEN: 'read:activation_token',
   ...
}`

>> Coment√°rio de filipedeschamps:
@gabrielew excelente sugest√£o!!! Poder√≠amos centralizar tudo isso no componente de `authorization` mesmo e exportar de l√° para quem precisar usar. Por exemplo:

```js
import authentication from `models/authentication.js
...
console.log(authentication.permissions.read.activation_token)
// -> "read:activation_token"
```

O que penalizaria um pouco o tamanho do c√≥digo, usando como exemplo o if discutido acima:

```js
if (!authorization.can(userToActivate, authentication.permissions.read.activation_token)) {
    throw...
}
```

Ao inv√©s de:
```js
if (!authorization.can(userToActivate, 'read:activation_token')) {
    throw...
}
```

Trade off que identifiquei:
* **A favor:** n√£o cometer errors simples de achar que est√° passando uma string de feature correta, e na verdade ela tem um typo. Isso tamb√©m pode acontecer com o objeto e ele pode silenciosamente retornar um undefined (mas dai o `authorization.can()` vai dar throw.
* **Contra:** Existe a chance de refatorar a string do token, sem refatorar o caminho do objeto? Se n√£o existir, ser√° que isso vai na pr√°tica economizar trabalho?

O que a experi√™ncia de voc√™s diz nesse caso?

>> Coment√°rio de tcarreira:
vou escrever uns coment√°rios e deixar um exemplo de c√≥digo em baixo

> O que penalizaria um pouco o tamanho do c√≥digo, usando como exemplo o if discutido acima:
> 
> ```js
> if (!authorization.can(userToActivate, authentication.permissions.read.activation_token)) {
>     throw...
> }
> ```

Acho que podemos usar alias para o c√≥digo ficar mais curto, 
ou o authentication.js exportar um alias mais curto (perms).
N√£o acho que seja realmente um problema


> * *A favor:* n√£o cometer errors simples de achar que est√° passando uma string de feature correta, e na verdade ela tem um typo. Isso tamb√©m pode acontecer com o objeto 

A meu ver, esta √© a principal vantagem.
N√£o acho que a refatoriza√ß√£o seja realmente uma vantagem neste caso. Existe sempre a op√ß√£o replace all, caso seja necess√°rio refatorar a string. 

Mas a nota que quero deixar √© que no caso de haver um arquivo com todas as permiss√µes, faz mais sentido renomear elas para resource.action, para que as permiss√µes fiquem ordenadas por contexto. (activation_token.read)

E at√© pode ficar facilitado criar aquelas a√ß√µes de crud automaticamente com uma helper_function.


> e ele pode silenciosamente retornar um undefined

Acredito que static code analysis encontra esses erros. 


---

Este √© o meu exemplo:
```js
// file: authentication.js

// helper function
function new_permissions(name, other = undefined) {
  perms = {};
  perms[name] = {
    create: name + ":create",
    read: name + ":read",
    update: name + ":update",
    delete: name + ":delete",
  };

  // Handle additional permissions, if any
  if (other !== undefined) {
    other.forEach((p) => {
      perms[name][p] = name + ":" + p;
    });
  }

  return perms;
}

authentication = {
  permissions: {
    ...new_permissions("post"),
    ...new_permissions("activation_token"),
    ...new_permissions("custom", ["read_all", "weird_permission"]),
  },
};

// alias, for shorter code
perms = authentication.permissions;

module.exports = { authentication, perms };
```

que pode ser usado com 

```js
import perms from `models/authentication.js`

// if (!authorization.can(userToActivate, 'read:activation_token')) {
if (!authorization.can(userToActivate, perms.activation_token.read)) {
    throw...
}

```


o que vcs acham?

>> Coment√°rio de filipedeschamps:
Sensacional @tcarreira muito bem bolado ü§ù 

Minha antena s√≥ ativa pelo fato de acabar criando permiss√µes *"ahead of time"*, no caso do template padr√£o ali resultante do `new_permissions()` ser o CRUD inteiro, ou qualquer que seja o padr√£o para facilitar a cria√ß√£o das permiss√µes. Eu ainda seria cabe√ßa dura e escreveria manualmente permiss√£o a permiss√£o, para ficar expl√≠cito o que existe e o que est√° sendo adicionado/alterado, de forma granular mesmo. Por que por exemplo, sem percebermos, as vezes uma refatora√ß√£o nessa fun√ß√£o possa criar permiss√µes n√£o esperadas, ou condicionais que come√ßam a quebrar a abstra√ß√£o, como uma feature ter permiss√£o s√≥ para `read`, ou uma feature sem CRUD tradicional e somente `other` para fazermos uma feature flag, por exemplo.

Mas partindo desse seu modelo consegui pensar em outro, e ao inv√©s de exportarmos um objeto com permiss√µes, a gente pode simplesmente validar a string que √© enviada... de forma tradicional mesmo.

Ent√£o pra atender a minha preocupa√ß√£o anterior de n√£o criar nada ahead of time, podemos construir um objeto (ou array) de actions aceitas, e quando a string de uma action for enviada, por exemplo `authorization.can(user, 'read:activation_token')` e ela n√£o existir nessa lista, pro-ativamente fazer o componente dar throw num `AuthorizationError` ou `ValidationError` explicando que essa action n√£o existe e isso pode ajudar o desenvolvedor a debuggar.

Assim temos:

1. Interface p√∫blica simples.
2. Mesmo trabalho de refatora√ß√£o (replace all de strings, sempre muito f√°cil).
3. Garantia contra uma `action` inexistente.
4. Granularidade para criar actions exatas ao que o sistema est√° pedindo.
5. E por conta dessa granularidade, conseguir criar feature flags.

To doido? Confere isso porque eu acordei 3h da manh√£ por conta do Oliver e n√£o consegui dormir at√© agora (s√£o 5:40 aqui agora) üòÇ

>> Coment√°rio de filipedeschamps:
Em paralelo, dever√≠amos sempre chamar de **actions** ou **features**? Porque no `user` √© tratado como uma `feature`, mas no `authorization` √© tratado como `action`. Vou padronizar tudo para `feature` para ver como vai ficar üëç

>> Coment√°rio de tcarreira:
> Minha antena s√≥ ativa pelo fato de acabar criando permiss√µes _"ahead of time"_, no caso do template padr√£o ali resultante do `new_permissions()` ser o CRUD inteiro

Aquele helper n√£o √© estritamente necess√°rio (no meu c√≥digo original eu chamava `default_permissions`), mas opini√£o pessoal que se houver permiss√µes "normais" que j√° existem por padr√£o, fica mais f√°cil usar elas sem grande preocupa√ß√£o, mas o que vc disse n√£o deixa de ser verdade (ver c√≥digo mais abaixo). 
No caso daquele c√≥digo, podia criar a permiss√£o sem as defaults bem f√°cil, j√° que o objeto √© um objeto/dicion√°rio normal:

```js
authentication = {
  permissions: {
    ...default_permissions("post"),
    ...default_permissions("activation_token"),
    ...default_permissions("custom", ["read_all", "weird_permission"]),
    custom2: {
      implode: "custom2:implode",
      explode: "custom2:explode",
    },
  },
```

e se usa igual:
```js
if (!authorization.can(userToActivate, perms.custom2.explode)) {
    throw...
}
```

Mas concordo que esta forma de fazer as coisas pode n√£o ajudar assim tanto, ent√£o v√™ o c√≥digo seguinte

---

> Mas partindo desse seu modelo consegui pensar em outro, e ao inv√©s de exportarmos um objeto com permiss√µes, a gente pode simplesmente validar a string que √© enviada... de forma tradicional mesmo.

```js
// ahahah gosto demais da op√ß√£o de ter permiss√µes padr√£o :D 
function default_permissions_simple(name, other = undefined) {
  let perms = [
    name + ":create",
    name + ":read",
    name + ":update",
    name + ":delete",
  ]

  // Handle additional permissions, if any
  if (other !== undefined) {
    other.forEach((p) => {
      perms.push(name + ":" + p);
    });
  }
  return perms;
}

// Lista de todas as permiss√µes que a app aceita
authentication = {
  simplePermissions: new Set([
    ...default_permissions_simple("activation_token"),
    "custom3:read", // na verdade, as permiss√µes s√£o apenas strings
    "custom3:write",
  ])
};
```
usando assim
```js
if (!authorization.can(userToActivate, "activation_token:read" )) {
    throw...
}
```

onde aquele `authorization.can` deve ser algo simples como j√° havia sido referido

```js
function can(user, permission_str) {
  if (!authentication.simplePermissions.has(permission_str)){
    throw new Error("non declared permission " + permission_str);
  }
  return user.features.has(permission_str)
},
```

---

> Assim temos:
> 
> 1. Interface p√∫blica simples.

Gosto üëç 

> 2. Mesmo trabalho de refatora√ß√£o (replace all de strings, sempre muito f√°cil).

Gosto üëç 

> 3. Garantia contra uma `action` inexistente.

Gosto üëç 

> 4. Granularidade para criar actions exatas ao que o sistema est√° pedindo.

Gosto üëç 

> 5. E por conta dessa granularidade, conseguir criar feature flags.

Gosto üëç 

---

> To doido? Confere isso porque eu acordei 3h da manh√£ por conta do Oliver e n√£o consegui dormir at√© agora (s√£o 5:40 aqui agora) üòÇ

Eu estava igual, adormecendo o beb√© nos bra√ßos, no meio da noite, mas pensando em js üòÇ . Tudo louco!


ps: vi que tem MR, vou tentar ver, mas n√£o prometo

>> Coment√°rio de tcarreira:
> ```js
> // Lista de todas as permiss√µes que a app aceita
> authentication = {
>   simplePermissions: new Set([
>     ...default_permissions_simple("activation_token"),
>     "custom3:read", // na verdade, as permiss√µes s√£o apenas strings
>     "custom3:write",
>   ])
> };
> ```

Ah, e estou usando um `Set` porque √© mais eficiente procurar nele do que em um `Array`

>> Coment√°rio de filipedeschamps:
Show!! Ent√£o sugest√£o: a base das duas solu√ß√µes est√° igual e uma adiciona um helper. Eu vou ent√£o continuar do modo sem helper (mas trocando para Set como voc√™ fez) e vamos deixar o c√≥digo chamar pela necessidade disso ü§ù 

E sobre o PR, eu quero s√≥ terminar de fazer mais uma implementa√ß√£o que eu comentei l√° e acho que ta massa para merge üëç

>> Coment√°rio de tcarreira:
Fant√°stico.
Fico ansiando pelo dia em que podemos agendar um pair programming em real time, estilo Dojo ;)

>> Coment√°rio de rodrigoKulb:
Confesso que fiquei um pouco perdido no final, Vou estudar o c√≥digo final depois!
Aqui √© s√≥ conversa de alto n√≠vel ü§©Ô∏è

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show! Eu vou fazer um novo v√≠deo, explicando tudo com mais calma, vai valer a pena üëç

>> Coment√°rio de gabrielew:
Uma d√∫vida que me surgiu aqui, ir√° existir templates com certas autoriza√ß√µes pre definidas?

>> Coment√°rio de filipedeschamps:
@gabrielew boa pergunta, por enquanto imagino que n√£o. Na verdade os √∫nicos templates por enquanto s√£o do usu√°rio b√°sico (que no √∫ltimo PR as features vem da migration) e o usu√°rio an√¥nimo que est√° no c√≥digo, e que talvez tudo isso poderia ser convertido para template de features üëç

>> Coment√°rio de filipedeschamps:
Pessoal, **encerramos a Milestone 2** com o merge desse PR: https://github.com/filipedeschamps/tabnews.com.br/pull/195

Que massa!!!

Agora vou ver se vale a pena refatorar algumas coisas e fazer a live de encerramento! E nessa live eu fecho essa issue aqui e lan√ßamos de fato a nossa primeira vers√£o da API pra valer, criando usu√°rios, etc.. ü§ù

>> Coment√°rio de tcarreira:
Acho que esta issue est√° terminada com o #170

>> Coment√°rio de filipedeschamps:
Eu queria fechar ela na live de encerramento da milestone üòÇ üëç
</issue_107_Sistema de Autoriza√ß√£o>

<issue_108_Problema de permiss√£o Docker no Linux - (Couldn't connect to Docker daemon)>
Acabei ficando sem tempo para documentar o problema que tive no Ubuntu na live [TabNews: Milestone 1 (ENCERRAMENTO)](https://youtu.be/rVsYU9HyREM?t=1631)

 Apenas para manter o hist√≥rico de li√ß√µes aprendidas, vou deixar essa Issues j√° como finalizada.
 
 Ao iniciar o comando `npm run dev` era apresentado o seguinte erro:
 
`tabnews.com.br@1.0.0 services:up`
`docker-compose -f infra/docker-compose.development.yml up -d`
`ERROR: Couldn't connect to Docker daemon at http+docker://localhost - is it running?`

Achei a resposta para o problema neste link:

https://docs.docker.com/engine/install/linux-postinstall/

Executando os itens 1,2,3,4.

>> Coment√°rio de rodrigoKulb:
Resultado:

![Captura de tela em 2021-08-19 10-09-49](https://user-images.githubusercontent.com/5334261/130076028-18c7fcd3-1445-473e-a08b-5b5aa4c42c2c.png)

>> Coment√°rio de rodrigoKulb:
Criei um Label chamado [lessons learned](https://github.com/filipedeschamps/tabnews.com.br/issues?q=label%3A%22lessons+learned%22+is%3Aclosed) para deixar no hist√≥rico como li√ß√µes aprendidas.

>> Coment√°rio de geovani-brito:
Muito, bom @rodrigoKulb. J√° tive esse problema mas acabei n√£o guardando a solu√ß√£o. Valeu por compartilhar!

Vou aproveitar pra relatar um problema que tive tamb√©m, mas com o **Docker-compose** no **Ubuntu**.

Eu n√£o estava conseguindo rodar o projeto com o arquivo `docker-compose.development.yml` na vers√£o `2.4`. Eu consegui fazer rodar baixando a vers√£o para `2.2`.

Pesquisando eu descobri que a vers√£o do meu Docker-compose estava desatualizada. Eu tinha a `1.17`. Baixei a vers√£o mais recente que √© a `1.29` com o comando: 

`sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose`

Mesmo assim ele n√£o funcionou. Na verdade nem mudou a vers√£o. Pesquisando um pouco mais a fundo descobri que a pasta da minha instala√ß√£o era `/usr/bin/` e n√£o `/usr/local/bin/` como aparece no comando. Bastou s√≥ eu fazer a troca do local que o problema foi resolvido. 

Quem quiser consultar a documenta√ß√£o o link √© esse:
https://docs.docker.com/compose/install/#install-compose

>> Coment√°rio de rodrigoKulb:
Muito bom @geovani-brito, tive **sorte** üòÖÔ∏è que a vers√£o que baixei rodou tranquilo, estou rodando na vers√£o docker-compose version 1.26.0.
</issue_108_Problema de permiss√£o Docker no Linux - (Couldn't connect to Docker daemon)>

<issue_110_Aten√ß√£o: Live de Inaugura√ß√£o essa segunda √†s 20h>
Fala turma! Infelizmente o Youtube n√£o est√° enviando notifica√ß√µes aos Membros (j√° estou com o pessoal do suporte para resolver), e por conta disso a Live de sexta com a inaugura√ß√£o foi um tiro na √°gua üòÇ 

Ent√£o estou notificando por aqui que a nova Live de Inaugura√ß√£o da [Milestone 2](https://github.com/filipedeschamps/tabnews.com.br/milestone/3) vai acontecer nessa **segunda-feira, √†s 20h** e este ser√° o link: https://youtu.be/_qJdv5Xqwf8

Um abra√ß√£o e nos vemos l√° :)

>> Coment√°rio de filipedeschamps:
Turma, daqui a alguns minutos estarei ao vivo nesse link: https://youtu.be/_qJdv5Xqwf8 ü§ù

>> Coment√°rio de brunofamiliar:
> Turma, daqui a alguns minutos estarei ao vivo nesse link: https://youtu.be/_qJdv5Xqwf8 ü§ù

Notifica melhor que o youtube aqui kk acabei minha cola√ß√£o de grau agora!!! Entrando l√° pra ver essa live top ;)

>> Coment√°rio de filipedeschamps:
Live feita com sucesso :)

>> Coment√°rio de rodrigoKulb:
Perdi a live, vou assistir agora!
</issue_110_Aten√ß√£o: Live de Inaugura√ß√£o essa segunda √†s 20h>

<issue_120_Migrations n√£o est√£o mais sendo rodadas>
@paulogdm voc√™ saberia dizer se a Vercel mudou algo no acesso aos arquivos pelo file system?

Pergunto isso, pois no ambiente de Preview e Production os arquivos de migration n√£o est√£o sendo mais encontrados, retornando um `ENOENT` (o que antes funcionava, veja logo abaixo).

```json
// GET https://www.tabnews.com.br/api/v1/migrations

{
  "error": "Can't get migration files: Error: ENOENT: no such file or directory, scandir '/var/task/infra/migrations/'"
}
```

O que √© estranho, porque numa [Live feita no canal feita dia 30 de Julho](https://youtu.be/rVsYU9HyREM) a gente conseguiu rodar normal no ambiente de Preview e Production. Tanto eu, quanto outras pessoas, tem at√© print disso inserido [nessa issue](https://github.com/filipedeschamps/tabnews.com.br/issues/83#issuecomment-890087633) no ambiente de Production,  segue abaixo aparecendo a parte que interessa e mostrando o **exato mesmo path** que foi resolvido:

![image](https://user-images.githubusercontent.com/4248081/132281092-99b96477-9b8f-4e17-9dfe-1253c5b6f014.png)

O que achei estranho √© que existe [essa issue](https://github.com/vercel/next.js/issues/8251) falando sobre esse problema, contornando com uma configura√ß√£o maluca, sendo que no nosso caso funcionava e a √∫nica coisa que a gente fazia era a resolu√ß√£o do path assim:

```js
  const defaultConfigurations = {
    dir: join(resolve('.'), 'infra', 'migrations'), // <--------
    direction: 'up',
    migrationsTable: 'migrations',
    verbose: false,
  };
```
[Link para a linha](https://github.com/filipedeschamps/tabnews.com.br/blob/main/infra/migrator.js#L7)

---

Voc√™ sabe o que pode ter acontecido nesse meio tempo para naquele dia rodar, mas hoje n√£o?

PS: eu tentei promover o deploy em production do dia 30 de Julho, mas o [build quebra malucamente](https://vercel.com/tabnews/tabnews/Fq2bc3qiRVRF2hTkbxsPK2LKUwCt) apontando erro em ```UnhandledPromiseRejectionWarning: Error: Cannot find module 'next/dist/shared/lib/constants.js'``` (?)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps n√£o consegui fazer o teste porque o erro √© em produ√ß√£o, mas achei um git falando sobre o mesmo erro, com uma solu√ß√£o da Vercel:
*Git*
https://github.com/vercel/vercel/discussions/5066
*Solu√ß√£o*
https://vercel.com/docs/runtimes#advanced-usage/technical-details/including-additional-files

>> Coment√°rio de filipedeschamps:
Sensacional @rodrigoKulb ! Vou tentar a solu√ß√£o de deixar expl√≠cito a pasta pelo `vercel.json` üëç

>> Coment√°rio de filipedeschamps:
Hmm... n√£o funcionou. Investigando üëç

>> Coment√°rio de filipedeschamps:
@rodrigoKulb o problema do `__dirname` √© que ele sempre vai resolver o caminho em que o script est√° sendo executado, no caso o contexto vai ser o arquivo da fun√ß√£o l√° na API. Ent√£o dependendo de onde o Migrator fosse chamado, essa pasta ir√° mudar.

De qualquer forma, pra tentar isolar o problema eu tentei apontar para a pasta pra ver se isso mudava algo, mas n√£o mudou, continuou dando erro.

@paulogdm voc√™ tem ideia do que pode ser essa mudan√ßa de comportamento desde o dia 30 de Julho?

[edit] o PR com o arquivo `vercel.js` [est√° aqui](https://github.com/filipedeschamps/tabnews.com.br/pull/119/files#diff-a3265310f552fb66876e8bfe8809737e59e5ba946bdf39138b44d9baf4e21240). Ser√° que estou fazendo algo errado no glob?

>> Coment√°rio de rodrigoKulb:
Exatamente at√© apaguei porque localmente deu erro.
Neste f√≥rum informa que o erro est√° correto, pois n√£o deveria ter permiss√£o para acesso a pasta:
https://answers.netlify.com/t/how-to-access-files-from-nextjs-api-function/35347
Ser√° que a Vercel alterou a politica de acesso?

Achei esse t√≥pico falando sobre **vercel.json** podendo adicionar includeFiles
https://vercel.com/support/articles/how-can-i-use-files-in-serverless-functions

**Tentou:**
```
{
  "functions": {
    "infra/migrator.js": {
      "includeFiles": "infra/migrations/**"
    }
  }
}
```
**Ou**
```
{
  "functions": {
    "api/v1/migrations/index.public.js": {
      "includeFiles": "infra/migrations/**"
    }
  }
}
```

>> Coment√°rio de paulogdm:
Toda resolu√ß√£o de arquivos em qualquer arquivo do app √© feita de forma est√°tica. Basicamente, compilamos tudo num "bundle" grande. Antigamente (bem antigamente) usavamos [NCC](https://github.com/vercel/ncc) mas isso evoluiu para [NFT](https://github.com/vercel/nft). Nourl caso do Next.js, tbm rola algumas coisas no n√≠vel de webpack. 

O problema pode ser alguma regress√£o na depend√™ncia usada no projeto ou at√© mesmo em coisas do lado da plataforma. O melhor a fazer √© um minimal repro e investigar.

>> Coment√°rio de filipedeschamps:
Show @paulogdm vamos continuar investigando e isolando o problema ü§ù 

@rodrigoKulb sobre as op√ß√µes abaixo, tentei sim mas somente o seletor `pages/api/v1/migrations/index.public.js` funcionou, e tava nas docs (n√£o to achando de novo a se√ß√£o). Mas eu acredito que esse jeito est√° certo, pois nas docs tinha uma se√ß√£o espec√≠fica do Next.js falando que era assim, e o build quebrava j√° no in√≠cio com qualquer outro pattern üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps exatamente eu estava lendo neste link:
https://vercel.com/support/articles/how-can-i-use-files-in-serverless-functions#caveats
Essa parte que fiquei com d√∫vidas:
![Captura de tela em 2021-09-07 16-37-26](https://user-images.githubusercontent.com/5334261/132401428-fae98aa3-039d-42fa-91a6-fda50c4f057f.png)

>> Coment√°rio de filipedeschamps:
Em paralelo, fiz uma branch que volta para o commit do dia l√° em que funcionava, e o build quebra malucamente, olha que estranho: https://vercel.com/tabnews/tabnews/2hB2KPyBJ57MuDjA6FL98wZ7xeME

>> Coment√°rio de rodrigoKulb:
> Em paralelo, fiz uma branch que volta para o commit do dia l√° em que funcionava....

Ent√£o realmente foi alguma altera√ß√£o de acesso na Vercel. Existe a possibilidade de abrir um chamado l√°?

Aparentemente existe uma forma alternativa para acessar, neste link:
https://github.com/vercel/next.js/issues/8251#issuecomment-547702744

>> Coment√°rio de paulogdm:
> > Em paralelo, fiz uma branch que volta para o commit do dia l√° em que funcionava....
> 
> Ent√£o realmente foi alguma altera√ß√£o de acesso na Vercel. Existe a possibilidade de abrir um chamado l√°?
> 
> Aparentemente existe uma forma alternativa para acessar, neste link:
> [vercel/next.js#8251 (comment)](https://github.com/vercel/next.js/issues/8251#issuecomment-547702744)

Isso est√° outdated. O comment √© bem antigo...

EDIT: Assim que tivermos um "minimal repro", posso perguntar pro core team o que seria a melhor alternativa, e se isso √© um bug no framework ou na plataforma.

>> Coment√°rio de rodrigoKulb:
Ser√° que apenas para teste, funcionaria desta forma?

```
{
  "functions": {
    "*": {
      "includeFiles": "*"
    }
  }
}
```

>> Coment√°rio de paulogdm:
Vamos testar isso aqui?
https://github.com/vercel/next.js/issues/8251#issuecomment-915287535

>> Coment√°rio de filipedeschamps:
> Ser√° que apenas para teste, funcionaria desta forma?
> 
> ```
> {
>   "functions": {
>     "*": {
>       "includeFiles": "*"
>     }
>   }
> }
> ```

kkkk √≥timo teste @rodrigoKulb üòÇ  Eu preciso dar um g√°s no v√≠deo de segunda, ent√£o vou segurar esse e outros testes at√© que consiga terminar o v√≠deo ü§ù 



> EDIT: Assim que tivermos um "minimal repro", posso perguntar pro core team o que seria a melhor alternativa, e se isso √© um bug no framework ou na plataforma.

@paulogdm fechado! Uma coisa que eu investigaria porque realmente ta estranho √© porque eu n√£o consigo mais `Promote to Production` o deploy da data em que tudo isso estava funcionando. N√£o sei se √© esperado quebrar por ser um deploy relativamente antigo. Olha s√≥ os logs do build que estranho: https://vercel.com/tabnews/tabnews/Fq2bc3qiRVRF2hTkbxsPK2LKUwCt



> Vamos testar isso aqui?
> [vercel/next.js#8251 (comment)](https://github.com/vercel/next.js/issues/8251#issuecomment-915287535)

Interessante!! Eu n√£o entendi exatamente como aplicar isso: √© s√≥ quest√£o de colocar isso no next.config.js, bumpar para a vers√£o canary, e fazer refer√™ncia normal aos arquivos usando o process.cwd()? Bom, preciso voltar para o v√≠deo aqui üòÇ mas topo total testar isso üëç

>> Coment√°rio de rodrigoKulb:
> Vamos testar isso aqui?
> [vercel/next.js#8251 (comment)](https://github.com/vercel/next.js/issues/8251#issuecomment-915287535)

@paulogdm e @filipedeschamps subi meu fork para Vercel, para fazer alguns testes. E a dica do Paulo funcionou aqui!!üéâÔ∏èüéâÔ∏è

https://tabnews-com-br-tabnews-rodrigo.vercel.app/api/v1/migrations

Apenas adicionei o `experimental: { nftTracing: true }` no `next.config.js` j√° vou criar uma PR para corre√ß√£o da falha.

>> Coment√°rio de filipedeschamps:
Que not√≠cia SENSACIONAAAAAAAAL üòç üòç üòç üòç üòç üòç üòç üòç üòç

>> Coment√°rio de filipedeschamps:
@rodrigoKulb e @paulogdm MUITO obrigado pela ajuda e eu n√£o esperava que esse problema ia ser resolvido t√£o r√°pido, que sensacional üòç 

Ta tudo funcionando, e j√° em produ√ß√£o: https://www.tabnews.com.br/api/v1/migrations (deve retornar um array em branco)

Voc√™s s√£o sensacionais ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps foi uma aventura, n√£o consegui dormir direito sabendo que n√£o t√≠nhamos resolvido. Acabei achando um banco de dados free. Com limite de 20Mb e 5 conex√µes simult√¢neas. Para um projeto em desenvolvimento funciona bem! Vou deixar o link aqui!

https://www.elephantsql.com/

>> Coment√°rio de brunofamiliar:
Nossa, andei muuito sumido por aqui. Voc√™s s√£o fera pessoal!! Preciso me atualiza

>> Coment√°rio de filipedeschamps:
Sa√≠mos mais fortes dessa üí™
</issue_120_Migrations n√£o est√£o mais sendo rodadas>

<issue_122_D√∫vida para rodar as migrations em ambiente local>
Ol√° pessoal, estou tentando rodar uma migration para criar a tabela users, porem se utilizo a URL http://localhost:3000/api/v1/migrations ele informa que rodou normal, porem n√£o cria a tabela e tamb√©m n√£o apresenta nenhum erro:
![Captura de tela em 2021-09-07 12-40-20](https://user-images.githubusercontent.com/5334261/132373372-26a60edb-e736-4030-b434-aa7d063f01bc.png)
![Captura de tela em 2021-09-07 12-36-28](https://user-images.githubusercontent.com/5334261/132373265-db56fc44-f174-49ef-b7f1-63c8e66a1dbd.png)


Fiz o teste rodando o comando manualmente e funcional normal:
![Captura de tela em 2021-09-07 12-43-19](https://user-images.githubusercontent.com/5334261/132373584-e44516b2-2c49-4233-a3d0-fe3cf84126b3.png)
![Captura de tela em 2021-09-07 12-44-00](https://user-images.githubusercontent.com/5334261/132373675-12a9d2ee-42cd-4bdb-b05e-c834194b5176.png)

Algu√©m sabe o que pode ser?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb voc√™ est√° dando um `GET` ou `POST` na rota das migrations? Pois o `GET` ir√° visualizar as migrations pendentes, enquanto o `POST` ir√° rodar elas de fato üëç

>> Coment√°rio de rodrigoKulb:
> um `GET` ou `POST` na rota das migrations? Pois o `GET` ir√° visualizar as migrations pendentes, enquanto o `POST` ir√° rod

Hahahaha!!! Isso que da n√£o prestar aten√ß√£o na LIVE!

>> Coment√°rio de filipedeschamps:
hahahah tranquilo! Uma regra pra lembrar √©: todo `GET` n√£o pode mudar nada daquele recurso üëç
</issue_122_D√∫vida para rodar as migrations em ambiente local>

<issue_123_Migrations op√ß√£o -> Up / Down>
@filipedeschamps outra quest√£o que estava verificando √© que hoje temos um script para subir as migrations, ele roda somente o UP ideal ter uma op√ß√£o para rodar o DOWN.
Exemplo:
http://localhost:3000/api/v1/migrations (POST['tipo']=='up' ou em branco)
http://localhost:3000/api/v1/migrations (POST['tipo']=='down')

>> Coment√°rio de rodrigoKulb:
Finalizando essa Inssue, j√° estamos resolvendo isso com o "**orchestrator**"

>> Coment√°rio de filipedeschamps:
Fala @rodrigoKulb voltando pra essa issue que eu atropelei üòÇ 

N√£o sou muito a favor da a√ß√£o de `down` nas migrations para ser sincero e isso se consolidou depois que esbarrei num cara chamado Nick Craver e como eles fazem no Stack Overflow:

https://nickcraver.com/blog/2016/05/03/stack-overflow-how-we-do-deployment-2016-edition/#database-migrations

> Rollbacks. We rarely do them. In fact, I can‚Äôt remember ever having done one. ... If we needed to reverse something, we could just push another migration negating whatever we did that went boom. ... Why roll back when you can roll forward?

Em paralelo, tem mais isso:

https://laraveldaily.com/still-need-migrations-taylor-says-no/

>> Coment√°rio de rodrigoKulb:
@filipedeschamps show, realmente tive que fazer isso no inicio para rodar novamente as migrations, o orchestrator.dropAllTables(), n√£o √© de uma certa forma esse down?

>> Coment√°rio de filipedeschamps:
Bom ponto meu caro! Sob um √¢ngulo √© sim üëç
</issue_123_Migrations op√ß√£o -> Up / Down>

<issue_132_GitHub Actions - Habilitar o uso do cache npm/node_modules>
O que acham de habilitarmos o cache do npm/node_modules?

Percebi que tanto no `tests.yml` e no `lint-styles.yml` nao esta sendo utlizado essa funcao de cache do Github. 

"Workflow runs often reuse the same outputs or downloaded dependencies from one run to another. For example, package and dependency management tools such as Maven, Gradle, npm, and Yarn keep a local cache of downloaded dependencies.

Jobs on GitHub-hosted runners start in a **clean virtual environment and must download dependencies each time**, causing increased network utilization, longer runtime, and increased cost. To help speed up the time it takes to recreate these files, **GitHub can cache dependencies you frequently use in workflows.**"

https://docs.github.com/en/actions/advanced-guides/caching-dependencies-to-speed-up-workflows


```
- uses: actions/setup-node@v2
  with:
    node-version: "14"
```

- Utilizar o cache poderia diminuir o tempo que o step `npm ci` leva
- Como para cada PR executamos esse comando 2x uma atraves to lint e outra dos tests esse cache poderia ser compartilhado entre esses workflows.

A action `setup-node@v2` ja provem uma forma mais simplificada de utilizar esses caches do github e esta explicado aqui:
https://github.com/actions/setup-node#caching-packages-dependencies

Example:

```
- uses: actions/setup-node@v2
  with:
    node-version: '14'
    cache: 'npm'
```

Desculpa pela falta de acentuacao, meu teclado esta em ingles :)

>> Coment√°rio de filipedeschamps:
Sensacional @andrefd17 seria muito show receber um PR com essa melhoria üòç

>> Coment√°rio de filipedeschamps:
Closed by #144
</issue_132_GitHub Actions - Habilitar o uso do cache npm/node_modules>

<issue_134_Nova funcionalidade no github Inssue / Project (Beta)>
Hoje pela manh√£ recebi um e-mail do Github com uma nova funcionalidade, para gerenciar as Inssues em forma de projeto, j√° fiz uns testes achei bem legal, n√£o sei se liberou para todos os usu√°rios, estou compartilhando aqui, pois lembro que est√°vamos procurando isso em alguma Inssue que j√° foi finalizada.

**Segue o link da land page falando sobre ela!**
https://github.com/features/issues
![Captura de tela em 2021-10-15 11-40-04](https://user-images.githubusercontent.com/5334261/137506116-1f353e23-5d4c-4358-b084-82aea0a13418.png)

>> Coment√°rio de rodrigoKulb:
Vai ser possivel criar workflows, conforme altera√ß√µes ele muda o status dentro do projeto da atividade.
![Captura de tela em 2021-10-21 17-53-22](https://user-images.githubusercontent.com/5334261/138355106-de2d6a30-00ed-4249-bb2f-c3ad2231f333.png)

>> Coment√°rio de rodrigoKulb:
Estou finalizando essa Inssue, pois era somente para mostrar a nova funcionalidade do github!

>> Coment√°rio de filipedeschamps:
Show Rodrig√£o!! Foi impressionante ver o quanto o Github evoluiu r√°pido depois da aquisi√ß√£o da Microsoft ü§ù  vamos ver o que vai acontecer agora com a troca do CEO üëç
</issue_134_Nova funcionalidade no github Inssue / Project (Beta)>

<issue_164_TODOs diversos do TabNews>
Turma, tudo bem? Vou come√ßar a juntar aqui alguns afazeres de manuten√ß√£o geral do TabNews. Quem quiser participar ser√° super bem vindo e ser√£o uma √≥tima oportunidade para rodar o projeto na m√°quina e fazer alguma altera√ß√£o ü§ù 

A lista naturalmente vai come√ßar pequena, mas vou juntando aqui os itens üëç 

# Reorganizar o nome dos jobs na Action do Github
- [x] **Feito por @andrefd17 no #165**

Hoje quando roda alguma action, o resultado est√° assim:

![image](https://user-images.githubusercontent.com/4248081/151264046-531cf94c-5f69-4d09-adc9-320b29fbdb34.png)

Os nomes est√£o um pouco redundantes, seria legal deixar mais simples, por exemplo:

```
CI / Tests (pull_request)
CI / Lint Styles (pull_request)
CI / Lint Commits (pull_request)
```

# Reduzir o tempo do Build

- [ ] **Feito**

Olha s√≥ que interessante, nos testes automatizados, o comando que mais demora **(1m32s)** √© o build do `next` pelo comando `npm run build`:

![image](https://user-images.githubusercontent.com/4248081/151264406-f00589f0-26ce-41ac-9705-cb7f035aa866.png)

Eu especulo que isso esteja acontecendo porque ao inv√©s de colocarmos as imagens no `/public` e chamar elas na p√°gina de uma forma tradicional, a gente processa elas de forma din√¢mica por aquele recurso novo l√° que manda pra CDN e otimiza tudo usando o componente `<Image>`.

Sugiro remover isso, hospedar e chamar as imagens tradicionalmente, para ver se isso contribui na velocidade do build.

# Usar SWC para acelerar desenvolvimento e build

- [x] **Feito no #173 mas n√£o teve efeito esperado, ent√£o n√£o foi merged**

O @andrefd17 notou que n√£o estamos usando o novo `SWC`, que √© um novo compilador feito em Rust e que acelera muito a compila√ß√£o de JavaScript. Ele n√£o est√° sendo usado, pois temos um `.babelrc` customizado. Podemos investigar o que ele faz e o que acontece se tirar.

![image](https://user-images.githubusercontent.com/4248081/151268894-ffdb92c4-d3ce-4f76-9bd4-5a3699b8b031.png)

# Usar cache do Actions no build

- [x] **Feito por @andrefd17 no #167**

Utilizar o pr√≥prio recurso de cache do Github Actions.

>> Coment√°rio de andrefd17:
@filipedeschamps pode deixar o rename das actions comigo ü§ù 

Quanto ao tempo do `npm run build` olhando o timestamp desse commando na screenshot abaixo da pra ver que passa 1 minuto no trecho em highlight. 

![image](https://user-images.githubusercontent.com/26145982/151266331-4fc4fe23-9eca-4652-8402-3f83009dd0ea.png)

Como n√£o entendo nada de NextJS, seria nesse step que ele iria realizar o processo de otimizar as imagens?

>> Coment√°rio de filipedeschamps:
@andrefd17 n√£o fa√ßo a m√≠nima ideia, mas ele est√° avisando algo importante ali, de n√£o usar o novo SWC pelo fato de termos uma configura√ß√£o do Babel customizada. Mais para frente poderemos ver isso, porque ajustar esse ponto vai contribuir numa velocidade global do projeto ü§ù  vou at√© em seguida criar um TODO para isso üëç 

Em paralelo, nota ali em cima o `warn` de `No build cache found`. Podemos investigar isso tamb√©m üëç

>> Coment√°rio de andrefd17:
> @andrefd17 n√£o fa√ßo a m√≠nima ideia, mas ele est√° avisando algo importante ali, de n√£o usar o novo SWC pelo fato de termos uma configura√ß√£o do Babel customizada. Mais para frente poderemos ver isso, porque ajustar esse ponto vai contribuir numa velocidade global do projeto handshake vou at√© em seguida criar um TODO para isso +1
> 
> Em paralelo, nota ali em cima o `warn` de `No build cache found`. Podemos investigar isso tamb√©m +1

Encontrei isso aqui (sobre o `No build cache found`) da Vercel e acho que pode ser um ponto de partida para diminuir o tempo de build -> https://github.com/vercel/next.js/blob/canary/errors/no-cache.md

Esse √© o exemplo deles pro GitHub Actions:

```
uses: actions/cache@v2
with:
  path: ${{ github.workspace }}/.next/cache
  # Generate a new cache whenever packages or source files change.
  key: ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-${{ hashFiles('**.[jt]s', '**.[jt]sx') }}
  # If source files changed but packages didn't, rebuild from a prior cache.
  restore-keys: |
    ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-
```

>> Coment√°rio de rodrigoKulb:
Eu instalei o [next-progressbar](https://github.com/lucleray/next-progressbar), e ao rodar o build acabou apresentando um pouco mais de detalhes, porem ainda n√£o da para identificar onde est√° o gargalo, procurei na internet se conseguimos debugar esse **Compiled client in 15s** ou **Compiled server in 22s** mas n√£o localizei nada.

Resultado com [next-progressbar](https://github.com/lucleray/next-progressbar):
info  - Using external babel configuration from /home/rodrigo/Dropbox/Projetos/rodrigoKulb/tabnews.com.br/.babelrc
info  - Creating an optimized production build ...
**Compiled client in 15s**
Compiling client
info  - Creating an optimized production build ..
**Compiled client in 2s**
Compiling server
info  - Creating an optimized production build ...
**Compiled server in 22s**
Compiling server
info  - Creating an optimized production build ..
Compiled server in 478ms
info  - Creating an optimized production build  
info  - Compiled successfully
info  - Collecting page data  
info  - Generating static pages (21/21)
info  - Finalizing page optimization

>> Coment√°rio de filipedeschamps:
Interessante @rodrigoKulb ! 22 + 15 = 37 √© bastante segundos para o tamanho atual da aplica√ß√£o, mas de fato pelos logs ali n√£o deu para identificar de uma forma mais detalhada.

Testei aqui removendo o cache `.next` e fazendo um build com a lista completa dos participantes, e com 1 participante e **n√£o deu nenhuma diferen√ßa consider√°vel** no tempo de build, ent√£o isso quebra a minha teoria (ou eu n√£o testei certo). De qualquer forma, eu removeria esse recurso de <Image> e deixaria tudo est√°tico porque lembro que ele foi o motivo de ter ultrapassado uma quota e fazer o projeto sair do plano gratuito para o plano pago.

>> Coment√°rio de andrefd17:
Achei algo interessante a respeito do cache do node-modules que poderia ajudar a gente a reduzir o tempo do `npm ci` que no momento esta em torno de 45 segs

https://docs.github.com/en/actions/advanced-guides/caching-dependencies-to-speed-up-workflows#example-using-the-cache-action

Irei abrir uma PR pra gente testar essa possibilidade tbm üëçüèª

>> Coment√°rio de filipedeschamps:
Pessoal, muito obrigado pela contribui√ß√£o de todos nessa issue! Estou fechando mesmo com ela incompleta, porque se o todo do build for importante, ele vai ser repescado naturalmente ü§ù
</issue_164_TODOs diversos do TabNews>

<issue_171_Melhorias de seguran√ßa/privacidade dos usu√°rios>
**NOTA PR√âVIA:** Estas sugest√µes n√£o precisam ser aplicadas at√© que o projeto esteja em produ√ß√£o. Como est√°, facilita na hora de fazer testes.

A rota que lista usu√°rios deve ser protegida para evitar problemas de seguran√ßa, nomeadamente [Enumeration Attacks](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account) 
(TL:DR: n√£o deve ser poss√≠vel verificar que um determinado login existe)


Assim, deixo as minhas propostas aqui:

- [x] #181
- [x] ~1.1 - A permiss√£o `read:users` deve ser dada apenas a quem necessita dela~
- [x] #185
- [x] #182
- [ ] #186
- [x] #183
- [x] #184

--- 

Notas

- 1 - A rota `GET /api/v1/users` deveria ser validada com a permiss√£o `read:users`. 

  Listar todos os usu√°rios existentes no banco permite fazer um ataque por enumera√ß√£o. Por exemplo, eu pego em toda a lista de usu√°rios, e para cada um deles, eu fa√ßo um brute-force das senhas mais comuns. Em 1000 usu√°rios, n√£o acredito que n√£o haja um com a senha "123456" ou "q1w2e3r4t5y6."

  (1.1) Essa permiss√£o deve ser dada apenas a usu√°rios que precisem ter essa listagem, n√£o deve ser dada a todos os usu√°rios existentes ([Principle of Least Privileges](https://en.wikipedia.org/wiki/Principle_of_least_privilege)) 

- 2 - Usar o email+senha para login (bloquear user+senha)

  N√≥s j√° consideramos o email como um dado privado. Podemos usar ele na autentica√ß√£o (ou seja, email+password).
  Isso tem duas vantagens: 
  - podemos usar o campo user em todo o lugar sem estarmos preocupados que seja um dado privado  
  - podemos listar todos os usu√°rios, se as regras de neg√≥cio entenderem essa necessidade


- 3 - A rota `POST /api/v1/sessions` deveria apenas retornar sim (com token) ou n√£o. 
  Neste momento, a rota devolve 3 respostas diferentes:
  - Usu√°rio n√£o existe
  - Usu√°rio existe mas tem senha errada
  - Autentica√ß√£o bem sucedida
  
  Isto permite eu saber se um usu√°rio existe no sistema, e isso permite ataques por enumera√ß√£o.
  A minha sugest√£o √© ter apenas duas respostas poss√≠veis:
  - Senha errada ou usu√°rio n√£o existente
  - Autentica√ß√£o bem sucedida

- 4 - A valida√ß√£o de usu√°rio+senha deve ter um tempo de resposta consistente
  Ao inv√©s de procurar o usu√°rio no banco e depois validar se essa senha √© a correta, eu sugiro validar tudo em apenas uma query.

  ```js
  const query = {
    text: 'SELECT * FROM users WHERE LOWER(username) = LOWER($1) AND password = $2 LIMIT 1;',
    values: [username, hashedPassword],
  };
  ```
  Na verdade, este n√£o √© um problema e aumenta o c√≥digo, mas vale ponderar se em vez de usarmos o `findOneByUsername(user)` + valida√ß√£o de senha, dever√≠amos usar um m√©todo exclusivo para login `findUsernameWithPassword(user, password)`

>> Coment√°rio de filipedeschamps:
Sensacionaaaaal @tcarreira !!!!! Vou adicionar mais um item e depois fazer meus coment√°rios:

- [ ] 5 - Cobrir de testes casos de n√£o sucesso, por exemplo: 1. criar conta; 2. n√£o ativar; 3. tentar fazer login
- [ ] 6 - Proteger todas as rotas com verifica√ß√£o de features e filtros de entrada e sa√≠da de dados

>> Coment√°rio de filipedeschamps:
Meus coment√°rios sobre os pontos:

## 1 - A rota `GET /api/v1/users` deveria ser validada com a permiss√£o `read:users`
Excelente ponto, eu me peguei um bom tempo decidindo qual seria a permiss√£o padr√£o para isso üòÇ  optei por deixar liberado (com dados sens√≠veis escondidos) porque o Github faz o mesmo e ainda oferece uma API fant√°stica de busca: [Listar todos os usu√°rios do Brasil](https://github.com/search?l=&o=desc&q=location%3Abrasil&s=followers&type=Users). Eu concordo tamb√©m que isso √© estranho e eu mesmo j√° implementei crawlers no passado pra montar lista de desenvolvedores que eu gostaria de contatar. Mas por outro lado, eu j√° vi outras ferramentas curiosas serem constru√≠das em cima disso, como rankings que misturam informa√ß√µes de outros lugares.

Mas n√£o sei realmente o que decidir, porque por um lado d√° medo, mas por outro lado deixar liberado tamb√©m d√° oportunidade de surgir solu√ß√µes muito legais.

Sobre o brute-force, √≥timo ponto, mas isso precisa ser resolvido na raiz e que √© com rate-limiting, banimento de ip, ou servi√ßos como os da Cloudflare pra pegar ataques mais complexos.

Mas de qualquer forma, o que fazer? üòÇ Deixar a lista dispon√≠vel para criarem solu√ß√µes novas, bloquear total, ou liberar por pedido? Acho que por pedido √© mais seguro por enquanto, n√©?

Se quiser fazer PR ajustando isso direto na migration seria show ü§ù  eu vou resetar o status do banco todo antes de subirmos a vers√£o final dessa milestone üëç  e se eu n√£o me engano, vai quebrar o teste que lista os usu√°rios, pois ele ta no modo antigo (assumindo tudo p√∫blico, usu√°rio sem autentica√ß√£o). Se quiser dar um skip nele fique a vontade, eu vou refatorar todos os testes velhos.

>> Coment√°rio de filipedeschamps:
## 2 - Usar o email+senha para login (bloquear user+senha)
Interessante abordagem! Me deixou pensando bastante aqui porque isso pode ser um passo de volta ao login por email (magic link), onde a pessoa pode optar por fazer login recebendo um link por email, ou email + senha como comentou. N√£o vamos deixar esse t√≥pico morrer, ok?

>> Coment√°rio de filipedeschamps:
## 3 - A rota `POST /api/v1/sessions` deveria apenas retornar sim (com token) ou n√£o
Excelente ponto! Ent√£o esse controle tem que ser feito dentro do controller mesmo, praticamente envolver tudo num grande `try/catch` e se for algum erro de n√£o encontrar usu√°rio ou senha n√£o confere, devolver tudo padronizado no `catch` com um `UnauthorizedError`.

Acho que esse controller pode dar throw no total em `NotFoundError`, `ForbiddenError` e `UnauthorizedError`. Ent√£o se forem esses os tipos dos erros, a gente d√° throw num `UnauthorizedError` √∫nico e gen√©rico. Se n√£o, a gente da throw no objeto de erro de novo, porque pode ser algum erro interno ou de servi√ßo, esse "re-throw" vai fazer cair l√° no final do controller, na centraliza√ß√£o dos erros. J√° da pra abrir PR com isso tamb√©m üòç

>> Coment√°rio de filipedeschamps:
## 4 - A valida√ß√£o de usu√°rio+senha deveria ser feita atomicamente no banco

Ahhh que abordagem massa! **Eu nunca teria pensado nisso** ü§ù üòç 

Um detalhe que n√£o sei se dever√≠amos considerar √© que gerar o `hash` (dado ao n√∫mero de rounds que usamos para o `salt`),  √© uma opera√ß√£o custosa. Como expliquei [nesse item do di√°rio](https://github.com/filipedeschamps/tabnews.com.br/wiki/031.-Hash-das-passwords) e vendo agora no ambiente da Vercel, verificar a senha leva uns `3 segundos` (arredondando pra cima), versus verificar se o usu√°rio existe e tem a feature que ta dando uns `200ms` (isso √© feito antes de construir o hash).

Somente se o usu√°rio existe e tem a feature √© que pagamos o custo de gerar o hash.

E agora?

>> Coment√°rio de tcarreira:
> Sensacionaaaaal @tcarreira !!!!! Vou adicionar mais um item e depois fazer meus coment√°rios:
> 
> * [ ]  5 - Cobrir de testes casos de n√£o sucesso, por exemplo: 1. criar conta; 2. n√£o ativar; 3. tentar fazer login
> * [ ]  6 - Proteger todas as rotas com verifica√ß√£o de features e filtros de entrada e sa√≠da de dados

Atualizei o post original para incluir esses pontos.
Depois vale converter cada ponto para uma issue independente (j√° vou fazer para os pontos mais claros)


---

> ## 1 - A rota `GET /api/v1/users` deveria ser validada com a permiss√£o `read:users`
> Mas n√£o sei realmente o que decidir, porque por um lado d√° medo, mas por outro lado deixar liberado tamb√©m d√° oportunidade de surgir solu√ß√µes muito legais.
>
> Sobre o brute-force, √≥timo ponto, mas isso precisa ser resolvido na raiz e que √© com rate-limiting, banimento de ip, ou servi√ßos como os da Cloudflare pra pegar ataques mais complexos.
> 
> Mas de qualquer forma, o que fazer? üòÇ Deixar a lista dispon√≠vel para criarem solu√ß√µes novas, bloquear total, ou liberar por pedido? Acho que por pedido √© mais seguro por enquanto, n√©?

Acho que deixar ele acess√≠vel a todo o mundo, juntando com rate-limiting (que √© claramente a coisa certa a fazer üëç) e com o ponto 2 (login com email+senha), fica uma solu√ß√£o segura e vers√°til.

---

> ## 4 - A valida√ß√£o de usu√°rio+senha deveria ser feita atomicamente no banco
> Somente se o usu√°rio existe e tem a feature √© que pagamos o custo de gerar o hash.

Se o request de um usu√°rio existente √© muito mais lento que o de um usu√°rio que n√£o existe, ent√£o fica f√°cil saber qual a raz√£o da recusa üòÑ .
Mas concordo em deixar a rota de login **mais barata para o projeto**, n√£o calculando o hash se n√£o for necess√°rio (mas √© um custo bem marginal). 

Se quisermos ser muito estritos com a preven√ß√£o de "timing-based attacks", este √© um √≥timo caso para adicionar um **sleep** no c√≥digo üòÇ 
Se o usu√°rio existir, calcula o hash; se ele n√£o existir, faz um sleep de 2~3s. 
Assim a rota √© consistentemente lenta üòâ )

>> Coment√°rio de filipedeschamps:
Sensacional a ideia de ser consistentemente lento, pois inclusive isso atrasa o ataque sem penalizar a infra (dado que em Node.js essa parte est√° tudo async e pendurar uma conex√£o n√£o vai ser problema).

>> Coment√°rio de filipedeschamps:
@tcarreira terminei o PR que inibe um usu√°rio alterar as informa√ß√µes do outro, mas me deu uma coceirinha:

`update:user`
`update:user:others`

Essa √∫ltima feature vai lhe dar o poder de alterar outro usu√°rio, por√©m o nome ta feio e no TabNews n√£o deixamos as coisas feias ü§ù

Lembro que na issue da Autoriza√ß√£o voc√™ tinha feito uma ordena√ß√£o de come√ßar pelo recurso e depois para a√ß√£o, ent√£o ficaria algo como:

```
user:update
user:update:others
```

To come√ßando a achar que de fato √© mais bonito. O que voc√™ acha?

E nos controllers ficaria assim (antigo/novo):

```js
.patch(authorization.canRequest('update:user'), patchHandler);

.patch(authorization.canRequest('user:update'), patchHandler);
```

N√£o fica a mesma leitura... na minha vis√£o o antigo ficava melhor porque eu lia em voz alta "Can this request update the user?"

Mas n√£o sei, acho que numa organiza√ß√£o de features fica mais f√°cil de ler. Novamente se puder responder, o que voc√™ acha?

>> Coment√°rio de tcarreira:
> Novamente se puder responder, o que voc√™ acha?

Eu j√° tenho uma ideia do que quero responder, mas me deixa encontrar fundamentos e justifica√ß√µes para uma resposta completa ;)

>> Coment√°rio de filipedeschamps:
@tcarreira show meu caro! Eu j√° vou fazer o PR com essa altera√ß√£o (espero estar alinhado com o que vai sugerir, qq coisa fa√ßo de novo), √© que eu quero gravar o v√≠deo de explica√ß√£o com isso alinhado e nesse exato momento lendo a lista de permiss√µes eu j√° fiquei confuso.


**Em paralelo** gostaria de sugerir outra medida de seguran√ßa: remover das mensagens de erro todas as interpola√ß√µes de texto, pois isso pode ser um vetor de ataque. Se n√£o sanitizarmos algum input/output e isso voltar para o client, se o client tamb√©m n√£o sanitizar, √© poss√≠vel emplacar um XSS delicinha.

>> Coment√°rio de filipedeschamps:
@tcarreira feito: https://github.com/filipedeschamps/tabnews.com.br/pull/178

>> Coment√°rio de tcarreira:
**TL:DR:** 

- fiz uma pesquisa por "solu√ß√µes de mercado" n√£o exaustiva (como √© mais natural usarmos permiss√µes em outros servi√ßos?)
- a ordem action resource √© irrelevante
- precisamos modificadores de a√ß√µes ou resources (a minha sugest√£o √© separar com `:` e modificadores com `.`)
- precisamos definir o formato dos modificadores, respondendo √†s permiss√µes no final deste post 

---

# pesquisa

A minha opini√£o pessoal seria `user:update`, e eu pensava que isso era o padr√£o de mercado, MAS parece que n√£o √© bem assim como eu pensava (por isso quis procurar um pouco mais antes de responder), apesar de ser o mais comum.


Tentei ver v√°rios exemplos de projetos p√∫blicos com algum tipo de permiss√µes. 
Acho que o mais f√°cil √© ver os scopes de rotas de OAuth ou OIDC.

O exemplo de [scopes do github](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps#available-scopes), √© como vc sugeriu `update:user`.
O google usa um [padr√£o mais verboso](https://developers.google.com/identity/protocols/oauth2/scopes#youtube), do tipo `https://www.googleapis.com/auth/youtube.readonly` (mas com a a√ß√£o no final)
O [slack](https://api.slack.com/scopes) tamb√©m usa a a√ß√£o no final, como  [`users.profile:write`](https://api.slack.com/scopes/users.profile:write) ou  [`users.profile:write:user`](https://api.slack.com/scopes/users.profile:write:user) 

Qual o problema de basear a minha pesquisa em OAuth ou OIDC? Todos eles s√£o orientados a acesso de conte√∫dos por terceiros, e n√£o est√£o preparados para permiss√µes de administra√ß√£o sobre os dados de um banco üòÖ 

Podemos olhar para clouds (que t√™m um esquema de pol√≠ticas de ACL bem mais complexas) e pegar em ideias:
A [AWS](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_aws-dates.html) usa `service-prefix:action-name` em conjunto com um *resource* (declarados separadamente).
Ou a [GCP](https://cloud.google.com/iam/docs/manage-access-other-resources) que abstrai as permiss√µes em roles, tais como `compute.instances.get` 

---

# conclus√µes?

Eu acho interessante ter a a√ß√£o primeiro, para ser mais f√°cil ler por humanos. 
Mas quero a versatilidade de poder definir um controlo fino quer da a√ß√£o, quer do resource.

Esta √© a minha proposta (podemos trocar a ordem):
```
ACTION[.AMODIFIER]:RESOURCE[.RMODIFIER]
RESOURCE[.RMODIFIER]:ACTION[.AMODIFIER]
```
Ou seja, separar a√ß√£o e resource com `:` e ter possibilidade de modificar qualquer um dos campos com um separador `.`.
Este formato permite ter a a√ß√£o no in√≠cio ou no fim.

exemplos:

```js
/***** <ACTION:RESOURCE> ******/
"update:user" // update my user
"update.all:user" // update all users
"read:user" // read my user
"read.all:user.email" // read everyone's email

/***** <RESOURCE.ACTION> ******/
"user:update" // update my user
"user:update.all" // update all users
"user:read" // read my user
"user.email:read.all" // read everyone's email
```

---

A vantagem de ter a resource no in√≠cio, √© podermos ordenar alfabeticamente e ficar tudo organizado.
A vantagem de ter a action no in√≠cio, √© podermos ler mais naturalmente.
De qualquer forma, n√£o me parece ser muito relevante esta escolha de ordem. Acho mais relevante os modificadores.

Mas...
Esta forma pode trazer uma confus√£o para novos contribuidores (s√≥ depois dos contribuidores antigos j√° estarem esclarecidos üòÇ )

Por exemplo, qual a "permiss√£o para editar todos os usu√°rios?"
```js
"update:users" // √© f√°cil errar, escrevendo users em vez de user, e dar permiss√µes que n√£o devia
// ser√° que o all dever√° estar atrelado √† a√ß√£o?
"update.all:user" // update all users. Ser√° que inclui apenas os campos p√∫blicos? ou....
"update.all:user.public" // ...devemos ser expl√≠citos quando queremos limitar permiss√µes?
"update.all:user.all" // permiss√£o para editar todos os campos de todos os usu√°rios
"update.all:user.fields.email" // permiss√£o para editar o email de todos os usu√°rios? (n√£o gosto muito desta)
// ou ser√° que o all deve estar atrelado ao resource?
"update:user.all" // update all users. (todos os campos do meu usu√°rio? ou todos os usu√°rios)
"update:user.all.public" // hum, parece-me confuso dizer que quero editar apenas os campos p√∫blicos de todos os usu√°rios

```

---

Dada esta confus√£o que eu mesmo criei, acho que para decidirmos o formato a escolher, dev√≠amos escolher um formato que permita atender as seguintes permiss√µes (n√£o exaustivo):
- ler o meu usu√°rio
- ler todos os usu√°rios, mas s√≥ os conte√∫dos p√∫blicos
- ler todos os usu√°rios, incluindo email
- ler todos os usu√°rios, incluindo todos os campos p√∫blicos e privados
- editar meu usu√°rio
- editar todos os usu√°rios, com exce√ß√£o do email
- editar todos os usu√°rios, apenas informa√ß√µes p√∫blicas
- listar todos usu√°rios (pode ser diferente de ler usu√°rios. ler todos pode n√£o incluir enumera√ß√£o)
- editar artigos de outros usu√°rios
- editar artigos com menos de 100 visualiza√ß√µes (este j√° √© demasiado) 

considera√ß√£o final: ser√° que vale definir isto agora? ou √© uma coisa f√°cil de refatorar no futuro quando/se for necess√°rio? 
O uso de separadores diferentes, permite extender a funcionalidade das a√ß√µes, para atender a √∫ltima permiss√£o (por exemplo `edit.all:articles.with{seen__lt=100}` em que seja poss√≠vel parsear permiss√µes com `with{}` ü§∑ com uma DSL)

---

Nota final: estou na d√∫vida se estamos usando roles mascarados de permiss√µes. 
Mas acho que s√≥ conseguimos esta resposta depois de ver como o sistema √© usado ü§î .

>> Coment√°rio de tcarreira:
Criei as v√°rias sub-issues para fazer as corre√ß√µes/sugest√µes de forma modular.

Muito provavelmente eu n√£o vou ter tempo de implementar nenhuma, j√° estoirei o meu plafond de tempo para este projeto h√° algum tempo üòÖ 
Mas queria deixar isto um pouco mais organizado.

(espero continuar respondendo aos coment√°rios, mas ser√° na medida do poss√≠vel)

>> Coment√°rio de liverday:
@filipedeschamps Como est√° o andamento das tarefas? Podemos pegar qualquer uma para contribuir com o PR? Estou livre de algumas tarefas que eu tinha e gostaria muito de contribuir com essas.

>> Coment√°rio de filipedeschamps:
@liverday show!!! Tem uma tarefa que seria √≥tima fazer antes da live de encerramento que √© sobre trocar o login de username para email: https://github.com/filipedeschamps/tabnews.com.br/issues/185

Em paralelo, vou tomar uma decis√£o sobre o que fazer com os nomes das features, e o que estou mais favor√°vel pro enquanto √© `action:resource:extra` ... mantendo o padr√£o do separador com `:` para facilitar a leitura. Vou fazer uns testes aqui ü§ù 

E @liverday essa altera√ß√£o n√£o deveria impedir a implementa√ß√£o ali de cima caso queira fazer. E caso n√£o queira, me avise ü§ù

>> Coment√°rio de liverday:
Fechado @filipedeschamps, vou dar andamento nessa tarefa e te mantenho informado sobre o andamento!

>> Coment√°rio de filipedeschamps:
@liverday show de bola meu caro!!!! üòç 

Em paralelo, mais um item para lista de seguran√ßa: https://twitter.com/leeerob/status/1381605537742254082

[edit] informa√ß√µes mais detalhadas aqui: https://nextjs.org/docs/advanced-features/security-headers

>> Coment√°rio de Lulusidev:
Ha alguma tarefa nessa issue que um iniciante pode concluir do inicio ao fim? :)

>> Coment√°rio de liverday:
@Lulusidev acredito que a #182 √© algo que d√° pra fazer, apesar de ser necess√°rio entender parte da estrutura de pastas do projeto. Mas pode ser uma boa entrada pra voc√™ conhecer mais sobre o projeto e fazer uma contribui√ß√£o do in√≠cio ao fim.

>> Coment√°rio de tcarreira:
> acredito que a #182 √© algo que d√° pra fazer

Eu acho que essa issue foi resolvida com o #201. Pelo menos eu entendi isso dos [coment√°rios no PR](https://github.com/filipedeschamps/tabnews.com.br/pull/201#issuecomment-1051127268).

Vou at√© fechar a issue. 
Se eu estiver enganado, volto a abrir

>> Coment√°rio de filipedeschamps:
Correto pessoal!

Isso foi implementado (mas sempre pode ser revisitado dado a import√¢ncia do assunto), e os testes que garantem a mesma mensagem para os dois casos diferentes est√£o aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/c22664fc32d690b140a043cf90165d2fda208d15/tests/api/v1/sessions/post.test.js#L89-L153

>> Coment√°rio de filipedeschamps:
@Lulusidev em cima disso, uma tarefa que pode ser implementada √© a #186 onde dentro do `catch` ali abaixo, antes do `throw`, poderemos adicionar uma demora falsa:

https://github.com/filipedeschamps/tabnews.com.br/blob/c22664fc32d690b140a043cf90165d2fda208d15/pages/api/v1/sessions/index.public.js#L36-L47

O que acha?

√â uma implementa√ß√£o simples, vai fazer voc√™ entender mais do fluxo de autentica√ß√£o, e √© extremamente importante para enganar os atacantes.

>> Coment√°rio de Lulusidev:
@filipedeschamps vou tentar,vou vascular mais a estrutura do projeto e depois voltar essa issue.
Alias,como que eu referencio uma parte do codigo aqui nos comentarios ?

>> Coment√°rio de filipedeschamps:
Voc√™ abre o c√≥digo aqui por dentro do Github, clica na linha que deseja destacar (e se quiser m√∫ltiplas linhas, depois de clicar na primeira, segure o shift e clique at√© onde quer que seja selecionado), depois clique nas 3 bolinhas e escolha a forma permanente de link:

<img width="663" alt="image" src="https://user-images.githubusercontent.com/4248081/155853855-2c8db0df-d31a-4dfb-88f5-74503193a4d1.png">

>> Coment√°rio de Lulusidev:
@filipedeschamps obrigado felipe :)
vc usa o github no modo claro que CRIME

>> Coment√°rio de filipedeschamps:
@tcarreira vou fechar essa issue, mas vou deixar a #186 aberta, pois vou reaproveitar ela para a pr√≥xima Milestone üëç
</issue_171_Melhorias de seguran√ßa/privacidade dos usu√°rios>

<issue_181_1 - A rota `GET /api/v1/users` deveria ser validada com a permiss√£o `read:users`.>
Listar todos os usu√°rios existentes no banco permite fazer um ataque por enumera√ß√£o. Por exemplo, eu pego em toda a lista de usu√°rios, e para cada um deles, eu fa√ßo um brute-force das senhas mais comuns. Em 1000 usu√°rios, n√£o acredito que n√£o haja um com a senha "123456" ou "q1w2e3r4t5y6."

Essa permiss√£o deve ser dada apenas a usu√°rios que precisem ter essa listagem, n√£o deve ser dada a todos os usu√°rios existentes ([Principle of Least Privileges](https://en.wikipedia.org/wiki/Principle_of_least_privilege))

> Excelente ponto, eu me peguei um bom tempo decidindo qual seria a permiss√£o padr√£o para isso üòÇ optei por deixar liberado (com dados sens√≠veis escondidos) porque o Github faz o mesmo e ainda oferece uma API fant√°stica de busca: [Listar todos os usu√°rios do Brasil](https://github.com/search?l=&o=desc&q=location%3Abrasil&s=followers&type=Users). Eu concordo tamb√©m que isso √© estranho e eu mesmo j√° implementei crawlers no passado pra montar lista de desenvolvedores que eu gostaria de contatar. Mas por outro lado, eu j√° vi outras ferramentas curiosas serem constru√≠das em cima disso, como rankings que misturam informa√ß√µes de outros lugares.
>
> Mas n√£o sei realmente o que decidir, porque por um lado d√° medo, mas por outro lado deixar liberado tamb√©m d√° oportunidade de surgir solu√ß√µes muito legais.
>
> Sobre o brute-force, √≥timo ponto, mas isso precisa ser resolvido na raiz e que √© com rate-limiting, banimento de ip, ou servi√ßos como os da Cloudflare pra pegar ataques mais complexos.
> 
> Mas de qualquer forma, o que fazer? üòÇ Deixar a lista dispon√≠vel para criarem solu√ß√µes novas, bloquear total, ou liberar por pedido? Acho que por pedido √© mais seguro por enquanto, n√©?
> 
> Se quiser fazer PR ajustando isso direto na migration seria show ü§ù eu vou resetar o status do banco todo antes de subirmos a vers√£o final dessa milestone üëç e se eu n√£o me engano, vai quebrar o teste que lista os usu√°rios, pois ele ta no modo antigo (assumindo tudo p√∫blico, usu√°rio sem autentica√ß√£o). Se quiser dar um skip nele fique a vontade, eu vou refatorar todos os testes velhos.

>> Coment√°rio de tcarreira:
Entendo que esta issue j√° est√° tratada aqui 
https://github.com/filipedeschamps/tabnews.com.br/blob/2dde685333840d05ca4499294ffb56120eb613a4/pages/api/v1/users/index.public.js#L15

Vou encerrar a issue. Se eu estiver enganado, me digam

>> Coment√°rio de filipedeschamps:
Sim meu caro! Ainda mais com o ajuste para login por email.

Em paralelo, como essa lista √© p√∫blica, eu estou bem afim de tirar essas permiss√µes p√∫blicas para despoluir a lista de features, fora que isso habilita a gente colocar o resultado (que √© p√∫blico) num cache na CDN e evitar qualquer tipo de computa√ß√£o.
</issue_181_1 - A rota `GET /api/v1/users` deveria ser validada com a permiss√£o `read:users`.>

<issue_182_3 - A rota `POST /api/v1/sessions` deveria apenas retornar sim (com token) ou n√£o.>
Neste momento, a rota devolve 3 respostas diferentes:

- Usu√°rio n√£o existe
- Usu√°rio existe mas tem senha errada
- Autentica√ß√£o bem sucedida

Isto permite eu saber se um usu√°rio existe no sistema, e isso permite ataques por enumera√ß√£o.
A minha sugest√£o √© ter apenas duas respostas poss√≠veis:
- Senha errada ou usu√°rio n√£o existente
- Autentica√ß√£o bem sucedida


> Excelente ponto! Ent√£o esse controle tem que ser feito dentro do controller mesmo, praticamente envolver tudo num grande try/catch e se for algum erro de n√£o encontrar usu√°rio ou senha n√£o confere, devolver tudo padronizado no catch com um UnauthorizedError.
> 
> Acho que esse controller pode dar throw no total em NotFoundError, ForbiddenError e UnauthorizedError. Ent√£o se forem esses os tipos dos erros, a gente d√° throw num UnauthorizedError √∫nico e gen√©rico. Se n√£o, a gente da throw no objeto de erro de novo, porque pode ser algum erro interno ou de servi√ßo, esse "re-throw" vai fazer cair l√° no final do controller, na centraliza√ß√£o dos erros. J√° da pra abrir PR com isso tamb√©m üòç

>> Coment√°rio de tcarreira:
closed by #201
</issue_182_3 - A rota `POST /api/v1/sessions` deveria apenas retornar sim (com token) ou n√£o.>

<issue_183_5 - Cobrir de testes casos de n√£o sucesso, por exemplo: 1. criar conta; 2. n√£o ativar; 3. tentar fazer login>


>> Coment√°rio de filipedeschamps:
@tcarreira vou fechar essa issue e mais para frente criar algo mais abrangente sobre os testes ü§ù
</issue_183_5 - Cobrir de testes casos de n√£o sucesso, por exemplo: 1. criar conta; 2. n√£o ativar; 3. tentar fazer login>

<issue_184_6 - Proteger todas as rotas com verifica√ß√£o de features e filtros de entrada e sa√≠da de dados>


>> Coment√°rio de filipedeschamps:
Agora que notei que isso foi feito quando todo sistema de valida√ß√£o foi refeito üëç
</issue_184_6 - Proteger todas as rotas com verifica√ß√£o de features e filtros de entrada e sa√≠da de dados>

<issue_185_2 - Usar o email+senha para login (bloquear user+senha)>
N√≥s j√° consideramos o email como um dado privado. Podemos usar ele na autentica√ß√£o (ou seja, email+password).
Isso tem duas vantagens:

podemos usar o campo user em todo o lugar sem estarmos preocupados que seja um dado privado
podemos listar todos os usu√°rios, se as regras de neg√≥cio entenderem essa necessidade


> Interessante abordagem! Me deixou pensando bastante aqui porque isso pode ser um passo de volta ao login por email (magic link), onde a pessoa pode optar por fazer login recebendo um link por email, ou email + senha como comentou. N√£o vamos deixar esse t√≥pico morrer, ok?

>> Coment√°rio de liverday:
Realizei a implementa√ß√£o dessa tarefa e submeti um [PR](https://github.com/filipedeschamps/tabnews.com.br/pull/200) para an√°lise!

Fico a disposi√ß√£o para esclarecimentos e pr√≥ximos passos!

>> Coment√°rio de tcarreira:
closed by #201
</issue_185_2 - Usar o email+senha para login (bloquear user+senha)>

<issue_186_A valida√ß√£o de email+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o>
De forma a deixar a rota `/api/v1/sessions` uma black box (ou seja, n√£o ser poss√≠vel saber se um usu√°rio existe ou n√£o atrav√©s do tempo de resposta do servidor), precisamos fazer algumas altera√ß√µes.

Sugest√£o de fluxo de valida√ß√£o de login, em pseudo-c√≥digo
```js
startTime = getMonotonicTime()
targetElapsed = random(2.5, 3.5) // uma dura√ß√£o de tempo aleat√≥ria entre 2.5s e 3.5s

userFromDB = getUserByUsername(requestedUser)
if (userFromDB) {
  isMatch = checkPasswordMatch(userFromDB, requestedPassword)
}

await waitForElapsed(startTime, targetElapsed) // espera at√© terem passado pelo menos entre 2.5s e 3.5s desde o startTime

if isMatch {
  return true
}
return false

```

Vantagens:
- a rota √© consistentemente lenta, previne timing attacks
- o hash da senha s√≥ √© calculado quando o usu√°rio existe (fazer o hash √© caro)
- aquele waitForElapsed() pode ser implementado com um sleep, o que reduz o CPU usado (fica mais barato quando o usu√°rio n√£o existe)

>> Coment√°rio de filipedeschamps:
@coffee-is-power por que essa issue foi fechada?

>> Coment√°rio de coffeeispower:
A feature ja foi implementada

>> Coment√°rio de filipedeschamps:
Onde exatamente?

>> Coment√°rio de coffeeispower:
#171
E tambem essa issue ja esta parada a 2 meses, se o criador da issue quiser voltar e so pedir para abrir

>> Coment√°rio de filipedeschamps:
@coffee-is-power n√£o entendi. Onde no c√≥digo (ou at√© naquela issue), demonstram que **"A valida√ß√£o de usu√°rio+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o"** foi implementado?

>> Coment√°rio de aprendendofelipe:
Edit: Como o login agora utiliza o `email`, e n√£o mais o `username`,  o que eu argumentei abaixo n√£o se aplica. E a implementa√ß√£o sugerida se justifica sim, na verdade, ainda mais do que antes.

Meus 10 centavos para esse assunto √© que n√£o existe justificativa para essa implementa√ß√£o enquanto houverem outras formas simples de obter os usu√°rios v√°lidos, como nesse endpoint:

https://www.tabnews.com.br/api/v1/users

E mesmo se eliminasse a rota acima, bastaria o atacante ir testando esse outro endpoint antes de tentar descobrir a senha:

https://www.tabnews.com.br/[username]

>> Coment√°rio de filipedeschamps:
@aprendendofelipe alguns pontos importantes nessa quest√£o:

1. A lista de usu√°rios n√£o faz diferen√ßa como vetor de ataque nessa situa√ß√£o, pois a nossa autentica√ß√£o n√£o √© mais feita usando o `username` como antigamente, ela √© feita apenas usando o `email`. Como voc√™ falou, o atacante pode fazer o scrape do `username` de outras formas, por isso foi importante alterar a autentica√ß√£o para apenas `email`, uma vez que isso √© um dado privado e n√£o √© exposto em nenhum lugar do TabNews. Isso foi uma sugest√£o do @tcarreira feita na mesma bateria de sugest√µes dessa issue daqui.
2. Ent√£o esta implementa√ß√£o n√£o tenta evitar a listagem dos usu√°rios, mas tenta evitar que o atacante saiba da exist√™ncia de um `email` na base, pois se o `email` n√£o existe, a resposta vai ser muito mais r√°pida. Isso porque do jeito que foi implementado, o c√°lculo do hash da senha, que √© uma etapa devagar, s√≥ acontece se o `email` foi encontrado.
3. Ent√£o ele sabendo da exist√™ncia ou n√£o de um `email`, o atacante pode escolher se focar em atacar a senha. Por exemplo, o meu email p√∫blico aqui no GitHub √© `filiped@gmail.com` e o atacante pode hoje tentar descobrir se eu usei esse email ou n√£o no TabNews. Se responder muito r√°pido na tentativa de criar a sess√£o, ele sabe que eu n√£o usei e nem adianta tentar atacar a senha, mas se responder devagar, bingo.
4. Isso tamb√©m pode ser usado quando h√° vazamento de `email+senha` de outros lugares. Isso acontecia **muito** no Pagar.me, onde um e-commerce qualquer tinha um vazamento da base de usu√°rios, o pessoal quebrava o hash e come√ßava a testar essa combina√ß√£o contra o nosso endpoint de autentica√ß√£o para ver se por *sorte* algum usu√°rio tinha usado o mesmo email e senha. Na √©poca que eu trabalhava l√° implementamos um rate limiting que identificava esse comportamento e continuava retornando uma resposta de erro, mesmo que o atacante tinha acertado a combina√ß√£o. Enfim, na situa√ß√£o atual do TabNews, d√° para identificar que pelo menos o mesmo email foi utilizado num caso de vazamento de lista de emails.
5. De qualquer forma, o endpoint `/user` talvez deveria ser removido por enquanto at√© que a gente tenha um caso concreto que necessite dele para algum client, e principalmente quando ele tiver pagina√ß√£o. Ent√£o @aprendendofelipe sugiro n√£o aplicar o PR #494 e fazer um outro que remova (desliste) esse endpoint. E quando o endpoint voltar, ele poderia ser listado de forma p√∫blica sem problemas, [o GitHub faz isso tamb√©m](https://api.github.com/users) e no caso deles as pessoas j√° constru√≠ram coisas legais em cima üëç 
6. Mas no final das contas, precisamos implementar rate limiting, e isso j√° est√° listado como tarefa nessa Milestone ü§ù

>> Coment√°rio de aprendendofelipe:
Corret√≠ssimo @filipedeschamps! Eu vi o `getUserByUsername` no pseudo c√≥digo (que o @tcarreira deve ter escrito antes da altera√ß√£o para `email`) e nem lembrei que n√£o usamos o `username` no login üòÖ

Sobre retirar o endpoint `users`, voc√™ que manda! üëç

Mas pensa s√≥ um pouco antes, pois pode ser √∫til manter o acesso somente para voc√™ (desde que adicione a feature `read:user:list` ao seu usu√°rio).

Da maneira que ficou no #494, ningu√©m mais ter√° acesso, j√° que nenhum usu√°rio tem essa feature.

E tamb√©m j√° est√° com os testes que v√£o impedir que a rota seja exposta novamente.

>> Coment√°rio de filipedeschamps:
> Da maneira que ficou no https://github.com/filipedeschamps/tabnews.com.br/pull/494, ningu√©m mais ter√° acesso, j√° que nenhum usu√°rio tem essa feature.

Puts, √© verdade! Sensacional!!!! Acabei de editar o draft da Milestone 5 com esse PR ü§ù ü§ù ü§ù

>> Coment√°rio de ThallesP:
O e-mail tamb√©m √© dito que existe na hora do cadastro:
![image](https://user-images.githubusercontent.com/76017384/191082049-aec5e244-20f5-4c16-8c81-5da8fbe7c1d3.png)
Para resolver isso, logo ap√≥s enviar o formul√°rio de cadastro, redirecionar o usu√°rio para a confirma√ß√£o de e-mail independente se j√° existir um e-mail cadastrado, mas com a seguinte mensagem "Iremos enviar um e-mail de valida√ß√£o caso ainda n√£o esteja cadastrado".
Assim, no back-end, iremos enviar a confirma√ß√£o apenas se o e-mail n√£o existir no banco de dados.

>> Coment√°rio de filipedeschamps:
@ThallesP show! Uma d√∫vida que tenho sobre esse ponto de evitar a confer√™ncia do email √© que muita gente fala para fazer isso na hora do cadastro, mas ainda fica um furo que √© na hora da atualiza√ß√£o por email, pois esse √© outro vetor. Qual a melhor UX nesse caso?

Por exemplo:

* Usu√°rio `A` possui o email `a@a.com`
* Usu√°rio `B` possui o email `b@b.com`
* Usu√°rio `B` faz requisi√ß√£o para atualizar seu email para `a@a.com`.
* O que deveria acontecer?

>> Coment√°rio de ThallesP:
@filipedeschamps 
Pensei em duas op√ß√µes:
- Usar quase mesmo esquema que eu disse para o cadastro, e ao atualizar o e-mail, pedir a verifica√ß√£o para esse novo e-mail e tamb√©m dar a op√ß√£o do usu√°rio fornecer outro e-mail dentro dessa nova verifica√ß√£o (caso ele tenha errado na hora de atualizar). (minha op√ß√£o favorita)
- Dizer que o e-mail existe, mas colocar um rate-limit para alterar (1 dia ou 3 dias?) raramente mudamos de e-mail ent√£o acredito que n√£o teria problema.

Problema que eu vejo com a primeira op√ß√£o √© caso um usu√°rio mal intencionado tente fazer spam atualizando para e-mails aleat√≥rios, talvez precise de um rate-limit para prevenir isso.

>> Coment√°rio de rodrigoKulb:
Tentando organizar as Issues, acredito que avisar que o e-mail j√° est√° cadastrado √© uma funcionalidade muito importante. o github faz assim hoje.

![Captura de tela em 2023-03-23 23-59-18](https://user-images.githubusercontent.com/5334261/227413247-a48d3fe2-604e-496c-af56-1340a93043f2.png)

Sobre o tempo de login com usu√°rio v√°lido e n√£o valido, j√° foi implementado?

>> Coment√°rio de aprendendofelipe:
> Tentando organizar as Issues, acredito que avisar que o e-mail j√° est√° cadastrado √© uma funcionalidade muito importante. o github faz assim hoje.
> 
> Sobre o tempo de login com usu√°rio v√°lido e n√£o valido, j√° foi implementado?

Ainda n√£o foi implementado. E s√£o duas medidas contradit√≥rias, pois o login √© com email, ent√£o se for mostrar que o email j√° existe, n√£o √© necess√°ria a implementa√ß√£o dessa issue.

Mas veja que, por estas [mensagens](https://github.com/filipedeschamps/tabnews.com.br/issues/186#issuecomment-1185111423) do @filipedeschamps, a inten√ß√£o da issue √© justamente esconder a informa√ß√£o se o email j√° estiver cadastrado:

> 2\. Ent√£o esta implementa√ß√£o n√£o tenta evitar a listagem dos usu√°rios, mas tenta evitar que o atacante saiba da exist√™ncia de um `email` na base...

> 3\. Ent√£o ele sabendo da exist√™ncia ou n√£o de um `email`, o atacante pode escolher se focar em atacar a senha...

> 4\. Isso tamb√©m pode ser usado quando h√° vazamento de `email+senha`...

Mas tem que ver se √© poss√≠vel fechar todos os furos, pois, se n√£o for poss√≠vel, talvez seja melhor agir no sentido de impedir a descoberta da senha por for√ßa bruta. J√° existe o rate-limit, mas como √© por IP, n√£o pode ser muito restrito, ent√£o deveria haver um limite por usu√°rio.

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe obrigado pelas explica√ß√µes:
- Realmente a funcionalidade de informar que o e-mail j√° est√° em uso √© essencial.

Desta forma, realmente n√£o faz sentido quebrar a cabe√ßa com o time de login para verificar se o e-mail existe. 
Ent√£o n√£o vejo necessidade de manter essa Issue aberta, tendo que o t√≠tulo dela √© para **alterar o tempo quando o usu√°rio existe ou n√£o**.

Estou nessa Issue porque √© a mais antiga aberta do projeto, e vou fazer uma "limpeza" da mais antiga para frente.

üëçÔ∏è - Finalizar essa Issue.
üëéÔ∏è - Seguir com ela aberta.

>> Coment√°rio de luanmz:
Fala pessoal, tudo beleza?

Confesso que n√£o entendi o porque dessa issue ainda n√£o ter sido fechada, testei para mail enumeration na rota `/api/v1/sessions` e n√£o notei diferen√ßa clara ou substancial nos tempos de resposta que justifique essa rota espec√≠fica estar vulner√°vel a enumera√ß√£o mencionada.

Por√©m, a historia √© diferente para a rota `/api/v1/users` chamada pela funcionalidade de cadastrar um usu√°rio na base de dados, isso se d√° pelo fato de o servi√ßo de email ser chamado apenas quando o email n√£o esta presente na base, permitindo a enumera√ß√£o via tempo de resposta onde emails existentes respondem a requisi√ß√£o de forma muito mais r√°pida.

Testei esse comportamento localmente e o validei no pr√≥prio site oficial do tabnews (onde a diferen√ßa chega a casa 2000ms).

Nos meus testes de poss√≠veis solu√ß√µes ainda encontrei uma outra enumera√ß√£o (um pouco mais especifica) na mesma rota, relacionada a com o tratamento de erro quando um usu√°rio tenta se cadastrar com um usu√°rio j√° existente e um email tamb√©m j√° existente (resultado de uma possivel enumera√ß√£o). O erro de "usu√°rio j√° existe" √© disparado somente se o **primeiro** match encontrado na base de dados para **userData** for um usu√°rio igual, se for um email, ele n√£o dispara o erro e mostra a mensagem que o email foi enviado. Permitindo enumerar todos os emails de usu√°rios que est√£o acima dele na base de dados. (j√° possuo uma corre√ß√£o satisfat√≥ria para esse comportamento)

No intuito de igualar esses tempos de resposta devo atacar essa issue e tentar corrigir essas enumera√ß√µes. N√£o sei se deveria abrir uma outra issue espec√≠fica dessa rota mas por enquanto vou utilizar esta.

>> Coment√°rio de aprendendofelipe:
@luanmz, voc√™ foi citado na publica√ß√£o sobre as novidades do TabNews üéâüí™

https://www.tabnews.com.br/FelipeBarso/tabnews-melhorias-de-seguranca-nos-testes-e-mais
</issue_186_A valida√ß√£o de email+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o>

<issue_187_V√≠deo Tutorial Programando TabNews (+DESAFIO MASSA E IMPORTANTE)>
Turma, segue v√≠deo tutorial onde eu mostro como eu to programando o TabNews usando testes automatizados e como isso facilita e deixa tudo mais seguro, e tamb√©m proponho um desafio massa pra gente fechar de vez a [Milestone 2: Auth e Usu√°rios](https://github.com/filipedeschamps/tabnews.com.br/milestone/3) e que ta muito f√°cil!!

**V√≠deo: https://youtu.be/Az2D-B4jKs4**

>> Coment√°rio de huogerac:
Pessoal, tive uma d√∫vida funcional ao implementar o teste do v√≠deo:
- legal, o teste de usu√°rio an√¥nimo receber um 403. Okay!
- mas pensando no segundo teste, onde criamos um usu√°rio e sua sess√£o, e fazemos novamente o GET migrations informando a sess√£o do usu√°rio via set-cookie. Neste caso ele deveria retornar 200?
- Em outras palavras, todos usu√°rios criados podem acessar a migrations?
- Onde est√° o c√≥digo com as regras de "features iniciais"? O que acham de ter tests para documentar estas regras de features iniciais, ou o omento de usu√°rio ganha a feature migrations: read etc...

Enfim, fiz um PR com o commit do v√≠deo, mas coloquei um WIP dado que este segundo teste n√£o est√° completo.

>> Coment√°rio de rodrigoKulb:
@huogerac eu tamb√©m pensei nisso quando criei a PR, fiz 3 tipos de testes:
01 - Usu√°rio anonimo (n√£o consegue rodar)
02 - Usu√°rio com permiss√µes padr√µes (n√£o consegue rodar)
03 - Usu√°rio for√ßando a features migrations: read / create. (consegue rodar)

Como n√£o temos um sistema de gest√£o de n√≠vel para definir em qual momento vamos "dar" essa feature, no teste eu forcei essa atribui√ß√£o.

>> Coment√°rio de filipedeschamps:
Show @rodrigoKulb , √© isso a√≠! Acabei de publicar [um item no di√°rio](https://github.com/filipedeschamps/tabnews.com.br/wiki/033.-Nome-padr%C3%A3o-de-uma-feature---helpers-de-teste) que fala sobre os **helpers de teste** e a import√¢ncia de separar o que √© **boilerplate** de o que voc√™ **realmente quer testar**.


Ent√£o @huogerac respondendo ponto a ponto:

### legal, o teste de usu√°rio an√¥nimo receber um 403. Okay!
Correto! 403 Forbidden üëç 

### mas pensando no segundo teste, onde criamos um usu√°rio e sua sess√£o, e fazemos novamente o GET migrations informando a sess√£o do usu√°rio via set-cookie. Neste caso ele deveria retornar 200?
N√£o deveria retornar 200 para usu√°rios com as features **padr√µes**. Essas s√£o as features quando algu√©m normalmente se cadastra no site e ativa aconta. Esse usu√°rio deveria continuar recebendo 403.

### Em outras palavras, todos usu√°rios criados podem acessar a migrations?###
Errado. Somente usu√°rios que possui a feature de ler e criar migrations.

### Onde est√° o c√≥digo com as regras de "features iniciais"? O que acham de ter tests para documentar estas regras de features iniciais, ou o omento de usu√°rio ganha a feature migrations: read etc...
Quem define o que √© um usu√°rio an√¥nimo √© o model do usu√°rio mesmo e est√° aqui: 

https://github.com/filipedeschamps/tabnews.com.br/blob/046f96f4e92f720e2f1add575c764fc6173d061e/models/user.js#L74-L78

E sobre testar e garantir que as features iniciais sejam estas mesmo, isso est√° sendo feito no teste do fluxo do cadastro, aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/046f96f4e92f720e2f1add575c764fc6173d061e/tests/api/v1/_use-cases/registration-flow.test.js#L44

E tamb√©m depois que ele √© ativado:

https://github.com/filipedeschamps/tabnews.com.br/blob/046f96f4e92f720e2f1add575c764fc6173d061e/tests/api/v1/_use-cases/registration-flow.test.js#L77-L85
</issue_187_V√≠deo Tutorial Programando TabNews (+DESAFIO MASSA E IMPORTANTE)>

<issue_189_Erro ao rodar testes>
Os testes em si passam por√©m no final aparece essa mensagem de envio desse **SIGTERM** e ent√£o d√° erro. 
```
[jest] Ran all test suites.
[jest] jest --runInBand --verbose --detectOpenHandles exited with code 0
--> Sending SIGTERM to other processes..
npm ERR! Test failed.  See above for more details.
```

Acredito que o problema est√° nesse ponto do script (Package.json): **'jest --runInBand --verbose --detectOpenHandles'**

>> Coment√°rio de filipedeschamps:
Que interessant√≠ssimo @adailsonaguiar ... os testes sa√≠ram com code `0` o que √© √≥timo, mas o que n√£o d√° para saber ali √© se ele teve erro ao tentar fechar os outros processos.

Voc√™ pode nos passar as seguintes informa√ß√µes:
- Sistema operacional
- Vers√£o do Node e NPM
- Vers√£o do Docker

Outra pergunta, quando voc√™ levanta o servidor web (`npm run dev`) e depois termina ele com `CTRL+C` ele derruba os servi√ßos normalmente?

>> Coment√°rio de adailsonaguiar:
Atualiza√ß√£o..
At√© reiniciei a m√°quina pra ver ser n√£o tinha servi√ßo que ficava rodando.

> Tentei rodar `npm run test`

![Screenshot_20220214_111915](https://user-images.githubusercontent.com/19656546/153881258-01c5802e-168f-4ca5-ab92-a06b1fd0d8f6.png)

### Node | NPM
![Screenshot_20220214_112219](https://user-images.githubusercontent.com/19656546/153881678-fa778a3f-8afc-43b9-a51c-4272c8e250de.png)

>> Coment√°rio de rodrigoKulb:
ol√° @adailsonaguiar achei um stackoverflow que possivelmente vai ajudar com a solu√ß√£o:

``Step 1: $ npm cache clean --force``

``Step 2: Delete node_modules by $ rm -rf node_modules (rmdir /S /Q node_modules in windows) folder or delete it manually by going into the directory and right-click > delete / move to trash. If are not updating your packages you can delete the package-lock.json file too.``

``Step 3: npm install``

``To start again, $ npm start `` (Aqui voc√™ roda o npm run dev ou o test)

``This worked for me. Hopes it works for you too.``

``PS: Still if it is there, kindly check the error it is displaying in red and act accordingly. This error is specific to node.js environment.``

https://stackoverflow.com/questions/42308879/how-to-solve-npm-error-npm-err-code-elifecycle?page=1&tab=votes#tab-top

>> Coment√°rio de filipedeschamps:
@adailsonaguiar em paralelo, ele aponta um arquivo de log ali do npm. Voc√™ pode colar o conte√∫do desse arquivo aqui? ü§ù

>> Coment√°rio de adailsonaguiar:
### Arquivo de log do erro
```
0 info it worked if it ends with ok
1 verbose cli [
1 verbose cli   '/home/actdigital/.nvm/versions/node/v14.19.0/bin/node',
1 verbose cli   '/home/actdigital/.nvm/versions/node/v14.19.0/bin/npm',
1 verbose cli   'run',
1 verbose cli   'test'
1 verbose cli ]
2 info using npm@6.14.16
3 info using node@v14.19.0
4 verbose run-script [ 'pretest', 'test', 'posttest' ]
5 info lifecycle tabnews.com.br@1.0.0~pretest: tabnews.com.br@1.0.0
6 info lifecycle tabnews.com.br@1.0.0~test: tabnews.com.br@1.0.0
7 verbose lifecycle tabnews.com.br@1.0.0~test: unsafe-perm in lifecycle true
8 verbose lifecycle tabnews.com.br@1.0.0~test: PATH: /home/actdigital/.nvm/versions/node/v14.19.0/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/home/actdigital/dev/tabnews.com.br/node_modules/.bin:/home/actdigital/.nvm/versions/node/v14.19.0/bin:/opt/firefox/firefox:/home/actdigital/.nodenv/shims:/home/actdigital/.nodenv/bin:/opt/firefox/firefox:/home/actdigital/.nodenv/shims:/home/actdigital/.nodenv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/actdigital/Android/Sdk/emulator:/home/actdigital/Android/Sdk/tools:/home/actdigital/Android/Sdk/tools/bin:/home/actdigital/Android/Sdk/platform-tools:/home/actdigital/Android/Sdk/emulator:/home/actdigital/Android/Sdk/tools:/home/actdigital/Android/Sdk/tools/bin:/home/actdigital/Android/Sdk/platform-tools:/home/actdigital/Android/Sdk/emulator:/home/actdigital/Android/Sdk/tools:/home/actdigital/Android/Sdk/tools/bin:/home/actdigital/Android/Sdk/platform-tools
9 verbose lifecycle tabnews.com.br@1.0.0~test: CWD: /home/actdigital/dev/tabnews.com.br
10 silly lifecycle tabnews.com.br@1.0.0~test: Args: [
10 silly lifecycle   '-c',
10 silly lifecycle   "npm run services:up && concurrently -s -k -n next,jest --hide next 'npm run next' 'jest --runInBand --verbose --detectOpenHandles' && npm run services:stop"
10 silly lifecycle ]
11 silly lifecycle tabnews.com.br@1.0.0~test: Returned: code: 1  signal: null
12 info lifecycle tabnews.com.br@1.0.0~test: Failed to exec test script
13 verbose stack Error: tabnews.com.br@1.0.0 test: `npm run services:up && concurrently -s -k -n next,jest --hide next 'npm run next' 'jest --runInBand --verbose --detectOpenHandles' && npm run services:stop`
13 verbose stack Exit status 1
13 verbose stack     at EventEmitter.<anonymous> (/home/actdigital/.nvm/versions/node/v14.19.0/lib/node_modules/npm/node_modules/npm-lifecycle/index.js:332:16)
13 verbose stack     at EventEmitter.emit (events.js:400:28)
13 verbose stack     at ChildProcess.<anonymous> (/home/actdigital/.nvm/versions/node/v14.19.0/lib/node_modules/npm/node_modules/npm-lifecycle/lib/spawn.js:55:14)
13 verbose stack     at ChildProcess.emit (events.js:400:28)
13 verbose stack     at maybeClose (internal/child_process.js:1058:16)
13 verbose stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:293:5)
14 verbose pkgid tabnews.com.br@1.0.0
15 verbose cwd /home/actdigital/dev/tabnews.com.br
16 verbose Linux 5.13.0-28-generic
17 verbose argv "/home/actdigital/.nvm/versions/node/v14.19.0/bin/node" "/home/actdigital/.nvm/versions/node/v14.19.0/bin/npm" "run" "test"
18 verbose node v14.19.0
19 verbose npm  v6.14.16
20 error code ELIFECYCLE
21 error errno 1
22 error tabnews.com.br@1.0.0 test: `npm run services:up && concurrently -s -k -n next,jest --hide next 'npm run next' 'jest --runInBand --verbose --detectOpenHandles' && npm run services:stop`
22 error Exit status 1
23 error Failed at the tabnews.com.br@1.0.0 test script.
23 error This is probably not a problem with npm. There is likely additional logging output above.
24 verbose exit [ 1, true ]

```

>> Coment√°rio de filipedeschamps:
Puts n√£o consegui extrair nada que me ajudaria na investiga√ß√£o.

Voc√™ chegou a fazer o teste do `npm run dev` e depois `CTRL+C` para ver se fecha tudo com sucesso? Porque √© meio que o que o script faz por voc√™. E para ver o status code ap√≥s isso, voc√™ pode digitar `echo $?` Se retornar qualquer coisa diferente de `0`, √© que est√° com problema mesmo.

Em paralelo, eu testaria o que o @rodrigoKulb ali em cima apontou tamb√©m, nunca se sabe.

>> Coment√°rio de filipedeschamps:
@adailsonaguiar voc√™ chegou a fazer o teste que comentei, e a sugest√£o do @rodrigoKulb ?

Abra√ß√£o!

>> Coment√°rio de filipedeschamps:
@adailsonaguiar estou fechando essa issue, qualquer novidade nos comunique ü§ù
</issue_189_Erro ao rodar testes>

<issue_196_Algu√©m conhece alguma ferramenta de Stress Test / Load Test?>
Fiz uma implementa√ß√£o no `database.js` pra que ele consiga rodar o site somente com 1 conex√£o (fazendo uns `retries` massa para pegar o client de conex√£o quando d√° problema). Isso aparentemente consertou outro bug onde eu fazia o fechamento do Pool de forma errada (vou elaborar no di√°rio de desenvolvimento üëç )

De qualquer forma, antes de mandar o PR eu queria testar a implementa√ß√£o contra uma carga boa de acesso aqui na minha m√°quina local.

Algu√©m sugere alguma ferramenta pra isso? ü§ù

>> Coment√°rio de filipedeschamps:
Numa pesquisa aqui achei o `ab` e √© bem simples de usar:

```bash
ab -n 5000 -c 15 http://localhost:3000/api/v1/users
```

Total de `5000` requests, onde s√£o feitas `15` paralelamente üëç

>> Coment√°rio de andrefd17:
J√° usei o [locust](https://locust.io/) que exige que o script seja escrito em python mais tamb√©m d√° mais flexibilidade para testar scenarios mais complexos por√©m tem o downside de ser em python e n√£o em javaScript para manter a mesma stack.

No NodeJS eu ja ouvi falar do [Artillery](https://www.npmjs.com/package/artillery) mas nunca usei.

>> Coment√°rio de filipedeschamps:
Caraca duas alternativas **MUITO** massa!!! Matou a pau, n√£o conhecia e fiz um monte de pesquisa aqui e n√£o esbarrei com elas ü§ù  üëç 

Em algum momento seria **simplesmente sensacional** ter um teste de carga que fa√ßa v√°rios acessos simult√¢neos, criando conta, ativando, logando, listando users, batendo em tudo quanto √© canto, e ainda mais massa ter um job separado no CI que teste isso e ainda mais massa manter e mensure o hist√≥rico üòÇ me empolguei üòÇ

>> Coment√°rio de liverday:
Aqui na empresa onde eu trabalho, n√≥s utilizamos o [k6](https://k6.io/) do Grafana Labs, que √© open-source e √© poss√≠vel escrever o teste de carga usando javascript :open_mouth: :star_struck:.

√â extremamente poderoso e intuitivo, vale a pena conferir!

>> Coment√°rio de sembug:
Outra op√ß√£o √© o bombardier  https://github.com/codesenberg/bombardier

bombardier -n 5000 -c 15 http://localhost:3000/api/v1/users

-- Roberto Nunes


On Fri, Feb 25, 2022 at 12:39 PM Vitor Medeiro ***@***.***>
wrote:

> Aqui na empresa onde eu trabalho, n√≥s utilizamos o k6 <https://k6.io/> do
> Grafana Labs, que √© open-source e √© poss√≠vel escrever o teste de carga
> usando javascript üòÆ ü§©.
>
> √â extremamente poderoso e intuitivo, vale a pena conferir!
>
> ‚Äî
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/196#issuecomment-1050961616>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AAAHQHSW43K7FORX5HVTX2TU46PDJANCNFSM5PE2OBPQ>
> .
> Triage notifications on the go with GitHub Mobile for iOS
> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>
> or Android
> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.
>
> You are receiving this because you are subscribed to this thread.Message
> ID: ***@***.***>
>

>> Coment√°rio de filipedeschamps:
Quanta alternativa sensacional üòç

>> Coment√°rio de tcarreira:
estou com o @liverday. O K6 √© muito bom, f√°cil de subir e testar. Est√° completamente pronto para rodar em docker

>> Coment√°rio de andrefd17:
Muito boa essa op√ß√£o do k6! N√£o conhecia, por ser em javascript d√° pra aproveitar os helpers criados para os tests do Jest üëç

>> Coment√°rio de filipedeschamps:
Turma, estou fechando essa issue, muito obrigado pela contribui√ß√£o de todos ü§ù
</issue_196_Algu√©m conhece alguma ferramenta de Stress Test / Load Test?>

<issue_206_Preciso de ajuda: testar lat√™ncia entre a aplica√ß√£o e banco>
# [edit] Testes encerrados. As URLs abaixo poder√£o n√£o mais se comportar como antes üëç 

Quem est√° no **Brasil**, eu pe√ßo que me ajude a testar a lat√™ncia total acessando os seguintes endpoints:

### Teste 1: Aplica√ß√£o e Banco no Brasil
https://tabnews-git-vercel-tabnews.vercel.app/api/v1/status

### Teste 2: Aplica√ß√£o e Banco nos EUA
https://www.tabnews.com.br/api/v1/status

Quando abrir, ser√° retornado um JSON, mas ignore ele, pois l√° vai ter um campo chamado `latency` e ele mensura a lat√™ncia entre a **Aplica√ß√£o** e o **Banco de Dados**. O que estou procurando analisar **n√£o √© necessariamente isso**... √© a lat√™ncia entre **Voc√™** e a **Aplica√ß√£o**. Ent√£o por favor eu pe√ßo que abra o Devtools na aba Network e veja quanto tempo durou para a request retornar em cada teste.

**Seria MUITO show se voc√™ pudesse colocar de onde est√° testando e prints como esses aqui embaixo mostrando algumas tentativas de refresh** ü§ù 

## Resultado Teste 1 (Brasil)

Como estou em Canad√° - Vancouver, demora para a minha request chegar na Aplica√ß√£o em SP, mas quando chega, ela tem pouqu√≠ssima lat√™ncia para acessar o banco de dados que tamb√©m est√° l√°. √â importante essa lat√™ncia ser pequena, porque uma √∫nica request minha contra esse `/status` far√° a aplica√ß√£o viajar duas vezes at√© ao banco (ela faz duas requests separadas). Ent√£o √© super importante sempre deixar o banco de dados perto da aplica√ß√£o, pois √© natural que uma √∫nica request web fa√ßa a aplica√ß√£o ir ao banco mais de uma vez (por exemplo, verificar sess√£o ativa, puxar usu√°rio, atualizar a expira√ß√£o da sess√£o e depois puxar os dados de fato):

<img width="1048" alt="image" src="https://user-images.githubusercontent.com/4248081/156287114-b861b94f-143a-482f-a52f-f57a3ecfbd8d.png">


## Resultado Teste 2 (EUA)
Primeiro super interessante notar que a lat√™ncia entre a Aplica√ß√£o e o Banco l√° na infra nos EUA √© menor do que a em SP:

Brasil: **29ms**
EUA: **12ms**

**[EDIT]:** Fiquei estressando, e depois de um tempo a lat√™ncia m√≠nima no Brasil tamb√©m ficou na casa dos 12ms ü§ù üëç 

E √© natural que a lat√™ncia entre Eu e a Aplica√ß√£o no Teste 2 seja menor, porque estou mais pr√≥ximo.

<img width="1034" alt="image" src="https://user-images.githubusercontent.com/4248081/156291365-41080f6d-2b4c-4aa9-b31e-eeb1189bbf8b.png">

>> Coment√°rio de boemekeld:
@filipedeschamps seguem os resultados dos testes feitos em Pelotas - RS:
![image](https://user-images.githubusercontent.com/2818768/156298023-1de00b3c-771e-46e4-a1f4-e6d4410d4549.png)

![image](https://user-images.githubusercontent.com/2818768/156298052-607e28cf-a0fc-46fd-a936-1fb1cdaf9501.png)

>> Coment√°rio de gabrieelaraujo:
@filipedeschamps resultados (localiza√ß√£o: Goi√¢nia-GO)
![Screenshot_1](https://user-images.githubusercontent.com/7256979/156311721-c6dde8fd-8e18-4da0-8163-72354943d4ce.png)

@filipedeschamps acabei esquecendo o outro endpoint, segue os testes ;)
![Screenshot_2](https://user-images.githubusercontent.com/7256979/156377521-bbf8613d-c7a4-48c8-baed-9e275dbaddd6.png)

>> Coment√°rio de filipedeschamps:
Sensacional @boemekeld 

@gabrieelaraujo muito bom!! Voc√™ consegue fazer o mesmo teste contra o endpoint https://www.tabnews.com.br/api/v1/status que est√° nos EUA? Gostaria de comparar a lat√™ncia global para ver se vale a pena hospedar tudo em SP (mais caro) versus hospedar nos EUA (mais barato) ü§ù 

**[edit]** agora que vi que colocou o teste atualizado, show ü§ù

>> Coment√°rio de rodrigoKulb:
Opa @filipedeschamps resultado localiza√ß√£o Santana de Parna√≠ba - SP
![Captura de tela em 2022-03-02 10-58-46](https://user-images.githubusercontent.com/5334261/156376650-035bd84f-7953-4ff3-8b8f-99ebcb2ef762.png)
![Captura de tela em 2022-03-02 11-07-07](https://user-images.githubusercontent.com/5334261/156377176-46bf7742-386f-4650-9e9a-66d65ce7b3ea.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb que interessant√≠ssimo! Nos dois casos a lat√™ncia total da request est√° a mesma üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps atualmente utilizo us-east-1 para as minhas aplica√ß√µes. Olha o teste no speed test de l√°, ideal seria algu√©m que tem acesso ao terminal do sa-east-1 e fazer o mesmo teste para avaliar a banda no Brasil.
```
Testing download speed................................................................................
Download: 964.27 Mbit/s
Testing upload speed..................................................................................
Upload: 948.52 Mbit/s
```
Mas realmente a diferen√ßa √© muito pequena, acredito que a grande responsabilidade de performance ficar√° por parte da aplica√ß√£o e n√£o da infra.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb eu n√£o estava entendendo porque voc√™ de SP estava tendo a maior lat√™ncia, mas percebi algo interessante no seu print: acho que o Devtools ali est√° configurado para simular uma conex√£o 3G, olha s√≥:

<img width="221" alt="image" src="https://user-images.githubusercontent.com/4248081/156394500-184be5d3-99c7-4256-a727-6b6bf5fb1770.png">

Veja se mudar isso altera os resultados üëç

>> Coment√°rio de gugadeschamps:
@filipedeschamps Resultados para Blumenau-SC:
### Teste 1
<img width="1440" alt="image" src="https://user-images.githubusercontent.com/7117858/156395772-ab26efb0-e597-4af7-a98b-57926eeb04b0.png">

### Teste 2
<img width="1440" alt="image" src="https://user-images.githubusercontent.com/7117858/156395984-56416fd3-c880-4b42-a75d-43e70d7dc29b.png">

>> Coment√°rio de rodrigoKulb:
> percebi algo interessante no seu print: acho que o Devtools ali est√° configurado para simular uma conex√£o 3G, olha s√≥:

@filipedeschamps haha matou √† pau! (Santana de Parna√≠ba - SP)

![Captura de tela em 2022-03-02 12-44-37](https://user-images.githubusercontent.com/5334261/156396142-94dcd4bb-4630-4aac-8c12-f0f2f3706f0a.png)
![Captura de tela em 2022-03-02 12-43-42](https://user-images.githubusercontent.com/5334261/156396149-a9bba28e-9543-4800-8f20-c5dbb276e8b3.png)

>> Coment√°rio de filipedeschamps:
@gustavodeschamps 100% delicinha quando fica abaixo de 100ms

@rodrigoKulb agora sim üéâ

>> Coment√°rio de filipedeschamps:
Turma, acho que est√° bem claro a diferen√ßa na lat√™ncia entre a infra no Brasil e nos EUA. Num c√°lculo de padaria, deixar no Brasil faz ter o **dobro de performance** para quem mora no pa√≠s.

Ent√£o considerando custos, o ambiente de Homologa√ß√£o vai ser colocado nos EUA (`us-east-1`) e ambiente de Produ√ß√£o vai ser colocado no Brasil (`sa-east-1`)

>> Coment√°rio de filipedeschamps:
Fechando essa issue e come√ßando a trabalhar nos ambientes finais, MUITO obrigado pela participa√ß√£o de todos ü§ù üëç
</issue_206_Preciso de ajuda: testar lat√™ncia entre a aplica√ß√£o e banco>

<issue_207_Encontrei uma forma de "salvar" uma p√°gina inteira para manter como hist√≥rico do projeto>
Olha que interessant√≠ssimo: https://github.com/gildas-lormeau/SingleFile (tem um GIF/tutorial ali no come√ßo)

Possivelmente isso vai ser √≥timo para salvarmos a atual Home e todas as POCs como est√°ticos reais e que n√£o dependem dos atuais pacotes do projeto (React/Tailwind CSS) üëç

>> Coment√°rio de rodrigoKulb:
Legal, basicamente copiar todo resultado "compilado", arquivos css, js gerados pelo node de forma est√°tica.
Edit: Fiquei com uma d√∫vida onde ele armazena as imagens?

>> Coment√°rio de rodrigoKulb:
Acabei de instalar e testar aqui, bem legal ele praticamente converte tudo em uma linha, porem o arquivo fica enorme, ele converte todas imagens em base64
![Captura de tela em 2022-03-02 23-21-01](https://user-images.githubusercontent.com/5334261/156483923-25480457-9138-483c-b28e-c162a51631cc.png)
O HTML da home do tabnews ficou com 6.7 Megas
![Captura de tela em 2022-03-02 23-20-36](https://user-images.githubusercontent.com/5334261/156483933-cc04dcbb-a4b6-46d3-a4dd-bd2b04c6b2d6.png)
Muito massa, o legal √© que a p√°gina fica TOTALMENTE sem depend√™ncias, mas n√£o vai aproveitar o cache de nenhum arquivo. 

E por algum motivo os confetes n√£o funcionaram hahaha!!

Outro detalhe a ordem das fotos n√£o ficaria rand√¥mica.

>> Coment√°rio de filipedeschamps:
Ahhh massa!!!

Sobre o arquivo enorme, n√£o vejo problema, porque √© o que a pessoa baixa no final das contas com as imagens externas.

Agora, os √∫ltimos dois detalhes s√£o uma pena :/ talvez se a gente injetar no bra√ßo essas funcionalidades, porque no final das contas, √© tudo 100% JavaScript üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps sobre a quest√£o de n√£o alterar a p√°gina **em constru√ß√£o**, acredito que mesmo transformando em um arquivo sem depend√™ncias, corremos o risco de alguma atualiza√ß√£o do Browser quebrar alguma funcionalidade.

Acho importante definir que n√£o vamos alterar o conte√∫do, porem efetuaremos sempre que necess√°rio as atualiza√ß√µes para manter o funcionamento inicial da p√°gina. Um grande exemplo √© a TAG `<blink>` do html que n√£o funciona nos browsers atuais.

>> Coment√°rio de pauloboare:
Falando da HOME hist√≥rica, imagino que a ideia seja "marcar em pedra" aquele marco inicial, por√©m de l√° pra c√° eu alterei meu username. √â azar meu ou tenho salva√ß√£o? haha!

>> Coment√°rio de vitoropereira:
@pauloboare Eu tbm estou na mesma situa√ß√£o. No nosso caso creio √© mais dificil, acho que teria q rodar aquele script todo novamente. E fazer na m√£o pode acontecer de vc alterar a pessoa errada e o @filipedeschamps aceitar pq ele n√£o sabe quem √© quem no projeto. Rodar o script creio que ir√° pegar quem entrou posteriormente. Bom vou procurar uma solu√ß√£o que eu ache factivel. Mas faz parte das regras... kkkkkk

>> Coment√°rio de rodrigoKulb:
@pauloboare e @vitoropereira acredito que a melhor solu√ß√£o seria deixar essa p√°gina como "hist√≥rica" sem altera√ß√£o e criar uma **nova** de membros / desenvolvedores onde listariam todos que apoiaram e apoiam o projeto, sempre atualizando com os novos que ir√£o entrar ou altera√ß√µes.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb √≥tima sugest√£o! Isso caberia na p√°gina de analytics, podemos formar uma lista din√¢mica de contribuidores aqui do reposit√≥rio, e uma est√°tica (que pode ser atualizada) das pessoas que estavam no evento do "init".

>> Coment√°rio de filipedeschamps:
Estou fechando essa issue para nos focarmos na #231 ü§ù
</issue_207_Encontrei uma forma de "salvar" uma p√°gina inteira para manter como hist√≥rico do projeto>

<issue_217_Draft da Milestone 3>
**[edit] as issues j√° est√£o sendo criadas e podem ser acessadas [por esse link](https://github.com/filipedeschamps/tabnews.com.br/milestone/4)**

Turma, j√° estou fazendo um draft da pr√≥xima Milestone. Qualquer sugest√£o √© bem vinda e mais al√©m irei criar issues individuais com mais detalhes ü§ù üëç 

- Princ√≠pio que deve ser usado o m√°ximo que puder:
  - P√°ginas devem sempre serem est√°ticas (com conte√∫do gerado por `getStaticProps` por exemplo) e todas as rotas p√∫blicas da API (que n√£o precisem de feature) precisam ter algum cache (`stale-while-revalidate`).
  - P√°ginas que precisam de conte√∫do din√¢mico, quando geradas de forma est√°tica devem ter seus dados atualizados de forma din√¢mica, por exemplo usando o SWR.
  - Atualiza√ß√µes nessas p√°ginas devem ser feitas pelo `revalidate` tradicional (e com [esse novo recurso beta](https://nextjs.org/blog/next-12-1#on-demand-incremental-static-regeneration-beta) de atualizar por demanda) e endpoints p√∫blicos da API por `s-maxage` na CDN da Vercel (e tamb√©m por esse recurso beta, se der).

---

## Itens que j√° criei issues
[Consulte elas por esse link](https://github.com/filipedeschamps/tabnews.com.br/milestone/4)

- Ativa√ß√£o
  - Recupera√ß√£o de cadastro n√£o ativo: Atualmente o ip da nossa conta no Sendgrid n√£o est√° conseguindo enviar o link para emails da Microsoft. Precisamos de um fluxo para o pr√≥prio usu√°rio conseguir pedir um novo email de ativa√ß√£o. Por exemplo: por padr√£o uma conta ter `create:activation_token` e possibilitar que o usu√°rio crie tokens at√© que a conta seja ativada e essa feature seja removida.
  - P√°gina de Ativa√ß√£o: Outlook proativamente d√° um `GET` no link de ativa√ß√£o e quando o usu√°rio clica, ele j√° est√° usado/inv√°lido. Mudar comportamento para ele n√£o reclamar. Na verdade um GET n√£o deveria mudar nenhum state, e deveria existir uma p√°gina intermedi√°ria que fa√ßa um POST contra aquela URL para ativar a conta de fato.

- Cadastro de Novo Usu√°rio
  - P√°gina com formul√°rio para cadastrar novo usu√°rio

- Not√≠cias
  - API para CRUD de not√≠cias
  - P√°gina com formul√°rio para criar not√≠cias
  - P√°gina para listar not√≠cias (Home)
  - P√°gina individual da not√≠cia

- Sistema de valida√ß√£o
  - Refazer todo sistema de valida√ß√£o (separar em valida√ß√£o sint√©tica e regra de neg√≥cio/filtros)
  - Revisitar todos os endpoints para entender se **todo e qualquer par√¢metro enviado** est√° passando pela valida√ß√£o sint√©tica e filtro.

- Estat√≠ticas p√∫blicas
  - API para puxar dados das estat√≠sticas do site (n√∫mero de cadastros, not√≠cias, visualiza√ß√µes, etc.)
  - P√°gina para mostrar as estat√≠sticas (e de quebra o `/api/v1/status`)


## Itens que eu julguei empurrar para pr√≥xima Milestone

- Recupera√ß√£o de senha
  - API para resetar senha (enviando por email convite para resetar)
  - P√°gina com formul√°rio para resetar

- Altera√ß√£o dados cadastrais
  - Altera√ß√£o de email
    - Remover possibilidade da pessoa simplesmente fazer um `PATCH` na propriedade `email`
    - API para alterar email (enviando para o email antigo convite para alterar)
    - P√°gina com formul√°rio para alterar email
  - Altera√ß√£o de senha
    - P√°gina com formul√°rio para alterar senha
  - Altera√ß√£o de username
    - P√°gina com formul√°rio para alterar username

- Continuar a reorganizar os testes
  - Mover testes antigos para pasta `~/tests/api/v1`
  - Formatar testes antigos para o novo padr√£o (que considera usu√°rio an√¥nimo, padr√£o e privilegiado - quando fizer sentido)
  - Criar testes para casos de n√£o sucesso, como apontado aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/183

>> Coment√°rio de rodrigoKulb:
Opa show de bola, eu adicionaria as migrations:
01 - Migration de not√≠cias;
02 - Migration coment√°rios;

>> Coment√°rio de liverday:
Cara, ver como o projeto come√ßou a acelerar de uns tempos pra c√° √© maravilhoso! To ansioso pela milestone 3

>> Coment√°rio de filipedeschamps:
Totaaal @liverday as coisas agora v√£o tomar forma üòç

>> Coment√°rio de andrefd17:
@filipedeschamps da uma olhada nesse repositorio aqui que contem o design system do GitHub:
https://primer.style/

![image](https://user-images.githubusercontent.com/26145982/160505337-b95b67b7-505c-437f-8b74-069f6144fb60.png)

Ele j√° oferece [React Components](https://primer.style/react/) ou se n√£o quiser depender diretamente dessa lib tamb√©m tem o [figma](https://primer.style/design/tools/figma#interface-templates) que poderia ajudar.

>> Coment√°rio de filipedeschamps:
Seria **sensacional** se aproximar da interface do Github üëç

>> Coment√°rio de filipedeschamps:
Turma, terminei todas as issues selecionadas para a Milestone 3 e podem ser acessadas aqui: https://github.com/filipedeschamps/tabnews.com.br/milestone/4

Tiveram coisas nesse draft que s√£o importantes (e s√£o de usabilidade b√°sica) mas que optei por empurrar elas para a pr√≥xima Milestone para n√£o deixar essa aqui muito grande ü§ù

>> Coment√°rio de filipedeschamps:
Mentira, adicionei mais um relacionado a log drain: #238

>> Coment√°rio de Dgdiniz:
Ol√°, voc√™s j√° fizeram a parte de autentica√ß√£o/autoriza√ß√£o? Em que p√© est√° esta parte? Aqui no iFood no time que eu estou estamos fazendo essa parte de autentica√ß√£o e autoriza√ß√£o num novo portal que estamos criando e seria legal comparar as ideias. N√£o manjava muito disso, mas nas √∫ltimas semana tive que aprender bastante coisa sobre isso.

>> Coment√°rio de filipedeschamps:
@Dgdiniz fala meu caro, muito bom te ver por aqui. Como est√° o nenem? üòç 

Sobre autentica√ß√£o e autoriza√ß√£o, ambos est√£o feitos, e apesar de que isso √© um assunto que nunca termina, chegou num est√°gio bem massa e estamos usando para valer. A estrat√©gia que adotamos √© que cada usu√°rio tem uma s√©rie de `features` e o backend vai verificando a exist√™ncia ou n√£o delas conforme a a√ß√£o que o usu√°rio quer fazer.

Veja por exemplo as features do meu usu√°rio: https://www.tabnews.com.br/api/v1/users/filipedeschamps

```json
{
  "id": "07ea33ea-78bd-4578-bad2-1cf5323cab07",
  "username": "filipedeschamps",
  "features": [
    "create:session",
    "read:session",
    "create:post",
    "create:comment",
    "update:user"
  ],
  "created_at": "2022-03-18T17:49:19.206Z",
  "updated_at": "2022-03-18T18:38:17.309Z"
}
```

Ent√£o sugiro ler 2 arquivos pra entender como que isso est√° sendo feito:

https://github.com/filipedeschamps/tabnews.com.br/blob/fcaa2d23b8ed6088fc4fdffa5529e160156a4993/models/authorization.js#L29

https://github.com/filipedeschamps/tabnews.com.br/blob/fcaa2d23b8ed6088fc4fdffa5529e160156a4993/pages/api/v1/sessions/index.public.js#L18

>> Coment√°rio de Dgdiniz:
A Laurinha j√° vai fazer um ano e dois meses. J√° est√° praticamente correndo j√°. √â muito boazinha. E o seu beb√™, como vai?

Dei uma olhada aqui e pelo que vi vcs fizeram apenas com usu√°rio e senha at√© o momento? Vai ter por Oauth2 com Google, Facebook, etc? 

Aqui n√≥s s√≥ usamos Otp (One Time Password) e Oauth2. A√≠ gera um token Jwt que dentro tem todas as permiss√µes daquele usu√°rio. O Token √© assinado, ent√£o fica tudo stateless, onde cada servi√ßo valida o token sozinho, sem precisar acessar um banco. 

N√£o usamos usu√°rio e senha pra n√£o ter que ficar guardando senha. Mas ainda estamos implementando e aprendendo durante o processo. Eu estou achando bem legal essa parte.

>> Coment√°rio de filipedeschamps:
> A Laurinha j√° vai fazer um ano e dois meses. J√° est√° praticamente correndo j√°. √â muito boazinha. E o seu beb√™, como vai?

Que massa üòç o Oliver vai fazer 1 ano agora dia 24 e ta uma aventura aqui dentro de casa, teste de usabilidade em 100% das superf√≠cies e objetos üòÇ 

> Aqui n√≥s s√≥ usamos Otp (One Time Password) e Oauth2. A√≠ gera um token Jwt que dentro tem todas as permiss√µes daquele usu√°rio. O Token √© assinado, ent√£o fica tudo stateless, onde cada servi√ßo valida o token sozinho, sem precisar acessar um banco.

Sensacional! Isso deixa cada servi√ßo bem independente ü§ù 

Mas isso ta sendo usado at√© na ponta que toca o usu√°rio?

A gente tinha come√ßado com a ideia de n√£o ter senha, mas pensando em todas as combina√ß√µes, uma que deixaria a pessoa trancada por fora era ela ter digitado o email de forma errada, deixando a conta num limbo que o usu√°rio por conta pr√≥pria n√£o conseguiria recuperar... ou tamb√©m porque receber email nunca √© garantido. De qualquer forma, do jeito que o login est√° hoje (email + senha), mudar para s√≥ usar email ta bem f√°cil.

Principalmente porque agora eu to pensando, se a pessoa digitou o email errado, ela tamb√©m n√£o consegue recuperar a conta, mesmo tendo a senha, porque a conta n√£o vai estar ativa pra ela conseguir fazer o login. Da√≠ talvez nesse caso o sistema deveria fazer a manuten√ß√£o e deletar contas que n√£o foram ativadas em X dias.

>> Coment√°rio de filipedeschamps:
E @Dgdiniz com token stateless (se ele for de uso do usu√°rio), como que voc√™s encerram a sess√£o se necess√°rio, por exemplo por abuso?

>> Coment√°rio de inovaprog:
Aqui tambem usamos jwt @filipedeschamps mas pra bloquear imediatamente um user tem um middleware que faz a checagem das permiss√µes do usu√°rio.

>> Coment√°rio de Dgdiniz:
Oi Filipe, n√£o entendi o eu voc√™ falou de uma pessoa ficar trancada por fora, pois a conta s√≥ seria criada ap√≥s uma valida√ß√£o por email, certo? At√© l√° seria algo tempor√°rio. No nosso caso email √© obrigat√≥rio, ent√£o quando a pessoa loga por Otp ela coloca o email no site, o sistema manda um c√≥digo para o email e ela coloca o c√≥digo recebido na p√°gina para se logar. Se o c√≥digo for correto a√≠ a conta √© criada (caso ainda n√£o exista), e neste momento o sistema pode pedir pra colocar outros dados, como nome, etc. Tem muitas formas pra se fazer, depende das caracter√≠sticas do produto.

Mas no caso do token, no final do login o usu√°rio recebe o token, e no token tem v√°rias informa√ß√µes de permiss√£o. No caso usamos um servidor de autentica√ß√£o que controla tudo isso, e tem v√°rios como KeyCloack, Aws Cognito, Okta, etc. S√£o esses servidores que geram o token, e ele assinam com a chave privada deles. A√≠ os servi√ßos tem acesso √† chave p√∫blica e conseguem validar que aquele token √© v√°lido e quais as permiss√µes dele. 
A princ√≠pio estamos fazendo tudo stateless, ent√£o pra revogar os tokens no momento estamos revogando apenas o Refresh Token, pois nesse caso n√£o tem como barrar o token atual pois √© tudo stateless. Ent√£o se uma pessoa logar e logo em seguida vc querer barrar ela, ela vai ter acesso ao sistema por todo o per√≠odo de validade do token atual, que √© configur√°vel, tipo 1 hora, 30 minutos, etc. Dependendo do caso isso n√£o serve. Pro nosso caso espec√≠fico isso n√£o pega muito, por√©m uma solu√ß√£o seria filtrar no Api Gateway, fazendo tipo uma blacklist. Aqui alguns sistemas fazem toda a filtragem no Api Gateway, mas isso √© mais comum quando n√£o tem quest√µes de autoriza√ß√£o envolvidas, pois nesse caso √© s√≥ deixar passar ou n√£o as mensagens. Como temos a quest√£o de autoriza√ß√£o, s√£o os servi√ßos que validam e verificam as permiss√µes.
Pra manter tudo stateless e ainda permitir o bloqueio imediato, isso que eu falei de blacklist no Api Gateway pode ser uma solu√ß√£o. Pesaria um pouco no gateway mas na maior parte do tempo essa blacklist estaria vazia, e quando um token entrasse na blacklist ele ficaria pouco tempo, no m√°ximo o per√≠odo de validade dos tokens. Mas se no seu caso tiver muitos bloqueios a todo momento a√≠ pode se tornar invi√°vel.

Caso isso n√£o servir a√≠ tem que ficar statefull e validar no banco. Mas do jeito que a gente fez ficaria f√°cil de mudar. Isso ficaria transparente para os servi√ßos, pois cada servi√ßo tem a lib que valida o token. Vc poderia fazer stateless, por√©m se mais pra frente tivermos que acessar um banco pra validar o token vc s√≥ muda a lib e o resto n√£o muda nada. A interface de valida√ß√£o dos tokens e das permiss√µes fica a mesma coisa, e s√≥ mudaria o que a lib faz internamente, validando de forma stateless ou acessando um banco.

Daria pra fazer todo o tratamento de autoriza√ß√£o no Api Gateway tb, mas √© mais chato na minha opini√£o. Mas funcionaria tb.

Sobre como injetar as permiss√µes no token isso √© feito no servidor no momento que o token vai ser gerado. Esses servidores como Keycloak, Cognito, Okta, etc, tem um trigger PreToken, ou algo do tipo, onde vc injeta o que quer antes do token ser assinado. Nesse momento vc faz o que quiser, verificando o tipo do usu√°rio e quais permiss√µes vai colocar no token. Aqui pode ter um banco com permiss√µes baseado em grupos ou o que for.

>> Coment√°rio de filipedeschamps:
> pois a conta s√≥ seria criada ap√≥s uma valida√ß√£o por email, certo?

Cara GENIAL, eu n√£o tinha pensado nesse fluxo. Do jeito que foi implementado aqui √© feito um `POST` no `/users` e j√° √© criada a entidade do usu√°rio, mas num estado de "n√£o ativado". Faz total sentido do jeito que voc√™ falou que √© criar um convite por email para poder criar uma conta üòç  A gente poderia apenas pedir o email no cadastro, e depois que o convite chegar no email dela, ela pode usar esse token para escolher o `username` e `password`. Brilhante! N√£o sei se vale a pena mudar isso agora, mas com certeza deixei anotado mentalmente aqui pra explorar isso no futuro ü§ù 

Do restante que voc√™ falou entendi ent√£o que √© uma mistura de stateless com stateful na verdade, pois se em algum momento voc√™ precisou conferir algum "state" para autorizar ou recusar (por exemplo a lista que comentou barrando um token), j√° n√£o √© mais stateless na minha vis√£o. Mas √© uma mistura interessante porque voc√™ pode fazer a confer√™ncia do state (a lista) em apenas 1 ponto central/inicial, e passando disso todas as outras confer√™ncias em outros servi√ßos ficam stateless. Correto?

>> Coment√°rio de Dgdiniz:
Sobre a √∫ltima pergunta, sim, seria isso, por√©m no momento ainda n√£o estamos fazendo essa lista. Como eu disse eu n√£o manjava nada sobre isso at√© 1 m√™s atr√°s üòÇ Estou aprendendo agora com outras pessoas que j√° entendem do assunto e com alguns cursos tb. Ent√£o s√≥ estou dando ideias baseado no que estou vendo aqui, pois essa parte tem muita coisa que pode ser feita. 

Sobre a conta tem que tomar cuidado com ataques, pois se vc j√° criar uma conta pra qualquer mensagem que chegar no /users, com certeza muita gente vai come√ßar a fazer scripts enviando emails aleat√≥rios pra entupir de usu√°rios n√£o ativados. Ent√£o os usu√°rios s√≥ devem ser criados depois de uma confirma√ß√£o. Ou pelo menos ficar limpando as contas de tempos em tempos, algo assim.

>> Coment√°rio de rodrigoKulb:
@Dgdiniz √≥timos pontos resumindo temos essas 3 solu√ß√µes, certo?

1 - Trabalhar o pr√©-usuario em tabela separada da user, com vencimento de "reserva do username".
Obs: Desta forma deixamos a tabela usu√°rio mais clean, deixando essa camada mais segura.

2 - Usu√°rio com status de "pre-usu√°rio", s√≥ seria atribu√≠do o username  / senha, ap√≥s clicar no link de ativa√ß√£o.
Obs: Resolvemos o problema do Outlook de clicar no link, s√≥ libera o cadastro apos preenchimento completo da informa√ß√£o.

3 - Cron para limpar usu√°rios que n√£o ativaram as contas apos um per√≠odo liberando o username novamente.
Obs: Solu√ß√£o simples e n√£o requer modifica√ß√£o no fluxo atual.

Seria isso ou temos mais op√ß√µes?

>> Coment√°rio de filipedeschamps:
@Dgdiniz perfeito! üëç 

E @rodrigoKulb show!! Eu tinha pensado numa outra abordagem, mas muito similar ao que voc√™ j√° falou: ao inv√©s de ter uma tabela para pr√©-usu√°rios, ter uma tabela de "token de cria√ß√£o de usu√°rio", que de informa√ß√µes do usu√°rio, s√≥ tem o email, e o sistema manda para esse email o token especial de cria√ß√£o de usu√°rio. Ao clicar no link do email, a pessoa cai num form em que pode escolher o seu nome de usu√°rio e senha, e ao fazer o post, o c√≥digo do client-side manda junto da request esse token especial... se ele estiver v√°lido (junto com o resto das informa√ß√µes que o usu√°rio escolheu), √© criado o usu√°rio e o token √© marcado como usado.

De qualquer forma, a pessoa motivada pode fazer um script para usar infinitos emails (principalmente com o `+` do gmail), receber o token e usar para criar os usu√°rios. Acho que a √∫nica coisa que mitiga ataque √© rate-limiting ou block por algum padr√£o (se ela tiver usand o mesmo ip, por exemplo) ou qualquer outra estrat√©gia mais inteligente.

Em paralelo, continuo achando genial a ideia de primeiro pedir o email e depois criar o cadastro, e para a nossa situa√ß√£o atual eu iria com a op√ß√£o `3` do @rodrigoKulb e limpar os usu√°rios, ou marcar eles como "exclu√≠dos" e o model precisa levar isso em considera√ß√£o na query (isso foi abordado no t√≥pico de `content` pelo @inovaprog)

A gente podia at√© colocar essa l√≥gica dentro da lamba que cria usu√°rio, dela ter a responsabilidade de limpar os usu√°rios. Da√≠ n√£o precisar√≠amos nos preocupar com um `cron` e cria√ß√£o do usu√°rio j√° √© super devagar por conta da hash da senha.

>> Coment√°rio de filipedeschamps:
Estou organizando a pr√≥xima Milestone e vou fechar essa issue e mover o conte√∫do que faz sentido ü§ù
</issue_217_Draft da Milestone 3>

<issue_218_Subir ambiente de produ√ß√£o, rodar migrations e possibilitar Membros criarem novas contas>
Se tudo der certo, essa issue vai ser fechada na [Live de encerramento de hoje](https://youtu.be/c5sdors9rXE), marcando a conclus√£o da Milestone 2 ü§ù

>> Coment√°rio de juniorbotelho:
@filipedeschamps Interessante o Terraform para o gerenciamento da infra. Apenas como informa√ß√£o, da uma olhadinha no https://www.pulumi.com/, ele tamb√©m √© um IaC, s√≥ que ao inv√©s de funcionar baseado em uma linguagem declarativa pr√≥pria, ele pode ser configurado usando a linguagem que voc√™ desejar, por exemplo, o pr√≥prio Javascript.

Lembrando que essa sugest√£o √© s√≥ para fins de informa√ß√£o mesmo üß†.

>> Coment√°rio de filipedeschamps:
Que sensacional @juniorbotelho !! Eu nunca entendi porque o Terraform n√£o escolheu uma linguagem popular üëç

>> Coment√°rio de rodrigoKulb:
Criei o usu√°rio üëèÔ∏èüëèÔ∏èüëèÔ∏èüëè
![Captura de tela em 2022-03-18 14-56-52](https://user-images.githubusercontent.com/5334261/159057642-1ceb6282-5699-4637-9432-249087143524.png)
Ô∏è

>> Coment√°rio de filipedeschamps:
Criei o meu tamb√©m üëç 

<img width="784" alt="image" src="https://user-images.githubusercontent.com/4248081/159058792-057001aa-1d7a-48b9-b822-1786e0d7b579.png">

>> Coment√°rio de ygorch:
T√° massa!

![Screen Shot 2022-03-18 at 15 05 03](https://user-images.githubusercontent.com/9532475/159058894-1fabb0c9-444e-4607-a565-346d2c6ae47d.png)

>> Coment√°rio de andrefd17:
Criei o meu tbm üòÉ 
![image](https://user-images.githubusercontent.com/26145982/159302753-396a0b24-a372-4191-8bbe-5068afa1200b.png)

>> Coment√°rio de filipedeschamps:
Muito massa üòç 

Em paralelo, o Sendgrid n√£o est√° conseguindo enviar emails para dom√≠nios da Microsoft, como Hotmail, Outlook, etc.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps ser√° que n√£o vale ter uma op√ß√£o de autentica√ß√£o via sms? Outra op√ß√£o √© ter 2 servi√ßos de envio de e-mail, primeiro sempre envia pelo sendgrid, o segundo enviar pela segunda op√ß√£o. outra d√∫vida √© se existe o servi√ßo de reenvio de e-mail do token?

>> Coment√°rio de filipedeschamps:
Show! Eu n√£o traria uma nova forma de autentica√ß√£o agora antes de masterizar a atual. O detalhe √© que esse problema n√£o est√° do nosso lado, mas temos alternativas, como por exemplo comprar um IP Privado, que da√≠ a sa√∫de dele √© definida pelo nosso trabalho (diferente do IP Compartilhado de hoje). Ou podemos tamb√©m trocar de servi√ßo.

Sobre um Servi√ßo B de email, acho show.

E o Sendgrid pelo que vi n√£o oferece servi√ßo de reenvio de email pela interface deles (precisa ver se eles tem API). Mas independente disso, precisamos de alguma forma implementar isso na API para a pessoa (por exemplo) poder fazer um novo cadastro com os mesmos dados e ao inv√©s do backend reclamar, ele gerar um novo token de ativa√ß√£o.

>> Coment√°rio de f-francine:
![image](https://user-images.githubusercontent.com/66988170/159392152-5cb2af62-1a88-4057-be2b-a072c1010828.png)
Consegui criar aqui, mas como foi mencionado acima, como o email que usei foi da microsoft, n√£o chegou nada para ativar a conta.

Percebi que pra nome de usu√°rio, n√£o √© permitido usar caracteres n√£o alfanum√©ricos (tentei colocar como username <br>`f-francine`). Existe um lado ruim em permitir simbolos como `-` para username? S√≥ curiosidade mesmo hehe

>> Coment√°rio de filipedeschamps:
@f-francine show!!!

1) √â uma pena darmos esse azar com o Sendgrid. Mas [nessa issue](https://github.com/filipedeschamps/tabnews.com.br/issues/220) j√° estamos avaliando alternativas e no [draft da Milestone 3](https://github.com/filipedeschamps/tabnews.com.br/issues/217) l√° no final eu inclu√≠ um novo item para que os pr√≥prios usu√°rios consigam recuperar suas contas.

2) Sobre os requisitos no `username`, o princ√≠pio foi deixar ele mais compat√≠vel com tudo que poderemos fazer daqui para frente com ele, mas esse princ√≠pio foi decidido por vozes na minha cabe√ßa üòÇ e podemos mudar ao longo da evolu√ß√£o do projeto (e as pessoas poder√£o da√≠ atualizar esse dado).
</issue_218_Subir ambiente de produ√ß√£o, rodar migrations e possibilitar Membros criarem novas contas>

<issue_219_Falha para criar novo usu√°rio>
@filipedeschamps fui fazer outro teste e retornou um erro de permiss√£o, normal?

![Captura de tela em 2022-03-18 15-22-49](https://user-images.githubusercontent.com/5334261/159061592-7c2a2911-01e1-4bd5-9626-455d2aa28e85.png)

>> Coment√°rio de geovani-brito:
Voc√™ usou o mesmo email do primeiro registro?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show!! Voc√™ se logou, correto? Eu especulo isso por conta do `Header [1]` e por conta da mensagem.

Isso vai acontecer quando voc√™ usar a sess√£o do seu **atual usu√°rio**, para criar um **outro usu√°rio**. Voc√™ recebe essa mensagem, porque de fato seu usu√°rio n√£o tem a feature `create:user`:

```
    "username": "rodrigoKulb",
    "features": [
      "create:session",
      "read:session",
      "create:post",
      "create:comment",
      "update:user"
    ],
```

N√£o sei se isso √© um comportamento bom para ser sincero. A gente deveria usu√°rios poderem criar outros usu√°rios? Ou esse tipo de situa√ß√£o s√≥ vai existir em tentativas de teste assim?

>> Coment√°rio de rodrigoKulb:
@filipedeschamps nossa verdade! Estou com o a session no usu√°rio, ele n√£o tem permiss√£o para criar novos, realmente pensando na l√≥gica n√£o precisa dessa permiss√£o, porem √© estranho que um usu√°rio tenha menos permiss√£o que um anonimo hahaha!! Mas acho que n√£o ir√° interferir no processo geral.

>> Coment√°rio de filipedeschamps:
> porem √© estranho que um usu√°rio tenha menos permiss√£o que um anonimo 

üòÇ just√≠ssimo!!

Mas que bom que esbarrou nessa condi√ß√£o, isso significa que o sistema de features est√° funcionando ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps super vou finalizar aqui!
</issue_219_Falha para criar novo usu√°rio>

<issue_220_Ajuda: Sugest√£o de provider de email (estamos com problema no envio de emails para Microsoft)>
Hoje estamos no seguinte plano do [Sendgrid](https://sendgrid.com/pricing/):

<img width="336" alt="image" src="https://user-images.githubusercontent.com/4248081/159483817-b3a3416d-d682-4c6c-81e3-0092b0fc4997.png">

Ele nos d√° um **IP compartilhado**, e para nossa conta foi atribu√≠do um IP que est√° banido pelos servidores da Microsoft e impedindo que emails para Hotmail, Outlook, etc. cheguem nas caixas (n√£o chega nem no spam, o servidor nega o recebimento).

N√≥s podemos fazer o upgrade para o Pro que ele nos d√° um **IP dedicado**:

<img width="338" alt="image" src="https://user-images.githubusercontent.com/4248081/159484213-e68f35b9-5b88-4859-9b94-7e6486fd6d6c.png">

E a√≠ mesmo que esse IP tenha sido abusado no passado, a gente pode pedir para os providers liberar ele e recome√ßar a criar nossa reputa√ß√£o.

Ele tamb√©m fornece **Reverse DNS** que no passado na √©poca que estava montando a Newsletter lembro que isso era um requisito para emails da Microsoft.

De qualquer forma, o valor de **$89.95** comporta at√© 200 mil emails por m√™s, e depois pula para **$249**.

Algu√©m conhece algum outro provider que seja bom ou vamos de Sendgrid mesmo no plano Essentials?

>> Coment√°rio de amonigor:
Dei uma pesquisada r√°pida e achei esse [MailerSend](https://www.mailersend.com/), procurei reviews por outros sites e parece ser bom de utilizar, o plano premium √© 10 dolares a mais que o da sendgrid e j√° oferece um endere√ßo de **IP dedicado**

![image](https://user-images.githubusercontent.com/48227869/159487165-462c6aed-be4e-473f-ae85-87234b9c8b31.png)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps nessa etapa de teste do projeto n√£o consegue utilizar uma conta gmail?
Segue os limites:
https://support.google.com/a/answer/166852?hl=pt-BR

>> Coment√°rio de filipedeschamps:
Ahh que ideia massa @rodrigoKulb ! [Lendo aqui sobre limites no SMTP](https://support.google.com/a/answer/2956491#sendinglimitsforrelay&zippy=%2Cveja-os-limites-de-envio-do-servi%C3%A7o-de-redirecionamento-smtp) me veio at√© em mente criar v√°rios emails e ir randomicamente distribuindo e enviando por eles üòÇ 

Minha √∫nica preocupa√ß√£o √© isso n√£o ser escal√°vel e acabar n√£o construir uma reputa√ß√£o em um outro provider/ip.

Mas mandar pelos servidores do Gmail teria uma entregabilidade abusrda eu imagino.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb lendo aqui estou seriamente considerando usar o Gmail, pelo menos para o principal email que iremos enviar na vida do usu√°rio dentro do sistema, que √© sobre a ativa√ß√£o da conta.

Faz sentido n√©?

Para outros emails, por exemplo notifica√ß√µes, podemos segmentar para outro provider.

>> Coment√°rio de filipedeschamps:
√â, pode n√£o ser t√£o f√°cil assim porque a integra√ß√£o por SMTP deles √© cheio de detalhes, por exemplo um que pode complicar no nosso caso por ser serverless:

<img width="1148" alt="image" src="https://user-images.githubusercontent.com/4248081/159545960-aa05485c-07a5-4253-9987-88ff5fb2aab4.png">

E o c√°lculo de limite di√°rio √© bem confuso e depende da quantidade de usu√°rios totais na organiza√ß√£o.

>> Coment√°rio de filipedeschamps:
@amonigor o ip dedicado √© cobrado a parte e n√£o to achando o pricing 

<img width="215" alt="image" src="https://user-images.githubusercontent.com/4248081/159576794-405ca4fb-efac-484b-bb57-dc8e87e934c2.png">

>> Coment√°rio de amonigor:
@filipedeschamps segue a p√°gina do [pricing](https://www.mailersend.com/pricing)
Realmente n√£o tinha visto que o IP era a parte, mas acredito que n√£o acrescente muito ao valor.
Mas pelo o que eu vi tamb√©m tem como fazer planos personalizados falando com a equipe de vendas.
De qualquer jeito vou continuar a buscar outras op√ß√µes

>> Coment√°rio de filipedeschamps:
@amonigor desculpa n√£o fui claro, n√£o estava encontrando em lugar algum o pricing do ip dedicado üòÇ üëç 

Uma alternativa bastante popular √© o https://www.mailgun.com/pricing/  oferecem IP dedicado no Foundation 100k e eles parecem ser bem "developer friendly".

<img width="433" alt="image" src="https://user-images.githubusercontent.com/4248081/159578257-cc8c84fc-e1bf-4147-9c3f-76b30b5f783d.png">

>> Coment√°rio de Dgdiniz:
Ol√° a todos. Estou caindo de paraquedas aqui e preciso dar uma lida nas centenas de outras mensagens anteriores. Pra esse caso do email o Aws SES n√£o seria uma op√ß√£o?

>> Coment√°rio de amonigor:
@filipedeschamps Mailgun parece uma alternativa bem completa.
@Dgdiniz AWS √© uma boa alternativa interessante, acho que final vai depender do pre√ßo mesmo para decidir

>> Coment√°rio de filipedeschamps:
@Dgdiniz faaala meu caro, quanto tempo! üòç 

Eu tive uma experi√™ncia com o SES quando fui construir a Newsletter e a UX de desenvolvimento foi √≥tima, mas tinha o **exato** mesmo problema de entregabilidade que o Sendgrid est√° tendo, n√£o chegavam os emails em endere√ßos da Microsoft.

>> Coment√°rio de filipedeschamps:
Antes de trocar de provider, fiz um teste aqui, de fato ta meio bagun√ßado: https://www.mail-tester.com/test-ouqwvwy5w

<img width="1127" alt="image" src="https://user-images.githubusercontent.com/4248081/159584207-8816fe58-bb72-47fb-96fe-69cb38a83019.png">

Os piores itens:

<img width="1126" alt="image" src="https://user-images.githubusercontent.com/4248081/159584261-28ce6e80-0a83-44df-be87-5c4f2136f8ac.png">

<img width="1134" alt="image" src="https://user-images.githubusercontent.com/4248081/159584281-924878c0-2647-4ee6-b86f-f9c4463ee0ab.png">

>> Coment√°rio de filipedeschamps:
# Score de 10/10 usando Mailgun

<img width="1144" alt="image" src="https://user-images.githubusercontent.com/4248081/159596768-6f15c14f-1a17-415d-9510-d46f84ea9f65.png">

A √∫nica coisa que ele reclamou, foi faltar um link e cabe√ßalho para "sair da lista", mas o email de ativa√ß√£o √© transacional, n√£o √© um email em massa.

<img width="1123" alt="image" src="https://user-images.githubusercontent.com/4248081/159596853-d9c5a167-71d0-4f38-a666-fc533ab15193.png">

# Outlook üéâ

Outra √≥tima not√≠cia, √© que em ambiente de Staging, consegui criar um cadastro usando um email do Outlook e chegou na caixa de entrada normal üòç 

√önico detalhe estranho, √© que parece que o pr√≥prio Outlook acessou por conta pr√≥pria o link (talvez para fazer uma verifica√ß√£o?) e quando eu fui clicar, o convite j√° estava "usado". Talvez podemos mudar o comportamento para a API n√£o reclamar nessa condi√ß√£o.

<img width="1034" alt="image" src="https://user-images.githubusercontent.com/4248081/159596996-6536acb0-bd00-431e-8b22-991acad6bdb3.png">

---

Vou passar as configs para ambiente de produ√ß√£o agora üëç

>> Coment√°rio de filipedeschamps:
E confirmado, toda vez que eu abro o email dentro do client web no Outlook ele **proativamente faz um GET no link**.

>> Coment√°rio de filipedeschamps:
Configurado em produ√ß√£o e funcionando (email chegando pelo menos em dom√≠nio `outlook.com`) üëç 

Pr√≥ximo passo agora √© implementar uma forma das pessoas receberem um novo link de autentica√ß√£o e vamos fazer isso logo no in√≠cio da Milestone 3 e que n√£o vamos demorar para abrir ela ü§ù

>> Coment√°rio de amonigor:
Sucesso!
@filipedeschamps sobre o Outlook fazer um GET na URL, n√£o seria interessante mudar a p√°gina de verifica√ß√£o para ao usu√°rio clicar no bot√£o para verificar?
Tipo o fluxo seria email > redireciona para a p√°gina > clica para verificar
Da√≠ o usu√°rio poderia colocar um dado para confirmar tipo o pr√≥prio endere√ßo de email da conta, ou passaria por um captcha.

>> Coment√°rio de filipedeschamps:
@amonigor show! Como √© um token que fica vivo s√≥ por 15 minutos, n√£o acredito ser um vetor de ataque muito vi√°vel (considerando que um dia a API vai ter rate-limit). Por exemplo 5 tentativas sem sucesso de encontrar um convite, o ip √© bloqueado ou algo assim.

Isso d√° a conveni√™ncia da pessoa clicar no link que est√° no email e a p√°gina que abrir automaticamente fazer o post por ela. O que acha?

>> Coment√°rio de amonigor:
@filipedeschamps a conveni√™ncia √© importante para ficar mais simples para o usu√°rio, mas a ideia de "confirmar" a verifica√ß√£o √© para evitar situa√ß√µes como o outlook entrar no link e verificar pelo usu√°rio

>> Coment√°rio de filipedeschamps:
Ah entendi @amonigor ! Justo! O que precisamos ver ent√£o √© se o Outlook est√° apenas fazendo um GET "t√©cnico", vamos colocar assim (um `hit` simples s√≥ pra ver se o link existe)... ou se ele est√° de fato est√° abrindo e rodando o JS da p√°gina (o que especulo que n√£o). Se for um GET simples, o fluxo que sugeri vai funcionar, pois a p√°gina n√£o vai fazer o POST autom√°tico.

>> Coment√°rio de amonigor:
Entendi @filipedeschamps daria at√© para colocar um timeout para a execu√ß√£o do post para poder ter essa certeza

>> Coment√°rio de juniorbotelho:
@filipedeschamps Parece que esse "problema" do outlook dar GET nos links √© meio antigo, na verdade, isso √© o recurso de preview do pr√≥prio outlook, ele tenta gerar uma preview da URL, pra isso ele tem que fazer uma chamada GET no link em quest√£o.

Link: [How do I stop outlook from following links in email](https://stackoverflow.com/questions/32851044/how-do-i-stop-outlook-com-from-following-links-in-email)

√â prov√°vel que ele habilite o JS da p√°gina pra gerar essa preview.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps tenta capturar o header de leitura do Outlook, assim voc√™ consegue mapear o "user-agent" e bloquear o clique quando a origem for dele.

Acredito que seja a ferramenta de filtro de spam que faz isso, conforme esse link:
https://helpdesk.mindmatrix.net/portal/en/kb/articles/why-are-spam-filters-automatically-opening-and-clicking-through-links-in-my-emails-how-can-i-stop-it

>> Coment√°rio de filipedeschamps:
Muito massa a participa√ß√£o de voc√™s!!! Vou fazer refer√™ncia a isso tudo na issue que vai para a Milestone 3, e que inclusive deveria ser a primeira issue a ser executada ü§ù
</issue_220_Ajuda: Sugest√£o de provider de email (estamos com problema no envio de emails para Microsoft)>

<issue_221_Link de Ativa√ß√£o: Melhorias no comportamento>
## Descri√ß√£o
Hoje o TabNews n√£o possui nenhuma P√°gina Web e toda intera√ß√£o est√° sendo feita pelos Endpoints da API, incluindo o Link de Ativa√ß√£o. O usu√°rio hoje recebe literalmente o **Endpoint da API** `/api/v1/activate/xxx` no Email de Ativa√ß√£o, por exemplo:

<img width="551" alt="image" src="https://user-images.githubusercontent.com/4248081/160171293-f3f4891f-32b6-43bb-b58e-ef5efd9884c6.png">

Claramente isso n√£o √© a vers√£o final que vai ser exposta ao grande p√∫blico, mas isso gerou um outro problema [apontado nessa issue](https://github.com/filipedeschamps/tabnews.com.br/issues/220#issuecomment-1075773927) que √© o Outlook, de uma forma **proativa**, automaticamente abrir o Link de Ativa√ß√£o... antes mesmo do usu√°rio clicar.

Ent√£o l√° dentro dessa issue voc√™ vai encontrar uma √≥tima discuss√£o e sugest√µes dadas por @amonigor @juniorbotelho e @rodrigoKulb destacando que esse √© um comportamento real, esperado e que [outras pessoas est√£o reclamando](https://stackoverflow.com/questions/32851044/how-do-i-stop-outlook-com-from-following-links-in-email).

## Execu√ß√£o

Princ√≠pio para executarmos deve ser **dar a menor quantidade de trabalho para o usu√°rio**. Ent√£o isso me fez pensar, qual o objetivo real de um "Email de Ativa√ß√£o"? √â testar se a pessoa que est√° ativando √© um **humano** ou se o **email √© v√°lido**? E eu cheguei a conclus√£o que √© a segunda op√ß√£o... porque sinceramente, provar que uma a√ß√£o √© humana √© algo dif√≠cil sem penalizar a UX e isso n√£o deveria estar acontecendo no ato de ativa√ß√£o, e sim de cadastro (para evitar que um monte de conta maluca seja criada). O ato de ativa√ß√£o √© mais para se certificar que o email informado **√© v√°lido e consegue receber emails**... a partir da√≠, n√£o importa se o Outlook clicou no link... porque se clicou √© meio que a "prova" que o email existe e inclusive foi aberto (pois essa a√ß√£o autom√°tica s√≥ acontece na abertura do email).

Ent√£o segue abaixo as duas tasks que deveremos resolver para comportar que:

1. Usu√°rios normais, em outros providers de mail, cliquem no link, caiam numa p√°gina que automaticamente ativa a conta.
2. Usu√°rios de Outlook, ao clicar no link, mesmo que ele j√° tenha sido ativado, recebam uma mensagem de sucesso igual aos outros usu√°rios.

### Tasks

- [x] #224
- [x] #225
- [x] #227
- [x] #226

**Obs: irei transformar cada Task em uma issue separada** üëç

>> Coment√°rio de filipedeschamps:
Conte√∫do de todas as Tasks dessa issue foram criadas, onde eu estou com uma grande d√∫vida na √∫ltima: https://github.com/filipedeschamps/tabnews.com.br/issues/226

>> Coment√°rio de filipedeschamps:
Todas as tasks dessa grande issue foram resolvidas com maestria, levando a Milestone 3 para **53% finalizada** ü§ù üëç 

<img width="519" alt="image" src="https://user-images.githubusercontent.com/4248081/162277735-9a3868d0-f831-4ba8-b087-61c06de558fe.png">

**[edit] 61% com o fechamento dessa issue aqui** üéâ
</issue_221_Link de Ativa√ß√£o: Melhorias no comportamento>

<issue_222_`activation(api)`: ativar por POST e ser idempotente>

</issue_222_`activation(api)`: ativar por POST e ser idempotente>

<issue_223_`activation(api)`: ativar por POST e ser idempotente>


>> Coment√°rio de filipedeschamps:
Github bugado, to criando no atalho na outra issue e ele fica loading, mas no fundo tava criando as issues :/

<img width="723" alt="image" src="https://user-images.githubusercontent.com/4248081/160200740-489a9d65-3edb-4c92-98f4-5441d52f23bb.png">
</issue_223_`activation(api)`: ativar por POST e ser idempotente>

<issue_224_`activation(api)`: ativar por POST e ser idempotente>
## Contexto

Um princ√≠pio importante de APIs REST √© que um `GET` n√£o pode deixar nenhum efeito colateral no seu backend, no sentido de que vai modificar algo relevante no banco de dados, mas infelizmente n√£o √© o que est√° acontecendo no Link de Ativa√ß√£o. Hoje, ao realizar um `GET` em `/api/v1/activate/[token]` ele ir√° invalidar o token, e isto est√° implementado no handler do `GET` desse endpoint:

https://github.com/filipedeschamps/tabnews.com.br/blob/9c1f6d878dfbbec3c636e39ffaf23c896e142b56/pages/api/v1/activate/%5Btoken%5D.public.js#L16-L20

## Execu√ß√£o

Talvez o `GET` nesse endpoint **n√£o deveria existir** e deveria ser apenas um `POST` com quase a mesma funcionalidade. Digo quase, porque o jeito que eu implementaria √© renomear o handler de "get" para "post", mas ou o controller ou o model deveriam se comportar de uma forma **idempotente**, ou seja, eu como usu√°rio poderia fazer POSTs seguidos e enquanto tudo estiver ok, eu tamb√©m recebo um ok de volta.

N√£o sei qual a melhor estrat√©gia para isso, mas uma coisa √© certa: **uma conta s√≥ pode ser ativada uma √∫nica vez.** Ent√£o se o token j√° tiver sido usado ou expirado, n√£o fazer nada, apenas retornar ele sem o campo `user_id`.

O principal de tudo est√° nessa linha do handler:

https://github.com/filipedeschamps/tabnews.com.br/blob/9c1f6d878dfbbec3c636e39ffaf23c896e142b56/pages/api/v1/activate/%5Btoken%5D.public.js#L20

Possivelmente essa intelig√™ncia deveria ficar dentro do model, para centralizar e n√£o correr o risco de ativar duas vezes um usu√°rio. Possivelmente aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/0b5c524bd20c7e27bf84d75ab5e5b52d73fa00a9/models/activation.js#L80-L86

Ao inv√©s de procurar por um token v√°lido (n√£o expirado e n√£o usado), primeir procurar por um token (com um novo m√©todo `findOneById()`) e com isso verificar se ele est√° usado, apenas retornar o token (porque isso significa que ele j√° foi usado dentro do per√≠odo de expira√ß√£o). Se esse n√£o for o caso, da√≠ sim chamar essa fun√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/0b5c524bd20c7e27bf84d75ab5e5b52d73fa00a9/models/activation.js#L81

Ent√£o conectado ao retorno do token, ao final de tudo l√° no handler, hoje ele est√° retornando o **usu√°rio** atrelado ao token:

https://github.com/filipedeschamps/tabnews.com.br/blob/9c1f6d878dfbbec3c636e39ffaf23c896e142b56/pages/api/v1/activate/%5Btoken%5D.public.js#L22-L24

Talvez deveria retornar o **objeto do token** somente e passar por um novo filtro de output `read:activation_token` que remova o `user_id`.

### Minor fix

O nome do model `activation` e nome da vari√°vel `activate` n√£o est√£o iguais. Mudar o nome da vari√°vel para `activation`:

https://github.com/filipedeschamps/tabnews.com.br/blob/9c1f6d878dfbbec3c636e39ffaf23c896e142b56/pages/api/v1/activate/%5Btoken%5D.public.js#L3
</issue_224_`activation(api)`: ativar por POST e ser idempotente>

<issue_225_`activation(page)`: landing page respons√°vel por fazer o POST de ativa√ß√£o contra a API>
## Depend√™ncia

#224 

## Contexto

**Depend√™ncia: #224**

Hoje s√≥ existe o endpoint na API para ativar o usu√°rio, n√£o existe uma p√°gina feita para usu√°rios comuns.

## Execu√ß√£o

Ent√£o o que temos hoje √© algo como:

```
// endpoint da api
https://www.tabnews.com.br/api/v1/activate/a21d7920-dfab-4379-d9e8-c8df6d32b6dc
```

E devemos ter algo como:

```
// p√°gina web
https://www.tabnews.com.br/ativar/a21d7920-dfab-4379-d9e8-c8df6d32b6dc
```

Ao entrar nessa p√°gina, ela dever√° automaticamente fazer um `POST` para o endpoint da API:

```
// endpoint da api, o mesmo de antes
https://www.tabnews.com.br/api/v1/activate/a21d7920-dfab-4379-d9e8-c8df6d32b6dc
```

### Layout

Por enquanto n√£o temos os componentes de layout feitos, ent√£o a p√°gina pode ser implementada primeiro sem layout, o mais importante √© a funcionalidade. Podemos fazer o merge do PR com a p√°gina sem layout e deixar essa issue aberta, ou criar outra com as instru√ß√µes para adaptar ao layout final.
</issue_225_`activation(page)`: landing page respons√°vel por fazer o POST de ativa√ß√£o contra a API>

<issue_226_`session(api)`: conseguir gerar novos links/emails de ativa√ß√£o de contas n√£o ativadas>
## Contexto

Se por algum motivo (como o [problema de entrega para emails da Microsoft](https://github.com/filipedeschamps/tabnews.com.br/issues/220)) o usu√°rio n√£o conseguir receber o email de ativa√ß√£o e n√£o conseguir ativar a conta, ele fica preso no limbo. Precisamos de um mecanismo onde o usu√°rio possa receber um novo link de ativa√ß√£o.

## Execu√ß√£o

Talvez uma ideia seja ao tentar fazer um cadastro novo (e o sistema identificar que o usu√°rio existe, mas n√£o est√° ativo), gerar um novo link de ativa√ß√£o e enviar ao usu√°rio... ou uma nova rota e p√°gina de recupera√ß√£o totalmente separado.

Como sempre, h√° tradeoffs em cada escolha, mas eu prefiro a op√ß√£o n√∫mero 1 por causa de um fator de seguran√ßa: Hoje quando um email j√° est√° sendo usado na base, n√≥s retornamos essa informa√ß√£o, e saber que um email existe nesse caso √© uma **informa√ß√£o sens√≠vel**.

### Mas pensando em todas as combina√ß√µes, eu n√£o consegui fazer o sistema n√£o revelar que um email existe na base na √∫ltima condi√ß√£o (condi√ß√£o 3), preciso de ajuda!

Ent√£o ao se fazer um `POST` no `/api/v1/users`, o sistema deveria se comportar quando for enviado as seguintes informa√ß√µes:

1. **Username inexistente e Email inexistente?**
  - N√£o reclamar.
  - Criar user.
  - Enviar email de ativa√ß√£o.
  - Parar de retornar o user criado (como √© hoje) e retornar um objeto qualquer com uma mensagem para verificar o email.

2. **Username existente e Email existente ou inexistente?**
  - Se o username tiver feature `read:activation_token`:
    - Isso significa que a conta n√£o foi ativada.
    - Ignorar o email que foi enviado no `POST`.
    - Criar um novo token de **ativa√ß√£o** e enviar para o email do usu√°rio que est√° no banco de dados.
    - Retornar objeto qualquer com uma mensagem para verificar o email.
  - Se o username n√£o tiver a feature `read:activation_token`:
    - Isso significa que a conta j√° foi ativada em algum momento no passado.
    - Ignorar o email que foi enviado no `POST`.
    - Criar um novo token de **altera√ß√£o de senha (n√£o implementado ainda)** e enviar para o email do usu√°rio que est√° no banco de dados.
    - Retornar objeto qualquer com uma mensagem para verificar o email.

3. **Usu√°rio inexistente e email existente?**
  - N√£o reclamar.
  - Enviar email de recupera√ß√£o de senha.
  - Retornar um objeto qualquer com uma mensagem para verificar o email.
  - **Problema que eu travei**: a pessoa que est√° abusando do sistema vai poder verificar que o usu√°rio inexistente n√£o foi criado, o que vai sinalizar que o email existe na base.

---

### Mas depois de toda essa complexidade maluca, o Github n√£o se preocupa com isso!

Ao digitar o meu email, ele fala que o email √© inv√°lido ou j√° foi usado:

<img width="649" alt="image" src="https://user-images.githubusercontent.com/4248081/160217165-1d6ccf8d-85b3-4b45-8df5-370d3376ece0.png">

<img width="705" alt="image" src="https://user-images.githubusercontent.com/4248081/160217233-87310552-03e6-4a46-93c6-185d5d8e8726.png">

Ele retorna um `422 Unprocessable Entity` onde `The client should not repeat this request without modification.`

**E agora?**

>> Coment√°rio de filipedeschamps:
Cheguei em novas conclus√µes, tentando considerar tudo que pode acontecer nessa superf√≠cie (desde usu√°rios n√£o privilegiados, quanto privilegiados) e vou anotar aqui para ver se faz sentido.

## Numa vis√£o macro

No extremo, n√≥s temos 3 cen√°rios a se considerar:
 - Usu√°rios que querem receber novamente o email de ativa√ß√£o.
 - Usu√°rios n√£o autenticados e que podem tamb√©m n√£o lembrar da sua senha e est√£o trancados por fora da sua conta e est√£o tentando entrar.
 - Usu√°rios autenticados tentando atualizar email ou senha.

## Usu√°rios que querem apenas receber email de ativa√ß√£o

Basta usu√°rio tentar fazer login no site (criar sess√£o) e o sistema deve identificar:

1. Usu√°rio possui a feature `read:activation_token` e n√£o possui a feature `create:session`? Ent√£o a conta n√£o est√° ativa, backend envia email de ativa√ß√£o e no JSON retornado avisa que a conta n√£o est√° ativa e pede para pessoa verificar o email. O backend pode at√© dar throw num erro para retornar um status code diferente de `200`. E por que verificar as duas features listadas ali? Porque usu√°rios an√¥nimos possuem sempre a feature `read:activation_token` para justamente poderem conseguir ler o token enquanto n√£o s√£o usu√°rios autenticados.

E o ato de enviar um email de ativa√ß√£o √© bem simples, foi por exemplo usado aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/9c1f6d878dfbbec3c636e39ffaf23c896e142b56/pages/api/v1/users/index.public.js#L34

2. Do resto, por exemplo usu√°rio n√£o possui a feature `read:activation_token`? Ent√£o segue fluxo convencional de cria√ß√£o de sess√£o.

**Aten√ß√£o:** para essa issue, devemos implementar somente esse fluxo que √© adicionar a verifica√ß√£o no item 1.

---

## Usu√°rios n√£o autenticados

Eu escrevi **muita** coisa sobre esses outros fluxos, inclusive considerando a diferen√ßa de comportamento entre usu√°rios privilegiados ou n√£o, mas que iria confundir completamente essa issue aqui. Vamos manter o escopo dela para o problema que estamos passando agora.

Mas em resumo caso algu√©m queria pensar comigo:

####  Recuperando senha

Depois de reescrever pela terceira vez o conte√∫do todo dessa issue porque a complexidade foi naturalmente tomando conta, minha sugest√£o √© tamb√©m juntar aqui os dois fluxos em um √∫nico fluxo de **recupera√ß√£o de senha**:

```js
// POST /api/v1/reset/password
// Usu√°rio precisa enviar o email atrelado a conta.

{
  "email": "emailcadastrado@gmail.com"
}
```

Com isso, duas coisas podem acontecer:

1. Usu√°rio possui a feature `read:activation_token` e n√£o possui a feature `create:session`? Ent√£o a conta n√£o est√° ativa, backend envia email de ativa√ß√£o e no JSON retornado avisa que a conta n√£o est√° ativa e pede para pessoa verificar o email. O backend pode at√© dar throw num erro para retornar um status code diferente de `200`. E por que verificar as duas features listadas ali? Porque usu√°rios an√¥nimos possuem sempre a feature `read:activation_token` para justamente poderem conseguir ler o token enquanto n√£o s√£o usu√°rios autenticados.
2. Usu√°rio n√£o possui a feature `read:activation_token`? Ent√£o a conta j√° est√° ativa, backend cria token de altera√ß√£o de senha e no final do fluxo (usu√°rio passando pelo email) essa informa√ß√£o deve ser enviada no mesmo endpoint inicial, mas agora usando um `PATCH`:

```js
// PATCH /api/v1/reset/password
// Usu√°rio precisa enviar o email atrelado a conta.

{
  "token": "3DFBBA6224AFFB7676E1337926CDD6021BE9414C",
  "password": "nova!senha@desejada"
}
```

## Usu√°rios autenticados

1. **Usu√°rios privilegiados**: poder√£o fazer um PATCH direto na entidade do usu√°rio, sem precisar passar por fluxos, como fluxo de altera√ß√£o de senha ou email.
2. **Usu√°rios n√£o privilegiados**: dever√£o passar pelos fluxos, e podemos reutilizar os mesmos que forem criados ali em cima para recupera√ß√£o de senha/email, ou criar novos endpoints como `POST` `.../[username]/password` e `.../[username]/email` para criar os tokens e fluxos, e impossibilitar que ele fa√ßa um pr√≥prio PATCH na sua entidade para esses campos.

## Enquanto isso, rela√ß√£o do Github com "email"

Enquanto isso, achei interessante destacar que o Github pede o email na recupera√ß√£o de senha e avisa se o email n√£o √© encontrado (destaco isso por que √© mais um ponto que eles **n√£o escondem** a exist√™ncia de um email).

Ent√£o na recupera√ß√£o de senha eles pedem o `email` e fazem um `POST` contra uma URL espec√≠fica para resetar a senha `https://github.com/password_reset`

<img width="571" alt="image" src="https://user-images.githubusercontent.com/4248081/160409984-a16c92a6-bf53-462a-b762-310286b3acb3.png">

**Observa√ß√£o:** talvez o Github seja mais solto na quest√£o do email, porque para uma parte consideravel dos reposit√≥rios, o email pessoal est√° atrelado aos commits (como √© o caso dos meus reposit√≥rios).

>> Coment√°rio de filipedeschamps:
Avan√ßo sensacional nessa issue feito por @inovaprog no PR #258 

Mas s√≥ vou considerar que ela foi conclu√≠da quando eu contatar todos os usu√°rios que tiveram problema usando Outlook e eles derem o retorno que funcionou ü§ù quero fazer isso amanh√£ üëç

>> Coment√°rio de filipedeschamps:
Funcionou perfeitamente, confirmado inclusive por @vitoropereira que tinha um email do Hotmail e tinha uma das contas que estava no limbo da ativa√ß√£o üéâ 

Issue completada com sucesso!
</issue_226_`session(api)`: conseguir gerar novos links/emails de ativa√ß√£o de contas n√£o ativadas>

<issue_227_`activation(api)`: atualizar template do email com link para nova p√°gina de ativa√ß√£o>
## Depend√™ncia

#225 

## Contexto

**Depend√™ncia: #225**

Hoje no email de ativa√ß√£o, o link leva o usu√°rio para o endpoint da API, mas deveria levar para a p√°gina de ativa√ß√£o.

## Execu√ß√£o

Alterar o template do email de ativa√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/0b5c524bd20c7e27bf84d75ab5e5b52d73fa00a9/models/activation.js#L33-L40

E ao inv√©s de levar para:

```
// endpoint da api
https://www.tabnews.com.br/api/v1/activate/a21d7920-dfab-4379-d9e8-c8df6d32b6dc
```

Devemos levar o usu√°rio para:

```
// p√°gina web
https://www.tabnews.com.br/ativar/a21d7920-dfab-4379-d9e8-c8df6d32b6dc
```

---

Outra coisa √© nesse email adicionar na √∫ltima linha a seguinte informa√ß√£o:

```
Rua Ant√¥nio da Veiga, 495, Blumenau, SC, 89012-500
```

Ent√£o um exemplo final de tudo feito ficar√° assim:

```
filipedeschamps, clique no link abaixo para ativar seu cadastro no TabNews:

https://www.tabnews.com.br/ativar/a21d7920-dfab-4379-d9e8-c8df6d32b6dc

Caso voc√™ n√£o tenha feito essa requisi√ß√£o, ignore esse email.

Atenciosamente,

Equipe TabNews
Rua Ant√¥nio da Veiga, 495, Blumenau, SC, 89012-500`,
```
</issue_227_`activation(api)`: atualizar template do email com link para nova p√°gina de ativa√ß√£o>

<issue_229_user(page): cria√ß√£o de usu√°rios>
## Contexto

Hoje s√≥ √© poss√≠vel criar contas interagindo com a API em REST. Devemos ter uma p√°gina convencional para cria√ß√£o de contas.

## Execu√ß√£o

Uma p√°gina respons√°vel por fazer `POST` em `/api/v1/users` com os dados do usu√°rio:

```js
{
  "username": "xxxxxxx",
  "email": "xxxx@xxxx.com",
  "password": "xxxxxx"
}
```

Quem sabe ela pode ficar no endere√ßo `/cadastrar` ou `/cadastro`? Qualquer sugest√£o √© bem vinda.

### Layout

Vamos por enquanto copiar os layouts abaixo (s√£o da √©poca das POCs) e n√£o vamos nos preocupar em abstrair as coisas em componentes... vamos duplicar c√≥digo sem problema para descobrir o que queremos oficialmente ter como layout (quem sabe um design system) e da√≠ implementar as p√°ginas com a vers√£o final do que queremos:

- https://www.tabnews.com.br/pocs/home-08
- https://www.tabnews.com.br/pocs/post-01

### B√¥nus

Quando voc√™ envia algo mal formatado para a API, ela responde com um erro informando em `message` o que aconteceu e em `action` o que o usu√°rio deveria fazer. Isso pode ser utilizado pela p√°gina. Mas apesar disso, hoje a API n√£o retorna qual foi o `field` que deu erro na valida√ß√£o e se necess√°rio isso pode ser implementado.

>> Coment√°rio de vitoropereira:
@filipedeschamps utilizaremos axios?

>> Coment√°rio de filipedeschamps:
@vitoropereira √≥tima pergunta! Hoje temos declarado no projeto o [cross-fetch](https://www.npmjs.com/package/cross-fetch) e eu pessoalmente n√£o acho que √© uma abstra√ß√£o t√£o boa quanto o Axios, at√© porque n√£o √© para ser o mesmo n√≠vel de abstra√ß√£o na verdade. Mas eu acabo preferindo ficar perto de coisas que vem por padr√£o e acabam resolvendo o problema, ainda mais por estar vindo por padr√£o no Node.js tamb√©m.

A tend√™ncia de uso do m√≥dulo est√° boa:

<img width="394" alt="image" src="https://user-images.githubusercontent.com/4248081/160674046-6917687a-4fbb-439f-85e5-ee93848e9e0f.png">


Acredito ser mais "a prova de futuro"... n√£o o m√≥dulo em espec√≠fico, mas o `fetch` em s√≠. O que acha?

>> Coment√°rio de vitoropereira:
A grande vantagem de ficar com o fetch √© n√£o ter que termos problemas com atualiza√ß√µes do pacote. (Eu acho) J√° que √© nativo. Penso que a grande vantagem do axios, na minha opini√£o, √© algumas facilidades que ja vem embutido no pacote, como criar um interceptador. Mas como o objetivo aqui tamb√©m √© ser desafiado, caso precisarmos pq n√£o criar um na m√£o. üòÖ Se precisar vai ser um bom desafio. Acho valido ent√£o ficarmos nesse foco de tentar usar coisas que vem por padr√£o e acabam resolvendo o problema do mesmo jeito. üëç

>> Coment√°rio de filipedeschamps:
Issue conclu√≠da pelo merge de #245 e #247.

Let's gooooooo!!!!
</issue_229_user(page): cria√ß√£o de usu√°rios>

<issue_230_Nova entidade: Conte√∫dos>
## Contexto

Hoje s√≥ √© poss√≠vel criar `users` no sistema, e agora devemos come√ßar a implementar a entidade para ser poss√≠vel criar **conte√∫dos** no site. Eu destaco a palavra "conte√∫do", porque n√£o devemos nos limitar a apenas "not√≠cias" (dado ao nome do projeto "tab*news*"). N√≥s dever√≠amos poder hospedar qualquer tipo de conte√∫do, por exemplo:

- Not√≠cias
- Perguntas
- Artigos
- Tutoriais
- O que tiver valor concreto para quem trabalha com tecnologia.

Ent√£o a partir dessa nova entidade poderemos ter uma Home com conte√∫dos, o que significa que tamb√©m precisaremos **cozinhar** e mover a Home Atual e as POCs para o seu pr√≥prio endere√ßo (aquele /init que vai ficar eternizado). Por cozinhar entenda transformar ela em conte√∫do est√°tico que n√£o dependa de nenhuma depend√™ncia do projeto.

## Execu√ß√£o

Dado ao contexto acima, talvez devemos nos afastar do termo `news` para essa nova entidade e talvez usar algo como `content`. E uma ideia interessante a se pensar √© talvez aproveitar isso tamb√©m para os **coment√°rios** e imaginar que toda essa rela√ß√£o √© **conte√∫do se relacionando com conte√∫do**... e a √∫nica coisa que muda √© a hierarquia dele.

Por exemplo, eu posto uma "Not√≠cia" e naturalmente ela vai agregando "Coment√°rios". No final das contas √© tudo `content`... onde a diferen√ßa √© que o meu conte√∫do n√£o possui nenhum `parent`... j√° os coment√°rios criados sobre ela possuem o `parent` que √© a minha not√≠cia.

Ent√£o na hora de listar os conte√∫dos na Home, podemos pedir para a entidade retornar todos os itens que n√£o possuem `parent`. E na hora de formar a p√°gina individual de cada conte√∫do, mostrar no topo esse mesmo conte√∫do sem `parent` e logo abaixo os conte√∫dos que possuem o `parent` desse conte√∫do principal.

N√£o sei se vai ser prematuro, mas poder√≠amos especular nessa entidade que ela retorne a lista de conte√∫dos por **estrat√©gia**. Por exemplo, na primeira vers√£o, a estrat√©gia poderia ser `descending` e ela simplesmente retornar uma lista de conte√∫dos do mais novo para o mais antigo. J√° nos coment√°rios, ainda nessa primeira vers√£o, poderia ser `ascending` e retornar primeiro os coment√°rios mais antigos e depois os mais novos. Ter esse sistema de estrat√©gia nos d√° a liberdade de, logo em seguida, criar outras estrat√©gias mais sofisticadas e que considerem outros par√¢metros (e isso √© algo que vai acontecer nas pr√≥ximas Milestones, quando for implementado o TabCoin, por exemplo).

De qualquer forma, se conseguirmos tratar tudo como `content`, iremos matar **v√°rios** coelhos com uma paulada s√≥ e realmente atingir o que queremos atingir na parte de conte√∫do, que √© um coment√°rio poder ter o mesmo peso e qualidade que o conte√∫do principal. Isso acontece aqui nas issues do Github, pois se voc√™ parar para analisar, os exatos mesmos recursos do conte√∫do principal da issue, s√£o os mesmos para as respostas. At√© visualmente √© tudo igual... visualmente, porque pela API deles o objeto do conte√∫do principal √© diferente dos coment√°rios (n√£o sei como est√° modelado no backend).

Sobre os layouts, sugiro n√£o gastarmos muito tempo nessa Milestone, e duplicar c√≥digo sem medo para descobrirmos quais elementos vamos fazer o design final numa Milestone seguinte. Ent√£o por enquanto, vamos copiar e colcar o que foi desenhado aqui:

- https://www.tabnews.com.br/pocs/home-08
- https://www.tabnews.com.br/pocs/post-01

## Tasks

- [x] #231
- [x] #232
- [x] #233
- [x] #235

>> Coment√°rio de filipedeschamps:
Todos os conte√∫dos das issues que s√£o listadas ali nas tasks foram criados ü§ù

>> Coment√°rio de andrefd17:
A n√≠vel de estrutura do banco ao separar em diferentes tables content and content_comments poderia ser melhor para a performance? Visto que poderi√°mos particionar os dados em duas tabelas e na UI a gente mostra de uma forma que tenha tudo o mesmo peso?

>> Coment√°rio de filipedeschamps:
@andrefd17 demorei pra responder e imagino que especializar as tabelas possa gerar sim um ganho de performance, mas at√© como conversamos ao vivo, usar a mesma estrutura de conte√∫do ajudou em v√°rios outros aspectos. Mas vamos ver at√© onde tudo isso se sustenta üòÇ üëç
</issue_230_Nova entidade: Conte√∫dos>

<issue_231_Cozinhar a Home e POCs em arquivos est√°tico e independentes>
## Contexto

Algo que eu pessoalmente tenho **muito orgulho** √© o que fizemos na Home atual do site, colocando em um √∫nico par√°grafo o esp√≠rito desse grupo que est√° se formando na internet e tamb√©m logo abaixo todo mundo que participou a primeira virada de chave do projeto, segue o print de um peda√ßo da Home:

<img width="1013" alt="image" src="https://user-images.githubusercontent.com/4248081/160494816-3390ddbd-b8c0-4170-8c14-b9966436d17b.png">

Quem estava l√° sabe como esse dia foi especial, foi realmente muito massa e a energia dessa p√°gina deve reverberar para sempre, por isso a id√©ia √© cozinhar essa Home e manter ela assim para sempre, mas em uma p√°gina especial para ela.

## Execu√ß√£o

Usando como base a issue #207 devemos cozinhar a Home e todas as POCs dentro do endere√ßo `/init`. Por que **init**? Porque `init` √© o primeiro comando que voc√™ executa quando come√ßa um reposit√≥rio do zero:

```
$ git init
```

E as POCs que foram desenvolvidas em paralelo devem tamb√©m serem cozinhadas e movidas para `/init/pocs`. Todas as p√°ginas das POCs podem ser encontradas dentro do reposit√≥rio mesmo, elas est√£o em `/pages/pocs/*`

### D√∫vidas na performance

A sugest√£o dada na issue #207 √© um pouco bruta, porque √© usado uma extens√£o que pega todas as depend√™ncias externas da p√°gina e "rasteriza" tudo para dentro do HTML, incluindo as imagens (transforma tudo em Base64, del√≠cia). Ent√£o no teste feito pelo @rodrigoKulb, a Home ficou com **6,7mb**. N√£o vejo isso como um problema para ser sincero, a n√£o ser que o Next.js ou a Vercel estoure por algum motivo.

### D√∫vidas na compatibilidade

Tamb√©m como reportado pelo @rodrigoKulb a extens√£o n√£o cozinhou algumas coisas, como por exemplo os confetes caindo. N√£o sei o que fazer para ser sincero e n√£o vejo problema implementar isso de novo, direto na p√°gina e sem passar pelo React, porque o `react-confetti` usado no projeto pra isso tem como base esse Codepen aqui: https://codepen.io/Gthibaud/pen/ENzXbp

Parece que os avatares n√£o s√£o randomizados na vers√£o cozinhada... e tamb√©m, eu implementaria isso na unha se esse for o caso.

### Conclus√£o

Fazer o que for preciso, para manter as informa√ß√µes e a apar√™ncia original da Home e POCs, de uma forma que fiquem **totalmente independentes** das depend√™ncias do projeto, por exemplo, atualiza√ß√µes do React e Tailwind CSS.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps s√≥ para atualizar a situa√ß√£o dessa issue, estou no seguinte dilema:

Conforme informado na inssue #207 o [SingleFile](https://github.com/gildas-lormeau/SingleFile) √© muito bom para gerar o base64 das imagens, sem deixar depend√™ncia de arquivos externos, porem acaba com o JS bugando o sistema rand√¥mico e os confetes. Tentei abrir o arquivo html para fazer as corre√ß√µes o problema √© que ele deixa minificado um arquivo html de 5Mb praticamente imposs√≠vel de identificar qualquer possivel problema, fora que a cpu vai l√° pra casa do chap√©u hahaha!!

Fiz outro teste baixando a p√°gina pelo navegador chrome com o ctrl + s, ele baixou todos arquivos / depend√™ncias certinhos, Somente com um pequeno problema nas imagens super tranquilo de resolver.

*Sugest√£o*
Baixar o site pelo chrome, depois tentar unificar todo JS + Imagens em um √∫nico arquivo. O bug do js est√° em quando migramos o arquivo para inline alguns par√¢metros n√£o s√£o compat√≠veis.
Exemplo do primeiro erro que retornou abaixo:
![Captura de tela em 2022-04-06 12-49-50](https://user-images.githubusercontent.com/5334261/162015683-da9628f4-1861-4bc1-bde9-202faec0374e.png)
![Captura de tela em 2022-04-06 12-49-30](https://user-images.githubusercontent.com/5334261/162015688-2a1a4598-a52c-47e3-b858-5a8f4fb92f60.png)

Estou seguindo esse caminho se algu√©m tiver alguma outra sugest√£o ser√° muito bem vinda!

>> Coment√°rio de filipedeschamps:
Ahhhhh que sensacional @rodrigoKulb muito obrigado por colocar a m√£o na massa e descobrir essas alternativas! Eu acredito que n√£o importa o meio que utilizarmos para cozinhar a p√°gina, e a sugest√£o que voc√™ deu parece √≥tima!

E em paralelo estou pensando: como que vamos hospedar e disponibilizar isso? No sentido de: vamos conseguir retornar a p√°gina em `www.tabnews.com.br/init` por exemplo? Eu acho que n√£o heim, a n√£o ser que n√≥s colocamos a vers√£o cozinhada no `/public/init` a p√°gina `/init` abra um iframe que abre esse est√°tico p√∫blico. Faz sentido?

>> Coment√°rio de filipedeschamps:
Ou at√© melhor, fazer o `/init` ser uma p√°gina beeem crua, que explica do que se trata e lista/linka para os est√°tico que podem estar cozinhados em `/public/init`. Acho que fica mais f√°cil e compreens√≠vel.

>> Coment√°rio de filipedeschamps:
O `<h1>` dessa p√°gina poderia ser **Museu TabNews** üòÇ

>> Coment√°rio de rodrigoKulb:
> E em paralelo estou pensando: como que vamos hospedar e disponibilizar isso? No sentido de: vamos conseguir retornar a p√°gina em `www.tabnews.com.br/init` por exemplo? Eu acho que n√£o heim, a n√£o ser que n√≥s colocamos a vers√£o cozinhada no `/public/init` a p√°gina `/init` abra um iframe que abre esse est√°tico p√∫blico. Faz sentido?

https://nextjs.org/docs/basic-features/static-file-serving
Se colocar a p√°gina html dentro da pasta public/init.html ela ficar√° acess√≠vel assim:
https://tabnews.com.br/init.html

>> Coment√°rio de rodrigoKulb:
Inclusive qualquer doc/tag que voc√™ precisar colocar como robots.txt ou arquivos de autentica√ß√£o do Google Webmaster ficariam nessa pasta.

>> Coment√°rio de filipedeschamps:
Perfeito! Ent√£o vamos fazer o seguinte:

Eu vou abrir um PR que adiciona a p√°gina desse museu no `/init` e ela vai listar e apontar para os est√°ticos que ser√£o hospedados na pasta `/public/init`. Por exemplo:

```html
<a href="/init/home.html">Home comemorativa</a>
```

O que no file system do Next.js, conforme voc√™ apontou, estaria em:

```
/public/init/home.html
```

Da√≠ voc√™ pode baixar essa branch e fazer o commit com os est√°ticos, ou abrir outro PR com eles.

Ent√£o eu vou agora fazer o levantamento dessa lista, incluindo os autores de cada POC ü§ù

>> Coment√°rio de filipedeschamps:
@rodrigoKulb acho que ficou mais claro na minha cabe√ßa que ao inv√©s de agruparmos essas coisas no `/init`, n√≥s dever√≠amos agrupar no `/museu` e l√° ser√° listado a p√°gina de init (nossa atual home) e as outras pocs, e talvez outras coisas que possam fazer parte do nosso museu ao longo do desenvolvimento do projeto.

O PR com o esqueleto √© o #254 faltando o fil√© mignon que s√£o os est√°ticos, e que poderiam ficar hospedados em `/public/museu`

O que acha?

>> Coment√°rio de rodrigoKulb:
@filipedeschamps concordo totalmente! Vamos seguir assim!

>> Coment√°rio de rodrigoKulb:
@filipedeschamps todo desenvolvimento √© uma escola, resumindo como fiz para conseguir criar esse html.
Baixei do chrome (ctrl+s) toda p√°gina, depois coloquei todos arquivos JS e CSS dentro do html, no final ficaram as imagens. Criei um programa em PHP para ler as imagens e gerar um base64 de cada uma criando um c√≥digo js compat√≠vel com o mesmo utilizado no site original.

Eu mantive exatamente os arquivos originais somente fazendo os ajustes necess√°rios para funcionar em uma √∫ncia p√°gina.
O arquivo html ficou com 17.8Mb, acredito que conseguimos reduzir um pouco rodando um processo de Minify.

Outra possibilidade √© migrar todas imagens para o formato **webp** que √© bem mais leve e depois gerar o base64, estaria alterando arquivos por isso importante saber se podemos fazer. Apesar de ter a mesma qualidade do PNG / JPEG.

No exemplo abaixo mantendo a mesma qualidade reduziu 6 vezes o tamanho do arquivo.
![Captura de tela em 2022-04-07 00-26-48](https://user-images.githubusercontent.com/5334261/162114277-c24a4071-eebc-4632-98b9-0f18fbae724f.png)
Se topar fazer posso organizar essa migra√ß√£o dos arquivos.

Subi no meu servidor para fazer um teste:
https://rodrigo-kulb.com.br/tabnews.com.br/init.html

>> Coment√°rio de filipedeschamps:
Ahhhhh que sensacional @rodrigoKulb !!! Testei aqui e ficou perfeito!! E que trabalho sensacional, matou a pau!! E topo tamb√©m por WebP, a qualidade ficou √≥tima!

>> Coment√°rio de rodrigoKulb:
√ìtimo! Acabei de converter todos os PNGs e JPGs para WebP praticamente um milagre, eu adoro WebP com certeza vai acabar com PNG,GIF e JPG porque tem anima√ß√µes, transpar√™ncia e muito mais leve.

Resultado antes: 17,8 MB
Resultado depois: 5,0¬†MB

Segue o link com p√°gina atualizada:
https://rodrigo-kulb.com.br/tabnews.com.br/init.html

Vou criar a PR aqui se aprovar.

>> Coment√°rio de filipedeschamps:
Que sensacionaaaaaal @rodrigoKulb **aprovad√≠ssimo**! Inclusive ta abrindo bem mais r√°pido que a atual home üòç 

N√£o sabia que o WebP era t√£o completo assim, muito muito bom!!!!

Vou fazer o merge do outro PR ent√£o üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps fiz os testes nos demais arquivos da POCS com o [SingleFile](https://github.com/gildas-lormeau/SingleFile) e rodou normal! 
Podemos seguir com ele para essas p√°ginas?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb voc√™ √© o mestre dos arquivos do Museu! Voc√™ colocou a m√£o na massa total e o que voc√™ falar, est√° falado! ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps feito, a PR #263 qualquer coisa s√≥ chamar!

>> Coment√°rio de filipedeschamps:
Fechado por @rodrigoKulb e todo o trabalho pode ser encontrado nessa p√°gina: https://www.tabnews.com.br/museu

>> Coment√°rio de filipedeschamps:
E o fechamento dessa issue avan√ßa ainda mais a Milestone 3 (velocidade de desenvolvimento recorde, eu to sinceramente impressionado)

<img width="522" alt="image" src="https://user-images.githubusercontent.com/4248081/162966698-f42da34f-1fd5-479d-b7db-3bdfab07bf8b.png">
</issue_231_Cozinhar a Home e POCs em arquivos est√°tico e independentes>

<issue_232_content(api): CRUD>
## Contexto

Nova entidade para criar conte√∫dos dentro do TabNews. Vou replicar abaixo parte do que foi escrito na issue principal #230 e adicionar mais coisas üëç 

---

Hoje s√≥ √© poss√≠vel criar `users` no sistema, e agora devemos come√ßar a implementar a entidade para ser poss√≠vel criar **conte√∫dos** no site. Eu destaco a palavra "conte√∫do", porque n√£o devemos nos limitar a apenas "not√≠cias" (dado ao nome do projeto "tab*news*"). N√≥s dever√≠amos poder hospedar qualquer tipo de conte√∫do, por exemplo:

- Not√≠cias
- Perguntas
- Artigos
- Tutoriais
- O que tiver valor concreto para quem trabalha com tecnologia.

## Execu√ß√£o

Dado ao contexto acima, talvez devemos nos afastar do termo `news` para essa nova entidade e talvez usar algo como `content`. E uma ideia interessante a se pensar √© talvez aproveitar isso tamb√©m para os **coment√°rios** e imaginar que toda essa rela√ß√£o √© **conte√∫do se relacionando com conte√∫do**... e a √∫nica coisa que muda √© a hierarquia dele, pois assim inclusive conseguimos fazer um conte√∫do em √°rvore (onde voc√™ consegue responder um coment√°rio e ele fica aninhado)

Por exemplo, eu posto uma "Not√≠cia" e naturalmente ela vai agregando "Coment√°rios" e os coment√°rios tamb√©m recebem coment√°rios, como no Reddit ou HackerNews. No final das contas √© tudo `content`... onde a diferen√ßa √© que o meu conte√∫do n√£o possui nenhum `parent`... j√° os coment√°rios criados sobre ela possuem o `parent` que √© a minha not√≠cia. Isso de fato √© super vis√≠vel no HackerNews, pois todo coment√°rio tem seu link √∫nico e tudo l√° √© tratado como um `item`.

Ent√£o na hora de listar os conte√∫dos na Home, podemos pedir para a entidade retornar todos os itens que n√£o possuem `parent`. E na hora de formar a p√°gina individual de cada conte√∫do, mostrar no topo esse mesmo conte√∫do sem `parent` e logo abaixo os conte√∫dos que possuem o `parent` desse conte√∫do principal.

N√£o sei se vai ser prematuro, mas poder√≠amos especular nessa entidade que ela retorne a lista de conte√∫dos por **estrat√©gia**. Por exemplo, na primeira vers√£o, a estrat√©gia poderia ser `descending` e ela simplesmente retornar uma lista de conte√∫dos do mais novo para o mais antigo. J√° nos coment√°rios, ainda nessa primeira vers√£o, poderia ser `ascending` e retornar primeiro os coment√°rios mais antigos e depois os mais novos. Ter esse sistema de estrat√©gia nos d√° a liberdade de, logo em seguida, criar outras estrat√©gias mais sofisticadas e que considerem outros par√¢metros (e isso √© algo que vai acontecer nas pr√≥ximas Milestones, quando for implementado o TabCoin, por exemplo).

De qualquer forma, se conseguirmos tratar tudo como `content`, iremos matar **v√°rios** coelhos com uma paulada s√≥ e realmente atingir o que queremos atingir na parte de conte√∫do, que √© um coment√°rio poder ter o mesmo peso e qualidade que o conte√∫do principal. Isso acontece aqui nas issues do Github, pois se voc√™ parar para analisar, os exatos mesmos recursos do conte√∫do principal da issue, s√£o os mesmos para as respostas. At√© visualmente √© tudo igual... visualmente, porque pela API deles o objeto do conte√∫do principal √© diferente dos coment√°rios (n√£o sei como est√° modelado no backend).

E numa pesquisa r√°pida, a princ√≠pio d√° para construir isso usando **Depth First Search** ou **Recurs√£o**. N√£o sei, nunca implementei esse algoritmo.

### Entidade e Endpoint

Entidade: `content`

Endpoint, algumas ideias:

- `/api/v1/contents`
- `/api/v1/contents/[username]/[slug]`
- `/api/v1/contents/[slug]`

Super rabisco e qualquer ideia √© bem vinda.

### Campos

Isso eu sempre tenho dificuldade em especular, mas vamos l√°:

- id [required]
- owner_id [required]
- parent_id
- slug [se n√£o tiver `parent_id` - required]
- title [se n√£o tiver `parent_id` - required]
- body [required]
- status [required]
- source_url
- created_at [required]
- updated_at [required]

### Detalhe do "post slug"

Isso √© uma informa√ß√£o √∫nica e √© o que vai formar a URL, por exemplo:

```https://www.tabnews.com.br/baixe-urgente-nova-versao-do-chrome```

Mas assim seco direto na raiz √© estranho... que tal ter o usu√°rio como prefixo, assim como aqui no Github?

```https://www.tabnews.com.br/filipedeschamps/baixe-urgente-nova-versao-do-chrome```

Assim isso j√° fica preparado para cada usu√°rio j√° pode ter sua p√°gina:

```https://www.tabnews.com.br/filipedeschamps```

O que me faz pensar que precisaremos implementar uma lista de usernames banidos, como por exemplo: `init`, `sobre`, `tabnews`, `perfil` e tudo que devemos evitar para que o pr√≥prio site possa usar.

## Tarefas

- [x]  `GET` `contents/`
- [x]  `GET` `contents/[username]`
- [x]  `GET` `contents/[username]/[slug]`
- [x]  `GET` `contents/[username]/[slug]/children`
- [x]  `POST` `contents/`
- [x]  `PATCH` `contents/[username]/[slug]`

>> Coment√°rio de inovaprog:
Fala @filipedeschamps boa noite! Acho que seria interessante ter tamb√©m uma coluna 'deleted_at', por padr√£o null e quando algum conte√∫do for deletado a gente faz s√≥ um soft_delete marcando a data que aquele objeto foi exclu√≠do. Ai no futuro baseado em alguma l√≥gica pode ser exclu√≠do de verdade do banco ou movido para algum lugar.

>> Coment√°rio de filipedeschamps:
Interessant√≠ssimo @inovaprog ! Voc√™ me fez pensar no content ter algo como um `status` que pode variar entre coisas como `draft`, `published` e `deleted` e da√≠ o `updated_at` reflete isso e outras atualiza√ß√µes. O que acha?

>> Coment√°rio de inovaprog:
Sim sim resolve o problema. Em um projeto que trabalhei tamb√©m era assim depois adicionamos essa outra coluna pela possibilidade de deletar o objeto no futuro e tamb√©m pq us√°vamos o typeorm que j√° faz a query levando em considera√ß√£o esse campo. As duas situa√ß√µes n√£o se encaixam nesse projeto ent√£o realmente podemos fazer usando s√≥ o update mesmo.

>> Coment√°rio de rodrigoKulb:
A vantagem de utilizar o deleted_at √© que poderia fazer uma chave √∫nica utilizando ele + o slug, assim conseguimos unificar os registros de slug √∫nicos, fora da lixeira.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb que genial, de fato e isso resolve o problema apontado no PR #272 sobre o conflito de slugs üòç üòç üòç üòç 

Ent√£o sugiro o seguinte: seguir com o merge do PR #272 e num outro PR (nessa milestone, ou em outra no futuro) ao inv√©s de deixar a pessoa atualizar o `status` do content para `deleted`, ela precisa fazer uma request com o verbo `DELETE`.

>> Coment√°rio de filipedeschamps:
Turma, acredito estar finalizada essa tarefa!

## Endpoints dispon√≠veis

- [x]  `GET` `contents/`
- [x]  `GET` `contents/[username]`
- [x]  `GET` `contents/[username]/[slug]`
- [x]  `GET` `contents/[username]/[slug]/children`
- [x]  `POST` `contents/`
- [x]  `PATCH` `contents/[username]/[slug]`

## M√©todos dispon√≠veis no model `content`

### content.findAll()
Retorna um Array com conte√∫dos. Isso pode ser usado para encontrar todos os conte√∫dos que n√£o possuem um `parent_id`, por exemplo:

```js
  const contendFound = await content.findAll({
    where: {
      username: request.query.username,
      parent_id: null,
      status: 'published',
    },
    order: 'created_at ASC',
  });
```

## content.findOne()
Retorna um Object com um √∫nico conte√∫do.

```js
  const contentFound = await content.findOne({
    where: {
      username: request.query.username,
      slug: request.query.slug,
      status: 'published',
    },
  });
```
##  content.findChildren()
Retorna um Array com todos os filhos de um determinado conte√∫do (independente se esse conte√∫do √© um "root" content ou "child" content).

```js
  const childrenFound = await content.findChildren({
    where: {
      parent_id: contentFound.id,
    },
  });
```

##  content.findWithStrategy()
Retorna lista de conte√∫dos com base em alguma "intelig√™ncia" (que estamos chamando de estrat√©gias) e que por agora tem duas estrat√©gias burras: `descending` e `ascending`. A `descending` pode ser usada hoje na Home para listar os conte√∫dos mais novos por primeiro, e mais para frente poderemos criar estrat√©gias com algoritmos mais avan√ßados e que considerem outras propriedades.

```js
  const contentList = await content.findWithStrategy({
    strategy: 'descending',
    where: {
      parent_id: null,
      status: 'published',
    },
  });
```

## content.create()
Cria um novo conte√∫do.

```js
await content.create({
    parent_id: 'optional',
    owner_id: 'required',
    slug: 'optional',
    title: rootContent? 'required' || childContent? 'optional',
    body: 'required',
    status: 'optional',
    source_url: 'optional',
  });
```

##  content.update()
Atualiza um conte√∫do.

```js
await content.update('id do conte√∫do a ser atualizado', {
    parent_id: 'optional',
    slug: 'optional',
    title: 'optional',
    body: 'optional',
    status: 'optional',
    source_url: 'optional',
});
```
</issue_232_content(api): CRUD>

<issue_233_content(page): P√°gina para criar e editar novos conte√∫dos>
## Depend√™ncia

#232 

## Contexto

N√≥s precisamos de uma p√°gina com editor no estilo do Github, que aceite markdown e possa ter um modo de preview. Se o conte√∫do n√£o existe, o bot√£o deve criar o `content` do zero. Caso ele exista, deve abrir o mesmo editor para o usu√°rio atualizar o conte√∫do, como est√° acontecendo nesse exato momento:

<img width="914" alt="image" src="https://user-images.githubusercontent.com/4248081/160511245-70e65b9d-5162-441f-9bf0-64d4956648e4.png">

## Execu√ß√£o

O ponto principal √© que a p√°gina deve ser **est√°tica** e quando necess√°rio, usar recursos din√¢micos. Isso significa que a p√°gina deve ser gerada usando `getStaticProps` e ser revalidada tanto usando `revalidate` e/ou com o novo recurso em beta que [atualiza a p√°gina por demanda](https://nextjs.org/blog/next-12-1#on-demand-incremental-static-regeneration-beta). Talvez a atualiza√ß√£o por demanda seja responsabilidade da API apenas, pois se algum coment√°rio dentro da p√°gina for atualizado, √© preciso navegar at√© ao conte√∫do raiz para saber o `slug` e atualizar ele.

### Modo edi√ß√£o

Cuidar com os 4 contextos envolvidos e tudo isso deve ser feito inline, para a p√°gina servir tanto no modo edi√ß√£o, quanto visualiza√ß√£o.

- [x] Criando novo conte√∫do raiz (sem `parent`)
- [x] Atualizando conte√∫do raiz
- [x] Criando nova resposta (com `parent`)
- [x] Atualizando resposta

Para cada contexto poder√° aparecer campos diferentes, por exemplo ter t√≠tulo ou n√£o.

### Modo visualiza√ß√£o

Esta p√°gina ter√° duas se√ß√µes, que ser√£o 99% similares:

1. O conte√∫do raiz
2. Os coment√°rios (e estes podem ser **nested** como no Reddit ou HackerNews)

### Layout

Se basear no layout abaixo e n√£o se preocupar em abstrair coisas, s√≥ sair copiando, colando e duplicando igual a um doido, porque na pr√≥xima Milestone vamos fazer a vers√£o final da interface:

https://www.tabnews.com.br/pocs/post-01

>> Coment√°rio de andrefd17:
Seria cab√≠vel usar algo do tipo?
![image](https://user-images.githubusercontent.com/26145982/160643967-fc884649-c3b0-4e2e-ada4-3a89929f9529.png)


[Toast UI Editor](https://nhn.github.io/tui.editor/latest/tutorial-example02-editor-with-horizontal-preview)
https://github.com/nhn/tui.editor

>> Coment√°rio de filipedeschamps:
Sensacional esse m√≥dulo @andrefd17 !!

>> Coment√°rio de filipedeschamps:
Deixando anotado aqui um outro editor que o Facebook acabou de lan√ßar: https://github.com/facebook/lexical

Parece bem bonito, mas acho que por enquanto n√£o chega aos p√©s do que foi apresentado pelo @andrefd17 mas fica registrado aqui para avaliarmos üëç

>> Coment√°rio de rodrigoKulb:
Uma coisa legal que descobri a pouco tempo, existe no HTML5 uma forma de deixar uma DIV com o conte√∫do edit√°vel.

Segue o exemplo abaixo, o legal √© que √© compat√≠vel com todos atalhos de um editor:
CTRL+B para bold 
CTRL+I para it√°lico
CTRL+u para underline

```<!DOCTYPE html>
<html>
  <body>
    <div contentEditable="true">
      Este conte√∫do pode ser editado.
    </div>
  </body>
</html> 
```

https://developer.mozilla.org/pt-BR/docs/Web/Guide/HTML/Editable_content

>> Coment√°rio de filipedeschamps:
Acredito que esta p√°gina possa ser criada usando os m√©todos comentados nessa issue: https://github.com/filipedeschamps/tabnews.com.br/issues/232#issuecomment-1109004906

>> Coment√°rio de filipedeschamps:
@andrefd17 o Toast UI √© sensacional, tem at√© um m√≥dulo para React, mas infelizmente quebra na hora do Nextjs fazer a passagem do SSR :(

E l√° no repo oficial meio que n√£o est√£o muito engajados com esse problema: https://github.com/nhn/tui.editor/issues/2323

Tem um workaround, mas zero confian√ßa: https://paigekim29.medium.com/toast-ui-editor-next-js-c9b48927fbf7

>> Coment√°rio de filipedeschamps:
Fiz uma pesquisa aqui e talvez temos essas alternativas:

1. https://www.npmjs.com/package/@uiw/react-md-editor
   17k downloads - tem "suporte" para Next.js (gambiarra oficializada)
2. https://www.npmjs.com/package/react-markdown-editor-lite
  9.7k downloads - tem suporte para Next.js por dynamic imports
3. Usar um `<textarea>`
  Sinceramente √© o que eu to afim de fazer, o Github faz isso e separa o `Preview` num outro componente.


Vamos ver...

>> Coment√°rio de oziasmjunior:
Seguindo pela linha de fazer o proprio editor encontrei um exemplo interessante
[https://codepen.io/askov/details/GEYKbR](https://codepen.io/askov/details/GEYKbR)

[https://marked.js.org/](https://marked.js.org/)

>> Coment√°rio de filipedeschamps:
Muita coisa evoluiu nessa √∫ltima semana sobre esse assunto e acabei usando o https://bytemd.js.org/

Por√©m logo logo vamos precisar trocar o editor por quest√µes de performance üëç  

**[edit]**

Em paralelo, quero deixar registrado uma outra alternativa para usarmos na parte do editor:
- https://www.npmjs.com/package/react-textarea-markdown-editor

Ele corretamente auto preenche ` - ` ao criar listas, por exemplo.
</issue_233_content(page): P√°gina para criar e editar novos conte√∫dos>

<issue_234_Ideia de design da pagina principal>
Tinha uma ideia e fiz isso: https://drive.google.com/file/d/1Xpx4OGB2a-WZrR3sWmeWRx8aPGJi6gsz/view?usp=sharing

>> Coment√°rio de filipedeschamps:
Show @joooom muito obrigado pela contribui√ß√£o! ü§ù 

Gostei do **Search** ali em cima e isso √© algo que mandatoriamente devemos ter no projeto mais para frente üëç

>> Coment√°rio de filipedeschamps:
@joooom estou fechando essa issue, muito obrigado novamente pela contribui√ß√£o ü§ù
</issue_234_Ideia de design da pagina principal>

<issue_235_content(page): P√°gina listando os √∫ltimos conte√∫dos>
## Depend√™ncia

#230

## Contexto

N√£o tem muito contexto por enquanto, √© a Home do site üëç 

## Execu√ß√£o

O ponto principal √© que a p√°gina deve ser **est√°tica** e quando necess√°rio, usar recursos din√¢micos. Isso significa que a p√°gina deve ser gerada usando `getStaticProps` e ser revalidada tanto usando `revalidate` e/ou com o novo recurso em beta que [atualiza a p√°gina por demanda](https://nextjs.org/blog/next-12-1#on-demand-incremental-static-regeneration-beta).

E como apontado nas outras issues, n√£o vamos nos preocupar com a qualidade t√©cnica da execu√ß√£o do layout agora (pode copiar/colar/duplicar) e vamos nos basear nesse layout abaixo:

- https://www.tabnews.com.br/pocs/home-08

Ent√£o basicamente a ideia por enquanto √© listar os conte√∫dos que n√£o possuem `parent` (podemos chamar de root contents?) usando por enquanto a estrat√©gia de `descending`, caso o que est√° sendo discutido na issue #230 fa√ßa sentido.

Um detalhe que n√£o sei muito bem como resolver √© sobre **pagina√ß√£o**. No HackerNews eles apenas colocam um link chamado **More** que vai para a p√°gina 2, √© bem simples. Podemos fazer assim tamb√©m por enquanto.

>> Coment√°rio de rodrigoKulb:
No medium a pagina√ß√£o √© autom√°tica apos chegar no fim da p√°gina.

https://medium.com/@FilipeDeschamps

Mas eu sei que para o Google a pagina√ß√£o ajuda muito no SEO, ent√£o o modelo ideal √© deixar das 2 formas.

>> Coment√°rio de filipedeschamps:
Show @rodrigoKulb tamb√©m acho que machuca o SEO. E tava pensando na pagina√ß√£o ser por data (por dia, mais especificamente) porque isso vai fazer bastante sentido quando existir o ranking de conte√∫dos (onde naturalmente um conte√∫do compete com outro dentro do mesmo dia, e n√£o entre dias).

Mas n√£o pensei muito a fundo na verdade na quest√£o do ranking e como isso afeta e tamb√©m se o ranking deveria vazar o dia. Eu n√£o fa√ßo a m√≠nima ideia como fazer esse ranking com uma performance aceit√°vel, s√≥ vem gambiarra na minha mente üòÇ

>> Coment√°rio de filipedeschamps:
Acredito que esta p√°gina possa ser criada usando o m√©todo `content.findWithStrategy()`, por exemplo:

```js
  const contentList = await content.findWithStrategy({
    strategy: 'descending',
    where: {
      parent_id: null,
      status: 'published',
    },
  });
```

Mais detalhes: https://github.com/filipedeschamps/tabnews.com.br/issues/232#issuecomment-1109004906
</issue_235_content(page): P√°gina listando os √∫ltimos conte√∫dos>

<issue_236_Refazer todo o Sistema de Valida√ß√£o>
## Contexto

Estou zero satisfeito em como estamos lidando com valida√ß√£o hoje no projeto, tanto por ter coisas duplicadas que n√£o deveriam estar duplicadas, quanto v√°rios rombos na interface e que n√£o validam coisas como o que √© enviado em `query` parameters, apenas √© validado o que √© enviado no `body`. Esse susto veio depois de uma conversa com o Andres Alonso do The Bug Hunter e numa parte espec√≠fica do curso dele sobre **IDOR (Insecure Direct Object Reference)** como que isso facilmente pode se tornar um problema grav√≠ssimo. Eu sinceramente tomei um susto com que v√°rias empresas grandes ca√≠ram em problemas assim.

Validar par√¢metros n√£o necessariamente evita problemas de IDOR, mas s√£o problemas causados pela mesma superf√≠cie, ent√£o voc√™ precisa tratar ela de todos os √¢ngulos e essa issue √© sobre dois √¢ngulos que vou explorar na pr√≥xima se√ß√£o.

## Execu√ß√£o

Sugiro implementar no sistema dois tipos de valida√ß√£o:

1. Valida√ß√£o sint√©tica
2. Valida√ß√£o de neg√≥cio

### 1. Valida√ß√£o sint√©tica
Eu n√£o sei se o primeiro nome est√° certo, mas √© o tipo de valida√ß√£o que n√£o tem regra de neg√≥cio a n√£o ser validar que o campo enviado est√° de acordo com as regras. E devemos fazer isso nas bordas do nosso sistema, onde no nosso caso √© fazer nos Controllers da API.

Um exemplo disso √© validar que o campo `password` √© uma string e possui limite m√≠nimo e m√°ximo de X caracteres. Ou ent√£o se o `password` e `password_confirmation` s√£o iguais, isso tamb√©m pode ser feito nessa camada.

No final das contas o principal trabalho dela √© evitar que **lixo** seja passado para outras camadas do sistema.

Hoje o sistema faz isso, tanto nos filtros de input, quanto em camadas mais internas, como por exemplo aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/a9245ce3abe6b4b4f941a7008498b6cb96e733ed/models/user.js#L105-L113

O que j√° logo em baixo gera quase que uma duplica√ß√£o, pois nesse caso n√£o √© `required`:

https://github.com/filipedeschamps/tabnews.com.br/blob/a9245ce3abe6b4b4f941a7008498b6cb96e733ed/models/user.js#L193-L199

Ent√£o mais abaixo eu sugiro uma ideia de como n√£o ter uma parte dessa repeti√ß√£o.

### 2. Valida√ß√£o de neg√≥cio

Depois disso entram as regras de neg√≥cio e isso s√£o valida√ß√µes que est√£o em camadas mais profundas do sistema, por exemplo dentro dos models.

Um exemplo √© n√£o conseguir ativar um usu√°rio que j√° est√° ativo. Esse caso em espec√≠fico come√ßa nessa fun√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/a9245ce3abe6b4b4f941a7008498b6cb96e733ed/pages/api/v1/activate/%5Btoken%5D.public.js#L20

E voc√™ pode passar algu√©m que j√° teve a feature `read:activation_token` removida, pois isso vai ser pego aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/a9245ce3abe6b4b4f941a7008498b6cb96e733ed/models/activation.js#L88-L98

### Conclus√£o

Dado a isso, sugiro centralizarmos a valida√ß√£o, pelo menos a rela√ß√£o entre campo e o que esperar dele.

Sou novo no mundo do JOI, mas ele parece oferecer algumas op√ß√µes para construir schemas de formas din√¢micas, onde eu declaro par√¢metros soltos em um lugar e uso isso em outros lugares. N√£o sei muito bem como fazer para hora um par√¢metro ser required, outra hora n√£o, e usando todas as mesmas mensagens, mas n√£o estou longe de descobrir como fazer. Vou deixar abaixo alguns links de uma pesquisa que fiz:

Esse link mostra como usar contextos, e talvez passar ali que algo √© required ou n√£o:
https://github.com/sideway/joi/issues/1683#issuecomment-446647506

```js
const schema = Joi.object().keys({
    conditional: Joi.number().when('$condition', {
        is: Joi.boolean().valid(true).required(),
        then: Joi.required(),
        otherwise: Joi.optional()
    })
});

schema.validate({}); // error: null
schema.validate({}, {context: {condition: false}}); // error: null
schema.validate({}, {context: {condition: true}}); // ValidationError: child "conditional" fails because ["conditional" is required]
```

---

Esse outro link mostra como declarar campos singulares, e depois juntar tudo:
https://stackoverflow.com/a/63221642

**Declarando os campos de forma isolada:**

```js
//an email address
  static emailAddress = Joi.object({
    emailAddress: Joi.string()
      .email({ tlds: { allow: false } })
      .required()
      .label("Email Address"),
  });

  static passwordRegex = /^(?=.*[A-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*()])\S{8,}$/;
  static passwordError =
    "Password must be at least 8 characters long, and have at least one uppercase letter, one lowercase letter, one number, and one special character.";
  
  //a password
  static password = Joi.object({
    password: Joi.string()
      .min(8)
      .regex(this.passwordRegex)
      .message(this.passwordError)
      .label("Password"),
  });
```

**Montando o Schema final**

```js
static registerUserSchema() {
    let schema = Joi.object()
      .concat(this.yourNameSchema)
      .concat(this.emailAddress)
      .concat(this.password)
      .concat(this.confirmPassword);
    return schema;
  }
```

---

Outro exemplo mostrando como fazer required condicional (n√£o lembro de onde tirei):

```js
let externalVar = true

module.exports = Joi.object({
  username: Joi.string().alphanum().min(3).max(30).required(),
  password: Joi.string().pattern( /^[a-zA-Z0-9]{3,30}$/ ).required(),

  // here
  role: Joi.number().when(externalVar, { is: false, then: Joi.required(), otherwise: null })
})
```

## Conclus√£o

Essa issue acabou trazendo muitas coisas importantes para o projeto, segue a lista:

- [x] Criar m√≥dulo e aplicar nos primeiros casos
- [x] Mover testes para novo padr√£o
- [x] Aplica√ß√£o desse m√≥dulo em todo resto da aplica√ß√£o
- [x] Renomear par√¢metros na resposta para Snake case: "request_id", "error_id" e "error_unique_code" (vou deixar para outro PR)
- [x] Adicionar mais cobertura de testes para cobrir furos anteriores
- [x] Validar Headers (o formato e caracteres aceitos no Cookie de Sess√£o "session_id")
- [x] N√£o relacionado, mas vou deixar anotado aqui para n√£o esquecer: O novo Logger que usa PinoJS est√° sofrendo algum leak, o mesmo [reportado aqui](https://github.com/pinojs/pino/issues/1322)
- [x] Tamb√©m n√£o relacionado, mas importante para seguran√ßa atual: n√£o deixar usu√°rio atualizar email e senha, at√© que seja implementado fluxo de dupla verifica√ß√£o por email.

>> Coment√°rio de filipedeschamps:
Impressionante, estamos na segunda semana e com 84% conclu√≠do!

Ainda tem duas tarefas, uma mais simples de executar, e a outra bem complicada üëç 

<img width="523" alt="image" src="https://user-images.githubusercontent.com/4248081/163402517-ab34695b-502e-4ba8-8517-943142bf0a36.png">
</issue_236_Refazer todo o Sistema de Valida√ß√£o>

<issue_237_Estat√≠sticas do Site>
## Contexto

Algo que eu acredito ser muito importante para mensurarmos nosso progresso √© visualizar de uma forma f√°cil e p√∫blica as estat√≠sticas do site.

## Execu√ß√£o

N√£o sei muito bem como executar esse ponto e procuro por ideias. Mas algo que precisa ser respeitado √© **n√£o fazer nenhum tracking individual de usu√°rios** e n√£o mandar nenhuma informa√ß√£o para sistemas malucos e da√≠ ter que pedir aquela autoriza√ß√£o de cookie maluco e usar esses dados de forma ultra mal√≠gna... n√£o... caramba chega desse tipo de internet.

Vamos montar estat√≠sticas para n√≥s **usu√°rios do site e criadores de conte√∫do** para entender o nosso pr√≥prio trabalho.

O pontap√© inicial poderia ser t√£o simples quanto uma tabela/gr√°fico mostrando quantos usu√°rios se cadastraram/ativaram no site ao longo dos dias. Ou quantas not√≠cias foram criadas... coment√°rios, etc. Qualquer informa√ß√£o que mostre que o site est√° crescendo e novas pessoas est√£o vindo formar essa comunidade massa, com conte√∫dos massa.

E novamente, podemos mirar em algo bem simples, uma entidade especializada nessas estat√≠sticas, uma p√°gina gerada estaticamente com revalidate razo√°vel e expor isso na API.

Se quisermos, essa p√°gina tamb√©m pode trazer o que √© mostrado por esse endpoint: https://www.tabnews.com.br/api/v1/status N√£o digo mostrar tudo, s√≥ o mais importante para saber que est√° tudo ok.

>> Coment√°rio de liverday:
Nas empresas onde eu trabalhei, sempre tivemos um servi√ßo relacionado a esse tipo de entidade. Sendo ela chamada de `Metric`, `Event` ou `Indicator`, o interessante √© que isso se repete na necessidade de conseguirmos ter um "mapa" de progresso da App.

Tem v√°rias estrat√©gias de seguir nesse tipo de tracking, seja com uso de ferramentas como Google Analytics, ou atrav√©s do nosso pr√≥prio desenvolvimento, que √© o que eu sugiro, pois conseguiremos escalar depois. 

Caso o escolhido seja partir pro desenvolvimento, tenho duas sugest√µes:

## 1 - Usar uma Entidade gen√©rica com padr√£o schemaless

Podemos criar uma entidade espec√≠fica com um padr√£o [schemaless usando JSONB](https://www.postgresql.org/docs/9.5/functions-json.html) para permitir injetarmos metadados em uma determinada m√©trica.

### Vantagens
- Todas as m√©tricas em uma √∫nica entidade.
- Possibilidade de incluirmos metadados sem a necessidade de termos mais "colunas".
- Menor complexidade de escrita do dado no banco (implementar o modelo no momento de escrita √© mais f√°cil).

### Desvantagens
- Complexidade na hora de extrair os dados (vai requerer uma query mais complexa pra saber quantos "clicks" determinada not√≠cia teve, por exemplo)
- Dificuldade pra conseguirmos relacionar dados entre si.

## 2 - Usar Entidades espec√≠ficas para determinado tipo de m√©trica

Podemos fazer com que todo tipo de dado "metrific√°vel" tenha uma tabela espec√≠fica correspondente pra isso. Exemplo disso √© termos uma tabela `posts` pra armazenar os posts e `post_visitors` pra armazenar os eventos das pessoas que passaram pelo Post

### Vantagens
- Facilidade na extra√ß√£o dos dados, √© f√°cil relacionar um post com seus visitantes e vice-versa.
- Conseguimos especializar todo tipo de consulta nessas entidades, fazendo com que o desenvolvimento delas escale mais r√°pido

### Desvantagens
- Esse tipo de abordagem requer uma melhor ger√™ncia na abstra√ß√£o das entidades, pra n√£o termos muitos modelos que possam fazer a mesma coisa ou coisas similares
- M√©tricas expandem continuamente, que se desordenado, pode gerar problemas de ger√™ncia.

Essa √© a minha contribui√ß√£o pra discuss√£o e pode ser que eu n√£o ajudei muito, mas acha que faz sentido alguma delas?

>> Coment√°rio de filipedeschamps:
@liverday cara achei sensacional todo mapa que escreveu, muito bom e nem tinha passado pela minha cabe√ßa essas solu√ß√µes, adorei o schemaless ü§ù  O que eu tinha pensado para montar a p√°gina era fazer uma query (um count) direto na fonte, nas entidades que a gente tem interesse em analisar, por exemplo ir direto na tabela users (meio que √© o "source of truth" desse dado), mas novamente a sua sugest√£o √© bem interessante porque d√° uma flexibilidade muito boa.

E isso me fez pensar onde certos valores deveriam estar anotados, como voc√™ comentou, visualiza√ß√£o dos Conte√∫dos (na tabela dos conte√∫dos ou outro lugar?), e da√≠ mais para frente quantidade de TabCoins dos Conte√∫dos e Usu√°rios, e outras coisas.

O que acha de nessa primeira vers√£o montarmos uma p√°gina, at√© sem API mesmo pra ser **realmente uma POC que a gente jogue fora depois** e que fazemos as queries diretamente dentro do `getStaticProps` usando o `database.js`? √â realmente algo para ser jogado fora depois, que √© f√°cil de executar e vai nos dar tempo para elaborarmos melhor o sistema de estat√≠stica e o que queremos dele.

E sobre o Google Analytics e sistemas parecidos, sugiro que a nossa postura seja banir esse tipo de solu√ß√£o por privacidade ao usu√°rio üëç  ent√£o ou a gente auto-hospeda algo open source, ou a gente faz o nosso de uma forma bem simples e direcionada ü§ù

>> Coment√°rio de liverday:
Acredito que podemos seguir assim por enquanto e ir refinando conforme as necessidades. 
Deixa que essa eu fa√ßo! Haha

Tem algum modelo de interface desejada?

>> Coment√°rio de filipedeschamps:
Showww @liverday que massa üòç 

Por enquanto, se basear nessas duas abaixo e pode copiar/colar/duplicar c√≥digo sem problema, porque n√£o vai ser agora que vamos desenvolver um design system. Vamos deixar para um pr√≥ximo passo, ent√£o fa√ßa o que for necess√°rio para mostrar os dados de uma forma legal üëç 

- https://www.tabnews.com.br/pocs/home-08
- https://www.tabnews.com.br/pocs/post-01

>> Coment√°rio de andrefd17:
J√° usei o jsonb exatamente pra isso em um projeto juntamente com pandas no python, funciona super bem para esse intuito!

Tamb√©m poder√≠amos criar um audit que "escuta" e armazena eventos que acontecem no sistema e da√≠ usar isso pra "alimentar" as estat√≠sticas?

Em rela√ß√£o aos eventos, estes poderiam ser criados com timestamp, o que poderia ser usado pra construir uma "timeline" de evolu√ß√£o.


E esses eventos poderiam ser por exemplo:

- Novos usu√°rios
- Quantos Tabcoins Gerados x Gastos
- Quantos conte√∫dos (Posts) criados


O que acham?

>> Coment√°rio de liverday:
> Tamb√©m poder√≠amos criar um audit que "escuta" e armazena eventos que acontecem no sistema e da√≠ usar isso pra "alimentar" as estat√≠sticas? 

Gosto bastante disso aqui, mas precisamos entender as limita√ß√µes quanto projeto. Por enquanto podemos ir para uma a√ß√£o faseada, onde podemos segmentar as a√ß√µes da seguinte forma:
- Criamos uma p√°gina que busca as informa√ß√µes desejadas direto nas fontes, usando o tradicional `database.js`
- Criamos um modelo para lidar com as m√©tricas/eventos em si, e criamos um mecanismo pra conseguirmos escrever e consultar de qualquer lugar do tabnews, atrav√©s de um modelo `event.js`
- Criamos rotas espec√≠ficas para consumo e escrita dessa informa√ß√£o, como `POST /events` e `GET /events`
- Isolamos essas rotas em uma segunda aplica√ß√£o/deployment. Essa parte aqui √© importante pois √© esperado que essas rotas tenham um volume muito grande entre todo o tabnews uma vez que formos pro ar.

O que voc√™s acham? faz sentido? De qualquer forma, vou come√ßar a implementa√ß√£o inicial!

>> Coment√°rio de rodrigoKulb:
>  O que eu tinha pensado para montar a p√°gina era fazer uma query (um count) direto na fonte, nas entidades que a gente tem interesse em analisar, por exemplo ir direto na tabela users (meio que √© o "source of truth" desse dado).

Esse sistema no inicio funciona muito bem, porem √© importante pensar em armazenar em cache as informa√ß√µes, para evitar o consumo dessas tabelas principais de forma desnecess√°ria.

Segue um exemplo de Estat√≠sticas aberta em um portal que gosto muito:

https://www.vivaolinux.com.br/estatisticas.php

>> Coment√°rio de inovaprog:
@rodrigoKulb d√° pra usar um banco s√≥ de leitura (meio que uma c√≥pia do banco original ) s√≥ pra trabalhar essas m√©tricas que as vezes tem um processamento mais trabalhoso. e esse banco espelha as tabelas usadas em produ√ß√£o mesmo.

>> Coment√°rio de sembug:
@rodrigoKulb Outra op√ß√£o √© prepararmos essas estat√≠sticas em D-1 e inserirmos em uma tabela. N√£o precisar√≠amos fazer um cache e ainda ganhamos um hist√≥rico de evolu√ß√£o do site.

>> Coment√°rio de rodrigoKulb:
@inovaprog gostei da sugest√£oüòäÔ∏è! Levando em conta o que o @filipedeschamps pediu aqui:
- **Usu√°rios**
 Cadastrados
Ativaram
- **Noticias**
Cadastradas
- **Coment√°rios**
- Cadastrados

Acredito que a sugest√£o do @sembug seja a melhor forma, podemos armazenar essas informa√ß√µes no momento do cadastro / ativa√ß√£o sempre somando +1 nessa tabela de relat√≥rio / analytics.

Desta forma n√£o precisa nem ser D-1, podemos seguir com a informa√ß√£o real, apenas utilizando uma tabela separada j√° com a somat√≥ria.

Acredito que o total por DIA assim podemos depois somar por m√™s facilmente.

O que acham?
</issue_237_Estat√≠sticas do Site>

<issue_238_Log Drain: sistema para controle dos logs>
## Contexto

Hoje a Vercel fornece um `tail` em tempo-real dos logs, mas ele n√£o ret√©m dados e apenas mostra poucos itens por vez. Recentemente testei o [Datadog](https://www.datadoghq.com/) e para o nosso caso que √© um projeto pequeno, eu achei a solu√ß√£o muito **bloated**, muito cheio de coisas.

## Execu√ß√£o

Estou ent√£o procurando sugest√µes por agregadores simples e baratos de log. Isso √© muito importante para debuggar as coisas no projeto üëç 

O sistema n√£o necessariamente precisa resolver logs vindos do Back ou Front ao mesmo tempo... o mais importante agora √© logs do Back.

>> Coment√°rio de filipedeschamps:
A Vercel oferece integra√ß√£o autom√°tica para esses servi√ßos:

<img width="815" alt="image" src="https://user-images.githubusercontent.com/4248081/160719366-6e8e556b-4da1-423e-b1ed-0c6ef095b09f.png">

>> Coment√°rio de juniorbotelho:
Logtail √© interessante, mas tive uns probleminhas com o realtime dele. Ele funciona melhor quando integrado ao Winston.

>> Coment√°rio de filipedeschamps:
@juniorbotelho Logtail parece muito delicinha heim! Bem profissional!!

E estou indo de provider em provider, e achei curioso o terceiro ali: https://vercel.com/integrations/logalert

Ele foi feito espec√≠fico para a Vercel e √© gratuito, n√£o tem plano pago. E tem alerta por email. Parece ser bem simples (e limitado) mas vou testar.

>> Coment√°rio de juniorbotelho:
@filipedeschamps Olha! Bem interessante mesmo, ainda n√£o o utilizei, mas acho que vale a pena testar :D.

>> Coment√°rio de sembug:
Estou usando o NewRelic https://newrelic.com/ porque √© free at√© 100GB com reten√ß√£o de 1 m√™s. √â s√≥ ter um √∫nico usu√°rio Admin.

>> Coment√°rio de liverday:
√â muito overkill, sendo bem sincero, mas o ElasticSearch pode ser uma boa alternativa por ser Open Source, mas isso vai requerer um gerenciamento que talvez n√£o d√™ pra fazer devido a falta de pessoas dispon√≠veis pra isso. Gostei do logtail e do logalert para uma solu√ß√£o inicial!

>> Coment√°rio de filipedeschamps:
Implementei o [Logalert](https://vercel.com/integrations/logalert) mas os logs n√£o entravam por nada, n√£o sei se a solu√ß√£o ta abandonada.

Implementei ent√£o o [Logtail](https://vercel.com/integrations/logtail) e ele √© lindo, mas **muito** devagar ao ponto de as vezes ser ok, e as vezes ser inutiliz√°vel. E eu n√£o sei tamb√©m por ele como mensurar a lat√™ncia das requests, dado que a Vercel manda esse dado dessa forma (destaquei em negrito):

> "message_string":"START RequestId: 20404dbc-9168-44df-a1e1-86ca84cb4fd9 Version: $LATEST END RequestId: 20404dbc-9168-44df-a1e1-86ca84cb4fd9 REPORT RequestId: 20404dbc-9168-44df-a1e1-86ca84cb4fd9 **Duration: 11.72 ms** Billed Duration: 12 ms Memory Size: 1024 MB Max Memory Used: 103 MB"

Sobre o NewRelic, no passado eu tive uma experi√™ncia **muito** boa usando ele em aplica√ß√µes Node.js, realmente era muito prestativo. Mas isso faz bastante tempo ent√£o n√£o sei como est√° agora e se se tornou overkill.

Acho que logs e monitoria s√£o assuntos com fun√ß√µes diferentes, vejo logs melhor para debuggar um comportamento (mas ao mesmo tempo n√£o temos logs de trace), e monitoramento pra entender quando e onde o neg√≥cio esteja estourando. Se tiver uma solu√ß√£o que fa√ßa os dois, seria √≥timo, principalmente pra fazer o parse das coisas que a Vercel est√° enviando

Mas vou continuar com os testes aqui üëç

>> Coment√°rio de filipedeschamps:
E @sembug voc√™ est√° usando o NewRelic com o combo Next.js/Vercel?

Eles lan√ßaram faz pouco tempo um integrador oficial:

<img width="794" alt="image" src="https://user-images.githubusercontent.com/4248081/161150919-39b470d8-2fde-4b94-a02a-e30a6afa4a84.png">

O [repo oficial √© esse](https://github.com/newrelic/newrelic-node-nextjs) mas fico confuso que eles assumem que as pessoas estejam rodando por conta pr√≥pria o servidor, e n√£o em ambiente serverless, olha o destaque que eles d√£o para essa condi√ß√£o:

<img width="866" alt="image" src="https://user-images.githubusercontent.com/4248081/161151139-6bd5d97a-d6ef-4d58-a3fa-a04c50a40df3.png">

Mas [nessa thread](https://discuss.newrelic.com/t/feature-idea-is-there-a-guide-to-instrumenting-a-nextjs-application/96169/27) uma pessoa comentou que est√° usando assim (s√≥ n√£o entrou em detalhes):

<img width="812" alt="image" src="https://user-images.githubusercontent.com/4248081/161151437-f4749753-63e4-4cb1-9ce1-d925a7bd9f77.png">

>> Coment√°rio de sembug:
Estou usando com .NET kkk

Em qui., 31 de mar. de 2022 18:22, Filipe Deschamps <
***@***.***> escreveu:

> E @sembug <https://github.com/sembug> voc√™ est√° usando o NewRelic com o
> combo Next.js/Vercel?
>
> Eles lan√ßaram faz pouco tempo um integrador oficial:
>
> [image: image]
> <https://user-images.githubusercontent.com/4248081/161150919-39b470d8-2fde-4b94-a02a-e30a6afa4a84.png>
>
> O repo oficial √© esse <https://github.com/newrelic/newrelic-node-nextjs>
> mas fico confuso que eles assumem que as pessoas estejam rodando por conta
> pr√≥pria o servidor, e n√£o em ambiente serverless, olha o destaque que eles
> d√£o para essa condi√ß√£o:
>
> [image: image]
> <https://user-images.githubusercontent.com/4248081/161151139-6bd5d97a-d6ef-4d58-a3fa-a04c50a40df3.png>
>
> Mas nessa thread
> <https://discuss.newrelic.com/t/feature-idea-is-there-a-guide-to-instrumenting-a-nextjs-application/96169/27>
> uma pessoa comentou que est√° usando assim (s√≥ n√£o entrou em detalhes):
>
> [image: image]
> <https://user-images.githubusercontent.com/4248081/161151437-f4749753-63e4-4cb1-9ce1-d925a7bd9f77.png>
>
> ‚Äî
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/238#issuecomment-1085131092>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AAAHQHTNTVBYDT7PECPVDTDVCYJQ7ANCNFSM5R74KTPQ>
> .
> You are receiving this because you were mentioned.Message ID:
> ***@***.***>
>

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #261 üëç obrigado a todos pela participa√ß√£o nessa issue ü§ù  qualquer novidade/necessidade vamos adaptando a solu√ß√£o üëç

>> Coment√°rio de filipedeschamps:
E a Milestone continua pegando fogo!!!! Essa semana quero refazer todo sistema de valida√ß√£o ü§ù üëç 

<img width="528" alt="image" src="https://user-images.githubusercontent.com/4248081/162801331-349e3de2-61c8-449f-8f3a-42e1324c8280.png">
</issue_238_Log Drain: sistema para controle dos logs>

<issue_246_Ativa√ß√£o de token retorna erro, mas o login √© realizado com sucesso [outlook]>
> **J√° adianto que isso √© non issue, s√≥ acho bacana deixar registrado o comportamento.**

Quando crio um usu√°rio usando um trick da microsoft, o email de ativa√ß√£o √© enviado, quando abro o link, √© retornado um erro 404 dizendo que o token n√£o existe, mas mesmo assim, consigo realizar o login.

Sobre o trick:
Google e Microsoft (pelo menos, nunca testei com outros) ignoram tudo a partir do `+`, ent√£o, se eu j√° tiver cadastrado um usu√°rio aqui no tabnews com o email `meuemail@outlook.com` e depois, criar um **outro usu√°rio** com o email `meuemail+1@outlook.com`, para o tabnews, esse √© um email novo, ent√£o vai passar na valida√ß√£o, mas na hora de enviar o email de ativa√ß√£o para o email que cadastrei, o email vai ser enviado para `meuemail@outlook.com` (o mesmo do usu√°rio que cadastrei anteriormente) e a√≠, quando abro o link, √© retornado o erro 404 que mencionei, mesmo que a ativa√ß√£o tenha dado certo (visto que logo ap√≥s isso, consigo realizar o login).

- Ps¬π: Esse erro 404 acontece apenas com a microsoft. Tentei criar um user com um email do google j√° cadastrado antes, adicionando o +1 no final e o link de  ativa√ß√£o retornou sucesso.

- Ps¬≤: Links de ativa√ß√£o para emails que pertencem a apenas um usu√°rio, sem esse esquema do `+`, funcionam certinho, retornando sucesso, mesmo se o email for da microsoft.

Acredito que isso seja non-issue, j√° que a 1: ativa√ß√£o funciona (mesmo que a tela seja de erro) e 2: provavelmente (quase) ningu√©m vai usar o email dessa forma, adicionando o +. Ainda assim, acho que seria legal tentar entender o porqu√™ de este erro estar sendo retornado, ao inv√©s de sucesso.

>> Coment√°rio de filipedeschamps:
@f-francine que √≥timo que esbarrou nesse comportamento, e eu imagino que esteja relacionado ao fato do Outlook abrir o link de ativa√ß√£o de forma proativa (sem a sua intera√ß√£o direta no link) e ativando a conta sem voc√™ perceber. Por isso que ao clicar no link, voc√™ recebe um 404, pois o Outlook supostamente j√° utilizou esse link.

Ent√£o talvez n√£o esteja relacionado ao alias +1, mas n√£o posso garantir, porque voc√™ n√£o reclamou desse comportamento com o email raiz (sem o +1). Ent√£o antes de mais nada, pe√ßo que leia a issue #221 pois n√≥s discutimos l√° esse comportamento e o que fazer para evitar que o Outlook confunda nosso processo de ativa√ß√£o.

De qualquer forma, voc√™ pode verificar se o fato Outlook estar clicando no link por voc√™ pode fazer parte desse mau comportamento? Se n√£o quiser ficar criando contas no ambiente de produ√ß√£o, voc√™ pode criar contas no ambiente de staging, por exemplo apontando tudo para essa URL: https://tabnews-git-pool-tabnews.vercel.app/ (√© um ambiente bem mais devagar porque o banco de dados est√° nos EUA, mas a aplica√ß√£o est√° em SP)

>> Coment√°rio de filipedeschamps:
@f-francine se poss√≠vel, voc√™ pode realizar a mesma bateria de testes, mas agora usando essa URL abaixo?

https://tabnews-git-new-activation-tabnews.vercel.app/cadastro

Ela deveria considerar e se comportar normalmente com emails Outlook üëç

>> Coment√°rio de filipedeschamps:
@f-francine estou fechando essa issue, qualquer novidade no assunto sinta-se livre em abrir ela novamente ü§ù
</issue_246_Ativa√ß√£o de token retorna erro, mas o login √© realizado com sucesso [outlook]>

<issue_252_P√°gina de Login>
## Contexto

Ap√≥s o @ygorthiago implementar a p√°gina de cadastro, notamos que na Milestone 3 faltou a p√°gina de Login.

## Execu√ß√£o

Nada muito diferente do que j√° foi executado no PR do @ygorthiago (#245 e #247)
</issue_252_P√°gina de Login>

<issue_255_Implementar tests e2e (UI) simulando user behaviour>
A ideia seria utilizar o [Playwright](https://playwright.dev/docs/intro) para escrever esses tipos de tests e2e simulando user actions nas p√°ginas.

@filipedeschamps
1. Em qual local esses testes seriam criados? vi que os de api est√£o dentro de `tests/api/v1`?
2. Playwright supporta v√°rios [test runners](https://playwright.dev/docs/test-runners) apesar de ter o seu pr√≥prio, para os tests de API estamos usando o **Jest** a ideia seria utilizar ele tamb√©m? Eu vi que o rep√≥sitorio do `jest-playwright` recomenda usar o `playwright test-runner` 

![image](https://user-images.githubusercontent.com/26145982/162213511-20bd3bcb-a50b-41db-a392-060c51f24c0d.png)

3. Poderi√°mos utilizar o [Page Object Model](https://martinfowler.com/bliki/PageObject.html) para 'mapear' as actions do usu√°rio com a UI, o playwright tem um [exemplo](https://playwright.dev/docs/test-pom) disso no docs deles, basicamente consiste em criar Objetos que representam p√°ginas, com isso podemos abstrair toda parte de clicks, locators e etc e reusar a mesma 'p√°gina' em v√°rios tests.

```// playwright-dev-page.js
const { expect } = require('@playwright/test');

exports.PlaywrightDevPage = class PlaywrightDevPage {

  /**
   * @param {import('@playwright/test').Page} page
   */
  constructor(page) {
    this.page = page;
    this.getStartedLink = page.locator('a', { hasText: 'Get started' });
    this.gettingStartedHeader = page.locator('h1', { hasText: 'Getting started' });
    this.pomLink = page.locator('li', { hasText: 'Playwright Test' }).locator('a', { hasText: 'Page Object Model' });
    this.tocList = page.locator('article ul > li > a');
  }

  async goto() {
    await this.page.goto('https://playwright.dev');
  }

  async getStarted() {
    await this.getStartedLink.first().click();
    await expect(this.gettingStartedHeader).toBeVisible();
  }

  async pageObjectModel() {
    await this.getStarted();
    await this.pomLink.click();
  }
}
```

4 - Caso o que seja definido no ponto 2 seja utilizar o **playwright** como test runner, temos que atualizar a github actions de test para rodar esses tests tamb√©m.

>> Coment√°rio de filipedeschamps:
@andrefd17 essa issue ta sensacional!!! Respondendo aos pontos:

1. Sugiro transformarmos o `_use-cases` em `e2e` e depois migrar todos os testes restantes para `integration`, ficando assim:

```
/tests
  /integration
  /e2e
```

2. Show! Sugiro n√£o misturarmos o `jest` com o runner do `playwright`. Quanto mais independente eles ficarem, melhor eles podem evoluir para dire√ß√µes opostas.

3. Interessant√≠ssimo! Abstra√ß√£o √© tudo de bom, quando feita no momento certo. Voc√™ vai ter muito mais experi√™ncia do que eu em `e2e` ent√£o manda bala no que for necess√°rio ü§ù 

4. Total! Separar em 2 jobs seria legal, um que rode os testes atuais de integration, e outro que rode o e2e para separar os erros. Isso vai ficar muito massa üëç

>> Coment√°rio de filipedeschamps:
Andr√©, estou passando um pente fino no projeto e vou fechar essa issue e o PR #266 ü§ù  Uma das partes dessa issue fizemos, que foi reorganizar a localiza√ß√£o dos testes e deixar preparado espa√ßo para encaixar os testes de `e2e` quando a gente entender como resolver a quest√£o dos imports üëç
</issue_255_Implementar tests e2e (UI) simulando user behaviour>

<issue_270_Preciso de ajuda: Escaping de caracteres>
Eu estou escrevendo os testes de valida√ß√£o do PR #269 e estava assumindo que, ao receber o input do usu√°rio, eu j√° deveria fazer o `escape` dos caracteres para evitarmos coisas como Cross-site Scripting... mas quanto mais eu pesquiso, mas estou entendendo que **n√£o**. A gente deveria **salvar no database os dados originalmente como foram enviados** (tirando o escaping relacionado a SQL Injection). Inclusive, na **resposta da API** a gente deveria tamb√©m voltar os dados da forma original.

Isso porque n√≥s n√£o sabemos qual **client** ir√° consumir a API. Por exemplo, se for um App Nativo, ele n√£o possui problemas de XSS e vai ser ruim para ele ter que interpretar os dados "escapados" para HTML. Se for um App de linha de comando, mesma coisa... se for gerar um XML √© outra regra de escaping, se for CSV, tamb√©m. E se for uma p√°gina HTML, ela √© a respons√°vel por fazer o escaping logo antes de mostrar os dados na p√°gina. O React faz isso por padr√£o, a n√£o ser que voc√™ use o `dangerouslySetInnerHTML`.

## Conclus√£o
O **client** deve ser respons√°vel pelo escaping dos dados e isso deve ser feito no √∫ltimo momento antes do dado ser usado, inclusive considerando o seu contexto. Por exemplo, se um usu√°rio quiser **editar** um conte√∫do que criou, os caracteres l√° devem estar **unescaped** dentro do form de edi√ß√£o... do contr√°rio, se o server ficar escaping toda hora corre o risco de duplamente escapar os caracteres do escaping original.

**Isso ta certo? Qual a vis√£o e experi√™ncia de voc√™s?**

>> Coment√°rio de filipedeschamps:
## Algumas refer√™ncias
- https://lukeplant.me.uk/blog/posts/why-escape-on-input-is-a-bad-idea/
- https://stackoverflow.com/a/11620443
- https://evertpot.com/when-to-escape-your-data/
- https://stackoverflow.com/a/22621882

Gostei da frase no primeiro link: **Filter on input, escape on output**

>> Coment√°rio de filipedeschamps:
## Uso no nosso atual frontend

Tenho pouca experi√™ncia nisso, mas estava pesquisando aqui e talvez para mostrar o `body` de um conte√∫do numa p√°gina (que vai ser um markdown), a gente poderia usar isso aqui:

- https://www.npmjs.com/package/react-markdown

Que aceita esse plugin:

- https://github.com/remarkjs/remark-gfm (para conseguir interpretar um Markdown com as features do Github)

Mas devemos cuidar com ataques, mesmo usando Markdown, olha s√≥ que interessante:

- https://medium.com/taptuit/exploiting-xss-via-markdown-72a61e774bf8
- https://github.com/cujanovic/Markdown-XSS-Payloads/blob/master/Markdown-XSS-Payloads.txt
- https://makandracards.com/makandra/481451-testing-for-xss-in-markdown-fields

>> Coment√°rio de rodrigoKulb:
@filipedeschamps essa preocupa√ß√£o seria para o campo body da tabela contents? certo?

Eu pensaria como um "firewall" de conte√∫do, o ideal √© primeiro definir quais funcionalidades do HTML podem ser utilizadas, exemplo:
- Negrito
- It√°lico
- Links
- Imagem
- bulleted
- numberlist
etc....

Assim conseguimos fazer os testes e filtros mais assertivos depois dessa defini√ß√£o.

Verifiquei que o node tamb√©m tem o striptags utilizo muito no PHP.
https://www.npmjs.com/package/striptags

Outro ponto o editor do github n√£o utiliza HTML e sim uma pr√≥pria linguagem, s√≥ depois convertendo para HTML na ABA Preview.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps estava pensando sobre esse t√≥pico e olhando para os demais campos como o t√≠tulo, body n√£o vejo problema em fazer o striptags na entrada, porque deixar passar essa informa√ß√£o para o DB se n√£o √© permitido utiliza√ß√£o? S√≥ vai ocupar espa√ßo na tabela.

>> Coment√°rio de escote:
L√≠ apenas o primeiro artigo (Why escape-on-input is a bad idea) e achei o conte√∫do muito valioso. Como entrei recentemente, ainda n√£o estou a par de todas as decis√µes, mas vou compartilhar um caso pra voc√™s verem se conseguem extrair algo...

J√° trabalhei na constru√ß√£o de um CMS do zero para uma intranet da empresa que trabalho, sendo que os conte√∫dos eram consumidos apenas por clientes WEB, sem Mobile. Depois de avaliar tudo com muito carinho, ficou decidido pela edi√ß√£o de artigos via markdown, por se tratar de um formato future-prof, uma vez que ele √© um arquivo de texto simples, que pode ser convertido / renderizado em qualquer plataforma, mesmo as que ainda n√£o existem.

O problema √© que o CMS estava substituindo um outro antigo, e os usu√°rios j√° estavam acostumados com a flexibilidade do editor HTML (e criavam verdadeiros monstros com isso, como artigos que mais se pareciam com hotsites), somando a isso, na √©poca haviam poucos editores visuais em markdown que tinham as caracter√≠sticas e licen√ßas compat√≠veis com nossas limita√ß√µes, e os usu√°rios, que n√£o eram da √°rea de TI, tinham muita resist√™ncia em aprender o padr√£o markdown.

A batalha foi perdida e foi necess√°rio regredir para um editor visual HTML. ü•∫

Uma vez conformado em trabalhar com HTML, a op√ß√£o sempre foi por gravar o conte√∫do no BD sem fazer os escapes, e isso era importante, porque como era um portal interno, foi necess√°rio implementar um mecanismo de indexa√ß√£o e busca pr√≥prio, e para isso foi utilizado o SOLR conectado diretamente √† base de dados para fazer a indexa√ß√£o do conte√∫do de forma peri√≥dica. Com isso foi poss√≠vel utilizar mecanismos de indexa√ß√£o espec√≠ficos para trabalhar com o formato HTML. Caso os dados estivessem com escape, ele passaria a renderizar tags e outros elementos como parte do conte√∫do, o que n√£o era desejado.

Por outro lado, foi necess√°rio fazer uma sanitiza√ß√£o do texto antes de gravar no banco. Um exemplo corriqueiro √© quando um usu√°rio copia conte√∫do do Word e cola no editor. Alguns caracteres especiais e de controle v√£o junto e mesmo trabalhando com UTF-8, isso virava lixo no conte√∫do e atrapalhava na indexa√ß√£o do SOLR, a gera√ß√£o de CSV ou DUMPs SQL da tabela e at√© na disponibiliza√ß√£o do conte√∫do quando era solicitado para a API no formato XML.

>> Coment√°rio de escote:
(complementando...) 
A etapa de sanitiza√ß√£o tamb√©m √© respons√°vel por filtrar coisas que n√£o devem fazer parte de um conte√∫do e n√£o faz sentido ocupar espa√ßo em banco, que pode ser tanto resultado de um copy-paste com lixo inocente tanto uma tentativa de ataque. Exemplos:
- qualquer conte√∫do dentro de tags <script>, <style>, \<form>, etc... 
- HTML Events, mesmo que dentro de tags aceit√°veis ( como onchange, onclick, onerror, onkeypress, etc)

>> Coment√°rio de rodrigoKulb:
@escote √≥timos pontos! Maldito WORD j√° quebrei a cabe√ßa com isso tamb√©m um "-" que virava "?" sempre. 

Outra quest√£o que estava pensando, ser√° permitido o upload de imagens / videos?
Fui pegar a referencia do medium, que √© simples e intuitivo e lembrei que tem a op√ß√£o de subir arquivos:
![Captura de tela em 2022-04-25 22-38-29](https://user-images.githubusercontent.com/5334261/165202013-5b170e82-f798-4ff6-afa2-0ba914dd29bb.png)
![Captura de tela em 2022-04-25 22-34-44](https://user-images.githubusercontent.com/5334261/165202014-4f5b8c76-037c-4d10-bfd5-67c814f4aa7e.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb eu entendo perfeitamente a preocupa√ß√£o e tive que fazer um malabarismo mental pra eu conseguir criar a issue sugerindo n√£o fazer o escape e deixar os dados entrarem da forma original üòÇ 

e @escote seja muito bem vindo ao projeto e muito obrigado por essa primeira participa√ß√£o! Foi sensacional ler o seu relato e est√° bem em linha com o primeiro artigo üëç 

No nosso caso, devemos suportar tudo o que o Github suporta, que √© Markdown e algumas tags HTML. Dado a isso, devemos manter os caracteres originais, mas fazer filtro sim. S√≥ precisamos tomar cuidado para n√£o filtrar o que n√£o deveria ser filtrado. Ent√£o eu vou escrever algumas coisas aqui (que retirei dos artigos ali em cima) e vamos ver o que o Github faz:

# Link HTML normal

### Caracteres originais (isso abaixo √© um print screen)

<img width="343" alt="image" src="https://user-images.githubusercontent.com/4248081/165406772-39b66657-12ad-462d-bc68-1eda18261b3a.png">

### Resultado

<a href="https://www.example.com/">Click Me</a>



# Link HTML com ataque

### Caracteres originais (isso abaixo √© um print screen)

<img width="315" alt="image" src="https://user-images.githubusercontent.com/4248081/165406904-1275624b-a545-4453-953a-c7a23f25dbc8.png">

### Resultado

<a href="javascript:alert('XSS')">Click Me</a>


# Link HTML com ataque, mas dentro de bloco de c√≥digo

### Caracteres originais (isso abaixo √© um print screen)

<img width="320" alt="image" src="https://user-images.githubusercontent.com/4248081/165407092-30e7f32a-a139-4f90-abb3-d1bb03c54742.png">


### Resultado

```html
<a href="javascript:alert('XSS')">Click Me</a>
```

### N√£o fizeram o escape, mas ta tudo bagun√ßado por conta do code highlighter

<img width="553" alt="image" src="https://user-images.githubusercontent.com/4248081/165407903-2a9b922f-1c27-45ca-8fb8-1548e05b843f.png">


# Link Markdown com ataque

### Caracteres originais (isso abaixo √© um print screen)

<img width="250" alt="image" src="https://user-images.githubusercontent.com/4248081/165407194-e5d8ca9f-04d5-4bf1-bd73-8d1702a236a4.png">

### Resultado

[Click Me](javascript:alert('Uh oh...'))


# Imagem usando HTML

### Caracteres originais (isso abaixo √© um print screen)

<img width="729" alt="image" src="https://user-images.githubusercontent.com/4248081/165407642-2d41b8a2-d99b-4117-ac25-75134a8f4ed0.png">

### Resultado

<img src="https://images.unsplash.com/photo-1537498425277-c283d32ef9db?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2378&q=80">

# Imagem usando HTML com ataque

### Caracteres originais (isso abaixo √© um print screen)

<img width="332" alt="image" src="https://user-images.githubusercontent.com/4248081/165407707-986c0603-7aa1-4494-8806-210ddda444ab.png">

### Resultado

<img src="" onerror="alert('XSS') alt="Uh oh...">

### Nesse caso fizeram o escape

<img width="369" alt="image" src="https://user-images.githubusercontent.com/4248081/165407811-b4bb4a86-d80b-4024-913f-2673c90368a4.png">


---

@rodrigoKulb e no futuro vamos sim suportar upload de imagens ü§ù

>> Coment√°rio de filipedeschamps:
Vou fechar essa issue, e por enquanto o escaping est√° sendo feito somente na borda (ou pelo React, ou pelo ByteMD que √© o m√≥dulo de markdown)
</issue_270_Preciso de ajuda: Escaping de caracteres>

<issue_271_M√≥dulo `snakeize` escondendo o Stack Trace>
Para padronizar o retorno da API e dos Logs para usar tudo o padr√£o `snake_case` eu fiz o PR #265 adicionando o m√≥dulo `snakeize` e funciona, por√©m n√£o imprime a propriedade `stack` de um objeto de erro.

Precisamos consertar isso, porque eu estou precisando logar manualmente l√° no callback de erro do controller pra ver o Stack Trace do que aconteceu. Fora que o stack tamb√©m n√£o deve estar sendo enviado para o Logflare.

>> Coment√°rio de gabrielew:
N√£o vi como estava e como ficou (pode postar exemplos?), mas passar JSON.stringify resolveria?

>> Coment√°rio de filipedeschamps:
@gabrielew bom ponto meu caro, eu acabei por mesclando na m√£o um JSON que o m√≥dulo conseguia imprimir, mas foi gambiarra. N√£o me lembro se o JSON.stringify chegava a imprimir os valores (eu chuto que n√£o). Tem alguma coisa de especial no objeto de `Error` e na propriedade `stack`.

Vou fechar essa issue, mas se quiser reabrir ela com alguma investiga√ß√£o ser√° muito bem vindo ü§ù
</issue_271_M√≥dulo `snakeize` escondendo o Stack Trace>

<issue_273_Criar usu√°rio: Body enviado deve ser do tipo Object>
@filipedeschamps fui fazer uns testes aqui baixei o projeto novamente e quando fui tentar criar o usu√°rio deu esse erro:
![Captura de tela em 2022-04-22 12-12-08](https://user-images.githubusercontent.com/5334261/164744091-94dc4c1e-8f44-4ccd-b1f3-5eac2af60d57.png)

Fiz o teste tamb√©m na URL de produ√ß√£o e tamb√©m retornou, sabe o que pode ser?

>> Coment√°rio de filipedeschamps:
Que interessant√≠ssimo @rodrigoKulb !! Fiz um teste em localhost com a branch `main` e consegui:

<img width="586" alt="image" src="https://user-images.githubusercontent.com/4248081/164745249-7abd8751-08ca-4da4-9244-215c7af5e74d.png">

Mas vamos investigar, pois isso est√° muito interessante!

Voc√™ pode tirar um print do que est√° ali na aba `Header (7)` no response? E tamb√©m o `Header` da Request?

>> Coment√°rio de filipedeschamps:
E especulando aqui, ser√° que o seu client n√£o est√° enviando o tipo de `Content-Type` correto?

Por exemplo:

```js
        headers: {
          'Content-Type': 'application/json',
        },
```

>> Coment√°rio de rodrigoKulb:
Voc√™ fez o teste em produ√ß√£o? Aqui tamb√©m retornou o mesmo erro.
![Captura de tela em 2022-04-22 12-28-17](https://user-images.githubusercontent.com/5334261/164746149-36882e6e-46da-4917-88c0-ee0c047fd6f6.png)
O GET funciona normal, somente o POST.

>> Coment√°rio de rodrigoKulb:
Acho que foi erro do meu Insomnia, fechei e abri e voltou a funcionar. Finalizando a Inssue

>> Coment√°rio de filipedeschamps:
Showwww üòç
</issue_273_Criar usu√°rio: Body enviado deve ser do tipo Object>

<issue_274_Erro ao rodar os testes 2 vezes>
@filipedeschamps n√£o sei se √© algo aqui na minha maquina somente para garantir que pra voc√™s est√° ok!

Apos rodar o comando:
`npm test`

Pela segunda vez, ele buga geral, conforme prints, se rodar o `npm run dev` novamente ele volta ao normal.
![Captura de tela em 2022-04-22 22-02-02](https://user-images.githubusercontent.com/5334261/164845010-eeaf168c-3398-470e-8e94-5c46ba497c5d.png)
![Captura de tela em 2022-04-22 22-01-40](https://user-images.githubusercontent.com/5334261/164845011-dd4d0d86-c189-498c-83c3-1afe2b15bd59.png)
:

>> Coment√°rio de filipedeschamps:
Massa! Isso acontece comigo quando em um terminal eu estou rodando o `npm run dev` e em um outro terminal eu rodo o `npm test`. Da√≠ uma coisa conflita com a outra, porque o `npm test` tenta tamb√©m levantar o seu pr√≥prio servidor web.

No seu caso, a ordem exata dos comandos foi essa?

1. N√£o existia nenhum processo relacionado ao tabnews rodando.
2. No terminal voc√™ rodou `npm test`.
3. Esperou terminar com sucesso ou fracasso.
4. Nesse mesmo terminal, voc√™ rodou de novo `npm test`.

Foi isso?

E @rodrigoKulb MUITO obrigado por estar testando essas coisas e reportando aqui nas issues üòç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps matou faltou ler a documenta√ß√£o hahaha!!

ATEN√á√ÉO: Primeiro se certifique que o Servi√ßo Web levantado no comando anterior n√£o esteja rodando, pois se estiver, a porta 3000 estar√° ocupada e os testes n√£o ir√£o rodar corretamente.

Na minha cabe√ßa precisava iniciar o servi√ßo para rodar os testes hahaha!!

>> Coment√°rio de filipedeschamps:
hahahahaah show!!! E exato, o `npm test` precisa se virar 100% sozinho do in√≠cio ao fim, porque ele √© usado no CI ü§ù üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps estou reabrindo essa Issue para fazer uma proposta de "corre√ß√£o" para esse erro, pensando que eu e voc√™ passamos pelo mesmo problema, imagino que varias pessoas podem passar tamb√©m. Acabei encontrando um comando bem legal que derruba a aplica√ß√£o rodando na porta 3000, evitando que rode a aplica√ß√£o gerando problemas.
`npx kill-port 3000`

Segue abaixo aplicando ele no package.json:
![Captura de tela em 2022-04-23 12-10-13](https://user-images.githubusercontent.com/5334261/164912331-f874a9ad-f1d2-40e6-a621-dd7e08092206.png)
Se achar interessante aplicar, abro uma PR aqui.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb ahhh massa!!! Topo total! E no PR tamb√©m seria legal alterar a descri√ß√£o no README üëç

>> Coment√°rio de rodrigoKulb:
Finalizando a Issue resolvida na PR #276
</issue_274_Erro ao rodar os testes 2 vezes>

<issue_281_Substituir a Home atual pela Home que est√° em `/beta`>
## Contexto

Essa √© a issue que vai finalizar a Milestone na Live de encerramento (que provavelmente ser√° marcada para essa sexta-feira).

## Execu√ß√£o

1. Mover o arquivo `/pages/beta/index.public.js` para a raiz do site em `/pages/index.public.js` 
2. Remover todos os arquivos encontrados em `pages/init/` (esses arquivos e p√°ginas continuam dispon√≠veis na p√°gina do nosso museu https://www.tabnews.com.br/museu)

>> Coment√°rio de filipedeschamps:
<img width="884" alt="image" src="https://user-images.githubusercontent.com/4248081/167188394-3d8f5486-0ea6-40d7-a041-0ddc3bf5eb36.png">

Milestone encerrada com sucesso!!!
</issue_281_Substituir a Home atual pela Home que est√° em `/beta`>

<issue_288_Confirma√ß√£o de Senha no cadastro e op√ß√£o de recupera√ß√£o de senha>
- [ ]  Falta a Op√ß√£o de recuperar senha caso esque√ßa

- [x] No cadastro deveria ter dois campos de senha, para confirmar se a senha foi digitada duas vezes igual

- [x] No cadastro a rota esta sendo chamada sem fazer a valida√ß√£o dos campos

- [x] Adicionar aviso de status do capslock

>> Coment√°rio de rodrigoKulb:
@arthurbotelho aplicado o aviso de status do capslock no password, falta s√≥ testar e aprovar a PR. 
Estou sem acesso ao tabnews, porque esqueci minha senha, mas n√£o consegui fazer esse item ainda.

>> Coment√°rio de filipedeschamps:
@arthurbotelho apesar que falta uma task nessa issue, eu vou fechar ela e come√ßar a organizar a abertura da pr√≥xima milestone e garantidamente incluir a feature de recuperar a senha ü§ù
</issue_288_Confirma√ß√£o de Senha no cadastro e op√ß√£o de recupera√ß√£o de senha>

<issue_297_Erro ao rodar npm run dev>
N√£o sei se fiz algo de errado, porem agora est√° dando erro para iniciar o projeto
![Captura de tela em 2022-05-10 10-29-31](https://user-images.githubusercontent.com/5334261/167640064-e08cbb06-ca4e-4fee-b078-b4e441b2419e.png)
.

>> Coment√°rio de filipedeschamps:
Show! Mas pe√ßo que mostre o in√≠cio da primeira mensagem de erro, pois ela que aponta o real primeiro problema üëç

>> Coment√°rio de rodrigoKulb:
![Captura de tela em 2022-05-10 10-33-04](https://user-images.githubusercontent.com/5334261/167640723-4f6abd03-540d-42c8-a6e5-c30c1af6cca8.png)

>> Coment√°rio de filipedeschamps:
Ele est√° avisando que a tabela n√£o existe, ent√£o sugiro rodar as migrations üëç

>> Coment√°rio de filipedeschamps:
E para rodar as migrations use o comando abaixo (acho que foi voc√™ quem implementou ele ü§ù )

```
npm run migration:run
```

Talvez seja interessante esclarecer isso no README, pois nessa se√ß√£o isso n√£o est√° nada claro:

<img width="857" alt="image" src="https://user-images.githubusercontent.com/4248081/167647208-0d522ed8-99bc-4f26-b34e-2053409a2ffe.png">

>> Coment√°rio de rodrigoKulb:
@filipedeschamps realmente n√£o lembro de ter rodado as migrations at√© a implementa√ß√£o do `contents`  e na documenta√ß√£o faltou essa informa√ß√£o. Agora rodou certinho! 
Acha que podemos "BLINDAR" e sempre rodar as `npm run migration:run` no run dev. At√© porque se n√£o tiver migration pendente ele n√£o roda.

Ou apenas adicionar na documenta√ß√£o?

>> Coment√°rio de filipedeschamps:
O problema de rodar no run dev √© que o script da migration n√£o vai esperar o servi√ßo do banco estar pronto. N√£o sei como fazer, mas seria √≥timo conseguir um jeito de automaticamente rodar as migra√ß√µes em ambiente dev.

>> Coment√°rio de rodrigoKulb:
Rodei assim e funcionou certinho, mesmo apagando o banco. 
O operador && s√≥ executa o pr√≥ximo comando quando finaliza o primeiro.
![Captura de tela em 2022-05-10 11-28-09](https://user-images.githubusercontent.com/5334261/167653081-bad6f781-3af2-44aa-8e82-adb301964047.png)

O que acha?

>> Coment√°rio de rodrigoKulb:
ou chamar o "atalho" deixando mais limpo
![Captura de tela em 2022-05-10 11-31-31](https://user-images.githubusercontent.com/5334261/167653536-28f2f6a4-565f-45b0-94fa-3dda6b913fa4.png)
![Captura de tela em 2022-05-10 11-34-24](https://user-images.githubusercontent.com/5334261/167654190-b3f1f524-78c7-493e-840a-554e95b8c2c1.png)

>> Coment√°rio de filipedeschamps:
Mas nesse caso eu especulo que os servi√ßos do banco de dados j√° estejam em p√©, pois do contr√°rio, como que ele est√° conseguindo se conectar ao banco para rodar as migra√ß√µes?

Na sequ√™ncia ali est√°:

1. Rodar as migra√ß√µes
2. Matar a porta `3000`
3. Subir os servi√ßos (banco de dados)

Voc√™ tem certeza que o banco estava parado quando rodou essa implementa√ß√£o?

>> Coment√°rio de rodrigoKulb:
Realmente existe um tempo para subir o banco e rodar as migrations, consegui adicionando um sleep 2s, porem cada maquina vai demorar um tempo diferente, estou pensando como podemos resolver isso.

Assim funcionou, porem o tempo est√° em 2 segundos.
`kill-port 3000 && npm run services:up && sleep 2s && npm run migration:run &&  npm run next && npm run services:stop`
1. kill-port 3000 
2. npm run services:up
3. sleep 2s
4. npm run migration:run
5. npm run next 
6. npm run services:stop

>> Coment√°rio de filipedeschamps:
N√£o recomendo colocar esses tipos de timers, √© ingrediente para dar problemas. O que podemos fazer √© colocar o `orchestrator` no meio disso, pois ele precisa fazer a exata mesma coisa, por exemplo, aguardar que todos os servi√ßos estejam prontos antes de continuar:

https://github.com/filipedeschamps/tabnews.com.br/blob/8286a2c07de1d73166ae2ce228b7b9460e333ff0/tests/integration/api/v1/_use-cases/registration-flow.test.js#L11

Isso foi implementado aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/8286a2c07de1d73166ae2ce228b7b9460e333ff0/tests/orchestrator.js#L14-L17

Da√≠ a gente teria que extrair e exportar a fun√ß√£o do banco de dados para ser usada de forma isolada em um novo scripts que fique como intermedi√°rio entre um comando e outro.

Mas por enquanto pra facilitar eu colocaria a instru√ß√£o no README que, ap√≥s subir os servi√ßos, √© necess√°rio rodar as migra√ß√µes.

>> Coment√°rio de rodrigoKulb:
Fechado, concordo!

>> Coment√°rio de joaogelado:
Tem como rodar scripts do terminal em Javascript n√£o? Se tiver, fica melhor para poder usar essa fun√ß√£o e o comando do `package.json` seria um s√≥. Lembro de uma ferramenta. Quando achar vou editar o coment√°rio.

[Edit] O nome √© `zx`

>> Coment√°rio de filipedeschamps:
Que interessante esse m√≥dulo @joaogelado, eu n√£o conhecia!

No nosso caso, n√£o sei se o que estamos procurando √© escrever Bash script de uma forma mais f√°cil. Digo isso pois podemos escrever um script em `.js` normal mesmo, que importe o `orchestrator` e pe√ßa para ele aguardar (`await`) pelo banco de dados... e assim que resolver e passar dessa linha, encerrar o processo, porque da√≠ isso daria continuidade a cadeia de execu√ß√£o de comandos ali em cima. E esse script pode ser rodado com Node convencional mesmo.

>> Coment√°rio de joaogelado:
Como fazer um script que s√≥ tenha a fun√ß√£o de aguardar o banco de dados e substituir o `sleep 2` por `node nome_do_script.js`? Pode ser tamb√©m, j√° que teriamos menos depend√™ncias para trabalhar e pesar no buraco negro (mais conhecido como `node_modules` üòÖ)

>> Coment√°rio de filipedeschamps:
Tentei aqui e por enquanto desisto, dado que todo arquivo do orchestrator foi montado levando em considera√ß√£o que ele √© lido e interpretado por dentro das transforma√ß√µes que o Next.js faz (por exemplo, usando `imports` e resolu√ß√£o dos [caminhos absolutos](https://nextjs.org/docs/advanced-features/module-path-aliases))

Cheguei a at√© usar o Bundler do SWC: https://swc.rs/docs/configuration/bundling e resolver todos os paths na m√£o:

```js
const { config } = require('@swc/core/spack');

module.exports = config({
  options: {
    jsc: {
      baseUrl: './',
      paths: {
        'infra/database.js': ['../infra/database.js'],
        'infra/migrator.js': ['../infra/migrator.js'],
        'infra/logger.js': ['../infra/logger.js'],
        'models/user.js': ['../models/user.js'],
        'models/activation.js': ['../models/activation.js'],
        'models/session.js': ['../models/session.js'],
        'models/content.js': ['../models/content.js'],
        'errors/index.js': ['../errors/index.js'],
      },
    },
  },
  entry: {
    web: __dirname + '/scripts/wait-for-database.js',
  },
  output: {
    path: __dirname + '/scripts',
    name: 'test.js',
  },
  module: {},
});
```

Mas ele gera um erro numa lib que n√£o temos controle:

```
‚ùØ npx spack
(node:10950) UnhandledPromiseRejectionWarning: Error: load_transformed failed

Caused by:
    0: failed to analyze module
    1: failed to resolve events from /Users/filipedeschamps/local/company/tabnews.com.br/node_modules/pg/lib/client.js
    2: not processed by tsc resolver because base module is in node_modules
    3: Impossible to get the node_modules path
```

>> Coment√°rio de filipedeschamps:
Inclusive √© o exato mesmo problema que o @andrefd17 est√° passando no PR #266

A ideia era ter um script intermedi√°rio bem simples:

```js
// scripts/wait-for-database.js

import orchestrator from '../tests/orchestrator.js';

async function waitForDatabase() {
  await orchestrator.waitForDatabase();
}

waitForDatabase();

```

>> Coment√°rio de filipedeschamps:
A gente pode algo como um retry de cli para tentar ficar rodando o comando de migration. Tipo isso: https://www.npmjs.com/package/retry-cli

>> Coment√°rio de rodrigoKulb:
@filipedeschamps fiquei quebrando a cabe√ßa aqui e achei um solu√ß√£o muito solida, testei aqui no Linux Ubuntu. N√£o sei se o docker-compose tem uma vers√£o com log em portugu√™s, estou utilizando o retorno (em ingl√™s) dos logs para verificar se ele j√° est√° pronto.

segue abaixo as 2 linha que alterei no `package.json`

`"dev": "kill-port 3000 && npm run services:up && npm run migration:run && npm run next && npm run services:stop",`

`"migration:run": "while ! docker-compose  -f  infra/docker-compose.development.yml logs | grep 'accept connections' ; do sleep 1; echo 'Aguardando docker iniciar'; done && node-pg-migrate up --envPath ./.env -m infra/migrations/"`

Aqui funcionou em 1 segundo ent√£o imprimiu o Aguardando docker iniciar somente 1 vez.

![Captura de tela em 2022-05-10 23-27-43](https://user-images.githubusercontent.com/5334261/167756689-9af3c1c9-e92d-4259-be64-0bd3d4545c7b.png)

O que acha dessa solu√ß√£o? Ideal testar em uma maquina bem lenta para ver o resultado.

>> Coment√°rio de filipedeschamps:
Feito: https://github.com/filipedeschamps/tabnews.com.br/pull/301

>> Coment√°rio de filipedeschamps:
@rodrigoKulb a gente comentou no exato mesmo minuto üòÇ

>> Coment√°rio de filipedeschamps:
@rodrigoKulb gostei mais da sua solu√ß√£o! Pois vai funcionar em qualquer ambiente eu imagino üòç 

Eu s√≥ alteraria a frase para: `Aguardando Postgres aceitar conex√µes`

Manda um PR?

>> Coment√°rio de rodrigoKulb:
> @rodrigoKulb a gente comentou no exato mesmo minuto joy

hahaha @filipedeschamps no mesmo minuto!!ü§£Ô∏è
Ta l√° agora √© testar em todos sistemas operacionais e se der tudo certo, seguir com ela!

>> Coment√°rio de rodrigoKulb:
Estou finalizando essa Inssue que foi resolvida com 2 solu√ß√µes geniais, ficou um aprendizado enorme!
E talvez um dia conseguiremos melhorar ainda mais removendo a depend√™ncia do pacote `retry-cli`
üöÄÔ∏è
</issue_297_Erro ao rodar npm run dev>

<issue_308_Upload de imagens>
Quando fiz minha primeira publica√ß√£o no TabNews senti falta de um meio para fazer o upload de imagens. Sendo assim, apelei para o servi√ßo imgur.com e fiz a refer√™ncia no Markdown.

Uma similaridade que eu notei entre o imgur.com e o GitHub √© que ambos suportam o upload de imagens de forma bastante r√°pida, "colando" o conte√∫do do clipboard.

No GitHub, por exemplo, se voc√™ cola uma imagem no editor Markdown ele automaticamente faz duas coisas, o upload da imagem e insere a refer√™ncia para ela em formato markdown no texto do editor, como no exemplo abaixo.

```
![image](https://user-images.githubusercontent.com/0101001/fad7fb44-ea68-4a52-b2ed-01c5a861ca0d.png)
```
Imagino que o primeiro par√¢metro seja um identificador do usu√°rio. O segundo √© o nome da imagem no formato UUID (universally unique identifier). 

Achei a refer√™ncia a seguir bem interessante:
https://ourcodeworld.com/articles/read/491/how-to-retrieve-images-from-the-clipboard-with-javascript-in-the-browser

Contudo na implementa√ß√£o da API faz-se necess√°rio observar limita√ß√µes do tipo de conte√∫do, limites de tamanho e duplicidade, op√ß√£o ou n√£o de excluir etc.

Em se tratando de recursos de infraestrutura, talvez limitar o uso de disco por usu√°rio ou a Vercel teria uma op√ß√£o de uso ilimitado sem custos adicionais?

De toda forma penso ser de extrema import√¢ncia o upload de imagens, pois isso certamente agrega valor ao conte√∫do publicado, assim como os diagramas [Mermaid](https://mermaid-js.github.io/mermaid)

>> Coment√°rio de filipedeschamps:
Antes de mais nada, muito obrigado pela contribui√ß√£o no TabNews e por abrir essa issue üòç concordo 100% que esse recurso deva ser implementado, inclusive tem [esse post aqui no TabNews](https://www.tabnews.com.br/filipedeschamps/duvida-onde-fazer-upload-de-imagens-de-graca-e-de-forma-facil) sobre qual o melhor lugar para fazer upload, e fizeram a sugest√£o de algumas APIs.

Tenho dois receios:
1. Abuso: dado que o projeto n√£o tem nenhum investimento (e n√£o vai ter), meu medo √© pessoas abusando do sistema para fazer upload de imagens que nem ser√£o usadas no TabNews. Ent√£o podemos habilitar essa feature s√≥ para quem chegar num certo patamar de uso do TabNews.
2. Migra√ß√£o de conte√∫do: migra√ß√£o ou garantia que o conte√∫do sempre estar√° l√°. Ent√£o ao usar o `S3` da AWS por exemplo, h√° uma alta garantia que o conte√∫do estar√° l√° para "sempre" (e garantido tamb√©m que a conta a ser paga no final do m√™s tamb√©m vai ser alta). Ent√£o independente de onde escolhermos salvar essas imagens, como garantir que a gente consiga migrar os est√°ticos caso precise e manter as URLs p√∫blicas intactas?

>> Coment√°rio de ricardomaia:
> 1. Abuso: dado que o projeto n√£o tem nenhum investimento (e n√£o vai ter), meu medo √© pessoas abusando do sistema para fazer upload de imagens que nem ser√£o usadas no TabNews. Ent√£o podemos habilitar essa feature s√≥ para quem chegar num certo patamar de uso do TabNews.

Pode parecer muito ousado, at√© porque eu mesmo n√£o conhe√ßo o grau de maturidade do projeto, mas quem sabe utilizar-se do [IPFS](https://ipfs.io/)? Alguns navegadores como Opera e Brave at√© suportam nativamente IPFS.

O IPFS √© um protocolo _peer-to-peer_ que distribui um conte√∫do (object) em blocos ou `chuncks` blocos de 256K entre os n√≥s da rede. Achei inclusive [um artigo](https://arxiv.org/pdf/2102.12737.pdf) recente que fala sobre o protocolo.

Existem v√°rios [gateways p√∫blicos](https://ipfs.github.io/public-gateway-checker/) que podem ser utilizados para recuperar arquivos na rede. 

A API do TabNews poderia abstrair a recupera√ß√£o de arquivos na rede IPFS (dentre outras estrat√©gias de armazenamento ou CDNs) e realizar apenas um cache, diminuindo o espa√ßo requerido no servidor.

De maneira bem simplificada, uma vez tendo sido instalado o IPFS, a inclus√£o e recupera√ß√£o de conte√∫do seria simples assim:

### Inicializando o IPFS

```console
ipfs init
```

### Adicionando conte√∫do na rede

```console
ipfs add /path/to/file/image.png
added QmVNsHE5rboiDqxNrrN7Kxu1ovUHQB9tnk9pgucge8Gy5C image.png
```

### Recuperando o conte√∫do de um arquivo

```console
ipfs cat QmVNsHE5rboiDqxNrrN7Kxu1ovUHQB9tnk9pgucge8Gy5C > /public/web/dir/image.png
```

### Inicializando o pr√≥prio n√≥ na rede

```console
ipfs daemon
```

###  Recuperando o arquivo por meio do pr√≥prio n√≥ 

```console
curl "http://127.0.0.1:8080/ipfs/QmVNsHE5rboiDqxNrrN7Kxu1ovUHQB9tnk9pgucge8Gy5C" --output /public/web/dir/image.png
``` 

At√© j√° existe uma [lib em Javascript que implementa o IPFS](https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core) e um exemplo com [NextJS](https://github.com/ipfs-examples/js-ipfs-examples/tree/master/examples/browser-nextjs), mas que n√£o consegui fazer funcionar.

> 2. Migra√ß√£o de conte√∫do: migra√ß√£o ou garantia que o conte√∫do sempre estar√° l√°. Ent√£o ao usar o `S3` da AWS por exemplo, h√° uma alta garantia que o conte√∫do estar√° l√° para "sempre" (e garantido tamb√©m que a conta a ser paga no final do m√™s tamb√©m vai ser alta). Ent√£o independente de onde escolhermos salvar essas imagens, como garantir que a gente consiga migrar os est√°ticos caso precise e manter as URLs p√∫blicas intactas?

Como mencionei, a API do TabNews seria a camada de abstra√ß√£o utilizada para garantir que a URL permane√ßa intacta mesmo no caso de migra√ß√£o do conte√∫do.

Considerando o grande n√∫mero de solu√ß√µes t√©cnicas assim como as limita√ß√µes or√ßament√°rias, talvez essa seja melhor tratar essa issue em outro milestone at√© que as op√ß√µes estejam mais claras!

>> Coment√°rio de filipedeschamps:
@ricardomaia sou super cru nesse tipo de abordagem, mas √© realmente muito massa!

>> Coment√°rio de filipedeschamps:
@ricardomaia voc√™ poderia usar o corpo dessa resposta que criou e fazer um post no TabNews!

>> Coment√°rio de filipedeschamps:
@ricardomaia estou reorganizando o reposit√≥rio e por hora vou fechar essa issue. Qualquer coisa que queira deixar registrado de melhoria, estamos centralizando nessa publica√ß√£o aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda

>> Coment√°rio de hisirdox:
Acho valido esta issue de upload de imagens, fui criar um post e deixei sem imagem pela dificuldade em colocar uma
</issue_308_Upload de imagens>

<issue_311_Pergunta r√°pida: como fazer pull requests aqui no reposit√≥rio?>
Geralmente para fazer pull requests eu "forko" o reposit√≥rio. Mas, vi muitas pessoas fazendo novas branchs com o pull request. Eu n√£o sei se aqui √© o lugar apropriado pra perguntar mas: como fazer pull requests aqui no reposit√≥rio?

>> Coment√°rio de joaogelado:
Acabei de ver duas issues sobre isso: #4 e #42. Vou fechar isso por agora, mas se alguem quiser complementar, fique a vontade.

>> Coment√°rio de filipedeschamps:
@joaogelado pode abrir branch diretamente aqui ü§ù
</issue_311_Pergunta r√°pida: como fazer pull requests aqui no reposit√≥rio?>

<issue_313_Sugest√£o de design para HOME>
Segue algumas sugest√µes de design para home:

1 - Remover os n√∫meros n√£o achei que faz muito sentido at√© porque o content est√° em ordem decrescente.

2 - Aumentar um pouco a fonte.

3 - Adicionar um "-" entre o nome e time.

4 - Adicionar uma marginBottom: 3 entre cada conte√∫do.

@filipedeschamps abaixo o resultado se quiser posso subir a PR:


![Captura de tela em 2022-05-15 11-45-49](https://user-images.githubusercontent.com/5334261/168478937-06cba9c1-2e7f-4fea-bec7-543f2e85ebbf.png)

>> Coment√°rio de gabrielew:
√ìtimas sugest√µes!!!

Aqui abri um t√≥pico de novas funcionalidades

https://www.tabnews.com.br/gabrielabpedro/dicas-de-novas-funcionalidades

>> Coment√°rio de filipedeschamps:
Show Rodrig√£o!!! Sobre os pontos:

1. N√∫meros: isso √© um "tempero secreto" que far√° mais sentido quando entrar em quest√£o o ranking por tabcoins (ou qualquer outro algoritmo). E a ideia √© ajudar o c√©rebro a come√ßar a ler primeiro o que est√° no momento como "mais importante". Mas novamente, na atual situa√ß√£o da lista, isso n√£o passa de simbolizar para o c√©rebro qual o conte√∫do mais fresco, mas quando essa ordem ficar mais maluca, a lista numerada ir√° ajudar rankear os posts.
2. Quando eu estava rabiscando a Home, eu tamb√©m fui e voltei no tamanho da fonte. N√£o sei o que dizer, porque eu ainda me pergunto como que o Hacker News funciona [com esse tamanho de fonte](https://news.ycombinator.com/news). Talvez isso facilite a leitura no final das contas, porque √© garantido que todas as postagens n√£o quebram linha, isso pelo menos no Desktop, e seu olho vira um scanner muito r√°pido a procura de algo que lhe interessa.
3. Sobre o `-` cuidado para n√£o abrir margem que o post foi feito num tempo negativo üòÇ (`- 2 minutos atr√°s`) mas tamb√©m h√° outros separadores como o `|` e `¬∑`
4. Interessante, faz sentido recalibrar os espa√ßamentos, n√£o est√° legal hoje.

Com a entrada das tabcoins tamb√©m na home (e a quantidade de coment√°rios), sugiro deixar para mexer nela quando esses recursos vierem da API ü§ù

>> Coment√°rio de rodrigoKulb:
Show, aguardamos a entrada do tabcoins para voltar com esse assunto!
</issue_313_Sugest√£o de design para HOME>

<issue_314_Criar uma rota na API para as notifica√ß√µes recebidas>
# Descri√ß√£o

Hoje em dia, nenhuma resposta ao seu coment√°rio/post √© mostrada de volta para voc√™.

## Porque isso √© ruim?

Isso dificulta **muito** a contribui√ß√£o porque, se algu√©m respondeu e voc√™ n√£o teve tempo, ou at√© esqueceu do seu coment√°rio/post, essa resposta passar√° em branco.

### Al√©m de que...

**Se** no futuro fizessemos uma op√ß√£o, por exemplo, de seguir uma pessoa, ou notifica√ß√µes como "Voc√™ conseguiu x TabCoins", j√° teriamos a maior parte do sistema pronto

## Como arrumar?

Criando uma rota na API do TabNews para guardar as respostas em que voc√™ recebeu.

# Execu√ß√£o

## Banco de dados

Estava pensando em fazer uma tabela no banco chamada `notifications`. Ela teria, basicamete, quatro colunas:
- id
- user_id
- content_id
- read

Onde:
- "id" seria o id da notifica√ß√£o
- "user_id" seria o id do usu√°rio que √© direcionado a notifica√ß√£o
- "content_id" seria o id do conte√∫do que √© mencionado na notifica√ß√£o
- "read" seria se o usu√°rio j√° leu a notifica√ß√£o

## Estrutura de arquivos

### Api

Essa rota ficaria em `/api/v1/notifications` e teria dois trabalhos:

#### Listar as notifica√ß√µes

- M√©todo: "GET"
- Permiss√£o: "read:notification"
_Nota: Acho que √© necess√°rio ter uma permiss√£o para usu√°rios an√¥nimos n√£o conseguirem ler as notifica√ß√µes e, se retornassemos um erro, n√£o mostrar√≠amos o √≠cone no front_

- Fun√ß√£o: Listar todas as notifica√ß√µes **do usu√°rio autenticado**

#### Ler as notifica√ß√µes

- M√©todo: "PATCH"
- Permiss√£o: "update:notification"
_Nota: Acho que √© necess√°rio ter uma permiss√£o para usu√°rios an√¥nimos n√£o conseguirem ler as notifica√ß√µes e, se retornasse$

- Fun√ß√£o: Marcar como "lida" a notifica√ß√£o (Se a notifica√ß√£o foi lida, ele marca como "deslida")

Essa issue n√£o tem c√≥digo ou um PR, principalmente porque n√£o sou muito bom em SQL e, tamb√©m, porque essa √© a minha primeira vez que fa√ßo uma contribui√ß√£o nesse reposit√≥rio. Espero que eu fui bem üòÇ.

>> Coment√°rio de gabrielew:
Massa @joaogelado , seria legal tamb√©m ter a funcionalidade de "Perguntar ao usu√°rio se ele quer ser notificado quando o navegador estiver aberto, mas a aba do tabnews n√£o". Ai o mesmo √© notificado em "tempo real" quando houver uma intera√ß√£o no seu post/participa√ß√£o.

>> Coment√°rio de joaogelado:
Seria sim, mas, provavelmente, haveria a necessidade de um servidor websocket (A n√£o ser que ficasse enviando requests a cada 5 segundos, por exemplo)

>> Coment√°rio de rodrigoKulb:
Sim, √≥tima ideia. Podemos separar em etapas.

01 - Desenvolver a API de notifica√ß√£o, aqui apenas resultado via json.
02 - Verificar possibilidade de enviar por e-mail.
03 - Habilitar a notifica√ß√£o push do navegador conforme mencionado pelo @gabrielew 
04 - Criar uma notifica√ß√£o interna do tabnews, igual a bolinha vermelha do youtube.

![Captura de tela em 2022-05-16 14-03-38](https://user-images.githubusercontent.com/5334261/168645706-bd1c2fb2-e519-4474-876b-a37663ebc946.png)


E que acham?

>> Coment√°rio de joaogelado:
Incr√≠vel @rodrigoKulb ! Se aceitarem, edito esse coment√°rio (ou a issue) com essa _To-Do_ list.

Em paralelo, se me ajudarem a escrever o SQL, estou tranquilo ajudar a fazer o resto (Ex.: a parte da API).

>> Coment√°rio de rodrigoKulb:
Como o @filipedeschamps falou, aqui qualquer implementa√ß√£o √© bem vinda, mesmo n√£o sendo aprovada vai ser base para uma futura implementa√ß√£o. Fora o aprendizado que ser√° eterno.

Eu particularmente nunca trabalhei com notifica√ß√µes, se voc√™ conhece a estrutura da base de dados para ela, segue o jogo. 

Ideal at√© adicionar essa etapa como uma atividade:
00 - Estrutura do banco de dados Migrations.
01 - Desenvolver a API de notifica√ß√£o, aqui apenas resultado via json.
02 - Verificar possibilidade de enviar por e-mail.
03 - Habilitar a notifica√ß√£o push do navegador conforme mencionado pelo @gabrielew
04 - Criar uma notifica√ß√£o interna do tabnews, igual a bolinha vermelha do youtube.

>> Coment√°rio de joaogelado:
Fiz uma branch chamada `notifications`. Por enquanto n√£o tem nada diferente, mas, quando eu conseguir, vou "commitar" o arquivo da migra√ß√£o e abrir o PR.

Em paralelo: no futuro podemos ter outros tipos de notifica√ß√£o, ent√£o estava pensando em colocar um campo "type" tamb√©m (e ent√£o colocaria o campo de "content_id" como opcional e, como n√£o teria um conte√∫do, ter√≠amos que colocar, por exemplo, uma tabela "text")

>> Coment√°rio de rodrigoKulb:
Estou pensando aqui para avaliar se precisamos adicionar mais campos, por exemplo quando algu√©m responde um coment√°rio de um coment√°rio. A notifica√ß√£o deveria ir somente para o coment√°rio PAI ou o AV√ì tamb√©m?

Outra duvida os irm√£os? pessoas que comentaram no mesmo n√≠vel?

Acredito que precisa adicionar um created_at tamb√©m.

>> Coment√°rio de gabrielew:
O coment√°rio PAI poderia receber notifica√ß√µes de novas "intera√ß√µes" ao seu post.
Os demais coment√°rios poderiam ser notificados caso sejam intera√ß√µes direcionados ao pr√≥prio coment√°rio.

Seria legal ter a possibilidade escolher por onde receber a notifica√ß√£o, somente via navegador e/ou e-mail.

Tem gente que n√£o gosta de ter 500 notifica√ß√µes no e-mail.

E tamb√©m, deve-se verificar se o coment√°rio ainda existe para continuar enviando notifica√ß√µes e/ou op√ß√µes de **silenciar** aquela postagem.

>> Coment√°rio de joaogelado:
> A notifica√ß√£o deveria ir somente para o coment√°rio PAI ou o AV√ì tamb√©m?

Para fins de contexto, acho que, pelo menos, o coment√°rio PAI deve ser exibido. N√£o acho necess√°rio outros n√≠veis j√° que, al√©m da pessoa se lembrar da "thread", se ela n√£o se lembrar, pode clicar para ver.

> Outra duvida os irm√£os? pessoas que comentaram no mesmo n√≠vel?

N√£o entendi. Est√° falando dos coment√°rios irm√£os? Se sim, n√£o est√° (ou n√£o deveria estar) relacionado ao coment√°rio original (o notificado), ent√£o n√£o acho que deveria ser mencionado tamb√©m.

> Acredito que precisa adicionar um created_at tamb√©m.

√ìtima ideia! Quando fizer as migrations, eu coloco esse campo.

>> Coment√°rio de rodrigoKulb:
Isso, exemplo no youtube se eu respondo um coment√°rio, entro em um "chat" qualquer pessoa que responder tamb√©m o mesmo coment√°rio sou notificado. Falei "irm√£o" porque estamos no mesmo n√≠vel de coment√°rio.

Exemplo:

- Conte√∫do Principal (recebe notifica√ß√£o de todos abaixo)
- - Coment√°rio Pai (recebe notifica√ß√£o de todos abaixo)
- - Coment√°rio Irm√£o (recebe notifica√ß√£o de todos abaixo)
- - - Coment√°rio Filho (recebe notifica√ß√£o de todos abaixo)
 
Exemplo de notificar sempre o que est√° no seu n√≠vel para dentro.

Mas acredito que podemos come√ßar somente notificando o PAI. Depois abrimos essa discuss√£o novamente.

>> Coment√°rio de joaogelado:
Isso mesmo, mas como far√≠amos para notificar todos? Uma query recursiva tamb√©m, que pegava todos os posts abaixo e mandava a notifica√ß√£o para todos?

>> Coment√°rio de rodrigoKulb:
Acho que podemos iniciar a PR com a notifica√ß√£o do PAI somente, e depois fazer um upgrade, realmente vai precisar ser uma query recursiva.

>> Coment√°rio de filipedeschamps:
Ahhh que issue sensacional üòç 

Essa feature tem que ser implementada sem sombra de d√∫vidas nessa pr√≥xima Milestone, mas eu sugiro que seja implementada a vers√£o `beta` (uma que envia um email somente para o `parent` do conte√∫do que foi respondido). Isso evita que o usu√°rio desse `parent` seja metralhado por emails por conta de uma "sub discuss√£o" que come√ßou a existir daquele n√≠vel para dentro, mas notifica respostas diretas a um conte√∫do que voc√™ pr√≥prio criou. Do jeito que est√° arquitetado, isso √© bem simples de implementar.

Fugindo da vers√£o `beta`, uma em que qualquer pessoa possa dar `watch` nas postagens contra um `content`, ou parar de dar `watch`, da√≠ teremos que partir para um consumo de filas. Inclusive, se a pessoa j√° viu o conte√∫do pela web antes da notifica√ß√£o ter sido disparada, √© necess√°rio remover a notifica√ß√£o da fila.

E sobre a query recursiva, voc√™ pode puxar todos os filhos de um model `content` pelo m√©todo `findChildren()`.

https://github.com/filipedeschamps/tabnews.com.br/blob/1976143fd9d1e0c1fa91524cf9708f425087d8f9/models/content.js#L434

>> Coment√°rio de joaogelado:
Legal Filipe! Por enquanto, deixar em beta √© melhor mesmo.

Em paralelo, tenho duas duvidas:
1. Como vamos tratar a queue? Criaremos uma tabela no banco?
2. Porque, na exporta√ß√£o "down" dos arquivos de migra√ß√£o, sempre derruba a tabela que criou?

Exemplos:

https://github.com/filipedeschamps/tabnews.com.br/blob/1976143fd9d1e0c1fa91524cf9708f425087d8f9/infra/migrations/1632278997051_create-user-table.js#L51-L53

https://github.com/filipedeschamps/tabnews.com.br/blob/1976143fd9d1e0c1fa91524cf9708f425087d8f9/infra/migrations/1643395493467_create-activate-account-tokens-table.js#L40-L42

https://github.com/filipedeschamps/tabnews.com.br/blob/1976143fd9d1e0c1fa91524cf9708f425087d8f9/infra/migrations/1643506329419_create-session-table.js#L39-L41

Queria saber porque estou fazendo a migration agora, mas n√£o entendi o porque disso.

Edit: Por enquanto vou adicionar essa linha, mas se algu√©m puder explicar eu agrade√ßo.

>> Coment√°rio de filipedeschamps:
@joaogelado do jeito que est√° o `down` eu acho que √© mais conven√ß√£o, pois eu pessoalmente n√£o acredito que reverter uma migra√ß√£o √© uma boa estrat√©gia. Gosto mais de "roll-forward".

De qualquer forma, se voc√™ estiver no escopo da vers√£o `beta` da feature de notifica√ß√£o, sugiro n√£o mexer em nenhuma tabela e apenas criar uma l√≥gica em que ao receber o `POST` de um conte√∫do e existir um `parent_id` na request, depois que criar no banco esse conte√∫do filho de fato, em seguida sugiro pegar o `id` do `user` do `parent` e enviar um email a ele com o `slug` do conte√∫do child que acabou de ser criado. O que acha? Isso vai servir bom um bom tempo at√© criarmos algo mais elaborado e com fila.

>> Coment√°rio de joaogelado:
Como, por exemplo, webhooks? Seria interessante sim. Quando tiver mais tempo eu fa√ßo isso. 

Ali√°s, j√° criei a migration e estava pensando em definir os tipos de notifica√ß√£o no model, ao inv√©s de l√° na migration. O que acha?

Vi, tamb√©m, que falou para n√£o mexer em tabelas, ent√£o quer que eu crie a API com respostas falsas para teste?

_Edit: j√° entendi essa parte_

>> Coment√°rio de tembra:
> 2\. Porque, na exporta√ß√£o "down" dos arquivos de migra√ß√£o, sempre derruba a tabela que criou?

@joaogelado Pela sua pergunta n√£o me parece que voc√™ j√° tenha tido um contato mais profundo com migra√ß√µes (_migrations_). Por favor me corrija se eu estiver enganado.

Dando uma explica√ß√£o mais elaborada que a do @filipedeschamps, o conceito de _migrations_ funciona como se fosse um sistema de versionamento (como o Git) para banco de dados, permitindo que uma equipe defina e compartilhe o esquema do banco de dados de uma aplica√ß√£o.

Para isso, assim como o Git possu√≠ o _commit_ e o _rollback_, uma _migration_ tamb√©m requer que toda altera√ß√£o no banco de dados possa ser aplicada e revertida. Como conven√ß√£o, utiliza-se o m√©todo `up` para "subir", ou melhor, aplicar a altera√ß√£o no esquema (seja ela uma nova tabela, a cria√ß√£o de um √≠ndice, a altera√ß√£o de um campo, etc.), e o m√©todo `down`, origem do seu questionamento, para reverter aquela mesma altera√ß√£o.

Isso significa que se na sua _migration_ o m√©todo `up` est√° criando uma tabela, o m√©todo `down` deveria remover a mesma tabela.

√â muito comum na cria√ß√£o de novas aplica√ß√µes vermos apenas m√©todos `up` criando tabelas e m√©todos `down` removendo-as, pois como tudo est√° saindo do papel ap√≥s um planejamento adequado, sabemos exatamente como nosso esquema de banco de dados deve ser.

Entretanto ap√≥s o _go live_ (ida pra produ√ß√£o) e a utiliza√ß√£o da aplica√ß√£o pelos nossos usu√°rios e clientes, encontramos a necessidade de implementar _features_ que fogem do escopo inicial do esquema definido para o banco de dados, exigindo que algumas tabelas sejam alteradas (e n√£o criadas!), novos √≠ndices sejam criados em uma tabela j√° existente, e etc. Neste momento assim como o m√©todo `up` n√£o ir√° apenas criar mais uma tabela, o m√©todo `down` tamb√©m n√£o conter√° mais a remo√ß√£o dela e sim a a√ß√£o inversa executada no m√©todo `up`.

Exemplo:

Digamos que agora precisamos salvar o telefone do usu√°rio no TabNews. Mas n√≥s j√° temos uma tabela de usu√°rios (`users`). Logo tudo que eu preciso √© alter√°-la, dessa forma a minha _migration_ seria:

```js
exports.up = (pgm) => {
  pgm.addColumns('users', {
    phone: {
      type: 'varchar(11)',
      default: null,
      notNull: false,
    },
  )
}

exports.down = (pgm) => {
  pgm.dropColumns('users', [
    'phone',
  ])
}
```

O m√©todo `up` apenas cria a coluna `phone` na tabela `users` e o m√©todo `down` faz exatamente o contr√°rio: remove essa mesma coluna da mesma tabela.

Assim se a _feature_ que necessita desse campo precisar ser revertida, o campo tamb√©m poder√° ser removido do esquema do banco de dados, revertendo-o ao estado anterior.

>> Coment√°rio de joaogelado:
Bem, ap√≥s o seu coment√°rio, eu vi que n√£o sabia mesmo ü§£. Eu achava que esse `down` era quando o processo da migration acabava. Enfim, eu achei muito informativo (talvez at√© vale a pena postar no TabNews!), obrigado!

>> Coment√°rio de filipedeschamps:
Voto total por um post sobre migrations no TabNews ü§ù

>> Coment√°rio de tembra:
Legal! Vou reunir mais informa√ß√µes, estruturar melhor e fazer o post.

Confesso que jamais faria sem os incentivos hehehe :sweat_smile:
</issue_314_Criar uma rota na API para as notifica√ß√µes recebidas>

<issue_317_Draft da Milestone 4 - TabCoins>
Turma, chegou a hora de tornar a **Milestone 4** realidade, a que implementa as **TabCoins** üí™ e que devemos fazer nessa pr√≥xima sexta-feira uma **Live de Inaugura√ß√£o da Milestone** como sempre fazemos.

Mas apesar do objeto central dessa Milestone ser as TabCoins, estou recebendo por v√°rios locais outras sugest√µes e features sat√©lites, sendo que umas s√£o **emergenciais**. Ent√£o tentei centralizar o que eu acredito caber para uma pr√≥xima Milestone e dividi as sugest√µes em 4 tipos:

1. Objeto principal da Milestone
2. Features cr√≠ticas
3. Melhorias
4. Itens de seguran√ßa

## 1. Objeto principal da Milestone

Isso j√° est√° definido, que s√£o as **TabCoins**, mas tem algo extra que gostaria de agregar e discutir com voc√™s que √© o **TabCash**. Na issue sobre as **TabCoins** eu vou detalhar isso. De qualquer forma, a exist√™ncia das TabCois faz com que seja poss√≠vel ordenar os itens da Home de uma forma mais sofisticada, como por exemplo, os conte√∫dos considerados mais valiosos dentro de um per√≠odo de tempo.

## 2. Features cr√≠ticas

Isso s√£o as features que deveriam ser feitas **urgentemente**, inclusive at√© antes do objeto principal da Milestone:

1. #323
2. #321
3. Feature para remover conte√∫dos ou remover acesso dos usu√°rios. Por enquanto tive que fazer isso no bra√ßo marretando diretamente o banco de dados. Por remover o conte√∫do, precisaremos de um novo status de `deleted`.
4. Pagina√ß√£o dos dados: isso primariamente para n√£o deixar a Home crescer infinitamente e tamb√©m para n√£o estourar a API, como vai acontecer em endpoints como https://www.tabnews.com.br/api/v1/users e https://www.tabnews.com.br/api/v1/contents
5. Primeira vers√£o do sistema de auditoria p√∫blica: por conta das TabCoins, vamos precisar registrar todos os eventos de cr√©dito e d√©bito entre os usu√°rios. E esse sistema deveria poder ser utilizado para registrar qualquer outro tipo de m√©trica. Isso foi inicialmente discutido nessa issue: #237

## 3. Melhorias

1. #335
2. #332
3. #337
4. #336
5. #322 

---

N√£o vai caber nessa Milestone:

1. Upload de imagens: #308 


## 4. Itens de seguran√ßa

Isso pode e deve ser executado a qualquer momento, em qualquer ordem, e pode e deve ser arrastado entre as Milestones:

1. Valida√ß√£o de email+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o: #186
2. Problema: "Entrada do tipo de senha com auto-preenchimento habilitado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
8. Problema: "Referrer Policy Inseguro" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
9. Problema: "Pr√°ticas recomendadas de HTTP Strict Transport Security (HSTS)" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
10. Problema: "Content Security Policy (CSP) n√£o implementado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
11. Problema: "P√°ginas sens√≠veis que podem ser armazenadas em cache" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
12. Problema: "Header Clickjacking: X-Frame-Options" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
13. Rate limiting: Alguma estrat√©gia que bloqueie um mesmo ip de realizar o mesmo comando de forma abusiva contra o backend, seja criando contas, postando conte√∫dos, editando, etc.

---

Acho que isso cria uma Milestone de peso e que vai levar a experi√™ncia do TabNews para um n√≠vel simplesmente sensacional. Eu sinto que a plataforma j√° est√° muito gostosa de usar e interagir, principalmente pela postura das pessoas l√° dentro, e com essa Milestone, tudo isso vai ser maximizado ü§ù

E qualquer coisa extra que for executada da Milestone (que for feito o merge na branch `main`), vamos incluir ela na Milestone em curso para darmos os devidos cr√©ditos ü§ù

E se eu esqueci de algo, por favor me avisem. Naturalmente n√£o d√° para incluir tudo numa √∫nica Milestone, mas vamos abrir pr√≥ximas Milestones at√© sentirmos seguros em colocar o projeto no est√°gio de **Lan√ßamento P√∫blico** ü§ù

>> Coment√°rio de tembra:
Obtive acesso ao projeto hoje e at√© agora estou achando _delicinha_ (:satisfied:) toda a ideia, organiza√ß√£o e colabora√ß√£o de todos os membros da turma!

Somente para ficar claro: a _inaugura√ß√£o_ de um milestone significa que ele come√ßar√° a ser desenvolvido agora ou significa a _finaliza√ß√£o_ dele e ida para produ√ß√£o? Pelo conte√∫do desta issue eu entendi que se trata da **inaugura√ß√£o**.

Ainda estou no processo de _on-boarding_, lendo o [di√°rio de desenvolvimento](https://github.com/filipedeschamps/tabnews.com.br/wiki), mas eu consigo facilmente implementar v√°rias features mencionadas nessa milestone por voc√™. Entretanto percebi que a maioria delas n√£o tem uma issue relacionada e devido a isso n√£o est√° necessariamente bem definida e/ou discutida.

Em caso de colabora√ß√£o devemos abrir uma issue por conta pr√≥pria para discuss√£o e desenvolvimento? Esse √© o caminho?

Tamb√©m senti falta de algumas features b√°sicas como o **perfil de usu√°rio**, que ser√° √∫til inclusive, por exemplo, para o sistema de notifica√ß√£o, pois acredito que n√£o √© todo mundo que vai querer receber um e-mail (ou uma chuva deles) quando tiver respostas nos seus posts.

Finalmente pergunto: Como est√° sendo controlado as issues ou tasks que devem ser cumpridas para cada milestone tendo em vista que elas n√£o est√£o nem criadas? Est√° sendo usado algum gerenciador de projetos como o GitHub Project pra isso ou somente a funcionalidade de issues + milestones mesmo?

>> Coment√°rio de rodrigoKulb:
@tembra seja muito bem vindo ao projeto tabnews, essa √© a **inaugura√ß√£o** da Milestone 4, desta forma o **FOCO** principal ser√° essas atividades.

Edit: A Inaugura√ß√£o Oficial ser√° na live conforme sugerido pelo Filipe dia 20/05/22

O @filipedeschamps deixa muito aberto a possibilidade de v√°rias pessoas enviarem sugest√µes de PRs, assim mesmo n√£o aprovando todas, claro que vai discutir e selecionar a melhor op√ß√£o para o projeto, mas desta forma conseguimos um maior aprendizado do grupo, que ir√° seguir como um desafio o desenvolvimento. 

Nessa Issue #17 voc√™ consegue conferir o resumo de todas as Milestones, e realmente a parte do **perfil de usu√°rio** n√£o est√° clara em nenhuma.

>> Coment√°rio de filipedeschamps:
Sensacional @tembra !!! Esclarecendo seus pontos:

1. **Inaugura√ß√£o**: correto, a gente d√° um "soft lock" nos itens Milestone (e √© soft mesmo, pois ela pode sempre mudar para melhor) e utilizamos essa Live para revisar essas issues e inaugurar essa nova temporada de desenvolvimento. Sabendo que desenvolvimento pode ser feito a qualquer momento, inclusive antes e ap√≥s da abertura de Milestones. S√≥ usamos elas como um norte de curto prazo. 
2. **Organiza√ß√£o das issues**: antes da abertura de uma Milestone, eu crio todas as issues e tasks de cada tarefa. Voc√™ pode ver um exemplo disso na Milestone passada: https://github.com/filipedeschamps/tabnews.com.br/milestone/4?closed=1
3. **Sobre perfil do usu√°rio**: voc√™ na verdade me lembrou de outra coisa importante e que ser√° necess√°rio adicionar nessa milestone, que √© listar os seus pr√≥prios conte√∫dos, independente do status. Mas sobre o Perfil em s√≠ e a configura√ß√£o de notifica√ß√£o, sugiro implementar isso na vers√£o seguinte da vers√£o `beta` inicial das notifica√ß√µes.

Ent√£o ao longo do restante dos dias dessa semana, eu vou come√ßar a criar e detalhar cada issue e task da Milestone e quem quiser, j√° pode ir desenvolvendo ela ü§ù

Se houver conflito de PRs, no sentido de que duas pessoas desenvolveram a mesma coisa, n√£o tem problema. A gente em grupo avalia qual PR est√° mais pr√≥ximo de ser aceito/finalizado e continua com ele. Como o @rodrigoKulb comentou, qualquer PR √© bem vindo, pois mesmo que ele n√£o seja aceito, ele j√° tirou o seu medo de contribuir (que √© a maior barreira).

>> Coment√°rio de tembra:
@rodrigoKulb perfeito! acabei buscando mais informa√ß√µes e encontrei justamente essa issue #17 que voc√™ citou!

@filipedeschamps entendido! como mencionei acima, acabei encontrando seu post que justamente fala sobre a organiza√ß√£o das issues.

Sobre o **perfil do usu√°rio** acredito que ningu√©m deixar√° de usar o TabNews (ou colocar√° o remetente na blacklist) por enquanto, mesmo alguns se incomodando com o recebimento dos e-mails ap√≥s o desenvolvimento do sistema de notifica√ß√£o na vers√£o `beta`, tendo em vista que a maioria dos usu√°rios s√£o pessoas sensacionais üòâ 

Dessa forma ficarei no aguardo da cria√ß√£o das issues e tasks para come√ßar a contribui√ß√£o com c√≥digo.

Muito massa o movimento que voc√™ tem liderado na nossa √°rea de tecnologia @filipedeschamps! Este projeto em espec√≠fico ir√° contribuir muito para a comunidade _open-source_ brasileira, pois muitos realmente n√£o contribuem por medo, por n√£o acharem que est√£o no mesmo n√≠vel, por n√£o se sentirem capazes, ou por tudo isso junto! E este projeto est√° simplesmente desmistificando tudo isso. Parab√©ns!

Uma √∫ltima d√∫vida: voc√™s tornaram o GitHub um ambiente de comunica√ß√£o s√≠ncrona? hahaha üòÇ

>> Coment√°rio de filipedeschamps:
> Sobre o perfil do usu√°rio acredito que ningu√©m deixar√° de usar o TabNews (ou colocar√° o remetente na blacklist) por enquanto, mesmo alguns se incomodando com o recebimento dos e-mails ap√≥s o desenvolvimento do sistema de notifica√ß√£o na vers√£o beta, tendo em vista que a maioria dos usu√°rios s√£o pessoas sensacionais üòâ

Eu acredito nisso! Por enquanto, s√£o as pessoas mais fundamentais do projeto e n√£o tenho d√∫vidas que todas as respostas ser√£o muito bem recebidas. E nessa primeira vers√£o beta, a notifica√ß√£o acontecer√° somente contra o `parent` direto do conte√∫do e implementar isso eu estou especulando aqui que √© bastante simples.

> Muito massa o movimento que voc√™ tem liderado na nossa √°rea de tecnologia @filipedeschamps! Este projeto em espec√≠fico ir√° contribuir muito para a comunidade open-source brasileira, pois muitos realmente n√£o contribuem por medo, por n√£o acharem que est√£o no mesmo n√≠vel, por n√£o se sentirem capazes, ou por tudo isso junto! E este projeto est√° simplesmente desmistificando tudo isso. Parab√©ns!

√â um prazer manter contato com as pessoas que est√£o se aproximando dos projetos (youtube, newsletter e agora tabnews). Estou literalmente na √©poca mais feliz e satisfeita profissionalmente da minha vida inteira.

> Uma √∫ltima d√∫vida: voc√™s tornaram o GitHub um ambiente de comunica√ß√£o s√≠ncrona? hahaha üòÇ

Depois da intera√ß√£o com o @rodrigoKulb em uns micro-PRs de refino que a gente fez no projeto depois do t√©rmino da √∫ltima Milestone, j√° n√£o sei mais üòÇ üòÇ üòÇ

>> Coment√°rio de joaogelado:
Ali√°s, uma p√°gina de "docs" da API seria muito conveniente. Estava pensando em fazer um post sobre isso enquanto a documenta√ß√£o da API n√£o existe

>> Coment√°rio de filipedeschamps:
@joaogelado seria **sensacional** um post l√° no TabNews com o que voc√™ conseguiu capturar sobre o funcionamento da API, pois isso seria um √≥timo teste se a "UX" dela est√° boa.

>> Coment√°rio de filipedeschamps:
@joaogelado olha que timing: https://www.tabnews.com.br/victorodev/ba0a1e96-610e-429f-b712-be71fb83168e

>> Coment√°rio de gabrieldev525:
Como o @tembra, tamb√©m obtive acesso ao projeto hoje! Estou achando bem bacana a organiza√ß√£o e toda a intera√ß√£o que est√° sendo feita por aqui!!!

Estou lendo o [di√°rio de desenvolvimento](https://github.com/filipedeschamps/tabnews.com.br/wiki) para me situar e poder contribuir mais acertivamente com o projeto!

Eu tenho algumas d√∫vidas:

Quanto tempo foi definido para o desenvolvimento das milestones? Ou s√≥ definimos um prazo na live de inaugura√ß√£o?

Ao criar as issues na milestone, basta eu associar meu usu√°rio como respons√°vel na task que eu quero desenvolver ou temos algum outro controle de tarefas?

Mas desde j√°, digo que estou bem ansioso para colocar a m√£o na massa e contribuir para esse projetol!!

>> Coment√°rio de filipedeschamps:
@gabrieldev525 sensacional, seja bem vindo! Sobre suas d√∫vidas:

1. Exato, n√≥s vamos definir um prazo da milestone inteira na Live. E sem apego ao prazo de fato, pois ele √© apenas um ponto de refer√™ncia.
2. At√© sexta-feira (estou torcendo para que d√™ tempo), eu vou criar todas as issues com instru√ß√µes b√°sicas e voc√™ n√£o precisa associar o seu usu√°rio. N√£o h√° problema duas pessoas trabalhando na mesma tarefa, dado que j√° algumas situa√ß√µes assim no passado e foi √≥timo poder ver o mesmo objetivo por √¢ngulos diferentes. Fora que voc√™ deveria encarar uma implementa√ß√£o que brilhe os seus olhos, pois isso vai ajudar a atravessar a barreira inicial de contribui√ß√£o.

E show que est√° ansioso, eu estou tamb√©m por essa milestone, tem **muita coisa** que realmente vai mudar a experi√™ncia do TabNews ü§ù

>> Coment√°rio de filipedeschamps:
O Github ta com problema em atualizar o corpo da primeira issue :(

<img width="912" alt="image" src="https://user-images.githubusercontent.com/4248081/169387893-bc6913a3-ac80-4be8-9a88-1ae98aa5caf2.png">

Ent√£o vou fechar essa e continuar na #345
</issue_317_Draft da Milestone 4 - TabCoins>

<issue_318_JavaScript Standard Style>
@filipedeschamps Voc√™ j√° leu sobre ou at√© mesmo usou o [JavaScript Standard Style](https://standardjs.com/)?

Eu o utilizo como padroniza√ß√£o de c√≥digo JavaScript nos projetos em que trabalho. Facilita bastante por requerer zero configura√ß√£o e ter alta capacidade de corre√ß√µes automatizadas.

O que voc√™ acha de utilizarmos no TabNews?

Aqui tem uma se√ß√£o do site que justifica um pouco o porqu√™ do seu uso: [Why should I use JavaScript Standard Style?](https://standardjs.com/index.html#why-should-i-use-javascript-standard-style)

>> Coment√°rio de filipedeschamps:
Show meu caro! Fiquei confuso se √© a mesma coisa, mas no projeto usamos o `prettier`.

Pela sua descri√ß√£o ele tamb√©m faz a mesma coisa sobre zero configura√ß√£o e auto-formata√ß√£o de c√≥digo. Eu configurei meu VSCode para sempre que salvar o arquivo, rodar o prettier. Em paralelo, a pessoa pode rodar tamb√©m `npm run lint:fix` que ajusta todos os arquivos com base nas regras do `eslint` e `prettier`.

E caso algum arquivo n√£o respeite essas valida√ß√µes, o CI recusa o commit.

>> Coment√°rio de tembra:
Basicamente s√£o a mesma coisa sim. O `prettier` assim como o `standardjs` s√£o formatadores de c√≥digo pr√©-configurados com v√°rias opini√µes, como voc√™ j√° sabe, para que n√≥s n√£o percamos tempo escolhendo se devemos utilizar `tabs` ou `spaces` pra indenta√ß√£o, por exemplo.

A diferen√ßa b√°sica entre os dois √© que as regras do `standardjs` n√£o podem ser desabilitadas _out of the box_ e voc√™ n√£o precisa sequer de um arquivo `.eslintrc`. Entretanto, se voc√™ desejar, poder√° instalar o `eslint` e estender o padr√£o do `standardjs` a fim de habilitar e modificar as regras. Mas n√£o √© recomendado, pois voc√™ estar√° voltando ao problema inicial que √© resolvido pelo `standardjs`: se preocupando com formata√ß√£o do c√≥digo e discuss√£o de opini√µes.

Eu tinha visto que o projeto utiliza o `prettier`, mas al√©m dele outras regras s√£o adicionadas e no final dependemos de uma configura√ß√£o para o `eslint`. Muitas vezes isso acaba requerendo a configura√ß√£o/execu√ß√£o de v√°rios scripts apenas para verificar e corrigir o padr√£o de c√≥digo, o que √© justamente o caso do TabNews como pode ser [visto aqui](https://github.com/filipedeschamps/tabnews.com.br/blob/1976143fd9d1e0c1fa91524cf9708f425087d8f9/package.json#L63-L66).

No final eu prefiro (e olha aqui a opini√£o novamente! hehe) o padr√£o do `standardjs`, pois pra mim ele facilita mais a leitura do c√≥digo fazendo uso de, por exemplo, aspas simples e da remo√ß√£o do ponto e v√≠rgula.

Enfim foi apenas uma sugest√£o. Entendo que provavelmente nada ser√° mudado. Ent√£o sinta-se a vontade para encerrar esta issue se voc√™ entender que a discuss√£o est√° encerrada e devemos continuar usando o `prettier`.

>> Coment√°rio de filipedeschamps:
Show @tembra !

> No final eu prefiro (e olha aqui a opini√£o novamente! hehe) o padr√£o do standardjs, pois pra mim ele facilita mais a leitura do c√≥digo fazendo uso de, por exemplo, aspas simples e da remo√ß√£o do ponto e v√≠rgula.

Concordo 100% com voc√™, eu pessoalmente prefiro assim tamb√©m, tanto que no passado v√°rios v√≠deos do canal em que eu mostrava c√≥digo era com esse padr√£o. Mas a turma me detonava e ficava confusa üòÇ e dessa experi√™ncia percebi que a maioria das pessoas est√£o mais acostumadas com um c√≥digo utilizando `prettier` do que o `standardjs` (veja as stats abaixo). Inclusive, l√° no Pagar.me a gente usava `standardjs`, mas n√£o sei como est√° agora.

### Prettier

<img width="375" alt="image" src="https://user-images.githubusercontent.com/4248081/169087937-2ab6f93d-93fa-4363-8761-3c31ec5dce1b.png">

### Standard

<img width="377" alt="image" src="https://user-images.githubusercontent.com/4248081/169088007-a6f14c28-e612-461e-83cf-a6d211840c64.png">

>> Coment√°rio de tembra:
Perfeito! Contra dados n√£o existem argumentos hehehe

E, apenas para linkar nesta issue, esta decis√£o a favor do `prettier` tem a ver [com o item 0 dessa sua resposta aqui no TabNews](https://www.tabnews.com.br/filipedeschamps/d70220d2-ff19-4cbf-8b8c-50e1e563980b).
</issue_318_JavaScript Standard Style>

<issue_319_TypeScript>
Existe algum motivo em especial para n√£o estarmos utilizando TypeScript no projeto?

Imaginei que talvez possa ser para que os membros da turma possam acompanhar a evolu√ß√£o do projeto, tendo em vista que TypeScript introduz novos conceitos e por isso tem uma curva de aprendizado superior ao JavaScript.

>> Coment√°rio de filipedeschamps:
Exato @tembra e eu desenvolvi um pouco sobre isso nessa resposta: https://www.tabnews.com.br/filipedeschamps/d70220d2-ff19-4cbf-8b8c-50e1e563980b

>> Coment√°rio de tembra:
Show!

O TabNews j√° √© realidade! Esta sua resposta, junto com a resposta do `LeonardoSilva` √† sua resposta (imagina quando tivermos mais respostas encadeadas? ü§£), j√° tirou outra d√∫vida sobre o n√£o uso de um ORM e sim o uso de _raw queries_.

A pergunta √©: Devido ao **item 0** da sua resposta no TabNews, voc√™ est√° pronto para reescrever o TabNews quando ele se tornar um sucesso de acessos e consultas? Pois tenho certeza de que isso vai acontecer!

Nesse ponto provavelmente ser√° importante separar o front do back-end, como o `LeonardoSilva` sugeriu, principalmente para escalonamento horizontal.

>> Coment√°rio de tiagorodriguesdev:
> Exato @tembra e eu desenvolvi um pouco sobre isso nessa resposta: https://www.tabnews.com.br/filipedeschamps/d70220d2-ff19-4cbf-8b8c-50e1e563980b

Recomendando fechar apenas para ajudar a manter o projeto organizado visto que a resposta foi dada anteriormente pelo @filipedeschamps 

Futuramente teremos outras issues para refatora√ß√£o provavelmente.
</issue_319_TypeScript>

<issue_321_Sistema de Notifica√ß√£o: vers√£o `beta`>
## Contexto

Precisamos **urgentemente[^1]** de um sistema simples e inicialmente **trivial** de notifica√ß√£o. Ent√£o para evitar que qualquer pessoa tenha que voltar ao projeto e manualmente conferir uma resposta que tenha algum valor concreto a ela, a id√©ia √© implementar uma vers√£o `beta` que apenas envia um email simples para o autor do post original.

E a sugest√£o √© implementar algo realmente trivial e que possa ser jogado fora, sem pena alguma, mas que n√£o "quebre nenhuma janela" no projeto e mantenha a mesma qualidade de execu√ß√£o, incluindo testes automatizados verificando que o email foi de fato enviado. Mas a parte "trivial" √© importante, pois para manter a simplicidade da execu√ß√£o n√£o vamos criar nenhuma flag de controle para habilitar ou desabilitar o envio de emails, nenhuma fila para consumo dos disparos e vamos simplesmente **enviar um email**.

Me arrisco a sugerir fazer dessa forma nesse est√°gio do projeto, dado que somente contribuintes **core** est√£o participando do TabNews e ir√£o entender o tamb√©m atual est√°gio dessa feature. Fora que do jeito que irei sugerir implementar, o autor que ir√° ser notificado n√£o receber√° emails de respostas dentro de respostas e somente ir√° ser notificado de respostas feitas **diretamente ao seu conte√∫do**.

## Execu√ß√£o

Todo tipo de postagem no TabNews √© um `content`, seja ele um conte√∫do raiz que vai para a Home do site, ou uma resposta a este conte√∫do. O que difere esses dois tipos de `content` √© possuir ou n√£o o par√¢metro `parent_id`. Voc√™ pode ver uma explica√ß√£o condensada disso nesse shorts: https://youtube.com/shorts/DT-C5SCwqEg

Ent√£o a estrat√©gia √©: ap√≥s a cria√ß√£o de um novo `content` que acontece nessa linha:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/pages/api/v1/contents/index.public.js#L83

... identificar se esse conte√∫do possui um `parent_id`, ou seja, o `id` do `content` que est√° acima na hierarquia (o conte√∫do "pai" que a pessoa acabou de responder), buscar esse `content` pelo `id` que est√° dentro desse `parent_id`, localizar o `owner_id` (que √© o `id` de um `user`), e enviar um email para ele.

**Em linguagem natural √©:** se o conte√∫do **B** que est√° sendo recebido pelo backend √© a resposta de um outro conte√∫do **A**, achar o dono desse conte√∫do **A** e enviar um email para ele com o `slug` para o conte√∫do **B**.

### Como enviar o email?

Dentro da pasta `/infra` voc√™ possui um m√≥dulo chamado `email` que possui um m√©todo `send()`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/infra/email.js#L21

**N√£o sugiro utilizar ele diretamente no controller do `content`.** Sugiro criar uma abstra√ß√£o, semelhante ao que foi feito no caso da Ativa√ß√£o de conta (que envia o email de ativa√ß√£o). Por exemplo:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/models/activation.js#L7

Ent√£o poder√≠amos criar algo como um novo model chamado `notification` que implementa um m√©todo `sendEmail()` (ou outro nome mais declarativo - s√≥ consigo pensar em nomes quando estou programando) e que recebe o **usu√°rio** a ser notificado de qual **conte√∫do**, por exemplo, logo ap√≥s essa linha:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/pages/api/v1/contents/index.public.js#L83

Adicionar algo como:

```js
if (createdContent.parent_id) {
  await notification.sendEmail(parentUser, createdContent)
}
```

Ou abstrair ainda mais, e enviar apenas o `createdContent` e deixar o m√©todo buscar o usu√°rio parent.

```js
if (createdContent.parent_id) {
  await notification.sendReplyEmailToParentUser(createdContent)
}
```

E precisamos tomar o cuidado de n√£o enviar um email caso eu responda diretamente ao meu conte√∫do.

### Testes

Nos testes ser√° necess√°rio verificar se o email foi recebido e com os dados corretos. Ent√£o para entender como montar um teste, sugiro primeiro ler esse teste aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/tests/integration/api/v1/contents/post.test.js#L1167-L1188

Ele **marreta** no banco de dados um conte√∫do raiz usando o `orchestrator.createContent()`, e depois usa a **API** para criar um conte√∫do filho. Porque hora usar um e hora usar outro? Porque nesse teste n√£o estava sendo testado criar o conte√∫do raiz, e apenas estava sendo testado bater na API para criar um conte√∫do filho.

Ent√£o prevejo que precisaremos criar dois testes:

1. Teste de eu respondendo ao meu pr√≥prio conte√∫do e verificando que eu n√£o recebi um email. Voc√™ pode for√ßar limpar os emails dessa forma:
https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/tests/integration/api/v1/_use-cases/registration-flow.test.js#L14

2. Teste de eu respondendo a um conte√∫do de outro autor. E nesse caso, verificar que o email foi recebido de fato e com os dados certos. Isso foi implementada em outro teste, que tamb√©m usa o `orchestrator` para puxar o √∫ltimo email recebido:
https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/tests/integration/api/v1/_use-cases/registration-flow.test.js#L57

[^1]: Isso significa que pode ser implementado antes da abertura da Milestone.
</issue_321_Sistema de Notifica√ß√£o: vers√£o `beta`>

<issue_322_Acessibilidade: Plugin `eslint` para verificar `a11y` em `jsx`>
## Contexto

O TabNews tem todos os elementos para facilmente ser um site acess√≠vel e devemos nos certificar desde agora que ele evolua respeitando regras que contribuam com esse tema. E fazer isso de forma **autom√°tica** √© **fundamental** para evitarmos cometer deslizes e especulo que muitas pessoas est√£o iniciando no tema acessibilidade (pelo menos eu estou).

## Execu√ß√£o

Ent√£o antes mesmo dessa issue, o @MiguelMachado-dev j√° criou esse PR #315 implementando uma nova regra no `eslint` e isso √© perfeito, porque nosso CI passa por essa verifica√ß√£o para aceitar ou recusar o commit.

E o @MiguelMachado-dev acabou de simular um teste quebrando as regras, e o CI recusou o commit com sucesso, olha que massinha: https://github.com/filipedeschamps/tabnews.com.br/runs/6497592507?check_suite_focus=true

Em paralelo, fico feliz que o CI n√£o apontou outros erros no projeto e agora temos a garantia que continuar√° assim ü§ù 

Em paralelo 2, pelo que entendi, o assunto "acessibilidade" n√£o √© somente t√©cnico e muita coisa √© subjetiva e precisa ser validada manualmente. Ent√£o vamos ter real carinho com esse assunto.

>> Coment√°rio de MiguelMachado-dev:
@filipedeschamps realmente, muita coisa o lintter nos ajuda, mas coisas como design ainda √© bem dif√≠cil.

Caso tenhamos a ideia de implementar no futuro o storybook, existe plugins onde √© validado a acessibilidade em cores tamb√©m, analisando o contraste da fonte com o fundo do site!

Existe ferramenta externa para isso tamb√©m, que √© o https://color.a11y.com/?wc3

>> Coment√°rio de filipedeschamps:
Caramba que sensacional isso! Eu sou muito cru em frontend mas quero aprender mais sobre essas ferramentas ü§ù
</issue_322_Acessibilidade: Plugin `eslint` para verificar `a11y` em `jsx`>

<issue_323_Recupera√ß√£o de Senha>
## Contexto

No passado, n√≥s publicamos a vers√£o beta da API (e somente dela, sem interface web alguma) e na Live de Encerramento da Milestone relacionada, as pessoas criaram suas contas usando ferramentas como o Postman ou Thunder client. Dado ao tempo que se passou, especulamos que muitas pessoas esqueceram suas senhas e est√£o trancadas por fora de suas contas.

Fora isso, talvez as pessoas possam nem se lembrar do email utilizado, ent√£o √© importante ser poss√≠vel a pessoa conseguir recuperar a sua conta enviando seu `username` ou `email`.

## Execu√ß√£o

- [x] #324
- [x] #325
- [x] #326

>> Coment√°rio de ricardomaia:
Para evitar abusos acho que seria interessante tamb√©m incluir uma verifica√ß√£o de dom√≠nios de e-mail descart√°veis (_disposable email domains_).

Separei 02 pacotes NPM:
 - https://www.npmjs.com/package/is-disposable-email-domain (bastante simples, mas requer a atualiza√ß√£o manual da lista de dom√≠nios)
 - https://www.npmjs.com/package/disposable-email-domains (esse outro aqui utiliza uma API externa. N√£o me deu confian√ßa pois no primeiro dom√≠nio que testei n√£o identificou corretamente)

Sugiro o primeiro pacote ou criar uma fun√ß√£o pr√≥pria, pois nos d√° mais liberdade de incluir ou remover dom√≠nios da lista. E falando em lista, [este reposit√≥rio](https://github.com/disposable-email-domains/disposable-email-domains/blob/master/disposable_email_blocklist.conf) mant√™m uma rela√ß√£o de _disposable domains_ que √© atualizada regularmente.

>> Coment√°rio de filipedeschamps:
Sensacional @ricardomaia ! Isso deveria ser incluindo na a√ß√£o do cadastro e mais futuramente quando tiver atualiza√ß√£o de email ü§ù

>> Coment√°rio de filipedeschamps:
Feature implementada pelo merge do PR #374 que foi iniciada por @gabrielew e finalizada por mim em conjunto com o feedback do pessoal aqui no reposit√≥rio ü§ù
</issue_323_Recupera√ß√£o de Senha>

<issue_324_`recover(api)`: endpoint para criar um novo token de recupera√ß√£o de senha>
## Contexto

Deveria seguir os mesmos princ√≠pios usados para executar a Ativa√ß√£o de Conta (em que √© enviado por email um token de ativa√ß√£o) e isso significa que a pessoa deveria poder enviar alguma identifica√ß√£o sua (`username` ou `email`) e receber por email uma esp√©cie de `token de altera√ß√£o de senha`.

## Execu√ß√£o

### Migration
Vamos precisar de uma nova migration como essa:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/infra/migrations/1643395493467_create-activate-account-tokens-table.js

E os campos poderiam ser os mesmos:

* `id`: o identificador do token
* `user_id`: o identificador do usu√°rio que pediu pela recupera√ß√£o de senha
* `used`: se esse token j√° foi usado
* `expires_at`: data de expira√ß√£o
* `created_at`: data de cria√ß√£o
* `updated_at`: data de atualiza√ß√£o

### Model

Talvez um novo model chamado `recover`, tamb√©m inspirado no de ativa√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/activation.js

### Controller

Tamb√©m nos inspirar no controller de ativa√ß√£o, mas com alguns detalhes a mais:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/api/v1/activation/index.public.js

#### Pedir por uma recupera√ß√£o de senha (POST)

Isso deve ser feito atrav√©s de um `POST` para uma rota como `/api/v1/recover` e a pessoa deveria poder enviar um `username` ou `email`. Ent√£o na valida√ß√£o do controller, esses dois campos devem ser opcionais (e a valida√ß√£o vai automaticamente reclamar se n√£o for enviado nenhum). Ficar√° a cargo do frontend entender se a pessoa digitou um `username` ou `email` para que o dado seja enviado no campo certo para o backend.

E o `POST` deve receber apenas isso mesmo, e logo em seguida criar um token de recupera√ß√£o e enviar email ao usu√°rio com o link para a p√°gina. Essa p√°gina por enquanto n√£o existe, mas assuma que ser√° algo como:

```
https://www.tabnews.com.br/cadastro/recuperar/[token_id]
```

**Aten√ß√£o:** √© necess√°rio considerar a URL base correta dependendo do ambiente (localhost, preview, production), e j√° est√° na hora de abstrairmos isso abaixo em um novo m√≥dulo (pode ser um model chamado `web`, `host`, `address` ou algo na pasta /infra)

https://github.com/filipedeschamps/tabnews.com.br/blob/0bd3c03f66181780bbe52cd472b188da42b325eb/models/activation.js#L45-L57

A resposta de sucesso nesse caso dever√° ser `201`.

E usu√°rios que n√£o possuem a feature `create:session` n√£o deveriam poder criar tokens de recupera√ß√£o, pois eles n√£o v√£o poder logar no final das contas.

#### Usar um token de recupera√ß√£o de senha (PATCH)

Isso deve ser feito atrav√©s de um `PATCH` para uma rota como `/api/v1/recover` e a pessoa precisa enviar apenas o `token_id` e uma nova `password`. Com isso, o backend encontra o `user_id` l√° na tabela com os tokens de recupera√ß√£o e altera a senha dele utilizando o model `authentication` com o m√©todo `hashPassword()`:

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/models/authentication.js#L9

A resposta de sucesso nesse caso dever√° ser `200`.

Fora isso, n√£o dever√° ser poss√≠vel reutilizar um token, nem utilizar um token expirado.

E usu√°rios que n√£o possuem a feature `create:session` n√£o deveriam poder utilizar tokens de recupera√ß√£o, pois eles n√£o v√£o poder logar no final das contas.

>> Coment√°rio de gabrielew:
Se os campos da migration s√£o os mesmos, n√£o podes ter uma coluna de `type`? activation/recover

>> Coment√°rio de filipedeschamps:
@gabrielew puts excelente ponto! Tenho medo de ser uma abstra√ß√£o muito cedo, mas voc√™ cutucou em algo que faz muito sentido!! ü§ù üëç üí™

>> Coment√°rio de tembra:
Pra botar mais lenha na fogueira e ampliar a discuss√£o eu me atreveria ainda a modificar o nome da tabela para `user_tokens` ou `account_tokens` e n√£o usar o `type` de forma geral. E nessa tabela s√≥ deveria existir um token v√°lido com `used` = `false` para cada conta (usu√°rio). Ou seja, a cada nova gera√ß√£o de token o anterior seria automaticamente invalidado.

Acredito que isso possivelmente adiciona uma camada de seguran√ßa para invalidar tokens n√£o solicitados e ainda n√£o utilizados.

Ap√≥s escrever este coment√°rio pensei:
1. Realmente precisamos de uma tabela de tokens seja para o que for?
2. Qual o objetivo da cria√ß√£o dela l√° no in√≠cio se poder√≠amos apenas ter criado um campo na tabela de usu√°rio? Guardar o hist√≥rico?

>> Coment√°rio de filipedeschamps:
Bom ponto @tembra üëç  ao gerar um token, ele primeiro invalida todos os outros.

Sobre ter uma tabela, talvez seja pela modelagem e responsabilidade ficar mais clara. √â um dado tempor√°rio e que expira, √© algo corriqueiro, vamos colocar assim. O que √© diferente as informa√ß√µes de uma modelagem de `user` que n√£o s√£o descart√°veis.

E isso tamb√©m pode levar o `user` a ficar com muitas responsabilidades, o que dificulta jogarmos parte dos recursos fora quando precisarmos. Nesse caso mesmo, podemos jogar fora todo recurso de ativa√ß√£o de conta por email, que nada no user ser√° afetado ü§ù
</issue_324_`recover(api)`: endpoint para criar um novo token de recupera√ß√£o de senha>

<issue_325_`recover(page)`: p√°gina que pede por um novo token de recupera√ß√£o de senha>
## Contexto
Usu√°rio n√£o se lembra mais da senha cadastrada e se lembra apenas do seu `username` ou `email`. Dado a isso, ele dever√° poder entrar numa p√°gina (por exemplo: `/cadastro/recuperar`) e apenas digitar num √∫nico campo um `username` ou `email`.

## Execu√ß√£o

Este √∫nico campo dever√° identificar se o dado digitado possui o formato de um email, se sim, dever√° fazer uma request para o servidor enviando o campo `email`... se n√£o, dever√° enviar o campo `username`. Ou pode ser feito a verifica√ß√£o ao contr√°rio, e verificar se s√≥ existem caracteres alfanum√©ricos, pois da√≠ √© um `username` e o resto pode ser um email.

A request em s√≠ dever√° ser um `POST` contra `/api/v1/recover` ou o que for decidido na issue #342.

Se receber um `201`, o token de recupera√ß√£o de senha foi criado com sucesso e j√° foi enviado para o usu√°rio por email. Com isso, voc√™ pode redirecionar o usu√°rio para uma p√°gina avisando para conferir o email, por exemplo: `/cadastro/recuperar/confirmar`

Fora isso, deve ser considerado erros de formata√ß√£o ou erros internos, como desenvolvido na p√°gina de Login:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/login/index.public.js

## Depend√™ncia
- #324
</issue_325_`recover(page)`: p√°gina que pede por um novo token de recupera√ß√£o de senha>

<issue_326_`recover(page)`: p√°gina que recebe um token de recupera√ß√£o e envia nova senha>
## Contexto
Usu√°rio n√£o que n√£o se lembra mais da senha cadastrada, pediu uma recupera√ß√£o de senha, recebeu um link de um token de recupera√ß√£o por email e clicou nesse link. Agora ele poder√° definir uma nova senha.

## Execu√ß√£o

Est√° p√°gina poder√° estar localizada em `/cadastro/recuperar/[token_id]` e que recebe por par√¢metro o `token_id`. E ao abrir essa p√°gina, dever√° haver um campo de senha e confirma√ß√£o de senha, muito inspirado na p√°gina de cadastro:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/cadastro/index.public.js

E agora com o `token_id` e `password`, √© necess√°rio fazer um `PATCH` contra o endpoint `/api/v1/recover`.

Se receber um `200`, o token de recupera√ß√£o de senha foi utilizado com sucesso e √© poss√≠vel redirecionar o usu√°rio para `/cadastro/recuperar/sucesso` informando que ele pode fazer o Login.

Fora isso, deve ser considerado erros de formata√ß√£o, erros de expira√ß√£o de token, erro de uso de token inexistente ou erros internos, como desenvolvido na p√°gina de Ativa√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/cadastro/ativar/%5Btoken%5D.public.js

## Depend√™ncia
- #324
</issue_326_`recover(page)`: p√°gina que recebe um token de recupera√ß√£o e envia nova senha>

<issue_327_Contador de respostas de cada conte√∫do>
## Problema:
Como visitante do tabnews, gostaria de visualizar quantas respostas cada not√≠cia tem, ou seja, desta forma consigo saber se uma tabnews est√° com discuss√µes interessantes ou n√£o.

![image](https://user-images.githubusercontent.com/962233/169174441-d4488c56-1214-43ef-a36f-cb8799c8c4b9.png)

## Fator complicador

O tabnews tem o conceito de `conte√∫do` e uma resposta tamb√©m √© um conte√∫do que tamb√©m pode ter outra resposta! isto √© fant√°stico, por√©m saber quantas respotas totais uma `tabnews raiz` tem, pode n√£o ser t√£o direto, certo?

Vamos pensar que a tabnews `8. O que faz uma linguagem "morrer"` tem 4 respostas diretas, ou seja, a not√≠cia 8 (conte√∫do sem parentId) tem 4 respostas com parent id = 8, e cada uma delas tem 1 resposta tamb√©m (com parent id referente a cada conte√∫do)

## Solu√ß√µes

- Talvez um solu√ß√£o simples seria, ter uma tabela "responses", a qual seria populada sempre informando que a api que gera a resposta for chamada. Nesta tabela teria sempre o id do conte√∫do raiz, data da resposta e o o parent id. √â claro que √© redundante esta informa√ß√£o, mas talvez uma vantagem seria a simplicidade de fazer join e tornar este contador junto a listagem de tabnews.
- Talvez outra possibilidade seria a propria tabela de conteudo ter o campo parent_root sempre contendo o id na tabnews raiz

## Resumo.

- Faz sentido esta funcionalidade
- Alguem imagina uma solu√ß√£o mais simples ou mais elegante que a proposta aqui?

>> Coment√°rio de filipedeschamps:
@huogerac estou fechando essa issue em prefer√™ncia a essa aqui que est√° no padr√£o da milestone: #332

Na sub-tarefa sobre a api tem todas as sugest√µes de como executar evitando a necessidade de criar uma nova tabela üëç
</issue_327_Contador de respostas de cada conte√∫do>

<issue_328_Criar avatar do usu√°rio>
## Problema

Como visitante do tabnews, gostaria de cadastrar meu avatar e que ele fosse exibido ao lado dos meus posts

![image](https://user-images.githubusercontent.com/962233/169177383-594f6d0b-ef9e-491e-8cff-ac2c15336cea.png)


## Solu√ß√£o

1. Criar o campo "avatar: string" na tabela de users como nullable
2. Talvez, permitir que no cadastro seja informado uma url v√°lida para este campo
3. Ou um novo endpoint, com uma api fazendo patch na tabela de usu√°rio alterando o campo avatar que est√° por padr√£o null
4. Alterar a listagem para retornar o avatar junto om o username

## Resumo

- Faz sentido neste momento
- Acredito que este mesmo campo poder√° ser preenchido automaticamente depois que tiver login com GitHub

>> Coment√°rio de rodrigoKulb:
@huogerac total, sou muito visual e gosto de olhar e j√° saber de quem √© o post / artigo.

>> Coment√°rio de filipedeschamps:
@huogerac estou reorganizando o reposit√≥rio e por hora vou fechar essa issue. Qualquer coisa que queira deixar registrado de melhoria, estamos centralizando nessa publica√ß√£o aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda

Em paralelo, algo a se pensar: talvez n√£o dever√≠amos dividir a aten√ß√£o do leitor entre o que foi publicado e o autor dessa publica√ß√£o, no sentido de que nessa vis√£o n√£o importa quem publicou, o que importa √© se a publica√ß√£o possui valor concreto. Pensando nisso, talvez seja at√© interessante na lista deixar o autor da publica√ß√£o por √∫ltimo, por exemplo:

<img width="623" alt="image" src="https://user-images.githubusercontent.com/4248081/178357670-1b21081f-16b7-44dd-883a-f6edff898505.png">
</issue_328_Criar avatar do usu√°rio>

<issue_330_Ajuda para entender frontend do tabnews üß† HELP PLEASE>
Galera do c√©u! Acredito que voc√™s do React est√£o todos doido fazer frontend assim! hehehe, espera que vou explicar! E realmente estou torcendo para estar engado e ser convencido do contr√°rio! okay? ü§î

**Entendi que a p√°gina principal da listagem de tabnews come√ßa aqui:**

```
# pages/interface/index.js  üëâ Um componente formado por diversos outros componentes

export { default as BaseLayout } from './components/BaseLayout/index.js';  üëâ Layout, legal
export { default as DefaultLayout } from './components/DefaultLayout/index.js';
export { default as Header } from './components/Header/index.js';   üëâ Cabe√ßalho

export { default as Content } from './components/Content/index.js';
export { default as ContentList } from './components/ContentList/index.js'; üëâ o loop que monta a listagem

export { default as useUser } from './hooks/useUser/index.js';

```

E dentro do componente da listagem (`pages/interface/components/ContentList/index.js`), temos:

![image](https://user-images.githubusercontent.com/962233/169186817-7e469f4d-a469-4d7b-8a0d-0c058f84418f.png)

Foi aqui que fiquei assustado e me questionando, isto realmente √© uma boa abordagem? gerar HTML via JS? Estou pensando no cen√°rio onde temos no time pessoas que s√£o √≥timos frontenders, ou seja, detonam no HTML + CSS, s√£o √≥timos designers de interfaces, UI, UX etc...fazem p√°ginas est√°ticas lindas em um tempo curto!

√â tranquilo pra esta galera criar p√°ginas usando este formato? √â interessante ter estilo dentro do JS?
Desculpa a ignor√¢ncia, mas qual a vantagem desta forma? Lembrei do tempo desta ideia no framework web Java criado pelo Google (Google Web Tool Kit), que acredito n√£o foi pra frente...

```
        <Box key={contentObject.id} sx={{ display: 'flex' }}>
          <Box sx={{ mr: 2, width: '20px', textAlign: 'right' }}>
            <Text sx={{ fontSize: 2, color: 'fg.default', fontWeight: 'semibold' }}>{count++}.</Text>
          </Box>
```
Box provavelmente vai gerar uma `<div>`

Eu estava esperando achar um arquivo .HTML no projeto, com templates √© claro, para fazer interpola√ß√£o de strings, alguma linguagem de template para fazer loops e condicionais ao inv√©s do html gerado automaticamente.

Eu venho de Django e VueJS, onde √© comum encontrar componentes web como:

```
    <v-list three-line>
      <template v-for="(item, index) in tabnewsList">
        <v-list-item :key="item.title">
          <v-list-item-avatar>
            <v-img :src="item.author.avatar"></v-img>
          </v-list-item-avatar>

          <v-list-item-content>
            <v-list-item-title v-html="item.title"></v-list-item-title>
            <v-list-item-subtitle
              v-html="
                `${item.description} &mdash; <span class='text--primary'>by ${item.author.name}</span>`
              "
            ></v-list-item-subtitle>
          </v-list-item-content>
        </v-list-item>
```

Onde um frontender, por mais que veja a linguagem de template, entende rapidamente e consegue criar p√°ginas usando o mundo que ele domina, adicionando CSS e tags HTML diretamente nos arquivos html

Enfim, gostaria de entender as vantagens desta abordagem, e quem sabe questionar se n√£o ser√° muito dif√≠cil fazer uma p√°gina bonitona, com recursos modernos, produzindo html sem√¢ntico e que ajudara no SEO e tudo mais tendo que fazer p√°ginas com JS diretamente.

Eu tive a impress√£o que esta abordagem √© para devs que n√£o querem se preocupar com frontend, css principalmente e tem uma lista de componentes (igual quando usamos bootstrap css), mas aqui fazemos de forma declarativa quais componentes vamos colocar na p√°gina.

confesso que o que mais achei estranho √© misturar estilo (como display: flex, font-size) junto onde colocamos conte√∫do!

Bom! espero estar com a impress√£o errada e que voc√™s me mostrem que estou enganado e isto √© uma boa ideia sim!

Valeu! ‚úå

>> Coment√°rio de huogerac:
Se entendi, isto vem do https://primer.style/react/

>> Coment√°rio de tembra:
> Se entendi, isto vem do https://primer.style/react/

√â isso mesmo @huogerac !

Foi aproveitado toda a implementa√ß√£o de HTML+CSS do GitHub's Primer Design System para React.

Assim a base da marca√ß√£o de texto e estiliza√ß√£o j√° est√° pronta, e est√° sendo modificado somente os estilos desejados atrav√©s de props.

>> Coment√°rio de escote:
Roger,

Gosto muito da abordagem do vue, que separa o html de javascript e, na MINHA OPINI√ÉO, deixa o c√≥digo mais limpo, no entanto, o react, por trabalhar com JSX, facilita muito a componentiza√ß√£o, o que tamb√©m gera benef√≠cios para a manutenibilidade do c√≥digo. Al√©m disso √© uma biblioteca consolidada, perform√°tica e fica ainda mais pr√°tica e poderosa com o next.js e hospedagem da vercel.

O angular tamb√©m trabalha com templates de forma parecida com o vue, possibilitando a separa√ß√£o do html com diretivas, por outro lado, criar um componente ou utilizar √© um pouco mais burocr√°tico e gera um punhado de boilerplate. Tem pontos positivos em rela√ß√£o a robustez da arquitetura da aplica√ß√£o, mas convenhamos que hoje em dia dificilmente um site ou app de sucesso dura mais de 5 anos sem ser reformulado, estou errado?

No final das contas, √© um trade-off onde a experi√™ncia ou capacidade de adaptabilidade do time √© uma das vari√°veis mais relevantes.

De qualquer forma, assim como um programador backend java precisa dominar uma s√©rie se frameworks (spring, jpa, sql, etc), um desenvolvedor front-end que se prop√µe a trabalhar com React precisa se familiarizar com JSX, caso contr√°rio, ele vai precisar fazer o html e css e repassar para outro programador que converta para um c√≥digo ‚Äúvivo‚Äù, assim como teria que fazer com vue, angular, etc.

>> Coment√°rio de filipedeschamps:
Turma, muito obrigado por toda ajuda nessa issue! Pelo que entendo ela foi esclarecida ent√£o estou fechado @huogerac qualquer outra d√∫vida, n√£o deixe de perguntar.
</issue_330_Ajuda para entender frontend do tabnews üß† HELP PLEASE>

<issue_332_Quantidade de respostas>
## Contexto

Hoje a Home do TabNews n√£o mostra a quantidade de coment√°rios que um conte√∫do tem e isso √© uma m√©trica visual muito importante para quem est√° escolhendo um conte√∫do para ler.

## Execu√ß√£o

- [x] #333
- [x] #334

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #366 ü§ù
</issue_332_Quantidade de respostas>

<issue_333_`comments(api)`: retornar o n√∫mero de conte√∫dos `children` pela API>
## Contexto

Hoje um `content` n√£o retorna a quantidade de conte√∫dos `children` que possui, por exemplo:

https://www.tabnews.com.br/api/v1/contents/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa

JSON retornado:

```json
{
  "id": "4b4ef715-2840-4a2f-8914-dc9d6e3f7742",
  "owner_id": "07ea33ea-78bd-4578-bad2-1cf5323cab07",
  "parent_id": null,
  "slug": "tentando-construir-um-pedaco-de-internet-mais-massa",
  "title": "Tentando construir um peda√ßo de internet mais massa",
  "body": "...",
  "status": "published",
  "source_url": null,
  "created_at": "2022-05-06T15:20:01.159Z",
  "updated_at": "2022-05-06T16:45:51.666Z",
  "published_at": "2022-05-06T15:20:01.158Z",
  "username": "filipedeschamps",
  "parent_title": null,
  "parent_slug": null,
  "parent_username": null
}
```

Voc√™ pode acessar a √°rvore inteira de children adicionado ao endpoint ali de cima o `/children`, mas mesmo assim isso n√£o retorna o valor j√° computado, retorna apenas os objetos:

https://www.tabnews.com.br/api/v1/contents/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa/children

## Execu√ß√£o

### Model
No model `content`, todos os m√©todos devem retornar uma nova propriedade chamada `children_count` com o n√∫mero de conte√∫dos filho.

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/models/content.js#L544-L551

Em alguns desses m√©todos, n√≥s podemos hoje nos dar o luxo de duplicar a l√≥gica que recursivamente encontra todos os conte√∫dos `children` a partir de um `id` de um `content` (um `parent_id`). Isso est√° dispon√≠vel no m√©todo `findChildren()`

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/models/content.js#L434-L542

Talvez seja interessante alterar o nome desse m√©todo de `findChildren()` para `findChildrenTree()`, pois como temos interesse **apenas no n√∫mero**, podemos criar um novo m√©todo chamado `findChildrenCount()` e a query que vamos duplicar pode simplificada e podemos nos focar apenas em fazer um count dos ids dos conte√∫dos retornados (ignorando todas as outras colunas e alguns JOINs respons√°veis por trazer dados como `username`).

E para manter a exata mesma assinatura do objeto retornado ao consultar um `parent_id` ou a sua √°rvore de `children`, na constru√ß√£o da¬†√°rvore que est√° dentro do m√©todo `findChildrenTree()` (considerando seu novo nome) a gente pode pelo JavaScript computar e injetar esse valor em cada n√≥, mesmo que precise fazer mais um loop:

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/models/content.js#L523-L542

### Endpoint

Retornar o novo valor `children_count` tanto na consulta do endpoint raiz do conte√∫do, quanto no `/children`:

1. Raiz: https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/index.public.js
2. Children: https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/children/index.public.js

E eu acho que a √∫nica coisa que vai precisar fazer, √© mexer no arquivo de valida√ß√£o para deixar esse dado novo ser "vazado" para interface p√∫blica:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/validator.js

Ser√° preciso criar uma nova chave chamada `children_count` e adicionar ela na valida√ß√£o do `content` (que √© recursiva)

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/models/validator.js#L401-L435

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #366 ü§ù
</issue_333_`comments(api)`: retornar o n√∫mero de conte√∫dos `children` pela API>

<issue_334_`comments(page)`: mostrar no ContentList o n√∫mero de conte√∫dos `children`>
## Contexto

O componente `ContentList` √© o que est√° sendo usado para mostrar listas de conte√∫dos (a que aparece na Home, ou quando se acessa o endere√ßo de um usu√°rio), por exemplo:

https://www.tabnews.com.br/
https://www.tabnews.com.br/filipedeschamps

O arquivo do componente est√° aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/ContentList/index.js

## Execu√ß√£o

Mostrar a quantidade de "respostas" (conte√∫dos `children`) que estar√£o vindo pela chave `children_count`. Sugiro colocar como a primeira informa√ß√£o e colocar um divisor, por exemplo:

`10 coment√°rios ¬∑ filipedeschamps h√° 9 horas atr√°s`

Cuidado com a varia√ß√£o entre `0 coment√°rios` e `1 coment√°rio`.

E aproveitar para remontar o layout dessa lista utilizando uma **Lista Ordenada** (`<ol>`) pois o layout est√° quebrando conforme a largura do t√≠tulo. Ou qualquer outra estrat√©gia melhor do que est√° hoje, porque veja a diferen√ßa de posi√ß√£o do n√∫mero da postagem entre os t√≠tulos que ocupam somente uma linha ou mais linhas:

<img width="358" alt="image" src="https://user-images.githubusercontent.com/4248081/169199564-9bf31254-e2d8-451a-b059-32c5b97afcdb.png">

Fora que, a partir do item `100`, come√ßa a gerar um overlap:

<img width="283" alt="image" src="https://user-images.githubusercontent.com/4248081/169199974-b3f71f67-d0fe-452a-acb4-e3f66e7ed86d.png">


## Depend√™ncia
- #333

>> Coment√°rio de tembra:
> E aproveitar para remontar o layout dessa lista utilizando uma Lista Ordenada (<ol>) pois o layout est√° quebrando conforme a largura do t√≠tulo.

Ia abrir uma issue pra isso. Percebi hoje. No meu computador o overlap ia acontecer a partir do item 1000.

Muito bom!

O que voc√™ acha de darmos uma repaginada no visual pra ficar mais leg√≠vel e organizado ? Parecido com o apresentado no projeto [TabNews mobile](https://www.tabnews.com.br/higor/aplicativo-do-tabnews).

>> Coment√°rio de filipedeschamps:
> O que voc√™ acha de darmos uma repaginada no visual pra ficar mais leg√≠vel e organizado ? Parecido com o apresentado no projeto [TabNews mobile](https://www.tabnews.com.br/higor/aplicativo-do-tabnews).

Ta muito massa esse projeto n√©? A ideia dos coment√°rios "collapsados" ficou muito legal. Por hora sugiro primeiro jogarmos tudo que temos na interface (que a chegada das TabCoins vai mudar coisas fundamentais) e com isso reavaliar o que fazer ü§ù 

Um princ√≠pio que sugiro seguir √©: "qual a forma mais r√°pida escanear informa√ß√£o?"

O benchmark para mim √© o HackerNews: https://news.ycombinator.com/news

Depois do choque inicial do qu√£o feio √© o site, fica muito r√°pido consumir a lista inteira e os coment√°rios dentro dos posts. √â **zero atrito**.

>> Coment√°rio de gabrielew:
@filipedeschamps estou terminando de implementar essa feature, mas n√£o manjo muito de nextjs.

Quando a tela √© renderizada ele mostra a quantidade correta de coment√°rios, mas 1 segundo depois muda para undefined e n√£o estou achando o problema. Poderia ajudar?

https://user-images.githubusercontent.com/9862392/169315921-6816ab5e-dc12-408c-9095-893c562a3a7e.mov

>> Coment√°rio de filipedeschamps:
@gabrielew sem ver o c√≥digo eu n√£o saberia dizer o que √©, mas provavelmente vai ter a ver com a seguinte din√¢mica:

1. Primeiro acesso da p√°gina √© atrav√©s de um conte√∫do est√°tico (que vem da CDN, gerado pelo `getStaticProps()`) e que pode estar desatualizado, mas que carrega instantaneamente.
2. Depois √© feito uma chamada no backend batendo no endpoint `/api/v1/contents` buscando pelo conte√∫do mais atualizado poss√≠vel. Essa chamada √© feita aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/index.public.js#L10

Que chama isso aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/interface/components/ContentList/index.js#L8

Ent√£o talvez voc√™ est√° passando o dado pelo `getStaticProps()`, mas n√£o est√° passando pela API no endpoint `/api/v1/contents`.

>> Coment√°rio de gabrielew:
Eu fiz as altera√ß√µes direto no model.
vou abrir uma pr para lhe mostrar

>> Coment√°rio de filipedeschamps:
Ent√£o ser√° necess√°rio executar o que est√° na se√ß√£o **Endpoint** dessa issue: #333

Que √© incluir esse campo na valida√ß√£o, se n√£o ela vai filtrar/remover o campo na resposta da API.

>> Coment√°rio de gabrielew:
> Ent√£o ser√° necess√°rio executar o que est√° na se√ß√£o **Endpoint** dessa issue: #333
> 
> Que √© incluir esse campo na valida√ß√£o, se n√£o ela vai filtrar/remover o campo na resposta da API.

Eu fiz essas altera√ß√µes, conseguiu ver a PR?

Edit: Consegui achar o problema.

>> Coment√°rio de filipedeschamps:
Parte essa issue foi conclu√≠da por @omariosouto no PR #389 e #392 (alinhamento dos itens).

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #366 ü§ù
</issue_334_`comments(page)`: mostrar no ContentList o n√∫mero de conte√∫dos `children`>

<issue_335_Salvar o conte√∫do das postagens ainda n√£o publicadas no `localStorage`>
## Contexto

J√° perdi 3 postagens que eu estava escrevendo por conta de refresh ou click acidental e isso √© bastante desanimador e imagino que isso esteja acontecendo com mais pessoas. Ent√£o devemos salvar temporariamente o conte√∫do que est√° sendo criado na m√°quina local do usu√°rio. O Github faz isso (n√£o sei como eles fazem), mas se voc√™ estiver escrevendo uma issue e der refresh sem querer, o conte√∫do n√£o se perde, ele volta como se nada tivesse acontecido.

## Execu√ß√£o

N√£o sei qual a melhor estrat√©gia, mas pensei em a cada `Keyup`, salvar o `title`, `body` e `source_url` no `localStorage` do usu√°rio. Talvez se isso for muito pesado (quando estiver lidando com um conte√∫do muito grande), colocar um `debounce`.

Um cuidado que eu teria √© que como tudo √© `content` e tudo usa o mesmo componente [Content](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/Content/index.js), n√£o podemos fazer o `localStorage` se atravessar e sobrescrever o que √© a escrita de um conte√∫do raiz (usado para criar novas postagens na Home) e conte√∫dos filho, que s√£o respostas a outros conte√∫dos.

S√≥ d√° para escrever 1 conte√∫do raiz por vez, mas d√° para escrever v√°rias respostas por vez, ent√£o talvez seja necess√°rio um identificador √∫nico (o id encontrado no `parent_id` quando existir?) na chave usada do `localStorage`.

De qualquer forma, se a pessoa der refresh na p√°gina e existir algo dentro do `localStorage`, recuperar isso e auto-preencher os campos.

E se a postagem for feita com **sucesso**, remover esses dados do `localStorage`.

>> Coment√°rio de andreghisleni:
Opaaa @filipedeschamps achei interessante essa id√©ia, ainda mais pelo fato de ter implementado algo semelhante em um sistema que eu trabalhei. Na minha opini√£o salvar no localstorage √© a melhor alternativa, eu ainda estou me achando nesse projeto mas assim que eu tiver tempo eu implemento essa funcionalidade

>> Coment√°rio de andreghisleni:
@filipedeschamps s√≥ me tira uma duvida, para mim poder fazer altera√ßoes e mandar um pull eu tenho que fazer um fork desse repositorio??

>> Coment√°rio de filipedeschamps:
@andreghisleni pode criar uma nova branch aqui mesmo e mandar PR, n√£o precisa de fork üëç

>> Coment√°rio de andreghisleni:
Pronto t√° na m√£o

>> Coment√°rio de andreghisleni:
Opaaa @filipedeschamps acredito eu que podemos fechar essa issue, pois j√° foi implementado, mesmo que n√£o esteja na produ√ß√£o, est√° em teste na url: https://tabnews-git-localstorage-tabnews.vercel.app/

>> Coment√°rio de filipedeschamps:
@andreghisleni sugiro s√≥ fechar a issue quando estiver em produ√ß√£o, principalmente por conta do problema do commit com mensagem quebrada do outro PR ü§ù

>> Coment√°rio de filipedeschamps:
Mergeeed!!!! Let's gooooo @andreghisleni üòç j√° est√° rodando em produ√ß√£o ü§ù üëç üéâ

>> Coment√°rio de andreghisleni:
boaaaa

>> Coment√°rio de filipedeschamps:
@andreghisleni fiz um post sobre essa nova melhoria: https://www.tabnews.com.br/filipedeschamps/nova-melhoria-voce-nao-perde-mais-os-conteudos-que-estiver-escrevendo-por-refresh-acidental

>> Coment√°rio de filipedeschamps:
@andreghisleni estou reabrindo essa issue, pois localizei um bug que impossibilita editar os conte√∫dos de um post. Para reproduzir:

1. Crie um post no ambiente de homologa√ß√£o dessa features: https://tabnews-git-localstorage-tabnews.vercel.app/
2. Na tela na qual for redirecionado, edite o post e voc√™ ver√° que somente o corpo vai carregar.
3. Comece a escrever uma **resposta** para voc√™ mesmo (mas n√£o publique), apenas fa√ßa refresh.
4. Agora edite o post principal e o conte√∫do da resposta vai estar no post principal.

>> Coment√°rio de filipedeschamps:
@andreghisleni um usu√°rio identificou v√°rios outros comportamentos interessantes: https://www.tabnews.com.br/Pryds/c3376f31-85eb-4b2d-92fa-f8c5d2fdcf94

>> Coment√°rio de andreghisleni:
j√° vi e estou analisando o c√≥digo pra achar o erro

>> Coment√°rio de andreghisleni:
agora eu acho que eu lembro o por que do id do usu√°rio

>> Coment√°rio de andreghisleni:
Pronto, ta na m√£o a corre√ß√£o

>> Coment√°rio de filipedeschamps:
Estamos com **16%** da Milestone completada üòç

<img width="458" alt="image" src="https://user-images.githubusercontent.com/4248081/169677505-db62f417-0e48-4315-93bf-fdf9d9a0398c.png">

>> Coment√°rio de filipedeschamps:
@andreghisleni https://www.tabnews.com.br/Pryds/9f8249eb-7fae-46ac-a151-a914f3c6ef48

üéâ
</issue_335_Salvar o conte√∫do das postagens ainda n√£o publicadas no `localStorage`>

<issue_336_`useUser()`: somente bater no endpoint se existir cookie indicando sess√£o>
## Contexto

O hook [useUser](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/hooks/useUser/index.js) √© usado para coisas como, no cabe√ßalho do TabNews mostrar os links de [Login/Cadastro](https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/interface/components/Header/index.js#L25-L38) se a pessoa n√£o estiver autenticada, ou mostrar o dropdown com o `username` do usu√°rio.

Ele tamb√©m √© usado para mostrar ou n√£o aquele bot√£o adicional de [editar o seu pr√≥prio conte√∫do](https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/interface/components/Content/index.js#L148) no componente Content.

Ainda nesse componente, ele tamb√©m √© usado para [mostrar uma mensagem](https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/interface/components/Content/index.js#L178) caso a pessoa n√£o esteja logada.

O problema √© que hoje, independente da condi√ß√£o do usu√°rio estar logado ou n√£o, ele bate no endpoint `/api/v1/user` e isso est√° causando bastante ru√≠do nos logs, pois todas as pessoas que est√£o visitando o site e n√£o est√£o logadas, por tr√°s dos panos est√£o tomando um `403`... e esses `403` est√£o se acumulando. Precisamos limpar isso, o que tamb√©m ir√° parar de "flickar" o cabe√ßalho durante essa verifica√ß√£o (fa√ßa um refresh no TabNews e note que agonia, n√£o aparece nada enquanto o endpoint n√£o retorna).

## Execu√ß√£o

Ao fazer Login (criar uma sess√£o), o backend devolve um cookie `session_id` mas que por quest√µes de seguran√ßa ele n√£o pode ser lido pelo client-side, ent√£o hoje n√£o d√° para saber se a pessoa est√° logada ou n√£o sem bater na rota citada acima.

Dito isso, a ideia geral √© na linha de: se **n√£o houver** algum outro identificado est√°tico de que sinalize que a pessoa possa estar logada, **n√£o fazer a request citada acima**, porque com certeza vai tomar um `403`. Se a pessoa tiver esse identificador, isso tamb√©m n√£o √© garantia que ela continua logada, ent√£o nesse caso deve ser feita a request... que caso tome um `403`, da√≠ deve se remover esse identificador.

Mas agora as d√∫vidas s√£o: esse identificador deve ser o que? Um cookie? Um item no localStorage? Quem deve setar ele, o client ou server? Em que momento? No momento do Login? Mas e as pessoas que j√° passaram pelo est√°gio de Login e se mant√©m logadas, como fazer uma feature que seja compat√≠vel com elas tamb√©m (porque elas n√£o ter√£o de in√≠cio o identificador)? Ent√£o ser√° que nesse caso a rota `/api/v1/user` deveria retornar um cookie adicional que seja acess√≠vel pelo client-side?

Talvez o `/api/v1/user` sempre deva retornar um cookie com o `username` atual do usu√°rio (porque ele pode mudar isso) e essa informa√ß√£o pode ser usada como o identificador. Se n√£o tiver esse cookie, a pessoa est√° deslogada. Das pessoas que j√° est√£o logadas, mas tamb√©m n√£o tem esse cookie, na pr√≥xima chamada do `/api/v1/user` elas v√£o receber o cookie (o problema √© como fazer elas chamarem o endpoint, dado que nosso objetivo agora √© parar de chamar o endpoint se n√£o tiver esse identificador). Talvez fazer uma chamada manual tempor√°ria, e remover isso depois de 30 dias. Enfim, se a pessoa tiver esse cookie, j√° instantaneamente usar isso como o `username` que aparece no cabe√ßalho para parar o flicker.

>> Coment√°rio de aprendendofelipe:
> Talvez o `/api/v1/user` sempre deva retornar um cookie com o `username` atual do usu√°rio (porque ele pode mudar isso) e essa informa√ß√£o pode ser usada como o identificador. Se n√£o tiver esse cookie, a pessoa est√° deslogada. Das pessoas que j√° est√£o logadas, mas tamb√©m n√£o tem esse cookie, na pr√≥xima chamada do `/api/v1/user` elas v√£o receber o cookie (o problema √© como fazer elas chamarem o endpoint, dado que nosso objetivo agora √© parar de chamar o endpoint se n√£o tiver esse identificador). Talvez fazer uma chamada manual tempor√°ria, e remover isso depois de 30 dias. Enfim, se a pessoa tiver esse cookie, j√° instantaneamente usar isso como o `username` que aparece no cabe√ßalho para parar o flicker.

Isso! E essa chamada tempor√°ria pode ser s√≥ na tela de login, para j√° eliminar o `403` desnecess√°rio das outras p√°ginas.

Assim, se o usu√°rio ainda n√£o tem o cookie com o `username`, as p√°ginas v√£o renderizar como se ele estivesse deslogado. Mas ao tentar postar algo j√° vai direcionar para o login, fazer a chamada para `/api/v1/user` automaticamente e voltar para onde estava sem precisar digitar a senha novamente (caso ele j√° esteja autenticado).

Lembrando que isso de aparecer como deslogado s√≥ vai acontecer para quem j√° est√° previamente autentitcado, mas ainda n√£o acessou a vers√£o nova para obter o cookie.

>> Coment√°rio de tembra:
Estou querendo pegar essa issue amanh√£ se tudo der certo! hehehe
Mas fiquem a vontade :)

Coment√°rio apenas pro @filipedeschamps trabalhar em outra frente se for o caso.

>> Coment√°rio de filipedeschamps:
Ta pensando aqui, essa feature tem 3 pontos de intera√ß√£o:

1. Login
2. Requisi√ß√µes no meio da exist√™ncia da sess√£o
3. Logout

Talvez para cobrir tudo de forma centralizada, a gente pode trabalhar dentro do model `session`, pois ele √© o respons√°vel por renovar o cookie de sess√£o `session_id`... mais especificamente no m√©todo `setSessionIdCookieInResponse()` como a gente vai ver um pouco mais pra frente.

Tudo come√ßa aqui nesse middleware que √© declarado em basicamente todas as rotas:

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/models/authentication.js#L25

E se o usu√°rio est√° autenticado (que √© o caso que queremos), a chamada entra aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/models/authentication.js#L39

E se a sess√£o existe no banco de dados (e ela ainda est√° v√°lida) e o usu√°rio existe e possui todas as permiss√µes, a sess√£o √© renovada aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/models/authentication.js#L51

E renovar significa duas coisas:

1. Renovar a data de expira√ß√£o da sess√£o l√° no banco de dados (que n√£o importa para essa implementa√ß√£o).
2. Setar de novo o cookie `session_id` com uma nova data de expira√ß√£o utilizando o m√©todo que comentei ` setSessionIdCookieInResponse()`.

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/models/session.js#L99-L100

Hoje esse m√©todo n√£o recebe o `user`, recebe somente o token da sess√£o e o objeto de `response` do Next.js, mas poderia aceitar o `user` ou um `username` para aproveitar e "renovar" isso nos cookies tamb√©m. Ent√£o poderia se chamar de uma forma mais gen√©rica, como `setAuthenticationCookiesInResponse()` porque da√≠ quando precisarmos implementar o `/logout`, podemos ter um m√©todo par chamado `removeAuthenticationCookiesInResponse()`.

Fora isso, na hora de fazer o login (que √© criar uma sess√£o), existe essa chamada:

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/pages/api/v1/sessions/index.public.js#L77

E esse m√©todo **tamb√©m** usa o `session.setSessionIdCookieInResponse`:

https://github.com/filipedeschamps/tabnews.com.br/blob/15fe956cfeb0dbcdd3198743824acdf534763b66/models/authentication.js#L78

Que novamente, poderia ser renomeado para algo mais gen√©rico e que fa√ßa comportar tamb√©m username.

---

Assim, todas as rotas que injetam o usu√°rio v√£o ganhar esse recurso de gra√ßa e teremos mais elasticidade para adicionar ou remover cookies de autentica√ß√£o de uma forma centralizada.

O que acham?

---

Como √∫ltimo ponto de observa√ß√£o, quando um controller recebe um erro de Autoriza√ß√£o, ele chama esse m√©todo que limpa o `session_id`:

https://github.com/filipedeschamps/tabnews.com.br/blob/2c34a1f1397bb24454c497de61637baec1f13495/models/controller.js#L36

Ele tamb√©m deveria ser algo mais gen√©rico e gente poderia renomear o m√©todo `clearSessionIdCookie()` para `removeAuthenticationCookiesInResponse()`, pois isso casaria 100% com a sugest√£o do `/logout` ali de cima.

>> Coment√°rio de filipedeschamps:
Em paralelo, me veio agora uma outra id√©ia que n√£o pensei muito a fundo, mas acho que vai ajudar muito na performance da interface:

1. Salvar o retorno do `/user` em `localStorage`.
2. Se h√° essa informa√ß√£o em `localStorage`, usar ela e assumir que ela est√° v√°lida.
3. Isso vai fazer com tudo que precise do `useUser()` apare√ßa instantaneamente na tela, seja o `username` l√° em cima no menu, ou a op√ß√£o de editar o seu pr√≥prio conte√∫do.
4. Em paralelo (e eu n√£o sei como para ser sincero), fazer uma chamada no backend para buscar as informa√ß√µes atualizadas do `/user`.

Em resumo, seria uma estrat√©gia de `stale-while-revalidate`, mas local (dado que n√£o podemos fazer o cache dessa rota na CDN).

>> Coment√°rio de filipedeschamps:
Estava pensando em usar algo como isso, olha que legal: https://github.com/leoafarias/use-state-persist

Algu√©m conhece algo mais atualizado?

>> Coment√°rio de aprendendofelipe:
Opa, s√£o dois problemas...

1) Para a quest√£o de menos acessos desnecess√°rios para a API, acho boa ideia usar o `localStorage`, nem que seja s√≥ como solu√ß√£o tempor√°ria, pois assim daria pra resolver mexendo s√≥ no front. Provavelmente s√≥ no `useUser` e em `pages/login`.

2) J√° o problema do render, acho que a estrat√©gia pode ser outra, pois mesmo buscando o `username` no `localStorage`, sempre ir√° renderizar o html est√°tico primeiro e depois o do client, ent√£o eles precisam ser mais compat√≠veis em qualquer situa√ß√£o, seja logado ou n√£o. Talvez algo assim:
- **Header** - N√£o enviar mais as op√ß√µes Login e Cadastrar no html est√°tico. Ap√≥s inicializar o `useUser`, a√≠ sim renderizar o que fizer sentido (`username` ou `Entrar`), mas com uma transi√ß√£o mais suave e tentando evitar deslocamentos.
- **Content** - Sempre renderizar os 3 pontinhos, s√≥ mudando as op√ß√µes que aparecem ao clicar neles. Sem estar logado pode aparecer s√≥ a op√ß√£o de denunciar, por exemplo.

>> Coment√°rio de filipedeschamps:
Show de bola!! E n√£o acho que √© uma solu√ß√£o tempor√°ria, ter o user local (mesmo que stale), vejo que √© uma √≥tima solu√ß√£o.

* **Header**: Sobre renderizar s√≥ quando souber o que renderizar, eu vi que a Vercel faz isso na Dashboard deles. E n√£o precisa ser suave, acho que quanto mais r√°pido melhor, o problem √© que hoje o dropdown tem um height que faz o menu dar um pulinho pra baixo, ta feio.
* **Content**: Por enquanto eu utilizaria a mesma estrat√©gia do Header, que √© s√≥ renderizar quando souber o que renderizar (que √© o que est√° hoje).

Em paralelo, eu vi que o SWR tem um suporte para local cache, olha s√≥:

* [LocalStorage Based Persistent Cache](https://swr.vercel.app/docs/advanced/cache#localstorage-based-persistent-cache)
* [Sync SWR cache with Web Storage](https://sergiodxa.com/articles/swr/storage-sync/#sync-swr-cache-with-web-storage)

Achei bem legal a solu√ß√£o 2 ali.

Em paralelo, quando o `useUser()` recebe um `403`, precisamos fazer o objeto de erro ser retornado na propriedade de erro do swr e do nosso hook, e n√£o do user. Acho que sem isso n√£o d√° para chamar o callback de erro ali do segundo artigo, e tamb√©m vamos parar de mandar um objeto de erro no lugar do objeto de user (e o front vai se virar melhor com isso).

Bom, n√£o vou mexer nisso agora, quero me focar nas issues de voltar o n√∫mero de coment√°rios pela API ü§ù

>> Coment√°rio de aprendendofelipe:
> Opa, s√£o dois problemas...

Dos dois problemas, o primeiro √© resolvido no PR #440.

J√° o segundo, como mexe com o design, acho que d√° pra ficar para uma nova Issue.

>> Coment√°rio de tembra:
@filipedeschamps 

> Salvar o retorno do `/user` em `localStorage`

Eu estava pensando em implementar _exatamente_ assim! hehehe

Infelizmente meus dias (e finais de semana üòÖ) est√£o concorridos e ainda n√£o consegui por a m√£o nessa issue.

>> Coment√°rio de aprendendofelipe:
Edit. Eu tinha invertido direita e esquerda üòÖ

>  o problem √© que hoje o dropdown tem um height que faz o menu dar um pulinho pra baixo, ta feio.

N√£o percebo esse pulinho pra baixo. O que me incomoda mais √© o deslocamento do bot√£o de Status que faz coisas piscarem... Se esse bot√£o permanecer na direita e os componentes que s√≥ surgem no segundo render ficarem mais para a esqurda, j√° fica uma transi√ß√£o "suave".

Se acharem que compensa ver como fica (eu j√° testei aqui e curti), posso colocar isso no PR #440 ou, melhor ainda, no #425 (que, entre outras coisas, fixa o Header no topo).

Ou testem por si, movendo o Status l√° para o final do componente Header:
```js
...
      )}

      <Header.Item>
        <Header.Link href="/status" fontSize={2}>
          Status
        </Header.Link>
      </Header.Item>
    </Header>
  );
}

>> Coment√°rio de filipedeschamps:
Issue fechada por dois PRs, dado que ela foi atacada em duas Fases:

* Fase 1: https://github.com/filipedeschamps/tabnews.com.br/pull/440
* Fase 2: https://github.com/filipedeschamps/tabnews.com.br/pull/460

Todas lideradas por @aprendendofelipe

>> Coment√°rio de filipedeschamps:
Fora a UX **muito melhor** de usar o localStorage para mostrar o menu l√° em cima, essa √© a situa√ß√£o de erros do TabNews antes desse deploy, os erros do endpoint `/api/v1/user` esmagam os outros erros. Agora finalmente podemos criar um alerta para tentar pegar algum desvio de erros com n√∫meros que fa√ßam sentido üéâ

<img width="988" alt="image" src="https://user-images.githubusercontent.com/4248081/173887590-78be0511-b851-4cfc-9673-ade35586279c.png">

>> Coment√°rio de filipedeschamps:
@aprendendofelipe post comemorativo üòç https://www.tabnews.com.br/filipedeschamps/nova-melhoria-aumento-de-performance-para-usuarios-logados-ultima-tarefa-antes-das-tabcoins üéâ

>> Coment√°rio de filipedeschamps:
Olha como est√° o gr√°fico de erro do `/api/v1/user`, tenta adivinhar s√≥ por ele quando que foi feito o deploy:

<img width="1732" alt="image" src="https://user-images.githubusercontent.com/4248081/174118488-6724b2be-5a5d-40bd-accc-61350da1abec.png">

>> Coment√°rio de rodrigoKulb:
@filipedeschamps a maioria dos acessos s√£o de usu√°rios an√¥nimos?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb √≥tima pergunta! Eu n√£o saberia dizer, preciso pensar em como montar uma query que agrupe isso ü§ù  se eu conseguir mando o print em algum momento üëç
</issue_336_`useUser()`: somente bater no endpoint se existir cookie indicando sess√£o>

<issue_337_Tags para SEO e Redes Sociais>
## Contexto

Essa issue possui dois est√°gios, o primeiro na qual iremos trabalhar nessa Milestone e envolve apenas **texto**, e o segundo que iremos trabalhar no futuro e que envolve **imagem** (tenho umas ideias massa para quando o post n√£o possui imagem). Ent√£o o que est√° acontecendo hoje √© que ao compartilhar um link do TabNews, nem toda aplica√ß√£o est√° conseguindo ler as informa√ß√µes da p√°gina, por exemplo:

![IMG_0DF9A8918762-1](https://user-images.githubusercontent.com/4248081/169299232-b2059cc9-7d96-43c5-aad6-c54f34733dd0.jpeg)


Por outro lado e de forma **impressionante**, o Facebook se virou e pegou tudo sozinho, incluindo a imagem (mas n√£o √© interessante contarmos com essa sorte üòÇ )

<img width="506" alt="image" src="https://user-images.githubusercontent.com/4248081/169298711-c9811a9a-5065-4701-a71e-b02066d2361a.png">


## Execu√ß√£o

Tudo isso est√° acontecendo no componente [BaseLayout](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/BaseLayout/index.js) que √© a base para o [DefaultLayout](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/DefaultLayout/index.js) e a execu√ß√£o deveria ter duas partes tamb√©m:

### Remover o recebimento do `content` no `BaseLayout`

At√© adicionei uma linha de TODO:
https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/interface/components/BaseLayout/index.js#L3

N√£o se √© certo o BaseLayout saber o que √© um `content`, ele deveria apenas se preocupar puramente com `metadata`.

Talvez a responsabilidade de massagear os dados √© do [DefaultLayout](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/DefaultLayout/index.js) e ele deveria passar para o `BaseLayout` os metadados como `title` e `description` atrav√©s do que receber como `content` ou o pr√≥prio `metadata`.

### Adicionar tags para SEO e Redes Sociais

Sou zero especialista nisso, mas j√° tive algumas experi√™ncias no passado implementando as tags do Open Graph, n√£o sei como est√° agora. Pesquisei aqui no Google e encontrei isso:

https://rockcontent.com/br/blog/meta-tags-para-redes-sociais/

Deixando o conte√∫do por um momento de lado, observa todos os comportamentos da p√°gina, todas as t√©cnicas do que chamo de "internet ruim" numa √∫nica p√°gina (modal que esconde a p√°gina inteira, pedido para habilitar cookies, pedindo para habilitar notifica√ß√µes, pedindo para se inscrever na newsletter), chega a ser impressionante e √© exatamente isso que precisamos evitar no TabNews, tanto que droppei essa p√°gina e procurei outra fonte:

https://css-tricks.com/essential-meta-tags-social-media/

Muito melhor, mas n√£o sei avaliar o qu√£o est√° atualizado. Mas lembro que no passado, o OG cobria muita coisa j√° ü§ù

>> Coment√°rio de gabrnunes:
Ei @filipedeschamps, eu posso pegar essa issue? Desculpa sou novo aqui, mas devo colocar o Assigment pra mim? 

Sobre as metatags, geralmente eu uso o https://metatags.io/, que √© um site simples e que j√° gera o padr√£o de metatags pros sites.

Sobre as imagens, o que acha de fazer um gerador de imagem estilo o que o GitHub tem? Eu j√° implementei algo assim usando Next.js e Puppeteer, √© tranquilo de fazer.

>> Coment√°rio de filipedeschamps:
@gabrnunes sensacional meu caro!!! üòç 

Eu recomendo ningu√©m pegar uma issue para si, pois isso abre margem para outras pessoas participarem e trazerem uma abordagem diferente (j√° aconteceu e ainda acontece de misturarmos PRs). Ent√£o independente disso, voc√™ ser√° **muito bem vindo** nessa tarefa, ainda mais por ter levantado a bola de como o GitHub resolve o problema de n√£o ter imagens e √© a forma mais elegante que j√° vi at√© hoje de criar uma thumbnail.

E da√≠ no nosso caso, podemos usar [SSR com stale-while-revalidate](https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props#caching-with-server-side-rendering-ssr), ia ficar muito massa!!

E se quiser dividir em dois PRs, primeiro as tags e depois da imagem, show tamb√©m, quanto antes nos indexarmos com as tags certas, melhor ü§ù

>> Coment√°rio de gabrnunes:
Oi @filipedeschamps, eu s√≥ n√£o entendi uma coisa... pq vc acha que deveria usar o `stale-while-revalidate`? Seria pra atualizar a imagem caso necess√°rio? Caso algu√©m edite o titulo do post, isso?

>> Coment√°rio de filipedeschamps:
√ìtima pergunta @gabrnunes, n√£o fui claro na minha resposta. Ao usarmos o SSR, toda vez que o endpoint da imagem for acessado, ser√° necess√°rio fazer uma requisi√ß√£o no backend (que muitas vezes pode retornar sempre os mesmos dados, caso nada mude). Ent√£o para evitar esse custo e demora, o `stale-while-revalidate` se encaixa perfeitamente, pois uma vez renderizada a imagem, ela fica cacheada na CDN e qualquer nova request √© respondida instant√¢neamente. E ap√≥s passar o valor que definirmos para o cache, a request continua sendo respondida instantaneamente, mas em paralelo o backend corre para atualizar o retorno (e da√≠ isso vai cobrir os casos das informa√ß√µes mudarem como voc√™ comentou).

Ent√£o temos a flexibilidade dos dados mudarem, sem o custo de renderizar isso a cada request üëç

>> Coment√°rio de gabrnunes:
Boa, fechou :)

>> Coment√°rio de filipedeschamps:
@gabrnunes olha que massinha isso que aconteceu sobre o SEO do TabNews: https://www.tabnews.com.br/rodrigo/fcdc51a9-60c4-43d6-b698-967f3009574a

>> Coment√°rio de gabrnunes:
Massa demais @filipedeschamps, respondi l√°! Ainda n√£o consegui mexer nessa issue, mas pretendo abrir alguma PR ainda essa semana, hehe.
</issue_337_Tags para SEO e Redes Sociais>

<issue_338_Rate limiting: identificar e deletar comportamentos abusivos>
## Contexto

Hoje o TabNews n√£o possui nenhuma prote√ß√£o contra DoS ou DDoS, tanto em ataques contra a infraestrutura, quanto ataques de conte√∫do. Eventualmente precisaremos colocar um Cloudflare na frente, mas eu n√£o sei se ele vai identificar um ataque de conte√∫do, por exemplo algu√©m fazer um script que crie 1 conte√∫do a cada minuto, durante 60 minutos. Se ele identificar, algu√©m me avisa para eu configurar, se n√£o, vamos executar no modo manual.

## Execu√ß√£o

Acredito que nessa hora todo mundo ir√° recomendar usar alguma outra tecnologia de cache, como o Redis, mas vamos explorar qual o m√°ximo que conseguimos da inst√¢ncia m√≠nima de Postgres da AWS. Ent√£o a ideia √© em cada Controller do site colocar um middleware (assim como fazemos para injetar o [id da request](https://github.com/filipedeschamps/tabnews.com.br/blob/850e4317528a4786d1e999a7792fc6a561900cf6/pages/api/v1/contents/index.public.js#L14)) que ter√° a responsabilidade por tomar nota do evento (o `ip` que est√° fazendo a requisi√ß√£o, o `id` do usu√°rio, qual tipo de requisi√ß√£o, ou outras informa√ß√µes que quisermos) e ele mesmo ir√° verificar os dados e decidir continuar com a request ou n√£o.

Ent√£o com esses dados poder√≠amos criar regras como (s√≥ exemplo mesmo):
1. Um `ip` n√£o pode criar mais do que uma conta por dia.
2. Um `ip` n√£o pode criar mais do que 10 `root` contents por hora.
3. Um `ip` n√£o pode criar mais do que 30 `child` contents por hora.
4. Um `ip` n√£o pode fazer mais do que 500 requests por hora.

E com essas regras, poder√≠amos criar consequ√™ncias e side-effects, por exemplo:

1. Se o `ip` tentou criar mais do que 10 `root` contents dentro de uma hora, automaticamente o `user` relacionado tem suas features removidas, e todos esses conte√∫dos (ou todos os conte√∫dos da conta), s√£o alterados para `draft` (ou se a gente tiver certeza que √© um ataque, colocar tudo para `deleted`) e fazer a request retornar uma mensagem para entrar em contato com o suporte.

>> Coment√°rio de rodrigoKulb:
√ìtima ideia de criar regras por IP, s√≥ precisamos tomar cuidado que quando falando de IP estamos falando do IP de sa√≠da da internet. 

Existem empresas por exemplo com v√°rios funcion√°rios utilizando o mesmo IP de sa√≠da, Mas acredito que seria s√≥ ajustar o item:
 01 - Um ip n√£o pode criar mais do que uma conta por dia.
 
 Podemos criar uma tabela "castigo" assim que um IP quebrar as regras colocamos um castigo por um per√≠odo.

>> Coment√°rio de tembra:
> Mas acredito que seria s√≥ ajustar o item:
> 01 - Um ip n√£o pode criar mais do que uma conta por dia.

Pensei exatamente isso @rodrigoKulb !

Aqui em casa por exemplo somos dois que s√£o cadastrados no TabNews. Nesse cen√°rio s√≥ ia poder fazer um cadastro por dia hehe.

Acredito que a regra de 1 conta por IP por dia √© algo muito rigoroso. Esse limite poderia at√© existir, mas deveria ser algo pra +10 por conta de empresas.

> Podemos criar uma tabela "castigo" assim que um IP quebrar as regras colocamos um castigo por um per√≠odo.

O ideal √© realmente n√£o termos um controle de cria√ß√£o de conta por IP e sim essa _blacklist tempor√°ria_ (ou at√© permanente?) em caso do n√£o cumprimento das demais regras. Assim um IP na blacklist n√£o conseguiria criar contas.

>> Coment√°rio de filipedeschamps:
> Aqui em casa por exemplo somos dois que s√£o cadastrados no TabNews.

Por algum motivo, isso me deu um **calor no cora√ß√£o** üòç 

E total, as regras precisam atrapalhar o m√°ximo que puder s√≥ quem estiver abusando.

Outra regra interessante a se criar √© de tentativas de login. Nesse caso a gente deveria ser abusado e responder uma resposta que imite uma resposta real para o script do atacante n√£o saber que caiu na regra.

>> Coment√°rio de rodrigoKulb:
Em outra Issue falei sobre o recaptcha, n√£o considera uma op√ß√£o? Exemplo errou o login j√° aparece na 2 tentativa.

O Google reCAPTCHA √© um servi√ßo gratuito para contas que realizam at√© 1 milh√£o de avalia√ß√µes por m√™s em qualquer de suas vers√µes. Entretanto, as contas que geram avalia√ß√µes al√©m de 1 milh√£o devem pagar taxas. Para at√© 10 milh√µes de avalia√ß√µes por m√™s, o pre√ßo da taxa √© de US$1 a cada mil avalia√ß√µes.

>> Coment√°rio de filipedeschamps:
> Em outra Issue falei sobre o recaptcha, n√£o considera uma op√ß√£o? Exemplo errou o login j√° aparece na 2 tentativa.

Acho uma solu√ß√£o totalmente v√°lida ü§ù  talvez at√© j√° de largada no cadastro.

>> Coment√°rio de filipedeschamps:
Implementado pelo PR #444 ü§ù
</issue_338_Rate limiting: identificar e deletar comportamentos abusivos>

<issue_339_Pagina√ß√£o dos Dados: `/api/v1/contents`>
## Contexto

Hoje nenhum endpoint de lista possui pagina√ß√£o e est√£o retornando todos os dados, acho que os dois que temos hoje:

https://www.tabnews.com.br/api/v1/users
https://www.tabnews.com.br/api/v1/contents

Mas sugiro trabalharmos nessa Milestone apenas no endpoint de `contents`, pois √© a √∫nica que usamos no site para valer hoje. E o que aprendermos dessa experi√™ncia, repassamos mais para frente para o `users`.

## Execu√ß√£o

- [x] #341
- [x] #343
</issue_339_Pagina√ß√£o dos Dados: `/api/v1/contents`>

<issue_341_`pagination(api)`: endpoint `/api/v1/contents`>
## Contexto

Hoje o endpoint de conte√∫dos est√° retornando todas as linhas, e isso √© insustent√°vel:

https://www.tabnews.com.br/api/v1/contents

## Execu√ß√£o

Passar por `query string` par√¢metros de pagina√ß√£o e aqui eu acredito que existam v√°rias abordagens, por exemplo:

1. Enviar o n√∫mero de itens e o n√∫mero da p√°gina (offset), essa √© a forma mais comum, mas se um item for adicionado entre a navega√ß√£o de uma p√°gina para outra, o √∫timo item da p√°gina anterior vai pular para a p√°gina seguinte (n√£o √© um grande problema).
2. Enviar o n√∫mero de itens e o `id` do pr√≥ximo item a ser consultado, isso significa que no cabe√ßalho de resposta voc√™ precisa montar a url da pr√≥xima p√°gina, e voc√™ tem a garantia que ir√° dar "lock" para a p√°gina seguinte (acho complicado demais).

No passado usei a API do GitHub e achei que a pagina√ß√£o deles se encaixou no meio termo e foi muito bom de usar. Ela usa o n√∫mero da p√°gina e monta para voc√™ a URL da p√°gina seguinte (o que √© excelente), d√° a √∫ltima p√°gina (e com isso voc√™ consegue saber quantas p√°ginas intermedi√°rias existem) e passa isso tudo por cabe√ßalho.

Documenta√ß√£o: https://docs.github.com/en/rest/guides/traversing-with-pagination

Para simplificar a implementa√ß√£o inicial, sugiro implementarmos s√≥ com o link para a pr√≥xima p√°gina.

>> Coment√°rio de filipedeschamps:
Para dar um contexto da import√¢ncia dessa issue, olha a evolu√ß√£o da m√©dia de resposta do endpoint `/api/v1/contents` que come√ßou com `700ms` e j√° est√° quase chegando em `2000ms`

<img width="1721" alt="image" src="https://user-images.githubusercontent.com/4248081/169676480-d1f02711-30cb-4560-b8f9-9f90b092a279.png">

>> Coment√°rio de escote:
Como ficaria essa consulta no banco? Pois quando voc√™ usa o id como refer√™ncia ( e assim pode ser usado o √∫ltimo id da resposta anterior), o banco de dados utiliza os √≠ndices para saber por onde come√ßar, processando um n√∫mero menor de linhas. J√° o limit com offset exige que o banco execute a consulta dos elementos do offset que n√£o ser√£o retornados, gerando processamento desnecess√°rio quando se consulta p√°ginas n√£o iniciais.

>> Coment√°rio de tembra:
**Trabalhar com pagina√ß√£o sempre ter√° trade-offs.** A exemplifica√ß√£o do @escote √© perfeita e bem resumida.

Quanto a estrat√©gia de pagina√ß√£o espec√≠fica, eu encontrei este excelente artigo:
- [Five ways to paginate in Postgres, from the basic to the exotic](https://www.citusdata.com/blog/2016/03/30/five-ways-to-paginate/) - Written by Joel Nelson

O artigo explica os trade-offs de cada situa√ß√£o, incluindo da `Offset-Limit` e da `Keyset`, as alternativas 1 e 2 sugeridas pelo @filipedeschamps, respectivamente. O artigo tamb√©m sugere implementa√ß√µes espec√≠ficas que podem ser utilizadas no Postgres.

---

Para o nosso projeto eu escolheria a estrat√©gia `Keyset` pelo simplesmente fato da principal funcionalidade do TabNews ser o conte√∫do e o fato de eles estarem dinamicamente mudando o tempo todo. O problema dela √© n√£o saber exatamente em qual p√°gina estamos, n√£o podendo acessar uma p√°gina diretamente e tamb√©m n√£o saber a quantidade de p√°ginas que faltam para terminar a listagem.

Esses problemas s√£o "resolvidos" se utilizarmos a estrat√©gia de bookmarks espec√≠fica do Postgres e proposta no artigo acima citado. Mas eu n√£o vejo necessidade de usar essa estrat√©gia.

Dessa forma a nossa pagina√ß√£o funcionaria como um `infinite scroll` onde a API devolveria sempre os links da p√°gina anterior e da pr√≥xima. Acredito que isso faz sentido inclusive para uma funcionalidade de carregamento din√¢mico de respostas √† um conte√∫do.

Para n√£o externar de forma f√°cil o `Keyset` utilizado e a dire√ß√£o da pagina√ß√£o, podemos utilizar a mesma estrat√©gia chamada de `Cursor Pagination` (n√£o confundir com cursores de banco de dados) implementada pelo framework PHP Laravel:

> The cursor is an encoded string containing the location that the next paginated query should start paginating and the direction that it should paginate
>
> Fonte: [Laravel Documentation](https://laravel.com/docs/9.x/pagination#cursor-pagination)

---

> o √∫timo item da p√°gina anterior vai pular para a p√°gina seguinte (n√£o √© um grande problema)

Al√©m do problema de performance que enfrentar√≠amos no futuro, eu n√£o escolheria o `Offset-Limit` justamente por isso. Pois ter√≠amos um problema de UX uma vez que usu√°rio vai reler um t√≠tulo/post que ele j√° leu antes.

Ao mesmo tempo, dependendo da listagem e, digamos que continuemos ordenando os conte√∫dos por inclus√£o, isso a princ√≠pio √© "ok" para o momento atual do TabNews. Mas quando o projeto estiver com bastante acessos e listarmos de 20 em 20 conte√∫dos, por exemplo, pode ser que no momento da troca de p√°gina 5 conte√∫dos novos entrem, afinal teremos muita gente lendo/criando conte√∫dos. Isso far√° o problema se agravar de 1 para 5 repetidos, comprometendo 25% do resultado daquela p√°gina.

---

> Passar por `query string` par√¢metros de pagina√ß√£o

Eu particularmente n√£o gosto de usar `query string` pois acredito que dificulta a leitura e "suja" a URL. Claro, isso √© apenas um gosto pessoal. Na verdade a maioria dos sistemas, frameworks e plataformas acabam utilizando `query string` para pagina√ß√£o. Mas eu votaria para fazer tudo usando `path`.

A minha sugest√£o seria algo como:
  - https://www.tabnews.com.br/api/v1/contents/[key]/[value]
  - https://www.tabnews.com.br/api/v1/contents/[username]/[key]/[value]
  - https://www.tabnews.com.br/api/v1/contents/[username]/[slug]/children/[key]/[value]

Onde `[key]` √© a palavra `cursor` ou `page` e `[value]` √© uma string encriptada ou o n√∫mero da p√°gina, de acordo com a estrat√©gia utilizada.

Entretanto essa abordagem tem a seguinte desvantagem:
- N√£o podemos permitir `username` ou `slug` com o conte√∫do `page` ou `cursor`, de acordo com a estrat√©gia utilizada.

---

Finalmente acredito que precisamos primeiro definir essas informa√ß√µes b√°sicas para ent√£o partirmos para um PR.

>> Coment√°rio de filipedeschamps:
Eu tamb√©m sou do time que prefere muito mais os dados no `path` do que na `query string`, mas acho que para esse caso, o `path` √© uma abstra√ß√£o que vai mais no limitar do que nos ajudar, uma vez que `search` √© algo que rapidamente pode ficar algo maluco, por exemplo: `page`, `per_page`, `offset`, `order`, `status`, [LHS Brackets](https://www.moesif.com/blog/technical/api-design/REST-API-Design-Filtering-Sorting-and-Pagination/#lhs-brackets) para ranges, e por a√≠ vai. O que acham?

>> Coment√°rio de tembra:
Realmente. N√£o havia pensado em todos esses par√¢metros. Ficar√° completamente invi√°vel controlar todos eles atrav√©s do path.

E quanto a estrat√©gia?

>> Coment√°rio de filipedeschamps:
O que n√£o exclui de travarmos a URL das p√°ginas (e n√£o da API) para o que queremos, mais simples e mais amig√°vel aos crawlers.

>> Coment√°rio de filipedeschamps:
Turma, estudei aqui sobre pagina√ß√£o e considerando os nossos requisitos reais de curto e m√©dio prazo, vamos de `LIMIT` e `OFFSET` ü§ù vou come√ßar essa implementa√ß√£o porque o endpoint `/api/v1/contents` ta naturalmente ficando cada vez mais devagar e isso est√° impactando bastante o tempo de intera√ß√£o da Home üëç

>> Coment√°rio de filipedeschamps:
Curiosidade: resultado da pagina√ß√£o no endpoint `/api/v1/contents`

<img width="949" alt="image" src="https://user-images.githubusercontent.com/4248081/170896458-942378b0-c608-4f10-b074-66b78de675f5.png">
</issue_341_`pagination(api)`: endpoint `/api/v1/contents`>

<issue_343_`pagination(page)`: ContentList>
## Contexto

Hoje as p√°ginas com listas e que utilizam o componente [ContentList](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/ContentList/index.js) naturalmente ir√£o renderizar todos itens que a API retorna. Por√©m hoje a API n√£o est√° paginda, mas vai estar com a resolu√ß√£o da issue #341.

## Execu√ß√£o

N√£o sei ao certo como que a issue no backend vai ser resolvida, mas se a sugest√£o de fazer como o GitHub faz que √© passar por cabe√ßalho o link para a pr√≥xima p√°gina, podemos usar essa informa√ß√£o para escolher ou n√£o mostrar um bot√£o para navegar para a pr√≥xima p√°gina.

A quest√£o √© que existir√° uma diferen√ßa entre o que √© a "pr√≥xima p√°gina" na vis√£o da **API** e na vis√£o da **P√°gina**. Digo isso, pois o endpoint da API poder√° ser algo como:

https://www.tabnews.com.br/api/v1/contents?page=2

Enquanto a URL da p√°gina (que o usu√°rio vai estar vendo no navegador), dever√° ser algo como:

https://www.tabnews.com.br/?page=2
https://www.tabnews.com.br/filipedeschamps?page=2

O que a gente pode fazer, √© pegar somente o que √© querystring do que estiver nesse cabe√ßalho, e adicionar isso na URL atual que a pessoa est√° acessando.

## Depend√™ncia

- #341

>> Coment√°rio de filipedeschamps:
Aparentemente, na atual vers√£o do Next.js n√£o √© poss√≠vel utilizar p√°ginas est√°ticas e enviar par√¢metros customizados por query string, por exemplo:

https://www.tabnews.com.br/?page=2
https://www.tabnews.com.br/filipedeschamps?page=2

A esperan√ßa era que para cada query string fosse gerado uma nova p√°gina est√°tica.

O que imagino que d√° para fazer √© reservar a palavra `pagina` e usar assim:

https://www.tabnews.com.br/pagina/2
https://www.tabnews.com.br/filipedeschamps/pagina/2

>> Coment√°rio de aprendendofelipe:
Faaaalaa pai do Oliver! Chegou a pensar em deixar a p√°gina inicial est√°tica com [On-Demand Revalidation (Beta)](https://vercel.com/docs/concepts/next.js/incremental-static-regeneration#on-demand-revalidation-(beta)) fornecendo apenas as primeiras postagens e puxar todo o restante conforme vai rolando em lista infinita? O cache da API pode economizar os acessos ao banco da mesma forma que as p√°ginas est√°ticas.

>> Coment√°rio de aprendendofelipe:
Com [On-Demand Revalidation (Beta)](https://vercel.com/docs/concepts/next.js/incremental-static-regeneration#on-demand-revalidation-(beta)) poderia revalidar a p√°gina inicial sempre que um novo conte√∫do for postado ao inv√©s de revalidar a cada segundo.

>> Coment√°rio de aprendendofelipe:
[Nesse v√≠deo](https://www.youtube.com/watch?v=lrot_otx2tA) o @omariosouto d√° uma ideia de como poderia ser feito o scroll infinito puxando os dados da API.

>> Coment√°rio de omariosouto:
Acho que o lance de separar com /p√°gina/numero seria o ideal :)

>> Coment√°rio de filipedeschamps:
Show @aprendendofelipe e @omariosouto olha [essa resposta](https://github.com/filipedeschamps/tabnews.com.br/pull/398#issuecomment-1140134049)
</issue_343_`pagination(page)`: ContentList>

<issue_345_Milestone 4 - TabCoins>
Turma, chegou a hora de tornar a **Milestone 4** realidade, a que implementa as **TabCoins** üí™ e que devemos fazer nessa pr√≥xima sexta-feira uma **[Live de Inaugura√ß√£o da Milestone](https://youtu.be/S4dMc-KM96w)** como sempre fazemos.

Mas apesar do objeto central dessa Milestone ser as TabCoins, estou recebendo por v√°rios locais outras sugest√µes e features sat√©lites, sendo que umas s√£o **emergenciais**. Ent√£o tentei centralizar o que eu acredito caber para uma pr√≥xima Milestone e dividi as sugest√µes em 4 tipos:

1. Objeto principal da Milestone
2. Features cr√≠ticas
3. Melhorias
4. Itens de seguran√ßa

## 1. Objeto principal da Milestone

1. #352

## 2. Features cr√≠ticas

Isso s√£o as features que deveriam ser feitas **urgentemente**, inclusive at√© antes do objeto principal da Milestone:

1. #323
2. #321
3. #339
4. #347
5. #351

## 3. Melhorias

1. #335
2. #332
3. #337
4. #336
5. #322 
6. #346


## 4. Itens de seguran√ßa

1. #338

---

## N√£o vai caber nessa Milestone (mas que podem ser executadas):

1. Upload de imagens: #308 
2. Valida√ß√£o de email+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o: #186
3. Problema: "Entrada do tipo de senha com auto-preenchimento habilitado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
4. Problema: "Referrer Policy Inseguro" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
5. Problema: "Pr√°ticas recomendadas de HTTP Strict Transport Security (HSTS)" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
6. Problema: "Content Security Policy (CSP) n√£o implementado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
8. Problema: "P√°ginas sens√≠veis que podem ser armazenadas em cache" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
9. Problema: "Header Clickjacking: X-Frame-Options" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
10. #384


---

Acho que isso cria uma Milestone de peso e que vai levar a experi√™ncia do TabNews para um n√≠vel simplesmente sensacional. Eu sinto que a plataforma j√° est√° muito gostosa de usar e interagir, principalmente pela postura das pessoas l√° dentro, e com essa Milestone, tudo isso vai ser maximizado ü§ù

E qualquer coisa extra que for executada da Milestone (que for feito o merge na branch `main`), vamos incluir ela na Milestone em curso para darmos os devidos cr√©ditos ü§ù

E se eu esqueci de algo, por favor me avisem. Naturalmente n√£o d√° para incluir tudo numa √∫nica Milestone, mas vamos abrir pr√≥ximas Milestones at√© sentirmos seguros em colocar o projeto no est√°gio de **Lan√ßamento P√∫blico** ü§ù

---

In√≠cio oficial da Milestone: 20 de Maio

>> Coment√°rio de filipedeschamps:
Issues finalizadas üéâ
</issue_345_Milestone 4 - TabCoins>

<issue_346_Fazer as migrations serem tolerantes a demoras do Docker e Postgres>
## Contexto e Execu√ß√£o

- #342
</issue_346_Fazer as migrations serem tolerantes a demoras do Docker e Postgres>

<issue_347_Feature para remover e editar conte√∫dos de outras pessoas>
## Contexto

Hoje, se √© necess√°rio remover algum conte√∫do do site, preciso **marretar** o banco de dados. Isso √© muito inseguro, arriscado e n√£o escala. Precisamos de uma feature que possa ser adicionada num usu√°rio que d√° a permiss√£o de alterar o conte√∫do de outro usu√°rio.

## Execu√ß√£o

- [x] #348
- [x] #349
- [x] #350

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #431 ü§ù
</issue_347_Feature para remover e editar conte√∫dos de outras pessoas>

<issue_348_`content(api)`: criar novo status `deleted`>
## Contexto

Para fazer um "soft delete" de um `content`, vamos criar um novo status `deleted` e um novo campo `deleted_at`.

## Execu√ß√£o

Hoje a tabela `contents` possui uma constraint entre `owner_id` e `slug` para que um usu√°rio n√£o possa criar posts com um mesmo identificador.

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/infra/migrations/1649621949432_create-content-table.js#L70

O problema de manter essa constraint, √© que acaba n√£o se tornando mais poss√≠vel deletar `contents` que acabem tendo o mesmo slug. Por exemplo:

1. Eu crio um post `/filipedeschamps/teste`
2. Em seguida me arrependo e deleto ele (soft delete, pois continua existindo na base).
3. Ao tentar criar um outro post `/filipedeschamps/teste`, o backend vai reclamar, pois j√° existe essa combina√ß√£o, mas uma delas (a primeira) est√° com o status `deleted`.

E se adicionar o `status` nessa constraint, n√£o adianta tamb√©m, pois da√≠ eu n√£o vou poder soft delete dois conte√∫dos com o mesmo indicador.

Ent√£o em conversas passadas com o @rodrigoKulb , ele fez uma sugest√£o de criar uma propriedade `deleted_at` e adicionar ela na constraint. Achei genial.

---

Fora isso, uma vez um `content` ganhando o `status` de `deleted`, n√£o √© mais poss√≠vel voltar atr√°s.

>> Coment√°rio de tembra:
Voc√™ acredita ter necessidade de criar um novo status `deleted`?

Assim ficaria organizado e ter√≠amos acesso direto para consulta, mas o `deleted_at` resolve todos os problemas.

Isso nos ajudaria a manter o √∫ltimo status do conte√∫do antes dele ter sido deletado e poder√≠amos contar com uma das maravilhas de se usar soft delete: an√°lise de dados.

Com o tempo poder√≠amos saber se a maioria dos conte√∫dos s√£o deletadas enquanto ainda est√£o com o status `draft`, pois as pessoas est√£o desistindo de postar algo. Ou ent√£o, se as pessoas se arrependeram de postar e est√£o deletadas depois que o status est√° como `published`.

Uma pergunta: ~Hoje existe a possibilidade de voltar um conte√∫do pra `draft` ap√≥s ele estar como `published` ?~ Se n√£o existe, ser√° adicionado no futuro?

Pergunto isso pois se n√£o tiver e n√£o formos adicionar esta possibilidade no futuro, o campo `published_at` j√° atenderia at√© o uso do `status` e na verdade nem precisaria ser utilizado, a n√£o ser que depois surgissem status como `pending-approval` para aguardar a aprova√ß√£o de algu√©m.

EDIT: Verifiquei na issue #349 que hoje o status `draft` n√£o est√° acess√≠vel.

>> Coment√°rio de filipedeschamps:
√ìtimo ponto @tembra mas na minha vis√£o fica menos sem√¢ntico, por exemplo, imagina montar uma query que agrupa todos os posts pelos seus status ou o `PATCH` que ser√° feito contra a API para mudar de um status para o outro, e tamb√©m como consultar isso pela API.

Talvez se um dia quisermos fazer essa leitura dos dados, a modelagem do banco deveria ser INSERT ONLY (o que eu acharia √≥timo), ou salvar essas a√ß√µes em outro lugar para consulta. Dado a isso, voto em manter uma modelagem mais comum e previs√≠vel, mesmo que nesse caso seja um dado redundante.

> EDIT: Verifiquei na issue #349 que hoje o status `draft` n√£o est√° acess√≠vel.

Na verdade o status `draft` est√° dispon√≠vel e funcional, por√©m hoje todos os endpoints for√ßam buscar os dados como `published`. Ent√£o n√£o h√° pela API hoje ningu√©m que listem os posts em `draft`.

>> Coment√°rio de filipedeschamps:
Sabe aquele tipo de problema que voc√™ acha que vai matar rapid√£o, mas quem te mata √© o problema? üòÇ ent√£o, quem est√° me matando √© a CONSTRAINT UNIQUE envolvendo `owner_id`, `slug` e `deleted_at`, sendo que o `deleted_at` pode ser `null` e isso faz o Postgres aceitar m√∫ltiplas linhas iguais.

Por exemplo, considerando o que est√° em Produ√ß√£o, o segundo insert daria problema porque ele possui o mesmo `owner_id` e `slug`:

```sql
INSERT INTO contents (owner_id, slug, title, body, status) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug', 'title', 'body', 'published');
INSERT INTO contents (owner_id, slug, title, body, status) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug', 'title', 'body', 'published');
```

Resultado:

```
ERROR:  duplicate key value violates unique constraint "contents_uniqueness_fkey"
DETAIL:  Key (owner_id, slug)=(88717cd5-d255-4ada-a235-e8c38bffe173, slug) already exists.
```

Isso porque temos isso de constraint:

<img width="595" alt="image" src="https://user-images.githubusercontent.com/4248081/171509174-55c56b65-f735-422f-a98c-10cf685ec3da.png">


Agora, rodando uma nova migration para considerar tamb√©m o `deleted_at`:

```js
exports.up = async (pgm) => {
  await pgm.addColumns('contents', {
    deleted_at: {
      type: 'timestamp with time zone',
      notNull: false,
    },
  });

  await pgm.dropConstraint('contents', 'contents_uniqueness_fkey');
  await pgm.addConstraint('contents', 'contents_uniqueness_fkey', 'UNIQUE (owner_id, slug, deleted_at)');
};
```

Show, atualizou a constraint:

<img width="595" alt="image" src="https://user-images.githubusercontent.com/4248081/171509397-2cfcc751-ecaa-4562-b01d-80c5b5272e14.png">

S√≥ que agora eu posso fazer m√∫ltiplos inserts, pois por padr√£o uma coluna `NULL` n√£o faz dar clash nos valores:

<img width="1268" alt="image" src="https://user-images.githubusercontent.com/4248081/171509603-297b5931-b90e-49c8-8c98-880858b0657d.png">

Que `!delicinha` n√©?

E procurando na internet, esse √© o comportamento mesmo e est√£o sugerindo uma alternativa com √≠ndices, mas puts, que bizarro demais:

* https://www.enterprisedb.com/postgres-tutorials/postgresql-unique-constraint-null-allowing-only-one-null
* https://www.dbrnd.com/2017/12/postgresql-allow-single-null-for-unique-constraint-column/
* https://stackoverflow.com/questions/8289100/create-unique-constraint-with-null-columns

E agora? Algu√©m conhece alguma alternativa mais elegante?

>> Coment√°rio de filipedeschamps:
Bom, n√£o consigo encontrar outra solu√ß√£o a n√£o ser **deletar a constraint** e substituir por um **√≠ndice**. Fiz da seguinte forma no arquivo de migra√ß√£o:

```js
  // pgm.createIndex(tablename, columns, options)

  await pgm.createIndex('contents', ['owner_id', 'slug', '(deleted_at IS NULL)'], {
    name: 'contents_owner_id_slug_deleted_at_unique_index',
    unique: true,
    where: 'deleted_at IS NULL',
  });
```

O que gera:

```sql
CREATE UNIQUE INDEX "contents_owner_id_slug_deleted_at_unique_index" ON "contents" ("owner_id", "slug", (deleted_at IS NULL)) WHERE deleted_at IS NULL;
```

E o comportamento de ir fazendo INSERTs em rela√ß√£o ao √≠ndice e o `deleted_at`:

```sql
INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug', 'title', 'body', 'published', NULL);

-- OK

INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug', 'title', 'body', 'published', NULL);

-- NOT OK
-- ERROR:  duplicate key value violates unique constraint "contents_owner_id_slug_deleted_at_unique_index"
-- DETAIL:  Key (owner_id, slug, (deleted_at IS NULL))=(88717cd5-d255-4ada-a235-e8c38bffe173, slug, t) already exists.

INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug-sera-deletado', 'title', 'body', 'published', NULL);

-- OK

INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug-sera-deletado', 'title', 'body', 'deleted', NULL);

-- NOT OK: ta certo, pois s√≥ mudei o `status` para `deleted` sem ter adicionado um `deleted_at`
-- ERROR:  duplicate key value violates unique constraint "contents_owner_id_slug_deleted_at_unique_index"
-- DETAIL:  Key (owner_id, slug, (deleted_at IS NULL))=(88717cd5-d255-4ada-a235-e8c38bffe173, slug-sera-deletado, t) already exists.

INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug-sera-deletado', 'title', 'body', 'deleted', NOW());

-- OK: n√£o esbarra mais por conta do `deleted_at`

INSERT INTO contents (owner_id, slug, title, body, status, deleted_at) VALUES ('88717cd5-d255-4ada-a235-e8c38bffe173', 'slug-sera-deletado', 'title', 'body', 'deleted', NOW());

-- OK: n√£o esbarra mais por conta do `deleted_at`
```

<img width="1268" alt="image" src="https://user-images.githubusercontent.com/4248081/171513983-d56d3480-32c6-468f-80ed-47b29c89b953.png">

O mesmo comportamento se garante se eu tentar sair fazendo `UPDATE`. Se ele n√£o esbarrar com o √≠ndice √∫nico, tudo ok... se esbarrar, ele devolve um erro.

>> Coment√°rio de aprendendofelipe:
Uma alternativa nada sem√¢ntica seria usar uma data espec√≠fica do passado no lugar de `null` e o artigo ser considerado deletado se `deleted_at` for diferente dessa data, por exemplo, 01/01/2000 00:... Quem a√≠ j√° trabalhava na √°rea na √©poca do bug do mil√™nio üòÖ

>> Coment√°rio de filipedeschamps:
E se eu te falar que sempre preencher uma data foi a primeira alternativa que pensei quando comecei a entender que n√£o daria para resolver usando constraint e null üòÇ ü§ùüëç

>> Coment√°rio de aprendendofelipe:
> E se eu te falar que sempre preencher uma data foi a primeira alternativa que pensei quando comecei a entender que n√£o daria para resolver usando constraint e null üòÇ ü§ùüëç

Elegante? Nada! Funciona? Perfeitamente... hahaha

>> Coment√°rio de rodrigoKulb:
@filipedeschamps aqui na empresa utilizamos 2 informa√ß√µes para registros apagados
01 - Quando  = deleted_at (data)
02 - Quem =  idUser (int)
Agora com a funcionalidade liberada para outros membros apagarem artigos de outro usu√°rios, acredito que seria muito importante essa informa√ß√£o at√© para seguran√ßa do portal.

E o campo int = 0  n√£o daria o mesmo problema certo?

>> Coment√°rio de aprendendofelipe:
@rodrigoKulb o problema seria que o mesmo usu√°rio n√£o conseguiria apagar duas vezes a postagem com o mesmo `slug` e `owner_id`

Edit para melhor clareza: Esse problema √© se a sugest√£o foi usar o `idUser` junto de `owner_id` e `slug` como `unique`.

>> Coment√°rio de filipedeschamps:
Interessant√≠ssimo @rodrigoKulb üëç no nosso caso o id do usu√°rio √© um `UUID`, ent√£o n√£o aceitaria 0, mas n√£o importa porque o √≠ndice que estamos usando para controlar o `unique` n√£o leva em considera√ß√£o esse campo. Na migration que est√° no novo PR ele s√≥ considera o `owner_id`, `slug` e `deleted_at`.

E acho √≥timo anotar esse tipo de informa√ß√£o, mas sugiro n√£o fazer nessa vers√£o (at√© porque vamos ter tudo isso registrado em logs caso a gente precise investigar). E da√≠ numa pr√≥xima intera√ß√£o fazer a anota√ß√£o de quem editou um conte√∫do (n√£o somente deletou), at√© porque esse "soft delete" √© uma "edi√ß√£o de conte√∫do" (que altera o status para `deleted`). Da√≠ devemos anotar todas as atualiza√ß√µes de um conte√∫do, inclusive para conseguir mostrar um hist√≥rico como o GitHub faz.

>> Coment√°rio de rodrigoKulb:
> Edit para melhor clareza: Esse problema √© se a sugest√£o foi usar o `idUser` junto de `owner_id` e `slug` como `unique`.

@aprendendofelipe verdade! üòÖÔ∏è

> id do usu√°rio √© um UUID

@filipedeschamps  verdade üòÖÔ∏è show! Seguimos quebrando a cabe√ßa aqui!

>> Coment√°rio de rodrigoKulb:
S√≥ para jogar uma ideia aqui, se utilizarmos o campo: 
deleted_at (int) com o [Unix Timestamp](https://www.unixtimestamp.com/)

Assim poderia utilizar o ZERO sem problemas = Jan 01 1970 00:00:00 GMT+0000

>> Coment√°rio de filipedeschamps:
@rodrigoKulb gosto de voc√™ por estar com a mesma raiva que eu em ter que usar um √≠ndice para controlar o `unique` üòÇ 

Mas apesar dessa ideia tecnicamente ser v√°lida, semanticamente fica estranho o `deleted_at` ser num formato e os outros campos de data como `created_at` ou `published_at` ser em outro formato.

>> Coment√°rio de tembra:
Comentando aqui somente pra registrar a normalidade de se usar unique index em soft deletes: Trabalho h√° +10 anos com grandes ERPs e todos os que possuem soft delete utilizam desta estrat√©gia. Seja com banco de dados SQL Server, Oracle ou Postgres.

Sempre √© criado um **√≠ndice √∫nico** contendo o flag do registro de dele√ß√£o.

Para entendermos melhor o porqu√™ do Postgres permitir m√∫ltiplos nulos devemos lembrar da tradu√ß√£o da palavra `constraint` que significa `restri√ß√£o`.

Tendo isto em mente entendemos que a maioria das implementa√ß√µes dos SGBDs utiliza `constraints` como forma de **referenciar** alguma coisa, como por exemplo chaves estrangeiras ou valores v√°lidos. Por outro lado sabemos que os √≠ndices s√£o utilizados explicitamente para facilitar/agilizar a busca por dados.

Dessa forma agregando agora o conceito de `unique` entendemos que um valor `NULL` n√£o impede nenhuma restri√ß√£o, por isso alguns SGBDs como o Postgres o desconsideram quando falamos de `constraints` (lembrem: restri√ß√µes). N√£o h√° o que ser restringido se o valor for `NULL` exceto se a pr√≥pria coluna n√£o o suportar √© claro (mas isso n√£o tem mais a ver com constraints). Por outro lado um √≠ndice √∫nico deve levar todas as possibilidades (incluindo o `NULL`) em considera√ß√£o, pois se trata de como os dados ser√£o **organizados**.

Ainda sim em alguns SGBDs (como no Postgres) √© preciso informar explicitamente que determinada coluna poder√° conter o valor `NULL` e, quando tiver, deve ser indexada de forma √∫nica, como feito pelo @filipedeschamps no coment√°rio acima, replicado logo abaixo:

```sql
CREATE UNIQUE INDEX "contents_owner_id_slug_deleted_at_unique_index"
ON "contents" ("owner_id", "slug", (deleted_at IS NULL))
WHERE deleted_at IS NULL;
```

>> Coment√°rio de filipedeschamps:
Explica√ß√£o **sensacional** @tembra e isso me tranquiliza bastante sobre a escolha ent√£o de criarmos o √≠ndice para controlar isso ü§ù

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #431 ü§ù

>> Coment√°rio de filipedeschamps:
Turma, olha o que est√° por vir na vers√£o 15 do Postgres üòç https://blog.rustprooflabs.com/2022/07/postgres-15-unique-improvement-with-null

>> Coment√°rio de aprendendofelipe:
> Turma, olha o que est√° por vir na vers√£o 15 do Postgres

`UNIQUE NULLS NOT DISTINCT` üòçüòçüòç
</issue_348_`content(api)`: criar novo status `deleted`>

<issue_349_`content(page)`: no modo edi√ß√£o mostrar implementar a√ß√£o de Deletar>
## Contexto

Hoje o sistema possui 2 status: `draft` e `published` e vai ter um terceiro de `deleted`. Hoje o status `draft` n√£o consegue ser aproveitado sem antes fazer outras implementa√ß√µes no backend (o autor n√£o tem como chegar nele para acessar o conte√∫do novamente). Mas tamb√©m n√£o vai ser o foco agora, pois precisamos apenas um atalho para deletar `contents`.

## Execu√ß√£o

Para deletar um `content`, basta fazer um `PATCH` contra `/api/v1/contents/[username]/[slug]` enviando `{ "status": "deleted" }`

E para simplificar a implementa√ß√£o nesse momento, o dropdown de editar o conte√∫do j√° mostra um item para Deletar:

<img width="210" alt="image" src="https://user-images.githubusercontent.com/4248081/169408645-7e213f84-e2cb-45cf-856e-3b6b34892556.png">

Ent√£o sugiro por enquanto **remover** o item de **Despublicar** e implementar esse patch no clique do **Deletar**.

√â importante pedir a confirma√ß√£o do usu√°rio para isso e que por enquanto pode ser um simples: `confirm('Voc√™ deseja realmente deletar o conte√∫do? N√£o √© poss√≠vel desfazer essa a√ß√£o.');`

E o c√≥digo desse dropdown est√° aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/pages/interface/components/Content/index.js#L75-L116

## Depend√™ncia

- #348

>> Coment√°rio de filipedeschamps:
Fechado pelo PR #431 ü§ù
</issue_349_`content(page)`: no modo edi√ß√£o mostrar implementar a√ß√£o de Deletar>

<issue_350_`user(api)`: criar nova feature `update:content:others`>
## Contexto

Feature **perigosa**, ent√£o j√° de in√≠cio eu vou destacar que precisa ser muito bem testada (garantir tudo em testes automatizados), mas o princ√≠pio √© simples: ao usu√°rio A tentar editar o `content` do o usu√°rio B, se ele possuir a feature `update:content:others`, aceitar a request, se n√£o, nega com um `403`.

## Execu√ß√£o

Primeiro vai ser necess√°rio adicionar essa feature na lista de features:

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/models/authorization.js#L23-L29

Depois, na verifica√ß√£o sobre se pode editar ou n√£o, colocar uma condicional a mais onde, se o usu√°rio possui a feature `update:content:others` ele est√° autorizado a editar.

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/models/authorization.js#L51-L57

Rabiscando aqui, eu chutaria o seguinte (c√≥digo n√£o testado):

```js
  if (feature === 'update:content' && resource) {
    if (user.id === resource.owner_id || can(user, 'update:content:others')) {
      authorized = true;
    }
  }
```

### Testes

Os testes de `PATCH` est√£o nesse arquivo:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/patch.test.js

Eles est√£o separados em 3 categorias de usu√°rios:

1. Anonymous user
2. User without "update:content" feature
3. Default user

Dentro do `Default user`, ser√° necess√°rio adicionar um teste que tenta fazer o `PATCH` no content de outro usu√°rio, para se certificar que ele receber√° um `403`.

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/patch.test.js#L114

Agora precisamos criar uma quarta categoria:

4. User with "update:content:others" feature

E adicionar essa feature em um usu√°rio privilegiado e fazer a mesma a√ß√£o de editar o conte√∫do de outro usu√°rio e da√≠ nesse caso especial, receber um `200` com o `content` atualizado.

Caso precise de inspira√ß√£o, aqui est√° um caso de um outro teste:

https://github.com/filipedeschamps/tabnews.com.br/blob/1d57c1ea7ffb11858f296b0b177f39524bcaaa36/tests/integration/api/v1/migrations/post.test.js#L61-L82

>> Coment√°rio de azevgabriel:
@filipedeschamps tem algu√©m desenvolvendo essa feature?

>> Coment√°rio de filipedeschamps:
@azevgabriel eu n√£o me recordo, mas sugiro implementar mesmo assim se quiser, pois n√£o vejo como problema PRs concorrentes, e √© at√© melhor porque cada pessoa pode abordar a situa√ß√£o de um √¢ngulo diferente e isso s√≥ complementa ü§ù

>> Coment√°rio de azevgabriel:
@filipedeschamps por enquanto t√° bem dif√≠cil de contribuir, hoje s√≥ estou apanhando para arquitetura em nextJS... Entretanto j√° estou conseguindo entender a l√≥gica das rotas e a implementa√ß√£o feita.

Pelo o que entendi a gente vai dar essa feature para alguns usu√°rios, o quais seriam os moderadores do TabNews. Essa permiss√£o daria o 'poder' de alterar os conte√∫dos que s√£o nocivos √† comunidade. Ai fiquei pensando em quem vai dar essas permiss√µes aos usu√°rios, j√° existe um usu√°rio ADM que muda as permiss√µes dos outros usu√°rios?

>> Coment√°rio de LucasManto:
@azevgabriel se voc√™ n√£o se importar, eu poderia contribuir com a implementa√ß√£o dessa issue ent√£o, enquanto voc√™ continua avan√ßando com seu entendimento sobre a aplica√ß√£o.
Tudo bem por voc√™?

>> Coment√°rio de filipedeschamps:
> j√° existe um usu√°rio ADM que muda as permiss√µes dos outros usu√°rios

√ìtima pergunta! Hoje n√£o tem, ent√£o eu marreto direto no banco de dados uma feature como essas. Mas mais para frente dever√° ter uma feature que possibilita alterar as features de outros usu√°rios ü§ù

>> Coment√°rio de filipedeschamps:
> @azevgabriel se voc√™ n√£o se importar, eu poderia contribuir com a implementa√ß√£o dessa issue ent√£o, enquanto voc√™ continua avan√ßando com seu entendimento sobre a aplica√ß√£o.
> Tudo bem por voc√™?

@LucasManto n√£o h√° necessidade de negociar implementa√ß√µes, e tamb√©m n√£o h√° problema existir PRs concorrentes ü§ù

>> Coment√°rio de azevgabriel:
> > j√° existe um usu√°rio ADM que muda as permiss√µes dos outros usu√°rios
> 
> √ìtima pergunta! Hoje n√£o tem, ent√£o eu marreto direto no banco de dados uma feature como essas. Mas mais para frente dever√° ter uma feature que possibilita alterar as features de outros usu√°rios ü§ù

@filipedeschamps Entendido!

>> Coment√°rio de azevgabriel:
> Resposta √† @LucasManto 

Minha d√∫vida foi mais nas rotas, como que eu via a rota e o m√©todo da API REST. Tipo depois de uns 30 min, explodiu minha cabe√ßa. Lembrei que o next trabalha com as rotas de acordo com o nome dados nas pastas e arquivos, estava tentando achar um arquivo routes igual em express. Por√©m acho que agora est√° mais tranquilo. Ambos podemos trabalhar nessa issue sem problemas.
</issue_350_`user(api)`: criar nova feature `update:content:others`>

<issue_351_Sistema de Auditoria e M√©tricas (vers√£o `beta`)>
## Contexto

Primeiro gostaria de referenciar a issue #237 onde √© discutido v√°rias alternativas de como fazer um sistema de registro de eventos. L√°, destacam o uso do `jsonb` para guardar um objeto de evento, que pode mudar sua estrutura de um evento para o outro. Ent√£o a id√©ia √© poder registrar qualquer tipo de "a√ß√£o" dentro do TabNews, por exemplo:

1. `userA` creditou `2 tabcoins` no `userB`.
2. `userC` foi `registrado`
3. `userC` criou um `content` com `id=xxxxx`
4. `userC` ganhou `5 tabcoins` por ter publicado o `content_id=xxxxx`

Por a√≠ vai...

E independente de como isso for executado, uma regra precisa ser respeitada: **todos esses dados estar√£o p√∫blicos eventualmente**.

## Execu√ß√£o

Destaquei a √∫ltima frase, pois precisaremos anotar o `ip` originador desse evento e isso n√£o pode ser disponibilizado de forma p√∫blica. Mas precisamos desse dado para num futuro poder tentar identificar que o `userA` e o `userB` s√£o a mesma pessoa e est√£o trocando tabcoins entre s√≠ de uma forma estranha. Isso n√£o √© a prova de balas e inclusive pode gerar falsos positivos, como o @tembra apontou em outra issue sobre na casa dele ter 2 usu√°rios aut√™nticos do TabNews. Mas, √© um dado que pode revelar um vacilo de um atacante tentando explorar algo nas tabcoins ou conectar e tornar mais moroso esconder outras movimenta√ß√µes no site.

Mas a d√∫vida √©, como fazer isso? Como guardar o `ip`, sem revelar ele? Podemos definir uma chave longa e fixa como vari√°vel de ambiente, concatenar isso ao ip e fazer um hash? Pois da√≠ podemos comparar os hashes entre as movimenta√ß√µes.

De qualquer forma, nesta primeira vers√£o, **n√£o vamos nos preocupar em disponibilizar um endpoint p√∫blico**. Vamos nos focar em ter esse mecanismo pronto para ter registrado todos os movimentos relacionados aos tabcoins (por exemplo, cria√ß√£o, cr√©dito e d√©bito).

>> Coment√°rio de ViniciusLima:
E no caso da pessoa criar 2 contas, uma pela operadora m√≥vel e outra pelo provedor local? E se ela tiver 03 linhas telef√¥nicas com plano de dados cada? Cria mais uma conta no trampo, etc...
Acredito que n√£o s√≥ o IP mas um identificador do dispositivo possa tamb√©m ser utilizado para identificar esse tipo de situa√ß√£o, tipo o `MAC` por exemplo.

No caso do @tembra at√© quando esse troca troca de `tabcoins` entre usu√°rios da mesma rede/MAC √© vi√°vel? Por que se eles usam em dispositivos diferentes, mesmo na mesma rede, n√£o h√° um problema de imediato, subtende-se que s√£o 02 `users` separados, mas se for com mesmo `IP` e `MAC` a√≠ o alerta deve ser dado.

>> Coment√°rio de filipedeschamps:
Show @ViniciusLima v√£o ter todos os casos imagino. Mas quando voc√™ diz MAC, voc√™ se refere ao MAC address, correto? √â uma informa√ß√£o show, mas mais pass√≠vel a ser burlada que o IP de sa√≠da, fora que voc√™ n√£o consegue capturar essa informa√ß√£o pelo navegador.

>> Coment√°rio de escote:
@ViniciusLima  blz? O endere√ßo MAC n√£o consegue ser capturado na API, pois ele est√° em uma camada muito baixa (camada f√≠sica). A informa√ß√£o √© modificada assim que passa pelo primeiro NAT. Entendo que o endere√ßo IP est√° longe de ser perfeito, mas √© frequentemente utilizado por diversas empresas em conjunto com o captcha conforme sugest√µes acima. S√≥ temos q lembrar do IPv6 .

>> Coment√°rio de ViniciusLima:
@filipedeschamps  e @escote, eu citei o `MAC` como exemplo e eu realmente n√£o sabia que n√£o poderia ser capturado. Pensei que poderia ter algo como funciona em mobile.

>> Coment√°rio de tembra:
@ViniciusLima Em mobile s√≥ pode ser capturado se tiver um app instalado no dispositivo e com essa permiss√£o. Seria o equivalente a ter uma aplica√ß√£o desktop (.exe no Windows, por exemplo).

No ambiente web o navegador (que de fato √© o que est√° instalado no dispositivo) n√£o repassa para o site esta informa√ß√£o. Esteja ele (o navegador) rodando em ambiente desktop ou mobile.

>> Coment√°rio de filipedeschamps:
Implementado pelo PR #444 ü§ù
</issue_351_Sistema de Auditoria e M√©tricas (vers√£o `beta`)>

<issue_352_TabCoins e TabCash>
## Contexto

Vou iniciar citando [parte desse conte√∫do](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa):

> Diferente de sites como o Reddit onde voc√™ pode comprar moedas virtuais utilizando **dinheiro externo**, o TabNews **nunca** ir√° abrir margem para compra de TabCoins e a √∫nica forma de adquirir elas √© **gerando valor concreto** atrav√©s da publica√ß√£o de not√≠cias, artigos, perguntas, tutoriais ou coment√°rios.
> 
> Voc√™ ir√° receber essas moedas tanto no ato da cria√ß√£o desses conte√∫dos, quanto ao receber moedas de outras pessoas que acreditaram que o seu conte√∫do possui **valor concreto**.
> 
> Ent√£o ao inv√©s de uma mec√¢nica de Like em que numa rede social convencional voc√™ pode **infinitamente** colocar 1 Like em cada post que quiser (pois o seu **saldo de Likes** n√£o vai acabar), no TabNews a sinaliza√ß√£o de valor **n√£o √© banalizada** e sempre **herda de algum valor concreto previamente criado**.

Ent√£o n√£o √© uma mec√¢nica dif√≠cil de se entender e pode ser resumida a: toda vez que um usu√°rio gerar valor concreto no site, ele receber√° **TabCoins**.

Mas √© agora que as coisas come√ßam a complicar:

### Pra que fazer isso? Pra que gerar TabCoins?

Esse √© um ponto muito importante, pois √© isso que vai nos afastar de **"trabalhar de gra√ßa para outras redes sociais"**, onde fazemos isso quando:

1. Criamos conte√∫dos: seja postagens novas ou coment√°rios
2. Qualificamos outros conte√∫dos: dando Likes e engajando

Ent√£o para fugir disso, vamos implementar um sistema de **Revenue Share** (Compartilhamento de Receita), muito pr√≥ximo do que voc√™ encontra nas outras plataformas como YouTube, onde uma parte fica para a plataforma e outra para o criador, mas que nesse momento vamos zerar qualquer repasse da plataforma para entender o que funciona para o criador, e depois o que sobra para a plataforma. **Tudo isso ser√° feito com muita conversa e tudo open source.**

Mas independente disso, ser√° feito **o repasse do que?** Ser√° feito o repasse do **espa√ßo dos an√∫ncios**, onde voc√™ poder√° colocar o que quiser. Citando novamente o conte√∫do l√° de cima:

> Isso √© extremamente empolgante, porque "algo" pode variar desde produtos ou servi√ßos convencionais, at√© seus projetos pessoais, como reposit√≥rios no GitHub na qual voc√™ n√£o gastaria dinheiro para divulg√°-los, mas com essa mec√¢nica voc√™ avaliaria divulgar. Ou at√© divulgar seu portf√≥lio, site pessoal, vaga de emprego, o que fizer fechar a conta para voc√™ e tornar vi√°vel e sustent√°vel a sua participa√ß√£o na plataforma.

N√£o tem muito mist√©rio, √© um espa√ßo de publicidade. Mas o mist√©rio vem agora: **como ent√£o fazer para aparecer nesses espa√ßos? Comprar eles utilizando TabCoins?** E √© a√≠ que vamos para o pr√≥ximo ponto:

### 1 ou 2 ativos no sistema?

Durante muito tempo, eu e o @gugadeschamps ficamos quebrando a cabe√ßa de como usar **um √∫nico ativo** para fazer tudo no TabNews, por exemplo, somente ter **TabCoins**. Ent√£o nesse cen√°rio, voc√™ poderia ativar o sistema de an√∫ncios que iria debitando o seu saldo de TabCoins, mas isso tem um problema grave: voc√™ **tira o incentivo** das pessoas usarem as TabCoins para **qualificar os outros conte√∫dos com valor concreto**.

Porque entre eu gastar esse ativo em an√∫ncios, ou dar esse ativo para outra pessoa ao qualificar um conte√∫do dela (e que vai poder gastar as TabCoins recebidas em an√∫ncios pra ela), a gravidade do sistema vai puxar para eu mesmo gastar nos meus an√∫ncios, e como consequ√™ncia, os conte√∫dos de valor concreto n√£o v√£o ter liquidez de TabCoins para brotar. E a√≠ o sistema travou. Ent√£o como alinhar os incentivos e destravar? √â a√≠ que entra o **TabCash** (s√≥ para deixar claro que o @gugadeschamps n√£o est√° convencido disso e ainda quer encontrar uma forma usando apenas TabCoins ü§ù).

### TabCash

Voc√™ somente consegue comprar an√∫ncios usando o **TabCash**, esse √© o "objetivo final" (caso voc√™ queira isso como objetivo). Ent√£o a quest√£o √©, **como ganhar TabCash**? E a resposta √© simples: **qualificando conte√∫dos de valor concreto com suas TabCoins**.

Isso que eu estou chamado do **Fluxo completo de contribui√ß√£o**:

1. Voc√™ gera TabCoins atrav√©s de conte√∫dos com valor concreto.
2. Depois gasta essas TabCoins qualificando outros conte√∫dos, e com isso gerando TabCash.
3. Depois gasta esses TabCash em an√∫ncios (e no futuro outras coisas, como `features`, ou qualquer outra coisa massa que conseguirmos inventar).

Ent√£o voc√™ est√° gerando um **ativo** ao ter o **esfor√ßo** de criar conte√∫dos com valor concreto, e voc√™ est√° gerando **mais um ativo** pelo **esfor√ßo** de qualificar o conte√∫do de outros usu√°rios.

E eu escolhi esses nomes, porque o est√≠mulo visual fica interessante, onde:

1. Tudo relacionado a "TabCoins" √© amarelo/laranja/ouro
2. Tudo relacionado a "TabCash" √© verde

## Execu√ß√£o

Acredito que s√≥ vale a pena escrever as issues sobre a execu√ß√£o depois de discutirmos o Contexto na Live: https://youtu.be/S4dMc-KM96w

Mas algo que precisaremos nos preocupar √© com o abuso no sistema. Porque do jeito que est√°, √© poss√≠vel criar duas contas, e se voc√™ ganhar 1 TabCoin, voc√™ pode gerar infinitos TabCash s√≥ passando de uma conta para a outra.

Fora isso, **todo mundo** que criou conte√∫do at√© ent√£o, **dever√° receber TabCoins em dobro**. Ent√£o se definirmos que o ato de criar um conte√∫do na raiz do site gera 5 TabCoins, a pessoa dever√° receber 10 TabCoins por ter sido um "early adopter".

>> Coment√°rio de ricardomaia:
> Diferente de sites como o Reddit onde voc√™ pode comprar moedas virtuais utilizando dinheiro externo, o TabNews nunca ir√° abrir margem para compra de TabCoins e a √∫nica forma de adquirir elas √© gerando valor concreto atrav√©s da publica√ß√£o de not√≠cias, artigos, perguntas, tutoriais ou coment√°rios.

Mas √† princ√≠pio nada impediria as empresas de contactarem usu√°rios diretamente oferecendo-lhes dinheiro em troca do uso de seus saldos de TabCash, numa esp√©cie de **mercado paralelo**. 

[_Parallel markets generally develop in conditions of excess demand for a commodity subject to legal restrictions on sale, or to official price ceilings, or both._](https://www.elibrary.imf.org/view/journals/001/1990/114/article-A001-en.xml) - o trecho se refere ao mercado de moedas, mas se aplica aqui tamb√©m!

No momento, a √∫nica forma que penso de restringir tal abuso seria limitar que a publicidade deve estar relacionada ao pr√≥prio usu√°rio, contudo, essa an√°lise requer fiscaliza√ß√£o e n√£o imagino um controle t√©cnico / autom√°tico eficiente para este fim.  

Nesse contexto penso que gerar TabCoins e utiliz√°-las para votar em outros conte√∫dos de valor bastaria, al√©m de estar mais alinhado com o objetivo do TabNews. Em suma, por mim, nada de TabCash por um bom tempo!

>> Coment√°rio de filipedeschamps:
@ricardomaia interessante, n√£o vejo problema a pessoa revender seus espa√ßos publicit√°rios, dado que essa conquista (de TabCash) foi constru√≠da atrav√©s de conte√∫dos com valor concreto.

>> Coment√°rio de rodrigoKulb:
@ricardomaia e @filipedeschamps algo que precisamos pensar e adicionar √© a op√ß√£o "**Denunciar**" tanto para o conte√∫do / coment√°rios e publicidades.

Vamos chegar em um ponto que n√£o teremos mais controle da informa√ß√£o que est√° sendo divulgada, outro ponto importante  √© criar um termo com um advogado para evitar problemas com poss√≠veis conte√∫dos postados.

A parte de denuncia pode gerar tamb√©m tipos de castigos para a conta utilizada.

Acredito que mesmo com toda tecnologia, vamos precisar de um apoio dos "Membros" para controlar o conte√∫do mal-intencionado, at√© mesmo com divulga√ß√£o de v√≠rus etc...

>> Coment√°rio de ricardomaia:
@filipedeschamps ... a quest√£o era evitar a situa√ß√£o que voc√™ mencionou no seu post.. "empresas n√£o v√£o poder penetrar na plataforma utilizando dinheiro externo."

> Se uma empresa quiser ter um espa√ßo dentro do TabNews, ela √© extremamente bem vinda e precisar√° participar do fluxo completo de contribui√ß√£o (que foi desenvolvido na issue citada acima)... em resumo: gerar valor concreto. 

Mas na situa√ß√£o que eu levantei a empresa pode fazer an√∫ncios apenas com dinheiro, sem gerar valor diretamente, pois o valor teria sido gerado por outro usu√°rio. Se ainda assim estiver tudo certo, ok! Foi apenas um exerc√≠cio de an√°lise de risco.

>> Coment√°rio de roberto-renovato:
@ricardomaia Pelo que eu entendi do que o Filipe falou, a empresa estaria participando do fluxo, ao "patrocinar" a produ√ß√£o de conte√∫do que possui valor concreto.

>> Coment√°rio de filipedeschamps:
> Mas na situa√ß√£o que eu levantei a empresa pode fazer an√∫ncios apenas com dinheiro, sem gerar valor diretamente, pois o valor teria sido gerado por outro usu√°rio. Se ainda assim estiver tudo certo, ok! Foi apenas um exerc√≠cio de an√°lise de risco.

Perfeito @ricardomaia e o seu exerc√≠cio est√° 100% correto! Precisamos de mais exerc√≠cios assim para descobrirmos todos os "cantos" dessa implementa√ß√£o antes que as pessoas mal intencionadas consigam ü§ù 

E refor√ßando o que falei sobre penetrar na plataforma utilizando dinheiro externo, talvez eu precise esclarecer mais esse ponto, pois gerou uma d√∫vida muito interessante.

Ent√£o minha preocupa√ß√£o com "dinheiro externo" √© a banaliza√ß√£o de recursos dentro da plataforma. Agora, se isso passou primeiro pela cria√ß√£o de valor concreto por algu√©m, que depois foi qualificado, chegando assim ao final do fluxo de contribui√ß√£o, n√£o vejo mais algo como banal. O sistema inteiro teve um upgrade de conte√∫do e curadoria antes que esse dinheiro pudesse ter "entrado no sistema". E eu coloco isso em aspas, porque esse dinheiro n√£o entra no sistema üòç  ele vai diretamente para a pessoa autora dos conte√∫dos e isso precisa ser assim para que essas contribui√ß√µes que ela est√° fazendo seja vi√°vel (fa√ßa fechar a conta para ela, no final das contas).

@ricardomaia com isso, voc√™ acha que faz sentido?

>> Coment√°rio de ricardomaia:
> @ricardomaia com isso, voc√™ acha que faz sentido?

Sim @filipedeschamps, faz todo sentido! Tudo esclarecido!

>> Coment√°rio de tiagorodriguesdev:
√â importante lembrar que tem que ter uma divis√£o entre conte√∫dos relevantes e conte√∫dos recentes, ou construir um algoritmo para mixar os conte√∫dos, sen√£o os conte√∫dos novos sempre estar√£o _below the fold_ por n√£o ter tido um _"Tab up"_ e os j√° existentes que possuem relev√¢ncia sempre estariam _above the fold_ o que pode trancar o fluxo de posts.

>> Coment√°rio de andreghisleni:
Opaaa @filipedeschamps eu estava pensando aqui a quest√£o de como utilizar s√≥ uma moeda na aplica√ß√£o, a minha ideia √© a seguinte, tu usa s√≥ uma moeda mas com algumas verifica√ß√µes:
- Caso o usu√°rio s√≥ fa√ßa publica√ß√µes o valor do anuncio vai ficando mais caro, e cada publica√ß√£o gera menos
- Caso a pessoa interaja com publica√ß√µes de outros usu√°rios o valor de cada anuncio fica mais barato e as suas publica√ß√µes v√£o gerar mais e a intera√ß√£o multiplique a moeda.

N√£o sei se deu pra entender.

>> Coment√°rio de tembra:
@filipedeschamps eu sou do time @gugadeschamps e acredito que tamb√©m pode e **deve** ser resolvido somente com um √∫nico ativo: TabCoins.

Eu penso em uma solu√ß√£o parecida com a do @andreghisleni, mas funcionaria da seguinte forma:

- Voc√™ simplesmente n√£o consegue gastar seus TabCoins com an√∫ncios se n√£o tiver gerado um **QUANTITATIVO** de valor **RECENTEMENTE** para a plataforma. E, quando conseguir, ter√° um **LIMITE** de gasto em um certo **TEMPO** de acordo com os par√¢metros anteriores.

Claro que o significado (em valores) dos termos **quantitativo**, **recentemente**, **limite** e **tempo** precisariam ser discutidos.

Exemplo:
- Voc√™ pode gastar 50 TabCoins em 7 dias, se tiver gerado 10 TabCoins em 30 dias.
  - **Quantitativo:** 10 TabCoins
  - **Recentemente:** 30 dias
    - Deve ser um valor fixo para todos os usu√°rios, assim todos seriam avaliados de forma justa pela sua contribui√ß√£o em um mesmo per√≠odo de tempo.
  - **Limite:** 50 TabCoins (quantitativo * 5)
    - Aqui o valor fixo deve ser o fator de multiplica√ß√£o (5, conforme o exemplo).
  - **Tempo:** 7 dias (recentemente / 4)
    - Aqui o valor fixo deve ser o fator de divis√£o (4, conforme o exemplo).
- Lendo da forma inversa seria algo como:
  - Precisei gerar 10 TabCoins em 30 dias para poder gastar com an√∫ncios 50 TabCoins em 7 dias.
- Sobre os valores fixos:
  - Podemos ir testando, discutindo e modificando-os at√© chegarmos a um valor fixo final que acharmos mais justo.

Assim abrangemos os seguintes pontos:

- Se voc√™ quer anunciar, ter√° que estar constantemente gerando valor para a plataforma, caso contr√°rio seus TabCoins somente poder√£o ser usados para curadoria de conte√∫do.
- Voc√™ n√£o sente que est√£o "roubando" de voc√™ cobrando caro por um an√∫ncio, enquanto outros est√£o pagando mais barato, que, ao meu ver, √© o problema da sugest√£o do @andreghisleni 
- Voc√™ n√£o sente que est√° perdendo seus TabCoins e sim que a plataforma est√° protegendo eles. Afinal, o motivo principal de eles existirem √© para fazer curadoria de conte√∫do. Os an√∫ncios s√£o apenas um retorno justo e necess√°rio para o "mundo real".

Poder√≠amos inclusive colocar no perfil p√∫blico de cada usu√°rio quantas TabCoins aquele usu√°rio j√° "minerou" e quantas ele j√° gastou com an√∫ncios a fim de entendermos o perfil dos usu√°rios que realmente s√£o geradores de conte√∫dos tendo este objetivo como √∫nico (ou principal) fim. N√£o sei se seria interessante tamb√©m fazer um ranking com essa informa√ß√µes, pois um ranking sempre leva a competi√ß√£o (o que acredito n√£o ser o objetivo aqui), mas um ranking ajuda as pessoas a consumir conte√∫do de uma mesma fonte que possivelmente j√° ter√° qualidade, pois a curadoria do **usu√°rio** j√° foi feita pela comunidade.

Quanto a venda do ativo (seja ele qual for) para empresas comprarem os espa√ßos de an√∫ncios: acho completamente v√°lido. Pois como o @filipedeschamps falou: o processo de gera√ß√£o de conte√∫do j√° ocorreu!

Entretanto todo usu√°rio gerador de TabCoins dever√° ser respons√°vel solidariamente pelos an√∫ncios veiculados, mesmo que efetuado para terceiros e mesmo que em um primeiro momento seja liberado pelo filtro da administra√ß√£o, estando o usu√°rio correndo risco de ser banido e perder todos os seus TabCoins, obviamente ap√≥s an√°lise. Essa informa√ß√£o da venda tamb√©m deveria estar no perfil p√∫blico do usu√°rio, assim como a listagem de todos os an√∫ncios j√° veiculados por ele para quem quiser consultar.

>> Coment√°rio de tembra:
Ressalto ainda que no lan√ßamento dos TabCoins precisamos proteger a plataforma com **Termos de Uso** e **Pol√≠ticas de Privacidade** rigorosos, possivelmente consultando advogados.

Digo isto devido a n√≥s mesmos estarmos chamando o TabCoins (ou TabCash) de ativo.

> Em contabilidade, ativo √© um termo b√°sico utilizado para expressar os bens, valores, cr√©ditos, direitos e assemelhados que formam o patrim√¥nio de uma pessoa singular ou coletiva e que s√£o avaliados pelos respectivos custos.
>
> Fonte: [Wikipedia](https://pt.wikipedia.org/wiki/Ativo)

Assim um usu√°rio pode se sentir lesado e entrar com algum tipo de processo (no m√≠nimo por danos morais), caso seja banido, ou, por exemplo, perca (ou deixe de ganhar) TabCoins devido a algum *bug* na plataforma.

Estamos evoluindo e indo encarar o mundo real. Todo cuidado √© pouco.

>> Coment√°rio de gabrnunes:
Eu gostei muito da ideia de usar duas formas de dinheiro, me lembram um pouco o Karma do Reddit. Existem algumas comunidades por l√° que s√≥ deixam voc√™ publicar depois de um determinado Karma... isso garante que voc√™ n√£o √© uma conta nova que surgiu do nada e t√° querendo publicar l√°.

Voc√™ ganha Karmas quando recebe `up votes` nos seus posts ou coment√°rios.

A forma que o @filipedeschamps sugeriu parece que cria essa barreira de incentivo para que as pessoas tamb√©m de√™m votos e respondam coment√°rios, por exemplo (depende muito de como ser√° definido as regras de pontua√ß√£o). Embora eu acredite tamb√©m que as pessoas ir√£o dar TabCoins e comentar em posts s√≥ pelo motivo de "ensinar o algoritmo", ou melhor, fazer um post legal ficar em primeiro no ranking.

Pq vai ter um ranking n√£o? Eu imagino que a gente deveria focar em dividir os conte√∫dos em "novos" mas a p√°gina inicial ainda ser um ranking dos mais "quentes", pra quem quer s√≥ ir ali e ver o que a comunidade elegeu como mais interessante nas √∫ltimas horas.

Dessa forma, poderiamos apenas substituir o Karma pelo TabCoins e fazer toda a din√¢mica usando uma moeda s√≥. Eu s√≥ achei a forma como o @tembra sugeriu muito complexa. Se tem que ter todo esse texto pra explicar antes de decidir, ningu√©m vai entender como funcionar√° e vai acabar n√£o vingando.

>> Coment√°rio de gabrnunes:
S√≥ pensando melhor agora, depois do √∫ltimo par√°grafo que escrevi. Ser√° que n√£o √© melhor ir pelo simples? Eu sei que a comunidade pode crescer e est√° todo mundo preocupado com os problemas... mas e se a gente acreditar em um mundo melhor? hahahah

Brincando aqui, mas acho que podemos pensar pelo lado de que as pessoas v√£o usar de uma forma legal e colocar no ar pra ver no que vai dar. Existem v√°rias comunidades na internet que funcionam de uma forma pac√≠fica e que a pr√≥pria comunidade "cuida" de tudo.

Talvez ir pelo mais simples seja uma das melhores op√ß√µes.

>> Coment√°rio de tembra:
@gabrnunes excelente ideia de listagem de conte√∫dos por ranking e por "novos".

Quanto a minha explica√ß√£o, ela √© como funcionaria o sistema "por tr√°s do panos". S√≥ precisa entender os valores exatos quem realmente quer.

Pense em um jogo online, por exemplo. Ele te d√° seu MMR e voc√™ simplesmente aceita. Muitas vezes o jogo n√£o explica como define. Voc√™ s√≥ sabe que se ganhar tem +X e se perder √© -X. Mas o n√∫mero inicial n√£o √© aberto porque geralmente se tratam de c√°lculos complexos.

Minha proposta n√£o chega nem perto da complexidade de um MMR em um jogo hehe. Se usarmos minha proposta, voc√™ s√≥ precisaria entender que somente uma parte dos seus TabCoins poder√£o ser utilizados para an√∫ncios. E pronto. Agora se voc√™ se perguntar o "por qu√™" ai sim, cabe a explica√ß√£o, que eu posso at√© ter complicado demais mesmo hehe.

A base da minha proposta √© termos um tempo m√≠nimo de contribui√ß√£o recente com conte√∫do para que ent√£o o usu√°rio possa gastar com an√∫ncio, utilizando um fator tanto para a quantidade que ser√° gasta quanto para o tempo que poder√° ser gasto.

√â basicamente a mesma do @andreghisleni s√≥ que em vez de cobrar o an√∫ncio mais caro (precisaria levar em considera√ß√£o um tempo e utilizar um fator pra isso tamb√©m!) eu simplesmente limitei o uso das TabCoins.

>> Coment√°rio de filipedeschamps:
Antes de tudo, que conversa sensacional que estamos tendo aqui ü§ù 

---

@gabrnunes correto, a p√°gina inicial vai ter um ranking, e vai ter outra p√°gina sem ranking (que √© a home atual). E pelo que eu entendi, o seu ponto cobre como formar esse ranking, mas talvez eu n√£o entendi como que vai ser distribu√≠do os espa√ßos publicit√°rios.

---

@tembra sobre uma parte ser reservada para rankear, e outra para an√∫ncios, show, isso ficou claro ü§ù  mas dado a isso eu pergunto (e levando a situa√ß√£o ao extremo): qual incentivo eu tenho de usar a parte para rankear outros posts? Qual incentivo eu tenho de subir no ranking posts "concorrentes" aos meus? E continuando no extremo, qual incentivo eu tenho para dar tabcoins para pessoas que v√£o poder usar parte delas para concorrer comigo nos an√∫ncios?

>> Coment√°rio de filipedeschamps:
> sen√£o os conte√∫dos novos sempre estar√£o _below the fold_ por n√£o ter tido um _"Tab up"_

Perfeito @tiagorodriguesdev muito bem colocado e eu imagino que seria interessante um post novo ter um "boost". Eu notei que o tiktok faz isso muito bem e acaba dando chance para muita gente ser descoberta, sem precisar ter um perfil grande.

>> Coment√°rio de yoelgama:
> * Caso o usu√°rio s√≥ fa√ßa publica√ß√µes o valor do anuncio vai ficando mais caro, e cada publica√ß√£o gera menos
> * Caso a pessoa interaja com publica√ß√µes de outros usu√°rios o valor de cada anuncio fica mais barato e as suas publica√ß√µes v√£o gerar mais e a intera√ß√£o multiplique a moeda.

A ideia que dei em live √© igual essa, @andreghisleni.
Podemos ainda, caso o escopo do an√∫ncio for controlado, garantir maior alcance para quem tem um hist√≥rico de gerar valor nas publica√ß√µes dos outros.

Tudo se baseia em saber a atividade de um usu√°rio. Informa√ß√µes como **n√≠vel de atividade** ( o qu√£o ele publica/qualifica publica√ß√µes), **tempo de atividade**  (a quanto tempo ele est√° ativo na plataforma publicando/qualificando) e **diversidade de atividade** (se ele est√° publicando conte√∫dos valorosos (medido pelo quanto as pessoas qualificam as publica√ß√µes dele) e qualificando diferentes usu√°rios ao longo do tempo (pois um per√≠odo grande dele avaliando apenas um ou dois pode indicar que ele est√° apenas gerando TabCoins nas pr√≥prias contas).

Em passos, o que pensei, junto com a ideia do @filipedeschamps sobre Minecraft, era:
* Sempre que a pessoa usar TabCoins para qualificar outra publica√ß√£o, o n√≠vel de atividade sobe e ela aumenta a taxa de ganhos de TabCoins dela;
* Quando a pessoa deixa de qualificar outras publica√ß√µes, o n√≠vel de atividade diminui e a taxa de ganhos tamb√©m;
* Por fim, os an√∫ncios tamb√©m poderiam ficar mais caros ou baratos a depender desse mesmo n√≠vel de atividade.

* (opcional) A taxa aumenta tamb√©m conforme o per√≠odo de atividade vai aumentando. Exemplo: uma semana/m√™s/ano de atividades (qualifica√ß√µes e coment√°rios) podem aumentar mais ainda essa taxa;


O ponto opcional seria interessante para controlar at√© mesmo a inje√ß√£o de novas contas de uma pessoa s√≥ para ficar gerando valor entre si, tendo em vista que n√£o poderia valer tanto a pena assim por conta do tempo e trabalho que daria manter duas contas ativas e gerando valor concreto para a comunidade. Al√©m de que, ter duas contas para gerar valor entre si significaria ter **primeiro** trabalhado muito para aumentar a taxa delas, sem contar que teria que manter esse trabalho, o que, ao meu ver, est√° sim agregando para toda a comunidade, ent√£o, se uma pessoa quer e consegue ter trabalho em dobro, tudo bem! Mas a√≠ a gera√ß√£o de TabCoins deve ser algo que de fato mostre dedica√ß√£o, algo assim:
1) ter uma conta recente e que faz apenas publica√ß√µes: gera poucas TabCoins;
2) ter uma conta h√° um tempo e que faz apenas publica√ß√µes: gera poucas TabCoins;
3) ter uma conta recente e que faz publica√ß√µes e comenta nas outras: gera TabCoins normalmente; 
4) ter uma conta h√° um tempo e que faz publica√ß√µes e comenta nas outras: gera TabCoins normalmente; 
5) ter uma conta recente, que faz publica√ß√µes, comenta e qualifica outras: gera TabCoins normalmente, mas vai aumentando conforme o tempo; 
6) ter uma conta h√° um tempo, que faz publica√ß√µes, comenta e qualifica outras: gera mais TabCoins que as anteriores e cada vez mais conforme esse tempo de atividade vai aumentando;

Sobre a perda dessa taxa conforme o n√≠vel de atividade vai baixando, poderia seguir o mesmo padr√£o: contas recentes e com pouca atividade diminui mais r√°pido do que as contas com mais tempo e com n√≠veis de atividade mais altos.

>> Coment√°rio de gabrnunes:
@filipedeschamps acho que o espa√ßo publicit√°rio poderia ser um "boost" no post, n√£o?

A gente pode fazer uma p√°gina inicial que ranqueia as publica√ß√µes de acordo com os `TabCoins` que recebe, quando algu√©m impulsiona uma publica√ß√£o, √© que se ela estivesse tirando as `TabCoins` da carteira dela e entregando como mais pontos para aquela publica√ß√£o.

Acho at√© que, dessa forma a gente nem precisa se preocupar em criar regras muito complexas como fazer o "pre√ßo" ficar mais caro (como o @yoelgama e o @andreghisleni sugeriram) ou de expira√ß√£o de TabCoins como o @tembra falou). Na verdade acho que para o ranking funcionar, tem que ter algo que o @tembra comentou, mas mais focado em h√° quanto tempo a publica√ß√£o foi feita. No [Chuvisco](https://chuvis.co) eu fiz algo assim e parece ter funcionado. Funcionaria mais ou menos assim:

## Publica√ß√µes
Para rankeamento na p√°gina inicial, as publica√ß√µes ganham likes (ou melhor, TabCoins) ou coment√°rios. O algoritmo d√° um ponto espec√≠fico para cada uma das formas de intera√ß√£oi (TabCoins = 1 ponto e coment√°rios = 2 pontos), e tamb√©m √© poss√≠vel ter um boost (que seria uma pessoa espec√≠fica gastando TabCoins para dar esse incentivo), digamos que o boost valha 3 pontos... 

Eu sugiro tamb√©m criar uma "deprecia√ß√£o" por tempo de publica√ß√£o, foi o que eu fiz no Chuvisco (inspirado no HackerNews), verificar h√° quanto tempo a publica√ß√£o foi feita e tirar pontos espec√≠ficos dela. Dessa forma a gente vai ter uma p√°gina inicial com conte√∫dos sempre frescos e que s√£o interessantes.

Os `Boosts` podem ajudar uma publica√ß√£o mais recente a ficar no topo do ranking, dessa forma a pessoa estar√° promovendo o que ela quer, sem necessariamente ser um an√∫ncio. At√© mesmo, dessa forma, todos os posts sofrem o mesmo tratamento do algoritmo, o `Boost` √© s√≥ uma forma de adicionar `Likes` em uma publica√ß√£o mais rapidamente, at√© mesmo, se uma publica√ß√£o recebeu poucos `Boosts` mas a comunidade em si curtiu ela, ela pode receber muitos outros likes e ficar na frente mais r√°pido.

## Pessoas
Eu acredito que, como o @filipedeschamps sugeriu, a gente precisa mesmo ter uma diferencia√ß√£o entre o que a pessoa d√° para outras pessoas e o que as pessoas usam pra si. Mas ainda me parece que usar dois termos e ter que explicar muita coisa fica confuso.

Como eu falei anteriormente, eu vejo os `TabCoins` semelhantes ao `Karma` que usam no HackerNews ou no Reddit.

### Como ganhar TabCoins?
Tenha reposta nos seus coment√°rio, tenha "ups" no seus coment√°rios, tenha "ups" nos seus posts, tenha coment√°rios nos seus posts. Basicamente isso. A gente pode definir pontua√ß√µes diferentes para cada tipo de inbtera√ß√£o que a pessoa receber.

### Como gastar TabCoins?
Voc√™ pode gastar as TabCoins para impulsionar publica√ß√µes. Pode ser suas pr√≥prias publica√ß√µes ou publica√ß√µes de outras pessoas... como no Reddit voc√™ consegue dar selos para as pessoas (pagos), mas aqui voc√™ pode gastar o seu `TabCoins` para ajudar projetos que curtiu muito. Semelhante a um super like hehe.

### E o que eu "dou" para as outras publica√ß√µes que eu curti mas n√£o curti muito? 
Pode ser um like, um "up", ou um voto, sei l√°. Mas dessa forma a gente simplifica a forma que as coisas funcionam sem necessariamente ter que criar uma outra moeda.

>> Coment√°rio de tembra:
@filipedeschamps 
> sobre uma parte ser reservada para rankear, e outra para an√∫ncios, show, isso ficou claro

@gabrnunes 
> expira√ß√£o de TabCoins como o @tembra falou

Acredito que n√£o ficou claro, pois na verdade n√£o ir√° ficar nada "reservado" ou "expirar". As TabCoins ser√£o todas uma s√≥. Minha ideia apenas limita a quantidade delas que voc√™ pode usar com an√∫ncios. Se n√£o usar, elas n√£o expiram. Continuam l√°. Mas s√≥ podem ser utilizadas para incentivo e n√£o mais para an√∫ncios.

@filipedeschamps 
> qual incentivo eu tenho de usar a parte para rankear outros posts? Qual incentivo eu tenho de subir no ranking posts "concorrentes" aos meus? E continuando no extremo, qual incentivo eu tenho para dar tabcoins para pessoas que v√£o poder usar parte delas para concorrer comigo nos an√∫ncios?

Perfeito! N√£o pensei no incentivo de usar para rankear outros posts! Esqueci completamente. Mas a solu√ß√£o √© a mesma.

Podemos substituir as vari√°veis relacionadas √† gera√ß√£o de conte√∫do por vari√°veis relacionadas ao gasto de TabCoins com incentivos. OU adicionar novas vari√°veis para considerarmos tanto gera√ß√£o de conte√∫do quanto gasto de TabCoins com incentivos.

**Substituindo** ficaria, por exemplo:
- Voc√™ pode gastar **com an√∫ncio** 25 TabCoins em 30 dias, se tiver gastado **com incentivos** 100 TabCoins em 15 dias.
  - **Quantitativo:** 100 TabCoins
  - **Recentemente:** 15 dias
    - Deve ser um valor fixo para todos os usu√°rios, assim todos seriam avaliados de forma justa pela sua contribui√ß√£o em um mesmo per√≠odo de tempo.
  - **Limite:** 25 TabCoins (quantitativo / 4)
    - Aqui o valor fixo deve ser o fator de divis√£o (4, conforme o exemplo).
  - **Tempo:** 30 dias (recentemente * 2)
    - Aqui o valor fixo deve ser o fator de multiplica√ß√£o (2, conforme o exemplo).
- Lendo da forma inversa seria algo como:
  - Precisei incentivar pessoas usando 100 TabCoins em 15 dias para poder comprar an√∫ncios usando 25 TabCoins em 30 dias.
- Observa√ß√µes:
  1. Perceba que diferente do exemplo l√° de cima, agora eu inverti os fatores de multiplica√ß√£o e divis√£o, pois agora envolve gastar/gastar e n√£o ganhar/gastar TabCoins.
  1. N√£o vou ganhar 25 TabCoins ao gastar 100. Se eu gastar 100 com incentivos tenho direito de gastar 25 com an√∫ncios. Se ap√≥s gastar 100 com incentivos eu ficar sem nada, n√£o vou ter nada para gastar com an√∫ncios, mesmo que tenha direito de gastar 25, pois meu saldo √© 0.
  1. Ap√≥s esses 30 dias acabarem, n√£o vou perder 25 TabCoins. Apenas n√£o vou conseguir mais gastar TabCoin nenhuma com an√∫ncios, pois meu prazo para gastar acabou. Mesmo que meu saldo de TabCoins seja 99999.

O exemplo se resolvermos **adicionar** mais uma regra ficaria meio monstruoso (mais que esses que j√° dei hehehe). Ent√£o vou me reservar no direito de n√£o faz√™-lo. Mas se realmente gostarem da ideia e considerarem utiliz√°-la, posso fazer sem problemas. √â s√≥ pedir ü§ù 

Finalmente talvez toda essa complica√ß√£o sobre como ou quanto pode-se gastar de TabCoins com an√∫ncios possa ter relacionamento com o XP do usu√°rio, que ir√° definir as a√ß√µes que ele poder√° efetuar dentro do TabNews, mais ou menos como o `Karma` do Reddit e o `Reputation` do StackOverflow.

@tiagorodriguesdev @gabrnunes 

Excelente ideia a do boost! Realmente isso deve acontecer.

>> Coment√°rio de filipedeschamps:
Turma, chegou a hora de executarmos essa tarefa üòç 

Eu reli todos os coment√°rios e uma sensa√ß√£o que me surgiu sobre s√≥ ter TabCoin ao inv√©s de dois ativos foi a mesma sobre quando est√° sendo discutido uma abstra√ß√£o que faz muitas coisas ao mesmo tempo. Se julga uma escolha boa colocar tudo numa √∫nica abstra√ß√£o ao inv√©s de criar duas similares, pois de fato no in√≠cio os sinais apontam para que tudo possa ser resolvido por essa √∫nica abstra√ß√£o e como que com isso trabalho redobrado ser√° evitado. Mas com o avan√ßo das coisas, essa abstra√ß√£o vai ficando "exponencialmente" complexa e de dif√≠cil compreens√£o, principalmente porque suas partes individuais v√£o querer evoluir para caminhos diferentes.

@tembra com isso eu percebi que **talvez** a sua proposta n√£o envolve somente 1 ativo, e na verdade envolve 2. Eles tem o nome TabCoin, somente por estarem dentro da mesma abstra√ß√£o. Digo que s√£o dois ativos, pois s√£o duas partes dentro da mesma abstra√ß√£o que precisam ser controladas de forma separada (possuem regras de neg√≥cio diferentes), s√£o contabilizadas de formas diferentes e em algum momento precisam ser mostradas de forma separada para a pessoa saber quanto existe de cada parte.

Ent√£o cada vez mais estou encarando o que precisamos fazer como se fosse modelagem de software e todos os seus efeitos colaterais no sistema (e n√£o s√≥ a modelagem em s√≠). Mas apesar disto ter clareado algumas boas coisas, isso n√£o significa que eu tenho a resposta, muito menos a resposta correta, ent√£o uma coisa ficou clara na minha cabe√ßa que √©: **n√≥s iremos errar na primeira tentativa**. Eu gostaria apenas de errar de uma forma que seja simples de entender e refatorar e que tivesse base em algo que j√° existe, pois n√£o estamos inventando nada novo.

## Game Economy

Ent√£o eu me "atrevi" a estudar sobre **game economy**, que √© basicamente tentar construir um ecossistema que rode e pare em p√©. Coloquei "atrevi" em aspas porque eu morro de medo de estrat√©gias mal√≠gnas como *"pay to win"*, mas por outro lado eu me acalmei porque, apesar de estamos criando sim um fluxo de incentivo, **tudo est√° sendo feito sob a luz do sol**, tudo est√° sendo exposto, com o c√≥digo inclusive, para que seja poss√≠vel identificarmos se n√≥s mesmo estamos abusando da situa√ß√£o. Inclusive vou apontar um exemplo ali em baixo onde poder√≠amos abusar, mas n√£o iremos.

Ent√£o pelo que eu entendi dos estudos, o primeiro passo para dar vida a um game economy √© definir o que ser√° atingido por quem est√° dentro desta economia, e para isso eu defini algo que j√° conversamos v√°rias vezes:

**Um local na internet com conte√∫dos de valor concreto para quem trabalha com programa√ß√£o ou tecnologia.**

Esse √© o "jogo" que estamos jogando. E h√° v√°rios incentivos para que isso aconte√ßa, sejam incentivos **virtuais**, por exemplo  puramente a vontade da pessoa contar com um espa√ßo assim (para poder ler coisas que v√£o ajudar ela de fato, um espa√ßo saud√°vel para poder fazer perguntas, etc), ou incentivos **concretos**, como a ideia do Revenue Share, que √© o Compartilhamento de Receita. Como j√° comentado, o TabNews n√£o tem receita, ent√£o ser√° compartilhado o Espa√ßo Publicit√°rio e as pessoas poder√£o usar esse espa√ßo para o que quiser, auferir receita, trazer liquidez para os seus projetos, o que for.

Ent√£o a√≠ n√£o tem nada de novo, mas √© agora que as coisas come√ßam a ficar interessantes, pois o pr√≥ximo passo para criar um game economy que para em p√© √© entender e definir os conceitos de **tap** e **sink**.

## Tap

Tradu√ß√£o de "tap" nesse contexto √© "torneira" e significa tudo que consegue gerar ativos dentro da economia. Por exemplo, o que consegue gerar TabCoins? Criar um post gera TabCoins? Se sim, "criar posts" √© uma **tap**. Ent√£o quando voc√™ liga essa "torneira", sai dela ativos que podem ser usados dentro dessa economia.

## Sink

Tradu√ß√£o de "sink" nesse contexto pode ser "pia", "ralo" ou at√© "fossa", e √© tudo que consome de forma permanente um ativo da economia. Por exemplo, qualificar um post consome TabCoins minhas? Se sim, "qualificar posts" √© uma **sink** (ou "conversor", como vamos ver mais para frente).

## Equil√≠brio entre Tap e Sink

Com isso, nota que uma economia n√£o pode ter somente **taps** (somente coisas que geram ativos), pois isso ir√° inundar a economia com ativos. Esses ativos precisam ou desaparecer de alguma forma, ou o ambiente sofrer infla√ß√£o (tudo ficar cada vez mais caro).

![image](https://user-images.githubusercontent.com/4248081/173657056-ad37bc8a-cea0-4798-becc-7ecf902cdb25.png)

## Ativos e Valores √Çncora

E isso tem rela√ß√£o com quais tipos de ativos voc√™ tem dentro da economia, sendo que ativos mais comuns se chamam **Soft Currency** e ativos mais raros e que habilitam recursos mais exclusivos se chamam **Hard Currency**.

Como voc√™ gera esses ativos se chama **Anchor Values** e √© a √¢ncora que **cria** a sua economia. Voc√™ precisa do que para criar os ativos? Por exemplo, no caso do jogo Clash of Clans, a √¢ncora √© o tempo que a pessoa gasta esperando uma constru√ß√£o ser conclu√≠da. No caso do TabNews, √© a cria√ß√£o conte√∫dos com valor concreto.

Dado a isso, um detalhe separa completamente a mal√≠cia do Clash of Clans do TabNews que √©: no Clash of Clans, voc√™ pode usar dinheiro real para comprar uma Hard Currency (que √© um Diamante) que ir√° acelerar as constru√ß√µes, ou seja, voc√™ tem como escapar da penaliza√ß√£o artificial do tempo que essas constru√ß√µes virtuais precisam ao usar dinheiro de verdade. No TabNews n√£o vai ter esse escape, nossa economia n√£o pode aceitar inje√ß√£o de dinheiro externo. A √¢ncora da nossa economia √© conte√∫dos com valor concreto, √© ali que ela come√ßa, mas n√£o termina a√≠, voc√™ precisa das alavancas e conversores caso queira atingir mais do que um objetivo.

## Alavancas e Conversores

![image](https://user-images.githubusercontent.com/4248081/173696997-e1e0136e-4538-4453-97c5-1f1849b5365b.png)

Olhando pelo √¢ngulo da plataforma TabNews, ela tem dois objetivos:

1. Ter nela conte√∫dos com valor concreto.
2. Ter esses conte√∫dos qualificados pelas pessoas.

O mist√©rio √© como conectar esses dois objetivos com o "fim do jogo", que √© o Revenue Share, e para isso serve as alavancas (tamb√©m conhecidas como conversores). A alavanca √© a combina√ß√£o entre uma tap e sink, onde o resultado disso pode ser voc√™ converter essa opera√ß√£o em uma outra tap ainda mais produtiva e poderosa, ou converter para outro ativo diferente e que d√° acesso a coisas diferentes.

Na proposta passada que enviei tem isso, e √© a jun√ß√£o da Cria√ß√£o com a Qualifica√ß√£o de publica√ß√µes. O fluxo inteiro acaba ficando assim:

| A√ß√£o | Resultado |
|:---|:---|
| Cria√ß√£o de Conte√∫do | `Tap` de `TabCoins` (Soft Currency) |
| Qualifica√ß√£o de Conte√∫do | `Conversor` de `TabCoins` para `TabCash` (Hard Currency) |
| Anunciar | `Sink` de `TabCash` |

E o legal √© que usando os conhecimentos de Tap e Sink, tem uma mec√¢nica que gera um **furo** no fluxo ali em cima. Lembra que comentamos que toda vez que voc√™ Qualifica um conte√∫do, essas TabCoins v√£o para a pessoa que criou esse conte√∫do? √ìtimo, pois esse √© o furo que ir√° desbalancear o Tap e Sink que comentei ali em cima. Isso porque a Qualifica√ß√£o se torna uma Tap para quem **criou** o conte√∫do que foi qualificado e o Conversor ali deixa de existir numa vis√£o da economia inteira. Ele converte sim as suas TabCoins em TabCash, mas insere de volta por igual no sistema mais TabCoins, que por consequ√™ncia ao passarem novamente pelo Conversor v√£o gerar outras TabCoins, assim infinitamente... e elas nunca saem por uma Sink (e as pessoas n√£o v√£o mais ter incentivo de ligar a Tap, que √© criar novos conte√∫dos):

![image](https://user-images.githubusercontent.com/4248081/173697130-033df254-0a02-4cd8-a81b-ac97a171d825.png)


Ent√£o uma das coisas que a gente tinha conversado em Lives no passado sobre evitar abusos, era para que a pessoa que recebe uma qualifica√ß√£o, ela n√£o recebe a TabCoin inteira, e apenas recebe uma fra√ß√£o. Assim se algu√©m criar um loop entre dois usu√°rios, o valor √© destru√≠do. Mas pensando agora, independente desse abuso, a gente **precisa** criar uma Sink para essa TabCoin que foi criada ao qualificar.

Ou ent√£o podemos fazer o seguinte: ao qualificar, n√£o gera mais nenhum Tap de TabCoin (a pessoa recebedora n√£o recebe um TabCoin que foi gerado do nada), ela recebe na verdade √© TabCash. Ent√£o quem qualifica recebe 10x TabCash, enquanto quem foi qualificado recebe 1x TabCash, por exemplo. Mas da√≠ o incentivo de qualificar n√£o √© mais integral.

## Outros detalhes de implementa√ß√£o

E a minha cabe√ßa em paralelo come√ßou a ir longe pensando em v√°rios outros detalhes de implementa√ß√£o, como quais ser√£o as regras caso uma pessoa publique um conte√∫do como `published` e atualize ele de volta para `draft` (ela perde as tabcoins?), ou um conte√∫do `deleted`, perde TabCoins? TabCash tamb√©m? E como se gasta TabCash? √â por `view` num an√∫ncio? Mas e se passar um bot de busca pelas p√°ginas e sair consumindo os an√∫ncios? Ou recebermos um ataque de views nos an√∫ncios e drenar o TabCash de todo mundo? Destaco isso, pois esse √© o maior tipo de ataque que o Adsense recebe e precisa saber lidar.

Tenho ideias para tudo isso, mas ficou claro que chegou a hora de come√ßar a sair do campo da **teoria** e ver o que a **pr√°tica** tem para nos dizer. Estou super feliz com os conhecimentos de Tap e Sink, mas preciso colocar a m√£o na massa e da√≠ vou dando os reports para voc√™s sobre o que vou descobrindo no caminho, independente do que seja, combinado?

## Fontes

As principais foram essas duas abaixo, mas tem v√°rias se procurar por "game economy":

* https://departmentofplay.net/the-principles-of-building-a-game-economy/
* https://bothgunsblazingblog.wordpress.com/2013/10/28/game-economies-and-currency-flows/

>> Coment√°rio de rodrigoKulb:
@filipedeschamps acho que o @torvalds (Linus Torvalds) vai utilizar o https://tabnews.com.br olha a frase que ele comentou sobre as redes sociais:

"O modelo de ‚Äòcurtir‚Äô e ‚Äòcompartilhar‚Äô √© apenas lixo. N√£o h√° esfor√ßo, nem **controle de qualidade**. Na verdade, √© tudo voltado para o reverso do **controle de qualidade**, com os menores denominadores comuns, clickbaits e coisas projetadas para gerar uma resposta emocional ‚Äî muitas vezes uma ofensa moral.‚Äù

Deixei a palavra **controle de qualidade** em negrito, pois talvez seja a chave para construir um sistema **blindado**. Podemos de alguma forma criar uma √°rea de auditoria, onde membros podem **ganhar** TabCoins tamb√©m auditando os TabCash utilizados.

E o poder de auditoria poderia ser liberado para os membros, por tempo de casa e uma quantidade x de publica√ß√µes. Algo do tipo.

Acredito que o caminho da auditoria √© uma boa podemos at√© levar para outra Milestone.

Outro item que estou percebendo ser muito importante √© ter **categoria** de assunto.
- Artigo
- Not√≠cia
- Dicas
- Publicidade
- Pedido de Ajuda
- Curr√≠culo
- Vaga
- Outros

Esses assuntos podem tamb√©m ser atribu√≠dos como TAG'S pelos pr√≥prios membros, n√£o precisa deixar isso na m√£o de quem publica at√© porque podem publicar uma **Publicidade** falando que √© uma **Dica**.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb plot twist: ele j√° usa diariamente üòÇ  e de fato, sinto que estamos um passo na frente do que muita gente vai tentar fazer com a internet para fazer ela um lugar um pouco melhor. Vamos desbanalizar o que as redes sociais banalizaram. E n√£o estamos sozinhos nisso aqui no Brasil, pega como exemplo o Chuvisco feito pelo @gabrnunes ou como o Hacker News √© protegido de todas as t√°ticas ruins da internet nova. N√≥s vamos construir um peda√ßo de internet boa tamb√©m, e vai ser massa ü§ù 

E sobre a auditoria do TabCash, interessante, diria at√© auditoria de todo o fluxo dos ativos, por isso da minha vontade de deixar os eventos p√∫blicos. Poder√≠amos fazer tamb√©m algo relacionado a bounties, seja opr encontrar pessoas abusando da economia, ou encontrando falhas de seguran√ßa.

Sobre as categorias e tags, show, isso deve vir mais para frente üëç

>> Coment√°rio de gabrnunes:
Massa demais! Isso √© muito do que eu acredito tamb√©m @rodrigoKulb @filipedeschamps. O Chuvisco n√£o deu certo, mas vou estar aqui pra ajudar no TabNews :)

>> Coment√°rio de filipedeschamps:
Issue fechada pelo PR #462

Estamos prontos para a Live de Encerramento da Milestone 4 üòç
</issue_352_TabCoins e TabCash>

<issue_357_Branch `main` quebrada (mas apenas no Linter de commit)>
Turma, preciso de ajuda para saber se n√£o vou fazer besteira.

O PR #331 tinha mensagens de commit que n√£o estavam passando no Linter, e at√© a√≠ tudo bem. Aceitei o PR com a op√ß√£o de `squash` pela pr√≥pria interface do Github na esperan√ßa que ele iria juntar tudo num commit v√°lido, mas n√£o.

O commit com problema √© este: https://github.com/filipedeschamps/tabnews.com.br/commit/ce7c9e4c5ec60774807ba57c8906b688409c7ac9

[Nesta outra branch](https://github.com/filipedeschamps/tabnews.com.br/pull/356) eu j√° reescrevi o hist√≥rico consertando a mensagem e passou no Linter, mas uma d√∫vida fica: o Github vai saber fazer o merge disso de volta para a `main`?

Ou eu vou precisar desabilitar a prote√ß√£o de `push force` da main, consertar o hist√≥rico, dar `push force` e pedir para todo mundo com branch ativa dar rebase?

Algu√©m tem alguma opini√£o de qual a melhor abordagem?

>> Coment√°rio de filipedeschamps:
Pera, to confuso, acho que o Github fez certo e o `squash` funcionou, porque na branch em que eu achei que consertei, n√£o consertei nada. O commit est√° l√° e o Linter n√£o est√° reclamando... mas estava antes. N√£o estou entendendo mais nada.

>> Coment√°rio de filipedeschamps:
Bom, fiz o merge e aparentemente funcionou. Deploy j√° est√° feito e a feature do localStorage j√° est√° rodando em produ√ß√£o ü§ù 

<img width="469" alt="image" src="https://user-images.githubusercontent.com/4248081/169626413-c309b95a-70c9-4de0-9d03-8b0120d560a7.png">

>> Coment√°rio de andreghisleni:
Aeeeeee boaaaaa

>> Coment√°rio de gabrielew:
Est√° normal aqui
</issue_357_Branch `main` quebrada (mas apenas no Linter de commit)>

<issue_369_Bug: Alinhamento dos n√∫meros na HOME (CSS)>
Tentei localizar o motivo porem n√£o localizei, quando o titulo ocupa somente uma linha no mobile ele fica com espa√ßo diferente.

![Captura de tela em 2022-05-23 11-32-41](https://user-images.githubusercontent.com/5334261/169843518-86f2485c-8907-4f9c-baa5-1a7819621085.png)

>> Coment√°rio de filipedeschamps:
Fala @rodrigoKulb isso foi mapeado aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/334

>> Coment√°rio de rodrigoKulb:
Opa, show! @filipedeschamps
</issue_369_Bug: Alinhamento dos n√∫meros na HOME (CSS)>

<issue_371_Comando Docker compose>
O docker compose em sua nova vers√£o (v2) est√° com o comando "embutido" no docker.

√â v√°lido fazer a atualiza√ß√£o para o projeto usar o comando `docker compose` ao inv√©s do `docker-compose`?

ref: https://github.com/docker/compose

>> Coment√°rio de filipedeschamps:
Fala @nathanosoares que show, n√£o sabia! Isso vai simplificar as coisas no futuro. E na sua avalia√ß√£o, quais s√£o os tradeoffs envolvidos nessa atualiza√ß√£o?

>> Coment√°rio de nathanosoares:
O maior tradeoff vai ser para colaboradores que possuem a vers√£o desatualizada do `docker-compose` (acho que √© grande parte de n√≥s). Isso pode causar uma confus√£o ao fazer o "primeiro setup" no ambiente de desenvolvimento.

Adicionar uma instru√ß√£o no readme para que os colaboradores tenham  o docker atuallizado pode contornar isso.

Aparentemente as flags que n√£o ser√£o implementas no novo comando n√£o afetam o projeto TabNews

Ref: https://docs.docker.com/compose/cli-command-compatibility/

>> Coment√°rio de filipedeschamps:
@nathanosoares dado que o tradeoff seja de confundir versus n√£o ter um benef√≠cio concreto, acredito que a conta n√£o feche no saldo positivo. Por conta disso vou fechar essa issue, mas pe√ßo que reabra caso essa atualiza√ß√£o traga outros benef√≠cios para o projeto que fa√ßa sentido pagar o custo deste upgrade, combinado? ü§ù
</issue_371_Comando Docker compose>

<issue_372_Lista de contribuidores>
Quando o reposit√≥rio estiver P√∫blico, sugiro utilizarmos o https://contrib.rocks para colocar o avatar de todo mundo que est√° contribuindo tanto aqui no README, quanto no https://www.tabnews.com.br/status

>> Coment√°rio de filipedeschamps:
Fechando essa issue, mas ir√° entrar no Draft da Milestone 5 de Lan√ßamento ü§ù
</issue_372_Lista de contribuidores>

<issue_375_Dark mode>
## Contexto
Hoje o TabNews n√£o possui uma op√ß√£o de escolher tema light ou dark e nem todo mundo gosta do tema light, ent√£o essa feature seria interessante para essas pessoas.

## Execu√ß√£o

A implementa√ß√£o dessa feature em tese √© bem simples, basta adicionar um bot√£o que faz a troca do tema light pro dark e vice e versa por meio do hook de tema do Primer React.

>> Coment√°rio de filipedeschamps:
Show, o tema est√° hardcoded aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/5dc6e3d0882887916a9aba8fb93a7f78549034b6/pages/_app.public.js#L18

Quando testei o tema dark, o fundo n√£o ficava escuro, √© preciso identificar o motivo (devo ter feito alguma besteira, n√£o sou um bom frontend).

E por enquanto para facilitar a implementa√ß√£o, isso pode ficar salvo no localStorage do usu√°rio e adicionar um `toogle` no dropdown no menu, por exemplo:
 
<img width="218" alt="image" src="https://user-images.githubusercontent.com/4248081/169921060-ab65a93f-66c5-4d06-9543-7b4f5c1810ff.png">

>> Coment√°rio de ermesonsampaio:
√ìtimo, agora s√≥ falta achar o que est√° fazendo com que o fundo n√£o mude.

>> Coment√°rio de ermesonsampaio:
Encontrei durante a adi√ß√£o do suporte a altern√¢ncia entre temas ao bytemd uma complica√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/Content/index.js#L34

O tema √© aplicado por meio de um import de css, por√©m n√≥s queremos que o tema seja aplicado de acordo com o valor armazenado no `localStorage`.

Ent√£o eu me pergunto se n√£o teria outra maneira de aplicar esse tema,  caso n√£o, como podemos contornar isso?

>> Coment√°rio de filipedeschamps:
@ermesonsampaio n√£o sei como funciona muito bem, mas ao inv√©s de importar o `github-markdown-light.css`, importar o `github-markdown.css`.

https://github.com/sindresorhus/github-markdown-css

> There are 3 themes provided in this package:
> 
> * github-markdown.css: (default) Automatically switches between light and dark through [@media (prefers-color-scheme)](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme).
> * github-markdown-light.css: Light-only.
> * github-markdown-dark.css: Dark-only.

>> Coment√°rio de ermesonsampaio:
@filipedeschamps o arquivo `github-markdown.css` faz uso da [@media (prefers-color-scheme)](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme) pra selecionar o tema dark ou light, ent√£o o problema ainda persiste pois n√£o podemos alterar o valor dessa media query(se pudessemos seria uma poss√≠vel solu√ß√£o, ent√£o caso seja poss√≠vel corrijam-me).

Vou continuar pesquisando pra ver se consigo achar uma solu√ß√£o!

>> Coment√°rio de tembra:
@ermesonsampaio voc√™ pode importar cada tema individualmente `...-light.css` e `...-dark.css` dentro de um seletor raiz para cada um como `.light` e `.dark`.

Ent√£o voc√™ pode usar javascript para identificar o `prefers-color-scheme` com `window.matchMedia` e dessa forma atribuir ao elemento `html` a classe `light` ou `dark` automaticamente. Isso tamb√©m te dar√° o poder de mudar essa classe no clique de um bot√£o, quando o pr√≥prio usu√°rio poder√° escolher o tema que quer, independente do preferencial informado pelo navegador.

Ou ainda voc√™ pode abstrair toda essa intelig√™ncia e utilizar esse maravilho web component: [dark-mode-toggle](https://github.com/GoogleChromeLabs/dark-mode-toggle)

>> Coment√°rio de ermesonsampaio:
@tembra muito obrigado pela sugest√£o, ajudou bastante!

Pra resolver esse problema eu achei interessante modificar o  `github-markdown.css` e se voc√™s analisarem as altera√ß√µes, eu basicamente troquei o crit√©rio do dark mode da media query para uma classe `dark` ou `light`, por√©m eu ainda tive que adicionar um tema `dark` e `light` para o [codemirror](https://codemirror.net/) que √© utilizado pelo [bytemd](https://github.com/bytedance/bytemd) e alterar algumas coisas desses temas para que ele seguisse o padr√£o do restante da aplica√ß√£o.

### Resultado:
![image](https://user-images.githubusercontent.com/87838931/170149630-d56b7118-7a7e-4811-b209-3077f5ed0674.png)

>> Coment√°rio de filipedeschamps:
Ficou impressionantemente bonito o modo darkmode ü§ù 

Mas vendo os commits, sinto que estamos encarando a abstra√ß√£o do jeito errado e por isso que estamos precisando dar tantas voltas. Isso dificulta fazermos updates das depend√™ncias e abre margem para muita coisa escapar, como blocos de c√≥digo:

<img width="1137" alt="image" src="https://user-images.githubusercontent.com/4248081/170355960-9f4a927e-caa2-4149-9c68-c8f3a8fc6e9d.png">

Eu tive uma intera√ß√£o faz um tempo no reposit√≥rio do Primer sobre os estilos do markdown: https://github.com/primer/react/issues/1680

Uma pessoa tava propondo um componente para markdown, mas n√£o teve nenhum engajamento. Mas veja as respostas ali para baixo, onde ele fala que importou o CSS do pr√≥prio Primer (que √© a abstra√ß√£o que vem antes do Primer React). N√£o sei se vai ter o efeito que procuramos e se comporta blocos de c√≥digo.

De qualquer forma, precisamos encarar esse problema por um outro √¢ngulo üëç

>> Coment√°rio de ermesonsampaio:
Implementando a solu√ß√£o encontrada pelo autor da issue podemos obter um resultado muito semelhante ao anterior.

Se olharem os √∫timos commits podem ver que agora o tema do codemirror est√° sendo importado do m√≥dulo de tema para codemirror do pr√≥prio Primer ([codemirror-github-dark](https://github.com/primer/codemirror-github-dark)) e n√£o mais do arquivo da pasta `styles`, por√©m da maneira como o c√≥digo est√° hoje, ainda √© necess√°rio o arquivo `bytemd.css` para que o layout do `bytemd` fique de acordo com o tema selecionado.

>> Coment√°rio de filipedeschamps:
Show! √ìtima descoberta e de fato √© menos coisas para administrarmos ü§ù 

Mas testando aqui um bloco de c√≥digo, ele continua imprimindo uns tokens com a cor errada e fica ileg√≠vel. Isso acontece a√≠ do seu lado tamb√©m?

>> Coment√°rio de ermesonsampaio:
Sim, isso tamb√©m est√° acontecendo do meu lado.

Dando uma fu√ßada na pasta `styles` do `highlight.js` v√≠ que existe o `github.css` e o `github-dark.css` e at√© o momento o arquivo que est√° sendo importado √© o `github.css` que √© respons√°vel pelo light mode, explicando assim o motivo das cores erradas üòÖ

Sabendo disso agora precisamos importar o arquivo de estilo referente ao tema ativo.

---

**Importando o arquivo `github-dark.css` estaticamente apenas pra ver como ficaria:**
![image](https://user-images.githubusercontent.com/87838931/170394631-614c4652-fe8d-4901-82e7-6097682ade6a.png)

>> Coment√°rio de filipedeschamps:
Ficou lindo demaaais @ermesonsampaio üòç

>> Coment√°rio de filipedeschamps:
https://www.tabnews.com.br/Cleverson/c8ca4e4e-78b3-4e4e-aa88-9aa0fc4b76d9 ü§ù

>> Coment√°rio de ermesonsampaio:
Acabei esquecendo de comentar aqui, mas agora o tema do `highlight.js` tamb√©m est√° sendo aplicado de acordo com o tema selecionado pelo usu√°rio, ent√£o creio que agora dark mode finalmente est√° pronto (pelo menos por agora kkkkk)

>> Coment√°rio de filipedeschamps:
Pessoal, vou fechar essa issue para centralizar a conversa no PR #377 pois os detalhes t√©cnicos evolu√≠ram muito mais l√° ü§ù
</issue_375_Dark mode>

<issue_376_N√£o foi especificado Prazo para a Milestone 4>
Quem participou da Live de Inaugura√ß√£o da Milestone 4, sabe que minha casa pegou fogo (√© brincadeira, mas o alarme n√£o parava de apitar). E acabei esquecendo de bater o martelo com voc√™s no **Prazo**, como sempre fazemos.

Ent√£o qual prazo voc√™s sugerem para essa Milestone: https://github.com/filipedeschamps/tabnews.com.br/milestone/5

Lembrando que **prazo** aqui dentro do TabNews n√£o √© nada corporativo e o √∫nico efeito √© **referencial**... para sentir que o tempo passou e quanto passou.

>> Coment√°rio de tembra:
Amanh√£! üòÇ 

@filipedeschamps queria ter nascido rico pra n√£o precisar trabalhar e contribuir 100% aqui hehe

N√£o sei qual o ritmo de contribui√ß√£o GERAL da galera aqui com c√≥digo. Pude apenas observar o gr√°fico inicial. Mas, levando em considera√ß√£o a √∫ltima semana e considerando talvez um hype moment√¢neo pela entrada de novos membros externos (como eu), que n√£o sabemos se (o hype) ir√° continuar, eu diria que 30 dias √© um prazo aceit√°vel, uma vez que o objetivo da Milestone √© algo muito importante (e ainda n√£o 100% definido): TabCoins e TabCash.

>> Coment√°rio de filipedeschamps:
@tembra acabamos por n√£o definindo um prazo üòÇ mas na pr√°tica, foi `50` dias contando com a Live de encerramento, ou `45` se considerar o √∫ltimo deploy ü§ù  eu achei **√≥timo**, principalmente pelo fato de ter entrado muitas issues e melhorias no meio da Milestone üëç
</issue_376_N√£o foi especificado Prazo para a Milestone 4>

<issue_379_[√Årvore de coment√°rios] Responsividade em telas pequenas>
**Bom dia, tarde ou noite!**

_De antem√£o, queria falar que n√£o verifiquei todas as issues para ver se tem essa._

**Problema:** Erro simples de responsividade, com visto nas imagens abaixo.

<div  align="left">
<img  alt="Imagem o layout estourado em responsividade mobile." width="200px" src="https://user-images.githubusercontent.com/73303855/170021447-8e259467-8fb0-4c45-961d-c7a8f5f0be65.jpeg"/> 
<img  alt="Imagem o layout estourado em responsividade mobile." width= "200px" src="https://user-images.githubusercontent.com/73303855/170021451-41ba5c8b-4516-4651-9df7-ccad66ed42a4.jpeg"/> 
</div><br>

**Poss√≠vel solu√ß√£o:** Criar um veja mais quando o encadeamento do pr√≥ximo componente for menor que x pixels.

>> Coment√°rio de tembra:
Perfeito! Tinha reparado isso e ia postar essa issue logo mais.

Acredito que a solu√ß√£o deveria ser modificar o design, encadeando as respostas de forma vertical, utilizando uma estrat√©gia de UX/UI que o usu√°rio entenda que a resposta de baixo √© referente ao conte√∫do imediatamente de cima.

Nossos UX/UI podem elaborar melhor hehe.

Ocultar conte√∫do ou torn√°-lo expans√≠vel n√£o √© uma boa pr√°tica pra nossa ideologia.

>> Coment√°rio de azevgabriel:
> Em resposta √† @tembra 

Saquei, tinha criado a branch para realizar o modifica√ß√£o. Mas vou deixar a discuss√£o rolar aqui! Para ver a melhor forma de resolver.

>> Coment√°rio de rodrigoKulb:
Caramba fui ver como o youtube faz s√≥ trabalha com 2 camadas e o Github com uma.

Acho dif√≠cil uma discuss√£o entrar em muitos n√≠veis assim, mas acredito que podemos solucionar com a mudan√ßa no UX/UI.

Se o objetivo do tabnews √© trabalhar todos os coment√°rios de forma igual, talvez n√£o devemos utilizar esse "TAB" uma sugest√£o √© adicionar um pr√©-titulo 
Exemplo:
`Em resposta de @azevgabriel  `

e deixar ordenado de forma que fique claro a resposta.

>> Coment√°rio de azevgabriel:
Galera algo assim n√£o funcionaria?

Diminuir o padding ou a margin entre os encadeamentos de acordo com a width do viewport. Sinalizar o encadeamento com alguma cor diferente.

<img width="250px" src="https://user-images.githubusercontent.com/73303855/170067510-b9794fb7-27fe-436c-b0f2-f94d507b8812.png" alt="Um design feito no paint" />
Ignorem a falta de software, no paint √© mais r√°pido. Apenas para demonstra√ß√£o.

>> Coment√°rio de yoelgama:
Acredito que a ideia do @rodrigoKulb √© a que mais se alinha com a ideologia do projeto, uma vez que removemos as conex√µes visuais de depend√™ncia, deixando apenas um <code>Em resposta de @rodrigoKulb </code>, passaremos a pensar mais nas respostas como conte√∫do completo e menos como um 'ah! valeu' em resposta da publica√ß√£o, com fim ali.
Nesse sentido, at√© a linguagem **'Em resposta de'** no lugar de **'Resposta para'** √© melhor, tendo em vista que a primeira op√ß√£o d√° mais a ideia de 'estou criando algo novo a partir de algo' e a segunda da a ideia direta de 'estou apenas respondendo algu√©m', essa ideia tamb√©m ocorre quando aninhamos as respostas com bordas. Mas tamb√©m, al√©m desse texto, podemos e acho que devemos agrupar as respostas de uma mesma publica√ß√£o, seja ela a primeira publica√ß√£o ou resposta de uma outra. Isso pode ser feito de algumas formas, mas gostaria de destacar duas:

1. Visualmente: colocar a resposta diretamente abaixo da publica√ß√£o a qual ela faz men√ß√£o;
2. Deixar as respostas seguirem apenas a ordem cronol√≥gica, mas colocar um <code>ver respostas (23)</code> ao lado de cada resposta (j√° resolvendo a issue #332  ). Esse bot√£o n√£o expande nem retrai as respostas de uma determinada  resposta na publica√ß√£o, mas sim expande a pr√≥pria resposta como publica√ß√£o e as respostas que houver para ela estar√£o logo abaixo.

Acho que a segunda op√ß√£o √© bem legal e espero ter conseguido explicar como iria funcionar :)

>> Coment√°rio de tembra:
A ideia do @rodrigoKulb realmente √© a melhor nesse sentido. Podemos ainda fazer um hyperlink para quando clicarmos no "Em resposta a @..." ser redirecionado de fato para a resposta.

Ap√≥s toda essa an√°lise, dificilmente teremos mais do que 5 respostas encadeadas. Mas se observarmos bem, o problema do TabNews nem √© o encadeamento em si e sim design:
- A cada nova resposta perdemos pixels preciosos tanto na **esquerda** quanto na **direita**.
- Acredito que n√£o precisamos perder espa√ßo na **direita**.
- Quanto ao espa√ßo da **esquerda** ele deveria ser reduzido.

A ideia seria mudar o design/espa√ßamento para algo parecido com o do Reddit, por exemplo:

![img](https://user-images.githubusercontent.com/6340360/170605324-bccfcbd2-1657-4d2e-b0f6-b617ab5d36d8.jpeg)

Aqui temos 5 respostas encadeadas em rela√ß√£o ao post original e j√° fica leg√≠vel, mas dariam mais respostas, ainda deixando leg√≠vel. Compare isso agora contra 6 e 7 respostas encadeadas da imagem apresentada l√° em cima na cria√ß√£o desta issue.

Finalmente acredito que desta forma fica at√© melhor de lermos um conte√∫do (sem o espa√ßamento na direita) ou at√© mesmo de fazermos o "scan" do @filipedeschamps  hehe

>> Coment√°rio de filipedeschamps:
Muito boa discuss√£o turma ü§ù 

Quando implementar as TabCoins eu vou fazer uma proposta que vai mexer bastante no layout (para comportar elas) e que vai liberar mais espa√ßo üëç

>> Coment√°rio de gabrnunes:
Eu acho que o @higorpo fez uma √≥tima sugest√£o no app da TabNews: https://github.com/higorpo/tabnews-mobile poderia ter algo semelhante n√©? Acho que √© mais ou menos o que a galera t√° discutindo aqui, de "minificar" as respostas.

>> Coment√°rio de aprendendofelipe:
O PR #425 resolve esse problema provisoriamente enquanto o @filipedeschamps n√£o nos apresenta o novo layout que est√° planejando

>> Coment√°rio de filipedeschamps:
Turma, voltando nessa issue, o layout que entrou em produ√ß√£o resolve a parte do problema de espa√ßamento na direita, mas n√£o resolve todos os problemas, pois vai depender da rela√ß√£o entre a profundidade da discuss√£o e a largura do device que est√° sendo usado para ler essas respostas. Dado a isso, poder√≠amos pensar no seguinte:

1. Um recurso em que seja poss√≠vel comprimir/esconder/fechar parte da √°rvore de respostas: isso serviria quando a pessoa n√£o se interessa pelo desenvolvimento de uma discuss√£o, mas quer acompanhar outras √°rvores de discuss√£o que est√£o abaixo.
2. Usar esse exato mesmo recurso para quando o device tiver uma dimens√£o X, esconder automaticamente a √°rvore de respostas a partir do n√≠vel Y, e se nessas condi√ß√µes a pessoa clicar para expandir as respostas, ao inv√©s de expandir/abrir, redirecionar o usu√°rio para uma p√°gina nova com o restante das respostas, como o @yoelgama comentou na Op√ß√£o 2.

S√≥ temos que tomar cuidado para n√£o abusar e esconder facilmente conte√∫dos de valor concreto, como antecipado pelo @tembra ü§ù

>> Coment√°rio de rodrigoKulb:
Acho que a resposta est√° aqui no github!

Como a proposta inicial era manter o mesmo peso dos coment√°rios ao conte√∫do principal. O Github faz isso muito bem, todos os coment√°rios est√£o na mesma linha se voc√™ responde algu√©m tem a op√ß√£o de colocar a parte do conte√∫do.

Se fizermos de forma autom√°tica, quando algu√©m "**Responder**" um conte√∫do colocamos esse prefixo no inicio do coment√°rio com o "link" ao coment√°rio que est√° sendo respondido.

Em contra partida todos os coment√°rios seguem na mesma estrutura, apenas alterando a ordem conforme √© hoje.

![Captura de tela em 2022-07-29 00-39-58](https://user-images.githubusercontent.com/5334261/181678440-bcdf6f45-4e04-4feb-88dc-d43c0f522c25.png)

Exemplo como ficaria:

![Captura de tela em 2022-07-29 00-44-53](https://user-images.githubusercontent.com/5334261/181680206-bbaf3bc5-5992-4a99-88ec-9bce4c70fa9d.png)

>> Coment√°rio de gpaiva00:
@filipedeschamps essa sugest√£o do @rodrigoKulb √© v√°lida? Parece que ela resolve o problema da √°rvore de respostas no Mobile.

>> Coment√°rio de filipedeschamps:
Nesta sugest√£o, todas as respostas daquele coment√°rio do `akachan` ficariam todas logo abaixo, correto? Como ficaria o layout com a resposta de uma resposta?

>> Coment√°rio de gpaiva00:
Ficaria assim como no Github. Todas alinhadas com esse design de bal√£ozinho. 
E o header da resposta seria:

> Em resposta √† `@fulano`

Nesse caso n√£o teria √°rvore.

>> Coment√°rio de filipedeschamps:
Show, mas n√£o sei se compreendi muito bem, pois n√£o entendi como que daria para saber exatamente contra qual resposta original eu estou lendo a resposta, ainda mais considerando que a posi√ß√£o da resposta pode variar conforme o seu ranking e um mesmo usu√°rio pode comentar v√°rias vezes e contra respostas diferentes.

Pegando como exemplo essa publica√ß√£o aqui:

https://www.tabnews.com.br/wesleyara/configurando-o-ambiente-javascript-no-linux

Se algu√©m conseguir fazer uma simula√ß√£o de como ficaria seria show ü§ù

>> Coment√°rio de gpaiva00:
Beleza, vou estudar como ficaria. ü§ùüèΩ

>> Coment√°rio de Ryannnkl:
> Em resposta √° @gpaiva00 

Talvez isso fique fora da style guide do prime, mas a forma que o whatsapp referencia mensagem funciona bem:

![image](https://user-images.githubusercontent.com/48577990/220809446-3e12a5ee-1c4c-43f3-ab00-329317c98f5d.png)

colocar um pequeno preview e um link para a mensagem referenciada, deixaria de ser necess√°rio ficar abrindo para direita a cada novo coment√°rio

>> Coment√°rio de Poveii:
Pessoal, tive uma ideia para a quest√£o da legibilidade por conta da #1300, vendo que o pr√≥prio @aprendendofelipe postou agora a pouco no Tabnews sobre.

Que tal a gente usar o bot√£o de expandir as respostas como um link para a thread, pensando como √© mais ou menos no Reddit e no Twitter (se eu n√£o me engano)?

Assim:
![Screenshot from 2023-03-16 12-23-55](https://user-images.githubusercontent.com/79858234/225665226-e0ea3358-2ffc-488d-9bcf-d2df847a3354.png)

Clicou:
![Screenshot from 2023-03-16 12-24-28](https://user-images.githubusercontent.com/79858234/225665290-7b3b3d74-6ef0-46f1-afdc-e554865f8b73.png)

Dessa forma, fica leg√≠vel pra ver quem respondeu quem e a para quem foi essa resposta.

Na minha opini√£o, n√£o acho que precise mudar o texto de "Ver mais x respostas" para algo do tipo como "Continuar essa thread". Porque de toda forma, voc√™ vai ver as tantas respostas ao clicar no bot√£o.

>> Coment√°rio de aprendendofelipe:
S√≥ para entender melhor sua sugest√£o @Poveii, o que ela √© diferente da minha √© que qualquer bot√£o "ver mais" j√° vai direcionar para outra p√°gina independentemente do n√≠vel da resposta?

O "ver mais" como est√° hoje mostra mais respostas que podem ser de threads diferentes. Pois ele agrupa v√°rios "ver mais" que apareceriam em sequ√™ncia.

N√£o √© melhor s√≥ sugerir para o usu√°rio abrir em uma nova p√°gina apenas para ele saber que existe a possibilidade?

E essa sugest√£o s√≥ apareceria caso fosse necess√°rio, ent√£o iria aparecer s√≥ em n√≠veis de respostas mais profundos e de acordo com a largura da tela.

>> Coment√°rio de Poveii:
Ahh, entendi. Concordo!

E no caso, isso s√≥ resolve em parte o problema da legibilidade no mobile n√©? Porque eu pensei que como nesse exemplo abaixo ([link do coment√°rio para entender](https://www.tabnews.com.br/guites/26d8254d-068d-475c-8038-fe63099cec1a)), implementando esse link para o bot√£o de ver mais poderia facilitar a legibilidade para entender que o usu√°rio `@Edson295` realmente respondeu o `@renanmorais` (se esse for o caso).

![Imagem do Tabnews](https://i.ibb.co/bF734FZ/20230315-231646.jpg)

**Complementando**: O bot√£o substituiria o coment√°rio do Edson por "ver mais 1 resposta" e ao clicar, ver que realmente ele respondeu o Renan. Quem sabe, pensando melhor pela quest√£o da UX, poderia ser um modal/popup/janela para mostrar o coment√°rio e sua resposta, mas como estamos falando de mobile, isso fica realmente dif√≠cil.

Enfim, eu tirei o meu medo de estar s√≥ h√° uns 8 meses estudando frontend, tendo aquela ideia na cabe√ßa de que eu n√£o sei de nada ainda e que deveria s√≥ fica de olho por cima, pra ver se eu me encaixo na conversa ou ajudo algu√©m. Ent√£o, obrigado Felipe por responder! üòéÔ∏è

>> Coment√°rio de aprendendofelipe:
> entender que o usu√°rio `@Edson295` realmente respondeu o `@renanmorais` (se esse for o caso).

Se for voltar com o achatamento, √© necess√°rio criar alguma outra forma visual de identificar para quem √© a resposta. Seja alguma das alternativas j√° discutidas aqui, ou alguma ideia nova.

J√° o "ver mais", a princ√≠pio est√° s√≥ para diminuir a quantidade de coment√°rios renderizados, e n√£o tem rela√ß√£o com a profundidade da √°rvore, mas isso pode ser alterado. Por enquanto podem estar ocultos coment√°rios at√© no primeiro n√≠vel, caso a publica√ß√£o tenha muitas respostas (agora o limite est√° em 108 respostas em uma tela full hd).

> ver se eu me encaixo na conversa ou ajudo algu√©m

Seja muito bem vindo! ü§óüí™

>> Coment√°rio de guites:
Eu achei um exemplo bom de como lidam com essa situa√ß√£o no [hacker.news](https://hacker.news).

Basicamente eles possuem um limite m√°ximo de indenta√ß√£o (coment√°rios de coment√°rios de coment√°rios de coment√°rios...) que pode aparecer na p√°gina principal da postagem.

Esse limite parece ser 20. Se voc√™s abrirem [este post sobre o snowden](https://news.ycombinator.com/item?id=6139606) e pesquisarem por "And?" v√£o cair num post com indenta√ß√£o de 20.

Reparem que ele recebeu ainda mais 13 respostas, mas voc√™ s√≥ consegue ver indo pra p√°gina dessa resposta:  <https://news.ycombinator.com/item?id=6144296>

![image](https://user-images.githubusercontent.com/71985299/225946852-fb77759d-c33f-414e-af3d-11d244ff7142.png)

E l√° dentro, acredito que o mesmo limite de 20 indenta√ß√µes seja refor√ßado.

Alguns ressalves sobre adaptar essa ideia pro Tabnews:

- Devido √† maturidade do site, talvez o melhor seja manter um limite menor de identa√ß√µes, com 5, 8 ou 10.
- A maioria das respostas n√£o chega nesse n√≠vel. O ideal, para uma resposta de qualidade, √© que ela tenha muitas respostas de mesmo n√≠vel.
- Quando as conversas ficam t√£o aninhadas, costuma ser um sinal de coment√°rios de m√° qualidade. O pr√≥prio exemplo que usei acima s√≥ chegou num n√≠vel t√£o grande porque era uma discuss√£o bem pessoal entre alguns users.

Eu acho que uma combina√ß√£o de limite de nesting (indenta√ß√£o) com direcionamento pra uma segunda p√°gina pra quem quiser seguir a discuss√£o √© uma boa ideia, mas mais importante √© **deixar claro para os usu√°rios que os coment√°rios devem ser pensados e produtivos, possuindo o mesmo n√≠vel de import√¢ncia da pr√≥pria postagem**. 

O que eu vejo muito hoje √© a galera fazendo coment√°rios pra agradecer ("Valeu pela for√ßa!" ou "√ìtimo ponto") quando a mesma ideia poderia ter sido transmitida dando um tabcoin.

Deixo aqui uma frase do [Paul Graham](http://www.paulgraham.com/hackernews.html?viewfullsite=1), um dos devs do hacker news, que pode auxiliar na forma que pensamos solu√ß√µes pro site:

>The good things in a community site come from people more than technology; it's mainly in the prevention of bad things that technology comes into play. Technology certainly can enhance discussion. Nested comments do, for example. But I'd rather use a site with primitive features and smart, nice users than a more advanced one whose users were idiots or trolls.


ps. por curiosidade, eis aquele post com identa√ß√£o 20 numa tela de celular

![image](https://user-images.githubusercontent.com/71985299/225951377-b368f359-ab1e-4b27-9e89-88b8b938378e.png)

>> Coment√°rio de rodrigoKulb:
porque n√£o utilizar o padr√£o do github?

Tudo na mesma linha com a op√ß√£o de responder, conforme abaixo.
![68747470733a2f2f692e6962622e636f2f6246373334465a2f32303233303331352d3233313634362e6a7067](https://user-images.githubusercontent.com/5334261/227417289-2a6d96c2-3fc5-4950-a56d-a27d6a9722d8.jpeg)

>> Coment√°rio de guites:
> porque n√£o utilizar o padr√£o do github?

O padr√£o do github gera alguns problemas, como mencionado pelo @filipedeschamps:

> Show, mas n√£o sei se compreendi muito bem, pois n√£o entendi como que daria para saber exatamente contra qual resposta original eu estou lendo a resposta, ainda mais considerando que a posi√ß√£o da resposta pode variar conforme o seu ranking e um mesmo usu√°rio pode comentar v√°rias vezes e contra respostas diferentes.

um mesmo usu√°rio pode ter feito diversos coment√°rios no mesmo post, e a ordem dos coment√°rios no tabnews n√£o √© fixa (como √© aqui no github), ent√£o n√£o temos como nos apoiar na ordem dos coment√°rios pra que a pessoa consiga entender o contexto.

Eu entendo a ideia de que o github serve tamb√©m como um "f√≥rum" pra discuss√£o, mas acho que a usabilidade n√£o √© otimizada pra isso.

Por exemplo pra te responder agora (esse coment√°rio √© em resposta ao @rodrigoKulb) eu tenho que escrever esse ps. explicando.

>> Coment√°rio de rodrigoKulb:
Sendo assim voto no limite tamb√©m para n√£o sair muito do objetivo e virar uma discuss√£o paralela!

Desta forma resolvemos o problema de quebra no layout e mantemos a usabilidade de indenta√ß√£o.

>> Coment√°rio de hisirdox:
Acredito que este seja o esbo√ßo ideal

![Sem t√≠tulo](https://user-images.githubusercontent.com/42983463/230631375-e4f50630-68bc-4873-ad5e-4a8722d0b164.png)
</issue_379_[√Årvore de coment√°rios] Responsividade em telas pequenas>

<issue_380_Problema nas depend√™ncias do projeto ou no meu node version?>
### Bom meus colegas, tentei rodar pela primeira vez o projeto e deu pau!

Queria ver se isso √© algum BUG ou se √© algum erro de instala√ß√£o do meu node.
Minha vers√£o do node √© v14.17.3 e do docker compose √© v2.1.1

### Usei esses dois comando apenas!
```cmd
npm install
npm run dev
```

**logs do npm install**
```cmd
npm install

npm WARN old lockfile 
npm WARN old lockfile The package-lock.json file was created with an old version of npm,
npm WARN old lockfile so supplemental metadata must be fetched from the registry.
npm WARN old lockfile
npm WARN old lockfile This is a one-time fix-up, please be patient...       
npm WARN old lockfile

added 1080 packages, and audited 1081 packages in 2m

96 packages are looking for funding
  run `npm fund` for details

4 vulnerabilities (1 high, 3 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
```

**logs do npm run dev**
```cmd
npm run dev   

> tabnews.com.br@1.0.0 dev
> kill-port 3000 && npm run services:up && npm run migration:run && npm run 
next && npm run services:stop

Process on port 3000 killed

> tabnews.com.br@1.0.0 services:up
> docker-compose -f infra/docker-compose.development.yml up -d

[+] Running 2/0
 - Container mailcatcher   Running                                     0.0s 
 - Container postgres-dev  Running                                     0.0s 

> tabnews.com.br@1.0.0 migration:run
> node infra/scripts/wait-for-db-connection-ready.js && node-pg-migrate up --envPath ./.env -m infra/migrations/ 2>migrations.log

internal/modules/cjs/loader.js:905
  throw err;
  ^

Error: Cannot find module 'node:child_process'
Require stack:
- C:\Users\gaga1\OneDrive\Documentos\GitHub\tabnews.com.br\infra\scripts\wait-for-db-connection-ready.js
    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:902:15)
    at Function.Module._load (internal/modules/cjs/loader.js:746:27)        
    at Module.require (internal/modules/cjs/loader.js:974:19)
    at require (internal/modules/cjs/helpers.js:92:18)
    at Object.<anonymous> (C:\Users\gaga1\OneDrive\Documentos\GitHub\tabnews.com.br\infra\scripts\wait-for-db-connection-ready.js:1:18)
    at Module._compile (internal/modules/cjs/loader.js:1085:14)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1114:10)
    at Module.load (internal/modules/cjs/loader.js:950:32)
    at Function.Module._load (internal/modules/cjs/loader.js:790:14)        
    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:76:12) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    'C:\\Users\\gaga1\\OneDrive\\Documentos\\GitHub\\tabnews.com.br\\infra\\scripts\\wait-for-db-connection-ready.js'
  ]
}
```

**Al√©m de alterar o lockfileVersion de 1 para 2 no package-lock.json**

Algu√©m poderia me informar, se eu estou fazendo algo errado ou se isso √© um problema no projeto?

>> Coment√°rio de filipedeschamps:
Interessante @azevgabriel voc√™ poderia fazer um teste com a vers√£o `14.18.3` do Node.js que √© a que tenho instalada aqui? S√≥ para isolarmos se √© a vers√£o dele.

>> Coment√°rio de azevgabriel:
> Resposta √† @filipedeschamps 

Felipe n√£o testei necessariamente com a mesma vers√£o. Fui justo pra √∫ltima vers√£o LTS (v16.15.0), para j√° deixar atualizado aqui, e deu super certo! Creio eu que tem que ser uma vers√£o >= a sua para rodar sem nenhum problema. 

E se isso se confirmar temos que mudar o README.md

>> Coment√°rio de filipedeschamps:
√ìtimo ponto! No README est√° `Node.js 14.x (ou qualquer vers√£o superior)`. O que voc√™ sugere colocar? A vers√£o que eu uso era uma vers√£o que a Vercel estava rodando as lambdas (que era a √∫ltima LTS na √©poca).

>> Coment√°rio de azevgabriel:
> Resposta √† @filipedeschamps 

Acho ao inv√©s de deixar qualquer vers√£o do 14.x, poder√≠amos restringir para: `Node.js 14.18.3 (ou qualquer vers√£o superior)` .

>> Coment√°rio de filipedeschamps:
Se topar, seria show mandar um PR ü§ù

>> Coment√°rio de tembra:
Reabrindo essa discuss√£o aqui novamente @filipedeschamps e @azevgabriel.

Eu identifiquei que o script `wait-for-db-connection-ready.js` est√° importando o m√≥dulo interno `child_process` do Node usando a nova forma de importa√ß√£o `node:module` a qual parece que na vers√£o `14.17.3` do Node (que era a utiliza pelo @azevgabriel) n√£o era suportada ainda.

Pesquisando r√°pido n√£o encontrei muito bem a documenta√ß√£o de quando essa "nova forma" de importa√ß√£o foi definida ou passou a ser utilizada. Mas baixando a vers√£o espec√≠fica do node acima citada (v14.17.3) consegui reproduzir o problema, s√≥ resolvendo quando removi o `node:` da importa√ß√£o.

Me parece que se tornou um padr√£o definido a partir da vers√£o 18, provado pela documenta√ß√£o do Node.js, mas j√° era poss√≠vel utilizar essa "nova forma" desde a vers√£o 16, tendo em vista que uso a v16.3.0 na minha m√°quina e nela o `node:child_process` funcionou normalmente.

Dito isto eu recomendaria utilizar a √∫ltima vers√£o LTS do node no README (atualmente a v16.15.0) ou ent√£o remover o `node:` do script.

Links para refer√™ncia:
- J√° com `node:` na vers√£o 18:
  - https://nodejs.org/docs/latest-v18.x/api/child_process.html
  - https://nodejs.org/docs/latest-v18.x/api/module.html
- Sem o `node:` na vers√£o 17:
  - https://nodejs.org/docs/latest-v17.x/api/child_process.html
  - https://nodejs.org/docs/latest-v17.x/api/module.html

>> Coment√°rio de filipedeschamps:
Quando eu vi o `node:` fiquei super confuso, mas funcionou na vers√£o que uso que √© a `v14.18.3` e no final achei bom porque √© uma boa medida de seguran√ßa. E essa √© a vers√£o que colocamos no README üëç 

De qualquer forma, acho super v√°lido atualizarmos o projeto para a 16 LTS, at√© porque a AWS disponibilizou essa vers√£o nas Lambdas e por consequ√™ncia a Vercel j√° disponibilizou tamb√©m ü§ù
</issue_380_Problema nas depend√™ncias do projeto ou no meu node version?>

<issue_381_Editor de Markdown preencher automaticamente a marca√ß√£o das Listas>
## Contexto

Estou criando essa issue apenas para termos o controle do que foi implementado nessa Milestone e para destacarmos tudo isso na Live de Encerramento.

## Execu√ß√£o

https://github.com/filipedeschamps/tabnews.com.br/pull/373
</issue_381_Editor de Markdown preencher automaticamente a marca√ß√£o das Listas>

<issue_382_Submeter publica√ß√£o ou coment√°rio com Command/Ctrl+Enter>
Uma sugest√£o para melhorar a usabilidade, eu t√¥ muito acostumado a publicar coisas usando s√≥ um Command+Enter e sinto falta quando n√£o tem.

>> Coment√°rio de gpoleszuk:
Como postagens definitivas geram notifica√ß√µes, poderia estar incluiso juntamente com essa funcionalidade proposta, uma op√ß√£o de tempo de arrependimento de postagem, assim como no GMail. Desta forma, se a combina√ß√£o acidental (CTRL+ENTER) ocorrer,  o usu√°rio ter√° alguns segundos para cancelar a postagem. O n√∫mero de segundos para esperar poderia ser definido nas personaliza√ß√µes da conta de cada usu√°rio (a ser extendida).

>> Coment√°rio de aprendendofelipe:
> o usu√°rio ter√° alguns segundos para cancelar a postagem.

Como ainda n√£o est√° sendo utilizada a estrat√©gia de interface otimista, isso pode atrapalhar a experi√™ncia do usu√°rio e eliminar a vantagem de usar o <kbd>Ctrl</kbd> + <kbd>Enter</kbd> j√° que, para ter esses segundos de arrependimento, a chamada para a API dever√° aguardar. Ent√£o sugiro implementar primeiro a interface otimista e depois a possibilidade de arrependimento.

Por enquanto o conte√∫do ainda n√£o aparece na notifica√ß√£o, ent√£o acredito que d√° pra implementar a submiss√£o com as teclas antes da possibilidade de arrependimento.

>> Coment√°rio de filipedeschamps:
@aprendendofelipe fiquei confuso no que de fato √© a interface otimista e a possibilidade de arrependimento, e a ordem das coisas üòÇ 

Em paralelo, eu adoro esse recurso de arrependimento citado pelo @gpoleszuk , mas de fato para implementar isso vamos precisar de uma fila/agendamento. Se eu entendi o que foi descrito ali em cima pelo @aprendendofelipe , a ideia seria primeiro implementar a submiss√£o com as teclas de atalho, e mais para frente o recurso de arrependimento? No Github √© poss√≠vel enviar uma publica√ß√£o pelas teclas de atalho, e n√£o tem arrependimento.

>> Coment√°rio de aprendendofelipe:
### Interface Otimista
Seria uma alternativa enquanto n√£o for implementada a fila no back-end. Implementa uma fila tamb√©m, mas rodando em segundo plano no client. Assim todas as a√ß√µes do usu√°rio tem respostas quase instant√¢neas como se j√° estivessem sido conclu√≠das com sucesso (da√≠ o otimismo), mas em segundo plano ocorre a comunica√ß√£o com o back-end at√© que todas as tarefas sejam executadas.

Caso o usu√°rio tente fechar o navegador enquanto ainda existem tarefas pendentes, √© exibido um aviso de que nem todas as altera√ß√µes foram salvas.

Caso ocorra algum erro nas tarefas, o front-end precisa avisar sobre o erro, mesmo que isso ocorra algum tempo ap√≥s ter ocorrido o otimismo.

### Possibilidade de Arrependimento

A√≠ sim, com a fila implementada, seja no back ou no front, pode-se aguardar um determinado tempo antes de fazer coisas irrevers√≠veis, como enviar um email de notifica√ß√£o.

Para as coisas revers√≠veis, pode ser utilizada outra estrat√©gia, como armazenar temporariamente tudo que pode ser desfeito.

### Submeter com Teclas

Acredito que pode ser implementado mesmo sem a parte de arrependimento. Ent√£o enviarei um PR.

>> Coment√°rio de filipedeschamps:
Que explica√ß√£o sensacional @aprendendofelipe üòç  muito obrigado meu caro!

>> Coment√°rio de filipedeschamps:
Fechado por #490
</issue_382_Submeter publica√ß√£o ou coment√°rio com Command/Ctrl+Enter>

<issue_384_Invalidar todas as sess√µes v√°lidas do `user` ao resetar a senha>
## Contexto

O PR #374 trouxe a feature de reset de senha, e agora pouco me veio em mente que uma medida de seguran√ßa interessante seria invalidar todas as sess√µes ativas o `user` ap√≥s esse reset de senha.

## Execu√ß√£o

- #603
- #615

>> Coment√°rio de filipedeschamps:
Fechado por #615
</issue_384_Invalidar todas as sess√µes v√°lidas do `user` ao resetar a senha>

<issue_387_[UX] - M√° experi√™ncia de usu√°rio em escrita em dispositivos moveis.>
**Problemas:**

Ambos est√£o presentes quando voc√™ da overflow no eixo y da √°rea de texto, na √°rea de cria√ß√£o um publica√ß√µes. [MOBILE]

1.  Quando voc√™ escreve, o texto come√ßa a ficar atr√°s do teclado.
2. Quando voc√™ quer corrigir alguma passagem do texto, ele d√° scroll para o come√ßo do texto.

*Cont√©m spoiler de conte√∫do do TabNews.*

<video src="https://user-images.githubusercontent.com/73303855/170382327-b78a0fe0-1141-4661-8f5c-1dbfe32213a3.mp4
" alt="V√≠deo mostrando BUG no TabNews" autobuffer=true />

**Poss√≠vel solu√ß√£o:**

Criar algo capaz de notar o ponto de inser√ß√£o de texto e rolar a barra de acordo com esse ponto.  _(quando houver o overflow-y)_ 

_Obs: uma coisa que passei muita dor de cabe√ßa com responsividade mobile, foi com a unidade de medida `vh`.  Pois quando abre o keyboard, o vh n√£o conta juntamente com o teclado. Portanto 100vh se torna a tela restante, mudando assim o layout caso tiver interfer√™ncia dessa unid. de medida._

>> Coment√°rio de filipedeschamps:
@azevgabriel por hora irei precisar fechar essa issue, pois ela faz parte de um problema maior que √© o editor de texto que usamos hoje, o [ByteMD](https://github.com/bytedance/bytemd) (que usa por baixo dos panos o [CodeMirror](https://github.com/codemirror/codemirror5)). Ele √© fant√°stico em alguns pontos, mas p√©ssimos em outros, como os que voc√™ levantou. O motivo de fechar a issue √© que provavelmente n√£o iremos conseguir consertar o problema de responsabilidade l√° no core do editor e precisaremos trocar de solu√ß√£o (ou fazer a nossa), o que ir√° desencadear em outros problemas e que ir√£o deixar as discuss√µes atuais desatualizadas ü§ù 

Mas caso consiga de alguma forma resolver do nosso lado, vamos abrir esse assunto novamente, porque a experi√™ncia em Mobile precisa ser excelente!
</issue_387_[UX] - M√° experi√™ncia de usu√°rio em escrita em dispositivos moveis.>

<issue_388_Refatora√ß√£o do componente `Content`>
## Contexto

Uma das melhorias dessa Milestone era salvar o conte√∫do digitado pelo usu√°rio em `localStorage` e toda administra√ß√£o de conte√∫dos (editar e mostrar) √© feita por um componente chamado `Content`. Fui eu quem fez esse componente e ficou um **monstro maluco**.

Ent√£o foi feita a implementa√ß√£o da feature, mas que como efeito colateral tamb√©m foi necess√°rio fazer uma refatora√ß√£o do componente para manter ele sob controle. E com isso ainda veio algumas melhorias de comportamento.

## Execu√ß√£o

Execu√ß√£o feita por @aprendendofelipe e @andreghisleni no PR #385

>> Coment√°rio de filipedeschamps:
Post comemorativo: https://www.tabnews.com.br/filipedeschamps/nova-melhoria-refatoracao-e-novos-comportamentos-no-editor-de-markdown
</issue_388_Refatora√ß√£o do componente `Content`>

<issue_393_Tipo de conte√∫do nas Tags para SEO>
@gabrnunes depois seria interessante analisarmos se `website` √© o melhor `og:type` para os conte√∫dos do TabNews, pois talvez o `article` seja melhor.

https://github.com/filipedeschamps/tabnews.com.br/blob/d4d8717c8973df1786ec4a3329065ba1601ce72d/pages/interface/components/BaseLayout/index.js#L15

Mas quanto mais eu pesquiso aqui, mais perdido eu estou, por exemplo:

https://stackoverflow.com/questions/29748013/what-is-the-correct-implementation-of-the-open-graph-article-type

E a√≠ comecei a testar umas coisas com [essa ferramenta](https://webcode.tools/generators/open-graph/article) e ela gerou umas tags muito interessantes com prefixo `article`, olha s√≥:

```html
<meta property="og:type" content="article">
<meta property="og:title" content="T√≠tulo">
<meta property="og:url" content="https://www.tabnews.com.br/">
<meta property="og:image" content="https://www.tabnews.com.br/img.js">
<meta property="og:description" content="Descri√ß√£o">
<meta property="article:author" content="filipedeschamps">
<meta property="article:published_time" content="2022-05-26T14:32:00.000-08:00">
<meta property="article:modified_time" content="2022-05-27T14:32:00.000-08:00">
<meta property="article:section" content="tecnologia">
```

No objeto de `content` n√≥s temos o que seria o `article:published_time` pela propriedade `content.published_at` e `article:modified_time` pela propriedade `updated_at`. O `article:author` da√≠ seria o `content.username`.

J√° no `article:section` eu chutei `tecnologia`.

O que acha de lapidarmos isso?

>> Coment√°rio de gabrnunes:
Legal demais, acho que d√° pra fazer isso sim. Mas e os links √∫nicos de coment√°rios, tamb√©m seriam classificados como artigos?

>> Coment√°rio de filipedeschamps:
Acredito que sim @gabrnunes üëç  eu j√° escrevi algumas respostas ali no TabNews que s√£o mini artigos, por exemplo: https://www.tabnews.com.br/filipedeschamps/82830059-7733-4a11-80da-47533557df69

E a gente sempre deveria mirar para que cada resposta tenha algum valor concreto ü§ù

>> Coment√°rio de gabrnunes:
E dai como ficaria o `title`? Pq isso √© importante pra um artigo n√©? Ser√° que colocamos algo gen√©rico como "Coment√°rio de Filipe Deschamps"? Hoje o t√≠tulo t√° meio confuso, pq s√≥ tem o nome do usu√°rio e aquela hash gigante.

>> Coment√°rio de filipedeschamps:
Ahhh ponto interessant√≠ssimo! Sim, eu senti isso na hora de criar as p√°ginas e n√£o sabia muito como resolver.

O curioso √© que um `content` child pode ter uma propriedade `title`, isso est√° dispon√≠vel na API mas a interface web n√£o d√° chance disso ser injetado. Bom, dado a isso, o que acha de:

1. Se tiver title, mostra o title e se n√£o tiver, pegar os `100` primeiros caracteres do corpo, por exemplo. Vai ficar muito melhor o resultado que aparece no buscador (ou n√£o, porque da√≠ talvez teremos que limpar um pouco alguns caracteres do corpo?). Talvez podemos come√ßar com eles sujos para ver o que acontece.

>> Coment√°rio de gabrnunes:
Ainda parece estranho ü§î E se a gente pegar sempre o t√≠tulo do post de maior level? Aqui no GitHub, por exemplo, o link direto pro coment√°rio √© s√≥ uma √¢ncora https://github.com/filipedeschamps/tabnews.com.br/issues/393#issuecomment-1139116157

>> Coment√°rio de filipedeschamps:
> Ainda parece estranho ü§î E se a gente pegar sempre o t√≠tulo do post de maior level?

Puts seria perfeito, algo como: `Em resposta a "...."` mas hoje infelizmente o model `content` n√£o tem um m√©todo para pegar o conte√∫do `root`, mas vai ter mais para frente, at√© para conseguir usar isso na p√°gina da resposta para dar mais contexto.

> Aqui no GitHub, por exemplo, o link direto pro coment√°rio √© s√≥ uma √¢ncora 

Correto, eles n√£o tem uma p√°gina para a resposta, ent√£o seria algo como um Tweet respondendo outro Tweet, exemplo:

https://twitter.com/mhmdou1/status/1528841400850296834

Interessante que nesse caso eles fazem uma mistura das ideias (um prefixo com o corpo):

Corpo:

```
It contains lot of changes
But sincerely one of the best updates i have seen 
Like wow holy molyüôÑü•∫
I swear i keep adoring next more and more
Segment routes are amazing 
Nested layouts

Making our lives easier‚ù§Ô∏è
```

Eles n√£o possuem uma tag <title> no source da p√°gina (???), mas por JavaScript (imagino) definiram o t√≠tulo como:

```
document.title 

> 'Mohammad AlOulabi on Twitter: "@vercel It contains lot of changes But sincerely one of the best updates i have seen Like wow holy molyüôÑü•∫ I swear i keep adoring next more and more Segment routes are amazing Nested layouts Making our lives easier‚ù§Ô∏è" / Twitter'
```

Mas acho que usar o corpo inteiro seria ruim porque pode ficar um mega t√≠tulo üòÇ

>> Coment√°rio de gabrnunes:
Hahahaha, boa! Pois √©, vi que no Dev.to √© assim tamb√©m, eles colocam o conte√∫do do coment√°rio no t√≠tulo. Acho que vamos seguir dessa forma mesmo.

>> Coment√°rio de gabrnunes:
@filipedeschamps desculpa, mas eu acabei tendo que focar na cria√ß√£o do novo site pra Codecon e n√£o to conseguindo ajudar aqui :(

Assim que eu der um tempo posso resolver essa Issue, mas fica livre se outra pessoa quiser resolver tamb√©m!

>> Coment√°rio de filipedeschamps:
Sem problema algum @gabrnunes foco total nas tarefas do seu trabalho e de quebra se quiser mais para frente, n√£o deixe de fazer uma publica√ß√£o com `Pitch:` l√° no TabNews contando um pouco sobre esse implementa√ß√£o do novo site e se tem algo a destacar que tenha valor pra turma, e com isso trazer mais pessoas para a Codecon. Acho um Pitch super v√°lido, pois voc√™ teve envolvimento direto com o projeto.

---

Em paralelo o @rodrigoKulb na issue #433 perguntou se ele podia ajudar em algo. Rodrigo, talvez iterar nessa implementa√ß√£o seja interessante. √â algo que faz parte da Milestone 4, que j√° foi executada pelo @gabrnunes mas que podemos ajustar para algo mais refinado a "artigos". E como lida com SEO, todo carinho √© pouco ‚ù§Ô∏è ü§ù

>> Coment√°rio de filipedeschamps:
Antes de fecharmos essa issue, sugiro criarmos uma fun√ß√£o que limpe todo o markdown do `body` para ser usado nas tags de `description`.

Pegando como exemplo essa [√∫ltima publica√ß√£o que fiz](https://www.tabnews.com.br/filipedeschamps/seal-ferramenta-para-comprovacao-da-autoria-de-suas-ideias-baseada-na-verificacao-de-timestamps):

```html
<meta name="description" content="[Seal](https://docs.planet.ink/data/seal/) faz parte de uma ferramenta chamada [Planet](https://planet.ink/product) (um aplicativo de gerenciamento de conhecimento) que consegue comprovar em"/>
```

O melhor seria gerar algo como:

```html
<meta name="description" content="Seal faz parte de uma ferramenta chamada Planet (um aplicativo de gerenciamento de conhecimento) que consegue comprovar em"/>
```

>> Coment√°rio de rodrigoKulb:
Temos a op√ß√£o de utilizar essa depend√™ncia ou fazer na unha.
https://www.npmjs.com/package/markdown-to-text
Qual sugest√£o?

Edit: Pensando aqui voc√™ n√£o acha legal a API do content retornar 2 body's com markdown e somente texto?
Dependendo da utiliza√ß√£o j√° vem direto da content essa op√ß√£o.

>> Coment√°rio de filipedeschamps:
Sugiro usar uma lib, porque tem v√°rias regrinhas chatas, mas a d√∫vida √© qual lib, pois tem essa sua, e tem outras:

* https://www.npmjs.com/package/strip-markdown (mais popular)
* https://www.npmjs.com/package/remove-markdown-and-html (m√£o na roda, pois tira HTML junto, mas est√° abandonada)

E remover HTML tamb√©m √© importante, porque d√° pra inserir no `body` coisas como `<img>`.

Sobre retornar isso limpo na API, n√£o sei, por enquanto acho que n√£o. Mas seguindo sua id√©ia, o `model` content poderia ter um m√©todo para limpar o body. Mas nesse caso em espec√≠fico, pelo uso ser somente no Layout, primeiro eu resolveria l√° e depois com a necessidade real eu transportaria para o model (e da√≠ expor na API). Esse tipo de refatora√ß√£o √© o tipo mais f√°cil e √© uma del√≠cia de fazer, ou n√£o fazer porque o futuro nos provou que n√£o foi necess√°rio antecipar uma abstra√ß√£o assim ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps na verdade o objetivo inicial dessa Issue foi realizado na ultima #453 PR, mas venho fazer uma sugest√£o de uma nova implementa√ß√£o para SEO:

https://developers.google.com/search/docs/advanced/structured-data/article?hl=pt-br
![Captura de tela em 2022-07-05 11-53-00](https://user-images.githubusercontent.com/5334261/177356743-bd15315a-b3c2-4468-b8f5-4bbeb8a89a6b.png)

[AMP com dados estruturados:](https://developers.google.com/search/docs/advanced/structured-data/article?hl=pt-br#amp-sd) as p√°ginas AMP com dados estruturados podem ser exibidas no carrossel das Principais not√≠cias, no carrossel de host da pesquisa aprimorada, nas hist√≥rias visuais e em resultados da pesquisa aprimorada em dispositivos m√≥veis. Esses resultados podem incluir imagens, logotipos de p√°ginas e outros recursos interessantes de resultados da pesquisa.

>> Coment√°rio de filipedeschamps:
Show Rodrigo! N√£o entendo muito bem de AMP, mas sei que o Next possui suporte para isso de alguma forma (acho), mas lembro que no passado o Google anunciou que iria parar de dar aten√ß√£o ao AMP, olha s√≥: https://plausible.io/blog/google-amp

√â sobre o mesmo assunto?

>> Coment√°rio de rodrigoKulb:
@filipedeschamps realmente parece que o Google vai descontinuar o AMP principalmente para not√≠cias / artigos. Tentei achar alguns artigos com APM n√£o consegui simular nenhum caso, Achei somente para receitas e livros. Ent√£o podemos cancelar a miss√£o.

Vamos finalizar essa Issue?

>> Coment√°rio de filipedeschamps:
> Vamos finalizar essa Issue?

Vamos ü§ù mas obrigado por trazer esse ponto para c√°, SEO √© algo fundamental para o tipo de site que √© o TabNews ü§ù üëç
</issue_393_Tipo de conte√∫do nas Tags para SEO>

<issue_394_√Årea do Perfil do usu√°rio est√° sendo feita>
Edi√ß√£o do Perfil est√° sendo feita ?

>> Coment√°rio de filipedeschamps:
No escopo da Milestone atual n√£o: https://github.com/filipedeschamps/tabnews.com.br/milestone/5

>> Coment√°rio de filipedeschamps:
Estou fechando essa issue, dado que essa sugest√£o foi dada nessa publica√ß√£o: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda
</issue_394_√Årea do Perfil do usu√°rio est√° sendo feita>

<issue_395_Imagem personalizada para compartilhamento de links em redes sociais>
Depois da ISSUE https://github.com/filipedeschamps/tabnews.com.br/issues/337, surgiur a ideia de criar uma imagem personalizada para os posts e coment√°rios sempre que algu√©m compartilh√°-los nas redes sociais. 

Essa √© uma pr√°tica utilizada atualmente pelo GitHub, Dev.to, entre outras plataformas.

Eu criei duas imagens aqui e queria abrir pra discuss√£o do que voc√™s acham delas:

## Quando algu√©m compartilhar um post
![image](https://user-images.githubusercontent.com/9409763/170602138-8cf4e2e7-3757-4d29-a528-6b77ffeccef6.png)

## Quando algu√©m compartilhar um coment√°rio
![image](https://user-images.githubusercontent.com/9409763/170602229-236aeb94-ab9d-4f9f-9ac2-6eb7751289af.png)

>> Coment√°rio de filipedeschamps:
Lindo demais! Fico **realmente emocionado** por essas melhorias estarem acontecendo no projeto.

Tenho apenas uma sugest√£o: na vers√£o `root` (quando compartilha um post), deixar o brand vers√£o minimizada igual na vers√£o da resposta (um √≠cone na direita), e mover o t√≠tulo l√° pra cima. Sugiro isso, pois o t√≠tulo √© o que vai mais chamar a aten√ß√£o e √© uma informa√ß√£o que sempre ir√° variar. √â a √¢ncora principal da thumbnail e √© a primeira informa√ß√£o que deveria ser lida (e possivelmente, a pessoa vai ler primeiro isso at√© antes do que a pessoa que compartilhou escreveu ao redor).

>> Coment√°rio de tembra:
Meus dois centavos: Adicionar tamb√©m na imagem da resposta a quantidade de respostas que a resposta tem.

>> Coment√°rio de gabrnunes:
Oi @tembra @filipedeschamps, fiz os ajustes sugeridos e o Figma com o layout t√° aqui: https://www.figma.com/file/5gdFx8Bzj4SN8rGZLhCxl6/TabNews?node-id=0%3A1

Se algu√©m quiser implementar fica a vontade! 

Aqui tem dois tutoriais que mostram como criar essa imagem:
https://www.youtube.com/watch?v=qvetoR6V5ic
https://mediajams.dev/post/automate-social-images-next-puppeteer

>> Coment√°rio de tembra:
@gabrnunes  Apenas para informar: O link do Figma parece estar quebrado.

E eu esbarrei nesse v√≠deo da Rocketseat esta semana hehe. Na mesma hora lembrei desta issue :)

>> Coment√°rio de gabrnunes:
Oi @tembra eu chequei as permiss√µes do Figma e parece estar tudo ok. O que aconteceu ai quando tentou abrir?

>> Coment√°rio de aprendendofelipe:
> Oi @tembra eu chequei as permiss√µes do Figma e parece estar tudo ok. O que aconteceu ai quando tentou abrir?

@gabrnunes, aqui est√° abrindo normalmente üëç

>> Coment√°rio de tembra:
@gabrnunes agora abriu! n√£o lembro exatamente o erro, mas salvo engano era uma mensagem sobre a inexist√™ncia do arquivo. üòï

>> Coment√°rio de tashima42:
Lembrei de um post no tabnews em que algu√©m compartilhou um gerador de imagens usando o HTML Canvas. N√£o tenho ideia se isso pode ser aplicado nesse caso, mas aqui ta o post:
https://www.tabnews.com.br/thi/meu-primeiro-projeto-open-source

>> Coment√°rio de ErickCReis:
Estive trabalhando nessa issue nos √∫ltimos dias e queria compartilhar alguns detalhes.

Dei uma olhada nos tutoriais que o @gabrnunes recomendou e vi que a pr√≥pria vercel tem um projeto sobre isso, o  https://og-image.vercel.app/, e no reposit√≥rio deles tem uma [issue](https://github.com/vercel/og-image/issues/148) com o um problema dessa implementa√ß√£o, o tamanho das libs. Nessa issue j√° tinha algumas inciativas para solucionar o problema, e foi a partir da√≠ que eu comecei alguns testes com o [resvg-js](https://github.com/yisibl/resvg-js).

Depois de fazer alguns ajustes no svg gerado pelo figma, que por sinal facilitou muito essa parte, a gera√ß√£o das imagens funcionou sem nenhum problema, s√≥ tive quebrar um pouco a cabe√ßa para trabalhar com o Nextjs.

Tem algumas partes dessa implementa√ß√£o que ainda n√£o sei se est√£o muito legais:
- Tive que subir o arquivo das fontes no projeto;
- Utilizei esse [artigo](https://bl.ocks.org/tophtucker/62f93a4658387bb61e4510c37e2e97cf) para resolver o tamanho do espa√ßo reservado para o nome do usu√°rio, n√£o fiz testes para tentar usar css no template da image;
- Modifiquei o next.config para fazer o rewrite para o rota da api.

>> Coment√°rio de gabrielsozinho:
Fechado por #535
</issue_395_Imagem personalizada para compartilhamento de links em redes sociais>

<issue_396_Sistema de Pagina√ß√£o>
Uma ideia que pode ajudar na renderiza√ß√£o das postagens √© a pagina√ß√£o. Onde ser√° listado no m√°ximo 100 postagens por p√°gina.

Para identificar o numero da p√°gina, poderia colocar um valor num√©rico em uma QueryString na URL chamada `page` que ficaria assim: https://www.tabnews.com.br/?page=2

Outra forma √© fazer a pagina√ß√£o ap√≥s um post, como √© usado no Github ao colocar uma QueryString chamada `after` com o ID do post.

>> Coment√°rio de tembra:
Ol√° @TiaGoiNsaNy tudo bem?

Esta feature j√° est√° prevista para entrega na [milestone atual](https://github.com/filipedeschamps/tabnews.com.br/milestone/5). Voc√™ pode acompanhar o andamento dela na issue #339.

>> Coment√°rio de tiagoryandev:
Opa @tembra !

Valeu por ter avisado, vou acompanhar melhor!
</issue_396_Sistema de Pagina√ß√£o>

<issue_399_Salvar dados do dark/light mode no perfil do usu√°rio>
Essa discuss√£o surgiu na PR https://github.com/filipedeschamps/tabnews.com.br/pull/377, que est√° salvando a informa√ß√£o sobre o light ou dark mode no `localStorage`, a minha sugest√£o √© salvar essa informa√ß√£o no perfil do usu√°rio, dessa forma sempre ficar√° salvo independente de onde ele fizer login.

>> Coment√°rio de ermesonsampaio:
Acho que isso se encaixa bem no TabNews, ainda mais com o [Aplicativo do TabNews](https://github.com/higorpo/tabnews-mobile) e outros poss√≠veis clients que possam ser desenvolvidos pela comunidade.

>> Coment√°rio de filipedeschamps:
@gabrnunes vou por enquanto fechar essa issue para centralizar tudo l√° no PR #377 e de fato essa √© uma informa√ß√£o que no futuro deve ser salva no perfil do usu√°rio ü§ù üëç
</issue_399_Salvar dados do dark/light mode no perfil do usu√°rio>

<issue_400_Falha no layout ao usar textos zalgo>
Opa, depois de ver a publica√ß√£o do <a href="https://tabnews-git-refactor-content-preview3-tabnews.vercel.app/michelsantana" class="BranchName-sc-lduqme-0 hxHDDt">michelsantana</a> no ambiente de homologa√ß√£o [(Caracter mal√≠gno)](https://tabnews-git-refactor-content-preview3-tabnews.vercel.app/michelsantana/caracter-maligno), eu tive a curiosidade de testar usar textos zalgo. 
**Texto Zalgo √© um texto digital que foi modificado com caracteres combinados, s√≠mbolos Unicode usados para adicionar diacr√≠ticos acima ou abaixo das letras, para parecer assustador ou com falhas.**

E o resultado obtido foi o seguinte:
<img src="https://ik.imagekit.io/gabrielsozinho/Opera_Instant%C3%A2neo_2022-05-25_222232_tabnews-git-refactor-content-preview3-tabnews.vercel.app_9Ha4_loJa.png?ik-sdk-version=javascript-1.4.3&updatedAt=1653528280945">

isso tamb√©m vale para o t√≠tulo de publica√ß√µes:
<img src="https://ik.imagekit.io/gabrielsozinho/zalgo-text-tabnews-title_De-SpXfN-.png?ik-sdk-version=javascript-1.4.3&updatedAt=1653673765286">
<br>
**O layout bugou, o texto do post ultrapassou o limite que deveria existir. Eu n√£o sei exatamente a solu√ß√£o para isso, mas em outras redes sociais n√£o acontece isso, o texto √© limitado √†quele espa√ßo.**
<br>
<br>
Fiz tamb√©m alguns testes pra mostrar como o texto fica em outras redes sociais (respeitando o limite de caracteres delas)

_Twitter:_
<img src="https://ik.imagekit.io/gabrielsozinho/zalgo-text-twitter_Q8iseF9m_.png?ik-sdk-version=javascript-1.4.3&updatedAt=1653673765308">
Ele s√≥ √© mostrado at√© a parte final da publica√ß√£o.

_Coment√°rios Youtube:_
<img src="https://ik.imagekit.io/gabrielsozinho/zalgo-text-youtube_RHqoej1GS.png?ik-sdk-version=javascript-1.4.3&updatedAt=1653673764458">
Aqui √© como se ele fosse "comprimido" at√© o limite do texto da publica√ß√£o

_Mensagens Instagram:_
<img src="https://ik.imagekit.io/gabrielsozinho/zalgo-text-messages-instagram_hR4loB5iM.png?ik-sdk-version=javascript-1.4.3&updatedAt=1653673764456">
Ele s√≥ √© mostrado at√© o limite da mensagem

>> Coment√°rio de tembra:
Est√° faltando um `overflow: hidden` em cada `Box` que representa uma resposta.

Acredito que s√≥ isso j√° deve resolver. Mas n√£o testei.

De repente o ideal seria fazer `parse` desses caracteres.

>> Coment√°rio de gabrielsozinho:
@tembra olha, se voc√™ quiser implementar isso, ser√° √≥timo! Isso porque sou novo nessa √°rea (principalmente no front-end) e n√£o sei como fazer isso. Voc√™ pode pegar a issue pra voc√™ sem problema algum.

edit: Nossa, vi que voc√™ tamb√©m √© de Bel√©m, muito massa

>> Coment√°rio de aprendendofelipe:
O PR #425 resolve esse problema para o ContentList e para o Content

>> Coment√°rio de filipedeschamps:
Fechando essa issue para dar prefer√™ncia ao PR do @aprendendofelipe ü§ù üëç
</issue_400_Falha no layout ao usar textos zalgo>

<issue_408_`ContentList`: conserta o "flicker" da data de publica√ß√£o e posi√ß√£o do n√∫mero do item>
# Contexto e Execu√ß√£o

Isso √© uma issue para registrar na Milestone 4 o trabalho iniciado por @omariosouto e lapidado por @aprendendofelipe no PR #406.

- Problema do flicker: #402 
- Problema dos n√∫meros: #403

>> Coment√°rio de filipedeschamps:
Post comemorativo: https://www.tabnews.com.br/filipedeschamps/novas-melhorias-remocao-do-flicker-na-data-posicao-dos-numeros-node-js-16-lts-sourceurl-e-nova-paginacao

@omariosouto @aprendendofelipe
</issue_408_`ContentList`: conserta o "flicker" da data de publica√ß√£o e posi√ß√£o do n√∫mero do item>

<issue_409_Falha ao tentar colocar um link na publica√ß√£o>
Ao tentar colcoar a fonte de uma publica√ß√£o n√£o foi possivel inserir. Recebia o seguinte erro:

"source_url" deve possuir uma URL v√°lida e utilizando os protocolos HTTP ou HTTPS."

Conforme na imagem abaixo:
![image](https://user-images.githubusercontent.com/47868559/170881021-ec661f8e-1073-4d72-bf38-4caad691c393.png)

>> Coment√°rio de aprendendofelipe:
O problema √© a quantidade de caracteres em "digital". O PR #411 corrige isso ao aceitar TLDs maiores do que 6 caracteres. Coloquei 18 caracteres, pois o maior que eu encontrei foi esse:
https://nic.northwesternmutual/
</issue_409_Falha ao tentar colocar um link na publica√ß√£o>

<issue_416_[Curiosidade] Ordena√ß√£o do Google>
Achei legal a forma que o Google ordena o conte√∫do do tabnews, ele prioriza usu√°rios que tem mais conte√∫do para os que tem menos:

J√° estamos com total de **122** p√°ginas indexadas pelo buscador:

![Captura de tela em 2022-05-30 00-09-13](https://user-images.githubusercontent.com/5334261/170910289-73e4ffcf-6c3f-4a0b-882b-5816ba39c1ea.png)

>> Coment√°rio de rodrigoKulb:
Finalizando
</issue_416_[Curiosidade] Ordena√ß√£o do Google>

<issue_417_Bug ao dar hover nas labels da p√°gina "Status">
As labels que cont√©m textos longos est√£o afetando a largura da p√°gina assim que acontece um hover.

![bug_pagina_status](https://user-images.githubusercontent.com/8277449/170916820-db75792c-2d12-4dd6-8e59-588387cdee95.gif)
#

>> Coment√°rio de filipedeschamps:
Comportamento interessant√≠ssimo üòÇ talvez a gente poderia remover por completo o autor e mensagem e s√≥ deixar o `SHA` para ter certeza quando um deploy foi aplicado de fato nas lambdas.

>> Coment√°rio de filipedeschamps:
Campo de mensagem removido pelo PR #418 ü§ù

>> Coment√°rio de aprendendofelipe:
O PR #425 prop√µe uma solu√ß√£o, caso seja de interesse manter a mensagem na p√°gina de status.
</issue_417_Bug ao dar hover nas labels da p√°gina "Status">

<issue_418_Atualiza vers√£o do Node.js para 16 LTS>
## Contexto e Execu√ß√£o

Isso √© uma issue para registrar na Milestone 4 o trabalho feito por @tembra no PR #407 que atualiza tanto nas lambdas quanto no CI e README a vers√£o do Node.js para 16 LTS.

>> Coment√°rio de filipedeschamps:
Post comemorativo: https://www.tabnews.com.br/filipedeschamps/novas-melhorias-remocao-do-flicker-na-data-posicao-dos-numeros-node-js-16-lts-sourceurl-e-nova-paginacao

@tembra
</issue_418_Atualiza vers√£o do Node.js para 16 LTS>

<issue_419_`source_url` aceitar TLD com at√© 18 caracteres>
## Contexto e Execu√ß√£o

Isso √© uma issue para registrar na Milestone 4 o trabalho feito por @aprendendofelipe no PR #415 que conserta um bug relacionado a URLs no `source_url`. A valida√ß√£o deste campo n√£o estava aceitando URLs com o TLD maior que 6 caracteres e foi ajustado para aceitar at√© 18 caracteres e resolver problemas como o #409 reportado por @vitoropereira.

Closes #409

>> Coment√°rio de filipedeschamps:
Post comemorativo: https://www.tabnews.com.br/filipedeschamps/novas-melhorias-remocao-do-flicker-na-data-posicao-dos-numeros-node-js-16-lts-sourceurl-e-nova-paginacao

@aprendendofelipe @vitoropereira
</issue_419_`source_url` aceitar TLD com at√© 18 caracteres>

<issue_420_Favicon transparente e respons√≠vel a Dark e Light Mode>
## Contexto e Execu√ß√£o

Isso √© uma issue para registrar na Milestone 4 o trabalho feito por @rodrigoKulb no PR #413 que deixa o `favicon` do TabNews transparente e respons√≠vel aos Dark e Light modes do sistema operacional.

>> Coment√°rio de filipedeschamps:
Post comemorativo: https://www.tabnews.com.br/filipedeschamps/novas-melhorias-remocao-do-flicker-na-data-posicao-dos-numeros-node-js-16-lts-sourceurl-e-nova-paginacao

@rodrigoKulb
</issue_420_Favicon transparente e respons√≠vel a Dark e Light Mode>

<issue_428_Sistema de artigos favoritos e poss√≠vel ranqueamento>
Como apontado pelo jack no post "sistema de salvar posts", alguns outros servi√ßos semelhantes costumam ter al√©m do sistema de favoritos, uma lista de leitura, a id√©ia desta issue √© trazer a funcionalidade de salvar uma lista pessoal de artigos favoritos dos usu√°rios e criar listas de leitura.

Um poss√≠vel uso destes favoritos (mas acredito que isso se encaixaria melhor com um sistema de like e dislike) seria de rankear os posts, deixando os posts com maior "qualidade" ou relev√¢ncia segundo a comunidade em uma lista com os 10 mais salvos da semana, 10 mais lidos, etc

Uma id√©ia pessoal que pode ser implementada em cima desta feature: compartilhamento de listas de leitura, assim como uma playlist no spotify ou no YouTube, dar a possibilidade de salvar e compartilhar listas de leitura
- Exemplo de caso: pedro pode criar uma lista de artigos com tutoriais e dicas sobre javascript para iniciantes, e quando marcelo, iniciante em javascript estiver buscando uma lista de refer√™ncias de estudo, pode utilizar e compartilhar para seus amigos a lista de pedro

>> Coment√°rio de filipedeschamps:
@eduardo-moro √≥tima sugest√£o, a feature de favoritos/salvar est√° bem popular e poderia sim evoluir para algo como as Playlists. Sobre o ranking, isso foi iniciado no algoritmo `best`, mas que por enquanto considera outras m√©tricas.

Em paralelo, estou fechando essa issue para centralizar aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda
</issue_428_Sistema de artigos favoritos e poss√≠vel ranqueamento>

<issue_432_Um sistema de notifica√ß√£o dentro do TabNews para notifica√ß√£o de respostas>
Seria muito √∫til se coloca-se um sistema de notifica√ß√£o dentro do TabNews.

>> Coment√°rio de aprendendofelipe:
Oi @gabrielmelodev, se a sugest√£o for uma notifica√ß√£o por e-mail, j√° foi implementada uma vers√£o em #331. Se pensa algo diferente, fale mais sobre...

>> Coment√°rio de gabrielmelodev:
Ol√° @aprendendofelipe tipo tinha pensado algo que quando algu√©m responde sua pergunta inv√©s de chegar por e-mail mostra no perfil do usu√°rio uma notifica√ß√£o que a sua pergunta deve uma resposta.

>> Coment√°rio de aprendendofelipe:
Boa @gabrielmelodev, tem [essa sugest√£o postada dentro do TabNews](https://www.tabnews.com.br/matheusfcw/4b71a7be-be8a-4d34-a1c2-d4818b1fb61f), mas √© bom deixar registrado aqui no GitHub tamb√©m.

>> Coment√°rio de filipedeschamps:
Turma, sugiro centralizar aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda

De qualquer forma, "notifica√ß√£o" √© um assunto que ficar√° vivo por um bom tempo ü§ù
</issue_432_Um sistema de notifica√ß√£o dentro do TabNews para notifica√ß√£o de respostas>

<issue_434_Ordenar coment√°rios pelos mais recentes>
## Contexto
Enquanto eu estava lendo o artigo <a href="https://www.tabnews.com.br/filipedeschamps/quem-deseja-acesso-ao-repositorio-privado-do-tabnews">Quem deseja acesso ao Reposit√≥rio Privado do TabNews?</a> que foi postado a 16 dias atr√°s, vi que os coment√°rios feitos por primeiro estavam no topo e isso me deu a impress√£o de que o post estava "abandonado" e que n√£o haviam mais intera√ß√µes (sendo que hoje mesmo foram feitos v√°rios coment√°rios).

------

## Sugest√£o
Deixar os coment√°rios mais recentes no topo, para que o usu√°rio n√£o tenha que ir at√© o final da p√°gina para poder ver se tem coment√°rios recentes e n√£o ter a impress√£o de que o post t√° "engessado".

>> Coment√°rio de aprendendofelipe:
Enquanto n√£o houver outra forma de ranqueamento das respostas, acho que a proposta faz todo sentido, pois fica coerente com a p√°gina inicial, em que os artigos mais novos est√£o no topo

>> Coment√°rio de filipedeschamps:
√ìtimo ponto @Dev-Lyh n√£o tinha pensado por esse lado, do conte√∫do parecer estagnado.

Dentro dessa Milestone, a Home ter√° seus conte√∫dos ranqueados (n√£o temos a f√≥rmula ainda, mas vai envolver possivelmente a rela√ß√£o entre as tabcoins que o conte√∫do recebeu versus desde quando ele foi publicado)... e isso deve ser replicado para os coment√°rios.

Mas seguindo o que o @aprendendofelipe falou, enquanto n√£o o houver esse ranqueamento, a ordem inversa faz muito mais sentido e de fato casa com a Home. Sugiro apenas deixar para o final da Milestone para decidir o que fazer. Se o ranking da Home for f√°cil de replicar para os coment√°rios, vamos aproveitar e fazer isso.. se n√£o, vamos inverter a ordem ü§ù

>> Coment√°rio de filipedeschamps:
Foi implementado o Rankeamento `best` na Home e Coment√°rios. Agora nessa atual Milestone iremos criar uma forma de voltar a listar por ordem decrescente de cria√ß√£o üëç
</issue_434_Ordenar coment√°rios pelos mais recentes>

<issue_435_Aten√ß√£o: vamos precisar reescrever o hist√≥rico no `main`>
No passado eu fiz um `squash` aqui pela interface do GitHub assumindo que ele iria criar uma mensagem de commit v√°lida e o meu erro foi n√£o fazer esse `squash` contra uma branch intermedi√°ria na qual passasse pelo `commitlint`, ent√£o isso foi para a `main` e o problema ressurgiu no PR #431 que trouxe um commit do passado e fez o `commitlint` reclamar de commits passados.

## Gostaria da avalia√ß√£o de voc√™s sobre os passos do que fazer

1. For√ßar o merge do PR #431 que n√£o tem nada a ver com a hist√≥ria
2. Todo mundo fazer um backup local da `main`.
3. Desabilitar a prote√ß√£o de `force push` contra a `main`.
4. Usar o `commitlint` local e reavaliar e reescrever todo hist√≥rico que estiver quebrado (usando o `rebase` com `reword` para alterar apenas a mensagem)
5. Fazer `force push` para a `main`.
6. Reativar a prote√ß√£o na `main`

## B√¥nus

J√° sugeriram isso no passado (e a √∫ltima vez que isso foi sugerido foi pelo @andrefd17 se eu n√£o me engano) que √© antes do push rodar o lint dos commits na m√°quina local da pessoa.

## Conclus√£o

Esse √© o caminho certo? Algu√©m j√° passou por isso no passado e tem alguma sugest√£o?

>> Coment√°rio de thadeucity:
Acho que n√£o √© prudente desabilitar o `force push` na `main`. 

Mesmo sendo a solu√ß√£o mais dolorosa, acho que a 4 seria a melhor para manter a boa organiza√ß√£o do projeto. 

Tamb√©m √© poss√≠vel salvar o `git diff` desses commits em um arquivo `.diff`, "remover" os commits fora de padr√£o e dar um `git apply` nos diffs commitando eles com uma mensagem, dessa vez dentro do padr√£o do projeto. Por√©m a hist√≥ria do git ficar√° um pouco suja tamb√©m

>> Coment√°rio de filipedeschamps:
Fala meu caro, acho que n√£o fui claro na minha mensagem inicial e refatorei ela, veja se agora ficou claro que era uma sugest√£o de passos a seguir ü§ù

Minha d√∫vida √© se a √∫nica forma de consertar a `main` √© com essa estrat√©gia.

>> Coment√°rio de thadeucity:
Opa Filipe, acabei me confundindo mesmo, falhei no meu lado da interpreta√ß√£o tamb√©m. Agora est√° bem claro e acredito que seja uma boa solu√ß√£o para o problema encontrado. Ser√° trabalhoso, mas acho que valer√° a pena. J√° fiz o backup da main no meu computador

>> Coment√°rio de filipedeschamps:
Show meu caro! Possivelmente vou fazer essa movimenta√ß√£o no domingo ü§ù

>> Coment√°rio de aprendendofelipe:
Vale a pena esse trabalho?

Se entendi direito, o problema s√≥ est√° ocorrendo porque o PR teve como base uma branch antiga. Um rebase nos commits do #431 usando a main atual n√£o resolve de maneira mais simples?

Se tiver algum outro PR com base em branch antiga, √© s√≥ fazer um rebase tamb√©m. E nos futuros PRs esses commits antigos n√£o devem causar problemas.

>> Coment√°rio de filipedeschamps:
> Se entendi direito, o problema s√≥ est√° ocorrendo porque o PR teve como base uma branch antiga.

No caso n√£o √© nem uma branch antiga, mas apenas 1 commit antigo que fez o `commitlint` reavaliar todos os commits dali para frente.

> Um rebase nos commits do #431 usando a main atual n√£o resolve de maneira mais simples?

Ent√£o, isso n√£o seria "resolver", no sentido de consertar o problema que est√° na `main`. Mas **sim**, um rebase "resolveria" o problema escondendo da vis√£o do commitlint os commits inv√°lidos.

> Vale a pena esse trabalho?

Essa pergunta me deixou pensando... e talvez n√£o valha n√£o (pelo menos n√£o no timing de estar no meio da Milestone) üëç 

Vamos ent√£o combinar duas coisas:
1. Na pr√≥xima Milestone que isso se apresentar um problema, ao final dela a gente mandatoriamente reescreve a `main`.
2. Vamos nessa Milestone (e em qualquer momento dela), implementar o [Husky](https://typicode.github.io/husky/) e colocar um pr√©-commit para passar o commitlint e rodar o auto-fix de code style. J√° recomendaram isso no come√ßo do projeto, o @andrefd17 j√° recomendou 10 vezes e agora entendo porque üòÇ 

O que acha?

>> Coment√°rio de aprendendofelipe:
> 1) Na pr√≥xima Milestone que isso se apresentar um problema, ao final dela a gente mandatoriamente reescreve a `main`.
> 2) Vamos nessa Milestone (e em qualquer momento dela), implementar o [Husky](https://typicode.github.io/husky/)...

Acho que √© o melhor a se fazer no momento üöÄ

>> Coment√°rio de filipedeschamps:
Fechad√≠ssimo ü§ù  E sua nova foto de perfil ficou √≥tima üòÇ üëç

>> Coment√°rio de aprendendofelipe:
> Fechad√≠ssimo ü§ù E sua nova foto de perfil ficou √≥tima üòÇ üëç

Esse simp√°tico do meu lado √© muito fotog√™nico... hahahahaha
</issue_435_Aten√ß√£o: vamos precisar reescrever o hist√≥rico no `main`>

<issue_437_Sugest√£o para perfil do usu√°rio>
N√£o seria melhor implanta√ß√£o da uma imagem de avatar para perfil. Cada pergunta j√° vir com a foto de perfil ou atribuir do GitHub que est√° utilizando. Ou Gravatar.

>> Coment√°rio de Cauen:
Acredito que uma breve descri√ß√£o tamb√©m seja uma boa

>> Coment√°rio de rodrigoKulb:
@gabrielmelodev e @Cauen concordo, talvez adicionar na Milestone 5

Aqui o link do conte√∫do previso nas pr√≥ximas Milestones

https://github.com/filipedeschamps/tabnews.com.br/issues/17

>> Coment√°rio de filipedeschamps:
Fechando esta issue, por estar relacionada com essa: #328
</issue_437_Sugest√£o para perfil do usu√°rio>

<issue_439_Slug: `children_deep_count` est√° sendo convertido para `childrendeepcount`>
Nada urgente, mas nossa atual fun√ß√£o que gera o slug est√° convertendo o t√≠tulo abaixo para slug da seguinte forma:

* T√≠tulo: `Testando children_deep_count`
* Slug atual: `testando-childrendeepcount`
* Slug correto: `testando-children-deep-count`

A fun√ß√£o abaixo deveria for√ßar a transforma√ß√£o de `_` para `-`:

https://github.com/filipedeschamps/tabnews.com.br/blob/d05287da2d03f6ab5c63ce5f2d4c6832fb6fff3c/models/content.js#L302-L310

>> Coment√°rio de filipedeschamps:
Fechado por #509
</issue_439_Slug: `children_deep_count` est√° sendo convertido para `childrendeepcount`>

<issue_441_[sugest√£o] Barra de busca para pesquisar conte√∫dos e discuss√µes>
N√£o encontrei nenhuma issue sobre esta funcionalidade, e acredito que seja muito importate pra a galera poder publicar seus conte√∫dos sem medo de estar duplicando algo j√° existente

De antem√£o, acredito que seja necess√°rio apenas:

1. Um campo de texto
2. Um checkbox "Buscar tamb√©m em coment√°rios"

O que acham?

>> Coment√°rio de filipedeschamps:
Estou fechando essa issue, por ter sido sugerida aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda
</issue_441_[sugest√£o] Barra de busca para pesquisar conte√∫dos e discuss√µes>

<issue_445_[Error] Arvore de dependencias com incompatibilidade de vers√µes entre primer e vers√£o utilizada do react>
*Descri√ß√£o:*
Basicamente quando tento fazer a instala√ß√£o recebo mensagem de erro quanto √†s dependencias, o erro pode ser visto abaixo.
Minha d√∫vida gira em torno de dois pontos: 
1 - Esse erro √© esperado? N√£o consegui encontrar nas issues
2 - Como devo prosseguir? Aparentemente posso utilizar o comando `--force`, mas tenho medo de quebrar algo ou posso fazer um downgrade da vers√£o do React (o que me parece uma ideia ainda pior, mas n√£o tenho experiencia suficiente para julgar)

*Erro encontrado:*

```
npm ERR! code ERESOLVE
npm ERR! ERESOLVE unable to resolve dependency tree
npm ERR!
npm ERR! While resolving: tabnews.com.br@1.0.0
npm ERR! Found: react@18.1.0
npm ERR! node_modules/react
npm ERR!   react@"18.1.0" from the root project
npm ERR!
npm ERR! Could not resolve dependency:
npm ERR! peer react@"^17.0.0" from @primer/react@35.2.1
npm ERR! node_modules/@primer/react
npm ERR!   @primer/react@"35.2.1" from the root project
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
```

*Comportamento esperado:*
Instala√ß√£o normal das dependencias

*Reprodu√ß√£o:*
`npm install`
Erro ocorre imediatamente ap√≥s tentativa de instalar as dependencias ap√≥s a clonagem do reposit√≥rio utilizando a branch "main".

*Configura√ß√µes utilizadas:*
- Windows 11 21H2
- PowerShell
- VSCode 1.6.7
- Ryzen 2600, 32gb
- NVM 1.1.8
- Node 16.15.1 (LTS)
- NPM 8.6.0

*Outras observa√ß√µes:*
Instala√ß√£o das dependencias foram concluidas normalmente utilizando o comando `--force`, do npm.

>> Coment√°rio de filipedeschamps:
Isso come√ßou a acontecer no CI sem motivo aparente algum. Eu n√£o estava conseguindo reproduzir na minha m√°quina, mas se deletar o `node_modules` consigo reproduzir. Confesso que n√£o fa√ßo a m√≠nima id√©ia do que est√° acontecendo e estou investigando aqui e aceito ajuda total ü§ù

>> Coment√°rio de aprendendofelipe:
Est√° intermitente... Deve ser s√≥ uma instabilidade no servi√ßo

>> Coment√°rio de filipedeschamps:
Ta muito estranho. Depois de deletar o `node_modules` consigo reproduzir o erro 100% das vezes, mas uma nova tentativa de rodar os testes l√° no CI do PR #444 ... passou.

Em paralelo to cavucando a internet sobre pessoas reclamando disso, mas n√£o estou encontrando muita coisa. Encontrei isso:

https://mobile.twitter.com/lianhuaspace/status/1534588363730460672

>> Coment√°rio de filipedeschamps:
E nada de incidente no status do npm: https://status.npmjs.org/

To muito confuso.

>> Coment√°rio de filipedeschamps:
@aprendendofelipe fa√ßa o teste deletando o node_modules, olha que interessante

>> Coment√°rio de aprendendofelipe:
Aqui n√£o consegui reproduzir nem apagando a node_modules... Talvez n√£o tenha um monte de reclama√ß√µes por ser alguma instabilidade no reposit√≥rio de alguma das depend√™ncias e n√£o um problema generalizado

>> Coment√°rio de guilfer-dev:
Eu j√° tive problemas com outros projetos migrando eles para o React 18
Muitas dependencias quebraram e a√≠ eu preferi ficar na vers√£o 17
O package.json do primer lista essa vers√£o inclusive: https://github.com/primer/react/blob/main/package.json
Tem uma issue aberta de tipos incompativeis, mas essa incomatibilidade n√£o parece se traduzir no que foi enfrentado: https://github.com/primer/react/issues/2065

Com o `--force`, nos poucos testes que tive, n√£o enfrentei quaisuqer probelmas na UI
O react veio instalado diretamente pela CLI do next, correto?

>> Coment√°rio de aprendendofelipe:
Aqui tamb√©m envolve o react@18.1.0 - https://github.com/supabase/ui/issues/350

Assim como 

> Encontrei isso:
> https://mobile.twitter.com/lianhuaspace/status/1534588363730460672

N√£o deve ser s√≥ coincid√™ncia

Aqui entre `npm ci` e `npm install` j√° foi mais de 10 vezes e nada de dar o problema

>> Coment√°rio de guilfer-dev:
> Aqui tamb√©m envolve o react@18.1.0 - [supabase/ui#350](https://github.com/supabase/ui/issues/350)
> 
> Assim como
> 
> > Encontrei isso:
> > https://mobile.twitter.com/lianhuaspace/status/1534588363730460672
> 
> N√£o deve ser s√≥ coincid√™ncia
> 
> Aqui entre `npm ci` e `npm install` j√° foi mais de 10 vezes e nada de dar o problema

Aqui os erros aconteceram em ambos os comandos.
Removi uma por uma as dependencias que inpediam o `npm install` e foram essas:
- "@primer/octicons-react": "17.1.0",
- "react-confetti": "6.0.1", 
- "@primer/react": "35.2.1",
- "recharts": "2.1.9",

No entanto, reinstalando-as manualmente, sem informar a vers√£o, as unicas que deram problema para instala√ß√£o foram as duas ultimas;

>> Coment√°rio de filipedeschamps:
@aprendendofelipe qual sua vers√£o do node?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe qual sua vers√£o do node?

v16.13.2

>> Coment√°rio de filipedeschamps:
Acho que √© isso, instalei aqui a `16.13.2` e funcionou 100% das vezes.

Se voc√™ instalar a √∫ltima LTS `16.15.1`, d√° erro 100% das vezes.

`nvm i --lts`

>> Coment√°rio de aprendendofelipe:
Nem com a `16.15.1` d√° erro aqui... Tentei duas vezes...

Tor√ßo para que amanh√£ tudo esteja normalizado... Boa noite turma!

>> Coment√°rio de filipedeschamps:
Eu vou e volto entre as vers√µes e o comportamento vai e volta! Muito doido! Mesmo fazendo um `npm cache clean --force`

Boa noite meu caro ü§ù

>> Coment√°rio de filipedeschamps:
Isolando mais o problema:

`16.15.0` - funciona 100%
`16.15.1` - funciona 0%

>> Coment√°rio de filipedeschamps:
@guilfer-dev force a utiliza√ß√£o da vers√£o `16.15.0` e veja se funciona ü§ù

>> Coment√°rio de guilfer-dev:
> @guilfer-dev force a utiliza√ß√£o da vers√£o `16.15.0` e veja se funciona ü§ù

Tentei usar a vers√£o 16.15.0 e 16.13.2, ambas obtive os mesmos erros, tanto para `npm ci`, quanto para `npm install`, limpei o cache do npm e n√£o deu certo tamb√©m; deletei o lockfile, mas sem resultados positivos.

Qual vers√£o do npm voc√™s est√£o utilizando? **(isso pode ser importante)**

Por curisosidade fiz o teste usando o yarn enquanto eu estava utilizando a vers√£o 16.15 do node e obtive essa mensagem:
```
error tabnews.com.br@1.0.0: The engine "node" is incompatible with this module. Expected version "16.15.0". Got "16.13.2"
error Found incompatible module.
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
```

Seguindo a orienta√ß√£o, passando para essa vers√£o do node 16.15.0 e utilizando do yarn v1.22.15 funcionou corretamente.

```
[5/5] Building fresh packages...
success Saved lockfile.
Done in 137.73s.
```

Sem sucesso para o npm, no entanto.

>> Coment√°rio de filipedeschamps:
Esse assunto est√° ficando cada vez mais interessante.

>> Coment√°rio de rodrigoKulb:
Eu tamb√©m recebi a mensagem de erro:
![Captura de tela em 2022-06-12 10-03-42](https://user-images.githubusercontent.com/5334261/173234662-0f41fac9-1fd4-439a-bafc-79ff88ed74eb.png)

utilizando o force funcionou com WARN

![Captura de tela em 2022-06-12 10-09-08](https://user-images.githubusercontent.com/5334261/173234780-c638aaaf-640f-4bba-8728-055d55542b57.png)

Achei uma discuss√£o sobre o assunto semelhante:
https://stackoverflow.com/questions/64718633/unable-to-resolve-dependency-tree-reactjs

>> Coment√°rio de rodrigoKulb:
@filipedeschamps dei um force no package.json com a vers√£o do "react": "17.0.2" e o erro parou, apaguei o package-lock.json.

Sabe se atualizamos essa vers√£o recentemente no projeto?
![Captura de tela em 2022-06-12 13-07-02](https://user-images.githubusercontent.com/5334261/173242545-9112ce6f-0a19-463e-a0b7-36e3176c9114.png)

Mesmo utilizando o node v16.15.1

>> Coment√°rio de filipedeschamps:
@rodrigoKulb n√£o me lembro, acho que foi quando atualizamos o Next.js. Posso estar enganado, mas esse problema de √°rvore n√£o foi causado por uma atualiza√ß√£o que fizemos no package.json, nem quando atualizamos o Node.js para 16. Esse problema come√ßou do nada (o CI come√ßou a quebrar sem motivo algum).

Em paralelo, voc√™ est√° usando a vers√£o `16.15.0`? Aqui e no CI pararam de dar problema com ela.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps realmente utilizando o node vers√£o 16.15.0 funciona perfeitamente, o complicado que a vers√£o LTS indicada no site √© a 16.15.1. 

Ser√° um bug da nova vers√£o?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb eu acho que sim, pelo menos algum comportamento estranho que come√ßou a acontecer do nada, e como no CI usamos o `package-lock.json`, a √∫nica coisa que poderia ter atualizado sem nossa interven√ß√£o √© a vers√£o do Node.js (que n√£o estava pinada, como est√° agora). Mas a gente deveria despinar depois que passar essa fase estranha para ganharmos automaticamente os patches de seguran√ßa ü§ù

>> Coment√°rio de rafa-thayto:
@filipedeschamps tenho duas solu√ß√µes pra esse problema, ainda bem que j√° tinha uma issue disso, bom...

**Primeira solu√ß√£o:**
Abaixar a vers√£o do `react` e `react-dom` pra `17.0.2`e aguardar o time do `@primer/react` dar suporte a nova vers√£o do `react`. _(Melhor solu√ß√£o na minha vis√£o, vou explicar o pq na pr√≥xima solu√ß√£o)_

**Segunda solu√ß√£o:**
Trocar o gerenciador de pacotes para o yarn e adicionar o `resolutions` dentro do `package.json` que basicamente fala pro yarn que ele deve for√ßar com que todo mundo que usa o react tem que usar a vers√£o `18.1.0` isso faz com que n√£o tenhamos problema de `more react instances` na mesma aplica√ß√£o e resolvamos o problema de `Could not resolve dependency`, por√©m... Pode causar uma s√©rie de efeitos colaterais, pois essa vers√£o nova do React est√° causando um problema de rodar o useEffect 2 vezes quando t√° no modo `React.StrictMode`
```json
"resolutions": {
    "react": "18.1.0",
    "react-dom": "18.1.0"
}
```

>> Coment√°rio de filipedeschamps:
@rafa-thayto sensacional, obrigado pela pesquisa! Desde a sua publica√ß√£o, o time do GitHub lan√ßou novas vers√µes do Primer, precisamos conferir se algo foi feito sobre isso pelo lado deles, mas se n√£o foi, topo voltar a vers√£o do React como voc√™ sugeriu. E tamb√©m o time da Vercel lan√ßou novas vers√µes do Next.js, precisamos ver se h√° influ√™ncia nessa equa√ß√£o tamb√©m, dado que eles est√£o pesando bastante no React 18 üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps ando um pouco corrido por aqui, mas com muita saudade de interagir no projeto tabnews!
Acabei de precisar instalar novamente o projeto, acredito que devido ao tempo para resolver o problema de depend√™ncias do projeto e como o arquivo packge.json est√° utilizando a vers√£o "16.15.0" acho v√°lido adicionar essa informa√ß√£o no readme o que acha?

Voc√™ precisa ter duas principais depend√™ncias instaladas:

- Node.js v16.15.0  (conforme informado na Issue [#445](https://github.com/filipedeschamps/tabnews.com.br/issues/445))
- Docker Engine v17.12.0 com Docker Compose v1.24.1 (ou qualquer vers√£o superior)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show! Vamos tentar uma √∫ltima vez antes de atualizar o README por conta da solu√ß√£o do @rafa-thayto 

> **Primeira solu√ß√£o:**
> Abaixar a vers√£o do `react` e `react-dom` pra `17.0.2`e aguardar o time do `@primer/react` dar suporte a nova vers√£o do `react`.

@rafa-thayto matou a pau!!! Rodei `npm i react@17.0.2 react-dom@17.0.2` e instalou perfeito, at√© na √∫ltima vers√£o `LTS` do Node.js üëç 

Vou mandar um PR s√≥ com o downgrade do React e vamos ver o que vai acontecer no ambiente de homologa√ß√£o ü§ù

>> Coment√°rio de filipedeschamps:
Downgrade do React rodando em: https://tabnews-git-react-tabnews.vercel.app/

>> Coment√°rio de filipedeschamps:
Turma, feito o merge do downgrade e ent√£o j√° est√° na branch `main` e em produ√ß√£o. Quem puder fazer um pull e avaliar se o `npm i` est√° funcionando em outras vers√µes do Node.js fora a `v16.15.0` seria show ü§ù  aqui estou na `LTS` `v16.16.0` e est√° 100% üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps aqui deu certo s√≥ precisa tirar o `required: { node: '16.15.0' },`

```
  "engines": {
    "node": "16.15.0"
  },
```

Tinha comentando isso aqui üòÖÔ∏è https://github.com/filipedeschamps/tabnews.com.br/issues/445#issuecomment-1153221658

>> Coment√°rio de filipedeschamps:
Ahh que massa!! Show!!

E sugiro n√£o tirar o `required`, vamos fazer ela voltar a ter o valor `16` que foi a implementa√ß√£o do @tembra para sempre ficarmos na LTS ü§ù 

Vou continuar atualizando todas as depend√™ncias amanh√£ üëç

>> Coment√°rio de filipedeschamps:
Agora que percebi que na publica√ß√£o de melhoria dessa segunda-feira eu n√£o listei que atualizamos todas as depend√™ncias e consertamos esse problema. Bom, vou deixar agendado para anunciar na pr√≥xima semana, mas o mais importante √© que est√° tudo atualizado e rodando ü§ù üëç üòç 

Qualquer problema, pe√ßo que reabram essa issue ou criem uma nova ü§ù
</issue_445_[Error] Arvore de dependencias com incompatibilidade de vers√µes entre primer e vers√£o utilizada do react>

<issue_446_Tem uma falha no TabNews>
Quando o usu√°rio n√£o est√° logado ou n√£o fez cadastro ele consegue acessar a p√°gina 
www.tabnews.com.br/publicar est√° p√°gina n√£o tinha que ser bloqueada e ser exibida somente para usu√°rio que fez o login?

>> Coment√°rio de alangabrielbs:
Pelo que parece n√£o √© uma falha, √© um fluxo de entrada para novos usu√°rios, voc√™ cria seu post, clica em publicar e vai para tela e login, isso faz com que o usuario j√° crie sua conta para conseguir publicar.

e tambem vai cair no sentimento de "se eu n√£o logar/criar conta, vou perder o que eu digitei, ent√£o vou criar minha conta"

>> Coment√°rio de aprendendofelipe:
√â proposital! üòâ

> e tambem vai cair no sentimento de "se eu n√£o logar/criar conta, vou perder o que eu digitei, ent√£o vou criar minha conta"

N√£o foi com essas palavras üòÖ, mas o que eu pensei no momento foi o que postei [aqui](https://github.com/filipedeschamps/tabnews.com.br/pull/385#commitcomment-74339479)

> estimulando a cria√ß√£o do conte√∫do e deixando a preocupa√ß√£o com login para depois de clicar em "Publicar"

O que permitiu fazer isso foi a implementa√ß√£o do armazenamento dos rascunhos, pois assim o usu√°rio n√£o perde o que tinha escrito ao redirecionar para login.

>> Coment√°rio de filipedeschamps:
No passado, ao acessar essa rota (ou o modo de edi√ß√£o de uma resposta), aparecia essa mensagem:

https://tabnews-euzimccgo-tabnews.vercel.app/publicar (deploy antigo em homologa√ß√£o)

<img width="995" alt="image" src="https://user-images.githubusercontent.com/4248081/172909063-314cbf4b-19c0-4e3d-99f7-0daddf821878.png">

Com essa nova feature de anotar o rascunho em localStorage, veio essa feature do clique redirecionar como o pessoal comentou, e agora que percebi que nunca tinha respondido o @aprendendofelipe no post ali que ele destacou üòÇ üëç 

Mas pensando agora, talvez assim como o bot√£o de "Responder" manda direto para o `/login` (com o retorno autom√°tio), ao acessar o `/publicar` sem estar logado, deveria ter o mesmo comportamento (ainda mais quando tivermos a feature do `user` no localStorage, que o feedback vai ser bem r√°pido).

>> Coment√°rio de aprendendofelipe:
> agora que percebi que nunca tinha respondido...

Relaxa @filipedeschamps üòÇ imagino o qu√£o intensa deve estar sua rotina... üí™

> Mas pensando agora, talvez assim como o bot√£o de "Responder" manda direto para o `/login` (com o retorno autom√°tio), ao acessar o `/publicar` sem estar logado, deveria ter o mesmo comportamento (ainda mais quando tivermos a feature do `user` no `localStorage`, que o feedback vai ser bem r√°pido).

N√£o tem nenhum bot√£o que leve para a p√°gina `/publicar` dispon√≠vel sem o usu√°rio estar logado. Pensa em redirecionar para o `/login` caso n√£o encontre o `user` no `localStorage` ap√≥s o render da p√°gina est√°tica? S√≥ me confirma que coloco no passo 2 ou 3 l√°

>> Coment√°rio de filipedeschamps:
> N√£o tem nenhum bot√£o que leve para a p√°gina /publicar dispon√≠vel sem o usu√°rio estar logado. Pensa em redirecionar para o /login caso n√£o encontre o user no localStorage ap√≥s o render da p√°gina est√°tica?

Correto üëç  Mesmo n√£o existindo nenhum fluxo feliz que exponha o usu√°rio a essa rota, existem os fluxos malucos da vida real üòÇ

>> Coment√°rio de aprendendofelipe:
> existem os fluxos malucos da vida real üòÇ

Simmm, por isso mesmo eu jamais redirecionaria algu√©m com tanta √¢nsia de publicar... üòÇüòÇüòÇ

Guardadas as particularidades de cada caso, √© como as lojas online que s√≥ pedem o login depois que o usu√°rio j√° se comprometeu com a compra üòâ

Se n√£o surgirem mais opini√µes e sugest√µes, at√© o t√©rmino da implementa√ß√£o do cache de usu√°rio eu fa√ßo isso üëç

>> Coment√°rio de gabrielmelodev:
As rotas tinha que ser  como o modelo do Twitter as rotas p√∫blicas s√£o somente para ver o perfil do usu√°rio se voc√™ quiser ver outras coisas voc√™ tem que fazer o login ou cadastro se voc√™ clicar em qualquer √°rea da p√°gina ele j√° verificar se tem login se n√£o ela j√° manda logo para tela de login ou avisar em um di√°logo para voc√™ fazer login colocando Rotas Privadas nas p√°ginas que n√£o pode ser exibidas na √°rea de edi√ß√£o de perfil ela tem que ser Privada a onde o usu√°rio n√£o logado n√£o pode visualizar a informa√ß√£o.

>> Coment√°rio de filipedeschamps:
Atrav√©s do PR #440 do @aprendendofelipe √© feito um redirect para a p√°gina de login.
</issue_446_Tem uma falha no TabNews>

<issue_447_A features da edi√ß√£o de perfil>
![image](https://user-images.githubusercontent.com/50870406/172870398-2d3130c8-a484-43f6-9240-c3d327ef85fb.jpeg)

Est√° features vai ser criada?

>> Coment√°rio de filipedeschamps:
Sim, em paralelo j√° deixa eu aproveitar para perguntar: o que voc√™ gostaria de editar hoje?

>> Coment√°rio de rodrigoKulb:
@filipedeschamps meu nome de usu√°rio acabou ficando somente **rodrigo** queria deixar **rodrigoKulb**, possivel?
E-mail acho uma informa√ß√£o importante de alterar, porem bem sens√≠vel.

Outro ponto que observei √© que utilizamos o **login** para apresentar como autor das publica√ß√µes e n√£o o nome, procurei algumas referencias, segue abaixo:
github: login
youtube: nome
medium: nome
instagram: login

O que voc√™ acha sobre isso?

Pensando nisso n√£o estamos utilizando o nome para nada, o que acha de colocar como TITLE dessa p√°gina:
https://www.tabnews.com.br/gugadeschamps
Isso podemos seguir na #393

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show, caso queira, por enquanto voc√™ pode alterar o `username` mandando um `PATCH` para o `/api/v1/users/[username]`:


```js
// PATCH -> https://www.tabnews.com.br/api/v1/users/rodrigo

{
  "username": "rodrigoKulb"
}
```

Lembre-se de enviar o token de sess√£o. Se voc√™ se logar pelo Thunder Client batendo na rota `/session`, ele vai guardar o token e enviar automaticamente na pr√≥xima requisi√ß√£o.

---

Em paralelo, sua sugest√£o √© al√©m do `username`, guardar algo como o `display_name` do usu√°rio?

>> Coment√°rio de rodrigoKulb:
> Em paralelo, sua sugest√£o √© al√©m do `username`, guardar algo como o `display_name` do usu√°rio?

Na verdade confundi o tabnews n√£o tem o nome **do** usu√°rio e somente o nome **de** usu√°rio.
Talvez podemos estudar se √© algo importante para um futuro.

Exemplo:
Nome **de** usu√°rio: **filipedeschamps** 
Nome **do** usu√°rio: **Filipe Deschamps**

>> Coment√°rio de gabrielmelodev:
> Sim, em paralelo j√° deixa eu aproveitar para perguntar: o que voc√™ gostaria de editar hoje?

Gostaria de realizar altera√ß√£o no endere√ßo de e-mail

>> Coment√°rio de filipedeschamps:
@gabrielmelodev infelizmente por enquanto n√£o √© poss√≠vel, n√£o implementamos o fluxo de confirma√ß√£o do novo email.

>> Coment√°rio de rodrigoKulb:
Estou com um usu√°rio preso utilizando o nome rodrigoKulb alterei para rodrigoKu1b com 1

Deu certo! ü§©Ô∏è

![Captura de tela em 2022-06-09 16-12-37](https://user-images.githubusercontent.com/5334261/172925896-89fdb6e1-cd96-4f53-9362-1af35c8fdbdf.png)

>> Coment√°rio de joaogelado:
Estava pensando em poder fazer essas coisas:

- Trocar de e-mail
- Trocar de username (j√° implementado no back)
- Trocar de senha
- Aceitar ou recusar features beta
- Enviar ou n√£o notifica√ß√µes por e-mail (ou at√© push no caso de um aplicativo)

>> Coment√°rio de filipedeschamps:
@joaogelado muito obrigado meu caro, tomei nota aqui do meu lado, mas queira registrar isso no TabNews estamos centralizando aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda
</issue_447_A features da edi√ß√£o de perfil>

<issue_449_Curiosidade: Vercel est√° rodando Lambdas do TabNews em duas vers√µes>
Olhando o https://www.tabnews.com.br/status agora, olha s√≥ o que eu peguei em Produ√ß√£o üòÇ  fica olhando para o √∫ltimo campo **Vers√£o do Node.js** (essa se√ß√£o √© atualizada a cada 1 segundo):

https://user-images.githubusercontent.com/4248081/172901120-e1c857cb-6880-4fed-bb98-3fb60403ed21.mov

>> Coment√°rio de guilfer-dev:
Eu nem sabia que isso era poss√≠vel
@filipedeschamps, em sua pesquisa chegou a ver alguem falando sobre?
Sera que isso foi especifico por conta do framework, ou se tivessemos usado React puro, isso poderia ter acontecido?
Cada dependencia tem sua lockfile, n√£o sei como o npm ou yarn gerenciam isso, mas que deve dar uma dorzinha de cabe√ßa manter essas coisas sem bug... ahh, isso deve!

Estou utilizando o yarn no ambiente e por curiosidade, contei as lockfiles geradas no node_modules: 13; E dentre elas encontrei um script da Vercel chamado patch-incorrect-lockfile.js.

>> Coment√°rio de filipedeschamps:
> @filipedeschamps, em sua pesquisa chegou a ver alguem falando sobre?
Sera que isso foi especifico por conta do framework, ou se tivessemos usado React puro, isso poderia ter acontecido?
Cada dependencia tem sua lockfile, n√£o sei como o npm ou yarn gerenciam isso, mas que deve dar uma dorzinha de cabe√ßa manter essas coisas sem bug... ahh, isso deve!

Ent√£o, parece que estabilizou, n√£o fa√ßo a m√≠nima ideia do que est√° acontecendo ü§ù 

> Estou utilizando o yarn no ambiente e por curiosidade, contei as lockfiles geradas no node_modules: 13; E dentre elas encontrei um script da Vercel chamado patch-incorrect-lockfile.js.

Que interessante ü§ù üëç
</issue_449_Curiosidade: Vercel est√° rodando Lambdas do TabNews em duas vers√µes>

<issue_454_Husky: pre-commit hooks>
Issue para marcar na Milestone 4 que o @andrefd17 implementou o Husky atrav√©s do PR #451 pelo que foi combinado na issue #435 sobre a `main` estar quebrada no CI.

>> Coment√°rio de filipedeschamps:
@andrefd17 voc√™ foi citado no post comemorativo: https://www.tabnews.com.br/filipedeschamps/novas-melhorias-husky-sistema-de-eventos-firewall-e-melhorias-no-seo üéâ
</issue_454_Husky: pre-commit hooks>

<issue_456_[Feature] Tabnews for new tabs>
**Feature:**
P√°gina "/random", ou similar, para em que haja um ponto de entrada para pessoas que gostariam de utilizar o tabnews como sua pagina inicial do navegador ou para curiosos que gostariam de ver uma publica√ß√£o sem se comprometer em olhar a lista de postagens do tabnews.

**Esta feature relacionada √† algum problema?**
N√£o

**Alternativas consideradas**
N√£o foram consideradas alternativas

**Contexto adicional**
Essa feature foi sugerida em uma postagem minha no proprio tabnews, o texto original pode ser encontrado [aqui](https://www.tabnews.com.br/guilfer/sugestao-de-feature-tabnews-in-new-tabs), em resumo, utilizando como inspira√ß√£o o "Tab for a cause", podemos criar uma p√°gina que venha a servir como ponto de entrada para artigos relevantes ao usu√°rio, mas sem exigir que n√£o ele se comprometa em acessar o site completo, num estilo "frase do dia", ou nesse caso "tab do dia".

>> Coment√°rio de filipedeschamps:
@guilfer-dev um dos princ√≠pios por tr√°s do *Tab* no nome TabNews veio da vontade de querer fazer um site onde a pessoa possa deixar a aba aberta no navegador üòç tanto que ao voltar para a Home em uma aba que j√° estava aberta, a Home atualiza sozinha.

Ent√£o isso est√° super alinhado com sua sugest√£o, bastaria saber qual publica√ß√£o mostrar. De qualquer forma, vou fechar essa issue pois estou organizando o reposit√≥rio em issues que podemos atacar na pr√≥xima Milestone e caso acredite ser importante desenvolver ela, sugiro cadastrar aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda ü§ù
</issue_456_[Feature] Tabnews for new tabs>

<issue_457_Mais um bug no `source_url` sobre URL inv√°lida>
Esse foi pego pelo @gugadeschamps e a URL problem√°tica √© essa: https://t.me/durov/186

![image](https://user-images.githubusercontent.com/4248081/173588861-2dc8f10b-56c7-4c0e-94ab-9524e45251d0.png)

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, n√£o encontrei nenhum regex que funcionasse direito para os padr√µes atuais, ent√£o fiz essa vers√£o:

`^(((http(s)?)|(HTTP(S)?)):\/\/)?(([-\p{L}\d_])+[.])*([-\p{L}\d_])+([-]+([\p{L}\d_])+)*\.[a-zA-Z]{2,18}(:[0-9]{1,5})?(\/.*)?`

Testei bastante, mas recomendo que testem tamb√©m. E se tiver algu√©m que entenda mais de regex, por favor, d√™ uma boa analisada.

>> Coment√°rio de filipedeschamps:
1. Sua imagem de perfil est√° cada vez melhor.
2. Escrevendo um teste adicional com a URL que deu problema para n√£o termos mais regress√£o nela, e o teste das outras URLs passarem, n√£o vejo problema usar essa. 
3. Talvez a gente deveria usar a valida√ß√£o do Joi, que na √©poca eu descartei porque achei ela muito solta, mas talvez seja o caminho para evitar atritos assim: https://joi.dev/api/?v=17.6.0#stringurioptions

>> Coment√°rio de aprendendofelipe:
Se ningu√©m resolver antes, pego nisso at√© o fim do feriad√£o üòâ
</issue_457_Mais um bug no `source_url` sobre URL inv√°lida>

<issue_458_Tem este erro aqui no TabNews>
Quando voc√™ est√° logado ou deslogado voc√™ conseguir entra nesta tela ainda

![image](https://user-images.githubusercontent.com/50870406/173705828-233eb884-5423-4e47-9c82-7c89f383ebf8.png)

![image](https://user-images.githubusercontent.com/50870406/173705847-f7034c09-83fc-4748-87bc-a6b0c48c782e.png)

>> Coment√°rio de gabrielew:
Acredito que n√£o chega a ser um erro em si, √© apenas um rota que possui esse texto ai. Pelo que eu me lembre, ela n√£o dispara nenhuma a√ß√£o.
</issue_458_Tem este erro aqui no TabNews>

<issue_461_[Conte√∫dos] Armazenar (e talvez tamb√©m exibir) o hist√≥rico de edi√ß√µes>
Eu n√£o consegui encontrar no escopo do projeto (ainda n√£o familiarizado), mas gostaria de saber se j√° h√° um planejamento para mostrar edi√ß√µes realizadas por usu√°rios ou moderadores.

Sei que √© poss√≠vel que o OP ou moderadores realizem mudan√ßas nas publica√ß√µes e coment√°rios; nesse sentido acho que seria interessante haver um registro historico das edi√ß√µes e, talvez,  uma tag de quem e por qu√™ realizou as edi√ß√µes (talvez no estilo do stackoverflow?), assim seria poss√≠vel ajudar na coerencia de algumas discuss√µes que acabam se tornando mais longas e passam a fazer menos sentido depois de edi√ß√µes (ex: https://www.tabnews.com.br/NathanFirmo/o-tabnews-esta-vulnera-vel-a-ataques-xss), al√©m √© claro de aumentar a transparencia (e a percep√ß√£o dela) na plataforma.

Se essa discuss√£o for pra frente (e imagino que o @filipedeschamps e outros j√° tenha pensando sobre), eu posso criar a issue da feature e come√ßar a trabalhar nela tamb√©m, nunca trabalhei com versionamento e seria interessante para o meu aprendizado, mas gostaria de estressar o assunto aqui antes de colocar a m√£o na massa.

Alguns assuntos relacionados, mas que n√£o elaborei o suficiente:
- Filtro de spam/alerta baseado em keywords ou contextos
- Avisos e eventual banimento quando as publica√ß√µes n√£o estiverem de acordo com as politicas da comunidade (ou do bom senso)
- Sugest√£o de tema comum baseado no titulo (para evitar duplicatas e enriquecer discuss√µes anteriores, ao inv√©s de recome√ßar)
- Tags para o assunto (podemos tentar implementar algo provis√≥rio, usando \\# por exemplo e parseando antes da publica√ß√£o, pois j√° h√° bastante conte√∫do muito legal e que ter√° um valor hist√≥rico interessante para o projeto)

>> Coment√°rio de filipedeschamps:
@guilfer-dev show meu caro, eu tamb√©m acredito que um hist√≥rico de edi√ß√£o √© uma feature sensacional!

Antes de iniciar qualquer tipo de implementa√ß√£o, sugiro discutirmos aqui quais alternativas temos para arquitetar isso. Voc√™ j√° pensou em alguma? Inclusive, precisamos pensar quais campos ser√£o versionados, isto √© o que o objeto tem hoje:

```json
  {
    "id": "5e56a78d-eff5-46f7-9d6c-614a9c5aa76b",
    "owner_id": "07ea33ea-78bd-4578-bad2-1cf5323cab07",
    "parent_id": null,
    "slug": "encerramento-milestone-4-ao-vivo-agora",
    "title": "Encerramento Milestone 4: Ao vivo agora üõë",
    "body": "Turma, estou ao vivo nesse exato momento para o encerramento da Milestone 4!\n\nO link para acesso √© esse: https://youtu.be/T-mXz4uxCwk",
    "status": "published",
    "source_url": null,
    "created_at": "2022-07-08T17:00:52.288Z",
    "updated_at": "2022-07-08T17:00:52.288Z",
    "published_at": "2022-07-08T17:00:52.321Z",
    "deleted_at": null,
    "username": "filipedeschamps",
    "parent_title": null,
    "parent_slug": null,
    "parent_username": null,
    "tabcoins": 23,
    "children_deep_count": 7
  },
```

De largada penso em `title`, `body`. Mas iremos tamb√©m versionar `source_url`, `slug`, `status`? Outra coisa que precisamos pensar √© como expor isso na API p√∫blica de uma forma que continue simples de consumir. Talvez separar o que √© o state atual do hist√≥rico?

>> Coment√°rio de aprendendofelipe:
> precisamos pensar quais campos ser√£o versionados

Que tal manter o hist√≥rico de vers√£o de todos os campos? Para isso, uma op√ß√£o √© praticamente "clonar" o objeto que est√° sendo editado, mudando s√≥ o `id`, o `"status": "edited"` e adicionando dois campos, uma refer√™ncia para o `original_id` e o `edited_at` que teria que entrar no `constraint` `unique` da mesma forma que o `deleted_at`.

Com isso n√£o muda nada na forma de consumir a vers√£o publicada, mas ser√° preciso mudar o processo de edi√ß√£o de conte√∫do e implementar a consulta das vers√µes obsoletas.

>> Coment√°rio de guilfer-dev:
@filipedeschamps  a ideia era discutir mesmo, nunca realizei esse tipo de tarefa e n√£o sei por onde come√ßar.
Acredito que haja literatura sobre o assunto e, embora meu tempo livre tenha dado uma apertada, vou procurar para que tenhamos uma discuss√£o produtiva.
Minha hipotese √© que haja um parseamento com as mudan√ßas que ocorreram, algo tipo o que o proprio git faz, assim n√£o precisa ficar duplicando infoma√ß√£o, apenas os metadados das altera√ß√µes, e a√≠ seria poss√≠vel t√°mbem reconstruir a mensagem e destacar com outros formatos as altera√ß√µes.
Acredito que os campos que voce sugeriu sejam os melhores e suficientes, s√≥ n√£o acho que o status precisa ser versionado, s√≥ mudado para "edited", pois todos os outros status v√£o ser o mesmo a partir da√≠. Concorda?

E pensando agora, n√£o tem nada a ver, mas acredito n√£o ser necess√°rio criar outra topico pra isso: voce pretende colocar telemetria (ou j√° existe?) para o engajamento dos posts e o ganho de tabcoins? Algo como √© feito com o youtube pra que o criador de conte√∫do tenha melhor no√ß√£o e possa adaptar suas estrategias?

>> Coment√°rio de filipedeschamps:
> E pensando agora, n√£o tem nada a ver, mas acredito n√£o ser necess√°rio criar outra topico pra isso: voce pretende colocar telemetria (ou j√° existe?) para o engajamento dos posts e o ganho de tabcoins? Algo como √© feito com o youtube pra que o criador de conte√∫do tenha melhor no√ß√£o e possa adaptar suas estrategias?

N√≥s temos um sistema de eventos que anota algumas a√ß√µes dos usu√°rios e isso pode ser usado como base para esse sistea eu acredito ü§ù  mas por hora nenhum plano detalhado sobre isso foi desenvolvido üëç

>> Coment√°rio de guilfer-dev:
Ontem encontrei esse artigo na wikip√©dia sobre o assunto.
Achei bastante interessante e, at√© que completo.
https://en.wikipedia.org/wiki/Diff

Acabei n√£o conseguindo explorar mais, mas deixo aqui como material para discuss√£o.
</issue_461_[Conte√∫dos] Armazenar (e talvez tamb√©m exibir) o hist√≥rico de edi√ß√µes>

<issue_464_Curiosidade: TabNews tomou mais um "ataque">
Analisando os logs mais profundamente, parece ter sido um problema de integra√ß√£o do que ataque de fato, porque foi feito um n√∫mero descontrolado de requests contra o endpoint `/api/v1/contents`, tudo vindo do Brasil e usando o [OkHttp](https://github.com/square/okhttp). Por isto estou abrindo essa issue caso a pessoa esteja dentro desse reposit√≥rio e precise de ajuda na integra√ß√£o.

<img width="573" alt="image" src="https://user-images.githubusercontent.com/4248081/174356322-d0a73bc8-7928-4041-9f05-fd5da3b4ecbc.png">

>> Coment√°rio de rodrigoKulb:
@filipedeschamps talvez algo que podemos implementar √© um tipo de User-Agent nas apis, obrigando o usu√°rio colocar essa informa√ß√£o para consumir a api.

**Exemplo:**
User-Agent: sitetabnews
User-Agent: appDoRodrigo
User-Agent: testeDoFulano

>> Coment√°rio de aprendendofelipe:
Ser√° que n√£o vale a pena implementar algo como esse exemplo da pr√≥pria Vercel?

https://github.com/vercel/next.js/tree/canary/examples/api-routes-rate-limit

Demo: https://nextjs-rate-limit.vercel.app/
</issue_464_Curiosidade: TabNews tomou mais um "ataque">

<issue_466_[Sugest√£o] Deixar uma branch fixa para deploy no ambiente de homologa√ß√£o>
@filipedeschamps j√° pensou em deixar criada uma branch espec√≠fica para fazer o deploy em ambiente de homologa√ß√£o?

#### Vantagens
1. N√£o seria necess√°rio criar os PRs duplicados apenas para for√ßar o deploy na Vercel, pois seria s√≥ voc√™ fazer o merge nessa branch espec√≠fica de homologa√ß√£o.
2. Poderia deixar configurado na Vercel um endere√ßo mais amig√°vel vinculado com essa branch. Pode ser um subdom√≠nio de vercel.app ou at√© mesmo do tabnews.com.br, caso queira.
3. Uma URL fixa para o ambiente de homologa√ß√£o facilita muito para quem est√° sempre acessando esse ambiente, pois permite deixar um atalho no navegador, e manter a sess√£o e os rascunhos entre diferentes deploys.

#### Permaneceria igual
1. Cada deploy ainda vai gerar o seu pr√≥prio endere√ßo, que permanece salvo enquanto n√£o for exclu√≠do na Vercel, mas esse endere√ßo s√≥ ser√° necess√°rio em situa√ß√µes espec√≠ficas, como em compara√ß√£o de comportamentos entre diferentes vers√µes.
2. Fora a elimina√ß√£o dos PRs duplicados, o fluxo de colabora√ß√£o que j√° ocorre n√£o deve ser alterado.

#### Pequena desvantagem (se √© que podemos chamar assim)
1. Por enquanto as URLs criadas para cada deploy em homologa√ß√£o est√£o restritas aos usu√°rios com acesso ao reposit√≥rio privado, mas ainda assim elas podem ser compartilhadas e acessadas por outras pessoas. Um endere√ßo fixo facilita esse compartilhamento externo.

>> Coment√°rio de filipedeschamps:
Acho uma id√©ia genial @aprendendofelipe !!! Todos os pontos que voc√™ levantou s√£o √≥timos!

Tenho algumas d√∫vidas apenas sobre como executar esses fluxos:

1. Uma pessoa abre um PR por um fork, eu fa√ßo o merge pelo GitHub desse PR na nossa branch de homologa√ß√£o?
2. Se sim, como depois passar para a `main`? Pois nesse caso terei que abrir um novo PR.
3. Ou ent√£o eu puxo na minha m√°quina os commits da pessoa, fa√ßo o merge numa branch local (precisa ter um commit de merge, pois √© o √∫ltimo commit que a Vercel faz a verifica√ß√£o), empurro para essa branch de homologa√ß√£o (pode at√© ser com um `-f` pra for√ßar que seja o hist√≥rico dela).
4. Se nesse caso tudo passar, eu fa√ßo o merge do PR dela.

Voc√™ consegue me ajudar a visualizar um fluxo melhor? ü§ù

>> Coment√°rio de aprendendofelipe:
Oi @filipedeschamps, n√£o tenho certeza se o que eu pensei daria certo, mas acho que podemos testar.
Minha principal d√∫vida √© se voc√™ fazendo merge na branch de homologa√ß√£o j√° permitiria o deploy na Vercel, mas eu acredito que sim. Se sim, o que pensei √© o seguinte:

1. Voc√™ faz o merge do PR na branch de homologa√ß√£o para testarmos.
2. Se tudo estiver funcionando bem, voc√™ abre a nova PR s√≥ para passar para a `main`.

Se isso funcionar, o PR extra s√≥ ser√° necess√°rio ap√≥s passar por todos os testes em homologa√ß√£o. Da forma que est√° hoje, me parece que voc√™ est√° precisando criar um PR extra para cada vez que for testar. Me corrija se n√£o for bem isso.

Mais algumas vantagens se isso der certo:

1. Quem estiver desenvolvendo qualquer coisa, pode optar por usar como base a branch de homologa√ß√£o, ao inv√©s da main.
2. Nem sempre voc√™ ir√° precisar de um PR para cada teste que passar na homologa√ß√£o, pois algumas vezes voc√™ pode optar por acumular algumas coisas e s√≥ no momento oportuno enviar para a main. Esse processo tamb√©m pode ajudar a diminuir os casos de PRs enormes e dif√≠ceis de revisar.

>> Coment√°rio de filipedeschamps:
> Minha principal d√∫vida √© se voc√™ fazendo merge na branch de homologa√ß√£o j√° permitiria o deploy na Vercel

Para o deploy conseguir ser feito, o √∫ltimo commit no PR precisa ser de algu√©m que est√° no time l√° dentro da Vercel. Ent√£o se eu fizer o merge de um PR em uma branch, isso cria um merge commit em meu nome, o que faz disparar o deploy com sucesso.


> 1. Voc√™ faz o merge do PR na branch de homologa√ß√£o para testarmos.
> 2. Se tudo estiver funcionando bem, voc√™ abre a nova PR s√≥ para passar para a `main`.
> 
> Se isso funcionar, o PR extra s√≥ ser√° necess√°rio ap√≥s passar por todos os testes em homologa√ß√£o. Da forma que est√° hoje, me parece que voc√™ est√° precisando criar um PR extra para cada vez que for testar. Me corrija se n√£o for bem isso.

Basicamente esse √© o fluxo que acontece hoje. Ent√£o eu abro o PR extra para visualmente pegar a URL do deploy, continuar a conversa e se tudo estiver certo, fazer o merge dele contra a `main`, que seria o final do seu fluxo.

> 1. Quem estiver desenvolvendo qualquer coisa, pode optar por usar como base a branch de homologa√ß√£o, ao inv√©s da main.

No nosso caso, sugiro n√£o fazer isso, pois nada que est√° em homologa√ß√£o est√° garantido e a fonte da verdade no nosso caso √© a `main`. Existem outros fluxos de git onde isso √© diferente.

E dado que n√£o temos garantia do que est√° na branch de homologa√ß√£o ir√° funcionar, eventualmente imagino que teremos que dar `push -f` nela por fora do GitHub.

---

Pelo que estou entendendo, n√£o vamos conseguir fugir de um PR extra se a pessoa n√£o tem acesso l√° na Vercel. E sobre normalizar uma branch para homologa√ß√£o, to pensando aqui que isso vai aumentar o meu trabalho quando eu fizer um PR, pois vou inicialmente fazer numa feature branch que j√° vai disparar o deploy, e da√≠ vou ter que fazer um merge adicional para a branch de homologa√ß√£o üòÖ

Mas vou continuar pensando aqui üëç

>> Coment√°rio de aprendendofelipe:
Pensei melhor aqui e realmente isso n√£o iria diminuir o seu trabalho @filipedeschamps  üëç
</issue_466_[Sugest√£o] Deixar uma branch fixa para deploy no ambiente de homologa√ß√£o>

<issue_471_[Sugest√£o] Colocar instru√ß√µes de markdown na p√°gina de cria√ß√£o da postagem>
Fala Turma!

Muitas pessoas n√£o est√£o familiarizadas com a linguagem de Markdown, pensando nisso, acredito que seria interessante ter um link/√≠cone logo na p√°gina de cria√ß√£o da postagem que exibe todas as formas de marca√ß√£o.

Desta forma, o criador tem todas as informa√ß√µes para elaborar sua postagem e deix√°-la delicinha.

O que acham?

>> Coment√°rio de Rafatcb:
Gosto bastante do estilo do Stack Overflow:
![stack-overflow-markdown](https://user-images.githubusercontent.com/26308880/177200542-fefc9540-01a2-4df7-a1e2-b27dd9dd1c57.gif)

Ter os √≠cones seria √≥timo, mas as instru√ß√µes j√° ajudam bastante, pra pessoa n√£o ficar completamente perdida.
Ao clicar em _"more"_, [essa p√°gina](https://stackoverflow.com/editing-help) √© aberta numa nova guia com instru√ß√µes bem completas sobre diversas formata√ß√µes.


O Stack Overflow em Portugu√™s tem as instru√ß√µes traduzidas (veja a p√°gina de [fazer uma pergunta](https://pt.stackoverflow.com/questions/ask) e a p√°gina de [ajuda do markdown](https://pt.stackoverflow.com/editing-help))

>> Coment√°rio de ewertonls:
Esse aqui serve? O editor do bytemd j√° tem um cheatsheet, √© s√≥ exibir no css:



https://user-images.githubusercontent.com/79954630/178112655-d87f72c4-6e36-4244-b8fd-61ea44057318.mov

>> Coment√°rio de filipedeschamps:
@ewertonl sensacional! Isso precisa ser habilitado novamente nessa Milestone, inclusive fazendo o editor usar a tradu√ß√£o para `pt-BR` üëç

>> Coment√°rio de limazia:
> Esse aqui serve? O editor do bytemd j√° tem um cheatsheet, √© s√≥ exibir no css:
> 
>  bytemdcsheet.mov

Sensacional!!! vou come√ßar a usar em meus projetos

>> Coment√°rio de aprendendofelipe:
Acho que j√° foi realizado no PR #630. Ou ficou faltando algo?

>> Coment√°rio de filipedeschamps:
Foi realizado ü§ù  fechando a issue üëç
</issue_471_[Sugest√£o] Colocar instru√ß√µes de markdown na p√°gina de cria√ß√£o da postagem>

<issue_472_Customizar os links da p√°gina inicial em formato de cards>
Pensei em customizar os links para deixar mais legivel as informa√ß√µes na p√°gina inicial, assim como o site [dev.to](https://dev.to) faz utilizando cards. Deixando uma coluna central para a lista de links.

O que acham?

![image](https://user-images.githubusercontent.com/46972789/177010265-0d89a3c4-14c4-494c-964a-1014ff6b22cc.png)

>> Coment√°rio de isaqueveras:
Criei a PR #475 que customiza os links do ranking, e ficou assim o design final, o que acharam?
![image](https://user-images.githubusercontent.com/46972789/177154837-549eaa90-27ba-4e15-abc6-18a1cc87f574.png)

>> Coment√°rio de isaqueveras:
Ol√° pessoal, com o passar do tempo desde que fiz essa sujest√£o e a PR, n√£o estou gostando desse design de cards. Irei fechar essa issue e a PR pois analisando o design atual da p√°gina inicial quero sugerir o design igual a lista do Google, que √© parecido com o atual design do tabnews.

![image](https://user-images.githubusercontent.com/46972789/178152206-5a6a211e-2cb3-4fe9-a6f7-ddd39c8339d5.png)

>> Coment√°rio de filipedeschamps:
@isaqueveras muito obrigado por abrir a issue com a sugest√£o, inclusive chegar no ponto de criar um PR com a implementa√ß√£o, simplesmente sensacional ü§ù 

Um dos princ√≠pios que estamos usando na Home √© o olho conseguir escanear rapidamente os itens, e o n√∫mero acaba sendo o ponto pivot para isso, ent√£o √© importante (talvez) manter o n√∫mero alinhado com o que o usu√°rio quer ler de fato:

![image](https://user-images.githubusercontent.com/4248081/178322441-36308fb6-e5d6-4030-af0b-99dfb2584135.png)

Para **hipoteticamente** ele estar fazendo isso:

![image](https://user-images.githubusercontent.com/4248081/178322672-fd49a2d8-e067-4375-b862-21250267eae3.png)

O mesmo cuidado foi utilizado para mostrar o n√∫mero de TabCoins e manter ele centralizado com o in√≠cio do que provavelmente a pessoa ir√° come√ßar a ler. Ent√£o se o conte√∫do tem t√≠tulo, ele desce o componente de TabCoins para ficar alinhado verticalmente, e se  n√£o tiver, ele tenta alinhar com o in√≠cio do corpo:

![image](https://user-images.githubusercontent.com/4248081/178323353-2e5010d4-a760-4650-81dd-fdeb433e2c23.png)

Se voc√™ notar, sua sugest√£o est√° muito longe da vers√£o com as TabCoins üëç   üòç  Mas de qualquer forma, estou aberto a qualquer sugest√£o, mas √© preciso considerar que a velocidade de ler uma lista √© muito alta e precisamos sempre lapidar para esse lado da equa√ß√£o ü§ù
</issue_472_Customizar os links da p√°gina inicial em formato de cards>

<issue_473_Application error: a client-side exception has occurred>
Ol√° @filipedeschamps acabei de receber essa mensagem em 2 browsers (PC e Mobile) que estavam **logados** no tabnews.

Quando acessei de browsers sem session n√£o retornou o erro, e apos dar F5 o erro sumiu. 

S√≥ estou abrindo essa Issue para analisarmos se isso pode ser algo relacionado a ultima PR. 

![Captura de tela em 2022-07-03 14-57-16](https://user-images.githubusercontent.com/5334261/177051737-562b0296-6fa7-4873-8a09-b6b1355df449.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb uma d√∫vida: isso foi no primeiro acesso, correto? Depois n√£o aconteceu mais?

Tamb√©m recebi, mas n√£o consigo reproduzir mais. O que eu acho que est√° acontecendo √© que o client-side n√£o est√° lidando  muito bem com um localStorage desatualizado que n√£o possui as informa√ß√µes de TabCoins e TabCash.

>> Coment√°rio de filipedeschamps:
Consegui reproduzir aqui for√ßando deletar as propriedades `tabcoins` e `tabcash`. Fiz um fix no PR #474 üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps show de bola! Pensei em ser algo relacionado com o localStorege, sendo que o erro s√≥ apresentava em browsers que estavam com session ativa.
</issue_473_Application error: a client-side exception has occurred>

<issue_476_Problema ao instalar depend√™ncia do primer>
Pessoal... estou enfrentando problemas pra rodar o npm install aqui na minha m√°quina

![image](https://user-images.githubusercontent.com/85972147/177057463-821e28ec-f26a-459d-ab2d-2bb22f81c3fb.png)

Algu√©m consegue me ajudar?

>> Coment√°rio de isaqueveras:
Ol√° @victorhcb aconteceu isso comigo, eu rodei o `nvm install` e logo depois o `npm install` e deu certo, veja se pode ser isso.

>> Coment√°rio de rodrigoKulb:
@victorhcb √© um problema de compatibilidade com a vers√£o do node, da uma olhada nesse Issue.

https://github.com/filipedeschamps/tabnews.com.br/issues/445

**Solu√ß√£o: utilizar o node na vers√£o 16.15.0**

>> Coment√°rio de victorhcb:
> @victorhcb √© um problema de compatibilidade com a vers√£o do node, da uma olhada nesse Issue.
> 
> https://github.com/filipedeschamps/tabnews.com.br/issues/445
> 
> **Solu√ß√£o: utilizar o node na vers√£o 16.15.0**

Obrigadooo @rodrigoKulb 

N√£o tinha visto a issue 
Vou tentar seguir as orienta√ß√µes da discuss√£o por l√° üòä
</issue_476_Problema ao instalar depend√™ncia do primer>

<issue_477_[Prefer√™ncias de usu√°rios] Sempre abrir links em nova guia>
E ai turma, tudo bem com voc√™s?
Minha primeira issue aqui, ent√£o se eu estiver fazendo ou falando besteira, por favor me corrijam, beleza?

Ent√£o, hoje fiz minha primeira postagem no TabNews e achei muito legal o est√°gio em que o projeto est√°.

Dando uma navegada entre as postagens, acessei uma do Guga e quando cliquei no link da fonte percebi que ele abriu na mesma aba em que eu estava lendo o conte√∫do do Guga.

Ai, fica a sugest√£o de melhoria de duas formas:
- Apenas mudar a forma de abertura dos links para `target: blank`
- Ou ent√£o, criar uma p√°gina de redirecionamento, que avisa o usu√°rio que ele est√° saindo do TabNews e indo pra um dom√≠nio externo, caso n√£o seja um link do pr√≥prio TabNews.

Agora, fica thread aberta para discuss√£o turma :)

>> Coment√°rio de gabrielsozinho:
Eu acho v√°lido ter a op√ß√£o do usu√°rio escolher. Por exemplo: no menu de configura√ß√µes uma op√ß√£o "Abrir links em novas abas". Ai a pessoa pode ativar ou deixar desativada.

>> Coment√°rio de filipedeschamps:
Show @cezarmzz seja super bem vindo aqui nas issues :)

E abrir sempre numa nova aba √© algo que j√° pediram v√°rias vezes, e eu tento achar formas de convencer as pessoas de n√£o implementar isso üòÇ 

Eu noto que em sites onde o usu√°rio possui mais natureza com a parte t√©cnica das coisas (e quer mais controle) essa feature n√£o √© implementada. Aqui mesmo no GitHub, por exemplo, ou Hacker News, as p√°ginas abrem numa nova aba s√≥ se voc√™ ordenar que isso aconte√ßa.

Eu chutaria que a origem de for√ßar esse comportamento veio de sites que n√£o querem que a pessoa feche o site de forma alguma, sabe, numa luta por "aumentar o tempo de sess√£o" a qualquer custo. Isso √© t√£o forte, que implementar esse recurso por conta desse ponto j√° foi sugerido aqui dentro do TabNews (n√£o lembro se no reposit√≥rio ou no site). E dado a natureza do projeto, n√£o concordo implementar esse recurso por esse motivo. Se a pessoa quer sair, deixe ela sair. Pelo menos isso acontece muito comigo quando estou navegando em mobile, fico frustrado pois nesse caso, voltar a p√°gina √© muito mais f√°cil que voltar a "aba".

Mas por outro lado, uma outra situa√ß√£o onde isso me deu uma rasteira foi quando no Preview de uma publica√ß√£o eu cliquei num link externo e perdi o que estava escrevendo, pois na √©poca ainda n√£o tinha o salvamento autom√°tico de rascunho.

Ent√£o acho que no final das contas √© entender de fato todos os motivos por tr√°s dessa implementa√ß√£o e se queremos tirar dos nossos usu√°rios a possibilidade de abrir um link na pr√≥pria p√°gina ü§ù

>> Coment√°rio de cezarmezzalira:
Fala Filipe! 

Obrigado pela resposta! 

Como nosso amigo comentou anteriormente, talvez o melhor jeito de resolver isso seria ter uma configura√ß√£o para o usu√°rio modificar isso, por√©m, mantendo o comportamento atual como comportamento padr√£o digamos assim.

Eu adoraria por exemplo ter essa feature e posso at√© ajudar na implementa√ß√£o.

Ali√°s, o TabNews vai √°rea de configura√ß√µes, certo?

>> Coment√°rio de filipedeschamps:
Show @cezarmzz ! O TabNews vai sim ter configura√ß√µes do usu√°rio, uma delas e que precisa ser implementado nessa Milestone inclusive √© a possibilidade de desabilitar o recebimento de emails ü§ù

>> Coment√°rio de santosesantos:
Eae pessoal. Espero que estejam muito bem.

Primeiramente, essa funcionalidade de _**Configura√ß√µes do Usu√°rio**_ √© uma excelente op√ß√£o, traz at√© uma possibilidade de customiza√ß√µes mais elaboradas no futuro.

Eu at√© pensei em comentar sobre sites que funcionam mais como ferramentas, como o Gmail, mas ele tamb√©m t√™m um **Ambiente de Ads**, o que justifica o comportamento de abrir em outra aba, sem "matar" a aba atual.

Ent√£o, na minha vis√£o, o que o @filipedeschamps comentou ainda prevalece e pela natureza do TabNews (ao menos por enquanto, antes do "Sistema de An√∫ncios Tab") n√£o faz sentido, realmente, implementar comportamentos como esse de forma **for√ßada**. Ainda assim, enxergo muito valor ao proporcionar a _liberdade_ de configurar o comportamento do site ao usu√°rio do TabNews, pois isso se conecta justamente com a natureza do TabNews. _Um espa√ßo onde o usu√°rio tem mais controle e clareza sobre o ambiente em que est√°._

Se eu estiver errado em alguma conclus√£o aqui, estou disposto a conversar tranquilamente. No mais, adoraria ajudar na implementa√ß√£o dessa feature (Configura√ß√µes de Usu√°rio). Vou buscar uma issue sobre esse tema aqui, inclusive.

>> Coment√°rio de aprendendofelipe:
N√£o acho que compense implementar essa op√ß√£o de sempre abrir links em nova aba.

Apenas dando minha opini√£o e trazendo um artigo legal sobre o assunto:

[When to use target=‚Äù_blank‚Äù](https://css-tricks.com/use-target_blank/)

>> Coment√°rio de gpoleszuk:
Para abrir um link constante em uma postagem n√£o seria suficiente segurar Shift e depois o clique sobre o link? Desta forma faz muito sentido o que o @filipedeschamps citou. O usu√°rio tem a liberdade de sair ou n√£o da p√°gina diferente quando √© implementado o abrir em outra p√°gina todas as vezes e o usu√°rio sempre vai ter, por imposi√ß√£o, uma nova p√°gina aberta.

>> Coment√°rio de cacpmw:
Gostaria de adicionar a minha perspectiva sobre esse topico

**Mas antes, peco desculpas pela falta de acentos (eu to sem teclado em portugues)**

## Por que eu gosto de `target=_blank`

Geralmente estamos lendo artigos ou posts ensinando algo e que possuem diversos links externos como por exemplo o proprio github. 
E muito comum que nos cliquemos em links para deixar abertos na aba como forma de leitura completamentar posterior ou durante a leitura do artigo original. 

Usando `target=_blank` eu posso sair do contexto atual e voltar sem me perder na leitura e ter que achar o ponto exato onde eu estava antes de sair. Sem contar que eu posso clicar em diversos links para deixar varias abas abertas.

## Abrindo links com `CTRL` ou `Botao do Meio`

Quando abrimos links usando ctrl ou o botao do meio, normalmente, o comportamento padrao e abrir a aba em background. Eu particularmente gosto desse comportamento pq nao me obriga a sair de onde estou e isso pode ser definido programaticamente. 

O problema dessa estrategia e que nem sempre nos lembramos de clicar com o botao do meio ou usar ctrl

## Minha percepcao

Eu acredito que em sites como o tabnews e o proprio curso.dev faz muito sentido a implementacao de abrir links em uma nova aba. Notoriamente os usuarios nao tem intencao de perder o ponto exato onde estavam e sim de consumir algum conteudo referenciado e voltar pro artigo original. 

Sendo assim eu vejo valor na implementacao do usuario poder escolher isso nas configuracoes do perfil

>> Coment√°rio de LucasMSCaetano:
Fala pessoal, vim por uma discuss√£o que vi nos coment√°rios do curso nessa aula: https://curso.dev/web/uptime-dos-servicos

ap√≥s ler os coment√°rios gostei bastante da ideia de podermos fazer com que essa op√ß√£o de "clicar no link e abrir em outra aba" ser configuravel em um menu do usu√°rio. Como ainda estamos com essa issue aberta, gostaria de saber se podemos fazer uma poc dessa feature, o que acham?
</issue_477_[Prefer√™ncias de usu√°rios] Sempre abrir links em nova guia>

<issue_478_Publicar + remover + publicar o mesmo conte√∫do causa um 404 eterno>
(S√≥ consegui reproduzir em produ√ß√£o, em homolog n√£o consegui.)

Como reproduzir:
- publicar novo conte√∫do
- apagar o conte√∫do rec√©m-criado
- publicar novamente o mesmo conte√∫do (com o mesmo t√≠tulo, de forma a que tenha o mesmo url)

Suponho que isto tenha a ver com a forma como o conte√∫do √© cacheado, mas n√£o voltei a testar em produ√ß√£o (para n√£o poluir o ambiente)
N√£o sei qual a diferen√ßa entre homolog e produ√ß√£o no que toca a caching.

@filipedeschamps talvez vc possa ‚ù§Ô∏è"testar em produ√ß√£o"‚ù§Ô∏è, j√° que depois de criar o segundo conte√∫do, eu n√£o consigo deletar ele porque tomo um 404 (talvez consiga direto na API)

De qualquer forma, n√£o me parece algo urgente.

>> Coment√°rio de filipedeschamps:
@tcarreira eu fiquei encucado com esse teste quando vi que n√£o conseguia abrir um link `published` em Produ√ß√£o e fiquei **duplamente** encucado quando voc√™ n√£o conseguiu reproduzir isso em ambiente de Homologa√ß√£o.

A URL de Homologa√ß√£o que voc√™ testou foi essa: https://tabnews-git-fix-tabcoins-localstorage-tabnews.vercel.app/ e na √©poca ela rodava o exato mesmo c√≥digo que em Produ√ß√£o... e pelo que entendo, n√£o h√° diferen√ßa alguma de infraestrutura ou cache entre os ambientes (tirando as vari√°veis de ambiente).

Mas encontrei isso aqui que pode solucionar esse mist√©rio: https://github.com/vercel/next.js/issues/34006

>> Coment√°rio de tcarreira:
Esse link que vc postou solucionou o mist√©rio dev/prod

Consegui reproduzir em dev: https://tabnews-git-fix-tabcoins-localstorage-tabnews.vercel.app/tcarreira/teste-unpublished-version

Como fazer:
- publicar conte√∫do
- remover conte√∫do
- acessar a p√°gina do conte√∫do removido (obtendo um 404)
- republicar conte√∫do (com o mesmo t√≠tulo)
- a p√°gina do conte√∫do publicado agora aparece como 404

>> Coment√°rio de aprendendofelipe:
Pelo jeito estamos correndo esse risco n√£o s√≥ com o slug do post, mas tamb√©m com algu√©m que testar se um nome de usu√°rio est√° dispon√≠vel antes de se cadastrar.

Nos meus testes resolveu adicionando o `revalidate: 1` no `notFound`. PR #491 aberto.

```js
if (error instanceof NotFoundError) {
      return {
        notFound: true,
        revalidate: 1,
      };
    }

>> Coment√°rio de filipedeschamps:
Fechado por #491
</issue_478_Publicar + remover + publicar o mesmo conte√∫do causa um 404 eterno>

<issue_479_[Sugest√£o] Mostrar a lista de pessoas que deram TabCoins no perfil do usu√°rio>
Mostrar de forma privada/publica as pessoas que deram tabcoins para o usu√°rio que fez o artigo, o que acham?

>> Coment√°rio de filipedeschamps:
@isaqueveras vou fechar essa issue e pedir para voc√™ centralizar esse pedido nessa publica√ß√£o aqui: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda

E j√° pediria para esclarecer o que seria a forma `privada/publica`, se seria uma op√ß√£o que a pessoa escolhe de deixar de forma p√∫blica onde ela est√° usando suas TabCoins ü§ù
</issue_479_[Sugest√£o] Mostrar a lista de pessoas que deram TabCoins no perfil do usu√°rio>

<issue_480_[Sugtest√£o] Habilitar o Github Discussions no reposit√≥rio>
O GitHub possui a funcionalidade de f√≥rum em um reposit√≥rio, isso possibilita aos usu√°rios e contribuidores discutirem, documentar, tirar d√∫vidas e criarem guias sem a necessidade de superpopular as issues.

## Exemplo
Vou me usar como exemplo, sou um programador iniciante e sei muito pouco de boas pr√°ticas, padr√µes, mas consigo me virar, no entanto, fico receoso sobre postar uma issue acerca de d√∫vidas que tenho para contribuir com o desenvolvimento do projeto. 

O caso em espec√≠fico √©: fiz um fork do projeto para conhecer um pouco o nextjs e fiz uma ''p√°gina'' `/feed`, que na verdade √© um documento xml RSS com as √∫ltimas 15 publica√ß√µes do Tabnews. Gostaria de discutir com o pessoal interessado o que fazer para o feed.

Como √© uma feature prospectada para a Milestone 7, imaginei que n√£o seria adequado abrir uma issue ~~ou reabrir a issue que j√° existe~~ s√≥ para discutir a implementa√ß√£o ou detalhes est√©ticos.

## Pontos interessantes sobre o Discussions
- Possui categorias e tags que filtram o conte√∫do das discuss√µes
- √â poss√≠vel fazer enquetes para, por exemplo, medir o n√≠vel de interesse acerca de um assunto/feature
- N√£o √© preciso fechar uma discuss√£o, como se faz com uma issue ou PR
- Uma resposta pode ser marcada como a ''correta''

## Habilitando o GitHub Discussions

Na p√°gina principal do reposit√≥rio e indo nas Settings > Features > Discussions

Voc√™ pode ver mais detalhes sobre o Discussions em: [https://docs.github.com/pt/discussions](https://docs.github.com/pt/discussions)

----
Perd√£o se a issue estiver fora do escopo do projeto, se for o caso pode fechar. No momento estou procurando algum grupo da comunidade que possa contatar o pessoal, se j√° tiver um grupo e puder me direcionar o link vai ser muito √∫til. Agrade√ßo antecipadamente!

>> Coment√°rio de filipedeschamps:
@ewertonl s√≥ conseguir chegar nessa issue agora, estou passando um pente fino no projeto porque o final da √∫ltima Milestone foi foco total por um bom tempo nas TabCoins ü§ù 

Sobre a sugest√£o, √© uma √≥tima sugest√£o, mas meu medo √© dividir o foco em duas partes que talvez as pessoas n√£o v√£o entender a diferen√ßa, ent√£o as vezes o que era para ser uma issue vai ser publicado no Discussions, e vice-versa. E dado a isso, n√£o vejo problema algum voc√™ abrir uma issue para discutir sobre a implementa√ß√£o do RSS, eu pessoalmente at√© prefiro centralizar tudo nas issues, pois da√≠ √© um s√≥ lugar para se concentrar e √© poss√≠vel atrelar essa issue numa Milestone.

**Mas tenho outra sugest√£o melhor:** ao inv√©s de usar o Discussions dentro do GitHub, porque n√£o usar o pr√≥prio TabNews para isso? üòç  quanto mais usarmos ele, mais iremos testar ele pra valer, descobrir bugs, novos casos de uso, etc. √â total a express√£o "eat your own dog food" ü§ù

>> Coment√°rio de ewertonls:
Entendi, obrigado pela resposta e por tirar minha d√∫vida, Filipe! Tinha pensado sobre postar no TabNews mesmo, j√° escrevi alguns t√≥picos e fiz alguns prints e testes para ilustrar a demonstra√ß√£o do feed. Qualquer dia desses fa√ßo a publica√ß√£o por l√°!

>> Coment√°rio de CarlosZiegler:
Hummm, interessante pont de vista. Para mim nao seria problema comentar no Issues, acho melhor mesmo que no proprio tabnews, deixando o escopo menor. Mas entendi a ideia :)

>> Coment√°rio de filipedeschamps:
Show @CarlosZiegler se algo que voc√™ comentaria num Discussions, mas n√£o comentaria numa issue, me avise para entender melhor. E mesmo assim, refor√ßo o pedido de publicar no TabNews, pois quanto mais usarmos ele, melhor ele vai ficar ü§ù

>> Coment√°rio de CarlosZiegler:
Seria mais mesmo por ter um escopo mesmo. Como se no tabnews noc conseguissemos filtrar por tema, por exemplo. Ai vc teria foco apenas no projeto tabnews. Por exemplo:

Hoje eh meu dia de folga, minha ideia √© dar uma olhada no projeto Tabnews (issue, PR, updates), ai me deparo com alguma noticia no tabnews ( Micro-SaaS ), que eh um assunto bem interessante, mas me faz fugir do foco hahah, ai eu ja entro no artigo, entro no micro-saas, quando vejo ja estou vendo videos de passarinhos no youtube. Tambem fica mais facil a busca direto no projeto. Mas como falei acho massa usar o Tabnews tambem, nada de ruim, seria apenas uma sugestao :)

>> Coment√°rio de filipedeschamps:
hahahah just√≠ssimo!! üòÇ üëç

>> Coment√°rio de allangrds:
@filipedeschamps Entrando na discuss√£o, hehe.

Acho que os prop√≥sitos s√£o diferentes. As issues dever√£o ser convertidas futuramente em PRs, sendo bugs, melhorias ou funcionalidades, j√° a parte de discuss√£o seria pra poder falar do que achamos que falta na plataforma, por exemplo.

- Issues: t√©cnico, execu√ß√£o
- Discussion: ideias de melhorias pra plataforma

Sobre deixar isso no Tabnews, entendo que ficaria aberto pra comunidade, mas ficaria tudo muito disperso, pois atualmente n√£o existe uma categoriza√ß√£o das postagens, e nem possibilidade de pesquisa.
</issue_480_[Sugtest√£o] Habilitar o Github Discussions no reposit√≥rio>

<issue_483_[Feature] Adicionar indicadores na pagina de status>
Acredito que seja interessante tamb√©m ter alguns indicadores na p√°gina de status, alguns indicadores que penso s√£o:

1) Quantidade de usu√°rios cadastrados
2) Total de artigos publicados e apagados

>> Coment√°rio de filipedeschamps:
@isaqueveras estou fechando essa issue e pe√ßo que centralize esse pedido nessa publica√ß√£o: https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda

Em paralelo, estava pensando aqui: esse √© um √≥timo caso para usar o sistema de eventos, apesar de que hoje n√£o conseguir√≠amos por ele extrair o `status`. N√£o est√° sendo anotado no `metadata` do evento. Talvez dever√≠amos? Outro ponto seria a necessidade de reconstruir o hist√≥rico ü§ù
</issue_483_[Feature] Adicionar indicadores na pagina de status>

<issue_485_Acessibilidade: aria-label dos TabCoinButtons est√° com o valor "Search">
O `aria-label` de ambos os bot√µes de tabcoins est√° setado com o valor `"Search"`, o que pode confundir o usu√°rio de leitores de tela:


![bot√µes de tabcoins com aria-label incorreto](https://user-images.githubusercontent.com/79954630/178125317-a7d1d038-ad31-4087-bb6c-180433eace2b.png)


Algo como **'upvote'** e **'downvote'** seria adequado, mas em portugu√™s qual seria o correto? Pensei em **'votar positivo'** e **'votar negativo'** j√° que √© um bot√£o e indica uma a√ß√£o, mas n√£o sei se √© a melhor escolha de palavras.

>> Coment√°rio de gabrielsozinho:
fechado por #508
</issue_485_Acessibilidade: aria-label dos TabCoinButtons est√° com o valor "Search">

<issue_488_N√£o estou conseguindo rodar `npm run dev`>
Quando eu tento rodar `npm run dev`, ele n√£o come√ßa o servidor de desenvolvimento, e para em "health check postgres:  /var/run/postgresql:5432 - accepting connections".

![Tentativa de iniciar o servidor de desenvolvimento usando o comando npm run dev](https://i.imgur.com/IKx6mal.gif)

Estou usando Windows rodando WSL (Debian), e j√° tive um problema parecido antes, mas era s√≥ quando eu matava o processo do servidor, ele n√£o desligava os servi√ßos.

Mais informa√ß√µes do sistema:
![Informa√ß√µes do sistema](https://user-images.githubusercontent.com/33376280/178485511-d855c751-8216-4bf0-93c4-e283391d8b2b.png)

Ah desculpa se ficou meio ruim essa issue, n√£o sou muito familiarizado com esse projeto e, tamb√©m, contribuir em projetos open-source.

>> Coment√°rio de joaogelado:
Eu tinha que deletar a database, porque uma migration tava conflitando com a outra
</issue_488_N√£o estou conseguindo rodar `npm run dev`>

<issue_492_[Erro] Vers√£o do node indicada no README n√£o est√° certa>
No README diz que para rodar o tabnews eu preciso ter a vers√£o do Node.js 16 ***ou superior*** para rodar o projeto, mas ent√£o tentei instalar as depend√™ncias usando a vers√£o [LTS que atualmente √© a v16.16.0](https://nodejs.org/en) mas tive o seguinte erro:

```sh
npm WARN config global `--global`, `--local` are deprecated. Use `--location=global` instead.
npm ERR! code ERESOLVE
npm ERR! ERESOLVE could not resolve
npm ERR! 
npm ERR! While resolving: @primer/react@35.2.1
npm ERR! Found: react@18.1.0
npm ERR! node_modules/react
npm ERR!   react@"18.1.0" from the root project
npm ERR!   peer react@"*" from @bytemd/react@1.15.0
npm ERR!   node_modules/@bytemd/react
npm ERR!     @bytemd/react@"1.15.0" from the root project
npm ERR!   10 more (@primer/octicons-react, @primer/octicons-react, next, ...)
npm ERR! 
npm ERR! Could not resolve dependency:
npm ERR! peer react@"^17.0.0" from @primer/react@35.2.1
npm ERR! node_modules/@primer/react
npm ERR!   @primer/react@"35.2.1" from the root project
npm ERR! 
npm ERR! Conflicting peer dependency: react@17.0.2
npm ERR! node_modules/react
npm ERR!   peer react@"^17.0.0" from @primer/react@35.2.1
npm ERR!   node_modules/@primer/react
npm ERR!     @primer/react@"35.2.1" from the root project
npm ERR! 
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
npm ERR! 
npm ERR! See C:\Users\funkt\AppData\Local\npm-cache\eresolve-report.txt for a full report.

npm ERR! A complete log of this run can be found in:
npm ERR!     C:\Users\funkt\AppData\Local\npm-cache\_logs\2022-07-12T23_19_48_860Z-debug-0.log
```

>> Coment√°rio de filipedeschamps:
@Theryston voc√™ est√° certo! Como consertar esse problema na raiz est√° sendo tratado na issue #445

Em paralelo, sugiro por enquanto instalar exatamente a vers√£o `16.15.0` que dever√° funcionar ü§ù
</issue_492_[Erro] Vers√£o do node indicada no README n√£o est√° certa>

<issue_493_Milestone 5 - Lan√ßamento>
Turma, chegou a hora de agitar o reposit√≥rio de novo üòç ent√£o segue abaixo a primeira vers√£o do draft da Milestone 5, onde ao longo dos dias da semana irei criar e separar em issues e cadastrar dentro da [Milestone](https://github.com/filipedeschamps/tabnews.com.br/milestone/9). E dessa vez, teremos 3 categorias:

1. Objeto principal da Milestone
2. Melhorias
3. Itens de seguran√ßa

**Mas aten√ß√£o:** os itens listados abaixo s√£o apenas um norte, algo para nos guiar e n√£o est√£o listados em ordem de prioridade. Ent√£o sinta-se livre em sugerir outras melhorias e discutir outras implementa√ß√µes, mesmo ap√≥s a inaugura√ß√£o da Milestone ü§ù  E caso queira sugerir outros itens, sugiro [centralizar nessa publica√ß√£o](https://www.tabnews.com.br/filipedeschamps/milestone-5-o-que-nao-pode-faltar-para-o-lancamento-do-tabnews-ajuda).

## Objeto principal da Milestone

1. Lan√ßar publicamente o TabNews (com v√≠deo no canal)

## Melhorias

Fora as sugest√µes que foram coletadas naquela publica√ß√£o do TabNews, esta lista inclui tamb√©m o que j√° tinha sido implementado ao longo do fechamento da Milestone 4 e abertura da 5, assim como itens que eu acredito ser importante para o futuro do projeto.

**Lista nova (W.I.P.)**:

1. #497
2. #498
4. #499
5. #502
6. #504
7. #505
8. #507
9. #511
10. #520
11. #521
12. #530
13. #532
14. #534
15. #542
16. #560
17. #569
18. #582
19. #584
20. #586
21. #587
22. #589
23. #591
25. #580
26. #610
27. #384
28. #617
29. #619
30. #622
31. #624
32. #626
33. #631
34. #629
35. #636
36. #638
37. #639
38. #641
39. #644
40. #647 
41. #650
42. #652
44. #658
45. #663
46. #669
47. #671
48. #673
49. #679
50. #680
51. #684
52. #689
53. #691
54. #696
55. #701
56. #705
57. #706
58. #709
59. #713
60. #719
61. #727
62. #728
63. #737
64. #655
65. #745
66. #770
67. #777
68. #781
69. #795
70. #806
71. #730
72. #733
73. #732

## Itens de seguran√ßa

1. Valida√ß√£o de email+senha deve tomar o mesmo tempo quando o usu√°rio existe ou n√£o: #186
74. Problema: "Entrada do tipo de senha com auto-preenchimento habilitado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
75. Problema: "Pr√°ticas recomendadas de HTTP Strict Transport Security (HSTS)" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
76. Problema: "Content Security Policy (CSP) n√£o implementado" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
77. Problema: "P√°ginas sens√≠veis que podem ser armazenadas em cache" [Fonte](https://www.tabnews.com.br/lengo/falhas-de-seguranca-no-tabnews)
62. Transformar endpoints gen√©ricos em realmente gen√©ricos (sem injetar o usu√°rio).
63. Middleware responder dentro de "4s", conforme [essa resposta](https://github.com/filipedeschamps/tabnews.com.br/issues/744#issuecomment-1252939012) do @aprendendofelipe 

## Itens importantes para pr√≥ximas Milestones

Novamente, caso voc√™ queira puxar essa responsabilidade para a Milestone atual, sinta-se livre ü§ù 

1. #496
2. Documenta√ß√£o sobre a API dentro do README - (Proposta em #599)
1. Configurar DMARC to email `contato` do TabNews para emails saindo do Gmail.
1. Refatorar mensagens de erro e deixar elas user friendly.
1. #308  (ideia em #486)
1. Fazer profiling da aplica√ß√£o para entender quais pontos est√£o demorando mais, e tamb√©m quais √≠ndices devemos criar no Banco de Dados.
3. Sitemap.
4. Limitar quantidade de upvotes.
6. Barra de busca.
7. Conseguir marcar as pessoas nas publica√ß√µes.
8. Favoritar publica√ß√µes e conseguir criar listas compartilh√°veis p√∫blicas e privadas.
10. P√°gina do usu√°rio listar tamb√©m os coment√°rios que ele fez.
11. Avaliar [TabRewards](https://www.tabnews.com.br/devlyh/sugestao-tabrewards)
12. Conseguir compartilhar o link para o `anchor` de uma resposta na publica√ß√£o `root` (e n√£o somente o link exclusivo da resposta, talvez inclusive remover essa feature em favor do `anchor`).
13. Toggle nos coment√°rios para compactar ou expandir uma `branch` de respostas.
14. Possibilidade de fazer posts sem texto (inspirado no HackerNews).
16. Estrat√©gia de rankeamento apenas por TabCoins (as melhores publica√ß√µes hist√≥ricas), que inclui tanto publica√ß√µes `root` quanto `child`.
17. #377

>> Coment√°rio de aprendendofelipe:
> 1. [Upload de imagens¬†#308](https://github.com/filipedeschamps/tabnews.com.br/issues/308)  (ideia em [feat(login/logout): adicionando a possibilidade de deslogar¬†#484](https://github.com/filipedeschamps/tabnews.com.br/pull/484))

Imagino que o PR correto da ideia seja o [Adiciona fun√ß√£o de subir imagens para o tabnews #486](https://github.com/filipedeschamps/tabnews.com.br/pull/486)

>> Coment√°rio de joaogelado:
> 44. Documenta√ß√£o sobre a API dentro do README.

N√£o teria uma p√°gina de documenta√ß√£o? Por exemplo: `https://www.tabnews.com.br/docs`.

>> Coment√°rio de filipedeschamps:
> Imagino que o PR correto da ideia seja o [Adiciona fun√ß√£o de subir imagens para o tabnews #486](https://github.com/filipedeschamps/tabnews.com.br/pull/486)

Muito obrigado meu caro! Ajustado ü§ù 

> N√£o teria uma p√°gina de documenta√ß√£o? Por exemplo: `https://www.tabnews.com.br/docs`.

Pode ser tamb√©m! A sugest√£o de estar no README me veio da facilidade da pessoa entrar no reposit√≥rio e j√° estar tudo l√° (e d√° pra organizar bem legal com `<details>` `<summary>`).

>> Coment√°rio de filipedeschamps:
Turma, vou precisar me colocar um soft limit de **duas semanas** para tentar **concluir a Milestone** e come√ßar a trabalhar no **v√≠deo de lan√ßamento** do projeto. Faz muito tempo que estou sem publicar v√≠deos e a inseguran√ßa financeira est√° aumentando cada vez mais. Ent√£o com o encerramento dessa Milestone vou tentar rebalancear os esfor√ßos para voltar com o canal (que tamb√©m estou morrendo de saudades de criar conte√∫do) e come√ßar organizar as coisas para o curso.

Para ajudar nisso, passei alguns itens para a Milestone seguinte e vamos ver o que dessa Milestone vai dar para executar nessas duas semanas ü§ù

>> Coment√°rio de filipedeschamps:
@andersonFaro9 acho que voc√™ deu um unpin sem querer nessa issue.

<img width="407" alt="image" src="https://user-images.githubusercontent.com/4248081/187954324-1f6c392b-b0d3-44aa-a8c9-ff5fe2a1d766.png">

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, como voc√™ est√° focado no retorno do canal e na plataforma do curso, fiz uma rela√ß√£o dos PRs que eu acredito que est√£o prontos e que poderiam (os primeiros at√© **deveriam**) ir para produ√ß√£o antes do lan√ßamento do TabNews.

Caso n√£o tenha tempo de olhar tudo, coloquei em ordem do que acredito ser prioridade:

~#823 - Performance da query com pagina√ß√£o distante (offset grande)~
#786 - Contorna problema de UX causado pela CDN da Vercel n√£o propagando revalida√ß√£o das p√°ginas
~#809 - Resolve o BUG da mensagem de conte√∫do apagado~
~#811 - Ignora o rate-limit se o Upstash estiver com problemas e n√£o responder dentro de 4s (ao inv√©s da API do TabNews ficar fora do ar)~
#804 - Melhora UX mantendo mais atualizado os saldos no Header
#817 - Corrige espa√ßamento entre checkbox e label na p√°gina de perfil

>> Coment√°rio de filipedeschamps:
Sensacionaaaaal @aprendendofelipe e de fato, eu terminei a primeira vers√£o da home da plataforma e agora estou subindo toda a infraestrutura e colocar o projeto para a Hotmart aprovar (e isso pode demorar, por isso estou dando prioridade total para isso).

E pode deixar que vou trabalhar no review e merge dessa lista! Ficou de fato muito massa!! Meu √∫nico medo √© ficar em cima do lan√ßamento e v√°rios merges resultarem em outros bugs. De qualquer forma, o PR do `offset` parece ser **extremamente cr√≠tico** e esse com garantia total vou fazer o merge!! ü§ù

>> Coment√°rio de 33gustavo33:
Filipe, acho que voc√™ esqueceu de fechar a milestone em si, pois ela [ainda est√° aberta](https://github.com/filipedeschamps/tabnews.com.br/milestone/9)
</issue_493_Milestone 5 - Lan√ßamento>

<issue_496_Adicionar linting para rejeitar vari√°veis n√£o usadas>
## Contexto

O projeto do TabNews come√ßou sem ter essa regra habilitada no Eslint e agora temos v√°rios arquivos que importam depend√™ncias/vari√°veis que n√£o s√£o usadas.

## Execu√ß√£o

- #404

>> Coment√°rio de Mazin97:
Essa issue j√° n√£o foi resolvida na [PR#1410](https://github.com/filipedeschamps/tabnews.com.br/pull/1410)?

>> Coment√°rio de aprendendofelipe:
Boa @Mazin97! üí™
</issue_496_Adicionar linting para rejeitar vari√°veis n√£o usadas>

<issue_497_`Content`: ajusta fonte dos tooltips para a padr√£o do site>
## Contexto

N√≥s usamos um editor chamado ByteMD que traz consigo sua pr√≥pria estiliza√ß√£o, e para as coisas ficarem sempre com a mesma apar√™ncia, precisamos "marretar" um CSS sobrescrevendo essa estiliza√ß√£o. Uma que escapou foi a fonte utilizada na tooltip da bandeja de √≠cones.

## Execu√ß√£o

- #430

>> Coment√°rio de filipedeschamps:
Conclu√≠da pelo PR #430 ü§ù
</issue_497_`Content`: ajusta fonte dos tooltips para a padr√£o do site>

<issue_498_Thumbnail criada de forma din√¢mica para cada conte√∫do>
## Contexto

- #395

## Execu√ß√£o

- #463
- #535

>> Coment√°rio de filipedeschamps:
Fechado por #535 com fixes de seguran√ßa em #545 e #547. Pesquisa em: #544
</issue_498_Thumbnail criada de forma din√¢mica para cada conte√∫do>

<issue_499_`source_url` acusando de forma errada URL v√°lidas>
## Contexto

- #457


## Execu√ß√£o

- #465

>> Coment√°rio de filipedeschamps:
Fechado por #465
</issue_499_`source_url` acusando de forma errada URL v√°lidas>

<issue_500_Pergunta sobre a altera√ß√£o de senha>
Oi? 

Gostaria de saber como ocorre o funcionamento da altera√ß√£o de senha. Estou desenvolvendo uma aplica√ß√£o e percebi que ao contr√°rio da realizada por mim, ela conta com um **link enviado para pessoa por e-mail**.

Esse link enviado por e-mail para a pessoa √© realizada por meio de uma api?

Eu pensei nisso:
![image](https://user-images.githubusercontent.com/101956836/179367686-a3daf43b-70cd-4ce0-9185-8767f674dc5b.png)
</issue_500_Pergunta sobre a altera√ß√£o de senha>

<issue_502_Gitpod: adiciona arquivo de configura√ß√£o do ambiente>
## Contexto

O [Gitpod](https://www.gitpod.io/) √© um editor de c√≥digo na nuvem que usa o VS Code como engine. Inclusive ele j√° at√© apareceu no meu canal [nesse v√≠deo aqui](https://www.youtube.com/watch?v=Q7YfzbJRzm0). E para subir o ambiente de desenvolvimento deixando ele preparado para uso, como por exemplo j√° usando a vers√£o correta do Node.js e com as depend√™ncias instaladas, √© necess√°rio adicionar um arquivo de configura√ß√£o.

## Execu√ß√£o

- #468

>> Coment√°rio de filipedeschamps:
Fechado por #468
</issue_502_Gitpod: adiciona arquivo de configura√ß√£o do ambiente>

<issue_504_Enviar publica√ß√µes com a tecla de atalho `CTRL` + `Enter` (ou `CMD` + `Enter`)>
## Contexto

- #382

## Execu√ß√£o

- #490

>> Coment√°rio de filipedeschamps:
Fechado por #490
</issue_504_Enviar publica√ß√µes com a tecla de atalho `CTRL` + `Enter` (ou `CMD` + `Enter`)>

<issue_505_Consertar o cache de p√°ginas 404>
## Contexto

- #478

## Execu√ß√£o

- #491

>> Coment√°rio de filipedeschamps:
Fechado por #491
</issue_505_Consertar o cache de p√°ginas 404>

<issue_507_Limpar dos logs os `404` gerados por `favicon.png` `apple-touch-icon.png` e `apple-touch-icon-precomposed.png`>
## Contexto

A request dessas imagens √© feita automaticamente dependendo do client que voc√™ usa, e como n√≥s n√£o fornecemos elas, nos √∫ltimos 30 dias isso gerou praticamente `3.000` erros `404` nos nossos logs. E com o crescimento do site, esses erros s√≥ tendem a crescer tamb√©m.

<img width="1719" alt="image" src="https://user-images.githubusercontent.com/4248081/179384033-3dc52944-4cd2-4da5-a257-3a24ae24131f.png">

Query do Axiom usada para depois verificarmos o resultado:

```
vercel
| where ['request.host'] == 'www.tabnews.com.br' and (['request.path'] contains "/favicon.png" or ['request.path'] contains "/apple-touch-icon.png" or ['request.path'] contains "/apple-touch-icon-precomposed.png")
| summarize count() by bin(_time, 24h)
```


## Execu√ß√£o

- #495

>> Coment√°rio de filipedeschamps:
Fechado por #495
</issue_507_Limpar dos logs os `404` gerados por `favicon.png` `apple-touch-icon.png` e `apple-touch-icon-precomposed.png`>

<issue_511_Trancar a rota `/users` para apenas quem tiver a feature `read:user:list`>
## Contexto

A rota `/users` foi criada inspirada no GitHub, que disponibiliza a lista de todos os seus usu√°rios para caso algu√©m queira construir alguma feature em cima disso. Mas por enquanto n√£o temos nenhum uso e ela n√£o possui pagina√ß√£o, ent√£o se tornou rapidamente uma rota pesada. A ideia inicial era deslistar ela da API, por√©m o @aprendendofelipe deu uma sugest√£o melhor: trancar ela para apenas usu√°rios que tenham a feature `read:user:list`.

## Execu√ß√£o

- #494

>> Coment√°rio de filipedeschamps:
Fechado por #494
</issue_511_Trancar a rota `/users` para apenas quem tiver a feature `read:user:list`>

<issue_512_Error: Ao clicar em responder>
O TabNews est√° retornando este erro ao clicar em responder:


![Screenshot_20220717-142227_Chrome](https://user-images.githubusercontent.com/234561/179417619-342381dd-78ca-4e22-a708-366f5361727f.jpg)

>> Coment√°rio de filipedeschamps:
@EduardoSpek voc√™ pode nos dar um pouco mais de informa√ß√£o? Qual URL que deu esse problema?

>> Coment√°rio de aprendendofelipe:
@filipedeschamps acabei de testar aqui e realmente d√° erro ao abrir em modo de edi√ß√£o, mas s√≥ ocorre no celular. Algo com o bytemd demorar para montar o textarea... J√° estou subindo a corre√ß√£o.

>> Coment√°rio de filipedeschamps:
Vim aqui comentar que tamb√©m tinha isolado que s√≥ acontecia no celular, muito louco! Mas que massa que identificou o que √©, vou fazer o merge em staging do seu PR e vamo pra cima!!!

>> Coment√°rio de filipedeschamps:
Consertado na velocidade da luz por @aprendendofelipe no PR #513 ü§ù
</issue_512_Error: Ao clicar em responder>

<issue_517_Seguran√ßa de links no Markdown>
Fazendo alguns testes eu descobri que √© poss√≠vel "mascarar" links, assim como o exemplo a seguir

[https://youtube.com](https://google.com) - Esse √© um "link falso"
\[ https://youtube.com ]\(https://google.com)

![image](https://user-images.githubusercontent.com/63757378/179510417-3f0357db-0e1e-403c-839b-77addf49b4de.png)

![image](https://user-images.githubusercontent.com/63757378/179510446-4f2e72c4-1087-4ec9-acb5-39993754fc44.png)

Ou seja, voc√™ clica em um link mas na verdade o link real √© outro.<br>
Isso √© um problema que existia antigamente no Discord, e por esse motivo, essa feature foi removida do Discord. E pra resolver isso, uma das formas que eu pensei √© de aparecer um aviso toda vez que a pessoa clicar em algum link de qualquer conte√∫do, bem parecido com o Discord mesmo:

![image](https://user-images.githubusercontent.com/63757378/179511088-7ffee75c-2e8b-47ad-8801-7c48b52653c7.png)

Pra prevenir que qualquer pessoa entre em algum link malicioso

>> Coment√°rio de agjunior:
A possibilidade dar um nome personalizado para um link √© muito √∫til para deixar o texto limpo e organizado. Mas concordo que abre muita brecha para pessoas mal intencionadas.

O aviso √© uma boa, mas tamb√©m come√ßa a ficar muito chato quando se tem uma lista de links, por exemplo. O Discord at√© adicionou uma op√ß√£o para "Confiar neste dom√≠nio" mas a√≠ j√° seria uma complexidade maior.

>> Coment√°rio de rodrigoKulb:
Realmente estranho, Mas se o github n√£o bloqueia n√£o vejo o porque bloquear tamb√©m, at√© porque a pessoa pode utilizar um encurtador e mascarar o possivel malware tamb√©m. Ou at√© dom√≠nios similares por exemplo goglle.com

Acredito que um sistema de modera√ß√£o para punir usu√°rios mal intencionados seria o melhor caminho.

>> Coment√°rio de vitoropereira:
> Realmente estranho, Mas se o github n√£o bloqueia n√£o vejo o porque bloquear tamb√©m, at√© porque a pessoa pode utilizar um encurtador e mascarar o possivel malware tamb√©m. Ou at√© dom√≠nios similares por exemplo goglle.com
> 
> Acredito que um sistema de modera√ß√£o para punir usu√°rios mal intencionados seria o melhor caminho.

Exato ou um sistema q previamente verifique os links. Mas ai fica um pouco mais complexo.

>> Coment√°rio de filipedeschamps:
N√£o vejo problema o recurso de voc√™ dar uma descri√ß√£o para um link, mesmo que o link seja um encurtador, o que fica **muito** estranho e n√£o vejo motivo do porque deixar existir √© uma descri√ß√£o ser um link v√°lido, mas √© uma m√°scara para outro link, como o exemplo do @ezequiaslopesdasilva 

```
[https://youtube.com/](https://google.com/)
```

Talvez o que poder√≠amos negar no backend com um `bad request` √© quando atingir a condi√ß√£o de que a descri√ß√£o √© um link v√°lido e ela est√° diferente do link real. At√© criaria um evento/alerta marcando essa conta para investiga√ß√£o.

Algu√©m v√™ algum motivo v√°lido para a usar um outro link como descri√ß√£o?

>> Coment√°rio de OtavioVB:
O √∫nico motivo que vejo para usar outro link como descri√ß√£o √© a quest√£o das a√ß√µes intencionais de terceiros. Mas como o @rodrigoKulb  falou √© poss√≠vel a pessoa mascarar o link com um redirecionador. N√£o sei se existe algo do tipo, mas seria interessante existir alguma funcionalidade para checar se o link √© de redirecionamento ou n√£o, desse modo, caso sim, pode haver um alerta para uma conta para investiga√ß√£o como o @filipedeschamps falou

>> Coment√°rio de aprendendofelipe:
> Talvez o que poder√≠amos negar no backend com um `bad request` √© quando atingir a condi√ß√£o de que a descri√ß√£o √© um link v√°lido e ela est√° diferente do link real.

O legal de fazer essa verifica√ß√£o no backend √© que abre oportunidade para checar tamb√©m se a URL est√° formatada corretamente para evitar acontecer o relatado aqui:

https://www.tabnews.com.br/Ja1/56a2f8b6-4c13-4733-887d-4c1f309944b4

E no frontend, acho que em algum momento pode ser implementado um aviso ao clicar em links, desde que exista a op√ß√£o de desativar o aviso. Isso tamb√©m abre oportunidade para fornecer a alternativa de abrir os links em novas janelas, que √© uma prefer√™ncia que alguns usu√°rios j√° relataram.

>> Coment√°rio de victorhcb:
Achei massa a ideia de colocar uma verifica√ß√£o para ver a descri√ß√£o do link √© um link v√°lido.

Uma outra ideia que tive que pode deixar interessante tamb√©m √© adicionar uma caixa suspensa quando o usu√°rio passa o mouse sobre o link (igual acontece no Google Docs, por exemplo) assim o usu√°rio pode ver facilmente para onde ser√° direcionado sem precisar criar uma janela de confirma√ß√£o que pode prejudicar a experi√™ncia do usu√°rio. 

Segue exemplo na imagem (no caso do google existem algumas fun√ß√µes de personaliza√ß√£o que n√£o seriam necess√°rias aqui no TabNews):

![image](https://user-images.githubusercontent.com/85972147/182257625-d208b4d4-6b94-42d3-8c53-4527d40083df.png)
</issue_517_Seguran√ßa de links no Markdown>

<issue_518_Diferenciar publica√ß√£o visitada/nova>
Item da Millestone 5:

> Criar diferencia√ß√µes visuais para publica√ß√£o j√° visitada, publica√ß√£o nunca visitada e publica√ß√£o nova desde √∫ltimo acesso.

Se for para ter somente duas visualiza√ß√µes diferentes, uma solu√ß√£o simples, que pode ser a primeira vers√£o, pode ser usar o `:visited` para diferenciar as publica√ß√µes j√° visitadas das n√£o visitadas. Qualquer nova publica√ß√£o ficar√° com a mesma formata√ß√£o das publica√ß√µes *antigas n√£o visitadas*.

Se for para diferenciar os 3 casos, tamb√©m √© simples, pois √© s√≥ salvar no `localStorage` qual foi a hora do √∫ltimo acesso e destacar os conte√∫dos criados ap√≥s esse hor√°rio. S√≥ me preocupa um pouco a polui√ß√£o visual com 3 formata√ß√µes diferentes no `ContentList`.

Em seguida pode ser feito algo mais complexo, envolvendo tamb√©m destacar conte√∫dos com novas respostas (talvez de in√≠cio destacando se a quantidade de respostas mudar, o que n√£o √© o ideal, mas quebra um galho inicialmente).

Acho que podemos fazer isso usando o localStorage (ou IndexedDb se precisar de algo melhor). Gostei que o @filipedeschamps falou algo nessa linha em uma das lives. 

Mas isso √© realmente mais complexo e precisamos pensar na melhor estrat√©gia. Sem pensar muito, me parece que ter√≠amos que salvar no m√≠nimo o id, o hor√°rio da visita e a quantidade de respostas de todas as publica√ß√µes j√° visitadas pelo usu√°rio.

Ter que salvar o hist√≥rico de todos os conte√∫dos √© que √© o problema, e por isso talvez seja melhor usar o IndexedDb para poder apagar facilmente o hist√≥rico mais antigo.

Uma vantagem da abordagem acima √© n√£o precisar de 3 diferentes visualiza√ß√µes, podendo dar ao usu√°rio a escolha do que √© novidade para ele, al√©m das publica√ß√µes ap√≥s a √∫ltima visita, pode-se acrescentar:
‚Ä¢ novas respostas;
‚Ä¢ conte√∫dos editados ap√≥s a √∫ltima visita;
‚Ä¢ conte√∫dos anteriores a √∫ltima visita, mas que n√£o foram abertos (*antigos e n√£o visitados*). 

Sobre os conte√∫dos *antigos e n√£o visitados*, tamb√©m podemos dar a op√ß√£o de marcar a publica√ß√£o como "n√£o destacar" para algo que o usu√°rio n√£o queira acompanhar.

Da√≠ quando ficar rodando legal de acordo com o feedback dos usu√°rios, partimos para uma forma de salvar no banco de dados para que o usu√°rio tenha essas informa√ß√µes sincronizadas entre diferentes dispositivos.

>> Coment√°rio de filipedeschamps:
Cada vez mais estou sentindo falta de diferenciar o que j√° abri, o que eu n√£o abri e o que √© novo.

> Se for para ter somente duas visualiza√ß√µes diferentes, uma solu√ß√£o simples, que pode ser a primeira vers√£o, pode ser usar o :visited para diferenciar as publica√ß√µes j√° visitadas das n√£o visitadas. Qualquer nova publica√ß√£o ficar√° com a mesma formata√ß√£o das publica√ß√µes antigas n√£o visitadas.

Eu topo **total** que essa seja a primeira vers√£o. Mas como isso seria executado com o Primer? A gente sobrescreveria o estilo dele?

> Se for para diferenciar os 3 casos, tamb√©m √© simples, pois √© s√≥ salvar no localStorage qual foi a hora do √∫ltimo acesso e destacar os conte√∫dos criados ap√≥s esse hor√°rio. S√≥ me preocupa um pouco a polui√ß√£o visual com 3 formata√ß√µes diferentes no ContentList.

Eu estava pensando em colocar uma bolinha azul e algum lugar, onde se √© a primeira visita da pessoa e n√£o h√° dado do √∫ltimo acesso, nenhuma bolinha aparece, pois do contr√°rio todas as publica√ß√µes teriam bolinhas.

### Exemplo interno

<img width="706" alt="image" src="https://user-images.githubusercontent.com/4248081/181389078-315a1875-ae71-45a0-a973-03a680c6e16f.png">

### Exemplo externo (prefiro esse)

<img width="705" alt="image" src="https://user-images.githubusercontent.com/4248081/181389349-64219616-27aa-47fe-bdcd-880a06981c73.png">

> Em seguida pode ser feito algo mais complexo, envolvendo tamb√©m destacar conte√∫dos com novas respostas (talvez de in√≠cio destacando se a quantidade de respostas mudar, o que n√£o √© o ideal, mas quebra um galho inicialmente).

Isso √© muito massa! Deixar azul se algum novo coment√°rio for adicionado. Mas o problema √© que para ser *perfeito* n√£o daria para usar a quantidade de coment√°rios para fazer o diff, uma vez que se um coment√°rio foi adicionado e enquanto isso outro foi deletado, a diferen√ßa de quantidade √© zero. Mas acho que dever√≠amos deixar para pensar isso numa pr√≥xima fase mesmo ü§ù 

> Da√≠ quando ficar rodando legal de acordo com o feedback dos usu√°rios, partimos para uma forma de salvar no banco de dados para que o usu√°rio tenha essas informa√ß√µes sincronizadas entre diferentes dispositivos.

Isso mais para frente seria sensacional!! Principalmente se usar estrat√©gias de stale-while-revalidate ü§ù

>> Coment√°rio de filipedeschamps:
Isso pode ajudar na estiliza√ß√£o:

https://primer.style/react/overriding-styles#nesting-pseudo-classes-and-pseudo-elements

>> Coment√°rio de filipedeschamps:
Tava pensando aqui, o `/user` poderia devolver um `last_visit`,  que poderia ser atualizado toda vez que esse endpoint √© chamado. N√£o sei se √© uma boa pr√°tica nesse caso um `GET` atualizar um valor assim, mas em paralelo, a sess√£o tamb√©m √© renovada por `GET` em rotas que injeta o usu√°rio.

>> Coment√°rio de vinicius-arcanjo:
> Eu estava pensando em colocar uma bolinha azul e algum lugar

Uma outra solu√ß√£o poderia ser utilizando algo estilo `tags`:

<img width="975" alt="Screenshot 2022-07-29 at 14 16 55" src="https://user-images.githubusercontent.com/69835383/181810832-91229dca-f45a-4c57-8515-01eab19db73f.png">

### ou 

<img width="1000" alt="Screenshot 2022-07-29 at 14 18 38" src="https://user-images.githubusercontent.com/69835383/181811065-7d1fa2c2-78d4-4340-87d4-ed294141713c.png">

>> Coment√°rio de filipedeschamps:
Que massa meu caro! O YouTube usa essa mesma estrat√©gia ü§ù 

<img width="376" alt="image" src="https://user-images.githubusercontent.com/4248081/181817019-2ce598da-3f73-4c1d-9660-d0827b5e7c43.png">

Uma preocupa√ß√£o que √© necess√°rio ter, √© sobre como isso ficaria em Mobile (que n√£o possui muito espa√ßo na esquerda e direita da tela) üëç

>> Coment√°rio de vinicius-arcanjo:
> Uma preocupa√ß√£o que √© necess√°rio ter, √© sobre como isso ficaria em Mobile (que n√£o possui muito espa√ßo na esquerda e direita da tela) üëç

No mobile poder√≠amos encurtar a `tag` para uma bolinha, caso precise otimizar o espa√ßo.

>> Coment√°rio de filipedeschamps:
> No mobile poder√≠amos encurtar a `tag` para uma bolinha, caso precise otimizar o espa√ßo.

Bom ponto! Mas fico pensando: ser√° que n√£o ficaria mais assimil√°vel para a pessoa que alterna entre um ambiente e outro ter exatamente a mesma dica visual?

>> Coment√°rio de vinicius-arcanjo:
> Bom ponto! Mas fico pensando: ser√° que n√£o ficaria mais assimil√°vel para a pessoa que alterna entre um ambiente e outro ter exatamente a mesma dica visual?

Entendo, nesse caso a refer√™ncia visual seria a cor da tag, porem √© uma quest√£o a se pensar.

>pode ser usar o :visited

Testei o `:visited` para uma primeira vers√£o, porem n√£o obtive √™xito, parece n√£o funcionar com o Primer

>> Coment√°rio de rodrigoKulb:
Utilizo o [Thunderbird](https://www.thunderbird.net/pt-BR/) para ler e-mails gosto muito da abordagem, repliquei para o layout do tabnews abaixo:

- Texto em negrito
- Pequena Bolinha para identificar

| Op√ß√£o 01 | Op√ß√£o 02 |
 | --  | --  |
 | ![Captura de tela em 2022-07-29 15-48-36](https://user-images.githubusercontent.com/5334261/181825407-19b12387-6e36-497d-bef9-32789cbef499.png) | ![Captura de tela em 2022-07-29 15-48-36](https://user-images.githubusercontent.com/5334261/181826117-3a2dd40d-d952-48a7-a46c-971f0f720fd0.png) 
| Op√ß√£o 03 | Op√ß√£o 04 |
![181826117-3a2dd40d-d952-48a7-a46c-971f0f720fd0](https://user-images.githubusercontent.com/5334261/181915286-f0f1bdfb-d130-40c3-87c3-1ae0523def48.png)|![181826117-3a2dd40d-d952-48a7-a46c-971f0f720fd03](https://user-images.githubusercontent.com/5334261/181915287-5dd1512f-7422-42da-9dec-c0bf648eda86.png)|

>> Coment√°rio de aprendendofelipe:
Eu gosto da ideia de mudar a fonte, deixando mais destacado o que for novidade e mais apagado o restante.

Nesse exemplo existe destaque para 3 casos diferentes:

- Conte√∫dos ainda n√£o acessados - Destaque para o t√≠tulo
- Conte√∫dos postados ap√≥s o √∫ltimo acesso - Destaque para a data
- Conte√∫dos com novas respostas - Destaque para o n√∫mero de coment√°rios

Com rela√ß√£o ao destaque para novas respostas, existem duas op√ß√µes:
1. Destaque s√≥ para novas respostas de conte√∫dos j√° visitados - considera a hora da visita ao conte√∫do.
2. Destaque para novas respostas independentemente de j√° ter visitado o conte√∫do - considera a hora da √∫ltima visita ao TabNews.

Gosto da alternativa 2, pois pode ser um indicador de que o conte√∫do antes ignorado, ainda pode estar relevante.

Op√ß√£o 1 | Op√ß√£o 2
--- | ---
![image](https://user-images.githubusercontent.com/77860630/182001890-3caf272b-a6cd-4b95-8282-82cf7eba4871.png) | ![image](https://user-images.githubusercontent.com/77860630/182002032-27516b08-0a62-4a7b-a160-8db71d6b23b5.png)

>> Coment√°rio de aprendendofelipe:
Aproveitando a op√ß√£o 3 do @rodrigoKulb, eu n√£o acho legal o avatar, pois uma imagem sempre chama mais aten√ß√£o do que um texto, ent√£o o autor vai chamar mais aten√ß√£o do que o t√≠tulo.

Tamb√©m sobre essa op√ß√£o 3, eu gosto da ideia de retirar o n√∫mero que acompanha o t√≠tulo, pois esse n√∫mero n√£o acrescenta muita informa√ß√£o para o leitor. Sei que ele ajuda na separa√ß√£o dos conte√∫dos, mas seria um bom lugar para colocar um √≠cone de status que faria tanto a fun√ß√£o de separar os conte√∫dos como destacar os que tivessem novidades.

Pensando nisso, poderia acrescentar aos exemplos que coloquei acima uma alternativa em que o n√∫mero est√° destacado n√£o s√≥ nos conte√∫dos n√£o lidos, mas tamb√©m nos que tem novos coment√°rios. E esse destaque poderia bem ser um √≠cone no lugar do n√∫mero.

![image](https://user-images.githubusercontent.com/77860630/182003252-258ec4d8-8e70-4217-a279-a82046630ba4.png)

>> Coment√°rio de aprendendofelipe:
> Testei o `:visited` para uma primeira vers√£o, porem n√£o obtive √™xito, parece n√£o funcionar com o Primer

O que voc√™ tentou alterar no estilo? N√£o d√° pra alterar nada al√©m de algumas cores usando o `:visited`.

Fonte: https://developer.mozilla.org/pt-BR/docs/Web/CSS/:visited#restri%C3%A7%C3%B5es_de_estilo

E por quest√µes de privacidade, n√£o conseguiremos obter esse status para fazer altera√ß√µes em outros elementos, ent√£o temos que mudar especificamente o elemento a.

Fonte: https://developer.mozilla.org/en-US/docs/Web/CSS/Privacy_and_the_:visited_selector

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe √≥timos pontos!

Gostaria de acrescentar algumas observa√ß√µes:

1. Destaque na fonte do t√≠tulo quando not√≠cia n√£o lida, gosto muito do **negrito** um padr√£o utilizado nos e-mails;
2. Sobre novos coment√°rios, achei que o layout ficou um pouco polu√≠do, se diferenciarmos apenas com o **negrito** tamb√©m?
3. Em rela√ß√£o a remover os n√∫meros **concordo** plenamente, n√£o vejo muito sentido para usu√°rio saber a posi√ß√£o exata da noticia; 
4. Removendo os n√∫meros ganhamos um espa√ßo maior para os t√≠tulos no mobile, podendo trabalhar melhor os √≠cones de lido e n√£o lido;
5. Outro ponto que vamos ter problemas no futuro com esses n√∫meros √© quando chegar na publica√ß√£o 1.000.000 vai quebrar o layout üòÖÔ∏è.

![novo](https://user-images.githubusercontent.com/5334261/182005275-506edbcf-d670-43a7-b15e-7c5cd096af5d.png)

>> Coment√°rio de aprendendofelipe:
√â verdade @rodrigoKulb, mudar s√≥ o negrito, seja no t√≠tulo, nos coment√°rios ou no tempo, parece a melhor op√ß√£o.

N√£o acha legal deixar o √≠cone destacado tamb√©m quando existir novo coment√°rio? Nesse caso o t√≠tulo continuaria sem negrito se for um conte√∫do j√° lido, mas o n√∫mero de coment√°rios ficaria em negrito para indicar o motivo do √≠cone estar destacado.

Sobre quais √≠cones utilizar, o que acham de algo na linha desses do GitHub?

![image](https://user-images.githubusercontent.com/77860630/182005709-3b64b0bb-2199-4c2d-81d9-2b397fc27e31.png) ![image](https://user-images.githubusercontent.com/77860630/182005739-3865f75c-c2ed-4d06-8bc8-d7a8a9b9bfdf.png)

N√£o precisa ser exatamente esses, mas um √≠cone que remeta a um checkbox. Isso permitiria adicionar uma funcionalidade legal como permitir ao usu√°rio clicar no √≠cone para mudar o status, ou seja, marcar como lido sem precisar abrir o conte√∫do ou marcar como n√£o lido mesmo j√° tendo acessado.

O `:visited` n√£o permite alterar o peso da fonte e tamb√©m n√£o daria para mudar o √≠cone, ent√£o isso j√° nos leva direto para o uso de algum armazenamento local.

>> Coment√°rio de rodrigoKulb:
> N√£o acha legal deixar o √≠cone destacado tamb√©m quando existir novo coment√°rio? Nesse caso o t√≠tulo continuaria sem negrito  se for um conte√∫do j√° lido, mas o n√∫mero de coment√°rios ficaria em negrito para indicar o motivo do √≠cone estar destacado.

Acho que podemos estudar algo tamb√©m, tenho medo de parecer algum **bug** se n√£o ficar claro que √© referente ao coment√°rio novo.

> Sobre quais √≠cones utilizar, o que acham de algo na linha desses do GitHub?

Acho super v√°lido estudar as possibilidades! ‚úâÔ∏è

> O :visited n√£o permite alterar o peso da fonte e tamb√©m n√£o daria para mudar o √≠cone, ent√£o isso j√° nos leva direto para o uso de algum armazenamento local.

Acredito que a melhor op√ß√£o seria guardar em banco de dados postagem vs usu√°rio, e podemos aguardar um minimo de 10 segundos para realmente contabilizar a leitura. Desta forma independente do dispositivo a leitura sempre vai estar atualizada.
E deixar a op√ß√£o de guardar no localStorage se o usu√°rio n√£o estiver logado.

Gosto do obvio, talvez utilizar 2 elementos no √≠cone, exemplo abaixo carta aberta e fechada e notifica√ß√µes.

![novo2](https://user-images.githubusercontent.com/5334261/182007230-868dc93d-5b33-4103-a2ba-645d182a2eb4.png)

>> Coment√°rio de aprendendofelipe:
Isso @rodrigoKulb, n√£o tem como fugir de salvar no banco. A ideia √© salvar local durante a PoC e depois de implementar no backend usar o local como cache.

E sobre o √≠cone aberto/fechado, √© bem por a√≠ que acredito tamb√©m üëç

Se algu√©m fizer algo no estilo da logo do TabNews tamb√©m ficar√° show

>> Coment√°rio de aprendendofelipe:
O conte√∫do novo √© a logo normal e o aberto pode ser algo assim
![TabNewsOpen](https://user-images.githubusercontent.com/77860630/182008776-844fd433-2853-4d70-9571-ce9a7e472648.png) ![TabNewsOpen3](https://user-images.githubusercontent.com/77860630/182009502-96a601dc-1165-4efa-8253-e8743ba905fa.png) ![TabNewsOpen4](https://user-images.githubusercontent.com/77860630/182009760-e23eee28-497c-46e1-a974-7ec4c67455de.png) ![TabNewsOpen5](https://user-images.githubusercontent.com/77860630/182009852-de9214fc-3447-4a2e-9be3-06fef9c8b4c9.png)

>> Coment√°rio de aprendendofelipe:
![Design sem nome (1)](https://user-images.githubusercontent.com/77860630/182010548-77f22473-c3ee-4fd8-8d03-03657c52ec94.gif)

>> Coment√°rio de vinicius-arcanjo:
> > Testei o `:visited` para uma primeira vers√£o, porem n√£o obtive √™xito, parece n√£o funcionar com o Primer
> 
> O que voc√™ tentou alterar no estilo? N√£o d√° pra alterar nada al√©m de algumas cores usando o `:visited`.
> 
> Fonte: https://developer.mozilla.org/pt-BR/docs/Web/CSS/:visited#restri%C3%A7%C3%B5es_de_estilo
> 
> E por quest√µes de privacidade, n√£o conseguiremos obter esse status para fazer altera√ß√µes em outros elementos, ent√£o temos que mudar especificamente o elemento a.
> 
> Fonte: https://developer.mozilla.org/en-US/docs/Web/CSS/Privacy_and_the_:visited_selector

Teste exatamente a cor e o background no elemento a, porem n√£o rolou com o primer.

>> Coment√°rio de vinicius-arcanjo:
A ideia do `√≠cone` √© boa, porem precisa ver se tamb√©m n√£o ira causar uma polui√ß√£o visual com muitos √≠cones, precisaria que ficasse bem homog√™neo, por isso citei as `tags` que √© algo que estamos acostumados a ver bastante, inclusive aqui no GitHub, j√° que o layout do site segue um pouco esse estilo ou algo mais discreto que nem a ideia do @rodrigoKulb e @filipedeschamps, inicialmente de que colocar s√≥ uma bolinha. 

> ![novo](https://user-images.githubusercontent.com/5334261/182005275-506edbcf-d670-43a7-b15e-7c5cd096af5d.png)

>> Coment√°rio de aprendendofelipe:
> Teste exatamente a cor e o background no elemento a, porem n√£o rolou com o primer.

Pelo jeito n√£o implementaram mesmo isso no Primer, ent√£o teria que partir para alguma forma de sobrescrever o css do componente Link, por exemplo com `style jsx`.

Mas n√£o vai dar pra trocar √≠cones com isso, ent√£o n√£o acho mais que compense usar o `:visited` nem na primeira vers√£o.

>> Coment√°rio de aprendendofelipe:
O que acham de algo assim?

Esse primeiro muda s√≥ o negrito:

https://user-images.githubusercontent.com/77860630/182047526-1c41f3b5-9274-417c-a58d-d62c06f84ac6.mp4

Esse tamb√©m muda a cor da fonte:

https://user-images.githubusercontent.com/77860630/182047740-c5e15095-3f19-4053-b74c-070dc26219bb.mp4

E o tamanho do √≠cone? Talvez um pouco menor? Para terem no√ß√£o, esses v√≠deos s√£o recortes da parte superior da tela do meu celular

>> Coment√°rio de filipedeschamps:
Turma, voc√™s s√£o **sensacionais**!!!! Olha a quantidade de experimentos condensados nessa thread üòç 

E nessas horas de experimenta√ß√£o, uma id√©ia ir√° conflitar com o outra e isso pode gerar um pouco de ansiedade em algumas pessoas, porque eventualmente o que passa na cabe√ßa √© *"como fazer ent√£o para encaixar todas as id√©ias ao mesmo tempo?"* E a resposta r√°pida √©: **n√£o se preocupe, porque n√£o d√°!** A fase da experimenta√ß√£o precisa ser livre, precisa conflitar mesmo, √© o melhor jeito de uma id√©ia lapidar a outra ü§ù 

**Mas ent√£o, qual a sa√≠da?** A sa√≠da √© ser **simples** e dar o **menor passo poss√≠vel**, avaliar o que aconteceu, e depois dar o passo seguinte com um pouco mais de sofistica√ß√£o, se necess√°rio. E eu ser o "chat√£o da simplicidade" √© algo que foi antecipado [no di√°rio de desenvolvimento](https://github.com/filipedeschamps/tabnews.com.br/wiki/022.-Milestone-0-(ENCERRAMENTO)) na parte **Gostaria de ser o Guia, e n√£o o Mentor**, mais para o final daquele par√°grafo. Vale a pena a leitura.

E dado a tudo que discutimos, o passo que sugiro dar √© apenas **marcar com uma cor mais clara um link que j√° foi visitado**... mais nada nesse momento. S√≥ que pelo jeito o Primer n√£o vai nos ajudar nem nisso, ent√£o teremos que compensar no lado t√©cnico.... mas de qualquer forma, um link mais claro √© a dica visual mais padr√£o do mundo de que algo j√° foi clicado (na verdade, n√£o necessariamente a cor "mais clara", mas basta seguirmos o princ√≠pio de trocar a cor como o link azul padr√£o para n√£o lido e roxo para lido).

E com o resultado disso, continuamos a pensar em como encaixar os outros recursos de links novos, coment√°rios novos, etc. O que acham desse primeiro passo ser super simples? ü§ù

>> Coment√°rio de aprendendofelipe:
O mais simples, se for s√≥ mudar a cor, √© o `:visited` mesmo... #609
</issue_518_Diferenciar publica√ß√£o visitada/nova>

<issue_520_√çcones do TabNews em SVG>
## Contexto

O @ezequiaslopesdasilva est√° criando v√°rios √≠cones em SVG para o Discord do TabNews e est√° come√ßando a repassar alguns deles para o reposit√≥rio.

## Execu√ß√£o

- #503

>> Coment√°rio de filipedeschamps:
Fechado por #503
</issue_520_√çcones do TabNews em SVG>

<issue_521_Renomear `error_unique_code` para `error_location_code`>
## Contexto

O objetivo inicial do `error_unique_code` era cada erro ter um ID √∫nico que fosse f√°cil de identificar pela resposta p√∫blica da API em que local dentro do c√≥digo o erro foi gerado, e de fato fica muito r√°pido s√≥ pelo retorno da API saber em qual condi√ß√£o o erro foi gerado, porque basta fazer uma busca global no c√≥digo por aquela string.

Por√©m o nome `error_unique_code` est√° errado, pois se o c√≥digo for refatorado (no sentido dele ter o mesmo comportamento final, mas o erro √© gerado em outro lugar do c√≥digo), a string que est√° escrita dentro do erro ir√° mudar, pois a posi√ß√£o ir√° mudar. Fora isso, deixar claro que isso n√£o √© um nome √∫nico de erro, faz as pessoas evitarem de usar esse nome em alguma l√≥gica no lado do client.

E apesar de ser improv√°vel de algu√©m estar usando essa propriedade em algum client, **isto √© uma breaking change**.

## Execu√ß√£o

- #506

>> Coment√°rio de filipedeschamps:
Fechado por #506
</issue_521_Renomear `error_unique_code` para `error_location_code`>

<issue_522_Mass Assignment permite altera√ß√£o do slug>
### Um usu√°rio deveria conseguir alterar a slug da sua publica√ß√£o ?

- Sobre o slug:
Este √© um campo que √© gerado automaticamente pela fun√ß√£o populateSlug quando uma nova publica√ß√£o √© feita.
https://github.com/filipedeschamps/tabnews.com.br/blob/0ee1f082bdf980213ad657228041e89c2a3e4657/models/content.js#L345


- Sobre o Bug: 
Quando um usu√°rio atualiza a sua publica√ß√£o, √© possivel injetar a slug na requisi√ß√£o (adicionar o campo no JSON que vai pro backend) e atualizar a slug no banco de dados. 
Esta √© a linha respons√°vel por fazer o merge dos dados antigos com os dados novos:

https://github.com/filipedeschamps/tabnews.com.br/blob/0ee1f082bdf980213ad657228041e89c2a3e4657/models/content.js#L571


N√£o existe a op√ß√£o para o usu√°rio alterar o slug, ent√£o acredito que este comportamento n√£o √© esperado. 


Melhor forma que acredito pra resolver:

- evitar "merges" de arrays.
- validar ou pegar da requisi√ß√£o somente campos o usu√°rio deve/pode atualizar no banco de dados, exemplo:
 ```js
  // exemplo besta...
  const content = {
     body: req.body.body,
     title: req.body.title,
     source_url: req.body.source_url
  };
 ```

>> Coment√°rio de filipedeschamps:
@carlosevieira obrigado por criar esse report, o comportamento √© esperado e est√° coberto por testes automatizados:

https://github.com/filipedeschamps/tabnews.com.br/blob/b3a40848fb13a586954248fd2005634f80b03ea6/tests/integration/api/v1/contents/post.test.js#L375-L420

Isso foi inspirado no Wordpress, onde l√° voc√™ tamb√©m pode definir o slug que desejar para uma publica√ß√£o.

Em paralelo, o client web de fato n√£o exp√µe essa op√ß√£o, mas por apenas n√£o ter sido implementado ainda. H√° outras features dispon√≠veis na API que o client ainda n√£o exp√µe ü§ù

>> Coment√°rio de carlosevieira:
Perfeito @filipedeschamps \o/
Vou continuar os testes por aqui ü§ù
</issue_522_Mass Assignment permite altera√ß√£o do slug>

<issue_523_[Notifica√ß√µes] Possibilidade de se inscrever em qualquer publica√ß√£o>
Ol√° amigos!

Assim como no Github, eu acho que seria interessante ter no TabNews a possibilidade de ativar/desativar notifica√ß√µes por email de novas respostas de uma publica√ß√£o. Desta forma, podemos acompanhar o debate mesmo de uma publica√ß√£o antiga.

O que acham?

>> Coment√°rio de Poveii:
Ol√°, @EduardoSpek.

Atualmente, eu acho que o Tabnews s√≥ est√° com todas as notifica√ß√µes ligadas para tudo e enviando para o email porque antes isso n√£o acontecia, foi implementado na pen√∫ltima milestone (se eu n√£o me engano) ent√£o creio que no futuro, nas pr√≥ximas milestones a ideia √© de as notifica√ß√µes aparecerem na pr√≥pria plataforma (como algumas redes sociais funcionam).

Mas que sua ideia √© v√°lida, com certeza! Mas creio que no momento n√£o seja vi√°vel, sem a implementa√ß√£o das notifica√ß√µes no pr√≥prio Tabnews. Bem, √© o que eu acho.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_523_[Notifica√ß√µes] Possibilidade de se inscrever em qualquer publica√ß√£o>

<issue_524_[sugest√£o] Possibilidade de escolher a ordem do ranqueamento dos conte√∫dos>
Heyoo!

Seguinte: Voc√™s acham v√°lido o usu√°rio poder escolher entre a ordem padr√£o (essa da rela√ß√£o entre tempo e tabcoins), somente por tempo e priorizando tabcoins (por exemplo, as do dia, dos ultimos 3 ou 7 dias tamb√©m ranqueadas s√≥ pelos tabcoins)?

> Imagino que coisas assim fiquem pras pr√≥ximas milestones, n√©?

>> Coment√°rio de Poveii:
Ol√°, @nottja1mmm!

Eu concordo e acho v√°lido. Creio que √© algo bem simples mas que pode ajudar v√°rias pessoas a interagirem com postagens mais recentes (com o "ordenar pelos mais recentes") e tamb√©m ajudar as postagens que est√£o crescendo na comunidade (com o "ordenar pelas tabcoins").

>> Coment√°rio de agjunior:
J√° existe um item na  Milestone 5 (#493 item 14) pra trazer de volta a listagem de itens recentes.

Acredito que nessa implementa√ß√£o j√° podemos incluir as 3 estrat√©gias dispon√≠veis na api (```best```, ```new``` e ```old```).

>> Coment√°rio de Rafatcb:
Percebi agora que existe um outro issue (https://github.com/filipedeschamps/tabnews.com.br/issues/1388) que trata sobre esse assunto e j√° recebeu alguns coment√°rios com sugest√µes de diferentes ordena√ß√µes e tamb√©m cuidados na implementa√ß√£o, ent√£o vou fechar aqui como duplicado. Obrigado pela sugest√£o!
</issue_524_[sugest√£o] Possibilidade de escolher a ordem do ranqueamento dos conte√∫dos>

<issue_530_Adicionar divisor padr√£o na data de publica√ß√£o no `ContentList` (antiga issue sobre mover `username` para √∫ltimo)>
## Edit

O t√≠tulo antigo dessa issue era `Mover autor da publica√ß√£o para √∫ltima posi√ß√£o no ContentList` e n√≥s abandonamos ela, pois n√£o ficou legal. Mas foi desenvolvido uma alternativa que melhora a leitura da data da publica√ß√£o e que foi feita no PR #541

## Contexto

A ideia √© reordenar as informa√ß√µes que ficam logo abaixo do t√≠tulo no componente `ContentList` e tentar deixar sempre as informa√ß√µes mais importantes na frente. E na tentativa de n√£o gerar nenhum *bias* sobre quem postou (para proteger e destacar um conte√∫do de valor concreto independente do autor), minha sugest√£o era de mover o autor para √∫ltima posi√ß√£o.

Mas como apontado por @aprendendofelipe no PR #510 onde isso foi executado por @vinicius-arcanjo, a legibilidade ficou **pior**, e ficou mesmo. O √∫ltimo campo n√£o necessariamente √© o menos vis√≠vel, muito pelo contr√°rio, √© um dos locais mais vis√≠veis da lista, pois sempre fica num extremo.

Ent√£o ap√≥s a implementa√ß√£o feita, n√≥s fizemos o deploy em Homologa√ß√£o e se confirmou o que o @aprendendofelipe tinha notado, por isso, estamos abandonando esta tarefa. De qualquer forma, muito obrigado @vinicius-arcanjo por colocar a m√£o na massa e implementar isso ü§ù

Segue abaixo uma simula√ß√£o:

### O que est√° hoje em Produ√ß√£o (hor√°rio por √∫ltimo)

![image](https://user-images.githubusercontent.com/4248081/180035351-8a6a925f-cd04-45b9-a2c8-d280a4ab05c0.png)

### O que a implementa√ß√£o dessa issue prop√µe (autor por √∫ltimo)

![image](https://user-images.githubusercontent.com/4248081/180035421-bbbffae9-654c-4d4b-a999-659b4c98c5c3.png)

### Percep√ß√£o

Ficou mais f√°cil de ler qual o autor, e pior de ler a quanto tempo a publica√ß√£o foi criada.

### Alternativa

O que talvez poder√≠amos fazer √© colocar um divisor entre o autor e o hor√°rio para deixar o hor√°rio ainda mais vis√≠vel e n√£o se misturar com o autor.

## Execu√ß√£o

- #510

>> Coment√°rio de vinicius-arcanjo:
@filipedeschamps, sobre as alternativas:

### H√≠fen(Autor no final)
<img width="684" alt="Screenshot 2022-07-20 at 13 49 52" src="https://user-images.githubusercontent.com/69835383/180038598-570dc60a-8539-47f6-8818-541e440cca22.png">

### Linha horizontal leve(Autor no final)
<img width="713" alt="Screenshot 2022-07-20 at 13 51 46" src="https://user-images.githubusercontent.com/69835383/180038935-61f9b7ba-bd30-4259-9568-d8ebc45bd68a.png">

### H√≠fen
<img width="975" alt="Screenshot 2022-07-20 at 13 43 08" src="https://user-images.githubusercontent.com/69835383/180037316-545276ca-b82e-4dc0-9510-ed9d43dc803f.png">

### Linha horizontal leve
<img width="983" alt="Screenshot 2022-07-20 at 13 46 02" src="https://user-images.githubusercontent.com/69835383/180037837-bcdc63e0-6233-477a-a027-30161d532e27.png">

Coloquei essas ideias, n√£o sei se algu√©m tem alguma outra alternativa que harmonize e destaque melhor a visibilidade do autor e/ou hor√°rio.

>> Coment√°rio de filipedeschamps:
@vinicius-arcanjo show! O que acha de testarmos o padr√£o `¬∑` que j√° divide os outros itens?

>> Coment√°rio de vinicius-arcanjo:
> @vinicius-arcanjo show! O que acha de testarmos o padr√£o `¬∑` que j√° divide os outros itens?

Opa, segue com padr√£o `¬∑`

<img width="645" alt="Screenshot 2022-07-20 at 14 11 25" src="https://user-images.githubusercontent.com/69835383/180042290-2f580bcc-b15c-40c5-8134-33c498f14e1f.png">


<img width="699" alt="Screenshot 2022-07-20 at 14 13 02" src="https://user-images.githubusercontent.com/69835383/180042568-8587b517-5a11-425f-a328-f6bba0258296.png">

>> Coment√°rio de filipedeschamps:
> <img alt="Screenshot 2022-07-20 at 14 11 25" width="645" src="https://user-images.githubusercontent.com/69835383/180042290-2f580bcc-b15c-40c5-8134-33c498f14e1f.png">

Essa primeira vers√£o com o hor√°rio atr√°s e o divisor padr√£o est√° fant√°stica na minha opini√£o! Tem s√≥ um espa√ßo a mais ali na imagem, mas eu voto por essa total.

>> Coment√°rio de filipedeschamps:
Fechado por #541
</issue_530_Adicionar divisor padr√£o na data de publica√ß√£o no `ContentList` (antiga issue sobre mover `username` para √∫ltimo)>

<issue_532_Ajuste de `aria-label` no `TabCoinButtons`>
## Contexto

Quando eu implementei os bot√µes de up/down vote das TabCoins, eu garantidamente copiei e colei de algum lugar e n√£o alterei a propriedade `aria-label` que veio junto com o c√≥digo. Ent√£o hoje est√° com o valor `"Search"` e que deveria ser alterado para algo que fa√ßa sentido com a a√ß√£o de creditar ou debitar TabCoins.

## Execu√ß√£o

- #508

>> Coment√°rio de filipedeschamps:
Fechado por #508
</issue_532_Ajuste de `aria-label` no `TabCoinButtons`>

<issue_533_[Sugest√£o] - Menu de "vagas" de trabalho>
# Menu Vagas

![image](https://user-images.githubusercontent.com/5832193/180069806-2c73e4d0-4ce1-4690-bf90-e33a82b33bbb.png)



Criar uma tabela de tipo de postagem
Nela cadastra os tipos de POST
EX:
- postagem normal (s√£o os tipos de postagem/noticias que ja √© feito hoje)
- vaga de trabalho

Tudo que fosse postagem fica no menu "Tabnews"
Tudo que fosse vaga de trabalho fica no menu "Vagas"

So isso que muda, apenas a filtragem

![image](https://media.giphy.com/media/bAplZhiLAsNnG/giphy.gif)

>> Coment√°rio de ghost:
Acho que s√≥ uma op√ß√£o de filtro e as categorias de post j√° resolveria, n√£o? A pessoa podendo retornar todos os posts ou selecionar o filtro, como [pergunta], [vagas], [tutorial], etc...

>> Coment√°rio de leonardocintra:
> Acho que s√≥ uma op√ß√£o de filtro e as categorias de post j√° resolveria, n√£o? A pessoa podendo retornar todos os posts ou selecionar o filtro, como [pergunta], [vagas], [tutorial], etc...

da certo tamb√©m. Entre ter o link (menu igual ta na imagem) ou filtragem na listagem de postagem seria bom trocar uma ideia com pessoal que manja de UX

>> Coment√°rio de Poveii:
Eu acho que a gente poderia fazer uma abordagem diferente para esse tipo de postagem no Tabnews.
Tipo o principal conte√∫do do Tabnews s√£o as not√≠cias sobre tecnologia. Poder√≠amos criar um t√≥pico fixo quem sabe, que poder√≠amos comentar falando sobre as vagas na √°rea. √â uma ideia.

>> Coment√°rio de Joao620:
Ser√° que vindo uma feature de tags, e tivesse funcionalidade de filtragem por tags e tudo mais, j√° n√£o bastaria? Imagino que a pr√≥pria comunidade se organizaria em ter tags como _#vaga-de-emprego_, e todos que quisessem ver sobre, podem filtrar por ela.

>> Coment√°rio de aprendendofelipe:
@leonardocintra, obrigado pela sugest√£o! üí™

Vou fechar a issue porque faz sentido o que o pessoal comentou sobre tags, ent√£o como j√° existe a #742 sobre o assunto, recomendo centralizar a discuss√£o por l√°. Combinado? ü§ù
</issue_533_[Sugest√£o] - Menu de "vagas" de trabalho>

<issue_534_Nova regra para o `slug` sobre `underscore` e `ampersand`>
## Contexto

- #439

## Execu√ß√£o

- #509

>> Coment√°rio de filipedeschamps:
Fechado por #509
</issue_534_Nova regra para o `slug` sobre `underscore` e `ampersand`>

<issue_540_[Sugest√£o] Rea√ß√µes>
Bom diaaa devsss

O que acham de rea√ß√µes simples nas postagens e principalmente nos coment√°rios do tabnews?
Acredito que ajudaria a evitar mais mensagens como "obrigado", ou "que legal", etc... Mas sem o v√°cuo sdksdks.

Uma ideia seria entrar junto com os tabcoins. Ou seja, a pessoa precisaria de tabcoins para reagir e a postagem receberia tabcoins tamb√©m. 

Pensei em algo clean sem muita polui√ß√£o visual, como as daqui do github, por exemplo, pra ser algo mais a cara do tabnews mesmo. Pensei em rea√ß√µes baseadas nos avatares que o Ezequiel [postou aqui](https://github.com/filipedeschamps/tabnews.com.br/pull/531).

>> Coment√°rio de Joao620:
No [v√≠deo de apresenta√ß√£o da plataforma](https://youtu.be/bYBVCxVwrdY), l√° pelo minuto 3:40 ele fala sobre desestimular coment√°rios simples, e eu sinto que rea√ß√µes mais estilizadas assim vai um pouco contra.

Como a sua issue mesmo, que possui rea√ß√µes, mas n√£o teve mais coment√°rios construtivos ou coment√°rios de apoio mais elaborados.

E sobre o problema de parecer deixar algu√©m no v√°cuo eu entendo, j√° gastei muitos coins para dar essa aten√ß√£o üòÖ. Por agora eu s√≥ t√¥ tentando ter uma mudan√ßa de mente, e imaginar que todos l√™em minha mensagem, e esperar que pensam assim de mim tamb√©m

>> Coment√°rio de aprendendofelipe:
Independentemente de adicionarmos outros tipos de rea√ß√µes, o que acham de adicionar os bot√µes de votos positivos e negativos l√° embaixo ao lado do bot√£o de responder?

Em muitas publica√ß√µes eu sinto falta dos bot√µes estarem vis√≠veis ao t√©rmino da leitura principal, ent√£o as vezes volto para o topo da p√°gina para votar e posso acabar n√£o lendo os coment√°rios, ou posso n√£o voltar para o topo e seguir lendo lendo os coment√°rios, mas acabar esquecendo de votar no conte√∫do principal.

Poderia ser uma mudan√ßa de local, ou deixar nos dois locais. Uma outra alternativa seria usar `position: sticky`. Acho que vou subir um PR com essa √∫ltima alternativa pra gente ver como fica.

>> Coment√°rio de Rafatcb:
Particularmente eu n√£o gosto de ter v√°rias rea√ß√µes, porque complicaria a mec√¢nica dos TabCoins e TabCash. Acho que o simples funciona melhor.

Sobre o `position: sticky`, eu acho uma boa. J√° tive que ler conte√∫do longo e voltar para votar nele. Acredito que o ideal seria ter um limite para n√£o passar da linha do Responder (isso √© importante no caso de respostas com muitas respostas). Me parece que vale um issue separado para isso, n√£o @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
J√° tem um deploy em homologa√ß√£o com uma pequena amostra do `position: sticky`.

Nesse teste, s√≥ est√° fixando o conte√∫do principal e o primeiro n√≠vel de respostas, ou seja, fiz um meio termo que n√£o √© legal, mas ajuda a imaginar como ficaria as duas alternativas que penso serem interessantes, que √© fixar s√≥ do conte√∫do principal ou fixar tamb√©m de todos os coment√°rios:

https://tabnews-git-sticky-tabcoinbuttons-tabnews.vercel.app/sowlfie/programacao-de-robotica-ideias-criativas-para-controlar-maquinas-via-codigo

Se acharem que merece um bom debate antes, √© bom abrir outra issue, mas tamb√©m pode ser dada a opini√£o no #1455, mesmo ele j√° estando fechado. ü§ù

----

Sobre as rea√ß√µes, algo que j√° pensei √© de apresentar um menu com op√ß√µes extras logo ap√≥s algu√©m qualificar um conte√∫do, dando a chance de enviar um feedback an√¥nimo para o autor sobre o motivo do voto, seja positivo ou negativo, mas esse feedback sendo totalmente opcional e restrito a quem qualificou.
</issue_540_[Sugest√£o] Rea√ß√µes>

<issue_542_Adiciona SVG de todos os logos/icones do `bot` do TabNews>
## Contexto

O @ezequiaslopesdasilva fez uma s√©rie de logos/√≠cones para o [Discord do TabNews](https://discord.gg/w7xeym9fx5). Quando v√≠ achei simplesmente **sensacional**, tanto pela qualidade do trabalho, quanto por conseguirmos usar em p√°ginas espec√≠ficas, como por exemplo a p√°gina de `404` ou `500` (ou qualquer outro lugar que fa√ßa sentido).

## Execu√ß√£o

- #531

>> Coment√°rio de filipedeschamps:
Fechado por #531
</issue_542_Adiciona SVG de todos os logos/icones do `bot` do TabNews>

<issue_544_[Bug] Estou logado com outro usu√°rio>
Acabei de entrar no TabNews e me deparei com isso: 

![Design sem nome](https://user-images.githubusercontent.com/30873873/180444487-56ecf987-1635-498f-9a3e-f802791696d2.png)

Por algum motivo estou logado com outro usu√°rio, estou no trabalho agora ent√£o n√£o vou conseguir investigar isso agora, mas me parece algo urgente.

N√£o tentei fazer publica√ß√£o ou usar os tabcoins para ver se a api apresenta algum erro, mas j√° atualizei a p√°gina e continuei assim.

@filipedeschamps @aprendendofelipe

>> Coment√°rio de filipedeschamps:
@ErickCReis muito obrigado por reportar! Estou investigando! Voc√™ saberia dizer se isso aconteceu do nada?

>> Coment√°rio de ErickCReis:
Sim, ontem a noite tenho quase certeza que estava logado com meu usu√°rio, e hoje de manh√£ s√≥ abri o site e estava assim.

>> Coment√°rio de filipedeschamps:
@ErickCReis qual seu usu√°rio dentro do TabNews?

>> Coment√°rio de ErickCReis:
erickreis

>> Coment√°rio de filipedeschamps:
@ErickCReis estou verificando se alguma sess√£o conflitou üëç

>> Coment√°rio de aprendendofelipe:
U√©, roubou minha sess√£o? üò±

>> Coment√°rio de filipedeschamps:
@ErickCReis  voc√™ poderia enviar um email para contato@tabnews.com.br com o valor que est√° em `session_id` nos Cookies?

<img width="249" alt="image" src="https://user-images.githubusercontent.com/4248081/180446558-8412c447-cd52-473b-b822-c8f65cf04d12.png">

>> Coment√°rio de ErickCReis:
Enviado

>> Coment√°rio de filipedeschamps:
Investigando!

>> Coment√°rio de filipedeschamps:
Vou reportando aqui qualquer informa√ß√£o que eu encontrar, mas por enquanto de fato no banco de dados a sess√£o que o @ErickCReis enviou por email aponta para o `user_id` do @aprendendofelipe e essa sess√£o foi criada `2022-05-26 00:25:19.423693+00` UTC e continua sendo revalidada.

Investigando ü§ù

>> Coment√°rio de filipedeschamps:
@ErickCReis invalidei a sess√£o, se poss√≠vel pe√ßo que ao tentar fazer um refresh da p√°gina voc√™ est√° deslogado.

>> Coment√°rio de GuiLra:
Aconteceu o mesmo comigo ![Design sem nome](https://i.imgur.com/9w7Nx6x.png)

>> Coment√°rio de filipedeschamps:
@GuiLra voc√™ poderia me enviar o seu `session_id` para o email contato@tabnews.com.br?

>> Coment√°rio de filipedeschamps:
Estou desconfiado que a nova rota das thumbnails esteja cacheando os cookies, ou alguma outra rota.

>> Coment√°rio de aprendendofelipe:
> @ErickCReis invalidei a sess√£o, se poss√≠vel pe√ßo que ao tentar fazer um refresh da p√°gina voc√™ est√° deslogado.

Eita! Acabou de revogar o acesso no meu celular. Devia ser essa a sess√£o original com esse id

>> Coment√°rio de filipedeschamps:
@aprendendofelipe faz sentido ü§ù  voc√™ lembra de ter compartilhado alguma publica√ß√£o com o novo sistema de thumbnail din√¢mica?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe faz sentido ü§ù voc√™ lembra de ter compartilhado alguma publica√ß√£o com o novo sistema de thumbnail din√¢mica?

N√£o compartilhei, mas cliquei no link dos exemplos que voc√™ enviou ontem

>> Coment√°rio de aprendendofelipe:
E fiz isso pelo celular

>> Coment√°rio de GuiLra:
@filipedeschamps Eu acho que tem a ver com esses links. Eu tmb consegui acessar a conta do @ErickCReis  ![Imgur](https://i.imgur.com/FsET7Ct.png)

>> Coment√°rio de filipedeschamps:
@aprendendofelipe obrigado pelas informa√ß√µes! Estou tentando vazar minha session_id para confirmar o bug ü§ù

>> Coment√°rio de filipedeschamps:
Consegui confirmar o bug ü§ù  atrav√©s de uma aba logada, eu acessei uma thumbnail e isso fez o endpoint da API que gera ela ser cacheando, inclusive o **cookie**. Em seguida, eu peguei essa URL da thumbnail e acessei numa aba an√¥nima e a CDN da Vercel retornou o cache, incluindo o cookie.

Est√° sendo feito um deploy nesse exato momento que exclui esse cache e em seguida vou invalidar todas as sess√µes.

>> Coment√°rio de filipedeschamps:
Em paralelo, com este novo deploy, todos os caches j√° foram invalidados.

>> Coment√°rio de filipedeschamps:
**Confirmei que com o novo deploy, o session_id n√£o est√° mais sendo cacheado, nem vazado.**

Em paralelo, notei o seguinte:

Na implementa√ß√£o do `/thumbnail`, a linha que definia o cache era a seguinte:

```js
response.setHeader('Cache-Control', 's-maxage=60, stale-while-revalidate');
```

Por√©m, temos outras rotas que tamb√©m definem o cache de `stale-while-revalidate`, como por exemplo `/status`, mas ese bug nunca aconteceu antes. E no endpoint de `/status`, est√° implementado assim:

```js
response.setHeader('Cache-Control', 'public, s-maxage=1, stale-while-revalidate');
```

nota que tem a flag `public`.

Estou investigando aqui se isso foi o ponto central do problema ü§ù

>> Coment√°rio de aprendendofelipe:
> Em paralelo, com este novo deploy, todos os caches j√° foram invalidados.

Precisa excluir os deploys recentes da Vercel, pois se estiverem no ar podem ser usados para roubar a sess√£o

>> Coment√°rio de aprendendofelipe:
Ser√° que dois acessos dentro do mesmo segundo na rota status n√£o gera o mesmo problema?

>> Coment√°rio de aprendendofelipe:
Estou longe de qualquer computador agora, ent√£o n√£o consigo dar uma ajuda melhor.

>> Coment√°rio de filipedeschamps:
> Precisa excluir os deploys recentes da Vercel, pois se estiverem no ar podem ser usados para roubar a sess√£o

Perfeito! Exclui todos que foram criados a partir da primeira implementa√ß√£o, foram 19 (inclui tanto todos os testes em ambiente de Homologa√ß√£o quanto Produ√ß√£o).

>> Coment√°rio de filipedeschamps:
> Ser√° que dois acessos dentro do mesmo segundo na rota status n√£o gera o mesmo problema?

Essa √© uma √≥tima pergunta, pois eu tamb√©m pensava que numa lamba √© poss√≠vel entrar duas requests ao mesmo tempo, mas depois que eu fiz aquela bateria de testes para construir o pool do banco de dados, consegui confirmar que isso n√£o acontece, √© uma request por lambda, e se precisar paralelizar, a AWS invoca uma nova lambda. Isso tamb√©m foi confirmado pelo pessoal que contribui para o m√≥dulo `pg` ü§ù 

Mas nesse momento n√£o quero descartar nada, s√≥ afunilar um pouco a pesquisa, porque a todo momento estou acessando o `/status` e esse problema pipocou em quantidade s√≥ agora (com o deploy do `/thumbnail`) e com a raiz sendo o a sess√£o do seu celular. Mas novamente, esse n√£o √© o momento para descartar nada ü§ù

>> Coment√°rio de filipedeschamps:
> Estou longe de qualquer computador agora, ent√£o n√£o consigo dar uma ajuda melhor.

Sua ajuda j√° foi fundamental @aprendendofelipe ü§ù voc√™ ter reportado que clicou na URL da thumbnail pelo celular e ao invalidar a sess√£o foi a sua do celular aumentou muito a defini√ß√£o do problema üëç

>> Coment√°rio de filipedeschamps:
@ErickCReis e @GuiLra uma pergunta para ter mais informa√ß√µes sobre a origem do bug: voc√™s chegaram a interagir com a URL da thumbnail l√° daquela issue, ou qualquer URL de thumbnail?

>> Coment√°rio de ErickCReis:
> @ErickCReis e @GuiLra uma pergunta para ter mais informa√ß√µes sobre a origem do bug: voc√™s chegaram a interagir com a URL da thumbnail l√° daquela issue, ou qualquer URL de thumbnail?

Sim, ontem acessei as 3 urls que vc colocou no pr.

>> Coment√°rio de GuiLra:
> @ErickCReis e @GuiLra uma pergunta para ter mais informa√ß√µes sobre a origem do bug: voc√™s chegaram a interagir com a URL da thumbnail l√° daquela issue, ou qualquer URL de thumbnail?

Eu acessei as 3 urls que colocou no pr.

>> Coment√°rio de aprendendofelipe:
> Est√° sendo feito um deploy nesse exato momento que exclui esse cache e em seguida vou invalidar todas as sess√µes.

@filipedeschamps, voc√™ falou em invalidar todas as sess√µes, quer dizer de todos os usu√°rios do TabNews? Mas ainda n√£o fez isso, n√©? √â que acabei de verificar em um computador que a minha sess√£o ainda est√° ativa.

>> Coment√°rio de filipedeschamps:
> @filipedeschamps, voc√™ falou em invalidar todas as sess√µes, quer dizer de todos os usu√°rios do TabNews? Mas ainda n√£o fez isso, n√©? √â que acabei de verificar em um computador que a minha sess√£o ainda est√° ativa.

Correto! Assim que eu terminar a investiga√ß√£o no PR #546 e ter certeza desse comportamento vou invalidar. Estou no √∫ltimo teste e conseguindo isolar ou n√£o, eu vou invalidar todas sess√µes e publicar no TabNews um postmortem ü§ù

>> Coment√°rio de filipedeschamps:
**Identifiquei onde est√° o problema.**

Bom, continuando as pesquisas aqui, rodei a mesma bateria de testes em produ√ß√£o no `/status` que rodei no `/thumbnail` e n√£o √© poss√≠vel replicar o mesmo bug. No `/thumbnail` foi zero atrito replicar o bug (no momento que a rota estava cacheada, o cookie estava l√°), e no `/status` n√£o consigo de forma alguma. Ent√£o minha pesquisa foi o seguinte:

1. Comecei especulando que h√° algo de especial na flag `public` do `Cache-Control`, pois essa foi a √∫nica mudan√ßa que fiz para evitar que o Cookie fosse armazenado. Comecei a cavucar um monte de artigo, como [esse aqui](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) e tamb√©m perguntas no Stack Overflow, e nenhuma delas respondeu com clareza o que o `public` faz, a n√£o ser falando que isso faz um cache ficar p√∫blico (mas n√£o exatamente quais informa√ß√µes ficam cacheadas).
2. Ent√£o para aprofundar a investiga√ß√£o, eu criei o PR #546 que reconstr√≥i o bug no endpoint `/status` no Ambiente de Homologa√ß√£o.
3. Eu sa√≠ de uma posi√ß√£o sem bug e com os mesmos `60` segundos de cache que tinha no `/thumbnail` (diferente do cache de `1` segundo que originalmente essa rota tinha).
4. Mas o interessante √© que mesmo removendo a flag `public` o bug n√£o se replica. Eu n√£o sei se os servidores de CDN para o cache em ambiente de homologa√ß√£o s√£o diferentes do de produ√ß√£o.
5. Encucado com a situa√ß√£o, li com calma o Controller que implementa o `/thumbnail` e identifiquei o maior ofensor, [que √© isso aqui](https://github.com/filipedeschamps/tabnews.com.br/blob/c2163c901bea80da3950f8ced125811285a544c5/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/thumbnail/index.public.js#L15).
6. Ele est√° injetando a sess√£o do usu√°rio na request, coisa que o endpoint `/status` n√£o faz. Ent√£o o cache do `stale-while-revalidate` est√° de fato cacheando **tudo**, mas isso n√£o √© um problema se voc√™ n√£o injetar nessa rota a sess√£o do usu√°rio e por consequ√™ncia n√£o cachear o `Set-Cookie` de retorno.
7. Ent√£o se o `Set-Cookie` de retorno que devolve a sess√£o atualizada ficar cacheado na CDN, qualquer navegador que ler esse comando vai de fato setar o cookie de sess√£o no lado do client.
8. Ent√£o com isso, injetei o usu√°rio no `/status` e agora consigo replicar o bug 100% das vezes.

Estou invalidando todas as sess√µes, criando o postmortem (vou publicar eles juntos) e criar outro PR para remover a inje√ß√£o do usu√°rio naquela rota, mesmo que ela por enquanto n√£o esteja mais sendo cacheada.

Em paralelo, nas rotas com cache, podemos pedir para [n√£o fazer o cache do Set-Cookie](https://security.stackexchange.com/questions/262955/does-cache-control-no-cache-set-cookie-set-cookie2-actually-prevent-caching) a pesar de que o resultado n√£o √© garantido, mas isso √© o in√≠cio para ficar mais protegido nesse ponto.

Muito obrigado a todos pela ajuda nos dados!!!

Assim que resetar as sess√µes, publicar o postmortem e fazer o merge do PR que remove a inje√ß√£o do usu√°rio irei fechar essa issue ü§ù

>> Coment√°rio de filipedeschamps:
Sess√µes invalidadas e postmortem criado: https://www.tabnews.com.br/filipedeschamps/postmortem-todas-as-sessoes-foram-invalidadas-por-conta-do-endpoint-thumbnail

Vou fazer o PR removendo a inje√ß√£o do usu√°rio no endpoint `/thumbnail` ü§ù

>> Coment√°rio de filipedeschamps:
Feito o merge do PR #547 que faz parar a inje√ß√£o da sess√£o do usu√°rio no `/thumbnail`.

## Ambiente de Produ√ß√£o antes deste deploy:

Note que o `session_id` √© retornado no `Set-Cookie` do `response` como esperado, pelo fato do endpoint estar injetando e revalidando a sess√£o do usu√°rio:

![image](https://user-images.githubusercontent.com/4248081/180485704-84f6d8f4-2f55-4123-8f8e-ae9f54742703.png)



## Ambiente de Produ√ß√£o depois deste deploy:

`Set-Cookie` n√£o est√° sendo mais retornado no `response`, e agora esse retorno pode voltar a ter cache:

![image](https://user-images.githubusercontent.com/4248081/180485767-e3f604f8-110f-40e5-8a94-0ca15e50e4cc.png)



## Aprendizados

1. Tomar cuidado redobrado em qualquer endpoint que seja escolhido fazer qualquer tipo de cache p√∫blico.
2. `Set-Cookie` tamb√©m consegue ser cacheado na CDN.
3. Pesquisar mais sobre `no-cache="Set-Cookie"` e se √© poss√≠vel definir isso de forma global (e se tem algum efeito).

---

Estou fechando esta issue, mas **qualquer** outra informa√ß√£o pe√ßo que volte a abrir ela ou dependendo do qu√£o sens√≠vel a informa√ß√£o √©, entrar em contato atrav√©s de `contato@tabnews.com.br` ü§ù
</issue_544_[Bug] Estou logado com outro usu√°rio>

<issue_548_(Melhoria) TabNews na tela inicial de dispositivos m√≥veis>
Isso na verdade, foi uma sugest√£o do @maiagusta (no TabNews). [https://www.tabnews.com.br/maiagusta/sugestao-pra-quem-usa-a-pagina-adicionada-na-tela-inicial-do-dispositivo-movel](https://www.tabnews.com.br/maiagusta/sugestao-pra-quem-usa-a-pagina-adicionada-na-tela-inicial-do-dispositivo-movel)


Se adicionado o seguinte c√≥digo na p√°gina inicial do TabNews, quando a pessoa adiciona o atalho na tela inicial, a barra de texto (ou de url) some e √© como se o site fosse um aplicativo.
```html 
 <meta name="mobile-web-app-capable" content="yes"/>
 <meta name="apple-mobile-web-app-capable" content="yes"/>
```

>> Coment√°rio de filipedeschamps:
@gabrielsozinho show!!! Sugest√£o: o que acha de abrir um PR com essa implementa√ß√£o, mostrando com prints o antes e depois?

>> Coment√°rio de gabrielsozinho:
> @gabrielsozinho show!!! Sugest√£o: o que acha de abrir um PR com essa implementa√ß√£o, mostrando com prints o antes e depois?

@filipedeschamps opa, desculpa, mas eu ainda to com problema no meu computador e n√£o fa√ßo id√©ia de como fazer pelo celular üôÄ

Por√©m, eu posso mostrar prints de como fica o GitHub (ele tem essa implementa√ß√£o). Vou editar esse coment√°rio daqui a pouco com os prints.


![Vizualiza√ß√£o no navegador](https://i.imgur.com/brv9gdD_d.webp?maxwidth=640&shape=thumb&fidelity=medium) (Vizualiza√ß√£o no navegador(com a barra de menu e da url))
<br>

![](https://i.imgur.com/tfjwyyB_d.webp?maxwidth=640&shape=thumb&fidelity=medium) (Quando adicionado na tela inicial)
<br>

![](https://i.imgur.com/s6hhCdD_d.webp?maxwidth=640&shape=thumb&fidelity=medium) (Vizualiza√ß√£o no web app (sem a barra de menu e url))
<br>

![](https://i.imgur.com/X4fnb7z_d.webp?maxwidth=640&shape=thumb&fidelity=medium3) (Enquanto abre o web app (isso pode variar de navegador pra navegador))
<br>

![](https://i.imgur.com/FXqe5ZP_d.webp?maxwidth=640&shape=thumb&fidelity=medium) (Isso √© na navega√ß√£o de abas do celular, aparece como se fosse um aplicativo mesmo)

>> Coment√°rio de filipedeschamps:
Fechado por #553
</issue_548_(Melhoria) TabNews na tela inicial de dispositivos m√≥veis>

<issue_550_[bug] site retorna uma listagem vazia logo na primeira vez em que o site √© acessado ap√≥s a invalida√ß√£o das sess√µes>
Opaa salve galera!

 (J√° avisando kkk, esse √© o meu primeiro contato com o repo do projeto, assim pe√ßo desculpas se caso eu falar ou der alguma sugest√£o equivocada nessa issue)

 Um bug que aconteceu comigo duas vezes (e acho que todos podem estar enfrentando o msm problema) √© que ap√≥s ter sido feita a [invalida√ß√£o de todas as sess√µes](https://www.tabnews.com.br/filipedeschamps/postmortem-todas-as-sessoes-foram-invalidadas-por-conta-do-endpoint-thumbnail) que aconteceu ontem a noite (dia 21/07), √© que quando fui acessar a p√°gina do tabnews, por estar com a sess√£o invalidada, foi retornado para mim a listagem de conte√∫do vazia. Mas dando reload na p√°gina, o site voltou com o comportamento esperado, mostrando a listagem dos conte√∫dos.

![Screenshot_2022-07-22-20-52-12-511_com android chrome](https://user-images.githubusercontent.com/52766091/180584787-0a947abd-a141-4c7a-a607-65af0c78e34f.jpg)
Exemplo do bug

 Esperamos que no futuro n√£o seja necess√°rio ter que invalidar todas as sess√µes novamente, mas como uma forma de preven√ß√£o e at√© msm, de melhora para caso haver algum case em o usu√°rio passe por algum conflito com a sua sess√£o, para n√£o haver uma m√° UX, acho que poder√≠amos criar algum approach para prevenir esse comportamento. 

Talvez, a partir de algum retorno espec√≠fico da API, poder√≠amos for√ßar o reload da p√°gina no front, ou at√©, fazer com que a listagem de conte√∫dos retorne da API msm que a sess√£o esteja invalidada.

>> Coment√°rio de filipedeschamps:
@MattFerreira18 seja muito bem vindo ao reposit√≥rio e √≥tima primeira contribui√ß√£o ü§ù 

Esse comportamento tamb√©m me deixou chateado e ele est√° sendo causado por essas linhas:

https://github.com/filipedeschamps/tabnews.com.br/blob/3d06906be74851504645a253285a75b287e4c09d/pages/api/v1/contents/index.public.js#L19-L22

Ent√£o na primeira request, o client recebe uma p√°gina est√°tica com todas as publica√ß√µes como esperado, mas logo em seguida por baixo dos panos √© feita uma request para API para **revalidar** os dados, e √© nesse momento que o endpoint `/contents` nega a request de `GET`, por tentar injetar e revalidar a sess√£o do usu√°rio ali na linha `19`.

Nesse endpoint, injetar e revalidar a sess√£o n√£o √© necess√°ria para o verbo `GET`, mas √© necess√°ria para o `POST` que est√° logo abaixo na linha `22`. De qualquer forma, mais para frente vamos precisar transformar o `GET` num retorno gen√©rico e _cache√°vel_ para n√£o sofrer o mesmo problema da issue #544 ü§ù

>> Coment√°rio de aprendendofelipe:
Al√©m da necessidade de uma revis√£o dos endpoints que precisam revalidar sess√£o e dos que podem ter cache, tem mais um um detalhe relacionado ao problema e que o @filipedeschamps n√£o comentou.

A fun√ß√£o `injectAnonymousOrUser` precisa de uma pequena reformula√ß√£o para tamb√©m chamar a `injectAnonymousUser` caso exista cookie de sess√£o, mas a sess√£o n√£o esteja v√°lida.

Imagino que n√£o deveria acontecer da fun√ß√£o `injectAnonymousOrUser` retornar o erro "Usu√°rio n√£o possui sess√£o ativa" ao inv√©s de retornar o "usu√°rio an√¥nimo".

Provavelmente o melhor seria qualquer erro retornado por `injectAuthenticatedUser` fazer chamar `injectAnonymousUser`.

Faz sentido?

>> Coment√°rio de filipedeschamps:
Interessant√≠ssimo @aprendendofelipe acredito que fa√ßa sentido sim!

>> Coment√°rio de aprendendofelipe:
Com as modifica√ß√µes em #1060 e #1374, acredito que esse bug n√£o deve mais ocorrer.

Ent√£o vou encerrar a issue.

Muito obrigado @MattFerreira18! üí™
</issue_550_[bug] site retorna uma listagem vazia logo na primeira vez em que o site √© acessado ap√≥s a invalida√ß√£o das sess√µes>

<issue_554_[Sugest√£o] Ferramenta para prever custo AWS>
Bom dia Devss

Estes dias estava navegando na internet, acho que no LinkedIn se n√£o me engano, e acabei me deparando com um post sobre uma lib/ extens√£o do VS Code que tem como intuito calcular o custo de uma infra que √© usado o Terraform para a mesma, achei uma delicia, dai pensei em falar da mesma por aqui, pois acredito que para um projeto Open source devemos ter total controle sobre o custo de cada altera√ß√£o que fazemos na infra.

Ferramenta que recomento: https://www.infracost.io
Git publico da mesma: https://github.com/infracost/infracost

Segue um exemplo da extens√£o do VS Code que gerou no projeto, ambiente de Dev!
![CleanShot 2022-07-23 at 08 24 56](https://user-images.githubusercontent.com/34342635/180603030-0cf05c85-602f-4ec4-9404-f2a3a78b4a4e.png)

E o mesmo print, porem agora em produ√ß√£o!
![CleanShot 2022-07-23 at 08 25 47](https://user-images.githubusercontent.com/34342635/180603052-3107b764-708f-46d8-a908-d64b2c59900e.png)

Para calcular ferramentas mais din√¢micas da AWS como o S3, pode ser usado um arquivo que tem uma simula√ß√£o de uso mensal, com isso partir deles, √© calculado!

>> Coment√°rio de filipedeschamps:
@TheMarkWill QUE SENSACIONAL!

Por favor, voc√™ se importaria em criar uma publica√ß√£o l√° no TabNews? Na √©poca que eu estava implementando o Terraform, foi um **caos** simular custos com as calculadoras da AWS... isso teria ajudado MUITO!

>> Coment√°rio de marconneves:
Boa, vou bolar um artigo bunitinho, acho que at√© segunda sai hehe ü§§ü§§

>> Coment√°rio de marconneves:
@filipedeschamps acabei de postar por l√°, espero realmente que tenha ficado bom. Era minha vontade a muito tempo come√ßar a escrever conte√∫do. Qualquer dica me manda um alo :) 
https://www.tabnews.com.br/themarkwill/prevendo-custo-de-arquitetura-terraform

>> Coment√°rio de Rafatcb:
√ìtima recomenda√ß√£o. Creio que podemos fechar esse issue para organizar o reposit√≥rio. Foi bom ter levado o conte√∫do para o TabNews tamb√©m :+1:

>> Coment√°rio de aprendendofelipe:
Show @marconneves, fechando a issue! üí™
</issue_554_[Sugest√£o] Ferramenta para prever custo AWS>

<issue_555_[sugest√£o] criar documenta√ß√£o da API>
E a√≠ turma!

 Como no futuro esse projeto vai se tornar p√∫blico, e at√©, para melhorar a DX para os novos devs que querem se aventurar no projeto (assim como eu kk), queria propor de a gente implementar alguma documenta√ß√£o da API.

 De lib para montar a documenta√ß√£o, uma que particularmente gostei muito foi a [Redoc](https://github.com/Redocly/redoc), que foi at√© implementada no BrasilAPI.

 O que voc√™s acham?

>> Coment√°rio de gabrielsozinho:
Opa, eu to trabalhando na cria√ß√£o da documenta√ß√£o. Primeiro eu vou postar l√° no TabNews mesmo, e se aceito, depois a gente implementa a Redoc. O que acha?

>> Coment√°rio de imattferreira:
> Opa, eu to trabalhando na cria√ß√£o da documenta√ß√£o. Primeiro eu vou postar l√° no TabNews mesmo, e se aceito, depois a gente implementa a Redoc. O que acha?

TOP! Gostei da ideia.

>> Coment√°rio de gabrielsozinho:
Acabei de publicar a primeira vers√£o da documenta√ß√£o l√° no TabNews!
[https://www.tabnews.com.br/GabrielSozinho/documentacao-da-api-do-tabnews](https://www.tabnews.com.br/GabrielSozinho/documentacao-da-api-do-tabnews)

>> Coment√°rio de CarlosZiegler:
Massa, acabei criando um PR usando Redoc: 
https://github.com/filipedeschamps/tabnews.com.br/pull/599

>> Coment√°rio de aprendendofelipe:
Apenas registrando aqui os PRs que j√° foram abertos e que podem servir de inspira√ß√£o para a cria√ß√£o de um PR atualizado:

- #557 
- #599 
- #799

>> Coment√°rio de Jeiel0rbit:
Ol√°, equipe!

Gostaria de sugerir a cria√ß√£o de uma documenta√ß√£o para este reposit√≥rio, utilizando a plataforma Docs Page. Aqui est√£o algumas das vantagens:

- F√°cil Configura√ß√£o: O Docs Page permite gerar documenta√ß√£o diretamente a partir dos arquivos markdown (.md) existentes no reposit√≥rio.

- Atualiza√ß√µes Autom√°ticas: Sempre que um arquivo markdown √© alterado no reposit√≥rio, a documenta√ß√£o √© atualizada automaticamente.

- Interface Simples: Oferece uma interface limpa e f√°cil de navegar, ideal para desenvolvedores e usu√°rios finais.

- Gratuito: A plataforma √© gratuita e pode ser integrada sem a necessidade de grandes configura√ß√µes adicionais.


Acredito que adicionar uma documenta√ß√£o organizada ir√° melhorar a experi√™ncia dos colaboradores e novos usu√°rios e menos confuso üòï.

O que acham?

https://docs.page/
https://docs.page/get-started

@Rafatcb @gabrielsozinho @aprendendofelipe

>> Coment√°rio de Rafatcb:
O Docs Page me pareceu um site interessante para criar a documenta√ß√£o, e poder escrev√™-la em Markdown seria √≥timo, pois permite a leitura pelo pr√≥prio reposit√≥rio, facilita a manuten√ß√£o e independ√™ncia do "servi√ßo de documenta√ß√£o", mas n√£o me parece um site de documenta√ß√£o de API.

Dois PRs abertos usaram o Redoc, que n√£o cheguei a ver. Seria interessante termos alguns sites de refer√™ncia para entendermos o caminho que queremos tomar, tamb√©m.

>> Coment√°rio de Jeiel0rbit:
> Dois PRs abertos usaram o Redoc, que n√£o cheguei a ver. Seria interessante termos alguns sites de refer√™ncia para entendermos o caminho que queremos tomar, tamb√©m.

Que tal https://redocly.com/docs ?

![](https://redocly.com/assets/example.9a2eec80cee59ade26b2a1bb1690055d8c0a62d83d1c17edd5537214d668d606.21e399be.svg)

@imattferreira d√™ uma olhada tamb√©m.

>> Coment√°rio de KitsuneSemCalda:
Gostaria de sugerir o uso de swagger para automatizar a cria√ß√£o e a atualiza√ß√£o da api conforme h√° atualiza√ß√µes no c√≥digo fonte, o resultado poderia se tornar um simples github pages. Apenas para melhorar a DX conforme o projeto avan√ßa
</issue_555_[sugest√£o] criar documenta√ß√£o da API>

<issue_558_`BUG` Implementa√ß√£o da `thumbnail`>
Com a nova implementa√ß√£o do thumbnail (que foi genial), surgiu um "bug" para respostas a postagens que possuem um t√≠tulo muito grande, como:

![https://www.tabnews.com.br/api/v1/contents/filipedeschamps/2a1f8451-dc1e-4a33-8ce8-aaac4f59cf2f/thumbnail](https://www.tabnews.com.br/api/v1/contents/filipedeschamps/2a1f8451-dc1e-4a33-8ce8-aaac4f59cf2f/thumbnail)

Como pode-se perceber o texto est√° comendo a `pasta`

>> Coment√°rio de OtavioVB:
Acredito que para a manuten√ß√£o disso √© necess√°rio reparo nessa linha de c√≥digo 
presente na pasta: `models/thumbnail
```javascript
parent_title = parent_title?.length > 50 ? parent_title.substring(0, 50) + '...' : parent_title; // alterar de 50 para 42 +/-
```

>> Coment√°rio de OtavioVB:
Procurando descobrir o problema que estava ocasionando isso, eu descobri que:

```javascript
parent_title = parent_title?.length > 50 ? parent_title.substring(0, 50) + '...' : parent_title;
```

Esse c√≥digo n√£o leva em considera√ß√£o os caracteres `Em resposta a ` e por tais motivos excede o limite permitido de "50 caracteres"... Desse modo acredito que o ideial √© diminuir esse limite em 14 que √© o n√∫mero de caracteres do texto "Em resposta a "
</issue_558_`BUG` Implementa√ß√£o da `thumbnail`>

<issue_560_Previnir problemas de "overflow", incluindo para textos Zalgo>
## Contexto

Contexto envolve parte do que foi reportado na issue #400 e parte do que est√° no pr√≥prio PR listado na se√ß√£o Execu√ß√£o aqui abaixo.

## Execu√ß√£o

- #425
- #562
- #564
- #567
- #604

>> Coment√°rio de filipedeschamps:
Fechado por #562
</issue_560_Previnir problemas de "overflow", incluindo para textos Zalgo>

<issue_561_`BUG` P√°ginas exclu√≠das aparecem nos buscadores do google>
H√° um tempo eu havia feito um artigo nas postagens do TabNews sobre uma `instru√ß√£o do csharp`. Recentemente, precisei pesquisar novamente para me aprofundar no assunto e acabei me esbarrando na minha publica√ß√£o. Logo, eu pensei, u√©? Essa publica√ß√£o eu tinha exclu√≠do...

Enfim:
![image](https://user-images.githubusercontent.com/101956836/180818697-327be539-5ad4-4254-88d9-ed5face85131.png)
Quando eu clico √© retornado `ERRO 404`.

Eu n√£o sei se o tabnews tem o `sitemap` e esse `sitemap` n√£o est√° sendo exclu√≠do ap√≥s a remo√ß√£o da postagem.

>> Coment√°rio de agjunior:
N√£o acho que isso seja um bug. 

A p√°gina est√° retornando o status 404 corretamente e a remo√ß√£o depende s√≥ do Google agora. 

O bot n√£o remove a p√°gina no primeiro erro porque pode ser apenas uma falha tempor√°ria, ent√£o as p√°ginas demoram um pouco mais pra sair do que pra entrar na busca.

Tamb√©m n√£o tenho certeza se o sitemap ajudaria nesse caso, j√° que a ideia do sitemap √© ajudar os buscadores em quais p√°ginas eles devem indexar e n√£o o contr√°rio.

>> Coment√°rio de agjunior:
Existe uma maneira melhor de lidar com esse problema que seria usando o c√≥digo `410 Gone` em vez do `404 Not Found` para informar ao Google que a p√°gina foi propositalmente exclu√≠da.

Esse artigo aqui explica um pouco:
https://www.searchenginejournal.com/google-404-status/254429/

>> Coment√°rio de filipedeschamps:
> Existe uma maneira melhor de lidar com esse problema que seria usando o c√≥digo 410 Gone em vez do 404 Not Found para informar ao Google que a p√°gina foi propositalmente exclu√≠da.

Muito interessante isso. N√≥s podemos identificar se o conte√∫do existe mas foi deletado para retornar o `410` ou simplesmente n√£o existe e retornar `404`.
</issue_561_`BUG` P√°ginas exclu√≠das aparecem nos buscadores do google>

<issue_565_D√∫vidas gerais sobre a contribui√ß√£o>
Eu fiz um PR recentemente aqui e me surgiram muitas d√∫vidas sobre fazer isso corretamente, sou novo com tudo isso e quero muito contribuir mas tenho bastante d√∫vidas ainda (inclusivd fico o tempo inteiro inseguro sobre como agir aqui...
E acredito que mais gente tamb√©m compartilhe algumas das mesmas d√∫vidas.

As principais s√£o:

`O que s√£o aqueles "lint commits e como faz eles"? `

`As PRs podem ser mais gerais ou s√£o mais espec√≠ficas? (Por exemplo as p√°ginas de erro que t√¥ fazendo, coloco as p√°ginas de 500, 404, 410, 403 no mesmo PR ou separado (t√° s√≥ o PR da 404 por enquanto) )`

`Al√©m do "roteiro" no npm run commit o que mais precisa ter no commit?`
Eu mesmo fiz um PR com a 404 mas n√£o sei se est√° tudo certo.

`Portugu√™s, ingl√™s ou tanto faz?`

`Posso abrir issues com perguntas "meio bestas" assim?`

```O que acham de colocar uma explica√ß√£o de como contribuir com o projeto pra galera (tipo eu kkkk) que t√° iniciando e ainda n√£o entende muito bem do processo do github por exemplo? ```
Eu mesmo poderia fazer mas preciso entender primeiro  dkakdka.

>> Coment√°rio de filipedeschamps:
√ìtimas perguntas, vamos para as respostas:

### O que s√£o aqueles "lint commits e como faz eles"

`lint` s√£o certas regras que v√£o verificar se o que voc√™ fez est√° dentro dos padr√µes estabelecidos por essas regras. Ent√£o o c√≥digo tem `lint` para o estilo dele (n√£o vai deixar voc√™ programar sem ponto e v√≠rgula, por exemplo), e as mensagens de commit tamb√©m tem `lint`.

Para criar commits que ir√£o passar pelo `lint`, digite o comando abaixo:

```
npm run commit
```

### As PRs podem ser mais gerais ou s√£o mais espec√≠ficas? (Por exemplo as p√°ginas de erro que t√¥ fazendo, coloco as p√°ginas de 500, 404, 410, 403 no mesmo PR ou separado (t√° s√≥ o PR da 404 por enquanto) )

N√£o temos regra para isso por enquanto. Nesse caso eu faria p√°gina apenas para `500` e `404` e colocaria dentro do mesmo PR. Inclusive, [testei a p√°gina de `404` e ficou linda](https://tabnews-git-fork-nottja1mmm-main-tabnews.vercel.app/pagina-inexistente).

### Al√©m do "roteiro" no npm run commit o que mais precisa ter no commit?

Acho que nada a mais e o CI vai avisar se est√° tudo certo. No caso do seu PR #549 infelizmente a Vercel pulou na frente e travou todo o fluxo da Action (que rodaria o `lint` dos commits). Mesmo eu destravando a Vercel ali, n√£o rodou os checks. Mas sem problemas, eu consigo for√ßar de novo.

### Portugu√™s, ingl√™s ou tanto faz?

Tudo que estiver dentro do c√≥digo deve ser em ingl√™s (coment√°rios, vari√°veis, fun√ß√µes, etc). Toda documenta√ß√£o externa deve ser em portugu√™s (README, issues e PRs). Os PRs tem a caracter√≠stica de levar seu t√≠tulo para dentro do commit de merge, e n√£o tem problema. Prefiro uma comunica√ß√£o flu√≠da aqui fora acima de tudo.

### Posso abrir issues com perguntas "meio bestas" assim?

Pode e estas perguntas n√£o s√£o bestas.

### O que acham de colocar uma explica√ß√£o de como contribuir com o projeto pra galera (tipo eu kkkk) que t√° iniciando e ainda n√£o entende muito bem do processo do github por exemplo?

Acho √≥timo!

>> Coment√°rio de aprendendofelipe:
Parab√©ns @nottja1mmm, ficou muito boa a p√°gina 404! ü§©

>> Coment√°rio de ghost:
Obrigado pelas respostas! Ajudou 100%!

> Acho √≥timo!

@filipedeschamps 

Que bomm!
Acha que d√° pra colocar uma sec√ß√£o de "como contribuir" no readme ou em algum outro lugar?

>> Coment√°rio de filipedeschamps:
Total! Acho que d√° pra inclusive englobar isso aqui: https://github.com/filipedeschamps/tabnews.com.br#commit-das-altera%C3%A7%C3%B5es

>> Coment√°rio de issdomingoss:
@aprendendofelipe Ola, tudo bem? Corrigi uma issue e gostaria de fazer o push do meu codigo, porem diz que nao tenho permissao, pode me ajudar quanto a isso? Primeira vez fazendo contribuicao! Abracos!!!

>> Coment√°rio de kaique-soares:
Ol√° @issdomingoss, seja muito bem-vindo ao reposit√≥rio do TabNews :handshake: 

Suponho que voc√™ tenha clonado este reposit√≥rio diretamente na sua m√°quina e caso seja isso mesmo, esse erro de permiss√£o √© o esperado. Com isso, voc√™ precisa fazer um `fork` deste reposit√≥rio para sua conta, ou seja, criar uma c√≥pia do TabNews por√©m na sua conta, onde voc√™ tem permiss√£o de escrita.

![Screenshot from 2023-03-17 18-29-39](https://user-images.githubusercontent.com/57193392/226057086-8f5f3109-3221-4de9-b209-5602ea1f7af4.png)

Ap√≥s isso, sugiro criar uma nova branch, implementar suas modifica√ß√µes, commitar e abrir uma `Pull Request`. Da√≠ tu deve conseguir enviar sua contribui√ß√£o para c√° :+1: 

Qualquer d√∫vida, n√£o hesite em perguntar, combinado :+1:

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe Ola, tudo bem? Corrigi uma issue e gostaria de fazer o push do meu codigo, porem diz que nao tenho permissao, pode me ajudar quanto a isso? Primeira vez fazendo contribuicao! Abracos!!!

Boa @issdomingoss! üí™

√â como o @kaique-soares explicou. E tem mais dicas nessa publica√ß√£o do @rodrigoKulb:

https://www.tabnews.com.br/rodrigoKulb/boas-praticas-para-criar-um-pull-request-no-projeto-tabnews-com-br

Muito bem vido! ü§ó

>> Coment√°rio de aprendendofelipe:
Considerando que o @Rafatcb j√° referenciou essa issue na mensagem https://github.com/filipedeschamps/tabnews.com.br/issues/605#issuecomment-1838995532 para levarmos ao `CONTRIBUTING.md` parte do que foi esclarecido aqui, e que n√£o houve novas d√∫vidas desde mar√ßo, vou dar essa issue como conclu√≠da. ü§ù

Muito obrigado pelas contribui√ß√µes! üí™
</issue_565_D√∫vidas gerais sobre a contribui√ß√£o>

<issue_569_Logout>
## Contexto

Hoje n√£o √© poss√≠vel fazer o logout do TabNews, nem pela interface, nem pela API. A √∫nica forma de fazer isso √© deletando o cookie de sess√£o manualmente (e removendo o objeto de `user do `LocalStorage`) mas isso n√£o invalida a sess√£o no backend.

## Execu√ß√£o

Precisamos primeiro remover a sess√£o no backend para depois refletir isso no frontend.

- [x] #570
- [x] #571

>> Coment√°rio de filipedeschamps:
Fechado por #484
</issue_569_Logout>

<issue_570_`session(api)`: endpoint `/sessions` conseguir invalidar a sess√£o atual com `DELETE`>
## Contexto

Hoje o endpoint de sessions `/api/v1/sessions` n√£o est√° habilitado para receber um `DELETE` e invalidar a sess√£o do usu√°rio logado. Precisamos expor isso para que pelo client as pessoas consigam se deslogar.

## Execu√ß√£o

Uma implementa√ß√£o foi iniciada no PR #484 feito por @gabriel-ayusso e v√°rios pontos muito legais foram levantados l√° pelo @aprendendofelipe . O PR tamb√©m traz ao mesmo tempo as implementa√ß√µes no backend e frontend, sendo que no backend a estrat√©gia adotada foi de fazer um "hard delete" da sess√£o do banco de dados. Sugiro n√£o seguirmos essa rota, at√© como foi levantado no pr√≥prio PR, deletar um dado como este ir√° dificultar auditorias quando necess√°rias.

Para manter o dado sem precisar adicionar uma coluna nova para controlar a validade de uma sess√£o, basta atualizarmos a data da expira√ß√£o do token para uma data atual ou no passado (de prefer√™ncia no passado para evitarmos qualquer tipo de bug relacionado a fuso hor√°rio).

√â muito importante tamb√©m se certificar que o formato do token que est√° sendo enviado na request √© v√°lido.

>> Coment√°rio de filipedeschamps:
Fechado por #484
</issue_570_`session(api)`: endpoint `/sessions` conseguir invalidar a sess√£o atual com `DELETE`>

<issue_571_`session(page)`: adicionar link de Logout no menu do usu√°rio>
## Contexto

Implementar no menu do usu√°rio logado um novo link para conseguir fazer o Logout.

## Execu√ß√£o

Possivelmente vai ser entregue junto com este outro PR: #484

>> Coment√°rio de filipedeschamps:
Fechado por #484
</issue_571_`session(page)`: adicionar link de Logout no menu do usu√°rio>

<issue_572_Bug no corpo do conte√∫do ao visualizar no celular>
Turma, vejam esse v√≠deo abaixo, acabou de acontecer e eu n√£o estou entendendo exatamente como replicar, apensar de que se eu ficar clicando e arrastando randomicamente, uma hora s√≥ o corpo do conte√∫do faz um scroll:

https://user-images.githubusercontent.com/4248081/181096503-3d4598cf-db3e-4f92-92e9-1b7c4c319919.MP4

>> Coment√°rio de aprendendofelipe:
Aparentemente o post foi editado depois que voc√™ gravou, pois a imagem est√° diferente e foi postada no Imgur a menos tempo do que o post.

N√£o sei se tem alguma rela√ß√£o, mas talvez seja legal o nandokferrari postar na ambiente de homologa√ß√£o, caso ele saiba o que foi alterado entre as duas vers√µes.

>> Coment√°rio de filipedeschamps:
@aprendendofelipe dando refresh aqui pelo celular ainda consigo reproduzir o bug ü§ù

>> Coment√°rio de filipedeschamps:
O markdown utilizado na publica√ß√£o foi o seguinte:

```markdown
![bun logo](https://i.imgur.com/7QB5GgA.png)

Lan√ßado o beta de Bun, o javascript runtime que promete fazer node e deno comerem poeira.

# √â s√©rio, voc√™ n√£o vai acreditar na velocidade.

Bun √© um novo JavaScript runtime com bundler native. Transpile, instale e rode projetos JavaScript e TypeScript ‚Äî todos diretamente no Bun.

Eu sei que o t√≠tulo desse artigo te chamou a aten√ß√£o, para a velocidade da cria√ß√£o dos projetos, mas saiba que bun √© r√°pido para todo o restante. Extremamente r√°pido para instalar pacotes npm, para rodar em modo de desenvolvimento, para buildar o seu projeto, e assim por diante... Vai por mim, voc√™ vai estranhar a velocidade :) 

Site oficial para aprender um pouco mais: https://bun.sh/

**Lembrando que ainda encontra-se na vers√£o beta.**

---

Instale o bun
---

Primeiro certifique-se de que voc√™ j√° n√£o o tenha instalado. Abra o terminal de sua m√°quina e digite:

    bun -v

Se algo como **"command not found"** retornar, √© porque ainda n√£o o tem instalado. Ent√£o digite:

    curl https://bun.sh/install | bash

Crie seu app React
---
Agora rode o seguinte comando para criar um app React.

    bun create react [seu-app]

Isso ir√° criar um novo diret√≥rio com o nome escolhido para seu app. Para iniciar o app, rode ent√£o os seguintes comandos:

    cd seu-app
    bun dev

Configurando "bun build" para gerar o bundle de produ√ß√£o
---

Por padr√£o, Bun n√£o vem com com react-scripts instalado, portanto, voc√™ deve instalar esse pacote como depend√™ncia de desenvolvimento, a flag **-d** realiza essa tarefa:

    bun a react-scripts -d

Ent√£o rode o seguinte comando para realizar o build de produ√ß√£o

    bun react-scripts build

Ap√≥s ter executado, o seu build de produ√ß√£o estar√° dispon√≠vel dentro da pasta **/build** dentro do diret√≥rio do seu app.

Adicionando scripts ao seu package.json
---
Devemos adicionar os seguintes scripts ao nosso package.json

    {
      "scripts": {
        "start": "bun dev",
        "build": "react-scripts build"
      }
    }

Rodando o projeto
---
Podemos rodar o seguinte comando para rodar nosso app

    bun start

Gerando build de produ√ß√£o
---

    bun run build

Adicione pacotes npm ao seu app
---
Se voc√™ est√° acostumado com npm, deve conhecer o comando **npm install [pacote]**.
Caso voc√™ j√° era adepto ao yarn, com certeza utilizava o **yarn add [pacote]**

Agora com o bun, voc√™ usar√° o seguinte comando, para adicionar novos pacotes ao seu projeto:

    bun a [pacote]


#### Usando TypeScript no projeto

> Por padr√£o **bun** cria aplica√ß√µes React com javascript, por√©m nos podemos facilmente utilizar TypeScript alterando a extens√£o dos arquivos `.jsx` para `.tsx`
```

>> Coment√°rio de aprendendofelipe:
N√£o consegui reproduzir nem no Chrome e nem no Safari. Posta no ambiente de homologa√ß√£o e v√™ se voc√™ s√≥ tem o problema ap√≥s a implementa√ß√£o do overflow: auto ou se nos deploys antigos tamb√©m... Se for isso, deveria estar aparecendo as barras de rolagem extras, mas vamos tentar isolar.

>> Coment√°rio de OtavioVB:
Bom, foi a primeira vez que vejo um post com logo de cara uma imagem, isso pode ser um fator importante para descrever o erro, estou realizando alguns testes para ver como a imagem se comporta com texto antes ou sem...

>> Coment√°rio de filipedeschamps:
Turma, fiz os testes e pode ter sido o `overflow`, olha s√≥:

### Branch recente (poss√≠vel reproduzir o bug)
https://tabnews-git-feature-deslogar-tabnews.vercel.app/filipedeschamps/crie-aplicacoes-react-5x-mais-rapido-com-bun

### Branch antiga (n√£o √© poss√≠vel reproduzir o bug)
https://tabnews-git-fix-tabcoins-localstorage-tabnews.vercel.app/filipedeschamps/crie-aplicacoes-react-5x-mais-rapido-com-bun

### V√≠deo (tem audio)

https://user-images.githubusercontent.com/4248081/181289313-2494bc9d-496e-45b1-a6e6-fa77d5d0024f.MP4

>> Coment√°rio de filipedeschamps:
Fechado por #604
</issue_572_Bug no corpo do conte√∫do ao visualizar no celular>

<issue_573_`Question` Isso era para acontecer ou n√£o?>
Estava realizando alguns testes no ambiente de homologa√ß√£o e apareceu isso:

![image](https://user-images.githubusercontent.com/101956836/181121961-87a5afeb-5557-4ea7-8a9c-af31d1bf3247.png)

>> Coment√°rio de filipedeschamps:
@OtavioVB sim, voc√™ caiu no nosso Firewall que evita spam de conte√∫dos. O bom √© que deu para testar o alerta aqui do meu lado üòç 

<img width="522" alt="image" src="https://user-images.githubusercontent.com/4248081/181122447-acb45072-ae91-47d8-bfb5-227fdef9f75d.png">

Pensando aqui, talvez eu devesse deixar o Firewall menos sens√≠vel em Homologa√ß√£o, vou fazer isso ü§ù

>> Coment√°rio de OtavioVB:
> @OtavioVB sim, voc√™ caiu no nosso Firewall que evita spam de conte√∫dos. O bom √© que deu para testar o alerta aqui do meu lado üòç
> 
> <img alt="image" width="522" src="https://user-images.githubusercontent.com/4248081/181122447-acb45072-ae91-47d8-bfb5-227fdef9f75d.png">
> 
> Pensando aqui, talvez eu devesse deixar o Firewall menos sens√≠vel em Homologa√ß√£o, vou fazer isso ü§ù

Sensacional Filipe que show! Acho que n√£o tem muito necessidade de deixar mais sens√≠vel n√£o, eu realmente, fiz muitos em poucos minutos... 

Que show, bom que a gente j√° testamos hahaha

>> Coment√°rio de filipedeschamps:
@OtavioVB feito! O Firewall ainda est√° ativo, mas est√° menos sens√≠vel e voc√™ j√° deve conseguir criar novas publica√ß√µes.

Como efeito colateral de ter ca√≠do na regra do Firewall, as suas √∫ltimas publica√ß√µes foram escondidas automaticamente.
</issue_573_`Question` Isso era para acontecer ou n√£o?>

<issue_574_[melhoria] diminuir font-size dos inputs para dispositivos mobile>
Salve galera!

 Tava fu√ßando no TabNews e vi que o `font-size` dos inputs est√£o um grandes se comparados com os outros font-sizes presentes no site.
![Screenshot_2022-07-26-21-58-17-510_com.brave.browser.jpg](https://user-images.githubusercontent.com/52766091/181139703-f482c4b1-fec8-4122-a283-c14c8100a5f0.jpg)

 Dando uma olhada na implementa√ß√£o desses inputs, √© utilizado o `<TextInput />` do Primer com o size `large`:
https://github.com/filipedeschamps/tabnews.com.br/blob/8a5205b5fdb9a400d94a0a64806beafaaead38d8/pages/cadastro/index.public.js#L138-L147

 Inspecionado esses inputs, pelo padr√£o do Primer, eles recebem um font-size de `inherit`. Como as labels do site possuem um `font-size` de 14px, queria propor de customizar o `font-size` desses inputs para tbm 14px (ou um tamanho similar).

 Caso for aceito essa sugest√£o de melhoria, eu msm posso fazer a implementa√ß√£o dela.

>> Coment√°rio de filipedeschamps:
@MattFerreira18 eu topo total! A quest√£o √© como executar isso da melhor forma, e digo isso porque eu acho que o Primer pode ser respons√≠vel nesse ponto, dado que ele usa o Styled System por baixo dos panos, olha s√≥: https://styled-system.com/responsive-styles/

>> Coment√°rio de imattferreira:
@filipedeschamps acho q a gente poderia subscrever o `font-size` a partir da prop `sx`  do pr√≥prio Primer, mas para n ficar uma implementa√ß√£o muito repetitiva, a gente poderia fazer uma camada de abstra√ß√£o do componente de `<Input />` j√° add essa altera√ß√£o de `font-size`.

 E a partir dessa camada de abstra√ß√£o, a gente pode at√© incluir alguns outros componentes q s√£o praticamente indispens√°veis na implementa√ß√£o do` <Input />`, como o componente de `<Label />`.

 Essa camada de abstra√ß√£o ficaria mais ou menos assim:
 ```js
import { FormControl, TextInput } from '@primer/react';

export default function Input({ onChange, name, type, size, error, message }) {
  return (
    <>
      <FormControl.Label>Repita a senha</FormControl.Label>
      <TextInput
        name={name}
        type={type}
        size={size}
        sx={{ fontSize: [14, null, 16] }}
        onChange={onChange}
      />
      {error && (
        <FormControl.Validation variant="error">{message}</FormControl.Validation>
      )}
    </>
  )
}
```

>> Coment√°rio de filipedeschamps:
Show! Tenho dois medos: 

1. Primeiro medo √© construirmos uma abstra√ß√£o prematura e ficar lutando com a evolu√ß√£o do Primer.
2. Segundo medo √© hardcode o tamanho da fonte ali com o `fontSize`, porque isso ao longo do tempo pode ir "descalibrando" a interface. Ao longo que o Primer evoluir, ele pode globalmente ir lapidando a fonte, e esse input poder√° ficar dessincronizado dessas atualiza√ß√µes.

De qualquer forma, eu testei a responsividade direto na propriedade `size`, mas fica bem bugado (fica maior que o `large`), apesar de ficar responsivo:

```js
size={['medium', 'large']}
```
<img width="524" alt="image" src="https://user-images.githubusercontent.com/4248081/181410112-c94a9674-2b8d-464e-81b5-1fdc095ab600.png">

E nos testes notei que o pr√≥prio Primer aumenta o tamanho da fonte quando pega o breakpoint menor.

Talvez mexer nisso n√£o deveria ser nosso foco agora ü§ù

>> Coment√°rio de imattferreira:
Ahh entendi, andei dando uma pesquisada e tbm n achei um approach melhor para reduzir esse font-size. Ent√£o j√° vou chegar essa issue.
</issue_574_[melhoria] diminuir font-size dos inputs para dispositivos mobile>

<issue_580_Ajusta m√©todo que cria o `slug` para considerar `/` como `-`>
## Contexto

Notei isso na [publica√ß√£o que fiz hoje](https://www.tabnews.com.br/filipedeschamps/como-ter-uma-receita-de-us-2-7-milhoesano-com-0-funcionarios): Se um t√≠tulo possui algo como `2,7 milh√µes/ano` vai converter de forma errada para `2-7-milhoesano` ao inv√©s de `2-7-milhoes-ano`.

O m√©todo de gerar o slug n√£o est√° convertendo `/` em `-`.

## Execu√ß√£o

- #594

>> Coment√°rio de filipedeschamps:
Fechado por #594
</issue_580_Ajusta m√©todo que cria o `slug` para considerar `/` como `-`>

<issue_582_Ajuste ao girar a tela do celular (vertical <-> horizontal)>
## Contexto

- #515

## Execu√ß√£o

- #581

>> Coment√°rio de filipedeschamps:
Fechado por #581
</issue_582_Ajuste ao girar a tela do celular (vertical <-> horizontal)>

<issue_584_P√°ginas customizadas de `404` e `500`>
## Contexto

Hoje ao esbarrar em uma URL que n√£o existe, ou numa p√°gina que retorne um erro interno, √© oferecida as p√°ginas padr√µes do Next.js que ficam com o layout meio que quebrado por conta do Primer. Independente disso, √© importante termos essas p√°ginas de erro customizadas para podemos redirecionar o usu√°rio para Home ou dar alguma instru√ß√£o adicional se necess√°rio.

## Execu√ß√£o

- #583
- #585

>> Coment√°rio de filipedeschamps:
Fechado por #583 e #585
</issue_584_P√°ginas customizadas de `404` e `500`>

<issue_586_Adicionar header `mobile-web-app-capable`>
## Contexto

- #548

## Execu√ß√£o

- #553

>> Coment√°rio de filipedeschamps:
Fechado por #553
</issue_586_Adicionar header `mobile-web-app-capable`>

<issue_587_Bug de √≠cone 100% escuro ao adicionar TabNews no celular>
## Contexto

Ao testar o PR #553 notei que o √≠cone do TabNews est√° 100% escuro no celular. Isto n√£o est√° relacionado ao PR #553 pois conseguir reproduzir em Produ√ß√£o antes do merge, este foi o teste:

![IMG_3796](https://user-images.githubusercontent.com/4248081/181382295-e5382c16-86cb-48ec-9cc6-1efbaa44310b.jpg)

## Execu√ß√£o

Entender porque antes funcionava (aparecia o √≠cone com o fundo branco), se tem rela√ß√£o com o tema Dark do celular, ou se √© o fato de estar sendo mostrado um √≠cone com tra√ßado escuro contra um fundo "transparente".

- #595

>> Coment√°rio de imattferreira:
@filipedeschamps testei aqui no meu phone (um Xiaomi com Android 10 e utilizando um force dark mode nos apps), e tive o msm problema s√≥ q com duas diferen√ßas: 
- quando fui add a home no modal do Chrome o √≠cone do TabNews apareceu corretamente;
- dps de add na home o √≠cone ficou totalmente branco;

 Vou deixar aqui um v√≠deo mostrando esse comportamento:
https://user-images.githubusercontent.com/52766091/181403839-a21a69cc-02a0-4ede-b931-d09c760a2157.mp4

>> Coment√°rio de filipedeschamps:
Que comportamento interessant√≠ssimo!

Ser√° que tem como definir um √≠cone fixo para quando √© mobile?

>> Coment√°rio de filipedeschamps:
Fechado por #595

>> Coment√°rio de filipedeschamps:
Ali√°s, @MattFerreira18 se puder verificar se o comportamento consertou para voc√™ seria show ü§ù

>> Coment√°rio de imattferreira:
@filipedeschamps @rodrigoKulb Show, funcionou certinho para mim

>> Coment√°rio de filipedeschamps:
Para deixar registrado aqui o antes e depois da implementa√ß√£o do @rodrigoKulb 

## Antes

![IMG_3798](https://user-images.githubusercontent.com/4248081/181646035-6f2d6066-4d00-4dd5-8b9c-9a6f7f8b4a46.jpg)

## Depois

Nota que o `manifest` at√© altera o t√≠tulo para algo melhor:

![IMG_3800](https://user-images.githubusercontent.com/4248081/181646056-6c9e9098-1b41-43b6-833e-70c10c40b9af.jpg)

## Home screen

![IMG_3802](https://user-images.githubusercontent.com/4248081/181646106-07400437-3ee1-4266-aa54-2fe43c6b7618.jpg)
</issue_587_Bug de √≠cone 100% escuro ao adicionar TabNews no celular>

<issue_589_Diferenciar publica√ß√µes lidas e n√£o lidas>
## Contexto

Por hora, n√£o h√° diferencia√ß√£o entre links que voc√™ j√° visitou ou n√£o, pois √© o jeito que o Primer trabalha por padr√£o. E a id√©ia inicial era diferenciar links visitados, links n√£o visitados e links novos, tanto que h√° uma discuss√£o mais complexa na issue #518 mas optamos por simplificar e nesse momento trabalhar apenas com links visitados ou n√£o.

## Execu√ß√£o

- #609

>> Coment√°rio de filipedeschamps:
Fechado por #609
</issue_589_Diferenciar publica√ß√µes lidas e n√£o lidas>

<issue_591_Atualizar todas as depend√™ncias do projeto>
## Contexto

N√£o tem muito contexto a n√£o ser que n√£o podemos ficar muito tempo sem atualizar as depend√™ncias por principalmente problemas de seguran√ßa.

Fora isso, h√° o caso da incompatibilidade do Primer com o React 18 que est√° sendo investigado nessa issue:

- #445

## Execu√ß√£o

- #590 
- #601
- #602
</issue_591_Atualizar todas as depend√™ncias do projeto>

<issue_598_Habilitar Github Discussions>
Ola pessoal, 
Recentemente vi uma postagem de usar o github discussions para comunica√ß√£o colaborativo:  https://docs.github.com/pt/discussions/quickstart

Nao seria uma boa usar isso aqui ? Pergunto pois vejo algumas perguntas nas issues e tambem no proprio site do TabNews, nao que isso seja um problema mas nao fica centralizado. O que voce acha?  @filipedeschamps

>> Coment√°rio de CarlosZiegler:
Mais sobre :  https://github.blog/2022-07-26-launching-github-community-powered-by-github-discussions/

>> Coment√°rio de allangrds:
Apoiado! Acho que enquanto campos das ideias √© o melhor lugar para se conversar, e ainda podemos categorizar os assuntos

>> Coment√°rio de filipedeschamps:
Show @CarlosZiegler essa sugest√£o j√° surgiu no passado. Pe√ßo que leia [essa resposta](https://github.com/filipedeschamps/tabnews.com.br/issues/480#issuecomment-1182525179) principalmente na √∫ltima sugest√£o que eu dou e me diga o que acha ü§ù

>> Coment√°rio de allangrds:
@filipedeschamps Entrando na discuss√£o, hehe.

Acho que os prop√≥sitos s√£o diferentes. As issues dever√£o ser convertidas futuramente em PRs, sendo bugs, melhorias ou funcionalidades, j√° a parte de discuss√£o seria pra poder falar do que achamos que falta na plataforma, por exemplo.

- Issues: t√©cnico, execu√ß√£o
- Discussion: ideias de melhorias pra plataforma, sem tocar no t√©cnico

Sobre deixar isso no Tabnews, entendo que ficaria aberto pra comunidade, mas ficaria tudo muito disperso, pois atualmente n√£o existe uma categoriza√ß√£o das postagens, e nem possibilidade de pesquisa.
</issue_598_Habilitar Github Discussions>

<issue_600_[Sugest√£o] C√≥digo de conduta>
O @filipedeschamps sempre consegue criar uma comunidade em torno das coisas que faz, e isso √© incr√≠vel. Pensando nisso, e na grandiosidade do TabNews, acho muito importante termos um c√≥digo de conduta(CODE_OF_CONDUCT.md) deste projeto, para definirmos os padr√µes da comunidade, comunica√ß√£o e como lidar com poss√≠veis abusos.

# Refer√™ncias

1. Code of conduct: https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-code-of-conduct-to-your-project
2. Evento Python Brasil: https://github.com/pythonbrasil/codigo-de-conduta
3. Flutter Brasil: https://github.com/FlutterComunidadeBR/codigo-de-conduta#c%C3%B3digo-de-conduta

>> Coment√°rio de jackson541:
Excelente ideia @allangrds! Aproveitando a deixa, acredito que seria legal tamb√©m ter um c√≥digo de conduta para quem usa o TabNews, informando o que pode ou n√£o ser feito dentro da plataforma e o que se espera dos usu√°rios.

>> Coment√°rio de filipedeschamps:
@allangrds caramba que saudades de trabalhar com voc√™ üòç  para quem n√£o sabe, a gente trabalhou juntos no Pagar.me ü§ù 

Sobre o CoC acho sensacional! Inclusive isso com certeza precisa pivotar para o TabNews como o @jackson541 comentou.

Eu usaria como base o que est√° escrito no par√°grafo _**"Quem s√£o as pessoas que participam do TabNews?"**_ dessa publica√ß√£o: https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa

>> Coment√°rio de allangrds:
Como preferem fazer? J√° crio um PR apontando pra essa issue e vamos discutindo o que mudar por l√°?

>> Coment√°rio de Rafatcb:
Estava investigando para resolver este issue. Parece que o c√≥digo de conduta tem mais a ver com o site do que o reposit√≥rio. Acredito que podemos usar o pr√≥prio [template do Contributor Covenant](https://www.contributor-covenant.org/translations/), sugerido pelo GitHub, com algumas adapta√ß√µes:

* A a√ß√£o corretiva n√£o √© um aviso privado, porque a modera√ß√£o n√£o tem esse recurso.
* N√£o temos "advert√™ncia" do jeito que est√° descrito no template.
* Remo√ß√£o da parte de banimento tempor√°rio (n√£o temos isso).

[Link direto para a vers√£o pt-BR](https://www.contributor-covenant.org/pt-br/version/2/1/code_of_conduct/code_of_conduct.md) (esse link realizar√° o download do template).

E talvez fizesse sentido ter algo sobre isso dentro do site, j√° que os Termos de Uso n√£o tratam as coisas nesse aspecto, como a especifica√ß√£o das diretrizes de aplica√ß√£o, al√©m de que os Termos de Uso abordam temas mais espec√≠ficos, j√° que o c√≥digo de conduta √© "o m√≠nimo" que qualquer lugar deveria ter.
</issue_600_[Sugest√£o] C√≥digo de conduta>

<issue_605_[Sugest√£o] Como contribuir>
Seguindo uma mesma linha do c√≥digo de conduta(CODE_OF_CONDUCT.md) proposta em outra issue(#600), sugiro que tenhamos um guia de como contribuir para o projet(CONTRIBUTING.md).

Nos t√≥picos podemos abordar:
- Como forkar o reposit√≥rio e criar um pull request;
- Explicar um pouco sobre o padr√£o de c√≥digo(eslint)
- Explicar um pouco sobre o padr√£o de commit
- Explicar sobre como funcionam as cria√ß√µes de issues

# Refer√™ncias
- https://chromium.googlesource.com/chromium/deps/mozdownload/+/5d3e0bf7851b093ff9a89d45f13185691c496bec/CONTRIBUTING.md
- https://gist.github.com/PurpleBooth/b24679402957c63ec426
- https://gitlab.com/gitlab-org/gitlab-foss/-/blob/master/CONTRIBUTING.md

>> Coment√°rio de Rafatcb:
O `README.md` hoje est√° bom como base para contribuir no reposit√≥rio (foi a refer√™ncia que tive para realizar a primeira contribui√ß√£o e me serviu bem), ent√£o pode ser usado como base para a cria√ß√£o do `CONTRIBUTING.md`.

Acho importante mencionar que um Issue deve ser criado em caso de sugest√£o/nova funcionalidade, para que n√£o aconte√ßa de algo que v√° ser rejeitado seja implementado, ou para receber sugest√µes de como implementar ou funcionalidades complementares. O problema de "PR rejeitado" acontece bastante com o exemplo de abrir links em novas guias.

Tem um coment√°rio do Felipe Barso falando sobre criar issues antes de PR: https://github.com/filipedeschamps/tabnews.com.br/pull/1528#issuecomment-1751716387

> Se o problema que voc√™ quer resolver ainda n√£o estiver documentado em uma issue, ent√£o abra uma nova e exponha primeiro o problema, e depois proponha a solu√ß√£o (na issue mesmo e sem preocupa√ß√£o com a implementa√ß√£o).

Esse processo n√£o est√° documentado, mas por ter visto esse coment√°rio, foi o que fiz antes da minha primeira contribui√ß√£o.

---

Edit: Vi um issue que cont√©m algumas coisas que podem ir para o `CONTRIBUTING.md` tamb√©m: https://github.com/filipedeschamps/tabnews.com.br/issues/565

>> Coment√°rio de aprendendofelipe:
@allangrds, muito obrigado por iniciar esse debate! üí™

Acrescentando informa√ß√µes ao que o @Rafatcb j√° trouxe, tem tamb√©m uma sugest√£o de `CONTRIBUTING.md` no PR #1005:

https://github.com/filipedeschamps/tabnews.com.br/blob/5f2d13e2c583a22136ce171f14b440d01d1a60a5/.github/CONTRIBUTING.md

Eu concordo com o @Rafatcb sobre o `README.md` ser usado como base, onde algumas coisas podem sair de l√° e ir para o `CONTRIBUTING.md` com os devidos links entre os dois arquivos.

>> Coment√°rio de aprendendofelipe:
Analisando o caminho tomado em #1583, fiquei em d√∫vida se √© o melhor caminho. Acredito que temos que separar alguns pontos que ficaram muito misturados ali no CONTRIBUTING.md.

- A parte de "Como rodar o projeto" acho que pode permanecer no README.md. E alguns detalhes extras podem ser adicionados onde fizer mais sentido (README.md ou CONTRIBUTING.md);
- A lista de diferentes formas de como contribuir com o projeto tamb√©m pode ser adicionada ao README.md, mas sem entrar em detalhes e direcionando para √¢ncoras no CONTRIBUTING.md;
- Explica√ß√µes detalhadas, e n√£o espec√≠ficas do TabNews, sobre como contribuir com c√≥digo aberto, como usar Git e GitHub etc. n√£o precisam estar nesses dois arquivos. Acho que no m√°ximo devemos colocar links para outros documentos auxiliares, sejam do TabNews ou externos;

### README.md

Eu n√£o gostei de como ele ficou vazio. Acho que merece pouca altera√ß√£o sobre o que temos hoje, e talvez nem precise ser no mesmo PR:

- Adicionar uma explica√ß√£o do que √© o TabNews (talvez igual ao do FAQ);
- Remover o "di√°rio de desenvolvimento", ou mudar o nome para algo que deixe claro que ali s√≥ consta o in√≠cio do desenvolvimento e explicar sobre as milestones;
- Retirar a parte sobre `nvm`, j√° que √© um pouco diferente para o Windows, e por n√£o ser algo obrigat√≥rio.
- Listar as formas de contribuir, mas sem entrar em detalhes:  reportar privadamente problemas de seguran√ßa, criar conte√∫dos e coment√°rios no site, debater nas issues do reposit√≥rio e enviar PRs com as solu√ß√µes previamente debatidas;


### CONTRIBUTING.md

Dar os detalhes sobre cada forma de contribuir:

- Reportar problemas de seguran√ßa: Explicar como reportar privadamente.
- Criar conte√∫dos e coment√°rios no site: Aqui talvez seja melhor n√£o entrar em detalhes e direcionar para o FAQ ou p√°gina "Sobre" do site (e do README.md tamb√©m pode ir direto para o mesmo local);
- Debater nas issues do reposit√≥rio: Explicar sobre os tipos de issues e o que √© esperado, por exemplo o texto em portugu√™s;
- Enviar PRs: Citar que devem ser relacionados com as issues previamente debatidas e adicionar parte do que foi colocado no PR #1583. Talvez sem alguns detalhes, como os comandos necess√°rios e outras informa√ß√µes sobre contribui√ß√µes de c√≥digo aberto em geral.


Faz sentido?

>> Coment√°rio de Rafatcb:
Enquanto eu escrevia o `CONTRIBUTING.md`, me perguntei o que deveria permanecer no `README.md`, tentando evitar um redirecionamento do tipo "Quer contribuir? Veja o outro arquivo. Est√° lendo o arquivo para contribuir e quer executar o projeto? Veja o outro arquivo e depois volte aqui para continuar a entender como contribuir."

Terei essas observa√ß√µes em mente na pr√≥xima altera√ß√£o do PR.

>> Coment√°rio de aprendendofelipe:
> Veja o outro arquivo e depois volte aqui para continuar a entender como contribuir."

N√£o √© um problema, pois √© praticamente imposs√≠vel criar documenta√ß√£o abrangente sem fazer esses desvios. √â claro que h√° formas melhores e piores de se fazer isso. Algo que acho importante, quando envolve procedimentos, √© colocar tamb√©m o link para voltar ao ponto de antes do desvio.

>> Coment√°rio de Rafatcb:
O @emerson-oliveira sugeriu (https://github.com/filipedeschamps/tabnews.com.br/pull/1583#issuecomment-1872366331) tamb√©m adicionarmos ao `CONTRIBUTING.md` metodologias espec√≠ficas adotadas para o desenvolvimento do front-end e do back-end, por exemplo o uso do [Primer](https://primer.style/guides/introduction). Tem algo mais, espec√≠fico do TabNews, que possa ser adicionado?

Edit: Me parece que esse tipo de informa√ß√£o faria mais sentido no `README.md`, que j√° cont√©m instru√ß√µes de como rodar o projeto, realizar modifica√ß√µes, criar migrations etc.

>> Coment√°rio de Rafatcb:
Fiz algumas altera√ß√µes no PR #1583 para separar melhor as informa√ß√µes entre o README e CONTRIBUTING. Al√©m disso, detalhei um pouco mais os tipos de contribui√ß√£o, tirei as explica√ß√µes sobre fork, branches e como abrir o PR, deixando os detalhes sobre o template existente, os testes e aprova√ß√£o dos mantenedores.

Expliquei sobre o Primer no `README.md`, acho que a explica√ß√£o ficou bem completa, deixando os detalhes para a pr√≥pria documenta√ß√£o do Primer, e pode evitar alguns erros comuns que j√° vi acontecerem em PRs:

> ## Sobre o Frontend
>
> Os componentes de UI utilizados no TabNews s√£o do [Primer](https://primer.style/guides/introduction), o design system do GitHub. Ou seja, sempre que for necess√°rio exibir um aviso, input, texto, ou qualquer outra coisa, isso √© feito com componentes espec√≠ficos do Primer.
>
> Al√©m de fornecer os componentes em React, o Primer tamb√©m possui orienta√ß√µes de como proporcionar uma melhor experi√™ncia para o usu√°rio. Voc√™ pode buscar orienta√ß√µes mais gerais na documenta√ß√£o do Primer, sobre os [fundamentos](https://primer.style/foundations) e [padr√µes de UI](https://primer.style/ui-patterns), ou informa√ß√µes espec√≠ficas sobre [componentes](https://primer.style/components).
>
> Para ter uma melhor experi√™ncia com o uso dos componentes Primer, existem alguns conceitos que voc√™ deve ter em mente durante o desenvolvimento, como por exemplo: a [propriedade `sx`](https://primer.style/react/overriding-styles) para estiliza√ß√£o, [uso de temas](https://primer.style/react/theming) e [conceitos centrais](https://primer.style/react/core-concepts) do Primer.

A parte "sobre o Backend" ficou praticamente vazia porque n√£o consegui pensar no que colocar l√°, principalmente porque as modifica√ß√µes que fiz no c√≥digo at√© ent√£o n√£o tocaram no backend.

Essas informa√ß√µes est√£o no `README.md`, n√£o sei se seriam melhor no `CONTRIBUTING.md`
</issue_605_[Sugest√£o] Como contribuir>

<issue_606_[Sugest√£o] Enviar por e-mail novas postagens>
Eu n√£o sei voc√™s, mas eu sou ainda o tioz√£o que usa muito e-mail... Todo dia eu checko meu e-mail para ver alguma novidade do GitHub (altera√ß√µes do reposit√≥rio do tabnews e de outros reposit√≥rios meus), de outras plataformas, recebimento de respostas, enfim, muitas vezes eu entro no tabnews para ver coisas novas, mas na verdade n√£o tem coisas novas.

Gostaria de saber do que voc√™s acham de adicionar uma `implementa√ß√£o para recebimento de e-mails de post's novos do tabnews`?

>> Coment√°rio de Rafatcb:
Acho que n√£o h√° necessidade de criar essa implementa√ß√£o, agora que temos RSS (desde Agosto/2022): https://github.com/filipedeschamps/tabnews.com.br/pull/621. O que voc√™ acha, @OtavioVB?

Edit: Tamb√©m √© preciso levar em conta a quantidade de novas publica√ß√µes que temos na plataforma hoje, que √© bem diferente de Julho/2022 (veja a p√°gina [tabnews.com.br/status](https://www.tabnews.com.br/status)).

>> Coment√°rio de aprendendofelipe:
@OtavioVB, obrigado pela sugest√£o!

Existem propostas para implementar notifica√ß√µes em diferentes casos, como seguir publica√ß√µes selecionadas ou qualquer publica√ß√£o/coment√°rio de determinados usu√°rios. Isso provavelmente ser√° implementado em algum momento.

Se o interesse for em monitorar todas as publica√ß√µes *root*, acredito que seja mais interessante acompanhar a p√°gina de recentes ou o RSS. N√£o vejo como algo interessante para o TabNews, e nem para os usu√°rios, enviar um monte de emails para cada nova publica√ß√£o.

J√° se o interesse √© em acompanhar todas as novas publica√ß√µes, incluindo os coment√°rios, acredito que em algum momento futuro possa ser implementada uma aba em que os conte√∫dos sejam organizados pelo hor√°rio do √∫ltimo coment√°rio, o que deve resolver essa demanda espec√≠fica.

Agora notificar por email sobre todas as publica√ß√µes, at√© mesmo coment√°rios, n√£o vejo como algo vi√°vel, ent√£o vou fechar a issue como "n√£o planejado". Mas qualquer coisa podemos reabrir o debate. ü§ù
</issue_606_[Sugest√£o] Enviar por e-mail novas postagens>

<issue_607_[Sugest√£o] Enviar por e-mail novas postagens>
Eu n√£o sei voc√™s, mas eu sou ainda o tioz√£o que usa muito e-mail... Todo dia eu checko meu e-mail para ver alguma novidade do GitHub (altera√ß√µes do reposit√≥rio do tabnews e de outros reposit√≥rios meus), de outras plataformas, recebimento de respostas, enfim, muitas vezes eu entro no tabnews para ver coisas novas, mas na verdade n√£o tem coisas novas.

Gostaria de saber do que voc√™s acham de adicionar uma `implementa√ß√£o para recebimento de e-mails de post's novos do tabnews`?

>> Coment√°rio de OtavioVB:
Problema de internet fez enviar duas issues...
</issue_607_[Sugest√£o] Enviar por e-mail novas postagens>

<issue_610_Fazer o comando `npm test` funcionar em todos os sistemas operacionais>
## Contexto

O comando `npm test` estava funcionando em ambientes `macos`, `linux`, mas n√£o estava funcionando em ambientes `windows`.

## Execu√ß√£o

- #592

>> Coment√°rio de filipedeschamps:
Fechado por #592
</issue_610_Fazer o comando `npm test` funcionar em todos os sistemas operacionais>

<issue_611_[Seguran√ßa] Remover o par√¢metro x-powered-by do cabe√ßalho de resposta>
# Introdu√ß√£o
**N√£o √© uma boa pr√°tica de seguran√ßa** deixar amostra qual servidor est√° sendo rodado por tr√°s, j√° que isso permiti o atacante fazer um ataque direcionado para aquele tipo de servidor. 

![image](https://user-images.githubusercontent.com/62905712/182279631-56f9b988-9dd8-48e3-bf1c-6079f4fd823b.png)

## Solu√ß√£o
1. Aplicar a seguinte config no arquivo de configura√ß√£o do NextJs:
```js
module.exports = {
  poweredByHeader: false,
}
```

## Refer√™ncias
[Stackoverflow](https://pt.stackoverflow.com/questions/78314/por-que-%C3%A9-importante-remover-o-x-powered-by-dos-headers-de-resposta-como-remove)
[Express](https://expressjs.com/pt-br/advanced/best-practice-security.html)

>> Coment√°rio de filipedeschamps:
Show meu caro! Please, se puder enviar um PR com isso seria massa :)

>> Coment√°rio de diegocrivelaro:
Opa... Tranquilo, logo logo mando o PR :)
</issue_611_[Seguran√ßa] Remover o par√¢metro x-powered-by do cabe√ßalho de resposta>

<issue_612_[Sugest√£o] Social Login>
## O problema
Por seguran√ßa, √© sempre recomendado a utiliza√ß√£o daquelas senhas geradas aleatoriamente, o problema delas para o usu√°rio, √© n√£o ser f√°cil de decorar. Uma forma de contornar este pseudo-problema, √© associar as aplica√ß√µes a redes sociais como facebook, google ou github, no qual o usu√°rio s√≥ precisa lembrar do login de uma aplica√ß√£o e logar nas outras a partir dela.

## A solu√ß√£o
Existem tecnologias bastante maduras no mercado como o [https://www.keycloak.org/](https://www.keycloak.org/). Mas por se tratar de uma implementa√ß√£o que utiliza por sua ess√™ncia as API's das pr√≥prias aplica√ß√µes (google, github, etc) acredito que poder√≠amos fazer n√≥s mesmos um Social Login 

Encontrei estes seguintes artigos no Google Cloud Docs
- [Como fazer login de usu√°rios com o Google](https://cloud.google.com/identity-platform/docs/web/google?hl=pt-br)
- [Como fazer login de usu√°rios com o Github](https://cloud.google.com/identity-platform/docs/web/github?hl=pt-br)

> Lembrei que em algum momento desses √∫ltimos anos, a Apple quis exigir uma lei em que se uma aplica√ß√£o tivesse login com google e facebook, deveria possuir login com o Apple ID obrigatoriamente por N motivos. N√£o sei se esse projeto foi pra frente.

>> Coment√°rio de ceelsoin:
Posso implementar o login social com keycloak, tenho experi√™ncia com a ferramenta e com o protocolo openid connect.

>> Coment√°rio de coffeeispower:
Sobre seguran√ßa, eu ontem implementei 2FA no tabnews, tem um PR que ningu√©m viu ainda #929.
E tbm pfv n√£o coloquem login com Facebook, me d√° v√¥mito s√≥ de pensar

>> Coment√°rio de fabiosvm:
Que tal login com GitHub e s√≥? TabNews √© focado na comunidade de Devs?

>> Coment√°rio de Rafatcb:
Acho que essa √© uma boa sugest√£o, mas acabou recebendo mais aten√ß√£o no issue #922, inclusive com sugest√£o de UI. Faz sentido fechar como duplicado, @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
Acho que sim, @Rafatcb!

Vou fechar essa aqui para concentrarmos na #922 ü§ù
</issue_612_[Sugest√£o] Social Login>

<issue_613_[sugest√£o] implementar MVP de um feed RSS>
Essa ideia surgiu com o @filipedeschamps num post sobre Feed RSS q eu publiquei a uns dias atr√°s. ([link do post](https://www.tabnews.com.br/MattFerreira/mantenha-se-atualizado-das-techs-que-voce-segue-de-forma-centralizada-e-organizada))

 De forma resumida, a ideia seria criar uma listagem de cards de RSS em uma nova  aba no TabNews. Cada card de RSS estaria preenchido com as seguintes informa√ß√µes:
- T√≠tulo do artigo
- descri√ß√£o
- data de publica√ß√£o
- origem (de onde veio esse RSS)
- autor
 O card ficaria com uma estrutura similar a essa (e repito aqui de novo, para fazer esse card utilizei todos os meus poderes de design para construir esse exemplo rsrsrs)
![image](https://user-images.githubusercontent.com/52766091/182444096-09cb8d1a-f5a0-48d8-bc1f-2f27db013117.png)

Nesses cards, os usu√°rios poderiam seguir dois fluxos:
- clicar no card e ser direcionado para uma nova aba do navegador rumo a p√°gina original do artigo
- clicar em um bot√£o para poder criar um rascunho de um novo conte√∫do, onde o campo **fonte** j√° estaria preenchido com a fonte do RSS em que o usu√°rio clicou.

 Algo q acho q seria interessante a gente pensar q em um primeiro momento, essa listagem n ser montada pelos RSS q o usu√°rio linkou, e sim a partir de uma curadoria, tipo, o curador (ou a comunidade) acredita q os artigos da Vercel sejam de grande valor, ent√£o todos os usu√°rios teriam em sua listagem os artigos da Vercel (assim a gente teria menos trabalho para poder criar a v1 do MVP).

 E a√≠ galera, oq vcs acham dessa ideia?

@filipedeschamps se caso eu acabei esquecendo ou at√© escrevi algo meio equivocado sobre essa ideia, me avisa q corrigo aqui rapidex.

>> Coment√°rio de Joao620:
Olha, eu li a thread e n√£o consegui entender direito a id√©ia. Seria uma outra maneira de criar posts usando o RSS?
</issue_613_[sugest√£o] implementar MVP de um feed RSS>

<issue_614_Unfollow e follow no TabNews>
N√£o seria legal se coloca-se esta funcionalidade para voc√™ seguir o perfil de cada usu√°rio.

>> Coment√°rio de netomarchiori:
como voc√™ imagina essa feature? um feed somente com pessoas que voc√™ acompanha?

rola criar uma sess√£o dentro do pr√≥prio tabnews para os usu√°rios pedirem essas features?

>> Coment√°rio de gabrielmelodev:
Tipo seguir o filipedeschamps e receber todas as postagem que ele realizar mais, tipo criar uma lista de pessoas que voc√™ esta seguindo as que voc√™ seguir voc√™ recebe as postagem.

>> Coment√°rio de Poveii:
Seguir uma pessoa e receber um email quando ele criar um novo t√≥pico, √© isso? (usar o email at√© ter as notifica√ß√µes no pr√≥prio tabnews)

Eu acho uma boa ideia.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_614_Unfollow e follow no TabNews>

<issue_617_`ContentList`: utilizar `Link` do Next.js junto com uma barra de carregamento para abertura instant√¢nea da p√°gina>
## Contexto

Hoje, cada link que √© clicado no TabNews faz ele abrir uma p√°gina nova, do zero, no sentido de que o link que √© clicado descarrega a p√°gina anterior e carrega uma nova, do zero, recebendo o HTML inteiro, fazendo o parsing, depois puxando os est√°ticos em `js`, parsing disso tamb√©m, bootstrap do framework, e a lista vai indo.

Para evitar isso, o Next.js fornece um componente chamado `Link`, que consegue transformar a mec√¢nica da p√°gina em uma SPA e carregando apenas o que precisa para abrir a nova p√°gina, evitando todos os passos que foram mencionados anteriormente, fora conseguir antecipar o carregamento do conte√∫do seguinte ao passar o mouse em cima dos links que o usu√°rio supostamente ir√° abrir.

Como isso pode ser uma altera√ß√£o agressiva, vamos dar um passo de cada vez e implementar apenas no componente `ContentList`.

## Execu√ß√£o

- #516 
- #616
</issue_617_`ContentList`: utilizar `Link` do Next.js junto com uma barra de carregamento para abertura instant√¢nea da p√°gina>

<issue_619_Adiciona a propriedade `owner_username` no conte√∫do e remove `username`>
## Contexto

N√≥s precisamos adicionar a propriedade `owner_username` no objeto `content` para fazer par com o `owner_id`. Por compatibilidade, ainda iremos manter o `username`, mas que ap√≥s notifica√ß√£o p√∫blica, iremos remover e fazer uma breaking change na interface p√∫blica. Estamos nos dando o luxo de fazer isso dessa forma pela API estar em beta.

O motivo  desta implementa√ß√£o √© sem√¢ntico, uma vez que um conte√∫do n√£o possui `username`, ele possui no m√°ximo um **dono** e esse dono √© quem possui um `username`.

Com a implementa√ß√£o no backend feita, precisamos tamb√©m alterar os componentes em `interface` como `ContentList` e `Content`. Muito cuidado nessa parte, principalmente nas horas que √© feito a edi√ß√£o do conte√∫do (e √© enviado um `PATCH` para `.../contents/[owner_username]/[slug]`)

Na publica√ß√£o abaixo anunciamos que dia **19 de Agosto** iremos remover a propriedade `username`:

https://www.tabnews.com.br/filipedeschamps/breaking-change-na-api-do-tabnews-sobre-o-objeto-content

## Execu√ß√£o

- #618
- #660

>> Coment√°rio de filipedeschamps:
Fechado por #618

>> Coment√°rio de filipedeschamps:
Reabri a issue para contemplar nela tamb√©m a parte de remover o `username` no `content` ü§ù

>> Coment√°rio de filipedeschamps:
Fechado por #618 e #660

>> Coment√°rio de coffeeispower:
aaaaa quebrou meu app
</issue_619_Adiciona a propriedade `owner_username` no conte√∫do e remove `username`>

<issue_620_[Feature] Funcionalidade de se inscrever no tabnews usando um cliente de RSS feed>
Essa funcionalidade seria otima para quem usa esse sistema, fica tudo confinado em um unico programa, e n√£o √© preciso sair pra ir em outros sites para ler noticias, e acho que o tabnews se encaixa perfeitamente no modelo do RSS

>> Coment√°rio de coffeeispower:
Eu vou tentar criar uma prova de conceito na branch [feat/rss](https://github.com/filipedeschamps/tabnews.com.br/tree/feat/rss)

>> Coment√°rio de coffeeispower:
@filipedeschamps Tem alguma de mandar xml sem usar a pasta /api no next js? Seria conveniente a url ser `tabnews.com.br/rss`

>> Coment√°rio de filipedeschamps:
Voc√™ precisa fazer o rewrite para a api ü§ù

https://nextjs.org/docs/api-reference/next.config.js/rewrites

Mas veja isso depois, porque voc√™ vai precisar implementar RSS pela api primeiro e de qualquer forma.

>> Coment√°rio de coffeeispower:
Ent√£o pelo que entendi √© como se fosse um redirect
O que ele vai fazer √© redirecionar /rss para /api/v1/rss certo?

>> Coment√°rio de coffeeispower:
![image](https://user-images.githubusercontent.com/92828847/183142436-676fc999-2851-4177-91cf-b13e75ce6d10.png)
![image](https://user-images.githubusercontent.com/92828847/183142567-9966970c-5cb4-43e8-8869-deedbd9fb0a3.png)

>> Coment√°rio de coffeeispower:
Coloquei agora para converter markdown pra html 
![image](https://user-images.githubusercontent.com/92828847/183144591-fbd9fb27-8e4f-4b35-a113-a7f58bb6d15d.png)
J√° vou commitar na branch agora.
</issue_620_[Feature] Funcionalidade de se inscrever no tabnews usando um cliente de RSS feed>

<issue_622_Alterar forma que estamos limpando os `metadados` para inserir na `head`>
## Contexto

@agjunior come√ßou uma investiga√ß√£o do porque uma certa p√°gina no TabNews demorava para carregar atrav√©s do profiling dela no frontend e descobriu que uma regex consumia grande parte do processamento (~83%). Em seguida, o @aprendendofelipe se aprofundou um pouco mais e entendeu com precis√£o o que estava acontecendo, ao ponto de conseguir elaborar um c√≥digo markdown que travasse a p√°gina por completo.

## Execu√ß√£o

Isto est√° acontecendo por conta de como o m√≥dulo `remove-markdown` funciona e n√≥s usamos ele para fazer a limpeza do markdown dos conte√∫dos antes de inserir um valor limpo (sem formata√ß√£o) nos metadados da p√°gina para alimentar melhor o SEO.

O @aprendendofelipe j√° est√° bolando uma proposta de como resolver isso.

- #627

>> Coment√°rio de aprendendofelipe:
@filipedeschamps eu enviei [um PR](https://github.com/stiang/remove-markdown/pull/57) que resolve esse problema de performance na biblioteca `remove-markdown`.

O que voc√™ prefere agora? Aguardar o desenrolar do PR, procurar outra biblioteca ou copiar o c√≥digo corrigido para o reposit√≥rio do TabNews enquanto n√£o atualizam a biblioteca `remove-markdown`?

>> Coment√°rio de coffeeispower:
acho que da pra fazer upload do fork com um nome parecido no npm pra usar aqui e depois deletar quando for mergeado.

>> Coment√°rio de coffeeispower:
Mas tambem regex √© uma coisa muito pesada de processar, √© uma linguagem cheia de truques e simbolos e √© uma dor pra implementar; o resultado: problemas de performance...

>> Coment√°rio de filipedeschamps:
@aprendendofelipe que genial!!!

Topo total criarmos um model que retorne esse dado limpo! Ou se quiser, voc√™ pode fazer um fork do projeto e como a licen√ßa √© `MIT`, voc√™ pode lan√ßar seu pr√≥prio m√≥dulo no npm, por exemplo: `fast-remove-markdown`.

A √∫ltima escolha d√° bastante trabalho, mas √© bastante recompensadora ü§ù

>> Coment√°rio de Rafatcb:
Tem a op√ß√£o de usar o [patch-package](https://www.npmjs.com/package/patch-package) para modificar o c√≥digo do `remove-markdown` no reposit√≥rio do TabNews. N√£o sei se foi isso que o @aprendendofelipe quis dizer com "_copiar o c√≥digo corrigido para o reposit√≥rio do TabNews_".

>> Coment√°rio de rodrigoKulb:
@filipedeschamps, @aprendendofelipe, @coffee-is-power e @Rafatcb acho que tenho uma sugest√£o. 

Hoje aplicamos removeMarkdown no corpo inteiro do texto. E no final s√≥ utilizamos 190 caracteres.

Podemos limitar uma quantidade inicial de caracteres exemplo 500 e depois fazer a limpeza o que acham?
**Ponto positivo:**
- Teremos praticamente o mesmo tempo de limpeza, independente do tamanho do post

**Ponto negativo**
- Existe a possibilidade de os **500** caracteres inicial serem todos tags, isso deixaria o head em branco. (raro).

Outra op√ß√£o √© gravar no banco os metadados, assim a limpeza vai acontecer no insert / update somente na inclus√£o ou modifica√ß√£o do post.

>> Coment√°rio de aprendendofelipe:
@Rafatcb interessante o `patch-package`, mas acho que n√£o vale a pena nesse caso, pois seria mais complexo do que criar uma fun√ß√£o que fa√ßa o que precisamos.

@rodrigoKulb s√£o sugest√µes interessantes para se pensar se vale a pena por outros motivos, mas n√£o resolvem o problema atual, pois com bem menos de 500 caracteres √© poss√≠vel atingir o timeout das lambdas da Vercel com essa regex problem√°tica.

>> Coment√°rio de filipedeschamps:
Foi feito o merge do PR #627 e o @aprendendofelipe publicou uma compara√ß√£o l√° mostrando a diferen√ßa:

https://github.com/filipedeschamps/tabnews.com.br/pull/627#issuecomment-1209398962

Nota que a vers√£o original demorava **4.6 segundos** enquanto a vers√£o com o fix dele demora **100ms**:

| Fun√ß√£o original | Nova fun√ß√£o |
| --- | --- |
|![image](https://user-images.githubusercontent.com/77860630/183663119-881b8d8a-65c1-4849-a462-955e40c829d3.png)|![image](https://user-images.githubusercontent.com/77860630/183663887-90fad61d-9d6f-4aa4-8f91-fd2a3204adb6.png)|

>> Coment√°rio de aprendendofelipe:
> Nota que a vers√£o original demorava **4.6 segundos** enquanto a vers√£o com o fix dele demora **100ms**:

Na verdade a diferen√ßa √© ainda mais absurda üòÖ

Foi de 4.6s para menos de 0.1ms... Esse de 100ms na direita √© outro script

>> Coment√°rio de filipedeschamps:
Nossa, √© verdade! Sumiu qualquer Regex do topo da lista da direita üéâ

>> Coment√°rio de filipedeschamps:
@aprendendofelipe eu vou encerrar essa issue e colocar no report dessa pr√≥xima segunda ü§ù  E sobre cozinhar o resultado no `getStaticProps`, abrimos uma nova issue da√≠ para resolver isso üëç
</issue_622_Alterar forma que estamos limpando os `metadados` para inserir na `head`>

<issue_624_Fazer o `controller` parar de devolver `500` quando um m√©todo HTTP n√£o √© encontrado>
## Contexto

Na miss√£o de ter zero erros `500`, h√° uma forma de consistentemente gerar um que √© enviar um `method` HTTP desconhecido pelo endpoint. Por exemplo, se em um endpoint que s√≥ aceita `GET` voc√™ enviar um `POST`, ser√° retornado um erro `500` ao inv√©s de `404`.

## Execu√ß√£o

- #623

>> Coment√°rio de filipedeschamps:
Fechado por #623
</issue_624_Fazer o `controller` parar de devolver `500` quando um m√©todo HTTP n√£o √© encontrado>

<issue_626_Implementa p√°gina de Recentes>
## Contexto

Criar uma p√°gina `/recentes` que lista as publica√ß√µes por ordem decrescente de publica√ß√£o (do mais novo para o mais velho), ignorando o algoritmo e as tabcoins.

## Execu√ß√£o

- #625

>> Coment√°rio de filipedeschamps:
Fechado por #625
</issue_626_Implementa p√°gina de Recentes>

<issue_629_RSS Feed dos itens mais recentes>
## Contexto

Implementar um RSS que devolva os 30 itens mais recentes.

## Execu√ß√£o

- #621
- #632

>> Coment√°rio de filipedeschamps:
Fechado por #621
</issue_629_RSS Feed dos itens mais recentes>

<issue_631_Editor: adiciona √≠cone de Ajuda e utiliza tradu√ß√£o para Portugu√™s>
## Contexto

Devemos voltar a mostrar o √≠code de **Ajuda** que abre a **Refer√™ncia de Markdown** do editor e tamb√©m utilizar o `locale` de Portugu√™s Brasileiro.

Em paralelo, a tradu√ß√£o que fizemos no passado acaba criando algumas quebras de linha, isso foi reportado aqui: https://github.com/bytedance/bytemd/issues/214 onde a nova tradu√ß√£o j√° foi feita, mas utilizando uma plataforma de tradu√ß√£o deles e eu n√£o estou entendendo como fazer o submit final. No passado eu tinha feito um [PR cl√°ssico](https://github.com/bytedance/bytemd/pull/177) e nas pr√≥ximas contribui√ß√µes eles sugeriram usar essa plataforma de tradu√ß√£o.

O problema √© este (destacado em vermelho):

<img width="274" alt="image" src="https://user-images.githubusercontent.com/4248081/183708643-6a3fb6bd-805f-4935-accd-05f0358fbb6c.png">

## Execu√ß√£o

- #630

>> Coment√°rio de filipedeschamps:
Fechado por #630
</issue_631_Editor: adiciona √≠cone de Ajuda e utiliza tradu√ß√£o para Portugu√™s>

<issue_633_Erro de layout na rota `/publicar` ao cancelar uma publica√ß√£o>
## Contexto
Eu estava fazendo a publica√ß√£o de um conte√∫do pelo site e cliquei em `cancelar` para publicar depois s√≥ que logo em seguida o layout do site perdeu toda a forma original e resultou na print a seguir

![tabnews-error-img](https://user-images.githubusercontent.com/63757378/183964753-317e0c85-93a4-4df1-bd97-bd6e82c13a1e.png)
![tabnews-error-gif](https://user-images.githubusercontent.com/63757378/183975075-7bcb7ebf-25c6-424e-91bd-5366502f4e7a.gif)

Eu recarreguei a p√°gina e continuou da mesma forma, s√≥ resolveu quando eu fechei e abri novamente.

**Observa√ß√£o**: N√£o aparece nenhum erro no console e nem na parte de `Network` do devtools.

>> Coment√°rio de filipedeschamps:
@gatodeoculos muito obrigado por reportar esse bug, inclusive com um GIF üòç  e obrigado @aprendendofelipe por consertar esse comportamento de forma t√£o r√°pida ü§ù 

Issue fechada por #634
</issue_633_Erro de layout na rota `/publicar` ao cancelar uma publica√ß√£o>

<issue_636_Erro no layout em `/publicar` ao cancelar uma publica√ß√£o>
## Contexto

 - #633

## Execu√ß√£o

- #634

>> Coment√°rio de filipedeschamps:
Fechado por #634
</issue_636_Erro no layout em `/publicar` ao cancelar uma publica√ß√£o>

<issue_638_Consertar typo na lista `blockedUsernames` do model `user`>
## Contexto e Execu√ß√£o

- #637

>> Coment√°rio de filipedeschamps:
Fechado por #637
</issue_638_Consertar typo na lista `blockedUsernames` do model `user`>

<issue_639_Implementar Rate-Limit>
## Contexto

A Vercel fornece automaticamente prote√ß√£o contra DDoS nos recursos est√°ticos, por√©m ela n√£o pode fornecer isso para as APIs por n√£o conhecer as regras de neg√≥cio do seu servi√ßo. E quando se fala em DDoS, quase que automaticamente se pensa em **Cloudflare**, por√©m quanto mais eu pesquisei sobre colocar o Cloudflare na frente da Vercel, mais reclama√ß√µes eu encontrei sobre os recursos mais avan√ßados do Next.js, como `ISR`, `stale-while-revalidate` e invalida√ß√£o de cache dos est√°ticos. Caso queira se dar o trabalho de pesquisar e encontrar algo que funcione sem atrito para todos os recursos do framework, **por favor responda essa issue**, porque seria uma maravilha controlar tudo pelo Cloudflare.

Ent√£o uma alternativa √© colocar as [`Edge Middleware`](https://nextjs.org/docs/advanced-features/middleware) na frente e por l√° fazer o controle das requisi√ß√µes. Este √© um recurso que distribui computa√ß√£o/processamento na borda (na CDN) e l√° conseguimos fazer a verifica√ß√£o da quantidade de requests que est√£o acontecendo por `ip`. Mas para isso n√£o gerar uma lat√™ncia grande entre onde est√° o `state` e o processamento dele, o `state` tamb√©m precisa ser distribu√≠do globalmente e pelo que vi muita gente recomenda utilizar o [Upstash](https://upstash.com/), pois l√° √© poss√≠vel criar uma inst√¢ncia de Redis distribu√≠da globalmente.

Ent√£o na execu√ß√£o desse rate limiting, vamos configurar um limite geral de requisi√ß√µes contra a API, e um limite espec√≠fico e muito mais baixo para certos caminhos, como por exemplo fazer um `POST` contra a rota `/api/v1/sessions`.

## Execu√ß√£o

 - #635
 - #656
 - #715

>> Coment√°rio de filipedeschamps:
@aprendendofelipe no passado eu tinha mandado essa d√∫vida pro suporte do Upstash, e responderam dois dias atr√°s, olha que curioso:

<img width="604" alt="image" src="https://user-images.githubusercontent.com/4248081/187083423-aaf44e8a-8619-4fb0-81fc-8a563e5d108c.png">


Pelo que entendi ent√£o, a escrita n√£o funciona global, somente a leitura.

>> Coment√°rio de aprendendofelipe:
No banco global tanto a escrita quanto a leitura ocorrem na r√©plica mais pr√≥xima. No caso da grava√ß√£o, instantes ap√≥s j√° ocorre a replica√ß√£o. Acontece que isso n√£o agrega nada para a implementa√ß√£o de um rate-limit, ent√£o √© s√≥ um custo desnecess√°rio.

>> Coment√°rio de filipedeschamps:
Rate limit implementado em todas as rotas ü§ù
</issue_639_Implementar Rate-Limit>

<issue_641_Habilitar `CORS`>
## Contexto

O TabNews deve ser um porto seguro para desenvolvedores testarem suas habilidades com programa√ß√£o e isso inclui ter liberdade e flexibilidade de utilizar a nossa API em qualquer tipo de `client`. Um destes clients √© o `Navegador Web`, que interpreta e utiliza os cabe√ßalhos relacionados a `CORS` para decidir se ir√° continuar com a request ou n√£o. Ent√£o devemos habilitar `CORS` para todos os endpoints da API para que outros desenvolvedores possam criar sites e p√°ginas que se integrem com a API do TabNews.

## Execu√ß√£o

- #640
- #643

>> Coment√°rio de filipedeschamps:
Fechado por #640
</issue_641_Habilitar `CORS`>

<issue_644_Remover configura√ß√£o experimental `nftTracing`>
## Contexto

Para ler as migrations atrav√©s do file system e disponibilizar elas pelo endpoint `/api/v1/migrations`, n√≥s utilizamos no passado uma op√ß√£o experimental chamada `nftTracing`. Tudo funcionou perfeitamente, mas nas √∫ltimas vers√µes do Next.js, esta feature deixou de ser experimental e foi renomeada para `outputFileTracing`, mas n√≥s n√£o nos atualizamos sobre isso e come√ßou a causar o `warning` abaixo toda vez que o servidor do Next.js era inicializado:

<img width="1047" alt="image" src="https://user-images.githubusercontent.com/4248081/184244880-319534e6-efba-49aa-9442-f1e5e2e18ccf.png">

Mas o @aprendendofelipe fez uma pesquisa sobre o que aconteceu com essa propriedade e consertou o warning. Mais detalhes no PR sobre a execu√ß√£o.

## Execu√ß√£o

- #642

>> Coment√°rio de filipedeschamps:
Fechado por #642
</issue_644_Remover configura√ß√£o experimental `nftTracing`>

<issue_645_Listas personalizadas de Conte√∫dos, Coment√°rios e/ou Usu√°rios (e futuramente Tags), seja para Seguir com Notifica√ß√µes ou apenas Favoritar>
## Contexto

Navegando pelo TabNews eu me deparei com conte√∫dos incr√≠veis e de extrema utilidade, s√≥ que eu senti falta de uma op√ß√£o de **salvar** aquele conte√∫do para que eu possa acessar ele mais tarde sem precisar procurar ele no feed.

## Favoritar Conte√∫dos

A minha sugest√£o √© de adicionar uma **feature** de `Conte√∫dos Favoritos`, onde em cada conte√∫do (`root` ou `child`) teria uma op√ß√£o de **favoritar**, igual os exemplos a seguir: 

1. A op√ß√£o de `Fork` do Github.
![github-fork](https://user-images.githubusercontent.com/63757378/184388422-1b15900e-e5e6-4832-b04f-750d1f127306.png)

2. "Quest√µes Favoritas" do Stackoverflow

![stackoverflow](https://user-images.githubusercontent.com/63757378/184388736-a559eedf-bad4-43eb-8eb2-6502e5d02d5b.png)

3. "Favoritos" do pr√≥prio Google.

![google](https://user-images.githubusercontent.com/63757378/184389109-df4310ee-fffb-4427-b24d-c52be96ed157.png)

## Nova Rota na API `/favoritos`

Como consequ√™ncia, teria que criar nova rota com os conte√∫dos favoritos do usu√°rio que, obviamente, listaria todos os conte√∫dos favoritos do usu√°rio...
E inicialmente, eu acho melhor deixar **privado os conte√∫dos favoritos** somente para os **usu√°rios que est√£o conectados na sess√£o**. (isso pode at√© ser uma op√ß√£o do usu√°rio, deixar p√∫blico ou privado)

## Sandbox

Uma ideia maluca que eu tive mas que pode ser √∫til (talvez) √©: em vez de criar uma feature de Favoritos, criar um sistema de `ContentList` onde o usu√°rio poder√° criar quantas listas quiser com diversos conte√∫dos adicionados √† ela, assim como as playlists do Youtube, por exemplo. Isso ajudaria bastante na quest√£o de organiza√ß√£o, principalmente pra quem publica sequ√™ncias de conte√∫dos did√°ticos e etc...

>> Coment√°rio de coffeeispower:
Fork pra favoritar cm assim? Pra favoritar r com uma estrela.

>> Coment√°rio de leocunhadev:
Eu acho que o `fork` n√£o foi um bom exemplo, talvez a `Star` se encaixe melhor, seria s√≥ uma forma de n√£o perder o conte√∫do ap√≥s lido.

>> Coment√°rio de rCirelli:
Pessoal, estou tentando implementar essa feature. Coloquei o bot√£o para adicionar aos favoritos abaixo dos bot√µes de tabcoin.
Estou com dificuldade em entender a estrutura√ß√£o do backend da aplica√ß√£o pra poder fazer a nova rota da API.

-----------

https://user-images.githubusercontent.com/22369220/224143708-e6473401-8f93-48fc-9170-5626cb202cc6.mp4

-------------
Inicialmente eu estava pensando em uma implementa√ß√£o simples, sem as funcionalidade de diversas listas de itens salvos. Mas ja estruturada para evoluir para isso, ent√£o com uma tabela com a seguinte estrutura:

![image](https://user-images.githubusercontent.com/22369220/224145481-8c9e376a-dc98-4685-922f-5c7a637f7319.png)

(O valor adicionado √† lista poderia ser um objeto com algumas outras informa√ß√µes al√©m do slug do conte√∫do)

Ao clicar em salvar, seria verificado se o usus√°rio possui uma lista. Se sim, adicionaria o slug do conte√∫do √† lista. Se n√£o, criaria uma lista com nome padr√£o e adicionaria o slug a essa lista.
Inicialmente s√≥ seria possivel ter a lista padr√£o, pra pelo menos ter a implementa√ß√£o basica. Depois poderia ser adicionada a funcionalidade de criar multiplas listas. 


O que acham?

Esta seria minha primeira contribui√ß√£o com um projeto open-source, ent√£o quem puder dar uma luz eu agradeceria imensamente!


Estou continuando a discuss√£o aqui e n√£o na issue que abri [(#1229)](https://github.com/filipedeschamps/tabnews.com.br/issues/1229).

>> Coment√°rio de Viniciusadm:
@rCirelli como t√° indo a implementa√ß√£o? Eu estava pensando nisso hoje, mas decidi procurar antes e encontrei essa issue.

>> Coment√°rio de AdrianKnapp:
@rCirelli @silvaezequias @aprendendofelipe @Viniciusadm Como est√° o desenvolvimento dessa Issue? 

Estou usando aplicativos como Instapaper, por exemplo. Para conseguir salvar artigos interessantes, e gostaria de contribuir com uma ferramenta para salvar/favoritar pots nativamente na plataforma do TabNews. Algo como o amigo descreveu acima.

Existe algo estruturado no back-end? Se sim, qual as rotas? 
Se n√£o, como funciona para essas rotas em funcionamento? Pois para come√ßar o front, precisamos disso estruturado.

>> Coment√°rio de anderood:
@rCirelli @silvaezequias @aprendendofelipe @Viniciusadm 
Alguma novidade sobre este item?

Esta uma issue (acredito eu) de interesse de muitos, o que pode estar faltando pra realizar a implementa√ß√£o?

>> Coment√°rio de eletroswing:
Ol√°, visto que essa feature como est√° seria algo muito grande de se fazer por si s√≥ e tornaria muito complicado o code review para os mantenedores do tabnews, o que acham de transformar essa feature(grande) em 3 novas features(com complexidade mediana).Poderiamos fazer algo como:
- implementa√ß√£o 1: O usuario salva as publica√ß√µes em local storage e so pode ver as proprios posts salvos, n√£o teria o sistema de playlists e partiria de um unico dispositivo

- implementa√ß√£o 2: a rota de api √© adicionada, fazendo com que o usuario possa ver seus posts salvos atraves de diferentes dispostivos, porem ainda nao pode compartilha-los ao mundo nem criar playlists

- implementa√ß√£o 3: a rota de api √© melhorada dando suporte a playlists, e, assim, tornando a visualiza√ß√£o das playlists e bookmarks publicas, onde um usuario pode ver, mas nao modificar a playlist de outro usuario

O que acham de partirmos assim?

>> Coment√°rio de Rafatcb:
@eletroswing acho que n√£o precisa separar tanto assim. A implementa√ß√£o 1 me parece pouco √∫til e traria a preocupa√ß√£o em sincronizar com o servidor na pr√≥xima implementa√ß√£o para o usu√°rio n√£o perder tudo. A implementa√ß√£o 2, de n√£o deixar as listas p√∫blicas, parece tamb√©m uma simplifica√ß√£o m√≠nima, porque provavelmente o que diferenciar√° uma lista p√∫blica de uma privada √© uma coluna na tabela.

Se quiser simplificar, pode fazer um PR para o frontend (UI) e outro para o backend (API), por exemplo. Nessa situa√ß√£o, recomendo fazer o de backend primeiro.

---

Sobre a sugest√£o do @rCirelli (https://github.com/filipedeschamps/tabnews.com.br/issues/645#issuecomment-1462736143), n√£o acho que um array √© melhor do que um relacionamento com outra tabela para essa situa√ß√£o. N√£o vi se teve um argumento a favor do array.

>> Coment√°rio de eletroswing:
Compreendi e de fato √© uma otima partida.

Sobre a segunda parte:
Voc√™ acha que seriam necess√°rios duas tabelas (uma, por exemplo, para as playlist que referencia a um user e outra referenciando os posts a uma playlist) ou, partir direto para uma tabela so de posts salvos ligadas a um usuario, sem essa intermedia√ß√£o de uma ¬¥playlist¬¥ na tabela? 

acredito que partir tendo 2 tabelas, apesar de parecer mais complexo, seja mais simples de se manter.

>> Coment√°rio de Rafatcb:
@eletroswing refleti um pouco para responder sua d√∫vida e acho que acabei chegando na mesma conclus√£o que voc√™.

Eu enxergo dois cen√°rios levemente distintos:

* Um usu√°rio pode colocar conte√∫dos em diferentes listas.
* Um usu√°rio pode seguir outros usu√°rios.

Isso implica que n√£o existir√° "listas de usu√°rios", apenas "listas de conte√∫dos". Faz sentido para mim, n√£o sei se algu√©m tem um contraponto.

Para um usu√°rio criar listas com conte√∫dos, parece algo simples:

`users` ----- `lists` ----- `contents`

J√° para um usu√°rio seguir outros usu√°rios, imagino o seguinte:

`users` ----- `followers`

Onde `followers` teria o `id` do usu√°rio que est√° sendo seguido e do usu√°rio que est√° seguindo.

O nomes das novas tabelas acima foi apenas para exemplificar.

Se formos considerar que um usu√°rio poder√° seguir listas de outros usu√°rios,  talvez complique um pouco mais. N√£o sei se isso ser√° permitido, mas pode fazer sentido. N√£o pensei agora no que precisaria ser modificado na pr√°tica para atender esse requisito.

>> Coment√°rio de eletroswing:
Acho que vou dar inicio pra adicionar essa feature de salvar no backend. Pensei um pouco nas rotas e acredito que possam ser assim: 
/bookmarks - POST cria
/bookmarks/username GET - exibe as playlists  de um user
/bookmarks/username/id GET - exibe a playlist DELETE destroi e PUT faz update
/bookmarks/username/id/user/slug POST - adiciona o conteudo na playlist DELETE remove o post da playlist

> nessa ultima rota ainda estou com duvida, pois teria v√°rios argumentos em uma unica rota, nao sei se passar o id real do conteudo seria uma boa ideia, ou se passar no body seria a melhor op√ß√£o. mas pra quem l√™ as rotas, parece ser mais f√°cil de entender e interagir

Para seguir os usuarios pensei em tipo:
/follow/username - GET - exibe a lista de pessoas que a pessoa esta seguindo, e segue em dois objetos: following e followers,
poderia ter um filtro para pegar somente o que se √© necessario, como:

> /follow/username?followers=true&following=false, retornando so um dos objetos

/follow/username - POST - come√ßa a seguir a pessoa DELETE - para de seguir a pessoa

>> Coment√°rio de Rafatcb:
@eletroswing eu refleti um pouco mais e percebi que relacionamentos N:N v√£o acabar demandando mais uma tabela. Bom, voc√™ perceber√° as necessidades conforme desenvolver.

N√£o sei se `bookmarks` √© o nome mais adequado, mas acho melhor debater esse tipo de detalhe no pr√≥prio PR. 

Tamb√©m n√£o sei se mostrar os seguidores de `<alguma-coisa>` √© algo √∫til ou se sequer deveria ser p√∫blico. A princ√≠pio, creio que nem precise implementar um endpoint ou fun√ß√£o para isso. Pode focar no b√°sico.

Andei pensando mais sobre o assunto e n√£o sei se n√≥s estamos nos confundindo em algumas funcionalidades aqui...

1. **Usu√°rios poder√£o criar listas de conte√∫dos** para organizarem as publica√ß√µes e coment√°rios como quiserem.
2. **Usu√°rios poder√£o ver listas de conte√∫dos p√∫blicas criadas por outros usu√°rios**.
3. **Usu√°rios poder√£o seguir usu√°rios** para serem notificados de novas publica√ß√µes/coment√°rios.
4. **Usu√°rios poder√£o seguir tags** para serem notificados de novas publica√ß√µes.
5. **Usu√°rios poder√£o seguir conte√∫dos** para serem notificados de coment√°rios/edi√ß√µes.
6. ‚ùì **Usu√°rios poder√£o seguir listas de conte√∫dos.** N√£o sei se isso faz sentido, seria para que? Para ser notificado quando o dono da lista adicionar algo novo? Vendo por esse lado, pode ser interessante.

Para criar uma implementa√ß√£o inicial √© interessante ter tudo em mente para n√£o fazer algo que dificulte a evolu√ß√£o, mas creio que para a funcionalidade de "lista de conte√∫do" inicialmente s√≥ precisemos do ponto `1` e, como um extra, o `2`.

>> Coment√°rio de eletroswing:
*_dado o escopo, abordarei seguir e playlist como 2 features distintas que se completam, mas que nao precisam uma da outra_

Sobre a de listas: Realmente 2 tabelas seriam necess√°rias nesse caso, uma para linkar uma playlist a um user e outra pra lincar um post a uma lista, at√© tem como fazer como mencionado anteriormente e usar um varchar[], mas acho que n√£o seria o melhor nesse caso.

Sobre a feature de seguidores, estou pensando em algo como a seguinte estrutura pra tabela: 
user_id: ser um campo que liga o evento de seguir a um usuario
target_id: seria o id alvo do objeto seguido
type: um campo texto para identificar o tipo do seguidor, seja pra seguir `USER` | `CONTENT` | `TAG` | `LIST` etc
e um campo da data de cria√ß√£o pra mensurar futuramente(se necessario), a partir de quando o usuario segue tal conte√∫do

e para evitar duplicidade uma uniqueness_fkey que pegue  ("user_id", "type", "target_id"), assim garantiremos que o objeto √© unico

>> Coment√°rio de eliasnsz:
Opa pessoal, entrando aqui pra saber como est√° a situa√ß√£o da feature de Favoritar conte√∫dos.

Esse √© meu primeiro contato com o open-source ent√£o dicas e orienta√ß√µes s√£o muito bem-vindas!

Estava trabalhando numa poss√≠vel implementa√ß√£o dessa feature e me deparei com o post de [boas pr√°ticas pra criar um PR](https://www.tabnews.com.br/rodrigoKulb/boas-praticas-para-criar-um-pull-request-no-projeto-tabnews-com-br) do @rodrigoKulb. Ent√£o vim pesquisar pra ver se j√° tinha alguma issue com rela√ß√£o a esse tema e cheguei aqui.

Bom, indo direto ao ponto eu fiz algumas altera√ß√µes e gostaria da opini√£o de voc√™s. 

A implementa√ß√£o que eu pensei se baseia em uma nova tabela `favorites` que relaciona o ID do conte√∫do com o ID do usu√°rio.

Criei uma nova rota em `api/v1/[username]/favorites` que quando chamada com GET retorna a lista de conte√∫dos favoritados pelo usu√°rio, j√° com pagina√ß√£o.

No model `content.js` alterei um pouco a constru√ß√£o da fun√ß√£o 'findWithStrategy()' para que ela recebesse uma nova estrat√©gia chamada `favorites` e um `userId` retornando assim a resposta que citei acima.

No front-end minha ideia foi de criar uma nova aba no perfil do usu√°rio onde se localizariam os favoritos:

![](https://i.imgur.com/Js8uaHQ.png")

E naturalmente, os posts teriam um bot√£o de favoritar que eu optei por adicionar no canto superior direito

![](https://i.imgur.com/K83LtuB.png)

Ainda n√£o trabalhei na parte POST da api para favoritar o conte√∫do, que na minha ideia ficaria localizado em
 `POST -> /api/v1/[username]/[slug]/favorite`

Mas a parte GET est√° funcionando, inserindo manualmente os dados no banco, tudo funciona como esperado. Eu achoü§£

![](https://i.imgur.com/ubKAr1D.png) ![](https://i.imgur.com/0F7ERCc.png)

Refor√ßando que √© minha primeira intera√ß√£o no mundo open-source, ent√£o gostaria de saber se estou no caminho certo, se fiz demais, se fiz errado, se fiz antes da hora, qualquer feedback √© bem-vindo, de verdade! 

Obrigado povo

>> Coment√°rio de Rafatcb:
@eliasnsz muito legal seu progresso, parab√©ns!

Se me permite sugerir uma mudan√ßa, seria tratar essa funcionalidade com _listas_ (no plural), ao inv√©s de uma √∫nica lista ("favorito"). Isso adiciona mais complexidade, mas √© a funcionalidade "alvo" que estamos buscando com esse issue.

Sua sugest√£o de implementa√ß√£o de UI no perfil est√° bem pr√≥xima do que eu imaginei que seria! S√≥ mudaria o fato de existirem v√°rias listas (mas eu continuaria deixando uma √∫nica aba). N√£o cheguei a pensar como seria a visualiza√ß√£o do conte√∫do presente em uma lista.

> Refor√ßando que √© minha primeira intera√ß√£o no mundo open-source, ent√£o gostaria de saber se estou no caminho certo, se fiz demais, se fiz errado, se fiz antes da hora, qualquer feedback √© bem-vindo, de verdade!

N√£o sei se voc√™ j√° tinha visto este issue antes de come√ßar a implementa√ß√£o, mas √© sempre bom buscar o que foi discutido antes de iniciar, principalmente quando √© algo complexo.

Mas eu n√£o diria que voc√™ est√° errado em ter feito algo. Se ter alguma d√∫vida pode comentar que eu e o @aprendendofelipe buscamos orientar da melhor forma poss√≠vel, e tamb√©m tem outras pessoas que ajudam a responder as d√∫vidas e sugest√µes nos issues. Como gostamos de dizer, "mesmo um PR recusado pode trazer ensinamentos para uma implementa√ß√£o futura", a discuss√£o √© ben√©fica.

Por fim, n√£o se sinta obrigado em fazer algo. Ao mesmo tempo em que ficamos felizes em receber colabora√ß√µes no reposit√≥rio, de forma alguma "exigimos" que algu√©m comece e termine uma funcionalidade, por exemplo, ou que se comprometa com a entregar algo num determinado tempo. J√° aconteceu algumas vezes de uma pessoa aparecer, colaborar, e um mantenedor do reposit√≥rio concluir e integrar a solu√ß√£o. Trabalho em equipe :smile:

>> Coment√°rio de dudubass15:
Pessoal, alguma novidade sobre a implementa√ß√£o dessa nova funcionalidade? Algo que posso ajudar?

Estava acessando a aplica√ß√£o hoje e queria salvar algumas postagens e ai fui parar aqui e ver que ainda est√° sendo desenvolvida essa solu√ß√£o.

>> Coment√°rio de HarukaYamamoto0:
Bom dia, tamb√©m gostaria de saber o status dessa issue, principalmente da feature de seguir um usu√°rio, pois atualmente para fins de estudo estou criando um client para o Tab usando compose e gostaria de adicionar essa feature nele

At√© pensei em fazer esse sistema criando meu pr√≥prio servidor onde a cada x tempo ele verificaria se tem novidades, mais logo cheguei a conclus√£o que seria invi√°vel pois provavelmente eu iria tomar rate-limit se muitos usu√°rios usassem o app

> J√° para um usu√°rio seguir outros usu√°rios, imagino o seguinte:
> 
> `users` ----- `followers`
> 
> Onde `followers` teria o `id` do usu√°rio que est√° sendo seguido e do usu√°rio que est√° seguindo.

Sobre isso n√£o seria mais f√°cil apenas colocar dois arrays `followers` e `following` dentro do user onde conteria apenas os ids usu√°rios dos respectivos campos?

E sobre seguir um conte√∫do acredito que n√£o fa√ßa tanto sentido, por exemplo se um usu√°rio comentar em um artigo, em tese o √∫nico que √© para receber essa notifica√ß√£o √© para ser o dono do artigo, a menos que esse coment√°rio seja uma resposta, a outro coment√°rio, e sobre receber a notifica√ß√£o ia ser bom poder que os clients podessem ouvir esses eventos tamb√©m

E tamb√©m sobre seguir tags, em larga escala isso n√£o tornaria quasse um spam se muitos usu√°rios publicarem artigo com tags? talvez se fosse ser notificado com um email tipo `Top #Pitch da semana`, em vez de necessariamente receber notifica√ß√£o de cada novo artigo com essa tag

Esses s√£o meus pontos de vista e minhas d√∫vidas, se eu tiver errado por favor me diga, pois eu n√£o tenho experi√™ncia com sistemas mais complexos, ent√£o gostaria de poder entender essas decis√µes

>> Coment√°rio de Edson5-spec:
A fun√ß√£o de guarda os posts que vc mais gosta s√≥ est√° no app mas e no site

Vai ser colocado no site ou vai ficar msm s√≥ para app?
</issue_645_Listas personalizadas de Conte√∫dos, Coment√°rios e/ou Usu√°rios (e futuramente Tags), seja para Seguir com Notifica√ß√µes ou apenas Favoritar>

<issue_647_Altera ganho de `tabcoins` de `5` para `2` a cada publica√ß√£o>
## Contexto

Para uma economia mais saud√°vel, vamos alterar o ganho por publica√ß√µes de `5` `tabcoins` para `2` (edit: anter era `1`). Sem isso, caso algu√©m publique um conte√∫do sem valor concreto, era necess√°rio que `10` `tabcoins` fossem utilizadas para zerar o ganho de `5` `tabcoins` que esse usu√°rio teve. Agora √© necess√°rio apenas `4` `tabcoins`.

Fora isso, ao deletar uma publica√ß√£o que possui um n√∫mero positivo de `tabcoins`, este valor ser√° descontado do autor. H√° mais detalhes sobre isso no PR de execu√ß√£o, principalmente o segundo (#649)

## Execu√ß√£o

- #646
- #649
- #651

>> Coment√°rio de filipedeschamps:
Fechado por #646

>> Coment√°rio de aprendendofelipe:
Essa altera√ß√£o, sem outras medidas, vai causar uma recess√£o e n√£o existir√£o tabcoins dispon√≠veis em quantidade suficiente para  qualificar todos os conte√∫dos que s√£o postados

>> Coment√°rio de filipedeschamps:
Hmm esse √© um bom ponto! Uma coisa que eu to notando √© que eu tenho mais tabcoins que consigo gastar:

<img width="115" alt="image" src="https://user-images.githubusercontent.com/4248081/184548656-fd7eb29d-52f7-4997-a2b2-698ee7a8274f.png">

Mas eu to criando/respondendo diariamente conte√∫dos e isso tanto gera tabcoins no ato da cria√ß√£o, quanto me deixa exposto a ganhar tabcoins por doa√ß√£o... mas fiquei curioso no balan√ßo disso e fiz umas queries aqui contra o meu usu√°rio e extra√≠ o seguinte da `balance_operations`

* `1660` tabcoins criando conte√∫do
* `790` recebendo doa√ß√µes

De qualquer forma, o que acha aumentar para `2` tabcoins por cria√ß√£o de conte√∫do? Pois assim pelo menos a pessoa pode qualificar algum conte√∫do logo ap√≥s a cria√ß√£o da sua primeira publica√ß√£o.

E por fim, esse ecossistema s√≥ vai conseguir rodar de verdade quando o tabcash tiver uso ü§ù

>> Coment√°rio de aprendendofelipe:
> fiz umas queries aqui contra o meu usu√°rio e extra√≠ o seguinte

@filipedeschamps, voc√™ est√° s√≥ criando conte√∫do e coment√°rios de valor concreto, mas tamb√©m existe influ√™ncia por ser o criador do TabNews, e soma a isso o fato de que voc√™ est√° respondendo mais do que qualquer outra pessoa, ent√£o voc√™ sempre ser√° um ponto fora da curva. Ent√£o o seu caso serve para entendermos quais s√£o os limites, mas n√£o a situa√ß√£o que ser√° mais comum para a maioria dos usu√°rios. Para isso temos que usar essas informa√ß√µes normalizadas.

> De qualquer forma, o que acha aumentar para 2 tabcoins por cria√ß√£o de conte√∫do?

Sim, de in√≠cio, vai funcionar melhor do que 1. Mas n√£o existe um n√∫mero fixo igual para todos que d√™ certo a longo prazo. Pois o valor concreto √© criado ao publicar o conte√∫do. J√° quando ocorrem as qualifica√ß√µes as tabcoins apenas mudam de m√£os, ou seja, na cria√ß√£o do conte√∫do tem que surgir tabcoins na propor√ß√£o do valor que acabou de ser criado.

Por isso eu acredito que a economia ir√° funcionar melhor se o ganho inicial for din√¢mico, baseado nas publica√ß√µes passadas do usu√°rio, que √© uma boa **estimativa** de qual √© o valor desse novo conte√∫do.

>> Coment√°rio de filipedeschamps:
Concordo 100%, que √© naquele modelo que voc√™ tinha feito a publica√ß√£o l√° no TabNews ü§ù  vamos com certeza chegar num modelo mais sofisticado para atender quem nunca publicou antes (e n√£o conhecemos o hist√≥rico), quem j√° tem um hist√≥rico positivo e pegar e afundar quem est√° abusando do sistema üëç

>> Coment√°rio de aprendendofelipe:
Eu n√£o coloquei naquela publica√ß√£o outros detalhes porque ficaria muita informa√ß√£o, mas tenho algumas ideias para os pr√≥ximos passos depois daqueles.

Pela pr√≥pria qualifica√ß√£o das publica√ß√µes j√° ficar√≠amos protegidos contra certos abusos. Principalmente educando pessoas que venham a se comportar como est√£o acostumadas nas outras redes.
</issue_647_Altera ganho de `tabcoins` de `5` para `2` a cada publica√ß√£o>

<issue_648_Problemas com o Editor de Markdown>
O indicador do cursor que serve pra mover o cursor pelo texto, n√£o aparece na maioria das vezes quando se toca em alguma parte de uma caixa de texto edit√°vel, dificultando a locomo√ß√£o pelo texto em dispositivos mobile.
![2022_08_13_11 02 26](https://user-images.githubusercontent.com/93549989/184498301-53d89294-0db1-4126-a5b6-a24851692870.jpg)
![2022_08_13_11 03 04](https://user-images.githubusercontent.com/93549989/184498313-cbef0632-0ab8-4ec4-96a8-137e508d83bb.jpg)

>> Coment√°rio de aprendendofelipe:
Oi @DarkLordRafa, isso s√≥ acontece no corpo da publica√ß√£o? Nos campos de t√≠tulo e de fonte vai tudo normal? Ocorre tamb√©m nessa p√°gina? https://bytemd.js.org/playground/

Se a resposta for positiva para todas as perguntas, √© algo com a biblioteca `ByteMD`.

No futuro, se os problemas com a `ByteMD` n√£o forem corrigidos, precisaremos substitu√≠-la.

>> Coment√°rio de DarkLordRafa:
Oi Felipe, isso s√≥ acontece no corpo da mensagem, no t√≠tulo e na fonte ta de boa, sempre aparece o indicador em forma de gota azul. E sim, o problema tamb√©m acontece na p√°gina que voc√™ mandou

>> Coment√°rio de aprendendofelipe:
O ByteMD √© baseado no CodeMirror 5. Vamos torcer para migrarem logo para a vers√£o 6.

O CodeMirror 6 se tornou est√°vel faz pouco tempo¬π e, aparentemente, corrigiram diversos problemas que enfrentamos no editor de markdown do TabNews.

[1] https://marijnhaverbeke.nl/blog/codemirror-6.html

@DarkLordRafa, se puder, veja se encontra o mesmo problema na vers√£o 6, pois para mim parece resolvido:

https://codemirror.net/try/

>> Coment√°rio de DarkLordRafa:
@aprendendofelipe Testei aqui e parece tudo ok. N√£o tive esse problema do ponteiro

>> Coment√°rio de filipedeschamps:
> O ByteMD √© baseado no CodeMirror 5. Vamos torcer para migrarem logo para a vers√£o 6.
> 
> O CodeMirror 6 se tornou est√°vel faz pouco tempo¬π e, aparentemente, corrigiram diversos problemas que enfrentamos no editor de markdown do TabNews.

Que massaaaa!!! E puts, to achando o reposit√≥rio do ByteMD meio abandonado. Nenhuma intera√ß√£o l√° mais teve retorno.

Em paralelo, tava vendo as depend√™ncias para entender o qu√£o complicado seria fazer um PR dessa atualiza√ß√£o, e vi que o ByteMD usa o https://github.com/pd4d10/codemirror-ssr que √© uma abtra√ß√£o do Codemirror para Server Side Rendering. Abri uma issue l√° para ver se o pessoal tem interesse em fazer o upgrade. Pelo que entendi, esse m√≥dulo √© uma "casca" que faz uma transforma√ß√£o.

>> Coment√°rio de aprendendofelipe:
> to achando o reposit√≥rio do ByteMD meio abandonado.

Ah, talvez markdown n√£o seja muito √∫til pro TikTok... hahaha...

Praticamente s√≥ esse usu√°rio pd4d10 que interage por l√°, o mesmo da codemirror-ssr que, sim, √© s√≥ uma transforma√ß√£o no codemirror5. Acredito que a mudan√ßa do CodeMirror do 5 para o 6 vai ter que ser realizada no ByteMD mesmo, n√£o apenas no codemirror-ssr. E por n√£o parecer uma tarefa muito f√°cil, talvez seja essa a raz√£o para o reposit√≥rio estar meio parado.

Seria uma contribui√ß√£o mais que delicinha se algu√©m fizesse algo pra gente usar o CodeMirror 6 diretamente, n√©? Sem precisar do ByteMD ü§© Eu acredito na Turma

>> Coment√°rio de filipedeschamps:
@aprendendofelipe olha o que est√° vindo para o Primer: https://github.com/primer/react/pull/2182

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe olha o que est√° vindo para o Primer: [primer/react#2182](https://github.com/primer/react/pull/2182)

![gifs-momentos-de-felicidade](https://user-images.githubusercontent.com/77860630/184888027-88ebbea1-da7d-4c28-b542-6f51ef894334.gif)

>> Coment√°rio de aprendendofelipe:
WOW!

Ser√° que teremos alguma perda se migrarmos logo? J√° vi que ganharemos o `Link Interception` que atender√° alguns pedidos da Turma

>> Coment√°rio de filipedeschamps:
> WOW!
> 
> Ser√° que teremos alguma perda se migramos logo? J√° vi que ganharemos o `Link Interception` que atender√° alguns pedidos da Turma

Boa pergunta! Minha task principal hoje √© preencher retroativamente as tabcoins (tirando aquela refatora√ß√£o pequena sobre o valor negativo de d√©bito). Depois disso eu gostaria de continuar nas issues da Milestone para n√£o driftarmos tanto dela, mas seria muito legal algu√©m j√° cavucar isso numa branch paralela para entender se est√° promissor e se vale a pena encaixar isso antes do lan√ßamento ü§ù  isso vai resolver muitas das gambiarras que precisamos fazer para o ByteMD ficar igual ao Primer üòç 

De qualquer forma, um cuidado m√°ximo que eu teria √© se o componente vai renderizar corretamente a View no server ü§ù

>> Coment√°rio de aprendendofelipe:
Ser√° que vale a pena dar a op√ß√£o de usar um campo de texto normal, sem a estiliza√ß√£o autom√°tica de markdown, para quem estiver com dificuldade de escrever no mobile?

Pois o editor que usamos, o ByteMD, √© um dos melhores, inclusive em dispositivos m√≥veis, ent√£o tentar utilizar outro deve piorar a experi√™ncia e aumentar os bugs.

O ByteMD deve resolver esse problema quando migrar para o Codemirror 6, mas essa migra√ß√£o exige um grande trabalho da comunidade open source.

Acho que podemos disponibilizar um campo de texto alternativo para quem estiver enfrentando problemas.

O que acham?

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe acredito que seja uma boa op√ß√£o, pode verificar que o github n√£o utiliza o editor estilizado.

Alem do ponto comentado pelo @DarkLordRafa ele tamb√©m n√£o habilita os erros de ortografia.

![Captura de tela em 2023-03-22 03-09-59](https://user-images.githubusercontent.com/5334261/226817038-997e52f7-6e39-4c35-a79b-cb00216e0ac9.png)
![Captura de tela em 2023-03-22 03-09-49](https://user-images.githubusercontent.com/5334261/226817040-6e1928c5-2fde-4333-970f-0fb592198c27.png)

>> Coment√°rio de aprendendofelipe:
Boas not√≠cias sobre o editor de markdown...

A vers√£o 2 do ByteMD, que deve corrigir a maioria dos bugs por substituir o Codemirror 5 pelo 6, j√° est√° em desenvolvimento üéâ

O desenvolvedor alterou o nome para HashMD e migrou o antigo reposit√≥rio de [`bytedance/bytemd`](https://github.com/bytedance/bytemd) para [`pd4d10/hashmd`](https://github.com/pd4d10/hashmd), mas no endere√ßo antigo foi criado um clone do reposit√≥rio, onde foi deixado o aviso de que a vers√£o 2 est√° sendo desenvolvida e apontando para o novo endere√ßo.

>> Coment√°rio de aprendendofelipe:
Se a nova vers√£o do ByteMD n√£o vingar, eu gostei bastante do que vi no playground do Lexical (sugerido [aqui](https://github.com/filipedeschamps/tabnews.com.br/issues/790#issuecomment-1292752988) pelo @silvaezequias).

https://playground.lexical.dev/

>> Coment√°rio de emerson-oliveira:
Foi identificado um problema no editor Markdown que estamos utilizando atualmente. O bug ocorre quando um texto √© selecionado e as op√ß√µes de lista numerada (Numbered list), lista n√£o ordenada (Unordered list) ou lista de tarefas (Task list) s√£o acionadas.

O comportamento esperado seria que, ao clicar nessas op√ß√µes, os marcadores correspondentes fossem adicionados ao texto selecionado. Se a a√ß√£o fosse repetida, os marcadores deveriam ser removidos. No entanto, o que est√° acontecendo √© que, a cada clique, os marcadores s√£o adicionados repetidamente ao texto, em vez de serem removidos na segunda vez.

Algu√©m j√° come√ßou a implanta√ß√£o do Lexical ?

>> Coment√°rio de aprendendofelipe:
Novidades n√£o muito boas sobre os editores.

### Primer

N√£o vamos poder contar com o editor do Primer, pois nem saiu de *draft* e j√° foi *deprecated*. Vai sair do m√≥dulo p√∫blico e virar somente interno do GitHub.

Fontes:
- https://github.com/primer/react/pull/4027
- https://github.com/primer/react/issues/3604

### ByteMD

O desenvolvimento da [nova vers√£o](https://github.com/pd4d10/hashmd) com o CodeMirror 6 est√° parado, ou muito lento.
</issue_648_Problemas com o Editor de Markdown>

<issue_650_Cozinhar os metadados no `getStaticProps()`>
## Contexto

Dando continuidade na issue #622 que traz a implementa√ß√£o de @aprendendofelipe no PR #627, temos uma margem para melhorar ainda mais a abertura de uma p√°gina no TabNews, incluindo acelerar o **Time to Interactive (TTI)**, principalmente para p√°ginas que possuem um `body` muito grande, que √© limpar os `metadados` antes de serem "cozinhados" pelo Next.js.

## Execu√ß√£o

Hoje estamos utilizando o novo model [remove-markdown.js](https://github.com/filipedeschamps/tabnews.com.br/blob/60dc53740abba0406e95a8fdfb38275743832e4b/models/remove-markdown.js) com o fix do @aprendendofelipe no cabe√ßalho dos arquivos de layout, por exemplo:

https://github.com/filipedeschamps/tabnews.com.br/blob/60dc53740abba0406e95a8fdfb38275743832e4b/pages/interface/components/DefaultLayout/index.js#L26

Fora isso, fazemos ainda algumas transforma√ß√µes, como remover as quebras de linha e tudo isso pode ser feito dentro do `getStaticProps()` para nada disso precisar ser processado no client-side.

- #661

>> Coment√°rio de kaique-soares:
@filipedeschamps eu tive a mesma sensa√ß√£o que voc√™ relatou em rela√ß√£o ao frontend, no PR #660 

Eu subi uma branch com a implementa√ß√£o dessa issue aqui, mas fiquei travado para abrir o PR porque n√£o me senti seguro se o que eu fiz, de fato, resolve a issue. Apesar da implementa√ß√£o ser simples, acredito, eu me peguei checando v√°rias vezes se onde eu modifiquei era de fato o √∫nico lugar que o component `DefaultLayout` tava recebendo a propriedade `content`.

Poderia dar uma olhada?

>> Coment√°rio de filipedeschamps:
Sensacional @kaique-soares ! Uma sugest√£o: **mantenha o medo e abra o PR mesmo assim!** Voc√™ vai ver que vamos tentar ao m√°ximo proteger para que aqui seja um espa√ßo em que qualquer pessoa possa tentar contribuir. N√£o interessa se sua implementa√ß√£o est√° certa ou n√£o, o que interessa √© que, mesmo com medo, voc√™ vai ter coragem de abrir esse PR, esta √© a parte mais importante desta sua contribui√ß√£o.

O que sobra, √© a parte t√©cnica, e da√≠ a gente conversa sobre isso l√° no PR, combinado? ü§ù

>> Coment√°rio de filipedeschamps:
Fechado por #661
</issue_650_Cozinhar os metadados no `getStaticProps()`>

<issue_652_Script para reconstruir hist√≥rico de TabCoins>
## Contexto e Execu√ß√£o

**Nesse caso, sugiro fortemente centralizar a discuss√£o na publica√ß√£o abaixo**

- https://www.tabnews.com.br/filipedeschamps/rfc-script-que-ira-preencher-historico-de-tabcoins

>> Coment√°rio de filipedeschamps:
Rodei hoje de manh√£ em Homologa√ß√£o, deu tudo certo demorou 60 segundos: https://tabnews-8b589clch-tabnews.vercel.app/filipedeschamps/rodei-o-script-de-preencher-o-historico-de-tabcoins-em-homologacao

Mas fui rodar agora em produ√ß√£o, e dado que a minha m√°quina aqui est√° longe da inst√¢ncia do banco em S√£o Paulo, demorou **muito  mais** (18 minutos) e nesse meio tempo, as TabCoins se mexeram e o script fez rollback üòÇ 

```js
    {
      name: 'UnprocessableEntityError',
      message: 'Number of added Content TabCoins does not match',
      action: 'Os dados enviados est√£o corretos, por√©m n√£o foi poss√≠vel realizar esta opera√ß√£o.',
      status_code: 422,
      error_id: 'b56c7726-907e-42b9-8be5-09f9bcbb8de3',
      request_id: '54cc3af3-7a91-4099-a82d-a09f05406f19',
      context: {
        total_contents_before_tabcoins: 2815,
        total_contents_tabcoins_before: '5271',
        total_contents_tabcoins_after: '8088',
        added_tab_coins: 2817
      }
    }
```

O legal √© que o rollback funcionou certinho pelo que pude avaliar aqui üëç

>> Coment√°rio de filipedeschamps:
Script executado em produ√ß√£o, durou **18 minutos**:

```
Contents: 4537
Contents before TabCoins existence: 2815
---
Content TabCoins (before): 5286
Content TabCoins (after): 8101 (+2815)
---
User TabCoins (before): 11995
User TabCoins (after): 40145 (+28150)
```

Isso injetou **muita** TabCoin no sistema, muita mesmo, mas tudo bem, pois era o que tinhamos combinado :)

>> Coment√°rio de filipedeschamps:
E este foi o **exato** script que rodei:

```js
import nextConnect from 'next-connect';
import controller from 'models/controller.js';
import database from 'infra/database.js';
import event from 'models/event.js';
import balance from 'models/balance.js';
import { UnprocessableEntityError } from 'errors/index.js';

export default nextConnect({
  attachParams: true,
  onNoMatch: controller.onNoMatchHandler,
  onError: controller.onErrorHandler,
})
  .use(controller.injectRequestMetadata)
  .get(runTabCoinsScript);

async function runTabCoinsScript(request, response) {
  // Para quem n√£o conhece, o conceito de "dry run" √© tentar rodar um c√≥digo,
  // mas que ao final n√£o faz nada de verdade. No caso desse script, √©
  // iniciada uma transa√ß√£o no banco de dados, que de fato executa tudo,
  // mas ao final √© feito o rollback, o que cancela tudo que foi feito.
  const DRY_RUN = false;
  const transaction = await database.transaction();

  try {
    await transaction.query('BEGIN');

    // 0) CRIAR EVENTO
    //    N√≥s primeiro criamos um evento, pois este evento ser√° usado
    //    como lastro em todas as entradas de balan√ßo que iremos criar
    //    mais para frente. A √∫nica coisa chata de "marretar" um evento
    //    assim fora do fluxo normal √© que eu precisei hardcode o meu
    //    usu√°rio e ip (localhost).
    const currentEvent = await event.create(
      {
        type: 'system:update:tabcoins',
        originatorUserId: '07ea33ea-78bd-4578-bad2-1cf5323cab07', // filipedeschamps
        originatorIp: '127.0.0.1',
        metadata: {
          description: `Backfill all TabCoins from contents created before '2022-07-03 16:48:12.457+00'.`,
        },
      },
      {
        transaction: transaction,
      }
    );

    // 1) PEGAR N√öMERO TOTAL DE CONTE√öDOS PUBLICADOS
    //    Para refer√™ncia, eu pego o n√∫mero total de Conte√∫dos publicados
    //    e isso vai dar um comparativo bom com a pr√≥xima query.
    const totalContents = await transaction.query(`
      SELECT
        count(*)
      FROM
        contents
      WHERE
        status = 'published'
    ;`);

    console.log(`Contents: ${totalContents.rows[0].count}`);

    // 2) PEGAR CONTE√öDOS CRIADOS ANTES DO DEPLOY SOBRE AS TABCOINS
    //    Estes Conte√∫dos hoje podem ter saldo de TabCoins, mas n√£o
    //    importa, pois precisamos mais para frente creditar as TabCoins
    //    originais do Conte√∫do e do Usu√°rio criador do Conte√∫do. Ent√£o
    //    dessa query, a gente extrai o ID do Conte√∫do e o ID do Autor
    //    e n√£o importa se o Conte√∫do √© "root" ou "child", precisa apenas
    //    estar com status "published" e ter sido criado antes do deploy.
    const totalContentsBeforeTabcoins = await transaction.query(`
      SELECT
       id as content_id,
       owner_id as user_id
      FROM
        contents
      WHERE
        contents.status = 'published'
        AND contents.created_at < '2022-07-03 16:48:12+00'
    ;`);

    console.log(`Contents before TabCoins existence: ${totalContentsBeforeTabcoins.rows.length}`);
    console.log(`---`);

    // 3) PEGAR TOTAL DE TABCOINS POSITIVAS DOS CONTE√öDOS (ANTES)
    //    Apenas como refer√™ncia, eu somo o total de TabCoins positivas
    //    de todos os Conte√∫dos do sistema s√≥ para entender o que vai
    //    acontecer com esse valor depois de rodarmos o script.
    const totalContentsTabcoinsBefore = await transaction.query(`
      SELECT
        sum(amount)
      FROM
        balance_operations
      WHERE
        balance_type = 'content:tabcoin'
        and amount > 0
    ;`);

    console.log(`Content TabCoins (before): ${totalContentsTabcoinsBefore.rows[0].sum}`);

    // 4) CRIAR TABCOINS PARA OS CONTE√öDOS
    //    Basicamente √© criado uma entrada na tabela de balan√ßo para cada
    //    Conte√∫do que foi criado antes do deploy e est√° na vari√°vel "totalContentsBeforeTabcoins"
    //    acima. Fora isso, usamos o evento tamb√©m criado acima para registrar o lastro
    //    dessa movimenta√ß√£o.
    for await (const contentWithoutTabcoins of totalContentsBeforeTabcoins.rows) {
      const contentId = contentWithoutTabcoins.content_id;

      await balance.create(
        {
          balanceType: 'content:tabcoin',
          recipientId: contentId,
          amount: 1, // Valor padr√£o que o Conte√∫do ganha ao ser criado
          originatorType: 'event',
          originatorId: currentEvent.id,
        },
        {
          transaction: transaction,
        }
      );
    }

    // 4) PEGAR TOTAL DE TABCOINS POSITIVAS DOS CONTE√öDOS (DEPOIS)
    //    Ent√£o agora n√≥s conseguiremos comparar o que aconteceu com
    //    o n√∫mero total de TabCoins no sistema, que deveria ter a mais
    //    o mesmo n√∫mero de Conte√∫do sem TabCoins, dado que √© creditado
    //    1 TabCoin por cria√ß√£o de conte√∫do.
    const totalContentsTabcoinsAfter = await transaction.query(`
      SELECT
        sum(amount)
      FROM
        balance_operations
      WHERE
        balance_type = 'content:tabcoin'
        and amount > 0
    ;`);

    console.log(
      `Content TabCoins (after): ${totalContentsTabcoinsAfter.rows[0].sum} (+${
        totalContentsTabcoinsAfter.rows[0].sum - totalContentsTabcoinsBefore.rows[0].sum
      })`
    );
    console.log(`---`);

    // 5) PEGAR TOTAL DE TABCOINS POSITIVAS DOS USU√ÅRIOS (ANTES)
    //    Mesma l√≥gica usada no caso das TabCoins dos Conte√∫dos, mas agora
    //    para os Usu√°rios.
    const totalUsersTabcoinsBefore = await transaction.query(`
      SELECT
        sum(amount)
      FROM
        balance_operations
      WHERE
        balance_type = 'user:tabcoin'
        and amount > 0
    ;`);

    console.log(`User TabCoins (before): ${totalUsersTabcoinsBefore.rows[0].sum}`);

    // 6) CRIAR TABCOINS PARA OS USU√ÅRIOS
    //    Praticamente a mesma l√≥gica que antes, mas agora bonificando os Usu√°rios.
    for await (const contentWithoutTabcoins of totalContentsBeforeTabcoins.rows) {
      const userId = contentWithoutTabcoins.user_id;

      await balance.create(
        {
          balanceType: 'user:tabcoin',
          recipientId: userId,
          amount: 10, // O valor b√¥nus para quem se arriscou a criar um Conte√∫do no passado
          originatorType: 'event',
          originatorId: currentEvent.id,
        },
        {
          transaction: transaction,
        }
      );
    }

    // 7) PEGAR TOTAL DE TABCOINS POSITIVAS DOS USU√ÅRIOS (DEPOIS)
    //    Isso deveria gerar para os usu√°rios 10x mais TabCoins que foram
    //    geradas para os Conte√∫dos.
    const totalUsersTabcoinsAfter = await transaction.query(`
      SELECT
        sum(amount)
      FROM
        balance_operations
      WHERE
        balance_type = 'user:tabcoin'
        and amount > 0
    ;`);

    console.log(
      `User TabCoins (after): ${totalUsersTabcoinsAfter.rows[0].sum} (+${
        totalUsersTabcoinsAfter.rows[0].sum - totalUsersTabcoinsBefore.rows[0].sum
      })`
    );

    if (
      totalContentsBeforeTabcoins.rows.length !==
      totalContentsTabcoinsAfter.rows[0].sum - totalContentsTabcoinsBefore.rows[0].sum
    ) {
      throw new UnprocessableEntityError({
        message: 'Number of added Content TabCoins does not match',
        context: {
          totalContentsBeforeTabcoins: totalContentsBeforeTabcoins.rows.length,
          totalContentsTabcoinsBefore: totalContentsTabcoinsBefore.rows[0].sum,
          totalContentsTabcoinsAfter: totalContentsTabcoinsAfter.rows[0].sum,
          addedTabCoins: totalContentsTabcoinsAfter.rows[0].sum - totalContentsTabcoinsBefore.rows[0].sum,
        },
      });
    } else if (
      totalContentsBeforeTabcoins.rows.length !==
      (totalUsersTabcoinsAfter.rows[0].sum - totalUsersTabcoinsBefore.rows[0].sum) / 10
    ) {
      throw new UnprocessableEntityError({
        message: 'Number of added User TabCoins does not match',
        context: {
          totalContentsBeforeTabcoins: totalContentsBeforeTabcoins.rows.length,
          totalUsersTabcoinsBefore: totalUsersTabcoinsBefore.rows[0].sum,
          totalUsersTabcoinsAfter: totalUsersTabcoinsAfter.rows[0].sum,
        },
      });
    } else if (DRY_RUN) {
      throw new UnprocessableEntityError({
        message: 'Dry run',
      });
    } else {
      await transaction.query('COMMIT');
      await transaction.release();
      return response.status(200).json({});
    }
  } catch (error) {
    await transaction.query('ROLLBACK');
    await transaction.release();
    throw error;
  }
}
```
</issue_652_Script para reconstruir hist√≥rico de TabCoins>

<issue_653_[bug] O rascunho n√£o √© vinculado a um usu√°rio>
Estava fazendo um teste com outro usu√°rio que tenho no tabnews, e quando fui escrever uma nova publica√ß√£o percebi que carregou o rascunho da minha outra conta.

Sei que o computador na maioria das vezes √© pessoal, mas acredito que n√£o seja correto. Se utilizar algum PC de lan house ou at√© mesmo de uma empresa, acho errado n√£o restringir o rascunho a chave do usu√°rio.

>> Coment√°rio de aprendendofelipe:
Acho que √© uma boa substituir o `localStorage.removeItem('user')` por `localStorage.clear()` na fun√ß√£o `logout`. O que acha @rodrigoKulb?

>> Coment√°rio de rodrigoKulb:
Uma √≥tima solu√ß√£o!

>> Coment√°rio de filipedeschamps:
Fechado por #668
</issue_653_[bug] O rascunho n√£o √© vinculado a um usu√°rio>

<issue_654_Bug em coment√°rios?>
Ola pessoal, ent√£o estou no celular e talvez precisasse investigar melhor. Tenho esse link de uma conversa em um post:

https://www.tabnews.com.br/CarlosZiegler/3d4e0ef7-3c60-416a-9f5d-394cf738fd87

No qual tem a conversa sobre um post em espec√≠fico. Por√©m quanto quero entrar no post:

https://www.tabnews.com.br/Jack/usestate-fora-do-react

Ta dando pra mim 404. Me pergunto:
- Se o post foi deletado, o correto √© manter os coment√°rios ? Pois assim se perde o contexto n√£o? 

- Caso queira manter o hist√≥rico nao ser√° melhor editar para nao ser mais poss√≠vel seguir nessa thread? 


Isso supondo que o post foi deletado, caso n√£o tenha sido, por que estou recebendo 404? Verifiquei umas 3 vezes :)

>> Coment√°rio de filipedeschamps:
@CarlosZiegler veja como est√° a evolu√ß√£o desse assunto nesse PR #676 (mais abaixo tem imagens)

>> Coment√°rio de filipedeschamps:
Link de refer√™ncia: https://www.tabnews.com.br/CarlosZiegler/3d4e0ef7-3c60-416a-9f5d-394cf738fd87

## Antes do fix

<img width="977" alt="image" src="https://user-images.githubusercontent.com/4248081/186467495-60fe27c5-cf4f-4e33-99d2-080ab873dd0d.png">

## Depois do fix

<img width="977" alt="image" src="https://user-images.githubusercontent.com/4248081/186467869-a73c39dc-cd02-4675-ae84-18f461523c20.png">

## Filho do filho

E se voc√™ acessar um conte√∫do filho numa profundidade ainda maior, o `root` deletado continua escondido e com a explica√ß√£o que est√° com status `deleted` se passar o mouse em cima: https://www.tabnews.com.br/Jack/97bad1e3-c676-49c3-b2ec-dd9a8e87f73b

<img width="977" alt="image" src="https://user-images.githubusercontent.com/4248081/186468282-bcc5bc55-87a4-47d4-8cbf-b29b132e33af.png">


Fechado por #676
</issue_654_Bug em coment√°rios?>

<issue_655_Novo Ranking de Conte√∫dos e Score de forma Persistente>
## Contexto

Hoje o algoritmo que define a ordem das publica√ß√µes e coment√°rios √© calculado de forma din√¢mica a cada requisi√ß√£o e usa uma regra inspirada no algoritmo do Hacker News e Reddit. N√£o √© uma regra dif√≠cil de entender, mas √© uma regra din√¢mica que acaba ficando dif√≠cil de prever o comportamento, fora que hoje n√£o estamos salvando um score de forma permanente no objeto de `content` e isso traz algumas dificuldades de ordena√ß√£o na hora de considerar publica√ß√µes que ultrapassam a pagina√ß√£o.

Com isso, o @aprendendofelipe sugeriu [uma nova mec√¢nica](https://www.tabnews.com.br/FelipeBarso/sugestao-mecanica-das-moedas-do-tabnews) que inclusive leva em considera√ß√£o um hist√≥rico do usu√°rio. Ontem tive uma conversa **fant√°stica** com ele e que ficou vis√≠vel todos os benef√≠cios de se usar uma mec√¢nica assim e para v√°rias situa√ß√µes, at√© para quando o que acontece se a pessoa deletar publica√ß√µes que estavam positivadas ou negativadas, pois isso j√° aconteceu no passado, aconteceu [recentemente](https://github.com/filipedeschamps/tabnews.com.br/issues/654) e vai continuar acontecendo.

## Execu√ß√£o

- #748
- #750
- Verificar √∫ltimo coment√°rio, tem v√°rios outros PRs

---

## [Deprecated]

Sugiro dividir a execu√ß√£o disso em duas Fases:

### Primeira fase

Dado a uma condi√ß√£o complexa, eu sempre acho mais proveitoso separar em passos, e para esse primeiro passo, sugiro que duas coisas sejam feitas:

1. Utilizar uma vers√£o inicial* do algoritmo do @aprendendofelipe e persistir um `score` dentro do `content`.
2. Criar nova `strategy` chamada `relevant` que ordena as publica√ß√µes por esse `score`.
3. Nessa nova estrat√©gia, √© importante ter uma nota de corte de inicialmente `1` tabcoin.

*O que seria uma vers√£o inicial? Eu n√£o sei, minha √∫nica preocupa√ß√£o √© entender como e quando vamos atualizar esse `score` no banco de dados e o qu√£o pesado √© calcular ele e persistir isso. Ent√£o talvez sugiro n√£o analisar o hist√≥rico ou definir uma reputa√ß√£o do usu√°rio se isso pesar muito e s√≥ levar em considera√ß√£o as `tabcoins` e `tempo`, como no algoritmo atual, mas usando a estrat√©gia do @aprendendofelipe com `steps` que fica muito mais previs√≠vel.

Nessa primeira fase, o mais importante na verdade √© ter um **score persistente** e ter uma **nota de corte**, pois √© isso que mais precisaremos para estarmos prontos para o **ru√≠do** de conte√∫dos que o lan√ßamento possa trazer. Passando essa lombada inicial, podemos nos focar em ficar lapidando o algoritmo com estrat√©gias mais complexas e essa parte quanto mais tempo e mais bem feita for, maior ser√° a capacidade do TabNews de se tornar um ecossistema saud√°vel e conseguir atender a regra de "tudo que voc√™ ler dentro do TabNews, vai ter valido a pena". Chegar nesse ponto e se **manter** nisso √© algo **fundamental** para o TabNews funcionar em alta escala.

### Segunda fase

Ent√£o para conseguir se manter nesse ponto, com a infraestrutura anterior rodando em produ√ß√£o, podemos ficar iterando infinitamente em algoritmos mais complexos, inclusive usando estrat√©gias de cache para que, independente do custo de calcular um `score`, o retorno da lista de conte√∫dos seja instant√¢nea. Ou at√© separar onde √© feito o c√°lculo e persist√™ncia, do retorno da lista.

Em paralelo, isso envolve um ponto que o @aprendendofelipe falou na conversa que tivemos, que √© o usu√°rio, dado o seu hist√≥rico de contribui√ß√£o, saber qual a sua reputa√ß√£o, porque isso vai ser usado como multiplicador nas publica√ß√µes seguintes. Antecipei que morro de medo de ter mais um ativo na economia, assim como lutei o m√°ximo que pude contra o TabCash, mas continuei pensando no que ele falou e de fato, para uma UX boa, a pessoa precisa ver a reputa√ß√£o dela em um **√∫nico n√∫mero f√°cil de entender**.

De qualquer forma, sugiro continuarmos as conversas antes de implementar qualquer coisa sobre isso, por isso sugeri separar em duas fases ü§ù

>> Coment√°rio de filipedeschamps:
Fechado por #748

>> Coment√°rio de filipedeschamps:
@aprendendofelipe vou puxar para c√° a conversa sobre o algoritmo para n√£o correr o risco da conversa ser fragmentada por m√∫ltiplos PRs.

Queria puxar principalmente a minha preocupa√ß√£o apontada [nesse coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/pull/748#issuecomment-1261099563) sobre conte√∫do `stale` na Home. O print abaixo √© da √∫ltima vers√£o publicada pelo PR #750, onde o primeiro item teoricamente j√° estaria na primeira posi√ß√£o por 4 dias:

<img width="463" alt="image" src="https://user-images.githubusercontent.com/4248081/192826915-a9632e8d-db6e-4ab2-bab1-abc8aa46f7f3.png">

N√£o sei se isso √© saud√°vel, dado que um conte√∫do assim, mesmo n√£o recebendo novas qualifica√ß√µes positivas, continuar√° ocupando o primeiro lugar caso algum outro conte√∫do n√£o ocupe. Ent√£o eu especulo que para algu√©m que acessa diariamente o TabNews, ter a probabilidade de um mesmo item nessa posi√ß√£o por 7 dias ficar√° cansativo.

Por isso da minha sugest√£o das primeiras janelas serem mais din√¢micas ü§ù

>> Coment√°rio de filipedeschamps:
Trazendo um pouco mais de contexto, print de agora:

<img width="860" alt="image" src="https://user-images.githubusercontent.com/4248081/192834016-15170204-9423-425f-ac2c-565b4527546a.png">

Para quem acessa diariamente o TabNews, os itens `1`, `2` e `3` s√£o menos relevantes que os itens `4`, `5`, `6` e `7` üëç

>> Coment√°rio de aprendendofelipe:
Concordo sobre o `stale`.... Na equa√ß√£o anterior tamb√©m tem esse efeito, mas provavelmente teria que ter um n√∫mero absurdo de TabCoins para isso acontecer. A vantagem √© que agora n√≥s escolhemos os n√∫meros.

Vamos ajustar...

>> Coment√°rio de filipedeschamps:
> Na equa√ß√£o anterior tamb√©m tem esse efeito, mas provavelmente teria que ter um n√∫mero absurdo de TabCoins para isso acontecer.

Correto! Um detalhe √© que para o `stale` acontecer, a cada momento que se passasse, o item precisaria ganhar mais qualifica√ß√µes positivas para conseguir vencer a batalha da gravidade ü§ù

>> Coment√°rio de aprendendofelipe:
Pode parecer, mas n√£o era a gravidade que retirava da primeira p√°gina os conte√∫dos antigos bem pontuados. Era o fato de s√≥ aparecer na primeira p√°gina os 30 conte√∫dos mais recentes, independentemente da pontua√ß√£o.

> Correto! Um detalhe √© que para o `stale` acontecer, a cada momento que se passasse, o item precisaria ganhar mais qualifica√ß√µes positivas para conseguir vencer a batalha da gravidade ü§ù

Sim e isso de fato j√° estaria acontecendo se n√£o fosse o que citei acima, pois a influ√™ncia do tempo diminui exponencialmente, ent√£o bastaria esse conte√∫do que chegou no topo continuar recebendo poucas qualifica√ß√µes positivas que ele ficaria para sempre no topo. Lembra que lhe alertei sobre isso? Esse √© um dos problemas de utilizar puramente aquela equa√ß√£o. Tamb√©m n√£o tinha limite de conte√∫dos que poderiam ficar `stale`. Que teria que dar um boost inicial cada vez maior, etc...

Agora estamos bem melhor... Est√° nas nossas m√£os controlar o que deve ocorrer com os conte√∫dos que fugirem da curva normal. S√≥ precisamos escolher bem:

1. Quantos conte√∫dos daremos destaque;
2. Qual √© a quantidade m√≠nima de TabCoins (ou Score) que ele precisa para ser considerado um destaque;
3. Qual √© a idade m√°xima do conte√∫do para poder aparecer como destaque;
4. Em que posi√ß√£o colocaremos esses destaques na lista de conte√∫dos.

Tentei responder essas quest√µes para reproduzir um efeito parecido com o que a equa√ß√£o j√° fazia. Mas j√° temos melhorias, pois agora, mesmo numa semana de v√°rios conte√∫dos top, s√≥ um ficar√° no topo. E nos √∫ltimos 2 dias, s√≥ 2 ou 3 ficar√£o por l√°. E nunca que um conte√∫do de mais de uma semana ficar√° no topo. Mas, por outro lado, n√£o temos o limite de 30 conte√∫dos mais recentes, ent√£o fica mais claro que a equa√ß√£o estava longe do ideal.

>> Coment√°rio de filipedeschamps:
Para deixar registrado, o @aprendendofelipe deu a ideia de criar uma branch separada para testarmos algoritmos de ranking diferentes:

- #754
- #755
- #756 
- #758
- #761
- #767
- #769
</issue_655_Novo Ranking de Conte√∫dos e Score de forma Persistente>

<issue_656_Implementa Rate Limit na API: Rotas com `POST`, `PATCH` e `DELETE`>
## Contexto

Continuando a implementar o rate-limit proposto pela issue #639 e que j√° foi iniciado na issue #635, mas dessa vez vamos come√ßar a trabalhar em outros endpoints sens√≠veis.

## Execu√ß√£o

Estava analisando os endpoints da API e destaquei o seguinte:

| M√©todo | Caminho | Cuidado
|:-|:-|:-
| PATCH | /api/v1/activation | intermedi√°rio
| POST | /api/v1/contents | baixo
| POST | /api/v1/recovery | **alto**
| PATCH | /api/v1/recovery | **alto**
| DELETE | /api/v1/sessions | intermedi√°rio
| POST | /api/v1/sessions | **alt√≠ssimo**
| POST | /api/v1/users | baixo
| PATCH | /api/v1/users/[username] | baixo
| GET | /api/v1/user | ???

<small>**_PS: Faltou algum endpoint que voc√™s notaram?_**</small>

N√£o sei se voc√™s concordam com essa classifica√ß√£o, mas na verdade a parte mais curiosa na minha opini√£o √© o `GET /api/v1/user`. Destaco isso, pois √© um endpoint em que voc√™ **n√£o consegue enviar nada**, a n√£o ser o `session_id` (como qualquer outro endpoint que recebe e interpreta o `session_id`), mas ele √© especial porque, se quebrar ele por falta de rate-limit, os dados pessoais do usu√°rio s√£o retornados.

Ent√£o por um lado, ele n√£o oferece vetor de ataque adicional, por√©m se quebrado, devolve informa√ß√µes sens√≠veis. Especial, n√£o?

De qualquer forma, a inclus√£o de controles espec√≠ficos para mais endpoints est√° impratic√°vel no c√≥digo atual. Ent√£o estou proponto no PR abaixo a refatora√ß√£o, e depois a adi√ß√£o das novas rotas:

- #657

>> Coment√°rio de filipedeschamps:
Fechado por #657 e vamos considerar essa a primeira vers√£o, pois o @aprendendofelipe destacou pontos **muito** importantes no PR e que devem ser implementados ü§ù

>> Coment√°rio de filipedeschamps:
Por enquanto o uso est√° assim:

<img width="1015" alt="image" src="https://user-images.githubusercontent.com/4248081/185712690-6b482eb7-60ad-431e-85c1-dd0633f58a2d.png">

>> Coment√°rio de filipedeschamps:
Registrando aqui o uso:

<img width="1010" alt="image" src="https://user-images.githubusercontent.com/4248081/185951369-9c7538fd-b644-438a-b512-294447f5b9aa.png">

>> Coment√°rio de filipedeschamps:
Vai vir o primeiro billing do Upstash de **0.47 dolares**:

<img width="1021" alt="image" src="https://user-images.githubusercontent.com/4248081/188496875-b0bebf5f-f970-4fc4-8910-faa91fbf1dcb.png">
</issue_656_Implementa Rate Limit na API: Rotas com `POST`, `PATCH` e `DELETE`>

<issue_658_Breaking Change: alterar `strategy` de `best` para `relevant`>
## Contexto

Hoje o endpoint `/api/v1/contents` aceita 3 tipos de estrat√©gia:

| Estrat√©gia | Descri√ß√£o |
|-|-|
| [/api/v1/contents?strategy=best](https://www.tabnews.com.br/api/v1/contents?strategy=best) | Ordena pelos conte√∫dos mais **relevantes.** |
| [/api/v1/contents?strategy=new](https://www.tabnews.com.br/api/v1/contents?strategy=new) | Ordena dos conte√∫dos mais **novos** para os mais **antigos**. |
| [/api/v1/contents?strategy=old](https://www.tabnews.com.br/api/v1/contents?strategy=old) | Ordena dos conte√∫dos mais **antigos** para os mais **novos**. |

Mas o nome da estrat√©gia `best` n√£o acredito ser o melhor e dever√≠amos mudar o nome para `relevant`, pois n√£o s√£o os **melhores** conte√∫dos e sim os mais **relevantes para aquele momento**. Isto far√° um par muito melhor l√° no menu principal superior, pois poder√≠amos colocar os itens **Relevantes** e **Recentes**.

Fora que a estrat√©gia `best` poderia ser usada para ordenar as publica√ß√µes **apenas pelas `tabcoins`** para um **dia** em espec√≠fico. Por exemplo, mostrar qual foi a publica√ß√£o mais bem avaliada `X`, ou at√© da semana, do m√™s, etc.

---

An√∫ncio da Breaking Change: https://www.tabnews.com.br/filipedeschamps/breaking-change-na-api-remocao-da-estrategia-best-e-informacoes-adicionais-de-parent-no-objeto-content

## Execu√ß√£o

Por hora, copiar para a estrat√©gia `relevant` o que a estrat√©gia `best` est√° fazendo e manter as duas rodando ao mesmo tempo, depois anunciar a breaking change, e por fim remover a `best` at√© que ela seja implementada da forma nova proposta no contexto.

- #662
- #681

>> Coment√°rio de filipedeschamps:
Primeiro passo dado que foi o merge do PR #662 e que exp√µe a estrat√©gia `relevant`. Agora s√≥ falta anunciar a breaking change e por enquanto remover a `best` üëç

>> Coment√°rio de filipedeschamps:
Fechado por #662 e #681
</issue_658_Breaking Change: alterar `strategy` de `best` para `relevant`>

<issue_659_Breaking change: remover a propriedade `username` do objeto `content`>
## Contexto

Primeiro t√≥pico dessa publica√ß√£o: https://www.tabnews.com.br/filipedeschamps/breaking-change-na-api-do-tabnews-sobre-o-objeto-content

## Execu√ß√£o

Remover por completo a propriedade `username` do objeto `content`.

>> Coment√°rio de filipedeschamps:
Fechado por duplicidade com #619
</issue_659_Breaking change: remover a propriedade `username` do objeto `content`>

<issue_663_Mensagem n√£o centralizada quando n√£o h√° conte√∫dos publicados>
## Contexto

Tem algo simples no TabNews que, quando n√£o h√° nenhum conte√∫do encontrado (por exemplo um usu√°rio nunca publicou nada), a mensagem que aparece `Nenhum conte√∫do encontrado.` est√° completamente desalinhada:

https://www.tabnews.com.br/henriquederosa

<img width="1904" alt="image" src="https://user-images.githubusercontent.com/4248081/185760182-cbb4016d-5ac3-44d2-a975-6b481506e0fc.png">

## Execu√ß√£o

Esta mensagem √© renderizada no `ContentList` e fora n√£o estar centralizada, o espa√ßamento entre o menu superior e a pagina√ß√£o abaixo tamb√©m est√° completamente desbalanceada.

https://github.com/filipedeschamps/tabnews.com.br/blob/2003e30353c0c032b78a8b8388bea912e0af8160/pages/interface/components/ContentList/index.js#L119-L126

Em paralelo, uma coisa que poder√≠amos aproveitar para fazer (talvez em outra issue para n√£o complicar essa?) √© identificar se o usu√°rio que acessou a p√°gina √© o mesmo usu√°rio que est√° logado e colocar um link recomendando ele a criar sua primeira publica√ß√£o.

- #665

>> Coment√°rio de filipedeschamps:
Fechado por #665

>> Coment√°rio de filipedeschamps:
## Antes

<img width="1008" alt="image" src="https://user-images.githubusercontent.com/4248081/185923940-a02e79f3-f617-4d89-b664-7d97522e0506.png">

## Depois do PR do @luantoningalvan 

<img width="1008" alt="image" src="https://user-images.githubusercontent.com/4248081/185924660-f7794936-b721-4f08-aa8c-11c15920ad8b.png">

## Com um detalhe a mais

Se voc√™ estiver logado e acessar a sua pr√≥pria p√°gina e ela n√£o tiver nenhum conte√∫do, aparece isso:

<img width="1008" alt="image" src="https://user-images.githubusercontent.com/4248081/185925244-370187e9-7d11-4190-9458-4efea97e7a73.png">

## Com um detalhe a mais 2

A Home tamb√©m tem sua mensagem, mas isso eu vou deixar apenas para quem rodar o projeto em localhost ‚ù§Ô∏è
</issue_663_Mensagem n√£o centralizada quando n√£o h√° conte√∫dos publicados>

<issue_664_Tabnews marcado como suspeito pelo McAfee>
O neg√≥cio √© bem simples, quando eu visito a p√°gina, ele d√° esse aviso:

![image](https://user-images.githubusercontent.com/59847214/185762856-b7026b3e-fed7-4cf7-b176-5f60d881b1d9.png)

Acredito que possa ser um bug do McAfee, e eu nem sei que Label encaixaria aqui.

>> Coment√°rio de filipedeschamps:
Massa @PabloJuan255 muito obrigado por trazer isso para c√° ü§ù e voc√™ sabe se tem algum lugar que ele consegue dar mais informa√ß√µes do que exatamente ele achou suspeito?

Eu vi que est√° escrito `PUPs` numa tag ali. Se voc√™ passar o mouse em cima, aparece algo a mais?

>> Coment√°rio de filipedeschamps:
Encontrei isso: https://www.mcafee.com/enterprise/en-us/assets/misc/ms-pup-policy.pdf

<img width="362" alt="image" src="https://user-images.githubusercontent.com/4248081/185764903-eada62f7-90d3-4315-b41c-647580cad770.png">

Que leva para um Dispute Form: https://www.mcafee.com/apps/mcafee-labs/dispute-form.aspx

Mas o link est√° quebrado.

Cavucando pela internet encontrei isso aqui: https://www.mcafee.com/en-us/consumer-support/dispute-detection-allowlisting.html

J√° entrei em contato ü§ù

>> Coment√°rio de ghost:
Desculpa pela demora, se eu lembro bem, ele n√£o falava muita coisa, ele fala algo tipo
> Esse site pode ter Programas Potencialmente Indesejados (PUPs), ele poderia "entrar" no computador e bla bla bla

>> Coment√°rio de filipedeschamps:
Fechado ü§ù vamos deixar essa issue aberta e ver se respondem o formul√°rio. Se n√£o tiver retorno por parte deles, vamos entender o que fazer, nem que seja fechar a issue e considerar um falso positivo üëç

>> Coment√°rio de filipedeschamps:
Turma, at√© hoje n√£o recebi nenhum retorno da McAfee, nem na caixa de spam. Ent√£o eu comecei a usar alguns sites de scan online, e n√£o sei o qu√£o confi√°veis s√£o, mas queria fazer alguma tentativa antes de fechar essa issue:

## https://www.virustotal.com/

<img width="1792" alt="image" src="https://user-images.githubusercontent.com/4248081/187043339-881fb83c-e827-4cd6-a01a-c54ba4cbdfc5.png">

## https://sitecheck.sucuri.net/

<img width="1792" alt="image" src="https://user-images.githubusercontent.com/4248081/187043369-730ff2bd-ca69-4ad6-b4db-65bdf6c6a6d6.png">

Legal que esse site confirmou que de fato estamos bloqueados no McAfee, mas n√£o nos outros:

<img width="391" alt="image" src="https://user-images.githubusercontent.com/4248081/187043390-16230b8b-f212-49e3-b1a5-4856edd8fc3e.png">

Cliquei no bot√£o **Request Blacklist Removal**  mas me levou para uma p√°gina comercial. E clicando em cima do link do aviso, me levou para isso: https://www.siteadvisor.com/sitereport.html?url=tabnews.com.br

<img width="1029" alt="image" src="https://user-images.githubusercontent.com/4248081/187043455-1b0b22ab-3e46-42ae-810b-c34293032805.png">

## https://vms.drweb.com/online/

<img width="1792" alt="image" src="https://user-images.githubusercontent.com/4248081/187043466-d5148afd-12e5-4539-9224-79e6f1e2bbcf.png">

## https://scanner.pcrisk.com/

Esse √© o que mais demorou para rodar, mas me pareceu o mais **completo**.

<img width="1792" alt="image" src="https://user-images.githubusercontent.com/4248081/187043528-cd187ce3-c39e-4ef6-adf3-219a63761d5b.png">

<img width="1160" alt="image" src="https://user-images.githubusercontent.com/4248081/187043566-29911e7a-8e78-4d4e-a2d2-fa61aef162bc.png">

<img width="1160" alt="image" src="https://user-images.githubusercontent.com/4248081/187043573-a8ba13e9-dc90-4186-918a-ac0987649cee.png">

<img width="1160" alt="image" src="https://user-images.githubusercontent.com/4248081/187043577-d9961bde-b20a-4711-b977-6b30204018f7.png">

<img width="1160" alt="image" src="https://user-images.githubusercontent.com/4248081/187043584-5b51cf6e-7b84-4f6b-9a96-d43f180a2830.png">

---

## Conclus√£o

Desisto da McAfee infelizmente... mas se algu√©m sugerir o que fazer ou outro report, sinta-se livre em reabrir essa issue ü§ù  a seguran√ßa do TabNews √© um item **extremamente importante** e qualquer sinal n√£o pode ser deixado passar sem ser investigado.
</issue_664_Tabnews marcado como suspeito pelo McAfee>

<issue_666_Docker-compose: comando n√£o encontrado>
Boa tarde amigos, tudo bem?
Ap√≥s tentar rodar o projeto com o comando conforme descrito: "npm run dev" tenho o seguinte erro: "linha 1: docker-compose: comando n√£o encontrado". Como posso resolver, tentei mas n√£o consegui.

>> Coment√°rio de filipedeschamps:
@andersonFaro9 tudo bem? Voc√™ precisa ter essas depend√™ncias globais para conseguir rodar o projeto: https://github.com/filipedeschamps/tabnews.com.br#depend%C3%AAncias-globais

O que sugiro fazer √© rodar o reposit√≥rio atrav√©s do Codespaces aqui do GitHub ou do Gitpod que j√° possuem todas as depend√™ncias instaladas.

>> Coment√°rio de andersonFaro9:
Opa, Filipe, blza? Segui conforme est√° no Readme.md mas o erro persisti.

>> Coment√°rio de filipedeschamps:
@andersonFaro9 show, vamos descobrir o que est√° acontecendo üëç 

Quando voc√™ digita no terminal `docker --version` o que aparece? E quando voc√™ digita `docker-compose --version` o que aparece? No meu aparece o seguinte:

```
‚ùØ docker --version
Docker version 20.10.17, build 100c701

‚ùØ docker-compose --version
Docker Compose version v2.6.1
```

>> Coment√°rio de coffeeispower:
O tabnews s√≥ roda no Linux e Mac.
E preciso do docker e docker compose para rodar os outros micro servi√ßos como o banco de dados.

>> Coment√°rio de filipedeschamps:
@coffee-is-power at√© onde testamos, o TabNews funciona 100% no Windows ap√≥s esse detalhe aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/610

>> Coment√°rio de coffeeispower:
Mas e sempre melhor rodar dentro do wsl j√° que a maioria das ferramentas normalmente s√£o feitas pra Linux primeiro. Na minha opiniao

>> Coment√°rio de coffeeispower:
Agora que eu percebi que essa issue e a n√∫mero 666 :pepeCruz:
![ScrawnyInsistentAmoeba-size_restricted.gif](https://user-images.githubusercontent.com/92828847/186026564-c0c9f8ae-e04f-4743-aca2-babac56ef5e5.gif)

>> Coment√°rio de rodrigoKulb:
@coffee-is-power realmente o Docker roda somente dentro do WSL no fundo dentro de um ambiente Linux.

Esse cara ajuda bem como instalar no Windows https://www.youtube.com/watch?v=05YN8F8ajBc

> Agora que eu percebi que essa issue e a n√∫mero 666 :pepeCruz:

Issue #666 hahaha üëøÔ∏èüëªÔ∏èüëªÔ∏èü§£Ô∏è

>> Coment√°rio de andersonFaro9:
@filipedeschamps Quando digito: Docker version, isso √© o que retorna: Docker version 20.10.17, build 100c701
 e no caso do compose, me retorna : "docker-compose version 1.29.2, build unknown"

>> Coment√°rio de filipedeschamps:
@andersonFaro9 interessante, a vers√£o do Docker √© a mesma que tenho aqui e a vers√£o do docker-compose est√° acima da que est√° no README: Docker Compose v1.24.1, deveria funcionar.

Ent√£o sobre o erro `"linha 1: docker-compose: comando n√£o encontrado"` n√£o tem a ver com o Docker em s√≠, mas em como ele est√° conseguindo encontrar ele no sistema eu imagino.

Qual seu sistema operacional?

>> Coment√°rio de andersonFaro9:
√© o fedora

>> Coment√°rio de filipedeschamps:
Hmmm, vai ser dif√≠cil eu conseguir debugar por aqui. Mas de qualquer forma, o que acontece se voc√™ digitar o seguinte na raiz do reposit√≥rio do TabNews:

```
docker compose -f infra/docker-compose.development.yml up -d
```

>> Coment√°rio de andersonFaro9:
tentei isso e me retornou: 
```
Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/json?all=1&filters=%7B%22label%22%3A%7B%22com.docker.compose.project%3Dinfra%22%3Atrue%7D%7D&limit=0": dial unix /var/run/docker.sock: connect: permission denied
```

>> Coment√°rio de andersonFaro9:
Da√≠, eu fiz login com sudo e continuo sem conseguir

>> Coment√°rio de filipedeschamps:
@andersonFaro9 eu infelizmente n√£o saberei configurar o Docker no seu ambiente.

Sugiro novamente usar um ambiente online, pois vai estar tudo pronto. Sugiro utilizar o Gitpod ü§ù

>> Coment√°rio de andersonFaro9:
Consegui, cara... com o gitpod

>> Coment√°rio de andersonFaro9:
@filipedeschamps  no meu caso em que nunca participei diretamente um projeto no github em que participo e posso implementar uma "feature" qual primeiro passo, busco numa issue, tento implementar e mando um push?

>> Coment√°rio de coffeeispower:
Cria uma issue, depois cria uma branch faz as suas modifica√ß√µes e depois crie um pull request , dar push na master n√£o e permitido (obviamente, pq √© a branch sagrada)

>> Coment√°rio de coffeeispower:
Tem que instalar o docker-compose, e um programa separado https://docs.docker.com/compose/install/

>> Coment√°rio de andersonFaro9:
Obrigado @coffee-is-power

>> Coment√°rio de andersonFaro9:
Quanto ao compose, instalei sim mas n√£o foi como esperado. Estou acessando aqui com o gitpod como o Filipe sugeriu.

>> Coment√°rio de rodrigoKulb:
> Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/json?all=1&filters=%7B%22label%22%3A%7B%22com.docker.compose.project%3Dinfra%22%3Atrue%7D%7D&limit=0": dial unix /var/run/docker.sock: connect: permission denied

Grande @andersonFaro9 tive o mesmo problema utilizando o Mate, um problema de permiss√£o para acesso ao docker

Da uma olhada nesse artigo! Veja se consegue aplicar no Fedora

https://linuxhandbook.com/docker-permission-denied/#:~:text=deal%20with%20it.-,Fix%201%3A%20Run%20all%20the%20docker%20commands%20with%20sudo,the%20Docker%20daemon%20socket'%20anymore.

>> Coment√°rio de kaique-soares:
> @filipedeschamps no meu caso em que nunca participei diretamente um projeto no github em que participo e posso implementar uma "feature" qual primeiro passo, busco numa issue, tento implementar e mando um push?

@andersonFaro9 seja MUITO bem vindo ao reposit√≥rio do TabNews :handshake:

Estamos neste momento trabalhando nas tarefas da **Milestone 5** que tem como objetivo principal **lan√ßar publicamente o TabNews** e voc√™ pode encontrar mais detalhes na issue #493 :+1: 

E @andersonFaro9,  eu tamb√©m nunca havia participado de um projeto no Github com outras pessoas e a experi√™ncia **aqui** tem sido sensacional, acredito que n√£o teria lugar melhor para eu ter dado o primeiro passo :+1: 

E eu comecei aqui faz pouco tempo, se n√£o me engano eu cheguei entre o meio (quase fim) da Milestone 4 e o inicio da atual. E algo que **me ajudou muito** foi, antes de tocar em c√≥digo, entender o que tava acontecendo aqui e fiz isso:

1. Come√ßando pelo [di√°rio de desenvolvimento](https://github.com/filipedeschamps/tabnews.com.br/wiki)
2. Conhecendo a estrutura do projeto, estudando ela, cavucando mesmo!
3. Olhando issues/PRs anteriores, que est√£o muito bem organizados nas [milestones passadas](https://github.com/filipedeschamps/tabnews.com.br/milestones?state=closed) e tem MUITO conhecimento registrado :heart_eyes: 
4. E nesse meio tempo surgiram issues que eu vi que davam para eu resolver, outras que dei uma patinada e a **turma** me ajudou, e no fim deu tudo certo!

N√£o necessariamente tu precisa seguir por esse caminho, mas me ajudou muito e acredito que seja uma boa op√ß√£o :+1: 

No mais, caso precise de ajuda estamos aqui, beleza!

>> Coment√°rio de CarlosZiegler:
Tem um Pr meu que deu in√≠cio a documenta√ß√£o da API, mas tem que ser lapidado e inserir os endpoints, talvez um bom in√≠cio pra vc :) @andersonFaro9

>> Coment√°rio de andersonFaro9:
Obrigado amigos pelo retorno, estou de fato alegre em participar desse projeto. Lerei em breve cada coment√°rio novamente.

>> Coment√°rio de andersonFaro9:
Ontem numa entrevista, citei a Tabnews e falei um pouco desse projeto. A pessoa perguntou se sabia teste unit√°rios e disse que n√£o, mas tenho uma d√∫vida: o que seria de fato testes uniti√°rios? conhe√ßo pouco de teoria do tdd, imagino que n√£o √© o mesmo que testes unit√°rios, algu√©m pode esclarecer?

>> Coment√°rio de coffeeispower:
Aqui n√£o fazenos testes unit√°rios, apenas testes de integra√ß√£o da API, que consiste em fazer um request para API e verificar o que retorna dado tais inputs.

>> Coment√°rio de coffeeispower:
Tdd e um modo de desenvolver cria novas features e encontrar bugs usando testes.
Testes s√£o mini programas que verificam a integridade e funcionalidade do c√≥digo.
Testes tamb√©m podem ser considerados como especifica√ß√µes, ou seja, eles s√£o como requisitos expressos em c√≥digo,e voc√™ precisa cumprir esses requisitos para ele passar.

>> Coment√°rio de herculesgabriel:
@andersonFaro9, eu tive um problema parecido num outro projeto h√° um tempo atr√°s e talvez possa ser o seu caso. Antes de tudo, roda no seu terminal o comando `which docker-compose` e fala pra gente qual √© a sa√≠da. No meu caso est√° assim:

```bash
docker-compose: aliased to docker compose
```

Breve explica√ß√£o: nas novas instala√ß√µes do compose "docker-compose" n√£o √© mais um bin√°rio do sistema, mas sim um apelido para o bin√°rio correto. Por isso pode ser que o script do package.json n√£o encontre esse bin√°rio e retorne erro (mesmo que seja poss√≠vel utilizar normalmente fora do projeto).

>> Coment√°rio de Ryannnkl:
Opa!

como o @andersonFaro9  explicou, ``docker-compose`` √© um alias para o comando ``docker compose``. Segundo o proprio site do docker o comando docker-compose vai cair em desuso para a nova vers√£o do compose v2 em Junho:

![image](https://user-images.githubusercontent.com/48577990/221443699-0967991a-eb87-47d0-a817-d45437b89ce0.png)

## Solu√ß√£o

mudar os scripts no package.json para utilizar a nova sintaxe do docker compose, os parametros continuam os mesmos s√≥ o ``docker-compose`` que vai mudar para ``docker compose``

>> Coment√°rio de aprendendofelipe:
Considerando que o @andersonFaro9 disse que conseguiu, e que o PR #1315 adicionou a compatibilidade com os comandos `docker-compose` e `docker compose` ao mesmo tempo, mesmo para quem n√£o usa o Docker Desktop, estou fechando essa issue. üëç
</issue_666_Docker-compose: comando n√£o encontrado>

<issue_669_Limpar todo `localStorage` no ato de logout>
## Contexto

- #653

## Execu√ß√£o

- #668

>> Coment√°rio de filipedeschamps:
Fechado por #668
</issue_669_Limpar todo `localStorage` no ato de logout>

<issue_670_[Bug] Redu√ß√£o excessiva de TabCoins>
## Contexto

1. Eu estava fazendo alguns testes com os TabCoins [nessa publica√ß√£o](https://tabnews-kx21muwwi-tabnews.vercel.app/Ezequias/teste-de-comentarios). 
Os testes basicamente eram pra ver se havia um desbalanceamento quando dois usu√°rio ficassem trocando TabCoins entre si por meio de coment√°rios. Na conta principal de testes, eu tinha mais ou menos **160** TabCoins e na outra conta eu tinha apenas 1. 

2. Decidi transferir os TabCoins da conta principal para a secund√°ria atrav√©s de um coment√°rio e, pra facilitar essa transf√™rencia, eu usei um `loop for` pra fazer **fetch autom√°tico** e ir transferindo tudo mais rapidamente. Quando encerrou o loop, eu recarreguei a p√°gina para ver se tinha ido tudo certinho e foi ai que percebi que eu fiquei com **TabCoins** negativos...

N√£o sei se era pra realmente acontecer isso, eu imagino que quando um usu√°rio tem TabCoins abaixo de 2 ele √© impossibilitado de dar Upvote em alguma publica√ß√£o.

![image](https://user-images.githubusercontent.com/63757378/186013038-d7a9370d-76c0-41a8-9e95-079198f120f1.png)

Imagino que isso foi causado pelo fato de eu usar um loop pra dar upvote. Um `RateLimit`, nesse caso, seria suficiente para resolver?

#### Observa√ß√£o

Todos os TabCashs foram distribu√≠dos de forma certa e os TabCoins transferidos para a outra conta tamb√©m foram distribu√≠dos de forma certa.

>> Coment√°rio de silvaezequias:
Fiz um segundo teste na minha conta secund√°ria e o mesmo problema continua.

![image](https://user-images.githubusercontent.com/63757378/186016288-4a45e41e-4302-43a8-8ba9-f86c630e7773.png)

Isso me parece uma puni√ß√£o por fazer muitos requests de uma vez hahaha

>> Coment√°rio de filipedeschamps:
**Sensacional esse teste e muito obrigado por fazer em ambiente de homologa√ß√£o!** Eu recebi um alerta aqui avisando de algumas boas lambdas n√£o conseguindo encerrar dentro de 60 segundos e estourando um `504`. Um rate limit ajuda e seria √≥timo ter, mas isso n√£o vejo que seja "consertar o problema", pois ele ir√° apenas esconder um problema.

Fiquei muito curioso que os TabCash creditados ficaram ok, os TabCoins transferidos ficaram ok, mas as TabCoins debitadas n√£o. Eu especulo que o bug est√° aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/847dad88d899c6e188e0d2aab1587da408d82d68/models/balance.js#L86

Todo o fluxo deveria estar dentro de uma `transaction` e √© feita a confer√™ncia do saldo depois da movimenta√ß√£o, onde se ficou negativo, √© feito o rollback. √â **bem prov√°vel** que estamos sofrendo de um race condition üëç

>> Coment√°rio de filipedeschamps:
To pensando aqui: talvez o bug aconte√ßa na linha destacada ali em cima, mas n√£o por conta dela e sim por conta do isolation level que usamos. √â preciso investigar üëç

>> Coment√°rio de aprendendofelipe:
@gatodeoculos, foi o seu loop que me deu esses 50 Tabcoins? üòÖ

>> Coment√°rio de aprendendofelipe:
@gatodeoculos, outra d√∫vida... Ap√≥s transferir as 160 TabCoins, o usu√°rio que tinha s√≥ 1, acabou ficando com quantas?

>> Coment√°rio de silvaezequias:
> @gatodeoculos, foi o seu loop que me deu esses 50 Tabcoins? üòÖ

Isso mesmo, foi o loop que transferiu 50 TabCoins pra voc√™ sim!! üòÜ



> @gatodeoculos, outra d√∫vida... Ap√≥s transferir as 160 TabCoins, o usu√°rio que tinha s√≥ 1, acabou ficando com quantas?

Ele ficou com 85 exatamente.

>> Coment√°rio de silvaezequias:
> To pensando aqui: talvez o bug aconte√ßa na linha destacada ali em cima, mas n√£o por conta dela e sim por conta do isolation level que usamos. √â preciso investigar üëç

Ent√£o o algoritmo t√° "criando as d√≠vidas" a cada request e pelo fato de ser uma Promise ele debita os tabcoins depois de resolver a promise? porque se for assim, faz sentido esse resultado...
O algoritmo vai verificar se o usu√°rio tem tabcoins suficientes mas como a promise do request ainda n√£o foi resolvida, pro algoritmo vai ser como se o usu√°rio tivesse tabcoins suficientes porque ainda n√£o foram debitados...

Deu pra entender o que eu quis dizer? acho que ficou meio embolado esse meu racioc√≠nio

>> Coment√°rio de aprendendofelipe:
A quest√£o de ficar com saldo negativo deve ser pelo n√≠vel de isolamento da transa√ß√£o mesmo, o que acabou n√£o dando `ROLLBACK` s√≥ porque obteve dados desatualizados com a fun√ß√£o `get_current_balance`. At√© a√≠ tudo mais ou menos tranquilo.

> Ele ficou com 85 exatamente.

@gatodeoculos, ser√° que a quantidade de Tabcoins antes do loop era de cerca de 160 mesmo, e o outro usu√°rio tinha mesmo s√≥ 1?

Pergunto isso pois os n√∫meros n√£o est√£o batendo. Ou ent√£o voc√™ descobriu como minerar Tabcoins üòÖ e a√≠ √© algo mais complexo pra gente investigar.

Para bater, os n√∫meros iniciais deveriam ser 148 (Ezequias) e 2 (DablioZe).

E ent√£o o balan√ßo que ocorreu deve ser isso:

Primeiro loop
Saldo inicial Ezequias: 148 (n√£o 160)
Saldo inicial DablioZe: 2 (n√£o 1)
Cr√©dito coment√°rio do DablioZe: +83
Cr√©dito usu√°rio DablioZe: +83
Saldo final Ezequias: -18
Saldo parcial DablioZe: 85

Segundo loop
Saldo parcial DablioZe: 85
Cr√©dito coment√°rio do fe1ipe: +50
Cr√©dito usu√°rio fe1ipe: +50
Saldo final DablioZe: -15

Consegue confirmar @gatodeoculos?

>> Coment√°rio de filipedeschamps:
Seria **muito massa** conseguir fazer uma replica√ß√£o m√≠nima desse bug num teste de integra√ß√£o ü§ù

>> Coment√°rio de silvaezequias:
> @gatodeoculos, ser√° que a quantidade de Tabcoins antes do loop era de cerca de 160 mesmo, e o outro usu√°rio tinha mesmo s√≥ 1?

Na verdade, o valor inicial eu n√£o lembro quanto era exatamente, eu s√≥ lembro que era um valor acima de 150 e abaixo de 170, ai eu escolhi a m√©dia. 
E o valor da outra conta era realmente 1, porque eu tinha acabado de criar aquela conta e fiz apenas aquele coment√°rio e o valor resultante daquele coment√°rio foi apenas 1 (inclusive, a quantidade de upvotes que tem nesse coment√°rio √© de 84 e o valor final resultante era 85).

O processo foi o seguinte:

```mermaid
graph TD;
    Ezequias --> TabCoins=160+ou- -->DablioZe;
    DablioZe --> TabCoins=85 -->Felipe;
    DablioZe --> TabCash=85 --> Ezequias;
    Felipe --> TabCash=50 --> DablioZe;
```

>> Coment√°rio de aprendendofelipe:
@gatodeoculos, hoje cada coment√°rio j√° d√° 2 Tabcoins para o autor, por isso deve ter sido como eu disse, pois quando o DablioZe fez um coment√°rio, ele ganhou 2 Tabcoins e o coment√°rio ficou com 1 Tabcoin. Ent√£o Ezequias deu 83 upvotes para o coment√°rio, resultando em 84 Tabcoins para o coment√°rio e 85 para o usu√°rio DablioZe.

O usu√°rio Ezequias tem 85 TabCashs, mas provavelmente porque voc√™ j√° tinha dado voto em algum outro coment√°rio. N√£o √© isso?

O bom disso √© que √© s√≥ resolver o n√≠vel de isolamento da transa√ß√£o mesmo, pois apesar do saldo negativo, o balan√ßo est√° correto.

@filipedeschamps, acho que √© pelo caminho que voc√™ disse mesmo, tentar reproduzir esse bug nos testes e ver se √© necess√°rio deixar o n√≠vel de isolamento como `SERIALIZABLE` para passar sem problemas.

>> Coment√°rio de aprendendofelipe:
Problema resolvido! Mais tarde subo a solu√ß√£o, pois ainda falta deixar os testes mais bonitos üòÖ, mas n√£o vou conseguir fazer isso agora. 

S√≥ estou avisando para o caso de algu√©m estar pensando em trabalhar nisso agora.

>> Coment√°rio de filipedeschamps:
Que not√≠cia sensacional!!! Duas not√≠cias at√©, uma que ent√£o deu para simular com os testes e outra que j√° fez o fix ü§ù

>> Coment√°rio de aprendendofelipe:
> Que not√≠cia sensacional!!! Duas not√≠cias at√©, uma que ent√£o deu para simular com os testes e outra que j√° fez o fix ü§ù

Sim! E fazer o problema ocorrer em desenvolvimento/teste foi o √∫nico desafio... No PR contarei tudo

>> Coment√°rio de aprendendofelipe:
@gatodeoculos, seria magnifico ü§© se voc√™ conseguisse testar pra gente se o seu script ainda causa problemas nessa vers√£o em ambiente de homologa√ß√£o: 

https://tabnews-v319q04ww-tabnews.vercel.app/

>> Coment√°rio de silvaezequias:
> @gatodeoculos, seria magnifico ü§© se voc√™ conseguisse testar pra gente se o seu script ainda causa problemas nessa vers√£o em ambiente de homologa√ß√£o:

Eu at√© testaria mas eu n√£o tenho nenhum tabcoin pra isso...

>> Coment√°rio de filipedeschamps:
@gatodeoculos voc√™ pode criar qualquer publica√ß√£o no ambiente para gerar tabcoins üëç  de qualquer forma, dei upvotes nessa publica√ß√£o: https://tabnews-v319q04ww-tabnews.vercel.app/Ezequias/teste-de-comentarios

>> Coment√°rio de aprendendofelipe:
@gatodeoculos, rodei um script que transferiu todos os meus Tabcoins para voc√™ e sua publica√ß√£o.

E por ele j√° deu pra testar a parte de n√£o ficar negativo. Fiquei s√≥ com zero mesmo üòÖ

Mas o mais legal √© que o sistema ficou parcialmente indispon√≠vel enquanto o script era executado üòÆ

Ent√£o por enquanto n√£o precisa rodar o seu script. Aviso aqui quando precisar.

Fechado?! üëç

>> Coment√°rio de silvaezequias:
> @gatodeoculos voc√™ pode criar qualquer publica√ß√£o no ambiente para gerar tabcoins üëç de qualquer forma, dei upvotes nessa publica√ß√£o: https://tabnews-v319q04ww-tabnews.vercel.app/Ezequias/teste-de-comentarios

Perfeito!! üòÅ

> Ent√£o por enquanto n√£o precisa rodar o seu script. Aviso aqui quando precisar.

Ok, Fechado!!

>> Coment√°rio de aprendendofelipe:
Resolvido no #685
</issue_670_[Bug] Redu√ß√£o excessiva de TabCoins>

<issue_671_Conseguir identificar o conte√∫do `root` a partir de um conte√∫do `child`>
## Contexto

Hoje √© poss√≠vel a partir do `id` de um conte√∫do identificar todos os seus conte√∫dos `children`, por√©m n√£o √© poss√≠vel a partir do `id` de um conte√∫do `child` identificar o conte√∫do `root`. Sem isto, n√£o √© poss√≠vel contextualizar os emails de notifica√ß√£o sobre qual a "thread principal" caso seja a notifica√ß√£o sobre uma resposta que esteja a partir do n√≠vel 2 de profundidade na √°rvore de respostas. Tamb√©m n√£o √© poss√≠vel mostrar essas informa√ß√µes nas p√°ginas exclusivas de uma resposta.

## Execu√ß√£o

- #667

>> Coment√°rio de filipedeschamps:
Fechado por #667
</issue_671_Conseguir identificar o conte√∫do `root` a partir de um conte√∫do `child`>

<issue_673_Remover m√∫ltiplas idas ao banco na consulta de `contents`>
## Contexto

A cada consulta de um Conte√∫do, o Backend faz uma ida adicional ao Banco de Dados para calcular o n√∫mero de filhos deste conte√∫do e isto √© feito nesta parte do c√≥digo:

https://github.com/filipedeschamps/tabnews.com.br/blob/de65be914f0fd7b5eed8905718e4ab286b10557e/models/content.js#L51-L64

Ou seja, se voc√™ pedir uma lista `30` conte√∫dos (que √© o padr√£o da Home), √© realizada mais `30` idas ao Banco de Dados para buscar a quantidade de respostas e injetar isso na propriedade `children_deep_count`.


## Execu√ß√£o

Buscar todos esses valores em uma s√≥ ida ao Banco:

- #672

>> Coment√°rio de filipedeschamps:
Em Homologa√ß√£o o ganho foi muito maior (como esperado) e em Produ√ß√£o deu para notar um leve ganho de performance. Segue abaixo o comparativo para `30` itens:

| Homologa√ß√£o (Antes) | Homologa√ß√£o (Depois) | Produ√ß√£o (Antes) | Produ√ß√£o (Depois)
|:-:|:-:|:-:|:-:|
|<img width="79" alt="image" src="https://user-images.githubusercontent.com/4248081/186031920-c812e96c-b12f-4da1-81fc-bcb666ebb885.png">|<img width="78" alt="image" src="https://user-images.githubusercontent.com/4248081/186031981-dcfd8a6d-7fbb-41ed-99cb-d8c07778b8cc.png">|<img width="78" alt="image" src="https://user-images.githubusercontent.com/4248081/186032033-955df799-c3c5-4402-9790-e102e55c3d98.png">|<img width="77" alt="image" src="https://user-images.githubusercontent.com/4248081/186037567-110db845-c4ec-4cd1-aba0-f01390d3b71e.png">

E o comparativo para `100` itens (este eu esperava uma diferen√ßa maior):

| Produ√ß√£o (antes) | Produ√ß√£o (depois) |
|:-:|:-:|
| <img width="78" alt="image" src="https://user-images.githubusercontent.com/4248081/186033210-afa3778d-3c35-4580-ab82-b82490ad796c.png"> | <img width="77" alt="image" src="https://user-images.githubusercontent.com/4248081/186038012-1d22ce47-dc12-4814-ad6d-16599477e710.png">

Fechado por #672
</issue_673_Remover m√∫ltiplas idas ao banco na consulta de `contents`>

<issue_674_Breaking Change na API: remo√ß√£o da estrat√©gia `best` e informa√ß√µes adicionais de `parent` no objeto `content`>
Centralizando as informa√ß√µes de forma p√∫blica em: https://www.tabnews.com.br/filipedeschamps/breaking-change-na-api-remocao-da-estrategia-best-e-informacoes-adicionais-de-parent-no-objeto-content

Estou criando essa issue para tentar notificar quem est√° dando `watch` no projeto üëç
</issue_674_Breaking Change na API: remo√ß√£o da estrat√©gia `best` e informa√ß√µes adicionais de `parent` no objeto `content`>

<issue_679_Destacar Item Ativo no Menu>
## Contexto

- #675

## Execu√ß√£o

- #678

>> Coment√°rio de filipedeschamps:
Fechado por #678

>> Coment√°rio de filipedeschamps:
## Antes

<img width="1008" alt="image" src="https://user-images.githubusercontent.com/4248081/186699435-04102d23-e7d8-4a79-a6f0-7694c0bececb.png">

## Depois

<img width="1008" alt="image" src="https://user-images.githubusercontent.com/4248081/186699725-046fa34d-435e-4939-bf14-96a1727c3666.png">
</issue_679_Destacar Item Ativo no Menu>

<issue_680_Breaking Change: expor endpoint `/parent` e remover propriedades de `parent` do `content`>
## Contexto

O objeto `content` possui informa√ß√µes do seu conte√∫do parent, que muitas vezes pode ter sido deletado. O objeto possui a refer√™ncia `parent_id` e essa deve permanecer, mas `parent_title`, `parent_slug` e `parent_username` hoje revelam informa√ß√µes de um conte√∫do que j√° foi deletado. Isto foi reportado inclusive nessa issue recente #654 de @CarlosZiegler .

Ent√£o devemos remover do `content` as propriedades `parent_title`, `parent_slug` e `parent_username` e expor em um novo endpoint `/parent` todo o objeto do conte√∫do pai, onde se deletado, deve continuar enviando o objeto, mas com informa√ß√µes sens√≠veis mascaradas, como:

* `title`
* `body`
* `slug`
* `source_url`

O mesmo comportamento deve acontecer para o novo endpoint `/root`.

---

An√∫ncio da Breaking Change: https://www.tabnews.com.br/filipedeschamps/breaking-change-na-api-remocao-da-estrategia-best-e-informacoes-adicionais-de-parent-no-objeto-content

## Execu√ß√£o

- #676
- #677

>> Coment√°rio de filipedeschamps:
Fechado por #676 e #677

>> Coment√°rio de filipedeschamps:
Resultado no `P50` da lat√™ncia do `/api/v1/contents?strategy=best|relevant` ap√≥s os dois merges relacionados nessa issue:

<img width="1721" alt="image" src="https://user-images.githubusercontent.com/4248081/187002188-009fd55f-26ff-4d53-be0a-dd846ca5271a.png">
</issue_680_Breaking Change: expor endpoint `/parent` e remover propriedades de `parent` do `content`>

<issue_684_Compactar espa√ßamentos em Mobile>
## Contexto e Execu√ß√£o

- #683

>> Coment√°rio de filipedeschamps:
Fechado por #683
</issue_684_Compactar espa√ßamentos em Mobile>

<issue_686_[Bug] Conte√∫do Invis√≠vel - Markdown que desaparece>
## Contexto

Testando alguns tipos de markdown, descobri um que d√° problema na visualiza√ß√£o, veja [nessa publica√ß√£o](https://tabnews-m7os7e0qs-tabnews.vercel.app/Ezequias/teste-de-markdown). Simplesmente fica invis√≠vel.

O markdown que d√° problema √© esse: 

```
```mermaid
graph TD;
  A-->B;
  A-->C;
  A-->D;
  A-->E;
```

A visualiza√ß√£o desse markdown √© essa: 

```mermaid
graph TD;
  A-->B;
  A-->C;
  A-->D;
  A-->E;
```

E aqui t√° a forma que eu coloquei no TabNews

![Script](https://user-images.githubusercontent.com/63757378/186723439-5f94b9cd-df3b-4eeb-ba5b-03bf0f330142.png)

E assim √© como ficou o resultado: 

![Empty](https://user-images.githubusercontent.com/63757378/186723541-8e392f7a-14fa-4414-aae5-b2214755a689.png)

N√£o sei se isso √© um problema do pacote de Markdown que √© usado ou √© especificamente nesse tipo `code block` que eu usei no markdown.

#### Observa√ß√£o
Eu tentei selecionar tudo usando o CTRL+A e o resultado foi esse: 
![CTRL+A](https://user-images.githubusercontent.com/63757378/186724084-79a307a0-dd65-4c18-8df2-dd7aed92c614.png)

Fui olhar no source-code da p√°gina pra ver se existia algum elemento ali e sim, existe mas n√£o est√° vis√≠vel

![devtools](https://user-images.githubusercontent.com/63757378/186724280-7eec5adb-7711-4409-ad03-094ee3a32c12.png)

>> Coment√°rio de filipedeschamps:
Total, √© uma pena que isso esteja acontecendo e √© por conta de um bug no ByteMD mesmo.

Quem reportou isso no passado foi o @ewertonls por essa issue l√° no reposit√≥rio deles: https://github.com/bytedance/bytemd/issues/205

√â bem poss√≠vel que em breve vamos fazer a migra√ß√£o para os componentes de Markdown do pr√≥prio Primer:

https://primer.style/react/drafts/MarkdownEditor
https://primer.style/react/drafts/MarkdownViewer

>> Coment√°rio de aprendendofelipe:
Solu√ß√£o chegando üéâ

https://github.com/bytedance/bytemd/pull/256

**[Edit]** Novo endere√ßo do reposit√≥rio: https://github.com/pd4d10/hashmd/pull/256

>> Coment√°rio de aprendendofelipe:
@silvaezequias isso j√° deveria ter sido corrigido, ent√£o fui conferir sua publica√ß√£o e tinha dois erros de sintaxe. Provavelmente a sintaxe acabou ficando errada ap√≥s alguma edi√ß√£o para teste, pois na imagem que voc√™ postou est√° correta.

Veja que est√° funcionando no link abaixo:

https://tabnews-ek480p79a-tabnews.vercel.app/Ezequias/teste-de-markdown

Ent√£o estou fechando como conclu√≠do üí™
</issue_686_[Bug] Conte√∫do Invis√≠vel - Markdown que desaparece>

<issue_689_Fixar dados no `/status` para os √∫ltimos 2 meses>
## Contexto e Execu√ß√£o

- #688
</issue_689_Fixar dados no `/status` para os √∫ltimos 2 meses>

<issue_691_Utiliza `Link` no `Header` para navega√ß√£o instant√¢nea>
## Contexto

Ap√≥s o sucesso de usar o componente `next/link` no componente `ContentList`, o @luantoningalvan abriu um PR para trazer o mesmo recurso para o `Header` do TabNews. Ficou sensacional, por√©m tecnicamente o @aprendendofelipe sugeriu uma outra abordagem. As duas abordagens est√£o listadas no item Execu√ß√£o.

## Execu√ß√£o

- #682
- #690
- #692

>> Coment√°rio de filipedeschamps:
Fechado por #690
</issue_691_Utiliza `Link` no `Header` para navega√ß√£o instant√¢nea>

<issue_695_Mobile React Native>
Boa tarde amigos, tudo bem? chegaram a pensar em criar uma vers√£o em mobile com react native, o que acham?

>> Coment√°rio de coffeeispower:
pra ser sincero eu n√£o curto react native, flutter pra mim √© mais produtivo e tem um ecossistema e uma experiencia de desenvolvimento muito melhor

>> Coment√°rio de aprendendofelipe:
@andersonFaro9, sei que existem diversas vers√µes de aplicativos do TabNews, mas n√£o me lembro se alguma √© em React Native.

De qualquer maneira, como os Apps apenas utilizam a API do TabNews, s√£o projetos independentes. Provavelmente nem valeria a pena fazer um fork, pois nada (ou quase nada) seria aproveitado. Por isso vou fechar a issue. ü§ù
</issue_695_Mobile React Native>

<issue_696_Componente Footer>
## Contexto e Execu√ß√£o

- #694

>> Coment√°rio de filipedeschamps:
Fechado por #694
</issue_696_Componente Footer>

<issue_701_Cadastro: Remover o campo "Repita a Senha">
## Contexto

Antigamente n√£o existia o fluxo de Recupera√ß√£o de Senha, ent√£o se a pessoa digitasse uma senha errada na hora de fazer o cadastro, n√£o tinha mais como recuperar a conta. Para ajudar nisso, adicionamos no cadastro um campo "Repita a Senha".

Agora que temos implementado o fluxo de Recupera√ß√£o de Senha, o atrito causado pelo campo adicional de repetir a senha se torna desnecess√°rio e deve ser removido para ficar como antes.

## Execu√ß√£o

- #698
- #700

>> Coment√°rio de filipedeschamps:
Fechado por #700
</issue_701_Cadastro: Remover o campo "Repita a Senha">

<issue_705_RSS: remo√ß√£o de um `await` duplicado>
## Contexto e Execu√ß√£o

- #704
</issue_705_RSS: remo√ß√£o de um `await` duplicado>

<issue_706_Lidar de forma mais consistente com m√∫ltiplas transa√ß√µes de TabCoins simult√¢neas>
## Contexto e Execu√ß√£o

- #685

>> Coment√°rio de filipedeschamps:
Fechado por #685
</issue_706_Lidar de forma mais consistente com m√∫ltiplas transa√ß√µes de TabCoins simult√¢neas>

<issue_709_Feature `ban:user` para conseguir fazer um `nuke` em um usu√°rio>
## Contexto e Execu√ß√£o

- #699

>> Coment√°rio de filipedeschamps:
Fechado por #709
</issue_709_Feature `ban:user` para conseguir fazer um `nuke` em um usu√°rio>

<issue_713_Cadastro: confer√™ncia de typo no campo `email`>
## Contexto e Execu√ß√£o

- #712

>> Coment√°rio de filipedeschamps:
Fechado por #712
</issue_713_Cadastro: confer√™ncia de typo no campo `email`>

<issue_714_[Sugest√£o] Feature de sugerir edi√ß√£o em conte√∫do>
## Sugest√£o

Adicionar uma feature em que o Leitor percebendo um erro na publica√ß√£o (digita√ß√£o, informa√ß√£o equivocada, etc...) possa sugerir uma edi√ß√£o nesse conte√∫do consertando os erros observados. 

* Cada sugest√£o feita por um leitor √© levada ao dono da publica√ß√£o para que ele possa conferir e aceitar ou negar aquela sugest√£o.
* Se o dono da publica√ß√£o aceitar aquela sugest√£o, automaticamente o conte√∫do inicial da publica√ß√£o √© alterado pela nova edi√ß√£o sugerida pelo Leitor.
* Como forma de recompensa por contribui√ß√£o, eu pensei em dar ao Leitor que fez a sugest√£o, metade dos TabCoins que ele ganharia se fizesse uma publica√ß√£o normal, para incentivar a contribui√ß√£o.
* O dono da publica√ß√£o ganharia 1 TabCash por ter feito esse Merge...

Isso evitaria aqueles coment√°rios sem valor concreto dos usu√°rios apenas dizendo que tem algo de errado na publica√ß√£o e os incentivariam a contribuir com a publica√ß√£o.

>> Coment√°rio de Rafatcb:
Isso me lembra o esquema de edi√ß√µes no Stack Overflow. Duas coisas que vieram √† minha mente:

1. Acredito que poderia ter uma restri√ß√£o para a pessoa sugerir uma edi√ß√£o. Pode ser uma _feature_ a ser liberada com o uso de TabCashs.
2. N√£o acho legal o dono da publica√ß√£o ganhar TabCoins porque isso pode ser um incentivo negativo, onde a pessoa deixa um erro ou outro para algu√©m corrigir, ou at√© mesmo um incentivo para aceitarem qualquer edi√ß√£o ao inv√©s de rejeitar.
3. Talvez nem toda edi√ß√£o mere√ßa uma recompensa, para n√£o ter um _spam_ de pequenas edi√ß√µes. Esse ponto precisa ser melhor pensado.

E essa funcionalidade √© bastante √∫til, eu mesmo j√° reparei erros que eu poderia ter corrigido, seja de formata√ß√£o, seja de digita√ß√£o.
</issue_714_[Sugest√£o] Feature de sugerir edi√ß√£o em conte√∫do>

<issue_717_[sugest√£o] m√©tricas das publica√ß√µes>
Um ponto que, para mim, seria interessante √© implementar um sistema de m√©tricas das publica√ß√µes que fazemos. Sinto falta em ver quantas pessoas foram impactas pelo que publiquei ao longo do tempo.

Um exemplo s√£o as m√©tricas que o dev.to apresenta em cada post:
Quantidade de acessos ao longo da semana, m√™s e desde a publica√ß√£o
![image](https://user-images.githubusercontent.com/40877357/188898619-920531f8-aded-4a89-8cef-aca58ac037c3.png)

De onde elas vieram:
![image](https://user-images.githubusercontent.com/40877357/188898841-f725058d-8998-484c-a29f-b589cc798f5c.png)

>> Coment√°rio de Rafatcb:
Isso √© muito legal! Com certeza √© algo para um est√°gio mais avan√ßado do projeto, mas que traria um grande valor para o TabNews.

>> Coment√°rio de aprendendofelipe:
@jackson541, obrigado pela sugest√£o! üí™

Vou fechar essa issue para concentrarmos o debate na #1115, pois l√° teve mais intera√ß√µes. ü§ù
</issue_717_[sugest√£o] m√©tricas das publica√ß√µes>

<issue_719_Nova p√°gina: `/perfil`>
## Contexto

Precisamos de uma p√°gina simples onde seja poss√≠vel por enquanto:

1. Alterar `username`
2. Alterar `email` (passando por um fluxo de confirma√ß√£o de email)
3. Desabilitar notifica√ß√µes de respostas por email.

## Execu√ß√£o

- #718
- #720
</issue_719_Nova p√°gina: `/perfil`>

<issue_722_Bug de layout: `hover` na data de publica√ß√£o n√£o mostra mais o `tooltip` por completo>
Provavelmente atrav√©s desse PR #683 eu inclu√≠ um bug que ao passar o mouse por cima da data de publica√ß√£o, n√£o mostra mais o `tooltip` com a data completa.

√â bem prov√°vel que o `overflow` que eu adicionei est√° causando esse problema, e ele foi adicionado para que a linha com o `username` e `PublishedSince` n√£o quebre e, se n√£o houver espa√ßo, mostre o `...`

https://github.com/filipedeschamps/tabnews.com.br/blob/3ddb499a2f5f7fd5b5b2f7f9d056188a4ecba4d9/pages/interface/components/Content/index.js#L197

V√≠deo mostrando o bug (nota que aparece a pontinha do `tooltip`):

https://user-images.githubusercontent.com/4248081/189385651-5c9b27e8-d2c2-4764-9be6-3e9dd2bcbd3e.mov

>> Coment√°rio de filipedeschamps:
Fechado por #726
</issue_722_Bug de layout: `hover` na data de publica√ß√£o n√£o mostra mais o `tooltip` por completo>

<issue_723_Obter conte√∫do pela API usando o ID do usu√°rio e da publica√ß√£o ao inv√©s do username e slug>
Atualmente, o √∫nico jeito de acessar uma publica√ß√£o pela api pelo que eu percebi, √© assim:
**`https://www.tabnews.com.br/api/v1/contents/{username do dono}/{slug}`**

O que eu queria saber √© se tem algum jeito de acessar uma publica√ß√£o assim:
**`https://www.tabnews.com.br/api/v1/contents/{id do dono}/{slug}`**
ou at√© mesmo:
**`https://www.tabnews.com.br/api/v1/contents/{id do dono}/{id da publica√ß√£o}`**

>> Coment√°rio de filipedeschamps:
Gustavo, √≥tima pergunta! Hoje pela API a √∫nica forma √© pelo `/contents/[username]/[slug]`

Qual seu caso de uso? Talvez eu consiga encontrar uma solu√ß√£o ü§ù

>> Coment√°rio de 33gustavo33:
Ent√£o Filipe, eu queria poder acessar por id as publica√ß√µes por um simples motivo:

Quando algu√©m muda o username, as urls j√° existentes para aquela publica√ß√£o quebram.
por√©m se fosse poss√≠vel acessar com o id, as urls continuariam funcionando.

>> Coment√°rio de filipedeschamps:
Perfeito! Este acaba sendo o mesmo problema do GitHub, onde segundo a [documenta√ß√£o](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-personal-account-settings/changing-your-github-username) deles para esse caso, algumas coisas conseguem ser atualizadas automaticamente, mas algumas n√£o. Refer√™ncias absolutas s√£o um desses casos.

Em paralelo, daria para a API conseguir lidar com `username` e `user_id` na mesma rota, mas usar isso para as p√°ginas de forma p√∫blica ficaria estranho. Uma p√°gina com `username` poderia ter como sua URL can√¥nica a p√°gina com `user_id`, mas acredito que isso traria uma complexidade ruim para o projeto e para as URLs p√∫blicas.

>> Coment√°rio de 33gustavo33:
√â, acho melhor deixar s√≥ pra API lidar com user_id.

>> Coment√°rio de coffeeispower:
ou talvez redirecionar o usuario para a url nova, o github faz isso tambem. isso envolveria colocar um historico de nomes, pra isso tambem √© preciso priorizar posts reais com o nome antigo de outro post pra n√£o ter problemas.
```
Usuario cria post
Usuario muda o nome
A URL antiga redireciona para a nova
Um novo usuario pega o nome antigo do outro usuario
Cria um post com o mesmo slug
Agora a URL antiga aponta para o post desse usuario
```
</issue_723_Obter conte√∫do pela API usando o ID do usu√°rio e da publica√ß√£o ao inv√©s do username e slug>

<issue_727_Consertar `tooltip` que mostra a data completa da publica√ß√£o>
## Contexto

- #722

## Execu√ß√£o

- #726
</issue_727_Consertar `tooltip` que mostra a data completa da publica√ß√£o>

<issue_728_Termos de Uso>
## Contexto

- https://www.tabnews.com.br/filipedeschamps/rfc-termos-de-uso-do-tabnews-preciso-de-ajuda-da-comunidade

## Execu√ß√£o

- #734

>> Coment√°rio de filipedeschamps:
Fechado por #734
</issue_728_Termos de Uso>

<issue_730_Adiciona lista de contribuidores no `README` e p√°gina `/status`>
## Contexto e execu√ß√£o

- #729
</issue_730_Adiciona lista de contribuidores no `README` e p√°gina `/status`>

<issue_731_Erro `503` ao enviar `\u0000` como `body`>
@33gustavo33 voc√™ conseguiu causar um erro `503` interessante no ambiente de homologa√ß√£o.

A request enviada foi o seguinte:

```
PATCH /api/v1/contents/Gustavo33/teste1
```

Com o seguinte body:

```json
{"body":"\u0000","status":"published"}
```

O que causou o seguinte erro interno:

```json
{
   "level":50,
   "time":1662855718038,
   "environment":"preview",
   "payload":{
      "name":"ServiceError",
      "message":"invalid byte sequence for encoding \"UTF8\": 0x00",
      "action":"Verifique se o servi√ßo est√° dispon√≠vel.",
      "status_code":503,
      "error_id":"9dfeb486-5b1a-458c-9b08-da27fe56fdff",
      "context":{
         "query":"\n      WITH\n        updated_content as (\n          UPDATE contents SET\n            parent_id = $2,\n            slug = $3,\n            title = $4,\n            body = $5,\n            status = $6,\n            source_url = $7,\n            published_at = $8,\n            updated_at = (now() at time zone 'utc'),\n            deleted_at = $9\n          WHERE\n            id = $1\n          RETURNING *\n        )\n      SELECT\n        updated_content.id,\n        updated_content.owner_id,\n        updated_content.parent_id,\n        updated_content.slug,\n        updated_content.title,\n        updated_content.body,\n        updated_content.status,\n        updated_content.source_url,\n        updated_content.created_at,\n        updated_content.updated_at,\n        updated_content.published_at,\n        updated_content.deleted_at,\n        users.username as owner_username\n      FROM\n        updated_content\n      INNER JOIN\n        users ON updated_content.owner_id = users.id\n      ;"
      },
      "error_location_code":"INFRA:DATABASE:QUERY",
      "database_error_code":"22021"
   }
}
```

**A parte mais importante est√° aqui:**

```
"message":"invalid byte sequence for encoding \"UTF8\": 0x00",
```

Issues relacionadas ao caractere `\u0000` no reposit√≥rio do `pg`:

* https://github.com/brianc/node-postgres/issues/2080
* https://github.com/brianc/node-postgres/issues/1121
* https://github.com/brianc/node-postgres/issues/1115

## Conclus√£o

N√£o sei o que fazer exatamente. De qualquer forma, coisas desse tipo n√£o deveriam gerar um erro interno.

>> Coment√°rio de 33gustavo33:
tamb√©m achei estranho enquanto estava testando a api.

Alias, uma pergunta.
Quando voc√™ edita um `content` , e voc√™ coloca `slug: "outro-slug"` no body da requisi√ß√£o, era pro novo slug ser aceitado e ele mudar?

>> Coment√°rio de filipedeschamps:
@33gustavo33 correto! Veja esse comportamento coberto por testes:

https://github.com/filipedeschamps/tabnews.com.br/blob/9b9dcc2948e4feb63f3c7893ed9d7f6418ce7983/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/patch.test.js#L629-L680

Est√° acontecendo isso ou outra coisa?

>> Coment√°rio de 33gustavo33:
@filipedeschamps est√° acontecendo isso mesmo, ent√£o tudo ok

>> Coment√°rio de filipedeschamps:
Fechado por #759
</issue_731_Erro `503` ao enviar `\u0000` como `body`>

<issue_732_Publicar v√≠deo de lan√ßamento do TabNews>
## Contexto e Execu√ß√£o

N√£o tenho muito o que desenvolver dentro dessa issue, mas o ponto principal √© criar um v√≠deo sobre o lan√ßamento do TabNews, onde esse v√≠deo vai tamb√©m inaugurar a volta do canal no YouTube üòç

>> Coment√°rio de rodrigoKulb:
Conte√∫do n√£o vai faltar para esse v√≠deo!

>> Coment√°rio de filipedeschamps:
V√≠deo publicado: https://youtu.be/bYBVCxVwrdY üéâ üéâ üéâ
</issue_732_Publicar v√≠deo de lan√ßamento do TabNews>

<issue_733_Transformar o reposit√≥rio para `publico` e reorganizar acessos>
## Contexto

Hoje o reposit√≥rio est√° no modo **privado** e isto implica em precisar convidar os contribuidores e dar acesso de **escrita** ao projeto. Isto naturalmente n√£o ir√° escalar e se torna um problema de seguran√ßa grave para contas que acabarem ficando abandonadas no meio do caminho.

## Execu√ß√£o

Reorganizar o acesso de todos os usu√°rios, removendo o acesso de escrita, tornando o reposit√≥rio **p√∫blico** e trabalhando no modelo tradicional de `fork`. Esta movimenta√ß√£o n√£o ir√° remover o hist√≥rico de contribui√ß√µes, mas ir√° remover todas as `stars` e `watch` do projeto, ficando a crit√©rio da pessoa adicionar novamente.

Isto dever√° ser feito logo antes do v√≠deo de lan√ßamento ser publicado
- #732

>> Coment√°rio de filipedeschamps:
Turma, dando continuidade nesta tarefa, em algumas horas irei fazer a manuten√ß√£o no reposit√≥rio e vou repetir aqui o que estava escrito na issue principal caso o seu acesso j√° tenha sido removido e voc√™ n√£o consiga mais ver do que se trata (e n√£o se preocupe, pois essa opera√ß√£o ir√° durar 1 dia apenas):

---

## Contexto

Hoje o reposit√≥rio est√° no modo **privado** e isto implica em precisar convidar os contribuidores e dar acesso de **escrita** ao projeto. Isto naturalmente n√£o ir√° escalar e se torna um problema de seguran√ßa grave para contas que acabarem ficando abandonadas no meio do caminho.

## Execu√ß√£o

Reorganizar o acesso de todos os usu√°rios, removendo o acesso de escrita, tornando o reposit√≥rio **p√∫blico** e trabalhando no modelo tradicional de `fork`. Esta movimenta√ß√£o n√£o ir√° remover o hist√≥rico de contribui√ß√µes, mas ir√° remover todas as `stars` e `watch` do projeto, ficando a crit√©rio da pessoa adicionar novamente.

Isto dever√° ser feito logo antes do v√≠deo de lan√ßamento ser publicado
- #732

>> Coment√°rio de filipedeschamps:
Print da tela com a turma que acompanhou at√© agora ü§ù **947** pessoas aceitaram o convite üëç 

<img width="1904" alt="repo-tabnews-pre-public-02" src="https://user-images.githubusercontent.com/4248081/202945745-e79c5368-9910-4df3-9a07-d06e038f8bc2.png">

Come√ßando a remover os acessos de **escrita** ü§ù

>> Coment√°rio de filipedeschamps:
Opera√ß√£o feita e, como efeito colateral, os PRs que s√£o de `fork` automaticamente foram fechados, vamos reabrir eles ü§ù

>> Coment√°rio de aprendendofelipe:
> Opera√ß√£o feita e, como efeito colateral, os PRs que s√£o de `fork` automaticamente foram fechados, vamos reabrir eles ü§ù

Reabertos ü§ù
</issue_733_Transformar o reposit√≥rio para `publico` e reorganizar acessos>

<issue_735_Novo erro `503` sobre o `database.js`>
@aprendendofelipe olha que interessante, depois do deploy de hoje (que n√£o tem nada a ver com o erro), a reconstru√ß√£o do cache dos est√°ticos estourou o limite de conex√µes. Imagino que foi por conta da altera√ß√£o da toler√¢ncia:

https://github.com/filipedeschamps/tabnews.com.br/blob/2140677b91ce45280355fef2d25f2ad4c0411815/infra/database.js#L81

Exemplo de request:

```
/_next/data/qB4Sh0A7dKVrKyO0cHOAP/pt-br/Ezequias/tabnews-discord-bot-teste-13-testando-markdown.json?username=Ezequias&slug=tabnews-discord-bot-teste-13-testando-markdown
```

```json
{
   "level":50,
   "time":1662918874297,
   "environment":"preview",
   "payload":{
      "name":"ServiceError",
      "message":"remaining connection slots are reserved for non-replication superuser connections",
      "action":"Verifique se o servi√ßo est√° dispon√≠vel.",
      "status_code":503,
      "error_id":"e198ad5e-c870-4113-805f-f07bbb3eddc0",
      "context":{
         "query":"\n      WITH user_found AS (\n        SELECT\n          *\n        FROM\n          users\n        WHERE\n          LOWER(username) = LOWER($1)\n        LIMIT\n          1\n      )\n      SELECT\n        user_found.*,\n        get_current_balance('user:tabcoin', user_found.id) as tabcoins,\n        get_current_balance('user:tabcash', user_found.id) as tabcash\n      FROM\n        user_found\n      ;"
      },
      "error_location_code":"INFRA:DATABASE:QUERY",
      "database_error_code":"53300"
   }
}
```

---

Nesse parece que n√£o deu tempo das retentativas (dado a dist√¢ncia entre lambdas e banco)

```
/_next/data/qB4Sh0A7dKVrKyO0cHOAP/pt-br/filipedeschamps/testando-o-novo-metodo-findrootcontent-que-vai-poder-trazer-muito-mais-contexto.json?username=filipedeschamps&slug=testando-o-novo-metodo-findrootcontent-que-vai-poder-trazer-muito-mais-contexto
```

```json
{
   "level":50,
   "time":1662918873580,
   "environment":"preview",
   "payload":{
      "name":"ServiceError",
      "message":"sorry, too many clients already",
      "action":"Verifique se o servi√ßo est√° dispon√≠vel.",
      "status_code":503,
      "error_id":"01238d2f-333c-4d63-9ff6-807172519f1b",
      "context":{
         "query":"\n      WITH user_found AS (\n        SELECT\n          *\n        FROM\n          users\n        WHERE\n          LOWER(username) = LOWER($1)\n        LIMIT\n          1\n      )\n      SELECT\n        user_found.*,\n        get_current_balance('user:tabcoin', user_found.id) as tabcoins,\n        get_current_balance('user:tabcash', user_found.id) as tabcash\n      FROM\n        user_found\n      ;"
      },
      "error_location_code":"INFRA:DATABASE:QUERY",
      "database_error_code":"53300"
   }
}
```

## Conclus√£o

Talvez reduzir um pouco o `maxConnectionsTolerance` e aumentar um pouco as retentativas? Digo talvez, pois Produ√ß√£o n√£o reclamou de nada.

>> Coment√°rio de aprendendofelipe:
J√° sabemos que sempre que ocorre um deploy:
1. N√£o √© aproveitada nenhuma conex√£o j√° aberta com o banco, pois s√£o criadas novas lambdas sem descartar as que j√° existiam.
2. Dezenas de lambdas s√£o criadas simultaneamente para gerar os est√°ticos de cada conte√∫do listado em ContentList, al√©m das p√°ginas de cada diferente autor desses conte√∫dos. Isso pode passar de 60 novas conex√µes.

Ent√£o vamos especular sobre a situa√ß√£o que deve ter ocorrido para pensar em como solucionar.

### Situa√ß√£o que gerou o erro
 Imagino que foi algo assim:

1. Antes do deploy, por qualquer motivo, j√° haviam muitas conex√µes abertas, mas em n√∫mero menor do que o limiar de 90%. **90% parece mesmo ser muito, talvez os 70% de antes funcionem melhor, ou at√© menos.**
2. Ap√≥s o deploy, para gerar as p√°ginas est√°ticas, o n√∫mero de tentativas de abertura de novas conex√µes ultrapassou n√£o somente os 90%, mas chegou ao limite do banco.
4. As primeiras lambdas que conseguiram se conectar encerraram suas conex√µes logo ap√≥s suas primeiras consultas (que obt√©m o id do autor) por causa do `tooManyConnections`.
5. Ent√£o essas lambdas entraram no processo de `retry` para tentar fazer a segunda consulta (que obt√©m os dados do conte√∫do). **Esse ponto precisa de ajuste, pois seria melhor a p√°gina ser gerada com uma √∫nica consulta ao banco, ou no m√≠nimo garantir que essas duas consultas ocorram com o mesmo `client`, como j√° √© feito nas transa√ß√µes.**
6. Enquanto isso as demais lambdas ficaram tentando se conectar de acordo com a configura√ß√£o de `retry` e s√≥ conseguiram utilizar as conex√µes encerradas pelas primeiras lambdas desse novo deploy. Somente as conex√µes que j√° estavam livres antes do deploy s√£o revezadas. Dependendo de quantas conex√µes est√£o sendo revezadas, e pelo maior tempo gasto em cada gera√ß√£o por necessitar estabelecer conex√£o duas vezes, nem todas lambdas conseguir√£o se conectar dentro dos tempos configurados e por isso temos esses erros. **Aumentar o n√∫mero de tentativas pode diminuir os erros, mas desde que n√£o cause ainda mais lentid√£o no banco, que ser√° sentida provavelmente pelo erro de timeout de conex√£o.**
7. J√° as lambdas do deploy antigo nem tomaram conhecimento e continuaram monopolizando as conex√µes com o banco, pois se n√£o estavam fazendo consultas, n√£o executaram o `checkForTooManyConnections`. **Aqui talvez o `idle_session_timeout` seja √∫til.**

### D√∫vidas
As d√∫vidas que ainda tenho que sanar antes de propor solu√ß√£o melhor s√£o:

1. Em que momento o servidor PostgreSQL encerra a conex√£o iniciada por uma lambda que foi congelada antes que pudesse liberar a conex√£o que ela estava utilizando? Informa√ß√£o √∫til, entre outras coisas, para lidar com as conex√µes abertas por deploys antigos.
2. Ao utilizar `getStaticPaths` s√£o utilizadas diferentes lambdas (e diferentes conex√µes com o banco) para cada p√°gina que ser√° gerada durante o deploy ou as p√°ginas s√£o geradas por uma √∫nica inst√¢ncia?
4. Numa situa√ß√£o de alta demanda para o banco, quanto tempo dura a consulta para gerar uma p√°gina est√°tica? Informa√ß√£o √∫til para determinar o `timeout` do `retry`.
5. Como podemos identificar se estamos enfrentando uma situa√ß√£o espor√°dica de alta demanda ou se estamos sob algum ataque?
6. Enquanto n√£o estamos diferenciando as duas situa√ß√µes acima (alta demanda ou ataque), pensando na experi√™ncia do usu√°rio, qual √© o tempo ideal para retornar um erro que indique que o sistema est√° passando por alguma instabilidade? Ou seja, quanto tempo ficar reenviando tentativas de conex√µes com o banco para atender uma solicita√ß√£o antes de retornar um erro? √â boa ideia usar todo o limite de 60s das lambdas?

### Proposta provis√≥ria
Se as especula√ß√µes estiverem corretas, e nenhum outro tipo de erro foi gerado, o que deve ter causado o problema foi que o n√∫mero de conex√µes existentes antes do deploy somado aos que foram gerados pelo deploy acabaram passando do limite do banco. Sendo assim, o que podemos fazer por enquanto √© diminuir o `maxConnectionsTolerance` para limitar as conex√µes preexistentes.

E caso queira aumentar o n√∫mero de tentativas de conex√£o com o banco antes de gerar um erro, temos que trabalhar nos valores do `retry`. Sem mexer nos demais par√¢metros, d√° pra deixar o `retries` at√© `12` que ainda assim n√£o vamos extrapolar os 60s de limite da lambda, mesmo se o banco n√£o estiver respondendo. E a partir da 6¬™ tentativa os intervalos ser√£o de 5 segundos entre cada tentativa de conex√£o que o banco recusar.

### Resumindo
Totalmente de acordo com o que voc√™ sugeriu:
`maxConnectionsTolerance = 0.6` ou `0.7`.
`retries: 12` ou qualquer coisa entre 5 e 12.

>> Coment√°rio de filipedeschamps:
Recebendo novos erros e o banco est√° no talo:

<img width="315" alt="image" src="https://user-images.githubusercontent.com/4248081/192849921-6b180024-a715-4ddf-aff2-14951156121b.png">

N√£o tem **nada** nas estat√≠sticas ou logs que justifiquem esse load. Se desse para saber qual lambda est√° consumindo a conex√£o seria muito show.

>> Coment√°rio de filipedeschamps:
Incluindo alguns erros doidos:

```
MissingStaticPage [Error]: Failed to load static file for page: /pt-br/500 ENOENT: no such file or directory, open '/var/task/.next/server/pages/pt-br/500.html'
    at /var/task/node_modules/next/dist/server/require.js:55:19
    at async Promise.all (index 2)
    at async Object.loadComponents (/var/task/node_modules/next/dist/server/load-components.js:53:49)
    at async NextNodeServer.findPageComponents (/var/task/node_modules/next/dist/server/next-server.js:451:36)
    at async NextNodeServer.renderErrorToResponse (/var/task/node_modules/next/dist/server/base-server.js:1250:26)
    at async NextNodeServer.renderToResponse (/var/task/node_modules/next/dist/server/base-server.js:1188:30)
    at async NextNodeServer.pipe (/var/task/node_modules/next/dist/server/base-server.js:634:25)
    at async Object.fn (/var/task/node_modules/next/dist/server/base-server.js:501:21)
    at async Router.execute (/var/task/node_modules/next/dist/server/router.js:222:36)
    at async NextNodeServer.run (/var/task/node_modules/next/dist/server/base-server.js:612:29)
```

>> Coment√°rio de aprendendofelipe:
> Recebendo novos erros e o banco est√° no talo:

Acabamos n√£o fazendo o que comentamos acima

>> Coment√°rio de filipedeschamps:
Meu maior palpite √© que algum bot (ou pessoa) possa ter passado por v√°rias pagina√ß√µes antigas e disparado requests de todos os links, apesar de ao avaliar somente o que foi acessado de `/_next` n√£o revelar nenhum outlier. Vou continuar monitorando aqui e fazer merge do #751 ü§ù

>> Coment√°rio de aprendendofelipe:
> Meu maior palpite √© que algum bot (ou pessoa) possa ter passado por v√°rias pagina√ß√µes antigas e disparado requests de todos os links

Provavelmente foi isso, pois parece que foi algo moment√¢neo, n√©? E n√£o deve ter rela√ß√£o com o novo algoritmo de ranqueamento, pois s√≥ tem 2 ou 3 p√°ginas utilizando ele. Na gera√ß√£o das p√°ginas de recentes s√≥ mudou a quest√£o do `count`.

Essa configura√ß√£o do #751 deve diminuir a chance disso se repetir.

>> Coment√°rio de filipedeschamps:
T√° no talo de novo e analisando qual a √∫ltima query feita pelas conex√µes que est√£o `idle`, a maioria se agrupa entre estas tr√™s:

## Query 1
```sql
      WITH RECURSIVE children AS (
        SELECT
            id,
            owner_id,
            parent_id,
            slug,
            title,
            body,
            status,
            source_url,
            created_at,
            updated_at,
            published_at,
            deleted_at
        FROM
          contents
        WHERE
          contents.id = $1 AND
          contents.status = 'published'
        UNION ALL
          SELECT
            contents.id,
            contents.owner_id,
            contents.parent_id,
            contents.slug,
            contents.title,
            contents.body,
            contents.status,
            contents.source_url,
            contents.created_at,
            contents.updated_at,
            contents.published_at,
            contents.deleted_at
          FROM
            contents
          INNER JOIN
            children ON contents.parent_id = children.id
          WHERE
            contents.status = 'published'

      )
      SELECT
        children.id,
        children.owner_id,
        children.parent_id,
        children.slug,
        children.title,
        children.body,
        children.status,
        children.source_url,
        children.created_at,
        children.updated_at,
        children.published_at,
        children.deleted_at,
        users.username as owner_username,
        get_current_balance('content:tabcoin', children.id) as tabcoins
      FROM
        children
      INNER JOIN
        users ON children.owner_id = users.id
      ORDER BY
        children.published_at ASC;
      ;
```

## Query 2

```sql
      WITH user_found AS (
        SELECT
          *
        FROM
          users
        WHERE
          LOWER(username) = LOWER($1)
        LIMIT
          1
      )
      SELECT
        user_found.*,
        get_current_balance('user:tabcoin', user_found.id) as tabcoins,
        get_current_balance('user:tabcash', user_found.id) as tabcash
      FROM
        user_found
      ;
```

## Query 3

``` sql
SELECT numbackends as opened_connections FROM pg_stat_database where datname = $1
```

---


Por exemplo, agora est√° com `45` conex√µes abertas, sendo nas top 3 queries, `17` s√£o da Query 1, `11` da Query 3 e `8` da Query 2.

>> Coment√°rio de aprendendofelipe:
> Por exemplo, agora est√° com `45` conex√µes abertas, sendo nas top 3 queries, `17` s√£o da Query 1, `11` da Query 3 e `8` da Query 2.

Nenhuma dessas queries foi alterada. Na verdade voc√™ est√° vendo as queries mais utilizadas, n√£o necessariamente as que est√£o causando algum problema. Se √© que o problema √© alguma query espec√≠fica.

Est√° aparecendo alguma vez a query de ranqueamento? Ela est√° sendo chamada a todo momento por causa do `revalidateOnMount` chamando a `api/contents`, ent√£o √© para aparecer.

Ou tem algu√©m fazendo algum acesso diferente do normal, ou a nova query est√° deixando o banco mais lento, pois comparando ontem e hoje nos mesmos hor√°rios, d√° pra ver no console da Vercel que aumentou o tempo de execu√ß√£o das lambdas.

Mas n√£o deu mais erro ap√≥s o deploy do #751, n√©?

>> Coment√°rio de aprendendofelipe:
Ser√° que tem muita gente acessando pra ver o saldo dos outros? üôà

https://www.tabnews.com.br/GabrielSozinho/pitch-tabstats-um-site-para-ver-informacoes-de-usuarios-do-tabnews

>> Coment√°rio de filipedeschamps:
> est√£o causando algum problema. Se √© que o problema √© alguma query espec√≠fica.

Isso, das conex√µes que est√£o ainda abertas, essa foi a √∫ltima query rodada naquela conex√£o. √â o mais pr√≥ximo que conseguir chegar de tentar entender quem est√° com essas conex√µes abertas. Seria muito massa conseguir ver quais lambdas est√£o ativas e congeladas üòç 



> Est√° aparecendo alguma vez a query de ranqueamento? Ela est√° sendo chamada a todo momento por causa do `revalidateOnMount` chamando a `api/contents`, ent√£o √© para aparecer.

Ela aparece sim, mas n√£o ficou em nenhum momento no top das mais usadas. Tem algum acesso acontecendo por dentro das p√°ginas mesmo, eu especulo.

> Ou tem algu√©m fazendo algum acesso diferente do normal, ou a nova query est√° deixando o banco mais lento, pois comparando ontem e hoje nos mesmos hor√°rios, d√° pra ver no console da Vercel que aumentou o tempo de execu√ß√£o das lambdas.

Pelo que estou entendo dos gr√°ficos, a nova query n√£o est√° deixando o banco mais lento, olha a an√°lise do P25, P50 e P75 dos √∫ltimos 2 dias:

<img width="1726" alt="image" src="https://user-images.githubusercontent.com/4248081/192871730-f9be9742-4eb5-4f6a-97f6-771d2e54be1f.png">

E a m√©dia:

<img width="1722" alt="image" src="https://user-images.githubusercontent.com/4248081/192872005-6ab30549-b7dc-45b9-9f33-9233a41fb0be.png">

Passando um pente fino, a m√©dia saiu de `~750ms` para `~900ms` o que √© absurdamente √≥timo considerando o que a query nova faz ü§ù 


> Mas n√£o deu mais erro ap√≥s o deploy do #751, n√©?

N√£o deu, tudo 100% ü§ù

>> Coment√°rio de filipedeschamps:
> Ser√° que tem muita gente acessando pra ver o saldo dos outros? üôà
> 
> https://www.tabnews.com.br/GabrielSozinho/pitch-tabstats-um-site-para-ver-informacoes-de-usuarios-do-tabnews

üòÇ eu especulei isso! @gabrielsozinho voc√™ poderia compartilhar a quantidade de acessos ao seu site (se voc√™ tiver) para vermos se teve algum volume que case com a quantidade de conex√µes abertas aqui?

>> Coment√°rio de gabrielsozinho:
> > Ser√° que tem muita gente acessando pra ver o saldo dos outros? üôà
> > https://www.tabnews.com.br/GabrielSozinho/pitch-tabstats-um-site-para-ver-informacoes-de-usuarios-do-tabnews
> 
> üòÇ eu especulei isso! @gabrielsozinho voc√™ poderia compartilhar a quantidade de acessos ao seu site (se voc√™ tiver) para vermos se teve algum volume que case com a quantidade de conex√µes abertas aqui?

Opa, desculpa n√£o responder antes! Eu n√£o tenho acesso a esses dados, n√£o adicionei nenhum contador de acessos e s√≥ contas premium conseguem esses dados na Netlify. Se ainda for do interesse, eu posso tirar o site do ar ou adicionar um contador.

>> Coment√°rio de gabrielsozinho:
Pra deixar registrado, 5 dias depois do coment√°rio que eu fiz aqui em cima, eu implementei um contador de acessos. A p√°gina √© acessada em m√©dia de 6 √† 11 vezes por dia. Mas tamb√©m, vale ressaltar que eu n√£o divulguei o site em nenhum lugar depois disso, sendo assim, o n√∫mero na √©poca em que eu publiquei no TabNews era bem maior.

Acho que esses acessos ou vieram de pessoas que conheceram o TabStats pelo TabNews, ou vieram pelo meu portf√≥lio. (Que eu n√£o sei como, conseguiu 104 acessos desde que eu implementei o contador, sendo que eu apenas adicionei o link no meu GitHub e em um coment√°rio do TabNews).

>> Coment√°rio de aprendendofelipe:
Vou fechar essa issue j√° que aparentemente o problema n√£o se repetiu, at√© porque fizemos diversas otimiza√ß√µes ap√≥s esse per√≠odo. ü§ù
</issue_735_Novo erro `503` sobre o `database.js`>

<issue_737_P√°gina de contato>
## Contexto

Precisamos de uma p√°gina simples `/contato` explicando os canais para contato dependendo da requisi√ß√£o.

## Execu√ß√£o

- #736

>> Coment√°rio de filipedeschamps:
Fechado por #736
</issue_737_P√°gina de contato>

<issue_738_Criar o sistema de notifica√ß√£o via API e interface web (em complemento ao email)>
Hoje temos o email para notifica√ß√µes, mas n√£o seria interessante ter um endpoint na api pra isso tamb√©m? Algo como
`GET api/v1/notifications`
E isso retornaria as notifica√ß√µes que o usu√°rio tem.
# Porque?
A maior utilidade ao meu ver seria criar um menu de notifica√ß√µes no frontend, parecido com o do youtube:

https://user-images.githubusercontent.com/50342600/189706254-ff576c25-42ee-472f-995f-fa1edbcd38a0.mp4

Tamb√©m poderia ser usado pra push notifications, etc..

>> Coment√°rio de Rafatcb:
Nunca implementei um sistema de notifica√ß√µes, ent√£o dei uma pesquisada e tentei elaborar quais s√£o as nossas necessidades para conseguir progredir com o issue, principalmente porque isso √© uma depend√™ncia para outras melhorias. Eu precisaria fazer esse estudo de qualquer forma para eu mesmo, ent√£o resolvi compartilhar aqui, at√© porque algu√©m pode saber mais do assunto e contribuir.

Separei as caracter√≠sticas entre o que √© **necess√°rio** e o que √© **desej√°vel**, assim fica f√°cil decidir o que deixar de lado durante a implementa√ß√£o dependendo do custo e complexidade.

Das refer√™ncias que li sobre o assunto, vale compartilhar o artigo [Designing a notification system - Tan Nguyen](https://tannguyenit95.medium.com/designing-a-notification-system-1da83ca971bc) e tamb√©m [essa thread do Reddit](https://www.reddit.com/r/PostgreSQL/comments/8z0kat/building_a_notification_system/) que cont√©m poss√≠veis solu√ß√µes para alguns problemas que menciono no pr√≥ximo t√≥pico. Podem at√© ler antes de continuar o meu coment√°rio, se preferirem.

## Necess√°rio

- **Relacionar quem enviou, quem recebeu e o motivo:** Enxergo algumas notifica√ß√µes poss√≠veis diferentes:
  - "O usu√°rio A comentou na sua publica√ß√£o B" - Tem quem enviou e o motivo.
  - "Sua publica√ß√£o B recebeu 1 TabCoin" - Tem o motivo.
  - "Sua publica√ß√£o B foi removida pela modera√ß√£o" - Tem o motivo, que envolve um elemento "removido".
- **Enviar a mesma notifica√ß√£o para mais de um usu√°rio:** Futuramente teremos a possibilidade de seguir uma publica√ß√£o, ent√£o mais de um usu√°rio poder√° receber a mesma notifica√ß√£o. J√° devemos estruturar de forma a permitir isso.
- **Toler√¢ncia a atrasos:** Podemos notificar em tempo real, mas n√£o vejo problemas se a notifica√ß√£o atrasar alguns segundos. A princ√≠pio, me parece que at√© 1 minuto de atraso √© toler√°vel. Isso ficar√° ruim se a pessoa ver a a√ß√£o antes da notifica√ß√£o.
- **Marcar notifica√ß√£o como lida/n√£o-lida:** Comportamento similar ao de um e-mail na caixa de mensagens.
- **Armazenamento de notifica√ß√µes por pelo menos 30 dias:** O ideal seria n√£o ter restri√ß√£o de tempo, mas n√£o sei da complexidade em manter um bom desempenho assim. A rede Stack Exchange, por exemplo, armazena todas as notifica√ß√µes que v√£o para o Inbox, e a rede tem v√°rios sites, usu√°rios e tipos de notifica√ß√£o.
- **Quando ocorreu:** Como armazenaremos um hist√≥rico, √© importante saber quando foi que o evento gerador da notifica√ß√£o ocorreu.
- **N√£o duplicar:** A mesma notifica√ß√£o deve ser enviada uma √∫nica vez, podendo ser consumida novamente pelo hist√≥rico.

## Desej√°vel

J√° falei sobre alguns desses pontos no t√≥pico anterior, mas vou listar novamente para ficar f√°cil de encontrar.

- Notifica√ß√£o em tempo real.
- Armazenamento de todas notifica√ß√µes "para sempre".
- Poder desfazer a notifica√ß√£o, caso a a√ß√£o seja desfeita.
- Agrupamento de notifica√ß√µes quando poss√≠vel. Ao inv√©s do usu√°rio receber v√°rias notifica√ß√µes iguais, pode receber uma √∫nica notifica√ß√£o como "A, B e C comentaram na sua publica√ß√£o X".

## Solu√ß√£o pr√≥pria ou de terceiros?

### Custos

Temos uma ideia dos [custos na √©poca do lan√ßamento do TabNews](https://www.tabnews.com.br/filipedeschamps/tabnews-atinge-1-5-milhoes-de-views-e-futuro-do-projeto-alerta-de-textao), mas sem nada espec√≠fico para estimarmos com base em armazenamento ou demora das consultas:

> | Servi√ßo |  Valor |
> | :--------- | -------: |
> | Vercel | ~$ 80,00 / m√™s~ |
> | Cloudflare | $ 20,00  / m√™s |
> | PostgreSQL (homologa√ß√£o)  |  $ 15,00  / m√™s |
> | PostgreSQL (produ√ß√£o)  |  $150,00  / m√™s |
> | Mailgun | $35,00  / m√™s |
> | Upstash | $48,00 / m√™s |
> | Gmail| $6,00 / m√™s |
> | **Total** |  **$ 274,00  / m√™s** |

Nas minhas pesquisas, encontrei v√°rias solu√ß√µes de terceiros sugeridas para esse tipo de problema, ent√£o precisei ler como elas resolvem isso e qual o custo envolvido.

1. [AWS SNS](https://aws.amazon.com/sns/). Pelo o que li, n√£o parece que atende nosso cen√°rio, mas posso estar enganado.
2. [Ably](https://ably.com/).
3. [Novu](https://novu.co/).
4. [Knock](https://knock.app/).
5. [MagicBell](https://www.magicbell.com/).

|     | [Ably](https://ably.com/solutions/channels) | [Novu](https://novu.co/) | [Knock](https://knock.app/) | [MagicBell](https://www.magicbell.com/) |
| --- | --- | --- | --- | --- |
| **Custo/m√™s** | Gr√°tis | Gr√°tis | Gr√°tis | Gr√°tis |
| **Limite/m√™s** | 6 milh√µes de mensagens | 10 mil eventos | 10 mil notifica√ß√µes | 100 usu√°rios ativos/m√™s |
| **Pr√≥ximo custo/m√™s** | US$ 2,50/milh√£o | US$ 25 | US$ 250 | US$ 99 |
| **Pr√≥ximo limite/m√™s** | - | 20 mil eventos | 50 mil notifica√ß√µes | 2.000 usu√°rios ativos |
| **Persist√™ncia** | [at√© 72 horas](https://ably.com/docs/storage-history/storage) |  30 dias / 90 dias | Ilimitado | ? |

- ?: N√£o encontrei informa√ß√µes sobre.

Dos quatro servi√ßos mencionados acima, tr√™s (Novu, Knock e MagicBell) fornecem solu√ß√µes de UI e se vendem como otimizadores de tempo para implantar o sistema de notifica√ß√£o. O esquema de precifica√ß√£o do MagicBell me faria exclu√≠-lo da lista (por usu√°rio ativo/m√™s), e o pre√ßo do "pr√≥ximo custo" do Knock √© muito alto. Sobra o Novu, mas vou mencionar novamente o Ably mais para frente.

### Implementa√ß√£o pr√≥pria

Al√©m da estrutura do banco de dados, similar ao que foi mencionado nos links de refer√™ncia ([Medium](https://tannguyenit95.medium.com/designing-a-notification-system-1da83ca971bc) e [Reddit](https://www.reddit.com/r/PostgreSQL/comments/8z0kat/building_a_notification_system/)), no backend ter√≠amos a responsabilidade de:

1. Salvar a notifica√ß√£o.
2. Enviar a notifica√ß√£o para o cliente, assim que criada.
3. Endpoint para obter as notifica√ß√µes.

No frontend, precisar√≠amos implementar a interface. O GitHub possui uma [p√°gina de notifica√ß√µes](https://github.com/notifications?query=is%3Aunread), mas n√£o uma "caixa simples" de notifica√ß√µes (como o Stack Overflow, Reddit e Facebook). Para fazermos isso, provavelmente precisar√≠amos usar o [`Popover`](https://primer.style/components/popover/react), que est√° em _draft_. Na documenta√ß√£o n√£o fica claro se ele √© o melhor componente para esse cen√°rio.

Fiquei em d√∫vida se poder√≠amos usar [server-sent events](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events) para notificar o cliente em tempo real. Nunca usei SSE e os exemplos que vi n√£o me deram a certeza, principalmente considerando o ambiente serverless. [Aqui](https://vercel.com/guides/do-vercel-serverless-functions-support-websocket-connections) a Vercel n√£o menciona o SSE como alternativa ao WebSocket, mas indica o **Ably**.

### Viabilidade

Criar algumas tabelas no banco de dados e ter o controle pr√≥prio me parece muito bom: n√£o teremos uma depend√™ncia extra e nem um custo financeiro por essa nova depend√™ncia.

Para saber se conseguir√≠amos lidar com isso criando as tabelas (como mencionado nos links de refer√™ncia e adaptando para nossas necessidades) com bom desempenho, podemos fazer alguns testes na casa de milh√µes de notifica√ß√µes localmente. Seria interessante fazer o teste tamb√©m em ambiente de homologa√ß√£o e entender os custos.

Pegando um m√™s inteiro pela p√°gina [/status](http://tabnews.com.br/status), e sem o efeito dos feriados de fim de ano, escolhi de 15/11 at√© 15/12. Nesse per√≠odo, tivemos:

- 808 cadastros.
- 774 publica√ß√µes.
- 2.182 coment√°rios.
- 5.287 votos.

Se considerarmos uma notifica√ß√£o por coment√°rio (como acontece com e-mails hoje) e uma por voto recebido, ter√≠amos 7.469 notifica√ß√µes. Isso ainda deixaria uma certa margem para os 10 mil eventos gratuitos do Novu, onde a pr√≥xima faixa √© 20 mil eventos por US$ 25.

Temos 3 op√ß√µes:
1. 100% solu√ß√£o de terceiro.
2. 100% solu√ß√£o interna.
3. Solu√ß√£o mista. Exemplo: Ably para o envio de eventos e o resto pr√≥prio; ou o Novu para cuidar de tudo, migrando para uma solu√ß√£o pr√≥pria quando necess√°rio.

Imagino que, para a op√ß√£o que envolve migra√ß√£o, precisar√≠amos armazenar as notifica√ß√µes desde o in√≠cio no banco de dados para conseguirmos exibir para os usu√°rios as notifica√ß√µes antigas (que √© desej√°vel, mas n√£o obrigat√≥rio, e talvez nem precise armazenar _todas_ notifica√ß√µes, s√≥ alguns tipos). Mesmo assim, n√≥s poder√≠amos aproveitar o componente de UI do Novu e a parte de notificar o cliente. E numa "vers√£o beta" poderia descartar a parte de n√≥s salvarmos as notifica√ß√µes, tendo o Novu.

## O que voc√™s acham?

Qual op√ß√£o parece fazer mais sentido para voc√™s? J√° precisaram implementar um sistema parecido e tem alguma informa√ß√£o para acrescentar aqui?

>> Coment√°rio de aprendendofelipe:
> * **Armazenamento de notifica√ß√µes por pelo menos 30 dias:** O ideal seria n√£o ter restri√ß√£o de tempo, mas n√£o sei da complexidade em manter um bom desempenho assim. A rede Stack Exchange, por exemplo, armazena todas as notifica√ß√µes que v√£o para o Inbox, e a rede tem v√°rios sites, usu√°rios e tipos de notifica√ß√£o.
> ...
> * Armazenamento de todas notifica√ß√µes "para sempre".

N√£o vejo raz√£o para armazenar as notifica√ß√µes por tempo indeterminado. Acho que as visualizadas podem ser exclu√≠das ap√≥s um certo tempo e/ou quantidade. 

> * Poder desfazer a notifica√ß√£o, caso a a√ß√£o seja desfeita.

Tamb√©m acho que devem ser exclu√≠das se o que elas estiverem notificando deixar de fazer sentido.

>> Coment√°rio de matheussfigueiredo:
## Sugest√£o de implementa√ß√£o

Realizei a cria√ß√£o desse pequeno exemplo utilizando as cores do pr√≥prio TabNews. Espero que gostem

![Captura de tela 2024-09-09 182425](https://github.com/user-attachments/assets/c88dff0e-440a-42c1-81f2-f7838be769a4)

[Link para o Figma](https://www.figma.com/design/BuuAXcHtg9BvrrPBDPdbq9/TabNews---Notification?node-id=0-1&t=tSvgdDhKF2GttOyx-1)
</issue_738_Criar o sistema de notifica√ß√£o via API e interface web (em complemento ao email)>

<issue_742_[Sugest√£o] Posts com tagueamento/t√≥picos>
No cen√°rio onde o usu√°rio deseja por exemplo ver t√≥picos relacionados ao Bitcoin, seria interessante algo como `https://www.tabnews.com.br/tag/[assunto]` ou `https://www.tabnews.com.br/[notic√≠a, tutorial, etc]/[assunto]`..

Outros pontos:
Acredito que os posts poderiam ter mais de uma tag, como nesse caso, "bitcoin", "criptomoeda" e "economia".

Obs: Sou novo por aqui, n√£o sei se esse assunto j√° foi abordado ou se tem alguma barreira para isso, de qualquer forma fico contente pela minha primeira contribui√ß√£o ao projeto por meio dessa sugest√£o üòÅ

>> Coment√°rio de betoth:
Um modelo de "Categoriza√ß√£o" que achei muito legal √© como funciona na WIKI,JS ( https://docs.requarks.io/guide/structure )

![image](https://user-images.githubusercontent.com/1172339/203569665-2c615b39-7d85-4a03-a6ad-ba650bf70063.png)

>> Coment√°rio de yuriveiga:
@betoth, inclusive eu olhando no site identifiquei alguns aspectos importantes ali: 

Algo do tipo: 
                                 
Tag m√£e:

>**Carreira em tech** 

Tags filhas: 
           

>    **Inicio de carreira**

             

>  **Transi√ß√£o de carreira** 

              

> **Aperfei√ßoamento** 

Daria at√© pra fazer um modelo de ML pra aplicar as tags automaticamente.

>> Coment√°rio de Joao620:
Gostaria de incluir [esse post](https://www.tabnews.com.br/willmvrs/sugestao-inclusao-de-tags-em-posts) do [willmvrs](https://www.tabnews.com.br/willmvrs) para discuss√£o, que eu acho que levantou uns bons pontos 

> O que essa feature poderia conter:
> * Divisao entre tags principais e secund√°rias
> * Inclusao de sugestoes de tags primarias, a escolha da tag ainda seria livre, mas j√° teriamos uma lista pr√©-criada com as principais tags
> * Cada tag pode ser acessada e seguida individualmente
> * Posts tamb√©m contam com opcao de seguir
> * Ao acessar a tag ter opcao de organizar entre mais relevantes e mais recentes posts
> * Inclusao de uma sessao no f√≥rum que permitise visualizar as tags e posts seguidos

(Conhecidentemente ele teve umas ideias parecidas com o yuriveiga)

Eu n√£o vejo um sistema desse sendo o melhor, n√£o para ser implementado agora pelo menos. Para come√ßar eu acho melhor s√≥:
* Poder adicionar Tags a posts
* Poder pesquisar por outros posts com essa tag
* Ter uma aba de relevantes e uma de recentes para cada tag
* Escolher receber novos posts de certa Tag
* ~Talvez ter seu feed aparecer mais das tags que voc√™ segue? ou um feed s√≥ do que voc√™ segue?~

Minha vis√£o √© que esses sistemas de tags funcionassem como canais dentro da plataforma, mas sem precisar se preocupar com cria√ß√£o, donos, modera√ß√£o, personaliza√ß√£o, etc...

Ent√£o a comunidade poderia se juntar e criar a tags `#vagas-de-empregos`, para posts sobre isso, ou `#Reactjs`.

>> Coment√°rio de betoth:
Ai s√≥ √© preciso pensar que existir√£o tags aplicadas que n√£o v√£o ter liga√ß√£o com o texto e √© preciso fazer uma esp√©cie de curadoria das tags futuramente

>> Coment√°rio de Joao620:
Sim! Pensei s√≥ na parte de spam de tags, mas um simples limite de tags por post j√° seria o suficiente. Talvez no futuro com um sistema de den√∫ncias, poderia ter uma sess√£o para uso impr√≥prio de tags? Porque acho dif√≠cil a comunidade pressionar pessoa fazendo uso indevido assim j√° que custa para dar downvote tamb√©m

Em 24 de novembro de 2022 23:12:41 BRT, Gilberto Theves ***@***.***> escreveu:
>Ai s√≥ √© preciso pensar que existir√£o tags aplicadas que n√£o v√£o ter liga√ß√£o com o texto e √© preciso fazer uma esp√©cie de curadoria das tags futuramente
>
>
>
>-- >
>Reply to this email directly or view it on GitHub:
>
>https://github.com/filipedeschamps/tabnews.com.br/issues/742#issuecomment-1326951827
>
>You are receiving this because you commented.
>
>
>
>Message ID: ***@***.***>

>> Coment√°rio de guaracy:
> Ai s√≥ √© preciso pensar que existir√£o tags aplicadas que n√£o v√£o ter liga√ß√£o com o texto e √© preciso fazer uma esp√©cie de curadoria das tags futuramente

Acho que a solu√ß√£o deve ser boa para os dois lados. Facilitar a vida do usu√°rio e dificultar a vida dos desenvolvidores √© uma p√©ssima escolha. N√£o fazer nada tamb√©m √© ruim.

1. Definir os assuntos de forma abrangente como: an√∫nicio, artigo, tutorial, d√∫vida, diversos. Evitar assuntos espec√≠ficos como JavaScript. A√≠ algu√©m que usa Python se acha prejudicado e abre uma issue para incluir a linguagem. O que usa Ruby tamb√©m. O que usal Elm tamb√©m. E assim vai.
2. Na hora de publicar um novo conte√∫do, tem um select com as op√ß√µes que o TabNews aceita. 

Se o usu√°rui quiser, poder√° incluir no text algo como #python, #backend, #dica para que algum mecanismo de busca possa tamb√©m pesquisar (mas a√≠ j√° n√£o √© com o TabNews).

>> Coment√°rio de silvaezequias:
Em rela√ß√£o a cria√ß√£o de tags, eu acho interessante fazer o uso do tabcash, j√° que o tabcash √© como uma "reputacao" do usu√°rio, creio que podemos passar essa confian√ßa (de cria√ß√£o de tags) para quem possui uma boa "reputa√ß√£o". Al√©m das tags abrangentes - j√° criadas previamente - esse sistema evita de certa forma o spam de tags. 

Ent√£o, um usu√°rio que possui tabcashs suficiente para criar uma tag ter√° a permiss√£o de cri√°-la e automaticamente essa TAG se torna dispon√≠vel para os outros usu√°rios usarem em seus posts.
Baseado nisso, √© poss√≠vel saber todas as informa√ß√µes sobre determinada tag: (quem criou, quando foi criada e etc...). Isso pode ser bem √∫til na modera√ß√£o.

Seria interessante tamb√©m, adicionar um sistema de tags relevantes: Uma tag que √© comumente usada em diversos posts teria mais visibilidade e destaque na p√°gina inicial.

>> Coment√°rio de mthmcalixto:
@aprendendofelipe que tal a gente tentar criar algo como isso? adicionar tags e descri√ß√£o tamb√©m, apenas uma parte do cont√©udo.

![Screenshot_3](https://github.com/filipedeschamps/tabnews.com.br/assets/121470728/78ac6230-e425-4666-99ee-76808b62eba8)

>> Coment√°rio de aprendendofelipe:
> adicionar tags e descri√ß√£o tamb√©m, apenas uma parte do cont√©udo.

@mthmcalixto, numa busca r√°pida aqui no reposit√≥rio eu n√£o encontrei, mas tenho quase certeza de que isso de mostrar parte do `body` no `contentList` j√° foi debatido e descartado, pois a ideia √© deixar o mais limpo poss√≠vel.

De qualquer maneira, isso n√£o tem rela√ß√£o nenhuma com o assunto dessa issue, ent√£o √© melhor n√£o misturar as ideias. Se quiser discutir mais sobre isso, √© melhor procurar as conversas relacionadas ou abrir uma nova issue espec√≠fica. ü§ù

>> Coment√°rio de emerson-oliveira:
Com o objetivo de gerar dados para conseguir criar as postagens relacionadas pensei no seguinte cen√°rio.

## Funcionamento

Ao criar uma nova postagem, o autor poder√° escolher at√© 3 tags que sejam relevantes para o conte√∫do da postagem. Posteriormente, os visitantes poder√£o sugerir at√© +3 tags. As tags que receberem mais votos ficar√£o vis√≠veis para os usu√°rios.

Com base nas tags mais sugeridas, poder√≠amos implementar uma se√ß√£o de ‚Äúpostagens relacionadas‚Äù no final de cada postagem. Isso permitiria aos usu√°rios navegar de um conte√∫do relacionado para outro sem precisar voltar para a p√°gina inicial.

## Execu√ß√£o

- [ ] **Desenvolvimento da funcionalidade de tags:** Permitir que os autores adicionem at√© 3 tags ao criar uma postagem.
- [ ] **Sugest√µes de tags pelos visitantes:** Implementar uma funcionalidade que permita aos visitantes sugerir at√© +3 tags para cada postagem.
- [ ] **Implementa√ß√£o de vota√ß√£o de tags:** Desenvolver um sistema de vota√ß√£o para as tags sugeridas.

Issue relacionada:
#1478

>> Coment√°rio de hkotsubo:
Outro detalhe importante: caso decida-se pela implementa√ß√£o desta issue, como ficam os posts j√° existentes? V√£o ficar sem tags, ou haver√° algum processo para categoriz√°-los?

>> Coment√°rio de Rafatcb:
@hkotsubo da forma que penso, a princ√≠pio ficariam sem tags, podendo ser adicionadas pelo autor ou moderador atrav√©s da edi√ß√£o da publica√ß√£o.

Publica√ß√µes de Pitch, que geralmente possuem essa palavra no t√≠tulo, poderiam ser categorizadas de forma semi-autom√°tica, com acesso direto ao banco para fazer as consultas necess√°rias. Seria um processo semi-autom√°tico para diminuir as chances de categorizar algo errado.

Uma outra quest√£o √©, se for necess√°rio que todas publica√ß√µes tenham tags, ent√£o as publica√ß√µes antigas teriam uma tag `sem-tag` (ou algo parecido).

>> Coment√°rio de tiagodavi:
@filipedeschamps 

Estava aqui lendo essas sugest√µes de tags e pensei em enviar logo um PR simples que permite incluir tags com "#" e criar uma tabela com tags √∫nicas "pr√©-cadastradas" e uma cor √∫nica definida pelo admin baseado no que as pessoas j√° est√£o "tentando usar" como se fossem tags no site atual, o usu√°rio ent√£o ao digitar com "#" poderia escolher entre as tags pr√©-cadastradas / cor e o t√≠tulo do post √© marcado com essa tag/cor e tamb√©m poder√° existir um filtro para pesquisar por elas ou clicar nelas para exibir todos os posts de uma tag espec√≠fica. 

Nessa primeira vers√£o ningu√©m poder√° criar tags, apenas usar as tags pr√©-criadas pelo admin baseadas nas pr√≥prias tags que os usu√°rios j√° querem ter.. s√≥ ler as postagens que voc√™ vai notar eles criando tags ou tentando criar por conta pr√≥pria. 

"Tags" pr√©-cadastradas que eu vejo bastante por l√°:

[Ajuda] / [D√∫vida] / [Orienta√ß√£o] / [Pitch]

Isso √© um PR simples que resolve o problema e pode ser aprimorado futuramente para todos os cen√°rios mais complexos listados acima.

>> Coment√°rio de fazedordecodigo:
> @aprendendofelipe que tal a gente tentar criar algo como isso? adicionar tags e descri√ß√£o tamb√©m, apenas uma parte do cont√©udo.
> 
> ![Screenshot_3](https://private-user-images.githubusercontent.com/121470728/254451469-78ac6230-e425-4666-99ee-76808b62eba8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkxNTM5NTcsIm5iZiI6MTcwOTE1MzY1NywicGF0aCI6Ii8xMjE0NzA3MjgvMjU0NDUxNDY5LTc4YWM2MjMwLWU0MjUtNDY2Ni05OWVlLTc2ODA4YjYyZWJhOC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIyOFQyMDU0MTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00YzU1ZTI3OGM1YjFkNTBiMjFiZjlkZjI1YmVlZDI0NGE0YjY4YmZhYzNjZTQ1MTU4YjU3YzQ1YzYxNGJjM2U4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.O2XM2XggI3uDGbqdhfXgLqoNhqQl8DKp2zS_o9tX3yc)

Gostei da disposi√ß√£o, acrescento a ideia de colorir as tags, da um visual massa e facilita na leitura.

>> Coment√°rio de fazedordecodigo:
> @filipedeschamps
> 
> Estava aqui lendo essas sugest√µes de tags e pensei em enviar logo um PR simples que permite incluir tags com "#" e criar uma tabela com tags √∫nicas "pr√©-cadastradas" e uma cor √∫nica definida pelo admin baseado no que as pessoas j√° est√£o "tentando usar" como se fossem tags no site atual, o usu√°rio ent√£o ao digitar com "#" poderia escolher entre as tags pr√©-cadastradas / cor e o t√≠tulo do post √© marcado com essa tag/cor e tamb√©m poder√° existir um filtro para pesquisar por elas ou clicar nelas para exibir todos os posts de uma tag espec√≠fica.
> 
> Nessa primeira vers√£o ningu√©m poder√° criar tags, apenas usar as tags pr√©-criadas pelo admin baseadas nas pr√≥prias tags que os usu√°rios j√° querem ter.. s√≥ ler as postagens que voc√™ vai notar eles criando tags ou tentando criar por conta pr√≥pria.
> 
> "Tags" pr√©-cadastradas que eu vejo bastante por l√°:
> 
> [Ajuda] / [D√∫vida] / [Orienta√ß√£o] / [Pitch]
> 
> Isso √© um PR simples que resolve o problema e pode ser aprimorado futuramente para todos os cen√°rios mais complexos listados acima.



A ideia da # √© boa! Fica como se fossem fica como se fosse uma hashtag do xwitter :smile:
Na verdade aqui mesmo no GitHub funciona assim...

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/38289677/3f7c0a7e-3b12-4cb8-9916-76215880ad91)

Vai ficar massa! :100:

>> Coment√°rio de fazedordecodigo:
@tiagodavi bora pegar essa task? 

@filipedeschamps podemos apoiar nisso?

>> Coment√°rio de aprendendofelipe:
@fazedordecodigo, n√£o precisa pedir, e nem se comprometer com a implementa√ß√£o! ü§ù

Quem for implementar, recomendo separar o backend do frontend, ou at√© mesmo dividir em mais do que 2 PRs se for necess√°rio, por exemplo, por causa das *migrations*.

>> Coment√°rio de tiagodavi:
@fazedordecodigo poderia at√© pegar, mas no meu tempo.. ando envolvido com muita coisa.. 

E j√° tenho esse PR enviado aqui: https://github.com/filipedeschamps/tabnews.com.br/pull/1641

>> Coment√°rio de ItaloSa:
Gente, podemos da uma simplificada e seguir com tags como no X (finado twitter)? Acho que faria isso andar e depois pensar√≠amos em mais formas de limitar a bagun√ßa.

>> Coment√°rio de mthmcalixto:
> Gente, podemos da uma simplificada e seguir com tags como no X (finado twitter)? Acho que faria isso andar e depois pensar√≠amos em mais formas de limitar a bagun√ßa.

Eu tentei implementar isso no localhost, na verdade na cria√ß√£o do conte√∫do, uma √°rea de tags.

Mas depois vi o trabalho que seria puxar as tags criadas, fora atualizar banco de dados e testes, o pessoal daqui prioriza bastante os testes antes de subir um pull, isso pode acabar demorando o PR.

Tem um site que tente fazer algo parecido dele, similar, pegar as tags e colocar no t√≠tulos na p√°gina inicial, e tamb√©m puxar nos posts, ficou bem bacana, o problema √© puxar e salvar essas informa√ß√µes.
</issue_742_[Sugest√£o] Posts com tagueamento/t√≥picos>

<issue_743_[Sugest√£o] Links em nova aba>
Boa noite, percebi que os links do tabnews sempre abrem na p√°gina que est√° aberta, sendo assim, se eu n√£o queria sair da postagem, sou for√ßado a voltar a p√°gina.
N√£o sei se isso j√° foi t√≥pico em outra sugest√£o, n√£o achei.
Tamb√©m n√£o sei se mais pessoas se "incomodam" com isso, n√£o chega a ser um problema, eu clico com o scroll pra abrir em nova aba, mas talvez seria interessante os links sempre abrirem em nova aba, para n√£o perder de certa forma a reten√ß√£o do usu√°rio na plataforma.
Obrigado pela aten√ß√£o.

>> Coment√°rio de Rafatcb:
Tem uma issue sobre abrir links de Fontes em uma nova aba: https://github.com/filipedeschamps/tabnews.com.br/issues/477. Eu sempre acabo abrindo os links em nova aba tamb√©m, mas o Filipe postou um coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074) com um ponto de vista diferente, que eu achei legal.
</issue_743_[Sugest√£o] Links em nova aba>

<issue_744_DOS ou alguma coisa estranha aconteceu com o Middleware>
Olha esse gr√°fico no Upstash:

<img width="1013" alt="image" src="https://user-images.githubusercontent.com/4248081/191357321-09551d3a-caf6-49a8-8f9d-541f87b639e6.png">

Digo estranho, porque antes disso a lat√™ncia do servi√ßo aumentou:

<img width="1030" alt="image" src="https://user-images.githubusercontent.com/4248081/191357406-c21d35f8-8a54-4122-bfb4-ca0e1cfc0ade.png">

E ambos os ambientes apresentaram esse pico:

<img width="610" alt="image" src="https://user-images.githubusercontent.com/4248081/191357656-253b0510-dc0a-4700-9afe-10925c059c21.png">

E nenhuma `status page` mostrava nenhuma instabilidade: Vercel, Upstash, AWS e Cloudflare.

O que suspeito √© que algo aconteceu na Upstash, onde os logs das lambdas marcavam que passavam de `30` segundos e retornava um erro.

>> Coment√°rio de aprendendofelipe:
> O que suspeito √© que algo aconteceu na Upstash, onde os logs das lambdas marcavam que passavam de `30` segundos e retornava um erro.

Ser√°? O Upstash n√£o deveria causar problemas para as lambdas, mas s√≥ para a Edge. E na Edge o timeout √© de 5s e n√£o 30s.

Talvez algo na AWS que tenha afetado tanto a Vercel quanto o Upstash. O mais estranho √© que nesse per√≠odo o console da Vercel s√≥ mostra 6 invoca√ß√µes das lambdas com erro. Nenhuma deu timeout e mais de 1000 deram sucesso. S√≥ que nessas com sucesso o tempo de execu√ß√£o foi l√° pra cima.

Talvez s√≥ os logs do Upstash e algumas requisi√ß√µes na Vercel tenham sido afetadas. Pois no gr√°fico da Edge n√£o aparece nenhum pico de acessos.

Sabe se realmente ocorreu alguma instabilidade para quem estava acessando o TabNews? Eu acho que acessei nesse hor√°rio e n√£o percebi nada de estranho.

@filipedeschamps, teve um deploy na Vercel nesse mesmo hor√°rio. Foi voc√™ mesmo?

>> Coment√°rio de filipedeschamps:
> Pois no gr√°fico da Edge n√£o aparece nenhum pico de acessos.

Justo, e tamb√©m n√£o aparece nenhum pico nos logs que entram nas lambdas.

> Sabe se realmente ocorreu alguma instabilidade para quem estava acessando o TabNews?

Sim, todas as rotas da API n√£o respondiam mais e retornavam `504`. Os est√°ticos continuavam ok.

> @filipedeschamps, teve um deploy na Vercel nesse mesmo hor√°rio. Foi voc√™ mesmo?

Foi, queria entender se isso destravaria algo, mas n√£o ajudou. O interessante √© que era poss√≠vel fazer a gera√ß√£o dos est√°ticos normalmente, s√≥ n√£o era poss√≠vel conseguir retorno do que passava pelo `/api`.

E da√≠ o √∫nico pico que encontrei foi no Upstash mesmo üëç

>> Coment√°rio de aprendendofelipe:
> Sim, todas as rotas da API n√£o respondiam mais e retornavam `504`. Os est√°ticos continuavam ok.

Isso provavelmente foi s√≥ por causa do Upstash mesmo, mas se foi isso, o timeout foi de 5s na Edge. 

Estamos tratando erros do Upstash, mas n√£o temos nada para quando ele demorar para responder.

Como tem o limite de 5s da Edge, podemos chamar o NextResponse.next() dentro de setTimeout de uns 4s (ou talvez bem menos), pra eliminar esse ponto cr√≠tico que √© o Upstash.

>> Coment√°rio de filipedeschamps:
> Estamos tratando erros do Upstash, mas n√£o temos nada para quando ele demorar para responder.
> 
> Como tem o limite de 5s da Edge, podemos chamar o NextResponse.next() dentro de setTimeout de uns 4s (ou talvez bem menos), pra eliminar esse ponto cr√≠tico que √© o Upstash.

Perfeit√≠ssimo! Acabei de adicionar no #493 esse seu coment√°rio na se√ß√£o de Seguran√ßa pra n√£o correr o risco de se perder entre as Milestones ü§ù  

Vou fechar essa issue mas vou continuar de olho aqui üëç
</issue_744_DOS ou alguma coisa estranha aconteceu com o Middleware>

<issue_745_Bug: `Link` faz resposta ser carregada por onde voc√™ navegar>
Acabei de esbarrar em um bug que foi revelado pelo fato de estarmos usando o `Link` para navegar entre os links de dentro de uma resposta.

Para reproduzir:

## 1) Criar uma resposta normalmente que ela vai ficar no modo "acabei de ser publicada".

<img width="784" alt="image" src="https://user-images.githubusercontent.com/4248081/191507680-f6a9a42b-b579-4ec8-a329-c75c8d992a7d.png">

## 2) Navegar clicando em algum link que esteja usando o componente `Link`

### 2.1) Nesse caso aqui eu naveguei para a publica√ß√£o raiz

<img width="800" alt="image" src="https://user-images.githubusercontent.com/4248081/191507344-82dcf9f4-6d96-4dae-acb5-2b55b40124f0.png">

### 2.2) Abri o link permanente de outra resposta

<img width="803" alt="image" src="https://user-images.githubusercontent.com/4248081/191507383-8d288211-ae35-457c-bf51-1f6618729bc5.png">

### 2.3) Abri o link permanente da minha pr√≥pria resposta

<img width="1028" alt="image" src="https://user-images.githubusercontent.com/4248081/191507190-0b1d3356-54b1-4658-9466-84ec7d81ddce.png">

# Conclus√£o

Naturalmente isso √© consertado no primeiro refresh, pois √© algo que est√° somente em mem√≥ria. Era um bug que j√° acontecia, mas estava escondido pelo fato de antes cada acesso era um novo refresh de p√°gina.

>> Coment√°rio de filipedeschamps:
Executado inicialmente por @Rafaelb4rros no PR #749 e alguns dias depois o @aprendendofelipe fez uma proposta mais simples no PR #760 que foi merged üëç comunidade do TabNews continuando ser simplesmente sensacional üòç

>> Coment√°rio de 33gustavo33:
A resposta n√£o √© mais carregada, mas uma outra coisa √©: A mensagem que o conte√∫do foi deletado
V√≠deo:
https://user-images.githubusercontent.com/50342600/200961050-7122e7c1-a2dc-46c8-b920-dca1b9e73404.mp4

Para reproduzir:

1. Crie uma resposta
2. Navegue at√© a pagina da resposta
3. Delete a resposta
4. Volte ao conte√∫do original pelo link que tem na pagina da resposta.

>> Coment√°rio de filipedeschamps:
@33gustavo33 sensacional! Voc√™ se importa em criar uma nova issue para aparecer l√° na lista principal? ü§ù

>> Coment√°rio de 33gustavo33:
> @33gustavo33 sensacional! Voc√™ se importa em criar uma nova issue para aparecer l√° na lista principal? ü§ù
Vou criar ü§ù
</issue_745_Bug: `Link` faz resposta ser carregada por onde voc√™ navegar>

<issue_746_Duvida sobre a contribui√ß√£o>
## Posso fazer um PR resolvendo apenas parte de um problema?
Por exemplo, L√° na [Milestone 5](https://github.com/filipedeschamps/tabnews.com.br/issues/493) na parte `Itens importantes para proximas Milestones` tem isso aqui:
> 13. P√°gina do usu√°rio listar tamb√©m os coment√°rios que ele fez.

Nesse caso eu poderia fazer um PR habilitando isso s√≥ na API? 
Pergunto isso pois ainda sou **ruim** em frontend, mas ainda sim quero contribuir com o Tabnews

>> Coment√°rio de filipedeschamps:
@33gustavo33 pode total meu caro! Inclusive, n√£o √© necess√°rio pedir permiss√£o para fazer PRs se voc√™ encarar de uma forma positiva que √© considerar que qualquer PR √© uma **sugest√£o de implementa√ß√£o**, muito como uma **issue** mas em forma de c√≥digo real, e n√£o h√° nenhuma obriga√ß√£o/comprometimento envolvido por nenhuma das partes para que essa contribui√ß√£o seja aceita.

Isso deveria tirar um peso das suas costas e lhe dar a liberdade para sugerir coisas concretas (e n√£o especulativas, como uma issue faz), que v√£o lhe trazer mais pr√°tica com o projeto e programa√ß√£o em si.

Mas batendo na tecla do _"s√≥ na API"_, n√£o vejo problema algum se voc√™ n√£o quebrar a interface p√∫blica da API para esse caso, pois isso lhe d√° a flexibilidade de outra pessoa implementar a parte do frontend em outro momento. Ou se achar que √© fundamental quebrar a interface, podemos fazer um comunicado para a comunidade, pois ainda estamos em beta e precisamos dessa flexibilidade ü§ù

>> Coment√°rio de 33gustavo33:
> @33gustavo33 pode total meu caro! Inclusive, n√£o √© necess√°rio pedir permiss√£o para fazer PRs se voc√™ encarar de uma forma positiva que √© considerar que qualquer PR √© uma **sugest√£o de implementa√ß√£o**, muito como uma **issue** mas em 

N√£o √© mais uma quest√£o de pedir permiss√£o, √© mas uma duvida mesmo que eu tinha sobre quais PRs s√£o validos e quais n√£o s√£o

Concluindo isso, j√° vou fazer o PR
</issue_746_Duvida sobre a contribui√ß√£o>

<issue_752_[Sugest√£o] Identificar que o usu√°rio j√° votou numa publica√ß√£o>
Uma das coisas que eu me pergunto, de vez em quando, √©: _"eu j√° votei nessa publica√ß√£o?"_.

Em ambientes onde s√≥ se pode votar uma vez, essa identifica√ß√£o √© feita de forma simples: no Hacker News o √≠cone some; no Stack Overflow o √≠cone fica com uma cor diferente.

| Hacker News | Stack Overflow |
| --- | --- |
| ![Publica√ß√£o votada sem exibir a seta; publica√ß√£o n√£o votada exibindo a seta](https://user-images.githubusercontent.com/26308880/193292422-e72f9808-d7bc-4a1a-b5fe-cd25ee345b70.png) |  ![Op√ß√£o votada em laranja, n√£o votada em cinza](https://user-images.githubusercontent.com/26308880/193292983-48dc99cd-7484-4aec-83f4-6aac9ff25768.png) |
| _Publica√ß√£o votada sem exibir a seta; publica√ß√£o n√£o votada exibindo a seta._  | _Op√ß√£o votada em laranja, n√£o votada em cinza._ |

Ent√£o, junto dessa sugest√£o, quero levantar dois pontos para a discuss√£o:

* **Frontend:** Como poder√≠amos exibir essa informa√ß√£o no nosso cen√°rio, onde podemos votar tanto de forma positiva quanto negativa, e mais de uma vez?
* **Backend:** √â vi√°vel trazer esse tipo de informa√ß√£o do backend para o frontend? Ou isso envolve muitas queries demoradas? (eu n√£o estudei o c√≥digo do backend nem a API do TabNews, ent√£o n√£o sei se esse dado j√° √© fornecido hoje)

--------

Caso a resposta para a pergunta sobre o backend seja _"√© vi√°vel, sem problemas"_, acredito que a discuss√£o sobre o frontend possa ser levada ao TabNews para ter mais visibilidade e gerar mais sugest√µes.

>> Coment√°rio de fabriciolak:
Ol√°, @Rafatcb. Adicionei essa "tag" de sugest√£o no in√≠cio e mudei o t√≠tulo para ficar um pouco mais claro. Tudo bem?

>> Coment√°rio de deyvisonIO:
Gostei da ideia. Creio que uma colora√ß√£o diferente, indicando que o usu√°rio j√° votou, por exemplo, verde para up-voting e vermelho para down-voting, seria interessante. Em rela√ß√£o √† quantidade de votos, poderia ser visualizada atrav√©s de um tooltip quando o usu√°rio passar o mouse sobre o bot√£o de up/down-voting.A quest√£o do backend fica mais complicada, pois acredito que esses dados n√£o s√£o salvos no banco de dados, apenas as transa√ß√µes de tabcoins s√£o realizadas.

>> Coment√°rio de Rafatcb:
Estou fechando essa issue porque a https://github.com/filipedeschamps/tabnews.com.br/issues/1510 teve mais intera√ß√µes e sugest√µes, acho legal concentrarmos a discuss√£o num lugar s√≥.
</issue_752_[Sugest√£o] Identificar que o usu√°rio j√° votou numa publica√ß√£o>

<issue_753_[Sugest√£o] Notifica√ß√µes usando Novu>
### O problema

Atualmente, s√≥ existe um canal de notifica√ß√£o: emails. Escalar isso, criar novos canais de notifica√ß√µes, gerenciar templates, prefer√™ncias dos usu√°rios etc pode ser chato e levar um tempo. Cheguei aqui na aba de issues e achei algumas ideias relacionadas a isso tamb√©m: #738, #523.

### A sugest√£o

H√° um tempo, ouvi falar do [Novu](https://novu.co) e resolvi que esse era a solu√ß√£o de notifica√ß√µes que eu gostaria de implementar na minha plataforma ([FreshCoins](https://freshcoins.io)). A solu√ß√£o mencionada permite entregar notifica√ß√µes para os usu√°rios em v√°rios canais (email, sms, barra de notifica√ß√µes, etc) com m√≠nima configura√ß√£o. Ainda n√£o fiz o release dessa integra√ß√£o em minha plataforma porque estamos focados em outras features no momento com maior prioridade, mas j√° fiz alguns testes e validei o potencial para minha plataforma e creio ser uma op√ß√£o v√°lida tamb√©m para o TabNews, visto que essa parte ainda est√° bem embrion√°ria.

### Novu

![image](https://user-images.githubusercontent.com/31714350/193360763-5bac0dae-671a-4024-b337-8361f032234a.png)

- Open source (MIT) - [reposit√≥rio no github](https://github.com/novuhq/novu)
- Pode ser self-hosted ou usar a infra deles que no momento √© gratuita e sem limita√ß√µes
- Suporta muitas integra√ß√µes nativamente (para email: Nodemailer - o mesmo usado aqui, Amazon SES, SendGrid, Mailjet, etc)
- Tem algumas facilidades tipo um [componente react para mostrar as notifica√ß√µes](https://docs.novu.co/notification-center/react-components) para o usu√°rio + hooks pra voc√™ fazer seu componente na m√£o

Desculpe se esse assunto j√° foi batido o martelo em algum encontro com os membros, estive muito fora desse meio nos √∫ltimos meses, espero que essa issue seja √∫til haha.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ßoes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_753_[Sugest√£o] Notifica√ß√µes usando Novu>

<issue_762_Bug na interface quando tem muitas respostas consecutivas>
Eu estava fazendo alguns testes nesse post [aqui](https://tabnews-git-ranking-tabnews.vercel.app/Gustavo33/teste4593832181797422292334945798549354624941348715825899669), e descobri que quando tem muitos coment√°rios a UI quebra. 

Como voc√™ vai poder ver acessando o post, depois da resposta `28` a UI simplesmente quebra.

Acredito que a solu√ß√£o pra isso seria definir um limite de respostas consecutivas

>> Coment√°rio de wcarugatti:
No responsivo/mobile fica ainda pior e mais frequente j√° que com menos respostas
Em vez de limitar o n√∫mero de respostas, sugiro a solu√ß√£o do reddit para o mesmo problema
![image](https://user-images.githubusercontent.com/13296861/195361528-ccd8387f-1407-4aec-a8a3-85b86338025b.png)
![image](https://user-images.githubusercontent.com/13296861/195360777-08c3c7e9-e71d-4ba7-bc2f-fde264c29bbc.png)

>> Coment√°rio de aprendendofelipe:
@33gustavo33, obrigado por relatar! üí™

Estou fechando essa issue por ser um problema que j√° √© discutido na #379 ü§ù
</issue_762_Bug na interface quando tem muitas respostas consecutivas>

<issue_763_Bug: lidar com caracteres `\u200e`, `\u200f` e `\u0000`>
## Contexto

- #731

## Execu√ß√£o

- #759

>> Coment√°rio de filipedeschamps:
Fechado por #759
</issue_763_Bug: lidar com caracteres `\u200e`, `\u200f` e `\u0000`>

<issue_764_Deprecated warning: IncomingMessage.connection>
Em um ambiente usando TypeScript, me deparei com o seguinte erro:

![image](https://user-images.githubusercontent.com/31714350/194676185-ebb7ca09-f331-4d5e-8b9c-d6b2de9aeaa7.png)

O mesmo trecho de c√≥digo pode ser encontrado aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/e06b605aacbd07da6ec1490fe92709f530f1586c/models/controller.js#L25-L26

√â bem simples. O tipo `IncomingMessage` (`@types/node/http.d.ts`), qual o `NextApiRequest` herda propriedades n√£o vai ter mais a propriedade `connection` em vers√µes futuras do NodeJS. Ao inv√©s disso, voc√™ deve usar `IncomingMessage.socket` ‚Äì que possui o exato mesmo tipo (imagem abaixo) ‚Äì, e isso causa um aviso de deprecated a partir da vers√£o 16 do NodeJS e seu respectivo pacote de defini√ß√£o de tipos.

![image](https://user-images.githubusercontent.com/31714350/194676697-ec3dbaa2-985d-4a20-ba89-e99beb3b111f.png)

Acho que dever√≠amos usar `IncomingMessage.socket`, mesmo que o projeto possa ser configurado para rodar usando Node@14. Vou subir um PR mencionando esse issue.
</issue_764_Deprecated warning: IncomingMessage.connection>

<issue_768_[D√∫vida] Aguardando uma fun√ß√£o n√£o-ass√≠ncrona>
Dando uma olhada no c√≥digo, percebi que tem um `await` em uma fun√ß√£o de valida√ß√£o de Schema.
https://github.com/filipedeschamps/tabnews.com.br/blob/e06b605aacbd07da6ec1490fe92709f530f1586c/models/user.js#L144
Quando fui olhar como era essa fun√ß√£o, vi que ela n√£o √© ass√≠ncrona e que pela l√≥gica o `await` n√£o teria efeito nenhum nesse caso:
https://github.com/filipedeschamps/tabnews.com.br/blob/e06b605aacbd07da6ec1490fe92709f530f1586c/models/user.js#L184
O `await` tem algum efeito ai? ou foi apenas um erro?

>> Coment√°rio de aprendendofelipe:
> O `await` tem algum efeito ai?

Nenhum efeito. Removido com o PR #769 üòâ
</issue_768_[D√∫vida] Aguardando uma fun√ß√£o n√£o-ass√≠ncrona>

<issue_770_Altera `request.connection` por estar deprecado>
## Contexto

- #764

## Execu√ß√£o

- #765

>> Coment√°rio de filipedeschamps:
Fechado por #765
</issue_770_Altera `request.connection` por estar deprecado>

<issue_771_Ambiente de homologa√ß√£o sendo idexado>
Eu estava fazendo algumas pesquisas no Bing quando isso apareceu:
![Screenshot 2022-10-10 at 14-29-16 tabstats tabnews - Pesquisar](https://user-images.githubusercontent.com/90806505/194931756-c554bd3d-4b1d-4dfb-b2de-7495d4ce0813.png)

Essas p√°ginas eram pra ser indexadas?

>> Coment√°rio de silvaezequias:
Apareceu isso uns dias atr√°s pra mim e eu pensei que fosse um bug do navegador...
Depois disso eu fiquei pensando se n√£o seria melhor atribuir esse ambiente para um subdom√≠nio tipo `https://preview.tabnews.com.br` s√≥ que ao mesmo tempo acho que √© um trabalho relativamente grande pra tal finalidade

>> Coment√°rio de aprendendofelipe:
Aparentemente esse endere√ßo n√£o est√° indexado agora, mas de vez em quando os rob√¥s devem indexar temporariamente, pois √© uma branch de teste do dark-mode, e tem links para ela em diversos locais (dentro do GitHub e do TabNews). Da√≠ quando os rob√¥s recebem o `noindex` da Vercel, acho que j√° excluem.

>> Coment√°rio de gabrielsozinho:
> Aparentemente esse endere√ßo n√£o est√° indexado agora, mas de vez em quando os rob√¥s devem indexar temporariamente, pois √© uma branch de teste do dark-mode, e tem links para ela em diversos locais (dentro do GitHub e do TabNews). Da√≠ quando os rob√¥s recebem o `noindex` da Vercel, acho que j√° excluem.

Ahh sim, ent√£o vou fechar a issue.
</issue_771_Ambiente de homologa√ß√£o sendo idexado>

<issue_772_Problema para acessar publica√ß√£o>
Sou novo na plataforma e estou aprendendo a mexer com ela agora, mas acho que houve algum erro pois quando tentei abrir a seguinte publica√ß√£o apareceu uma tela de erro dizendo: *"Application error: a client-side exception has ocurred(see the browser console for more information)"*

### Imagem e link
![Application error: a client-side exception has ocurred(see the browser console for more information)](https://lh3.googleusercontent.com/zWIeEVmSMSrM_odsR3GHN48j12ba6l0vwXpt2dD1yHC-UWfifejZQwvMwqIC-ewj1hyuADBRC11l3WH4XAnTsJmUb6s51Vdt5REfvW0ugg26jAagDh4Q8Tlh4Gw56mfVX3b5z1VvseNW-b7z2xyRUHSZOsRaZECaocqrortAeoLgoYeQIXRLtbCy8PsFZ7XAb99JeW_qRY10l0cutFIGC8CK2RrvQyCkSUcUH75kS8ZMWNP7TFMs_JuQ80bOCK4L-KHcoiHMKej1shRsNiMtKFJCU1tm6fTpbvEuxrzWHYflA9YeVMVcfIYG2VNS3EqrFDL0V0BWV-XyBfTygk--VMtcznA5TK_mR3V6jH7yvfxDRGhVvJ1wg3FpWCWKYl7VJm8K6x9RL311SFFOJW44JZMV5L9g2OS_vZGKFv30CZJnQ1_Tiel8vU3fpv3y0Gte8iCkcz6Mj7zun1qEf-PX9QT5wbnByx-AvMMM98qlk29LOoBwuSO-UFmNKy0NRME3iV6OdUvu-2Pxr4T72g3CrcNE5j-1WsfWVuXC2EY6siepEGfDKkP2wdIL78CUpKAwlVYl5Cg-PCpdVnm6O1b2R750Y-xoJg8yhM5VFtlFs6C11vIWqaO4QNqYTISwD6pGACGmrTNijWRU79RdniKaRx0YgVJrysOOQWLIQ24IuYpEBF73l1rQNdy5m9gQNx60ixCumqT-o5Nf_h7uWcRwNqyUUqJRAQ3s-fuPqovot3nebsID0rpQt5gmlPL7VFaN8E_-V9rw9yaH1Q8aYQhPyDwPI6L2YvKHdKNkaWK3qCi41HvaU5WdGcVucx0AosCN4WalPYzJXHqcLvqsvELgQkHNU1palLdu-gvjTcgS2dpjsLjdfjawwHyUiGkZZeHq1UItvLSVMlYDmn6nfOnCSl1A-ljwW0GtrMZU=w1793-h969-no?authuser=0)
[https://www.tabnews.com.br/FlaviaCarvalho/publicidade-via-satelite-e-tecnica-e-economicamente-viavel-afirmam-cientistas-russos](https://www.tabnews.com.br/FlaviaCarvalho/publicidade-via-satelite-e-tecnica-e-economicamente-viavel-afirmam-cientistas-russos)

>> Coment√°rio de Rafatcb:
_Esse problema foi brevemente discutido no [TabNews](https://www.tabnews.com.br/guisouzaDev/nao-consigo-abrir-publicacao)_


-------


Consegui reproduzir aqui. Eu uso o navegador Brave, e s√≥ aconteceu com os "_Shields_" ativos. Os passos para a reprodu√ß√£o foram:

1. Ir para a p√°gina de [Recentes](https://www.tabnews.com.br/recentes)
2. Procurar a publica√ß√£o [Publicidade via sat√©lite √© t√©cnica e economicamente vi√°vel, afirmam cientistas russos](https://www.tabnews.com.br/FlaviaCarvalho/publicidade-via-satelite-e-tecnica-e-economicamente-viavel-afirmam-cientistas-russos)
3. Clicar na publica√ß√£o

Ao ir para a p√°gina de Recentes, ocorre um _fetch_ mal sucedido, e o hover na publica√ß√£o realiza o _pr√©-fetch_. Essas duas requisi√ß√µes s√£o bloqueadas por causa dos _Shields_ do Brave:

* https://www.tabnews.com.br/api/v1/contents/FlaviaCarvalho/publicidade-via-satelite-e-tecnica-e-economicamente-viavel-afirmam-cientistas-russos 
* https://www.tabnews.com.br/api/v1/contents/FlaviaCarvalho/publicidade-via-satelite-e-tecnica-e-economicamente-viavel-afirmam-cientistas-russos/children

![Reprodu√ß√£o do problema conforme explicado acima](https://user-images.githubusercontent.com/26308880/194933511-23815e1a-53e9-4bf8-9fde-7c1c08600c4b.gif)

Alguns detalhes:

* Se eu der F5, acessar a not√≠cia abrindo em nova aba ou pelo link que est√° nessa publica√ß√£o, o erro n√£o acontece porque n√£o h√° _pr√©-fetch_.
* N√£o percebi outra publica√ß√£o do TabNews cuja alguma chamada foi bloqueada pelos _Shields_ do Brave.

O erro ocorrido foi:

```
main-89a62caeeb28afe5.js:1 TypeError: Failed to fetch
    at V (main-89a62caeeb28afe5.js:1:55248)
    at d (main-89a62caeeb28afe5.js:1:55681)
    at X (main-89a62caeeb28afe5.js:1:56508)
    at main-89a62caeeb28afe5.js:1:71085
    at l (main-89a62caeeb28afe5.js:1:109320)
    at Generator._invoke (main-89a62caeeb28afe5.js:1:109108)
    at forEach.e.<computed> [as next] (main-89a62caeeb28afe5.js:1:109743)
    at r (main-89a62caeeb28afe5.js:1:882)
    at u (main-89a62caeeb28afe5.js:1:1087)
    at main-89a62caeeb28afe5.js:1:1146
```

>> Coment√°rio de aprendendofelipe:
Seria bom clicar em ‚ÄúReport a broken site‚Äù para que saibam que o TabNews √© seguro

>> Coment√°rio de aprendendofelipe:
@guisouza-dev, obrigado por reportar! üí™

Na √©poca chegamos na conclus√£o de que o Brave estava bloqueando a requisi√ß√£o por conter a palavra "publicidade" na URL.

N√£o sei se esse problema ainda est√° presente, provavelmente n√£o, pois ningu√©m mais reportou.

De qualquer forma, n√£o parece algo que esteja no nosso controle, ent√£o estou fechando a issue! ü§ù
</issue_772_Problema para acessar publica√ß√£o>

<issue_777_Aumenta a √°rea de `hover` das TabCoins e TabCash>
## Contexto e Execu√ß√£o

- #766
- #776

## Antes

![Antes](https://i.imgur.com/mybk4M2.gif)

## Depois

![Depois](https://i.imgur.com/08duDWX.gif)
</issue_777_Aumenta a √°rea de `hover` das TabCoins e TabCash>

<issue_778_[Sugest√£o] FAQ / Help Center>
Com o tabnews cada vez mais perto de um lan√ßamento oficial, um FAQ simples como o do hackernews √© fundamental ou um help center mais completo futuramente como o do reddit. Atualmente n√£o tem uma fonte clara de informa√ß√µes sobre como funciona o sistema de tab coins/cash por exemplo.

Poderia entrar aqui, seria bem simples:
![image](https://user-images.githubusercontent.com/13296861/195359889-5a8446a6-7156-414e-b02c-9e455eafaede.png)

https://news.ycombinator.com/newsfaq.html
![image](https://user-images.githubusercontent.com/13296861/195358574-da40dea5-e148-47a8-a5bf-e1582011bf96.png)
![image](https://user-images.githubusercontent.com/13296861/195358727-9f72bf92-28ad-457f-a459-71d60c6d8215.png)

>> Coment√°rio de gabrielsozinho:
Opa, acho que essas p√°ginas aqui j√° respondem muitas coisas:
- [https://www.tabnews.com.br/contato](https://www.tabnews.com.br/contato)
- [https://www.tabnews.com.br/termos-de-uso](https://www.tabnews.com.br/termos-de-uso)
- [https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa)
- [https://www.tabnews.com.br/filipedeschamps/nova-melhoria-tabcoins-tabcash-e-melhorias-no-layout](https://www.tabnews.com.br/filipedeschamps/nova-melhoria-tabcoins-tabcash-e-melhorias-no-layout)

Apesar disso, concordo que as informa√ß√µes deveriam estar mais "unificadas".

>> Coment√°rio de wcarugatti:
Verdade, n√£o vi que tinha esses links no footer
</issue_778_[Sugest√£o] FAQ / Help Center>

<issue_779_Bug: `/api/v1/contents/[username]` retorna todos os conte√∫dos>
## Contexto

N√£o sei em qual momento isso come√ßou a acontecer, mas o endpoint raiz de conte√∫dos do usu√°rio (sem passar a estrat√©gia), est√° retornando todos os conte√∫dos:

https://www.tabnews.com.br/api/v1/contents/filipedeschamps
- Est√° retornando os conte√∫dos de todos os usu√°rios, utilizando a estrat√©gia `relevant`.

https://www.tabnews.com.br/api/v1/contents/filipedeschamps?strategy=new
- Est√° retornando apenas os conte√∫dos do usu√°rio `filipedeschamps`.

Isto implica nunca mais mostrar aquela mensagem de aviso inicial caso o usu√°rio n√£o tenha mais publica√ß√µes. Esta mensagem √© **extremamente** importante aparecer para a pessoa entender o quanto prezamos conte√∫dos de valor concreto:

https://github.com/filipedeschamps/tabnews.com.br/blob/35db16c24672c743b277856a058eada5b25fc1db/pages/publicar/index.public.js#L23-L33

Em paralelo, eu acredito que foi uma cadeia de 2 fatores:

1. O valor padr√£o para o strategy √© `relevant`.
2. O que faz cair na nova estrat√©gia `getRelevant()` que ignora as `options` com o `owner_username` (que vai se transformar em `username`):
https://github.com/filipedeschamps/tabnews.com.br/blob/acb108f0976f45728bd36552772f5a3122e371af/models/content.js#L242


## Duas coisas precisam ser feitas que podem/devem ser feitas de forma separada

1. **A mais urgente:** para conferir corretamente a exist√™ncia de conte√∫dos de um usu√°rio, definir a estrat√©gia `new` na hora de buscar os dados, uma vez que o `relevant` ir√° buscar publica√ß√µes feitas apenas dentro de uma semana.
https://github.com/filipedeschamps/tabnews.com.br/blob/35db16c24672c743b277856a058eada5b25fc1db/pages/publicar/index.public.js#L10
2. Trazer de volta o escopo do `owner_username` para dentro do `getRelevant()` e escrever um teste que prove que esse comportamento quebrou e foi consertado.

## Execu√ß√£o

- #783

>> Coment√°rio de 33gustavo33:
Esse bug n√£o √© por causa desse if dentro do `findAll()`?
https://github.com/filipedeschamps/tabnews.com.br/blob/56cddfa447d7f628b3277ba2e6b7020789faab9b/models/content.js#L23-L32

>> Coment√°rio de filipedeschamps:
Perfeito @33gustavo33 muito obrigado por complementar! Ent√£o de fato, mesmo passando o escopo do usu√°rio para dentro do model `content`, a query n√£o recebe isso ü§ù

>> Coment√°rio de 33gustavo33:
https://github.com/filipedeschamps/tabnews.com.br/blob/56cddfa447d7f628b3277ba2e6b7020789faab9b/models/content.js#L23
Uma das solu√ß√µes pra arrumar esse if seria isso:
```js
 if (options.strategy === 'relevant' && !values?.where?.owner_id) { 
```
O √∫nico problema, √© que fazendo isso a estrat√©gia `relevant` para de funcionar no `api/v1/contents/[username]`
Assim toda as requests com o valor `relevant` como estrat√©gia seriam substitu√≠das pela estrat√©gia `new` 

De qualquer jeito, eu n√£o acho que os `ranks_groups` se encaixam na pagina do usu√°rio, j√° que v√°rios usu√°rios postam no m√°ximo 1 conte√∫do por semana ou menos que isso

Uma parte positiva da estrat√©gia `relevant` parar de funcionar, √© que n√£o teria que fazer nenhum novo teste, s√≥ modificar [esse teste](https://github.com/filipedeschamps/tabnews.com.br/blob/main/tests/integration/api/v1/contents/%5Busername%5D/get.test.js#L79-L160) pra funcionar com a estrat√©gia `relevant` e fazer ela criar um outro conte√∫do `root` com outro usu√°rio

>> Coment√°rio de aprendendofelipe:
> N√£o sei em qual momento isso come√ßou a acontecer, mas o endpoint raiz de conte√∫dos do usu√°rio (sem passar a estrat√©gia), est√° retornando todos os conte√∫dos:

Como o @33gustavo33 disse, come√ßou quando adicionei esse desvio:

`if (options.strategy === 'relevant') { `

> Uma das solu√ß√µes pra arrumar esse if seria isso:
> ```js
>  if (options.strategy === 'relevant' && !values?.where?.owner_id) { 
> ```

Boa! Isso j√° deveria estar a√≠, pois n√£o faz sentido usar a nova query de relevantes para os conte√∫dos de um √∫nico usu√°rio. Na verdade, pelo sucesso nos testes, eu imaginei que isso j√° estava ocorrendo, mas olhando com mais aten√ß√£o aos testes do endpoint `contents/[username]` percebo que ele n√£o est√° completo. Precisamos criar conte√∫dos com diferentes usu√°rios no mesmo teste, para testar o filtro por usu√°rio e tamb√©m precisamos testar a estrat√©gia `relevant`, pois s√≥ est√° sendo testada a `new`. Vou criar esses testes.

> O √∫nico problema, √© que fazendo isso a estrat√©gia `relevant` para de funcionar no `api/v1/contents/[username]`
> Assim toda as requests com o valor `relevant` como estrat√©gia seriam substitu√≠das pela estrat√©gia `new`

Ao desviar desse `if`, vai acabar caindo na estrat√©gia de relevantes antiga, o que acho que √© a melhor alternativa por enquanto. Mas, assim que poss√≠vel, devemos pensar em novas estrat√©gias de relevantes para esse endpoint e tamb√©m para os conte√∫dos children.
</issue_779_Bug: `/api/v1/contents/[username]` retorna todos os conte√∫dos>

<issue_781_`/publicar`: faz aparecer novamente a mensagem para usu√°rios com `0` publica√ß√µes>
## Contexto

- #779

## Execu√ß√£o

- #780
- #783
</issue_781_`/publicar`: faz aparecer novamente a mensagem para usu√°rios com `0` publica√ß√µes>

<issue_782_Criar og:image automaticamente usando a nova biblioteca da vercel>
A vercel recentemente criou uma biblioteca pra gerar imagens og automaticamente na Edge usando jsx convencional, seria muito interessante mostrar algumas informa√ß√µes como t√≠tulo, autor e upvotes.

Mais informa√ß√µes:
https://youtu.be/6rYzM_oWi7A

>> Coment√°rio de aprendendofelipe:
@coffee-is-power, o @filipedeschamps tamb√©m sugeriu isso ü§©

https://github.com/filipedeschamps/tabnews.com.br/pull/559#issuecomment-1275394144
> Talvez a gente deveria trocar toda a implementa√ß√£o de thumbnail por isso: https://vercel.com/blog/introducing-vercel-og-image-generation-fast-dynamic-social-card-images

>> Coment√°rio de coffeeispower:
Alguma novidade aqui? @filipedeschamps @aprendendofelipe

>> Coment√°rio de ErickCReis:
Hoje fiz uns testes com esse pacote e ele n√£o resolve todos os problemas, al√©m disso t√™m alguns detalhes que podemos discutir aqui.

1. O @vercel/og s√≥ funciona no Edge Runtime ([link](https://vercel.com/docs/concepts/functions/edge-functions/og-image-api)), e na estrutura atual da thumbnails n√£o seria poss√≠vel utiliz√°-lo pois realizamos algumas consultas no banco. Uma alternativa seria fazer um redirect depois de buscar os dados, mas n√£o sei √© uma boa op√ß√£o.

2. O suporte a CSS ainda √© um pouco limitado, e por mais que as thumbnails sejam extremamente simples, acho que ainda vamos precisar de algo assim: https://github.com/vercel/satori/issues/253

D√° para brincar no playground da Vercel, montei a estrutura b√°sica da thumbnail atual, l√° d√° pra ver como vai ficar o resultado final ([link](https://og-playground.vercel.app/?share=vVfrctpGFH4VDZ3-iqfWDTd2685gidjrsosxwhTGf4SkiBW6MEgykjx-934rhMCJ06ZpWuMB7Z772XO-s3ruOInrdS46v7r86TGWpDQrQ-_y-Vk8S5LL03VolxfSY-dj6BWPnZPdvliYfOM5GU9iQXWSMI_ilr70uL_MBEGR5R_b7S13s-Vnu2vbdXnsi_338rqQuvuvg7kkzj7YEQ9rT-6TRZIlr4hjXnkXErQ2ewvbWfmbJI9dIwmTjZD64UNXfB47guPl5TH-TTyIsL8y5k-c36mplbyp5suK2ojv90lSj4PdZRfRtOvILm7ahOryJ8xt-D-fvdqctiKLJHSPJJInb_MxTLaCtOSu6x3OTZIyr8iGRwxeGPJ1ytOWpY1ZkqwlTyX82xIESilMYl_KeBZ6kh27Es-kdJnkoSst7SdPUtSu5Cztje1k3gZisZQlmR3-JJEsleIkk7KlJyLlUR7tDdiO460zz5We7DD3TqRFngm1MFkbbK02h3CKU4Bz33QkYnm9ETHva2i3N15ueLw6nMZR-L_yqLEs_tKNc_nYce3MvuCR7Xun6ZP_rojCXxZ26p3pJ3c3TJ2XV5o9vZdtU-ZDk3JyvQztqZu4WLPA4eRmvp7_4RoLzT8nQc-nRk-nZU9lJfHnUZguwLeIzvP5mPjetZIuYnpOoqXs3vTOBuW55mpO7lY0X2i38aAiW2r2nhxtHpNA__3u5mrpXvs7PYZSutMivBvfhm70kC_U-xXhV8HiOtwO_rhVFtcT6H1Q59Pu0_x6BD9H52Qla9TQK1aNVGL2cjahGiv1kpqrql6P4SvXNWauQJ_l1Bxt8ewPTZJDpst4rwBdZ9XDlFmjnFpEGVV-OQgceWjNfBb08qE16bKyd6R3pg6Cic-qXk4rR4YOlXFdGZt9yM1KZi5NNta1odUr6XhHE77QAPaqifBjOwhWytBykEsd_CuNCVuN_YdA6PE1xAI-Aj8cRdgYBD0Z_neJOYHvqy0N-kIeuvd2_Xo9Nh3IIQ_m3LYsRx7AroiFBhRy8En2Zfin0uDBZCZFDCONcuyXukZNgvhGkPcVVlHI9BG_sx2OYdvQtywYCXtd0Ctm3VJaTUAf6fBPR85e5YBaIj8jxL-jEdPPEStyAF9AY9ZKHaKWdv45yEsT98NMYYZeCP-Gho74kR_eQw50xE9L8In4ZBaInPnI6wT6cJ4iV0ZPgUzJJn5bF6PKET4pNPBbfuzvfHml95Crw1mQCr4j18xGLUb2tEjvxiRAXkpmkS7h798Zwbau5zs_Qa8deq-G5svn9-pP3Zdm9lw-n529SKd7fD6ChlfPXw__DSg3sP-NSuyQ-zHJvCith6YXAwv_wwGzU4Zp-smAeWs8Gj-b533jiAkjvSHpqm50z47lk43rbe5tl-cIpPvGLNLUz-DyI8ck8VwvxRSI1ul3wuzmSD47lH-s7C-P5m9C-3eTgFbk1SSgVe-tSVABOSpqfMdJAB2W1a_RnFbiQ3R0MLoRqBLUiFnvim6GfaDiqKJAZPADBahA6y2T6RYooQ2CPhAAKDYWKEswsYByAsUq4gPtSiqQKCBCd5fKW8gQINtMZYFLa_QyfRl7sAH0qICV4AVyYE8gc7-odQtdQkfV16Ff5KOA7i6zeho8A6rMgDQUyClsjXJMWA3TUyCYiKIEYhVAocP6Q4K8z9eL6-054VS_n_SLUTDigwo5Ms4rN3LeGf7lW0ijqQec0eQDznyh6v62Id_qtj3tqM4kyLWGXhX796_B_pdrEDX3nWsQk0nUAmrOws1BnI7si7Ot6w9TusC0a3jcacujrBkNcOZiv0QtTHzcAloZ1JJ4YqTlUWYFfYCMmIiNzHDiK009QIZgKjUyex7IDGsZTNSDzJFvxzINTytzsAPfjuwc-XZkp_ZN1Hjbd0vEiilqwZ6Mtbg5ID4WiJuRmJboufo84JOhd8GnoV-Qq6vpkQ5Cq1vcTkS_1Ts-eHc0Wdy-RE5nGuJAfvc-OeidPqa5sEGb2wn8qLtm50ONFibZ91J9e2npjX7IFwd6gzGgDw_ysD9p6Ks9vcDtb8ssB3lqbFavbwTD_sMVnRD5K24Eb_Xp_9SpinaqKKeqrDbj4rNZ16wOT7vfzkknWYvX6rRz8dyp4-hcKCpebTu7SDoXZ-r7k47rLXK_c5Ft8GLU8aIk4Fa5Fm_y2bZeQY-YWf1o4bk7tpeXPwE)).

Iniciei uns testes aqui fazendo uma implementa√ß√£o que n√£o depende do Edge Runtime, e sim da lib base para o @vercel/og -> https://github.com/vercel/satori

>> Coment√°rio de ErickCReis:
Com a implementa√ß√£o de https://github.com/vercel/satori/issues/253 foi poss√≠vel continuar essa feature -> https://github.com/filipedeschamps/tabnews.com.br/pull/1425
</issue_782_Criar og:image automaticamente usando a nova biblioteca da vercel>

<issue_784_Bug: Delay na troca de p√°gina (pagina√ß√£o)>
Ol√° Pessoal procurei alguma Issue sobre o assunto e n√£o localizei. Estou abrindo para deixar mapeado o problema sobre o delay da pagina√ß√£o, acredito que podemos adicionar um load de conte√∫do antes do carregamento, semelhante ao facebook.




https://user-images.githubusercontent.com/5334261/195657096-e2569fb4-580d-49a3-86a3-d39dca5941f4.mp4

>> Coment√°rio de aprendendofelipe:
Oi @rodrigoKulb!

Isso ocorre quando acessamos p√°ginas com cache antigo, ent√£o o `SWR` recebe conte√∫dos diferentes via API e atualiza a lista. N√£o sei se seria legal um `loading` nesse caso, pois ele ficaria aguardando o `isValidating` mesmo quando n√£o houvesse nenhuma diferen√ßa entre a vers√£o est√°tica da p√°gina e os dados da API. Ent√£o pode piorar a experi√™ncia.

Mas seria interessante alguma estrat√©gia para diminuir a ocorr√™ncia desse efeito. Por exemplo, se o efeito ocorreu na p√°gina que estou visitando, √© um ind√≠cio muito forte de que a p√°gina seguinte tamb√©m est√° desatualizada, ent√£o podemos j√° for√ßar a revalida√ß√£o da pr√≥xima p√°gina antes de navegar para ela. S√≥ n√£o tem como evitar totalmente esse efeito, pois os dados sempre podem mudar entre uma navega√ß√£o e outra.

Nesse problema o `prefetch` do `Next.js` n√£o nos ajuda, pois ele busca a vers√£o em cache da p√°gina, mesmo que ela esteja `stale`. Mas podemos usar o `onSuccess` do `SWR` para comparar os dados est√°ticos com os obtidos da API. Se os dados forem diferentes, ent√£o podemos disparar a atualiza√ß√£o da pr√≥xima p√°gina de uma dessas maneiras:

1. Usar o `mutate` do `SWR` passando a pr√≥xima p√°gina como `key`. Assim, ao navegar para a pr√≥xima p√°gina, o `SWR` j√° ter√° os dados mais atuais em cache.
2. Fazer uma chamada para um endpoint que atualiza a pr√≥xima p√°gina utilizando a revalida√ß√£o sob demanda do `Next.js`.

O que acham? Algu√©m tem outra sugest√£o?

>> Coment√°rio de rodrigoKulb:
> 1. Usar o mutate do SWR passando a pr√≥xima p√°gina como key. Assim, ao navegar para a pr√≥xima p√°gina, o SWR j√° ter√° os dados mais atuais em cache.

Perfeito super acho v√°lido sua sugest√£o! Esses dias eu entrei no elevador navegando pelo reels do instagram e percebi que ele faz um pre-load do inicio dos 5 pr√≥ximos reels antes de mudar.

Como hoje a navega√ß√£o do tabnews s√≥ temos uma op√ß√£o de passar para a pr√≥xima p√°gina, vai resolver o problema!

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe estava pensando e dependendo do tempo de leitura das not√≠cias talvez o problema vai continuar.

Uma boa op√ß√£o de **gatilho** para a chamada do pr√©-load poderia ser quando o link "Pr√≥ximo >" ficar vis√≠vel na tela do usu√°rio.

O que acha?

>> Coment√°rio de aprendendofelipe:
> Uma boa op√ß√£o de **gatilho** para a chamada do pr√©-load poderia ser quando o link "Pr√≥ximo >" ficar vis√≠vel na tela do usu√°rio.

Boa! üëç

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe pensando ainda mais vejo uma outra **problem√°tica** futura:

Imagine quando o site estiver com muitos acessos, v√°rias pessoas dando up ou down nas postagens, pelo que eu verifiquei a tabela de ordem e novas postagens √© atualizada em **tempo real**, o usu√°rio praticamente n√£o vai conseguir ler a postagem devido a altera√ß√£o de ordem descontrolada do sistema.

Acho que podemos pensar em trabalhar com um tempo de refresh, talvez o correto n√£o seria alterar a ordem e sim deixar a ordem carregada inicialmente por um tempo determinado, para facilitar a leitura do usu√°rio.

O que √© mais importante aqui ter a ordem em segundos atualizada, ou um conte√∫do fixado para facilitar a leitura dos usu√°rios? 

![Captura de tela em 2022-10-14 23-05-36](https://user-images.githubusercontent.com/5334261/195964168-0d10d92d-7c16-4431-b971-0f20df550829.gif)

>> Coment√°rio de aprendendofelipe:
No backend √© em tempo real, mas no client n√£o. O SWR s√≥ est√° configurado para atualizar a lista de conte√∫dos em 3 situa√ß√µes: no carregamento da p√°gina, quando ela entra novamente em foco e quando cair e voltar a conex√£o de rede.

N√£o √© o seu script que est√° for√ßando essa atualiza√ß√£o?

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe ahh ent√£o √© isso eu tive que sair e voltar no **foco** da p√°gina para cadastrar e ver novamente.
</issue_784_Bug: Delay na troca de p√°gina (pagina√ß√£o)>

<issue_787_Duplicidade de postagens>
Issue aberta para pensarmos em uma solu√ß√£o para evitar duplicidade ou uma consulta

discuss√£o iniciada nessa postagem.
https://www.tabnews.com.br/amaraldr/duvida-existe-algo-pensado-para-evitar-a-duplicidade-de-informacoes

>> Coment√°rio de faagner7:
Ol√°, meu primeiro coment√°rio aqui no repo.

Minha sugest√£o √© que para al√©m de algo "inteligente" que fa√ßa uma valida√ß√£o na hora de criar uma publica√ß√£o, √© que tamb√©m criemos uma forma de um usu√°rio reportar uma "duplicidade" ou at√© mesmo algo similar ao que existe nas issues do github, onde encerra uma e linka a outra.

>> Coment√°rio de Rafatcb:
O Hacker News tem uma funcionalidade que me parece interessante para o cen√°rio do TabNews, j√° que s√£o plataformas parecidas.

O moderador pode marcar uma publica√ß√£o como duplicada de outra, e deixa um coment√°rio com o link para a principal, movendo todos os coment√°rios existentes para l√°. Dessa forma √© poss√≠vel concentrar a discuss√£o num √∫nico lugar, ao inv√©s de dividir em duas publica√ß√µes, mesmo que os links das fontes sejam diferentes.

Um exemplo: no Hacker News, a publica√ß√£o [_Gemini: Google's most capable AI model yet_](https://news.ycombinator.com/item?id=38544746), com fonte do Blog da Google, foi marcada como duplicada de [_Gemini AI_](https://news.ycombinator.com/item?id=38544729), com fonte da p√°gina da IA, tendo um coment√°rio (o primeiro) mostrando o link da outra fonte e dizendo que as discuss√µes foram mescladas.

Ent√£o, sumarizando essa observa√ß√£o com minha opini√£o, creio que essa funcionalidade pode ser assim:

1. O moderador poder marcar a publica√ß√£o como duplicada de outra publica√ß√£o.
2. Mostrar na interface que ela √© duplicada e o link de onde est√° concentrada a discuss√£o.
3. O autor da duplicada n√£o perde os TabCoins ganhos.
4. A publica√ß√£o duplicada n√£o aceita mais coment√°rios.
5. Por termos um "corpo" na publica√ß√£o (o que o Hacker News n√£o tem), o corpo pode virar um coment√°rio na outra publica√ß√£o, mas considerando que as duplicadas geralmente ser√£o not√≠cias, parece-me que isso far√° sentido em na minoria dos casos.

Com a quantidade de publica√ß√µes duplicadas que vejo hoje (quase nenhuma), diria que esse issue tem prioridade baixa, mas se algu√©m quiser implementar, pode ser √∫til. Precisamos de mais discuss√£o, at√© para ficar bem claro o que poderia ser considerado duplicado ou n√£o.

>> Coment√°rio de aprendendofelipe:
Uma solu√ß√£o simples, a la TabNews, seria apenas setar o `parent_id` da publica√ß√£o duplicada com o id da publica√ß√£o principal. 

Ent√£o ela, e todos os coment√°rios, virariam uma nova thread na publica√ß√£o principal.

Seria algo bem simples de implementar, pois bastaria atualizar o `parent_id` dessa publica√ß√£o e a coluna `path` de todos dessa √°rvore. E sobra a d√∫vida sobre o que fazer com o t√≠tulo, mas acho que podemos mudar a interface para quando um coment√°rio tiver o campo t√≠tulo preenchido, mostrar o t√≠tulo da mesma forma que um t√≠tulo presente no markdown (com `#`).

S√≥ que antes dessa implementa√ß√£o, precisamos melhorar o que acontece quando novas intera√ß√µes ocorrem em publica√ß√µes antigas, pois hoje elas j√° voltam para o ranking de relevantes se atenderem aos requisitos, mas os novos coment√°rios deveriam ganhar um destaque maior do que a `rankContentListByRelevance()` faz atualmente. Talvez deixar o `boostPeriodInMilliseconds` n√£o mais com um valor constante, mas com alguma fra√ß√£o do tempo decorrido desde a publica√ß√£o do `root` ou do `parent`.
</issue_787_Duplicidade de postagens>

<issue_788_Apresentar Spinner (Loading) no bot√£o de Publicar/Atualizar>
Hoje j√° existe uma funcionalidade de desabilitar o bot√£o caso o mesmo esteja com o estado de `isPosting` como true.
Por√©m, ontem ao realizar uma publica√ß√£o a minha conex√£o estava lenta e pensei que havia acontecido algum BUG para meu conte√∫do n√£o ter sido de fato enviado.

 Ent√£o gostaria de saber se mais pessoas pensam ou j√° pensaram em algo para melhor ainda mais a usabilidade/feedbacks visuais durante uma publica√ß√£o.

Edit.: Tamb√©m percebi que o `aria-label` fica somente como "Publicar" (mesmo se estiver atualizando) e o cursor do mouse n√£o √© modificado para `not-allowed`.

>> Coment√°rio de Rafatcb:
[Nesse artigo](https://uxmovement.com/buttons/when-you-need-to-show-a-buttons-loading-state/) tem algumas orienta√ß√µes para fazer um estado de _loading_ para o bot√£o.

![O √≠cone de progresso deve estar dentro do bot√£o, o bot√£o deve estar desabilitado (sem mudar a cor, apenas "mais transparente") e continuar com o texto](https://uxmovement.com/wp-content/uploads/2019/08/progress_button-practices.png)

No artigo dizem para usar em a√ß√µes que demoram mais do que dois segundos, mas n√£o vejo problemas em a√ß√µes mais r√°pidas (n√£o sou UX):

> To prevent these errors, you need to use progress buttons on operations that take longer than two seconds. A [research study](https://www.akamai.com/us/en/about/news/press/2009-press/akamai-reveals-2-seconds-as-the-new-threshold-of-acceptability-for-ecommerce-web-page-response-times.jsp) found that users expect pages to load in two seconds or less, and become impatient when it takes longer.
>
> A progress button gives users a visual cue that indicates a loading state. When users see a process taking place, they‚Äôre less likely to press the button again. It‚Äôs crucial to ensure no action errors occur by disabling the button when it‚Äôs in progress.

>> Coment√°rio de bernardoeuler:
Ol√° pessoal, nesse PR que o @aprendendofelipe mencionou acima eu estou desenvolvendo essa solu√ß√£o para dar um feedback para o usu√°rio de que sua a√ß√£o ao clicar num bot√£o est√° sendo processada.

N√£o sei se isso j√° est√° em desenvolvimento  por aqui, mas gostaria da opini√£o de voc√™s em rela√ß√£o a implementa√ß√£o.

Queria saber se durante o carregamento √© melhor manter somente o spinner no bot√£o  (e retirar o texto)¬π ou manter os dois simult√¢neamente¬≤, e talvez trocar para uma palavra que indique continuidade e p√¥r retic√™ncias (ex: Cadastrando..., Enviando... e etc.).

### Imagens 
Imagem 1:
![images.jpeg](https://user-images.githubusercontent.com/77172676/209735945-4c19c186-e368-4edd-b54e-2594fd694034.jpeg)

Imagem 2:
![images.png](https://user-images.githubusercontent.com/77172676/209736043-773a24c0-9320-4ae8-9615-f6d18599c5ee.png)

>> Coment√°rio de aprendendofelipe:
Implementado no #1501 üéâ
</issue_788_Apresentar Spinner (Loading) no bot√£o de Publicar/Atualizar>

<issue_789_Erro 404 em uma nova rota `/pesquisar`>
Eu estou adicionando a feature de pesquisa de conte√∫dos nessa branch https://github.com/filipedeschamps/tabnews.com.br/tree/search-content-by-keywords.
Eu estou fazendo uma p√°gina separada para fazer um modo de pesquisa mais din√¢mico, por√©m quando crio uma rota `/pesquisar` o nextjs compila certinho s√≥ que me redireciona automaticamente para um `404`. Usei duas formas de criar a rota: `pages/pesquisar/index.public.js` e `pages/pesquisar.public.js`; Das duas formas me retornou um **404**.

Gostaria de saber se existe algum bloqueio para essa rota ou se eu preciso adicionar ela em uma esp√©cie de whitelist (n√£o sei como chamar isso)?

O componente est√° assim: 

```js
import { DefaultLayout } from "pages/interface"

export default function Search() {
  return (
    <DefaultLayout>
      Ol√° Mundo
    </DefaultLayout>
  )
}

```

>> Coment√°rio de silvaezequias:
Mudei de ideia e vou fazer de outra forma mas mesmo assim gostaria de saber o motivo desse "problema"...

>> Coment√°rio de filipedeschamps:
@ezequiaslopesdasilva eu abri sua branch e n√£o consegui localizar o arquivo da p√°gina, voc√™ alterou ela? Mas de qualquer forma, do jeito que voc√™ descreveu deveria abrir corretamente sim!

>> Coment√°rio de aprendendofelipe:
@ezequiaslopesdasilva, ser√° que n√£o foi algum erro de digita√ß√£o?

Seu componente est√° funcionando normalmente no padr√£o `pages/pesquisar/index.public.js`


![image](https://user-images.githubusercontent.com/77860630/198161882-5adc6a62-d2e7-47dc-9917-ae09c691419d.png)

>> Coment√°rio de silvaezequias:
> @ezequiaslopesdasilva eu abri sua branch e n√£o consegui localizar o arquivo da p√°gina, voc√™ alterou ela?

Eu n√£o tinha commitado essa altera√ß√£o, estava apenas em meu Codespace.

> @ezequiaslopesdasilva, ser√° que n√£o foi algum erro de digita√ß√£o?

Creio que n√£o pois eu copiei o nome do arquivo e colei na rota pra ter certeza, acho que foi algum bug de carregamento do Next mesmo, criei um novo codespace aqui no github e tentei rodar esse componente e funcionou corretamente.
E muito obrigado por testar pra mim, j√° tinha desistido.

>> Coment√°rio de filipedeschamps:
Um detalhe que eu tomaria cuidado com o Codespace aqui do GitHub √© que na configura√ß√£o padr√£o de mem√≥ria dele, ele come√ßa a fechar o processo do Next por estourar o limite de mem√≥ria.

>> Coment√°rio de silvaezequias:
@filipedeschamps partir para o Gitpod adiantaria em alguma coisa ou √© o mesmo sistema?

>> Coment√°rio de aprendendofelipe:
No Gitpod eu n√£o tenho esses problemas
</issue_789_Erro 404 em uma nova rota `/pesquisar`>

<issue_790_Sugest√£o para Editor de publica√ß√£o>
Estava olhando o editor queria da uma sugest√£o poderia utilizar o @facebook/draftjs vir que ele tem milhares de funcionalidades bem legal vir que est√° sendo utilizado @bytemd.

>> Coment√°rio de silvaezequias:
Mas pelo que est√° escrito no reposit√≥rio deles: https://github.com/facebook/draft-js#status est√° em MANUTEN√á√ÇO e a partir do dia 31 ser√° arquivado o reposit√≥rio. Eles tamb√©m falaram que a Meta est√° migrando para um novo framework e √© o mesmo que eles recomendam para quem quer esse servi√ßo opensource, o [Lexical](https://github.com/facebook/lexical). Ainda est√° em fase Experimental mas tem suporte ativo.

>> Coment√°rio de filipedeschamps:
Show! Uma outra alternativa que talvez se encaixe melhor dado que usamos o Primer do GitHub √© acompanhar o componente oficial deles: https://primer.style/react/drafts/MarkdownEditor

>> Coment√°rio de gabrielmelodev:
Tbm vir que tem o Quill e um √≥timo editor de texto.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas sugest√µes! üí™

As mais promissoras s√£o as do GitHub e do Facebook, e j√° est√£o documentadas na [issue mais antiga](https://github.com/filipedeschamps/tabnews.com.br/issues/648), ent√£o vou fechar essa aqui para concentrarmos a discuss√£o por l√°. üëçü§ù
</issue_790_Sugest√£o para Editor de publica√ß√£o>

<issue_791_Alterar o layout padr√£o das p√°ginas>
### Contexto
Estou trabalhando na implementa√ß√£o de pesquisa no TabNews: https://github.com/filipedeschamps/tabnews.com.br/tree/search-content-by-keywords.
Essa implementa√ß√£o vai alterar um pouco o layout default das p√°ginas e por isso eu fiz uma representa√ß√£o de como seria (na minha opini√£o) a melhor forma de implementar isso mantendo o principio de simplicidade do TabNews e sem alterar MUITA coisa no layout:

![Homepage 2.0](https://user-images.githubusercontent.com/63757378/198235290-b52134d4-db9a-4560-b1d7-e783ca557a2e.svg)

Essa √© uma vers√£o com o NavBar light
![Homepage with light navbar](https://user-images.githubusercontent.com/63757378/198237077-fed85946-6ae0-4954-a660-7cbf03d40e26.svg)

O que acham desse layout? Isso √© apenas um esquema feito no Figma, n√£o est√° em c√≥digo ainda. N√£o implementei responsividade usando esse layout ainda.

N√£o espero que esse seja o layout final mas que pelo menos ajude com ideias e possibilidades!

>> Coment√°rio de silvaezequias:
Se quiser manter a forma atual do header e footer, fica assim: 

![Default Homepage with search inputs](https://user-images.githubusercontent.com/63757378/198307421-b79780af-a257-490d-8957-0cc739803804.svg)
![Default Homepage with search inputs - navbar light](https://user-images.githubusercontent.com/63757378/198307409-a1221ccf-f9d9-4b51-9f8e-0ad1f7f20c09.svg)

>> Coment√°rio de Jeiel0rbit:
> ### Contexto
> Estou trabalhando na implementa√ß√£o de pesquisa no TabNews: https://github.com/filipedeschamps/tabnews.com.br/tree/search-content-by-keywords.
> Essa implementa√ß√£o vai alterar um pouco o layout default das p√°ginas e por isso eu fiz uma representa√ß√£o de como seria (na minha opini√£o) a melhor forma de implementar isso mantendo o principio de simplicidade do TabNews e sem alterar MUITA coisa no layout:
[...]

Ficou top. Concordo que seja simples, mas eficaz.

>> Coment√°rio de Rafatcb:
Como o TabNews j√° implementou o mecanismo de busca, e conseguiu deixar no pr√≥prio header, acho que podemos fechar esse issue, certo?

Imagem de como est√° atualmente para refer√™ncia:

![TabNews](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/8abceed7-5292-4129-a7e2-1f18f56b56c4)

Acess√≠vel pelo Web Archive: https://web.archive.org/web/20231107213341/https://tabnews.com.br/

>> Coment√°rio de aprendendofelipe:
@silvaezequias, muito obrigado pela sugest√£o de layout! üí™

Pelo baixo volume de utiliza√ß√£o da barra de busca dentro do pr√≥prio site (irris√≥rio se comparado com a busca diretamente no Google), no momento n√£o vale a pena investir em um sistema de busca pr√≥prio mais elaborado.

E sem um sistema mais elaborado, n√£o vale a pena ocupar tanto espa√ßo da Home com a barra de pesquisa simples que temos dispon√≠vel.

Como a issue √© especificamente sobre o layout, por enquanto estou fechando como "n√£o planejado". ü§ù
</issue_791_Alterar o layout padr√£o das p√°ginas>

<issue_793_Endpoints>
Opa, fala turma!
Como ainda estamos no processo de cria√ß√£o das docs do tabnews, algu√©m tem e poderia disponibilizar uma collection do postman e/ou insomnia ou quem sabe at√© um swagger para os membros que n√£o tem tanta experi√™ncia com backend para "buscar os endpoints na m√£o"? E quem sabe at√© usar desse recurso para contribuir pra constru√ß√£o da pr√≥pria doc futuramente... ü§©

>> Coment√°rio de gabrielsozinho:
Voc√™ quer uma lista com os endpoints? Talvez isso aqui possa te ajudar: [https://www.tabnews.com.br/GabrielSozinho/documentacao-da-api-do-tabnews](https://www.tabnews.com.br/GabrielSozinho/documentacao-da-api-do-tabnews)

>> Coment√°rio de DanielJ06:
Opa, muito massa @gabrielsozinho ! Inclusive tenho seu post salvo pra usar como base hehe. Mas como √© de 3 meses atr√°s n√£o sabia se estava up-to-date, mas vlw

>> Coment√°rio de Rafatcb:
Vale mencionar que existe um issue para cria√ß√£o de documenta√ß√£o da API: https://github.com/filipedeschamps/tabnews.com.br/issues/555
</issue_793_Endpoints>

<issue_795_Atualiza Next.js para vers√£o 13 (junto com outros m√≥dulos) e habilita Analytics>
## Contexto e Execu√ß√£o

- #792
- #794
</issue_795_Atualiza Next.js para vers√£o 13 (junto com outros m√≥dulos) e habilita Analytics>

<issue_796_[Feature request] - Create dynamic sitemaps>
Boost the website SEO with sitemaps, since we're creating multiple pages would be nice to use [Sitemaps](https://developers.google.com/search/docs/crawling-indexing/sitemaps/build-sitemap). 
It work really well with RSS feeds.

Recommended library:
https://www.npmjs.com/package/next-sitemap

>> Coment√°rio de aprendendofelipe:
Considerando que [um feed rss pode ser usado como sitemap](https://developers.google.com/search/docs/crawling-indexing/sitemaps/build-sitemap?hl=pt-br#rss), acabo de adicionar nosso feed no Google Search Console:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/761c176f-3ca2-42f2-b047-35750d0b9e69)

>> Coment√°rio de Rafatcb:
@aprendendofelipe como ficou o resultado no Google Search Console nessas duas semanas? Resolveu o problema e podemos fechar o issue?

>> Coment√°rio de aprendendofelipe:
Acredito que podemos fechar, pois a indexa√ß√£o das novas publica√ß√µes est√° ocorrendo bem r√°pido.

N√£o d√° para saber exatamente de quanto em quanto tempo o Google verifica o feed, mas publica√ß√µes com menos de 1 hora j√° aparecem na busca, ent√£o isso nos atende bem enquanto n√£o chegarmos em um volume de mais de 30 publica√ß√µes raiz por hora.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/e0ee37d9-a638-405e-af70-fce234c1c64a)

Fechando a issue. ü§ù

Obrigado @r3nanp e @Rafatcb! üí™
</issue_796_[Feature request] - Create dynamic sitemaps>

<issue_798_Criar documenta√ß√£o usando OpenAPI e Redoc>
A Api do tabnews est√° estavel o suficiente a essa altura do campeonato, eu considero a documenta√ß√£o da API algo critico para o lan√ßamento. Com OpenAPI e redoc √© facil de documentar a api, basta servir o arquivo do open api e um arquivo html, e o redoc vai montar a interface no navegador. Claro, √© preciso manter o arquivo yml para bater com a api real, mas da muito menos trabalho do que refazer a interface inteira.

>> Coment√°rio de aprendendofelipe:
@coffee-is-power, obrigado pela sugest√£o! üí™

Vou fechar essa issue e podemos centralizar a conversa na #555 que √© mais antiga. Combinado? ü§ù
</issue_798_Criar documenta√ß√£o usando OpenAPI e Redoc>

<issue_801_Atualizar as TabCoins e o TabCash junto com o refresh autom√°tico da home>
Hoje navegando pelo TabNews percebi um coportamento que n√£o esperava. Eu deixo sempre uma aba fixa do TabNews no navegador, pois como as not√≠cias sofrem um refresh a cada 30 segundos, acho interessante acompanhar dessa forma.

Estava lendo uma not√≠cia numa outra aba e acabei interagindo com o post. Voltei a aba fixa do TabNews e as not√≠cias atualizaram como o esperado, mas o TabCash e as TabCoins permeneceram iguais. Os n√∫meros s√≥ mudaram quando foi realmente feito um refresh (F5) na p√°gina.

Pelo que vi no c√≥digo, o hook useUser √© chamado no componente Header e ele seta as informa√ß√µes de TabCash e TabCoins no localStorage. Mas quando a home tem o seu refresh feito automaticamente, ele n√£o gera um re-render no Header, portanto, o dados permanecem os mesmos.

Na sequ√™ncia tenho duas prints para exemplificar:

1) Abri esse post numa nova aba. Por consequ√™ncia, o Header foi renderizado e o TabCash e as TabCoins foram mostradas corretamente
![nova aba](https://user-images.githubusercontent.com/83674797/200080274-25889e3e-796c-454d-baf7-6352cd5db788.png)

2) Voltei para a home do TabNews. Aqui o localStorage encontra-se atualizado, por√©m como o Header n√£o foi re-renderizado, o TabCash e as TabCoins permanecem iguais
![home](https://user-images.githubusercontent.com/83674797/200080272-990b50ea-f369-417b-b470-cd5d85830556.png)

Acredito que se o refresh autom√°tico da home chamar o hook useUser junto, j√° resolveriamos este problema.

>> Coment√°rio de aprendendofelipe:
Boa @ottomicheletti, isso era algo que eu j√° queria ter feito.

Na verdade os conte√∫dos n√£o s√£o atualizados em um intervalo de tempo fixo, mas sim quando a aba entra em foco. Ent√£o no PR #804 eu fa√ßo a sincroniza√ß√£o dos dados entre as abas ocorrer tamb√©m ao entrar em foco. Assim qualquer intera√ß√£o que ocorrer em uma aba ir√° refletir em qualquer outra que entrar em foco.

E, al√©m disso, como podem ocorrer intera√ß√µes em outros dispositivos, se passar de 10 minutos desde a √∫ltima atualiza√ß√£o via API, uma nova chamada ir√° ocorrer quando a aba entrar em foco.

>> Coment√°rio de ottomicheletti:
Muito massa @aprendendofelipe! 

Obrigado por me ensinar mais algo que n√£o sabia! Bacana pensar tamb√©m nessa intera√ß√£o de outros dispositivos concomitantemente! üöÄ üöÄ
</issue_801_Atualizar as TabCoins e o TabCash junto com o refresh autom√°tico da home>

<issue_806_Mostra as respostas feitas por um usu√°rio na sua p√°gina exclusiva>
## Contexto e Execu√ß√£o

- #747 
- #805
</issue_806_Mostra as respostas feitas por um usu√°rio na sua p√°gina exclusiva>

<issue_807_Filtrar os conte√∫dos root e child exibidos na p√°gina do usu√°rio>
## Contexto

O merge da PR #805 viabilizou a visualiza√ß√£o dos conte√∫dos `child` do usu√°rio em sua pr√≥pria p√°gina, com isso, agora temos 2 tipos de conte√∫dos na p√°gina de usu√°rios, sendo eles: `root` e `child`, como usu√°rio do Tabnews eu ficaria bastante satisfeito se houvesse a possibilidade de filtrar esses conte√∫dos.

O que voc√™s acham?

>> Coment√°rio de Rafatcb:
Prefiro como voc√™ sugeriu. Para mim, n√£o √© √∫til ver ambos ao mesmo tempo, fica at√© mais dif√≠cil de encontrar o que estou procurando. Faria mais sentido ter duas tabs:

* **Publica√ß√µes** (ou algum outro nome; conte√∫do `root`, selecionado por padr√£o)
* **Coment√°rios** (ou "respostas"; conte√∫do `child`)

Falando nisso, tem lugar que o conte√∫do `child` √© chamado de **coment√°rio**, e lugar que √© chamado de **resposta**. Seria interessante padronizar isso tamb√©m.

PS: N√£o necessariamente precisam ser "tabs", mas √© o que veio na minha cabe√ßa agora.

>> Coment√°rio de guilherssousa:
> Falando nisso, tem lugar que o conte√∫do `child` √© chamado de **coment√°rio**, e lugar que √© chamado de **resposta**. Seria interessante padronizar isso tamb√©m.

Coment√°rio seria mais que suficiente para categorizar esses dois, afinal, uma resposta a um coment√°rio √© um coment√°rio, n√£o?

>> Coment√°rio de aprendendofelipe:
@ermesonqueiroz, obrigado pela sugest√£o! üí™

No PR #1413 estamos centralizando os dados sobre conte√∫dos em um √∫nico endpoint, e a maneira que foi feita permite filtrar por conte√∫dos raiz e/ou coment√°rios, ent√£o ap√≥s esse PR ser√° poss√≠vel implementar essa funcionalidade no front-end üëç

>> Coment√°rio de aprendendofelipe:
Como acaba de ocorrer o merge do PR #1188 do @ErickCReis, j√° √© poss√≠vel consultar pela API de forma separada atrav√©s dos par√¢metros `with_root` e `with_children`.

Para n√£o quebrar os sistemas que utilizam a API atualmente, o endpoint `/api/v1/contents/[username]` continua retornando por padr√£o os dois tipos de publica√ß√µes, pois o valor padr√£o √© `true` para os dois par√¢metros.

Ent√£o basta passar `false` para qualquer um deles para obter apenas o outro tipo de conte√∫do. No exemplo abaixo s√≥ ser√£o retornados os conte√∫dos `root` do @filipedeschamps:

https://www.tabnews.com.br/api/v1/contents/filipedeschamps?with_children=false

A vers√£o frontend ainda precisa de implementa√ß√£o, mas como a ideia parece estar bem avan√ßada, isso n√£o deve demorar üéâ
</issue_807_Filtrar os conte√∫dos root e child exibidos na p√°gina do usu√°rio>

<issue_808_[Bug] Mensagem de conte√∫do deletado √© carregada por onde voc√™ navegar>
Na #745 foi corrigido um problema semelhante a esse
Em resumo, a mensagem "Conte√∫do apagado com sucesso" continua a existir ap√≥s sair da pagina da resposta.

V√≠deo mostrando o problema:
https://user-images.githubusercontent.com/50342600/200961050-7122e7c1-a2dc-46c8-b920-dca1b9e73404.mp4

Passos para reproduzir:

1. Crie uma resposta
2. Navegue at√© a pagina da resposta
3. Delete a resposta
4. Volte ao conte√∫do original pelo link que tem na pagina da resposta.

>> Coment√°rio de aprendendofelipe:
Boa @33gustavo33! Resolvido no #809
</issue_808_[Bug] Mensagem de conte√∫do deletado √© carregada por onde voc√™ navegar>

<issue_810_Lan√ßamento Oficial do TabNews üéâ üéâ üéâ>
Pe√ßo que leiam essa publica√ß√£o: https://www.tabnews.com.br/filipedeschamps/lancamento-oficial-do-tabnews

Vai acontecer turma ü§ù
</issue_810_Lan√ßamento Oficial do TabNews üéâ üéâ üéâ>

<issue_813_Criar bot√£o para compartilhar o conte√∫do>
A ideia seria criar um bot√£o de copiar, assim copiando o titulo do post e o link que leva direto para o post. Segue abaixo como ficaria o texto para ser copiado.

`Canad√° quer atrair 1,4 milh√£o de imigrantes at√© 2025. Essa not√≠cia saiu no TabNews (e voc√™ ganha TabCoins comentando l√°): https://www.tabnews.com.br/felipsbreno/canada-quer-atrair-1-4-milhao-de-imigrantes-ate-2025`

A ideia veio desse [coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/pull/814#issuecomment-1317563567) no antigo PR.

>> Coment√°rio de felipsbreno:
#875

>> Coment√°rio de Poveii:
Hummm, eu acho que eu peguei a ideia. Seria como o bot√£o de compartilhar s√≥ que com mais informa√ß√µes al√©m do link?

![compartilhar-button](https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/fda3a465-5b80-472d-bea8-2dc19de9bfaf)

Faz sentido um bot√£o? Vejo que no celular √© bem dif√≠cil, ainda mais em um PWA (atalho) do tabnews com o Google Chrome, pegar o link para compartilhar o post.

> Edit: Percebi que o texto que mostra a data de publica√ß√£o do post, √© um link para o pr√≥prio post, no celular √© s√≥ segurar e copiar. Mas eu vejo que ainda √© necess√°rio algo mais amig√°vel no mobile.

E complementando, essa issue (#1398) pode ajudar a desenvolver essa ideia, s√≥ for isso mesmo kkkkkkk.

>> Coment√°rio de Rafatcb:
Acho que a exist√™ncia de um bot√£o para copiar o link / compartilhar ser√° bastante √∫til, principalmente no mobile.

Para concentrar a discuss√£o nesse issue, vou citar aqui a sugest√£o de usar o menu "Compartilhar" do pr√≥prio dispositivo, feita pelo @eduardofaria (https://github.com/filipedeschamps/tabnews.com.br/issues/1398#issuecomment-1531625997):

> Existe uma API que permite abrir o menu nativo do sistema para compartilhar. Acredito que poderia estar embutido nesse "bot√£o" que mencionou. Se fosse apenas para copiar o link, deveria haver uma mensagem de "link copiado", e o usu√°rio se encarregaria de ir no aplicativo desejado e usar esse dado. Ou, implementar essa API, ex:
>
> Fonte 1: https://w3c.github.io/web-share/
> Fonte 2: https://css-tricks.com/how-to-use-the-web-share-api/
>
> ```
> shareButton.addEventListener('click', event => {
>   if (navigator.share) {
>     navigator.share({
>       title: 'WebShare API Demo',
>       url: 'https://codepen.io/ayoisaiah/pen/YbNazJ'
>     }).then(() => {
>       console.log('Thanks for sharing!');
>     })
>     .catch(console.error);
>   } else {
>     shareDialog.classList.add('is-open');
>   }
> })
> ```

>> Coment√°rio de Jeiel0rbit:
@aprendendofelipe essa `issue` dever√° permanecer aberta com rela√ß√£o a #1900 ?

Vejo que isso foi em 2022.

>> Coment√°rio de aprendendofelipe:
Implementado em #1900 üöÄ
</issue_813_Criar bot√£o para compartilhar o conte√∫do>

<issue_815_[bug + ou -] espa√ßamento no bot√£o receber notifica√ß√µes na pagina de perfil>
![image](https://user-images.githubusercontent.com/83033666/201414986-db7d6f48-529a-4597-9cfd-29e80b78aea0.png)
</issue_815_[bug + ou -] espa√ßamento no bot√£o receber notifica√ß√µes na pagina de perfil>

<issue_820_Bug estranho entre o `DefaultHead()` e `Head()` no componente `Head`>
Estou usando o core do TabNews na plataforma do curso e notei que o t√≠tulo da p√°gina alterava entre o t√≠tulo customizado enviado pelo `metadata` e o t√≠tulo padr√£o do `DefaultHead()`. A sequ√™ncia do comportamento √©:

1. O HTML enviado do backend possui o `title` customizado.
2. Logo depois da p√°gina abrir, o `title` continuava customizado.
3. Depois do React rodar, o `title` da p√°gina √© alterado para o que est√° dentro do `DefaultHead()`.

Eu n√£o consigo reproduzir isso na code base do TabNews, mas eu queria deixar registrado isso aqui para uma pesquisa futura. O que eu entendi at√© ent√£o √© que pode estar acontecendo algum race condition entre isso daqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/3fca4f312c1b3061a09a6b33567adc68619defc7/pages/_app.public.js#L19

E depois isso aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/3fca4f312c1b3061a09a6b33567adc68619defc7/pages/interface/components/DefaultLayout/index.js#L7

No caso da plataforma do curso, por algum motivo que eu n√£o consegui entender, parece que primeiro est√° sendo carregado o `Head()` (que recebe o `title` customizado) para depois carregar o `DefaultHead()` e sobrescrever tudo. Tanto que se eu coloco um `console.log()` no topo de cada fun√ß√£o, ele registra isso:

<img width="107" alt="image" src="https://user-images.githubusercontent.com/4248081/202290652-542427f2-2d93-4cb6-af93-1eb6bc2f0107.png">

J√° se eu rodar localmente o TabNews e abrir uma publica√ß√£o, ele mostra isso:

<img width="105" alt="image" src="https://user-images.githubusercontent.com/4248081/202291255-e355594b-073b-4724-854b-16d6c727bc1a.png">

Esse problema n√£o √© urgente e aqui na plataforma do curso vou consolidar tudo no `DefaultHead()`, mas queria repescar isso no futuro, pois √© um comportamento estranho ü§ù

>> Coment√°rio de aprendendofelipe:
Isso pode estar acontecendo se existir algum objeto dentro de `DefaultHead()` que se altera ap√≥s o *render* (ou que o React.js considere como algo que mudou). Isso pode estar causando essa atualiza√ß√£o extra do `DefaultHead()`.

Todas as meta tags que tem a mesma `key` em `DefaultHead()` e `Head()` ir√£o assumir o valor do √∫ltimo que for executado.

> aqui na plataforma do curso vou consolidar tudo no `DefaultHead()`

Como o `DefaultHead()` fica dentro de `_app`, a ideia √© passar para ele apenas os valores padronizados. E tudo que exigir dados vindos do banco precisa ser passado para o `Head()` que est√° presente no arquivo de cada rota e pode receber valores via, por exemplo, `getStaticProps` ou `API`.
</issue_820_Bug estranho entre o `DefaultHead()` e `Head()` no componente `Head`>

<issue_822_[Sugest√£o] Criar extens√£o para o Tabnews>
Atualmente uso a extens√£o `daily.dev`, onde s√£o mostrados alguns cards com links para artigos. Seria muito interessante ter uma extens√£o de nova aba para o Tabnews.

Eu nunca desenvolvi uma extens√£o, mas aceito o desafio se a ideia for boa.

>> Coment√°rio de felipsbreno:
@lucasoliveiracruz gostei da ideia, pode ser uma boa!

J√° tive uma breve experi√™ncia desenvolvendo uma extens√£o pro navegador, se quiser ajuda estou a√≠.

>> Coment√°rio de netomarchiori:
@lucasoliveiracruz @felipsbreno uma outra op√ß√£o (talvez mais simples) √© conversar com o pessoal do daily.dev para que listem o Tabnews como uma fonte de not√≠cia. 

Imagino que seria t√£o simples quanto expor um endpoint para eles em um determinado formato.

>> Coment√°rio de brunofamiliar:
E ai pessoal, tudo bem? Ando beeem sumido aqui do projeto. @lucasoliveiracruz , no in√≠cio do projeto eu j√° havia criado a estrutura inicial para extens√£o. Tive a ideia tamb√©m baseado no daillydev. Caso queira continua o projeto, recomendo analisar esse PR #13

>> Coment√°rio de gabrielsozinho:
N√£o √© exatamente como voc√™ falou, mas criaram uma extens√£o do TabNews: [(link)](https://github.com/agjunior/tabnews-browser).

Essa extens√£o envia notifica√ß√µes a cada artigo novo no TabNews. Se voc√™ criar uma nova extens√£o para novas abas, talvez fosse interessante de ter a op√ß√£o de receber as notifica√ß√µes nesse mesmo sistema. (√© s√≥ uma sugest√£o)

>> Coment√°rio de Joao620:
Gostaria de adicionar aqui que o tabnews j√° possui um feed RSS para os posts recentes [aqui](https://www.tabnews.com.br/recentes/rss). E pode ser que j√° exista uma extens√£o que notifica sempre que esse feed muda, o meu s√≥ aparece o n√∫mero de mensagens n√£o lidas aumentando

>> Coment√°rio de coffeeispower:
@Joao620 sim eu fiz isso, foi a minha primeira contribui√ß√£o aqui no tabnews :)

>> Coment√°rio de brunofamiliar:
Pessoal, reativei o projeto que mecionei acima. Fiz um [post](https://www.tabnews.com.br/brunofamiliar/extensao-tabnews-para-o-chrome) explicando um pouco melhor, se puderem avaliar a ideia.

>> Coment√°rio de Rafatcb:
Extens√µes e aplicativos m√≥veis acabam saindo do escopo desse reposit√≥rio, que se limita ao site e √† API, como dito inicialmente em https://github.com/filipedeschamps/tabnews.com.br/pull/13#issuecomment-861889280 e colocado em pr√°tica com o avan√ßo do reposit√≥rio. Dito isso, a comunidade j√° fez algumas extens√µes para o TabNews, voc√™ pode ver alguns exemplos aqui:

* [brunofamiliar ‚Äî üì£ Extens√£o TabNews para o Chrome üåê](https://www.tabnews.com.br/brunofamiliar/extensao-tabnews-para-o-chrome)
* [agjunior ‚Äî Pitch: Extens√£o do TabNews para navegador](https://www.tabnews.com.br/agjunior/extensao-do-tabnews-para-navegador)
* [olavomello ‚Äî üì∞ Criei o TabNews Reader - Extens√£o para o Google Chrome](https://www.tabnews.com.br/olavomello/criei-o-tabnews-reader-extensao-para-o-google-chrome).

>> Coment√°rio de aprendendofelipe:
Turma, vou encerrar essa issue por organiza√ß√£o do reposit√≥rio üí™ü§ù
</issue_822_[Sugest√£o] Criar extens√£o para o Tabnews>

<issue_826_V√≠deo de lan√ßamento conseguiu derrubar a API (mais ou menos) ü§ù>
Tudo parece que est√° funcionando como esperado, apesar da inst√¢ncia do banco que utilizamos n√£o estar conseguindo dar conta, tanto por conta do n√∫mero alto de conex√µes abertas consumindo o **processamento**, quanto a dificuldade de conseguir responder a request dentro de **60 segundos** antes da lambda cortar a conex√£o.

A Vercel n√£o est√° marcando ainda as visitas, mas olhando diretamente os logs, o pico de acesso achatou a parte anterior do gr√°fico:

<img width="430" alt="image" src="https://user-images.githubusercontent.com/4248081/203075742-1a1c2b16-f988-497b-a1f3-ac910ed1b4f0.png">

**[edit]**

Em paralelo, para quem s√≥ est√° consumindo as p√°ginas (que s√£o est√°ticas), tudo est√° 100% üëç

>> Coment√°rio de rodrigoKulb:
Acho que realmente estamos com instabilidade no servidor devido a quantidade de acessos!

Parece que chegamos no limite da Vercel para o plano utilizado, ou do DB. Precisamos analisar os logs para achar onde foi o gargalo! Mas √© normal pelo tamanho que o Canal possui, sabia que algo assim poderia acontecer.

![Captura de tela em 2022-11-21 11-11-14](https://user-images.githubusercontent.com/5334261/203077013-65384640-c12a-4a8f-b733-9ae6f0fcce26.png)

>> Coment√°rio de devajmeireles:
![image](https://user-images.githubusercontent.com/60591772/203077532-83a72d10-903f-4f59-9481-06ee5fb4f20e.png)

N√£o consegui realizar o cadastro ... N√£o seria uma boa um sistema de OAuth para autentica√ß√£o geral? :thinking:

>> Coment√°rio de Rafatcb:
Pior que se for se basear pela p√°gina Status, o site est√° saud√°vel, com conex√µes ainda dispon√≠veis e lat√™ncia baixa:

> ### Banco de Dados
> Status: healthy
> Conex√µes dispon√≠veis: 78
> Conex√µes abertas: 46
> Lat√™ncia: 11ms 3ms 8ms
> Vers√£o do PostgreSQL: 14.3

>> Coment√°rio de JonathanArgentao:
Me deparei varias vezes com essa tela ja desde que lan√ßou, sem erro em tela, s√≥ no console

<img width="2560" alt="image" src="https://user-images.githubusercontent.com/18245871/203079247-29b5e21a-5191-4fc5-b7a8-848a4beb91ec.png">

>> Coment√°rio de filipedeschamps:
Total! Nesta visualiza√ß√£o h√° um problema, pois se o endpoint que testa o banco de dados n√£o est√° saud√°vel, ele n√£o consegue retornar. Ent√£o eventualmente s√≥ vamos conseguir ver a sa√∫de do banco de dados at√© na ultrapassagem dele n√£o estar mais saud√°vel.

Em paralelo, os alertas pela vis√£o dos logs:

![image](https://user-images.githubusercontent.com/4248081/203080285-b0839d42-cb46-4e3a-be76-f82e153fdb16.png)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps consegue acessar o status direto do banco no painel de controle? Com certeza chegamos no limite l√°!

Podemos criar uma p√°gina est√°tica explicando que o projeto est√° em fase de desenvolvimento etc... com talvez at√© um v√≠deo explicativo. Como uma SALA de espera at√© o n√∫mero de conex√µes normalizar. Vai liberando os acessos conforme o fluxo do banco.

Ou isso ou subir o plano do banco de dados üòÖÔ∏è

>> Coment√°rio de filipedeschamps:
Total! Quero avaliar subir o banco de dados total! Por que num evento de pico assim √© muita request para a inst√¢ncia m√≠nima da AWS:

<img width="1704" alt="image" src="https://user-images.githubusercontent.com/4248081/203083570-2b30c29f-5da2-4030-92c4-5c34132b1615.png">

>> Coment√°rio de rodrigoKulb:
Engra√ßado que eu n√£o consigo fazer nada mas o n√∫mero de novos cadastros n√£o para de subir üòÖÔ∏è

Olha que assunto legal para abordar em um pr√≥ximo v√≠deo do canal!

![Captura de tela em 2022-11-21 11-50-42](https://user-images.githubusercontent.com/5334261/203085146-99a058fd-539f-4095-a080-a4908fb2f2e1.png)

Parece que o **insert** funciona bem melhor que o **select** nessas situa√ß√µes.

>> Coment√°rio de filipedeschamps:
A Vercel acabou de me mandar um email:

<img width="624" alt="image" src="https://user-images.githubusercontent.com/4248081/203086828-69725926-31ae-49b0-8362-8a18631177de.png">

Imagino que isto esteja se agravando, pois a maioria das lambdas est√£o consumindo os `60` segundos de execu√ß√£o.

>> Coment√°rio de filipedeschamps:
1 milh√£o de requests dentro dos primeiros 60 minutos:

![image](https://user-images.githubusercontent.com/4248081/203087623-1efb6008-b731-4d17-b425-2aae10e84e7d.png)

>> Coment√°rio de filipedeschamps:
Por dentro da Vercel:

<img width="1224" alt="image" src="https://user-images.githubusercontent.com/4248081/203088820-30ea3d03-bdf2-4cd2-9604-fedf6fab0c36.png">

A parte que mais preocupa:

<img width="463" alt="image" src="https://user-images.githubusercontent.com/4248081/203088883-459f0f2f-cdbb-4b7f-bc57-151d159aa213.png">

>> Coment√°rio de felipsbreno:
√â, s√≥ hoje um bom n√∫mero de cadastros, estamos com 304 agora.

![image](https://user-images.githubusercontent.com/50807243/203088810-025c915c-64e6-46e3-a504-7d97db99185d.png)

>> Coment√°rio de rodrigoKulb:
Subestimou o poder do canal üòÖÔ∏è 
O conte√∫do est√°tico est√° rodando normalmente, problema √© s√≥ com o banco de dados mesmo.
‚û°Ô∏è https://www.tabnews.com.br/museu

>> Coment√°rio de filipedeschamps:
Vou come√ßar a pagar multa na Vercel üòÇ 

<img width="622" alt="image" src="https://user-images.githubusercontent.com/4248081/203091239-e7cfbcca-bd5c-4604-af41-563980fc55fa.png">

Em paralelo, o volume de requests est√° desacelerando:

<img width="1703" alt="image" src="https://user-images.githubusercontent.com/4248081/203091345-e36c2b3f-936b-42f9-9522-9b9f23b91546.png">

>> Coment√°rio de Rafatcb:
> Vou come√ßar a pagar multa na Vercel üòÇ

Esse √© o pre√ßo do conhecimento hehehe. Mas acho que essa experi√™ncia traz insights valiosos que voc√™ pode adicionar no curso! Al√©m disso, pode servir para definir uma m√©trica norte que guiar√° os pr√≥ximos passos do projeto, para continuar algo vi√°vel.

>> Coment√°rio de peterpaulodev:
Aqui rolou a falha no cadastro tamb√©m, a request foi de base!

![WhatsApp Image 2022-11-21 at 12 25 06](https://user-images.githubusercontent.com/109550332/203093480-c104ca3a-eea3-4193-b2bd-8f6d42334008.jpeg)

>> Coment√°rio de filipedeschamps:
To pensando aqui em como conseguir tirar a API do ar sem afetar muito o site, pois se ela n√£o est√° us√°vel e s√≥ gerando custos, isso √© uma situa√ß√£o ruim de se colocar.

>> Coment√°rio de felipsbreno:
Vejo que tem algumas issues sendo abertas referente ao problema que est√° sendo discutido aqui, n√£o seria melhor deixar est√° issue em pinned ?

>> Coment√°rio de filipedeschamps:
@felipsbreno sensacional, feito!

Em paralelo, fiz o PR #839 para tentar segurar um pouco a carga. O importante √© tentar n√£o estragar a entrega dos est√°ticos para isso n√£o debitar do SEO (caso algum crawler passe pelo site) e fazer um deploy √© um risco, pois invalida o cache do est√°ticos, mas preciso controlar isso aqui:

<img width="475" alt="image" src="https://user-images.githubusercontent.com/4248081/203099486-2f93ea1b-8513-47f8-aa7e-0925ae87d01d.png">

>> Coment√°rio de VictorManhani:
Erro ainda persiste e ao olhar os logs no Console parece que algumas chamadas n√£o foram incluidas no cache.

Mensagem do erro: Application error: a client-side exception has occurred (see the browser console for more information

![Erro de acesso - Application error: a client-side exception has occurred (see the browser console for more information).](https://i.imgur.com/yquGu9W.png)

No console parece que o erro √© de carregamento de recursos.
![Erro de acesso - Console](https://i.imgur.com/aQSfQob.png)

Para estes casos, quando o recurso j√° foi carregado, n√£o deveria parar de fazer qualquer outro carregamento? Pois estes erros est√£o acontecendo constantemente mesmo quando o conte√∫do j√° foi completamente carregado.

>> Coment√°rio de brunofamiliar:
Tem alguma possibilidade de j√° ter um bot rodando ?

>> Coment√°rio de filipedeschamps:
Tem sim @brunofamiliar infelizmente o site estava normalizando e tacaram um DoS em cima üòÇ  olha s√≥:

<img width="1703" alt="image" src="https://user-images.githubusercontent.com/4248081/203102474-a4f76c16-5bbb-43dd-9416-a318c04788fe.png">

>> Coment√°rio de nicolasteofilo:
Nossa, pessoal t√° bem r√°pido em üòÇ

>> Coment√°rio de brunofamiliar:
> Tem sim @brunofamiliar infelizmente o site estava normalizando e tacaram um DoS em cima üòÇ olha s√≥:
> 
> <img alt="image" width="1703" src="https://user-images.githubusercontent.com/4248081/203102474-a4f76c16-5bbb-43dd-9416-a318c04788fe.png">

Deu nem tempo de ver as cenas p√≥s cr√©dito os caras j√° fizeram um bot kkk

>> Coment√°rio de Gustavosta:
Algumas coisas no site realmente est√£o limitadas. Quando eu vou dar Tabcoins para uma publica√ß√£o ou coment√°rio, por exemplo, a requisi√ß√£o aparentemente sofre um timeout e ela n√£o √© conclu√≠da, retornando um alert com: `undefined undefined`.

**Aqui est√° um exemplo:**

![Sem t√≠tulo](https://user-images.githubusercontent.com/43628256/203105437-84ea715c-698f-4515-b2e0-e65bca3e2927.png)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps depois se possivel puxar o hist√≥rico de query's do banco, para verificar qual foi a mais solicitada. Desta forma podemos tratar um possivel gargalo de solicita√ß√µes.

Sei que com a quantidade de acesso n√£o teria muito o que fazer, mas ela pode servir para analisar quais poss√≠veis funcionalidades podem ser otimizadas.

>> Coment√°rio de filipedeschamps:
Total @rodrigoKulb e tem v√°rias otimiza√ß√µes que podemos fazer ü§ù 

Em paralelo, o banco est√° explodindo mesmo:

<img width="574" alt="image" src="https://user-images.githubusercontent.com/4248081/203109545-5a86ff17-5328-4066-b925-9ccbbffa52f8.png">

>> Coment√°rio de rodrigoKulb:
Voc√™ consegue alterar o limite m√°ximo de conex√µes ou √© configurado pelo plano?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb √© pelo plano apenas üëç 

Segue o gr√°fico do uso de processamento do banco, foi ele quem nos deu a rasteira mesmo:

![image](https://user-images.githubusercontent.com/4248081/203327291-51918739-2c6d-4b5f-8294-de68c8e7dc21.png)

>> Coment√°rio de jjeanjacques10:
@filipedeschamps caso as aplica√ß√µes que estejam acessando o banco sejam Lambdas √© interessante utilizar o [RDS Proxy](https://aws.amazon.com/rds/proxy/) da AWS para gerenciar melhor as conex√µes.

>> Coment√°rio de rodrigoKulb:
Parece que agora est√° normalizando novamente!
![Captura de tela em 2022-11-21 13-53-44](https://user-images.githubusercontent.com/5334261/203113795-11ab730b-b323-4c8b-a419-8b00dfeaed71.png)
Refletindo mais a realidade!

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, chegando agora, ent√£o n√£o sei o que j√° foi feito, mas eu faria o seguinte pra manter o m√≠nimo funcionamento:

1. Retirar o retry da conex√£o com o banco (melhor dar erro logo do que ficar segurando as lambdas e martelando mais ainda o banco)
2. Retirar os revalidates do SWR
3. Aumentar o intervalo de revalida√ß√£o das p√°ginas est√°ticas de 1s para 30s ou mais
4. Diminuir a toler√¢ncia do rate-limit

Mas **antes de tudo isso**, para conseguir dar um respiro para o banco, fazer o deploy com o middleware redirecionando tudo pra erro 500 (ou outra p√°gina est√°tica) e algo parecido com a API (tipo o rate-limit)

>> Coment√°rio de filipedeschamps:
Total @jjeanjacques10 , isso √© muito importante para conseguir abrir mais conex√µes, o problema √© que neste caso o processamento do banco de dados ficou em `100%`, e abrindo mais portas, s√≥ iria pressurizar ainda mais.

Em paralelo, o banco de dados vai cair um pouco, pois estou fazendo o upgrade da inst√¢ncia nesse momento üëç 

![image](https://user-images.githubusercontent.com/4248081/203114150-4e3a9010-91c4-4b2d-9f27-c3944240f7f7.png)

>> Coment√°rio de filipedeschamps:
@aprendendofelipe totaaal!! O maior problema √© que n√£o est√° dando para fazer deploy, pois a gera√ß√£o de est√°ticos tamb√©m retornando erro. Tem alguns bons builds com erro e tentei aqui rapidamente tirar, mas acabei mais quebrando do que consertando a situa√ß√£o.

Vou deixar o upgrade do banco finalizar e tento de novo üëç

>> Coment√°rio de aprendendofelipe:
N√£o retire a gera√ß√£o dos est√°ticos do build, pois s√≥ vai piorar a situa√ß√£o

>> Coment√°rio de filipedeschamps:
√â que se n√£o tirar, o build n√£o avan√ßa e nenhuma altera√ß√£o √© aplicada.

De qualquer forma, os dois PRs que tentei colocar em produ√ß√£o, mas deu erro  no build porque o banco estava indispon√≠vel:

- #839
- #843

>> Coment√°rio de filipedeschamps:
Pronto, agora temos mais conex√µes dispon√≠veis, um total de `407`:

<img width="391" alt="image" src="https://user-images.githubusercontent.com/4248081/203115195-8931973f-6ebb-49e5-be34-1dd731a6a608.png">


Mas o processamento continua no talo:

<img width="158" alt="image" src="https://user-images.githubusercontent.com/4248081/203115359-549d7c55-66ac-4d41-8254-471f5c4d6a66.png">

>> Coment√°rio de rodrigoKulb:
Consegui fazer um coment√°rio:
![Captura de tela em 2022-11-21 14-12-36](https://user-images.githubusercontent.com/5334261/203118206-de501628-44bc-419f-bdb0-40241a397f71.png)

>> Coment√°rio de rodrigoKulb:
**Conex√µes dispon√≠veis** n√£o √© a melhor nomenclatura para **max_connections** parece que ainda temos dispon√≠veis essa quantidade. 

**Sugest√µes:**
Limite de conex√µes, M√°ximo de conex√µes, Capacidade de conex√µes, Limite de conex√µes simult√¢neas

![Captura de tela em 2022-11-21 14-17-17](https://user-images.githubusercontent.com/5334261/203119218-76ed7281-3027-43bc-8861-73de634fbfb6.png)

Mas depois quando normalizar os servi√ßos abro uma PR com essa sugest√£o.

>> Coment√°rio de filipedeschamps:
Consegui retomar os deploys com o PR #848

Agora vou continuar trabalhando em algumas otimiza√ß√µes üëç

>> Coment√°rio de rodrigoKulb:
üëèÔ∏èüëèÔ∏èüëèÔ∏èüëèÔ∏è
![Captura de tela em 2022-11-21 14-28-40](https://user-images.githubusercontent.com/5334261/203121543-444a6092-718e-4712-b9f1-8d17abe60a32.png)

>> Coment√°rio de filipedeschamps:
Show!!! Agora vai :) estou fazendo o PR #849 para recuperar os conte√∫dos, mas ainda deixar a API desabilitada, assim n√£o machucamos o SEO das p√°ginas que j√° est√£o indexadas ü§ù 

Em paralelo, o banco de dados se recuperou tamb√©m:

<img width="966" alt="image" src="https://user-images.githubusercontent.com/4248081/203122131-6cadefdc-8ff3-4d1f-bb66-62bcedf5b454.png">

>> Coment√°rio de filipedeschamps:
Os alertas se normalizaram e este que ainda est√° ativo √© por conta do redirecionamento for√ßado que estamos fazendo na API (for√ßando rate-limit), ent√£o est√° tudo normal:

<img width="857" alt="image" src="https://user-images.githubusercontent.com/4248081/203122401-ed2d517b-495e-4cbc-8067-28c1287763e4.png">


Em paralelo, os conte√∫dos voltaram:

https://www.tabnews.com.br/recentes

>> Coment√°rio de filipedeschamps:
O que n√£o vai voltar √© essa multa linda aqui de **R$ 2.000,00** üòÇ 

<img width="470" alt="image" src="https://user-images.githubusercontent.com/4248081/203122915-de510590-4dab-437b-85db-8735dad12fa7.png">

A li√ß√£o dessa vez foi: n√£o deixa o banco de dados virar um gargalo. O trabalho agora √© cachear o m√°ximo de endpoints que der e voltar com o t√≥pico sobre os √≠ndices no banco de dados üëç

>> Coment√°rio de augustresende:
Vakinha pro @filipedeschamps pagar a multa da Vercel

>> Coment√°rio de aprendendofelipe:
> O que n√£o vai voltar √© essa multa linda aqui de **R$ 2.000,00** üòÇ
> 
> <img alt="image" width="470" src="https://user-images.githubusercontent.com/4248081/203122915-de510590-4dab-437b-85db-8735dad12fa7.png">
> 
> A li√ß√£o dessa vez foi: n√£o deixa o banco de dados virar um gargalo. O trabalho agora √© cachear o m√°ximo de endpoints que der e voltar com o t√≥pico sobre os √≠ndices no banco de dados üëç

https://github.com/filipedeschamps/tabnews.com.br/blob/08f3994e4f98fff4ecc675797182a83586f3eb13/infra/database.js#L61

Muda pra 1 por enquanto

>> Coment√°rio de manotroll:
uma pergunta se so tera texto n√£o poderia rodar no sistema web 3.0 ?
aonde pessoas poderiam rodar o site e junto pra compartilhar os acessos ?
o mangadex.org usa um sistema assim so que com torrent pra permitir que conte√∫dos sejam espelhados e possam ser acessado por outros lugares de forma transparente

>> Coment√°rio de filipedeschamps:
@aprendendofelipe interessante! Meu √∫nico receio √© falhar r√°pido demais para a pessoa. Vou retomar o servi√ßo como estava antes, pois quero observar ele sem o volume que veio do v√≠deo e DoS. Estou retomando tudo nesse PR:

- #850

>> Coment√°rio de filipedeschamps:
> uma pergunta se so tera texto n√£o poderia rodar no sistema web 3.0 ? 

Muito obrigado pela sugest√£o @manotroll como eu sou zero familiarizado com web 3.0 eu n√£o saberia avaliar esta op√ß√£o no momento meu caro ü§ù

>> Coment√°rio de filipedeschamps:
Turma, estamos 100% no ar novamente: https://www.tabnews.com.br/

Vou ficar aqui acompanhando o desenrolar das m√©tricas dos servi√ßos ü§ù

>> Coment√°rio de manotroll:
> > uma pergunta se so tera texto n√£o poderia rodar no sistema web 3.0 ?
> 
> Muito obrigado pela sugest√£o @manotroll como eu sou zero familiarizado com web 3.0 eu n√£o saberia avaliar esta op√ß√£o no momento meu caro ü§ù

tem o ZeroNet que e de c√≥digo livre ele roda de uma forma pra ser ant censura usando a rede torrent/tor seria lento 
e tipo um toresmo todo mundo "baixa e envia os dados" se a rede for grande fica rapidinho

>> Coment√°rio de joojano:
Bem, cheguei agora e que bom que est√° tudo online novamente. N√£o cheguei a verificar as decis√µes tomadas em rela√ß√£o a infraestrturua, mas abaixo seguem minhas sugest√µes que podem ser √∫teis para evitar um problema semelhante no futuro.

@filipedeschamps Considerando que o banco de dados ser um dos principais gargalos, achas que pode fazer sentido utilizar uma solu√ß√£o de banco de dados como o [Aurora Serverless](https://aws.amazon.com/pt/rds/aurora/serverless/) ou, usar uma solu√ß√£o mais opensource como o [YugabyteDB](https://www.yugabyte.com/)? Assim o banco pode escalar ou desescalar, otimizando custos e mantendo disponibilidade, al√©m de manter a compatibilidade com o PostgreSQL.

Em adi√ß√£o, apesar da Vercel Edge Functions ser bem massinha, talvez fique muito caro a longo prazo. Pode ser interessante a avalia√ß√£o do [Cloudflare Workers](https://workers.cloudflare.com/).

>> Coment√°rio de filipedeschamps:
@joojano show de bola meu caro! Eu diria que at√© antes de migrar a solu√ß√£o do banco de dados, dever√≠amos trabalhar com √≠ndices, que n√£o h√° nenhum hoje espec√≠fico para a busca de conte√∫dos. Se eu n√£o me engano, acho que hoje temos dois √≠ndices apenas (ou 1, n√£o lembro).

Ent√£o eu imagino que isso √© uma das coisas que est√° consumindo bastante o uso do banco de dados, que voltou a ficar em 100%:

<img width="481" alt="image" src="https://user-images.githubusercontent.com/4248081/203128599-561d0ff2-26ac-41a8-88f0-16bff700bd2c.png">

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe interessante! Meu √∫nico receio √© falhar r√°pido demais para a pessoa. Vou retomar o servi√ßo como estava antes, pois quero observar ele sem o volume que veio do v√≠deo e DoS. Estou retomando tudo nesse PR:
> 
> * [Retoma Home e API¬†#850](https://github.com/filipedeschamps/tabnews.com.br/pull/850)

Considerando um alto volume de acessos, e que n√£o temos circuit-breaker, melhor deixar o retry em 0 ou 1 (1 representa uma nova tentava em 150ms), pois √© melhor falhar logo quando o banco estiver com gargalo.

Ficar retentando s√≥ est√° consumindo tempo das lambdas atoa. E n√£o aumenta em nada a quantidade de requisi√ß√µes atendidas com sucesso, pois se o volume de acessos est√° alto, e nova tentativa ser√° liberada para o pr√≥ximo usu√°rio que estiver tentando acessar.

>> Coment√°rio de filipedeschamps:
Olha ali o ataque delicinha conta a Home. Precisamos entender porque os est√°ticos da Vercel passaram esse peso para dentro do backend.

<img width="956" alt="image" src="https://user-images.githubusercontent.com/4248081/203130012-3bb4ff6d-682d-4236-a755-cad159aac557.png">

>> Coment√°rio de rodrigoKulb:
@filipedeschamps n√£o sei se consegue ver as query's que est√£o sendo executadas, ideal seria puxar um log para entender onde est√° sendo o gargalo, exemplo no mysql `SHOW PROCESSLIST`

>> Coment√°rio de filipedeschamps:
> Ficar retentando s√≥ est√° consumindo tempo das lambdas atoa. E n√£o aumenta em nada a quantidade de requisi√ß√µes atendidas com sucesso, pois se o volume de acessos est√° alto, e nova tentativa ser√° liberada para o pr√≥ximo usu√°rio que estiver tentando acessar.

Perfeito! Vou incluir isso no pr√≥ximo PR ü§ù

>> Coment√°rio de aprendendofelipe:
> Olha ali o ataque delicinha conta a Home. Precisamos entender porque os est√°ticos da Vercel passaram esse peso para dentro do backend.

Por causa do revalidate de 1s

>> Coment√°rio de filipedeschamps:
> Por causa do revalidate de 1s

Um revalidate de 1 segundo me faz pensar que no m√°ximo seja 1 request por segundo, isso √© bem leve. Mas com certeza n√£o √© isto que est√° acontecendo.

>> Coment√°rio de aprendendofelipe:
Diferentes p√°ginas est√£o sendo acessadas ao mesmo tempo e continuamente, portanto o banco est√° tendo que lidar com revalida√ß√£o de x p√°ginas por segundo, n√£o s√≥ 1 por segundo. Some a isso todas as outras queries pra cadastros, login, votos etc.

>> Coment√°rio de joojano:
> @joojano show de bola meu caro! Eu diria que at√© antes de migrar a solu√ß√£o do banco de dados, dever√≠amos trabalhar com √≠ndices, que n√£o h√° nenhum hoje espec√≠fico para a busca de conte√∫dos. Se eu n√£o me engano, acho que hoje temos dois √≠ndices apenas (ou 1, n√£o lembro).
> 
> Ent√£o eu imagino que isso √© uma das coisas que est√° consumindo bastante o uso do banco de dados, que voltou a ficar em 100%:

Concordo contigo em rela√ß√£o ao problema ser relacionado a falta de √≠ndice, j√° que ele provavelmente deve estar fazendo full scan no banco. Mesmo as minhas sugest√µes relacionadas a banco n√£o iriam resolver o problema caso continuasse sem √≠ndice. Consegue dar o [EXPLAIN](https://www.postgresql.org/docs/current/sql-explain.html) na query dentro do banco pra verificar o que o banco est√° fazendo? (no caso da consulta feita no banco de dados pelo "/")

>> Coment√°rio de bielsavi:
@filipedeschamps, o que est√° "pesando" √© a quantidade de acessos simult√¢neos ou a quantidade de novos cadastros? 
Anseio das pessoas por uma nova rede social ou apenas viralizando? Seria importante saber sobre isso antes de migrar para outros tipos de bancos de dados eu acredito Kk mas sou bem J√∫nior, ainda estou come√ßando com front end hahahaha

>> Coment√°rio de filipedeschamps:
Essa query abaixo representa as queries que est√£o mais sendo usadas (seja em `iddle` ou n√£o?)

<img width="644" alt="image" src="https://user-images.githubusercontent.com/4248081/203131792-5bbf52d2-bf20-4390-a2cf-d790e0b772c5.png">

Na ordem:

## Query 1

```
      WITH RECURSIVE children AS (
        SELECT
            id,
            owner_id,
            parent_id,
            slug,
            title,
            body,
            status,
            source_url,
            created_at,
            updated_at,
            published_at,
            deleted_at
        FROM
          contents
        WHERE
          contents.id = $1 AND
          contents.status = 'published'
        UNION ALL
          SELECT
            contents.id,
            contents.owner_id,
            contents.parent_id,
            contents.slug,
            contents.title,
            contents.body,
            contents.status,
            contents.source_url,
            contents.created_at,
            contents.updated_at,
            contents.published_at,
            contents.deleted_at
          FROM
            contents
          INNER JOIN
            children ON contents.parent_id = children.id
          WHERE
            contents.status = 'published'

      )
      SELECT
        children.id,
        children.owner_id,
        children.parent_id,
        children.slug,
        children.title,
        children.body,
        children.status,
        children.source_url,
        children.created_at,
        children.updated_at,
        children.published_at,
        children.deleted_at,
        users.username as owner_username,
        get_current_balance('content:tabcoin', children.id) as tabcoins
      FROM
        children
      INNER JOIN
        users ON children.owner_id = users.id
      ORDER BY
        children.published_at ASC;
      ;
```

## Query 2

```
SELECT numbackends as opened_connections FROM pg_stat_database where datname = $1
```

## Query 3

```

      WITH user_found AS (
        SELECT
          *
        FROM
          users
        WHERE
          LOWER(username) = LOWER($1)
        LIMIT
          1
      )
      SELECT
        user_found.*,
        get_current_balance('user:tabcoin', user_found.id) as tabcoins,
        get_current_balance('user:tabcash', user_found.id) as tabcash
      FROM
        user_found
      ;
```

## Query 4

```

    WITH
    latest_published_root_contents AS (
        SELECT
            contents.id,
            contents.owner_id,
            contents.parent_id,
            contents.slug,
            contents.title,
            contents.status,
            contents.source_url,
            contents.created_at,
            contents.updated_at,
            contents.published_at,
            contents.deleted_at,
            get_current_balance('content:tabcoin', contents.id) as tabcoins
        FROM contents
        WHERE 
            parent_id IS NULL
            AND status = 'published'
            AND published_at > NOW() - INTERVAL '1 week'
    ),
    ranked_published_root_contents AS (
        SELECT 
            *,
            COUNT(*) OVER()::INTEGER as total_rows
        FROM latest_published_root_contents
        WHERE tabcoins >= 0
        ORDER BY
            tabcoins DESC,
            published_at DESC
    ),
    group_1 AS (
        SELECT
            *,
            1 as rank_group
        FROM ranked_published_root_contents
        WHERE
            published_at > NOW() - INTERVAL '36 hours'
            AND tabcoins > 11
        ORDER BY
            published_at DESC
        LIMIT 10
    ),
    group_2 AS (
        SELECT * FROM group_1
        UNION ALL
        SELECT
            *,
            2 as rank_group
        FROM ranked_published_root_contents
        WHERE
            published_at > NOW() - INTERVAL '24 hours'
            AND tabcoins > 6
            AND id NOT IN (SELECT id FROM group_1)
        ORDER BY
            rank_group,
            published_at DESC
        LIMIT 20
    ),
    group_3 AS (
        (SELECT 
            *,
            3 as rank_group
        FROM ranked_published_root_contents
        WHERE
            published_at > NOW() - INTERVAL '12 hours'
            AND id NOT IN (SELECT id FROM group_2)
        ORDER BY
            published_at DESC
        LIMIT 5)
        UNION ALL
        SELECT * FROM group_2
    ),
    group_4 AS (
        (SELECT 
            *,
            4 as rank_group
        FROM ranked_published_root_contents
        WHERE
            published_at > NOW() - INTERVAL '3 days'
            AND tabcoins > 11
            AND id NOT IN (SELECT id FROM group_3)
        ORDER BY
            published_at DESC
        LIMIT 10)
        UNION ALL
        SELECT * FROM group_3
    ),
    group_5 AS (
        (SELECT 
            *,
            5 as rank_group
        FROM ranked_published_root_contents
        WHERE
            published_at > NOW() - INTERVAL '72 hours'
            AND tabcoins > 1
            AND id NOT IN (SELECT id FROM group_4)
        ORDER BY
            published_at DESC
        LIMIT 10)      
        UNION ALL
        SELECT * FROM group_4
    ),
    ranked AS (
        SELECT * FROM group_5
        UNION ALL
        SELECT
            *,
            6 as rank_group
        FROM ranked_published_root_contents
        WHERE id NOT IN (SELECT id FROM group_5)
        ORDER BY
            rank_group,
            tabcoins DESC,
            published_at DESC
        LIMIT $1
        OFFSET $2
    )
    SELECT
        ranked.id,
        ranked.owner_id,
        ranked.parent_id,
        ranked.slug,
        ranked.title,
        ranked.status,
        ranked.source_url,
        ranked.created_at,
        ranked.updated_at,
        ranked.published_at,
        ranked.deleted_at,
        ranked.tabcoins,
        ranked.rank_group,
        ranked.total_rows,
        users.username as owner_username,
        (WITH RECURSIVE children AS
            (SELECT id,
                 parent_id
            FROM contents as all_contents
            WHERE
                all_contents.id = ranked.id
                AND all_contents.status = 'published'
            UNION ALL
            SELECT
                all_contents.id,
                all_contents.parent_id
            FROM contents as all_contents
            INNER JOIN children ON all_contents.parent_id = children.id
            WHERE all_contents.status = 'published'
            )
            SELECT count(child
```

## Query 5

```

      WITH content_window AS (
      SELECT
        COUNT(*) OVER()::INTEGER as total_rows,
        id
      FROM contents
      WHERE contents.id = $3
      

      LIMIT $1 OFFSET $2
      )
      
      SELECT
        contents.id,
        contents.owner_id,
        contents.parent_id,
        contents.slug,
        contents.title,
        contents.body,
        contents.status,
        contents.source_url,
        contents.created_at,
        contents.updated_at,
        contents.published_at,
        contents.deleted_at,
        users.username as owner_username,
        content_window.total_rows,
        get_current_balance('content:tabcoin', contents.id) as tabcoins,

        -- Originally this query returned a list of contents to the server and
        -- afterward made an additional roundtrip to the database for every item using
        -- the findChildrenCount() method to get the children count. Now we perform a
        -- subquery that is not performant but everything is embedded in one travel.
        -- https://github.com/filipedeschamps/tabnews.com.br/blob/de65be914f0fd7b5eed8905718e4ab286b10557e/models/content.js#L51
        (
          WITH RECURSIVE children AS (
            SELECT
                id,
                parent_id
            FROM
              contents as all_contents
            WHERE
              all_contents.id = contents.id AND
              all_contents.status = 'published'
            UNION ALL
              SELECT
                all_contents.id,
                all_contents.parent_id
              FROM
                contents as all_contents
              INNER JOIN
                children ON all_contents.parent_id = children.id
              WHERE
                all_contents.status = 'published'
          )
          SELECT
            count(children.id)::integer
          FROM
            children
          WHERE
            children.id NOT IN (contents.id)
        ) as children_deep_count
      FROM
        contents
      INNER JOIN
        content_window ON contents.id = content_window.id
      INNER JOIN
        users ON contents.owner_id = users.id
    
      ;
```

>> Coment√°rio de aprendendofelipe:
Sobre os √≠ndices, iriam ajudar, mas s√≥ um pouco. O que faria diferen√ßa √© n√£o precisar computar o saldo de tabcoins e quantidade de respostas de cada conte√∫do a todo momento.

>> Coment√°rio de rodrigoKulb:
J√° tive problema com `UNION` √© um problema utilizar em quantidade! Melhor pensar em uma query alternativa.

>> Coment√°rio de aprendendofelipe:
> J√° tive problema com `UNION` √© um problema utilizar em quantidade! Melhor pensar em uma query alternativa.

`UNION` √© pior do que `UNION ALL`, que √© o que utilizamos.

O que demora nessas queries √© computar os saldos de respostas, tabcoins e tabcash.

>> Coment√°rio de rodrigoKulb:
Em quais situa√ß√µes s√£o solicitados esses c√°lculos? Lembro que conversamos sobre isso em alguma PR (inclusive o pessoal do pagar.me falou tamb√©m) de ter um ultimo valor totalizando o saldo ou sempre recalcular a somat√≥ria.

Estamos sempre recalculando a somat√≥ria n√©? Talvez vamos precisar pensar em voltar atras e utilizar o ultimo valor somado para continuar calculando.

>> Coment√°rio de filipedeschamps:
Em paralelo, um √∫nico IP fez `1.283.059` requests e fez da seguinte forma:

<img width="960" alt="image" src="https://user-images.githubusercontent.com/4248081/203135539-ae418382-2c32-4d61-ad81-15e087562992.png">

>> Coment√°rio de augustresende:
@filipedeschamps parece que esse post est√° bem pesado e n√£o abre de jeito nenhum
https://www.tabnews.com.br/filipedeschamps/quem-deseja-acesso-ao-repositorio-privado-do-tabnews

Talvez ele possa ser usado para encontrar otimiza√ß√µes nas queries.

>> Coment√°rio de aprendendofelipe:
> Em paralelo, um √∫nico IP fez `1.283.059` requests e fez da seguinte forma:

Em que intervalo de tempo? Se foi espalhado, n√£o deveria ser problema. Se foi em um intervalo curto, deveria ter sido barrado pela Vercel

>> Coment√°rio de aprendendofelipe:
> @filipedeschamps parece que esse post est√° bem pesado e n√£o abre de jeito nenhum https://www.tabnews.com.br/filipedeschamps/quem-deseja-acesso-ao-repositorio-privado-do-tabnews
> 
> Talvez ele possa ser usado para encontrar otimiza√ß√µes nas queries.

@filipedeschamps, aproveita o PR e muda esse link do Footer para o reposit√≥rio no GitHub

>> Coment√°rio de filipedeschamps:
@aprendendofelipe 

<img width="325" alt="image" src="https://user-images.githubusercontent.com/4248081/203136260-f8ed9e58-e42b-42ef-8698-85fdecdea361.png">

Sobre o footer, perfeito!!

>> Coment√°rio de filipedeschamps:
@aprendendofelipe n√£o consigo fazer o build novamente, como o banco est√° no talo e sem retry piora conseguir passar por ele.

<img width="944" alt="image" src="https://user-images.githubusercontent.com/4248081/203137338-38fcef94-c858-433a-934c-de1a3249cee0.png">

>> Coment√°rio de manotroll:
n√£o pode fazer um sistema de fila ?
https://www.youtube.com/watch?v=0TMr8rsmU-k
aqui ele deu uma ideia de como fazer isso no sistema do ingresso.com

>> Coment√°rio de filipedeschamps:
Turma, vou ter que derrubar a API de novo, pois a multa l√° n√£o para de crescer. Em paralelo iniciei uma conversa com uma pessoa da Vercel para ver o que fazer.

>> Coment√°rio de aprendendofelipe:
> <img alt="image" width="325" src="https://user-images.githubusercontent.com/4248081/203136260-f8ed9e58-e42b-42ef-8698-85fdecdea361.png">

Parece ter sido calculado especialmente para causar problemas no banco, mas sem ser percebido pela Vercel.


> @aprendendofelipe n√£o consigo fazer o build novamente, como o banco est√° no talo e sem retry piora conseguir passar por ele.

Vamos fazer duas configura√ß√µes diferentes? Uma para a gera√ß√£o de p√°ginas est√°ticas e outra para a API?

>> Coment√°rio de aprendendofelipe:
> Turma, vou ter que derrubar a API de novo, pois a multa l√° n√£o para de crescer. Em paralelo iniciei uma conversa com uma pessoa da Vercel para ver o que fazer.

N√£o consigo pensar em outra solu√ß√£o r√°pida a n√£o ser diminuir o retry para desacelerar o crescimento dessa conta. Ap√≥s o bloqueio da API, voc√™ deve conseguir fazer o deploy. Al√©m disso, o atacante ir√° precisar aumentar o n√∫mero de requisi√ß√µes para derrubar o banco, e isso aumenta as chances dele ser bloqueado pela Vercel

>> Coment√°rio de filipedeschamps:
> Vamos fazer duas configura√ß√µes diferentes? Uma para a gera√ß√£o de p√°ginas est√°ticas e outra para a API?

Topo qualquer coisa! üòÇ  O que voc√™ sugere exatamente?

>> Coment√°rio de aprendendofelipe:
> > Vamos fazer duas configura√ß√µes diferentes? Uma para a gera√ß√£o de p√°ginas est√°ticas e outra para a API?
> 
> Topo qualquer coisa! üòÇ O que voc√™ sugere exatamente?

Eu sugeri isso, pois pensei que o retry reduzido j√° estava em produ√ß√£o, mas n√£o est√°, n√©?

>> Coment√°rio de aprendendofelipe:
Se precisar derrubar a API novamente com a mesma estrat√©gia, basta usar isso

![image](https://user-images.githubusercontent.com/77860630/203141400-0c3d9365-4ef2-45b1-a9bd-e522dc1ed05a.png)

Neste deploy

![image](https://user-images.githubusercontent.com/77860630/203142135-c4792452-85cb-49fa-9b9b-ded1bbc5fc5c.png)

>> Coment√°rio de aprendendofelipe:
Da√≠ n√£o precisa de PR

>> Coment√°rio de rodrigoKulb:
> Essa query abaixo representa as queries que est√£o mais sendo usadas (seja em `iddle` ou n√£o?)

Conseguimos identificar a origem de cada query, acredito que devemos atacar o TOP 5 querys que est√£o sendo utilizadas otimizar os processos que est√£o fazendo essa quantidade de querys repedidas. Se s√£o iguais porque essa quantidade?
|Query | quantidade | funcionalidade|
|----------|:-------------:|------:|
Query 1 |27 |??|
Query 2 |20 |??|
Query 3 |11|??|
Query 4 |9|??|
Query 5 |7|??|

Vamos mapear o que cada uma faz e quem est√° chamando para conseguir mitigar esses picos.

>> Coment√°rio de joojano:
Infelizmente estou recebendo esse erro ao comentar em uma postagem. C√≥digo fafaaf7a-d1f7-42db-87f5-17ff4f933c83
![image](https://user-images.githubusercontent.com/44454114/203143081-72c828f6-da9e-4bd9-9ed5-06c3c80d6702.png)

>> Coment√°rio de filipedeschamps:
@joojano desabilitei a API e estou subindo uma mensagem global avisando que estamos s√≥ no modo leitura ü§ù  O PR √© este #862

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, se o ataque nas p√°ginas est√°ticas ainda estiver ocorrendo, precisa retornar 500 na rota `/[username]/[slug]`, sen√£o a utiliza√ß√£o do banco n√£o ir√° baixar

>> Coment√°rio de filipedeschamps:
@aprendendofelipe n√£o est√° mais acontecendo ataque pelo que estou vendo, mas estava pensando, vamo coloca a Upstash na frente de tudo?

>> Coment√°rio de aprendendofelipe:
N√£o d√° pra colocar a Upstash na frente das p√°ginas est√°ticas

>> Coment√°rio de aprendendofelipe:
> N√£o d√° pra colocar a Upstash na frente das p√°ginas est√°ticas

N√£o pelo Middleware

>> Coment√°rio de filipedeschamps:
@aprendendofelipe acho que d√° sim, olha s√≥: https://nextjs.org/docs/advanced-features/middleware#matcher

Eu n√£o lembro onde tinha lido isso, mas que dava at√© para passar o que est√° dentro do `_next`

>> Coment√°rio de filipedeschamps:
De qualquer forma, o `load` n√£o est√° mais sendo causado por ataque, mas por baixa performance da API mesmo, como voc√™ apontou, o grande vil√£o deve ser somar tabcoins e coment√°rios.

>> Coment√°rio de CarlosZiegler:
Por que colocar upstash? N√£o vi como foi implementado mas n√£o daria para colocar em um rate-limit com delay no middleware? 

https://kittygiraudel.com/2022/05/16/rate-limit-nextjs-api-routes/

>> Coment√°rio de aprendendofelipe:
> Eu n√£o lembro onde tinha lido isso, mas que dava at√© para passar o que est√° dentro do `_next`

O problema √© justamente esse caminho. Quando eu testei, n√£o consegui. Mas n√£o estava seguindo nenhum procedimento espec√≠fico, s√≥ tentei colocar algo assim:

```js
export const config = {
    matcher: ['/_next/data/:path*'],
};
```

>> Coment√°rio de filipedeschamps:
@CarlosZiegler To pensando aqui: acho que agora o foco n√£o deveria necessariamente prevenir ataques, e sim fazer o backend performar com o novo patamar de `load` que ele est√° precisando trabalhar.

@aprendendofelipe que tal o matcher ser tudo?

>> Coment√°rio de filipedeschamps:
Requests das √∫ltimas 6 horas:

<img width="1703" alt="image" src="https://user-images.githubusercontent.com/4248081/203147202-606612bf-6427-4174-9148-058f95d8a977.png">

>> Coment√°rio de aprendendofelipe:
> @CarlosZiegler To pensando aqui: acho que agora o foco n√£o deveria necessariamente prevenir ataques, e sim fazer o backend performar com o novo patamar de `load` que ele est√° precisando trabalhar.
> 
> @aprendendofelipe que tal o matcher ser tudo?

Testei tamb√©m, mas `_next` n√£o caia no middleware

>> Coment√°rio de filipedeschamps:
@aprendendofelipe sabe dizer se conseguimos fazer o `Link` ser menos agressivo no prefetch? Porque ele pode estar contribuindo em abarrotar de requests. Queria testar desabilitar ele e ver o comportamento geral do consumo no backend.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps n√£o acho que o ataque foi o principal motivo da lentid√£o, acredito que temos gargalos em query's e dimensionamento da infra para quantidade que o v√≠deo trouxe

>> Coment√°rio de filipedeschamps:
@rodrigoKulb no per√≠odo do ataque foi ele mesmo, foi muito bem feito e uma pena que nosso rate-limit n√£o pega do jeito que ele foi feito. Mas do resto, eu concordo com voc√™ ü§ù 

Em paralelo, as estat√≠sticas pela Vercel:

<img width="1239" alt="image" src="https://user-images.githubusercontent.com/4248081/203147579-37b3e2f3-9141-43db-9e68-2669de1935da.png">

>> Coment√°rio de filipedeschamps:
Vamos desabilitar o prefetch?

<img width="689" alt="image" src="https://user-images.githubusercontent.com/4248081/203147984-78dda5f2-f932-47fd-8993-d5c50301d310.png">

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe sabe dizer se conseguimos fazer o `Link` ser menos agressivo no prefetch? Porque ele pode estar contribuindo em abarrotar de requests. Queria testar desabilitar ele e ver o comportamento geral do consumo no backend.

S√≥ passar `prefetch={false}`, mas acho que n√£o vai dar quase diferen√ßa, pois ele n√£o dispara revalida√ß√£o para p√°ginas que j√° est√£o em cache, mesmo que *stale*

>> Coment√°rio de aprendendofelipe:
O banco ainda est√° 100%?

J√° conseguiu colocar em produ√ß√£o alguma vers√£o com retry = 1?

>> Coment√°rio de filipedeschamps:
@aprendendofelipe j√° est√° em produ√ß√£o com retry = 1 desde o PR que desabilitei/reabilitei os conte√∫dos.

E o banco saiu de 100% mas ele ta lutando bastante (n√£o deveria):

<img width="976" alt="image" src="https://user-images.githubusercontent.com/4248081/203149231-9ede18c0-3840-4d58-b2d1-e7652a5f795f.png">


E o PR do prefetch: #865

>> Coment√°rio de aprendendofelipe:
Show! Ent√£o remove a quantidade de coment√°rios da query e do contentList.

>> Coment√°rio de rodrigoKulb:
S√≥ para registro de hist√≥rico:
![Captura de tela em 2022-11-21 17-16-02](https://user-images.githubusercontent.com/5334261/203150213-46df1623-68d9-474e-ab7b-f3e23095549b.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show, √≥tima ideia!!! Fiz aqui tamb√©m uma aparecendo mais itens e na aba an√¥nima ü§ù 

<img width="1792" alt="image" src="https://user-images.githubusercontent.com/4248081/203150458-b4ea9d2a-880f-4552-a437-4b5c689febcd.png">

>> Coment√°rio de aprendendofelipe:
> Show! Ent√£o remove a quantidade de coment√°rios da query e do contentList.

Troca

```
(WITH RECURSIVE children AS ...
            ...) as children_deep_count
```

por

`0 as children_deep_count`

aqui: 

https://github.com/filipedeschamps/tabnews.com.br/blob/af97b7b41b3dce642be33c8090ce8c923a3cd4b9/models/queries.js#L136

e em diferentes lugares do:

https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/content.js

E comenta essas linhas:

https://github.com/filipedeschamps/tabnews.com.br/blob/215023fb81d69f07927055ddc3fed686633b36d6/pages/interface/components/ContentList/index.js#L119-L122

>> Coment√°rio de filipedeschamps:
@aprendendofelipe feito no PR #867

Em paralelo, processamento do banco:

![image](https://user-images.githubusercontent.com/4248081/203326141-30d5b93b-7d28-40a0-a532-d80db6565103.png)

>> Coment√°rio de filipedeschamps:
Vou habilitar novamente a API, vamos ver o comportamento no processamento ü§ù

>> Coment√°rio de filipedeschamps:
Tudo no ar novamente :)

E legal que o pessoal se cadastrou e tentou publicar coisas, pena que a API ficou inst√°vel, acredito que muita mais gente teria conseguido:

<img width="1021" alt="image" src="https://user-images.githubusercontent.com/4248081/203159421-105a1d53-ff50-4553-882e-8dfd45223be5.png">

>> Coment√°rio de filipedeschamps:
Um v√≠deo com mais informa√ß√µes pra deixar registrado:

https://user-images.githubusercontent.com/4248081/203159656-6345fdc8-c455-40a2-9027-d561948669a2.mov

>> Coment√°rio de aprendendofelipe:
Pelo jeito a configura√ß√£o ` prefetch={false}` no Primer n√£o foi repassada para o `next/link`.

Mas realmente acho que isso teria um efeito insignificante no banco, por√©m grande na UX, pois a navega√ß√£o seria mais lenta.

>> Coment√°rio de aprendendofelipe:
Invoca√ß√µes das lambdas nas √∫ltimas 2h30 (a faixa 18 - 19h √© parcial):

![image](https://user-images.githubusercontent.com/77860630/203161493-a819f980-a6cf-41b6-b046-0084bd8e269b.png)
![image](https://user-images.githubusercontent.com/77860630/203161550-68fa88c9-e84f-420b-9ddc-c4bd081fd2b9.png)
![image](https://user-images.githubusercontent.com/77860630/203161582-3f37a630-331a-4f95-a74e-4df7aa35b34d.png)

E o tempo de execu√ß√£o voltou ao normal em algum momento entre 16h e 17h

* hor√°rios de Bras√≠lia

>> Coment√°rio de filipedeschamps:
> Pelo jeito a configura√ß√£o ` prefetch={false}` no Primer n√£o foi repassada para o `next/link`.

Acho que passou sim, dado que ele n√£o faz o `prefetch` do que est√° na view, somente no que o usu√°rio passar o mouse em cima. Aqui est√° assim pelo menos e ficou alinhado com o que a documenta√ß√£o falou ü§ù 

> Mas realmente acho que isso teria um efeito insignificante no banco, por√©m grande na UX, pois a navega√ß√£o seria mais lenta.

Justo! No momento estou raspando qualquer coisa que der para raspar üòÇ üëç

>> Coment√°rio de Mr-Guilherme:
Meus 2 centavos aqui, n√£o tenho conhecimento como est√° a base de testes do projeto, mas uma sugest√£o que possa ajudar no futuro seja implementar testes com ferramentas semelhantes ao [autocannon](https://github.com/mcollina/autocannon) na api para estressar.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps @aprendendofelipe o que foi feito que normalizou o site? Acredito que as visitas tamb√©m diminu√≠ram foi localizado o gargalo? Somente removeu a quantidade de coment√°rios da listagem?

>> Coment√°rio de filipedeschamps:
Acho que foi tudo, as visitas naturalmente esfriaram, mas tamb√©m removemos a valida√ß√£o dos conte√∫dos pela API (aquela chamada adicional que atualizava uma p√°gina que tinha sido gerada estaticamente), removemos a quantidade de coment√°rios numa publica√ß√£o, aumentamos o cache de algumas coisas e reduzimos o revalidate.

Ainda n√£o estou seguro que a API n√£o v√° cair amanh√£ de novo com o movimento do site voltando ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps ainda sou muito a favor de manter o total de coment√°rios na tabela **principal**, sem precisar sair somando toda vez que for atualizar o cache. O coment√°rio s√≥ √© atualizado quando algu√©m adicionar um novo coment√°rio n√£o faz sentido sempre fazer essa soma se nenhum novo coment√°rio foi inserido ou exclu√≠do.

**Atualizar o total de coment√°rios quando:**
- Algu√©m cadastrar um novo coment√°rio
- Algu√©m excluir um coment√°rio.

Apenas completando o gargalo da QUERY estava no SELECT e n√£o no INSERT e UPDATE sabemos que o SELECT ser√° bem mais solicitado, ent√£o a sugest√£o √© tirar toda carga de calculos do SELECT deixando tudo para o INSERT e UPDATE.

>> Coment√°rio de filipedeschamps:
Ainda estamos com **127** pessoas online simult√¢neas.

<img width="1246" alt="image" src="https://user-images.githubusercontent.com/4248081/203177523-4bd6b692-66c0-4148-a003-6d2bcd9809ea.png">

Load no banco de dados:

![image](https://user-images.githubusercontent.com/4248081/203326032-e6e747f8-cbcf-4a6c-9fc1-f861a8764af7.png)

>> Coment√°rio de rodrigoKulb:
Legal essa informa√ß√£o! Com a estrutura atual, j√° comentando o total de coment√°rios com 127 usu√°rios total de 60% CPU.
Fazendo uma conta de p√£o:
1.270 usu√°rios 600% CPU
12.700 usu√°rios 6.000% CPU

Isso que precisamos trabalhar para reduzir ainda estamos com um consumo acima do ideal para a demanda que tivemos hoje.

Editei a quantidade de query por % de cpu agora que vi o gr√°fico. Mas segue a mesma l√≥gica.

>> Coment√°rio de gabrielsozinho:
@filipedeschamps n√£o tem muito a ver com essa issue (ou talvez nada), mas por curiosidade, voc√™ tem como saber quantas TabCoins/TabCashs foram geradas hoje? Se sim, voc√™ pode falar quantas?

edit: pode ignorar, era s√≥ eu ver quantas publica√ß√µes e coment√°rios haviam sido feitos pra saber issoüòÖ (pelo menos pras TabCoins)

>> Coment√°rio de filipedeschamps:
Fala @gabrielsozinho √© poss√≠vel ver sim, s√≥ n√£o consigo ver isso agora üòÖ üëç

>> Coment√°rio de Rafatcb:
> edit: pode ignorar, era s√≥ eu ver quantas publica√ß√µes e coment√°rios haviam sido feitos pra saber issoüòÖ (pelo menos pras TabCoins)

@gabrielsozinho votos tamb√©m geram TabCoins (ou tiram, se for voto negativo), ent√£o seu c√°lculo seria uma boa estimativa, mas n√£o exata.

>> Coment√°rio de aprendendofelipe:
Ap√≥s a experi√™ncia de hoje, segue algumas coisas para refletirmos:

1. Olhando apenas para as √∫ltimas 5 horas, o tempo de execu√ß√£o das lambdas ainda continua alto. Calculo um custo mensal de cerca de R$ 5.000,00 s√≥ com essa conta na Vercel (se for mantido esse patamar).

2. Ainda est√£o ocorrendo alguns erros e timeouts nas lambdas, mas nada grave, pois as requisi√ß√µes com falhas est√£o ocorrendo em propor√ß√£o menor do que ocorria antes do PR #823. Com isso considero que o funcionamento se tornou est√°vel.

3. Ent√£o acredito que a prioridade deveria ser baixar ainda mais o tempo de execu√ß√£o das lambdas. E considerando que esse tempo √© devido ao desempenho do banco de dados, temos dois caminhos (n√£o excludentes) para resolver isso: melhorar o desempenho do banco e/ou diminuir o n√∫mero de consultas.

4. Desempenho do banco - Pelo alto custo com as lambdas, deve ser vi√°vel melhorar ainda mais o tipo de inst√¢ncia do banco. E mesmo que essa n√£o seja a melhor solu√ß√£o, por ser a mais r√°pida, deve ser a que trar√° mais economia em um primeiro momento.

5. Desempenho do banco 2 - A cria√ß√£o de √≠ndices deve melhorar um pouco o desempenho, mas n√£o acredito que seja mais significativo do que mudar a estrat√©gia de c√°lculo do saldo de TabCoins e TabCash (e da quantidade de coment√°rios que deve voltar a ser computada assim que for vi√°vel).

6. Diminuir as consultas ao banco - A a√ß√£o mais simples que trar√° esse resultado √© aumentar o tempo de revalida√ß√£o das p√°ginas, que hoje mudou de 1s para 10s, mas acredito que ainda tem margem para um valor ainda maior. Algo que tamb√©m pode ser feito √© deixar um tempo de revalida√ß√£o ainda maior para p√°ginas de conte√∫dos mais antigos.

7. Ap√≥s a ado√ß√£o dessas medidas mais r√°pidas, acredito que devemos implementar um sistema de filas para lidar com as atualiza√ß√µes de dados que s√£o necess√°rias ap√≥s cada tipo de evento dentro do sistema (cria√ß√£o de conte√∫do, respostas, votos etc.). Com isso os dados mais consumidos podem ser armazenados j√° computados, diminuindo muito a exig√™ncia do banco.

8. E para armazenar os dados j√° computados, se, por enquanto, pudermos deixar a API p√∫blica em segundo plano, n√£o precisamos mudar muito a modelagem de dados. Bastaria usar melhor o cache da Vercel, deixando as p√°ginas est√°ticas sem nenhuma revalida√ß√£o por tempo (ou deixar um tempo bem alto) e utilizar as filas para disparar lambdas que fazem a revalida√ß√£o sob demanda, de acordo com as a√ß√µes dos usu√°rios.

9. Enquanto isso a API p√∫blica ficaria com um cache com tempo razo√°vel e um rate-limit bem baixo para n√£o impactar o funcionamento principal.

Gostaria de saber o que todos pensam sobre essas ideias e seria melhor ainda ouvir ideias diferentes ü§ù

>> Coment√°rio de filipedeschamps:
Sensacional!!

**1** Sobre o custo, estou conversando com a Vercel para tentar entrar no programa de apoio deles, j√° que o projeto √© open source. Isso vai fazer com que a gente tenha que provavelmente colocar um logo deles em algum lugar, ou algo assim. Eu topo total enquanto a gente tenta otimizar as coisas, at√© pra eu n√£o ficar com esse ru√≠do de 5k na cabe√ßa üòÇ 

**2** Sim, esse PR foi salvador!! Imagina sem ele como estar√≠amos üòÇ 

**4** Eu fiz um upgrade de `db.t4g.micro` para `db.t4g.medium`, mas n√£o deu para notar muita diferen√ßa na quest√£o do processamento. Ser√° que estou usando a inst√¢ncia errada? Por exemplo, usar uma mais focada em processamento, n√£o sei se existe isso. Usando a calculadora da AWS, o custo do banco vai aumentar para USD 150: https://calculator.aws/#/estimate?id=5eb0045632cc63df889d8d9ee5c860c3151fe4c0

**5** Acho que devemos ter √≠ndice independende de qualquer estrat√©gia para evitar um full scan de agora. Mas com certeza temos que voltar com aquelas outras estrat√©gias de cache üëç 

**6** A gente poderia voltar com aquela estrat√©gia do `unstable_revalidate()` que j√° est√° stable eu imagino, pelo menos para cobrir alguns casos de atualiza√ß√£o de dado.

**7, 8 e 9** show!! Meu foco agora vai ser nas tarefas do dia zero para tentar conseguir passar o dia amanh√£, e da√≠ vamos incrementando as solu√ß√µes ü§ù

>> Coment√°rio de CarlosZiegler:
Bom dia a tyodos, principalmente a quem apagou o fogo :)

Questao de custo um amigo meu passou coisa parecida com a vercel. Entao eu me pergunto:

- Por que nao criar um backend separado (aws, gcp, digital ocean, etc)
- Qual estrategia de uso da API ? Consigo usar sem ter um token ? Caso nao esteja implementado, nao seria melhor ter algo como github faz? Gera um token apra cesso da API, assim conseguimos identificar quem esta fzendo mau uso etc ? √â possivel ?
- Colocar um metodo de "doacao" no projeto, talvez um botaozinho do paypal, para ajudar o projeto com custos  de infra/ custos adicionasdo projeto.

No mias parabens a todos ai pelo otimo trabalho :)

>> Coment√°rio de filipedeschamps:
@CarlosZiegler acho que √© uma quest√£o do qu√£o r√°pido d√° para acatar cada item. Sugiro por enquanto cavar por performance na atual infraestrutura. E sobre doa√ß√£o, seria show!!! Mas deixa eu ver antes se a Vercel consegue patrocinar o servidor at√© que a gente consiga normalizar o uso ü§ù 

Que falando nisso, processamento do banco subiu de novo:

![image](https://user-images.githubusercontent.com/4248081/203325907-349df836-27e1-4264-9336-5c0200e1b5c6.png)

>> Coment√°rio de filipedeschamps:
Tive que colocar o site em modo leitura (e usei o instant rollback @aprendendofelipe funcinou show!)

Precisei fazer isso para conseguir rodar as migrations desse PR: #882

>> Coment√°rio de filipedeschamps:
Tirando de read only. Rodei a migration que adiciona os indices em balance operations, e a query da Home est√° retornando em `10ms`. Vamos ver at√© quanto tempo isso se sustenta e estou monitorando aqui:

![image](https://user-images.githubusercontent.com/4248081/203325738-51b0b5d1-6685-4a63-b4a4-788ecf0151d9.png)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps quantos visitantes o site bateu 100% de cpu do banco?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb visitantes eu n√£o tenho, mas estava com 4 mil requests naquele minuto:

<img width="1736" alt="image" src="https://user-images.githubusercontent.com/4248081/203318512-6fe7ebfa-95b8-4d50-ae8a-e6977ed6e735.png">

>> Coment√°rio de rodrigoKulb:
Essa parte de passar o mouse sobre os links e recarregar o conte√∫do da API, n√£o deveria ter um delay?
![Captura de tela em 2022-11-22 10-01-23](https://user-images.githubusercontent.com/5334261/203320674-8fa3c8d2-06b0-4c1e-8864-c7dcfcf659ed.png)
Se ficar passando o mouse ele sempre solicita a uma nova request. @aprendendofelipe dever√≠amos fazer igual a nova implementa√ß√£o de pagina√ß√£o, depois de carregar deixar um delay para uma nova request. 

ou isso √© do NEXT?

√â realmente necess√°rio fazer essa quantidade de request pegando v√°rias informa√ß√µes somente passando o mouse sobre o link?

>> Coment√°rio de filipedeschamps:
@rodrigoKulb isso √© do Next sim e serve para melhorar a UX ao interagir com a pr√≥xima p√°gina, pois ela j√° carrega de forma antecipada (prefetch) antes do clique. Segundo a documenta√ß√£o da Vercel, eles usam o est√°tico que foi gerado por uma p√°gina est√°tica (puxa um JSON dos dados), ent√£o teoricamente n√£o deveria pesar no backend (considerando que o est√°tico j√° foi gerado). E como o @aprendendofelipe observou, isso n√£o revalida o est√°tico, ent√£o √© um dado stale mesmo.

>> Coment√°rio de brunofamiliar:
> @rodrigoKulb isso √© do Next sim e serve para melhorar a UX ao interagir com a pr√≥xima p√°gina, pois ela j√° carrega de forma antecipada (prefetch) antes do clique. Segundo a documenta√ß√£o da Vercel, eles usam o est√°tico que foi gerado por uma p√°gina est√°tica (puxa um JSON dos dados), ent√£o teoricamente n√£o deveria pesar no backend (considerando que o est√°tico j√° foi gerado). E como o @aprendendofelipe observou, isso n√£o revalida o est√°tico, ent√£o √© um dado stale mesmo.

Fiz um teste aqui, por√©m estou tendo um erro 404 no prefetch 

![image](https://user-images.githubusercontent.com/32016729/203323902-b289ecdd-d2ba-4bfa-b2da-46f749290dc9.png)

Mas esse ponto n√£o est√° afetando minha usabilidade

>> Coment√°rio de rodrigoKulb:
@filipedeschamps ok realmente n√£o deveria fazer a solicita√ß√£o para o backend mas com certeza √© contabilizado como uma **requests** no seu relat√≥rio n√£o? Consegue filtrar se no relat√≥rio de request est√° chamando arquivos .json ?

>> Coment√°rio de filipedeschamps:
> Fiz um teste aqui, por√©m estou tendo um erro 404 no prefetch

√â que eu fiz um deploy e sua p√°gina estava com o cache dos ids passados dos est√°ticos. Se voc√™ der refresh agora, vai funcionar ü§ù

>> Coment√°rio de filipedeschamps:
> @filipedeschamps ok realmente n√£o deveria fazer a solicita√ß√£o para o backend mas com certeza √© contabilizado como uma **requests** no seu relat√≥rio n√£o? Consegue filtrar se no relat√≥rio de request est√° chamando arquivos .json ?

Consigo sim! N√£o consigo montar a query agora porque quero continuar as otimiza√ß√µes aqui, mas d√° para filtrar sim üëç

>> Coment√°rio de brunofamiliar:
> > Fiz um teste aqui, por√©m estou tendo um erro 404 no prefetch
> 
> √â que eu fiz um deploy e sua p√°gina estava com o cache dos ids passados dos est√°ticos. Se voc√™ der refresh agora, vai funcionar ü§ù

Deu bom kk ü§ù

>> Coment√°rio de filipedeschamps:
Turma, processamento no banco continua **√≥timo**, mas trabalho n√£o para por aqui, precisamos agora cavucar performance nos **conte√∫dos**.

<img width="867" alt="image" src="https://user-images.githubusercontent.com/4248081/203324799-b194df76-c14e-424e-a6c2-0b92020ea7ea.png">


Eu vou iniciar a implementa√ß√£o de retomar a quantidade de coment√°rios, mas quero incluir um campo novo na coluna de conte√∫dos, que √© algo sobre o `root_id`. Este campo √© o **id** do **primeiro** conte√∫do `root` e que vai ser replicado para todos os conte√∫dos `child`, ent√£o na hora de construir a √°rvore de conte√∫dos, eu posso incluir na query esse id do root e isolar melhor a busca no banco (incluindo, colocando um √≠ndice nesse campo).

E dado a isso, vou remover a possibilidade de um conte√∫do atualizar o seu `parent_id`. √â um recurso que n√£o utilizamos e se formos utilizar (mover um conte√∫do para outra √°rvore), podemos implementar de outra forma para fazer o `root_id` continuar consistente.

>> Coment√°rio de filipedeschamps:
Em paralelo, com o v√≠deo de lan√ßamento batemos 300 mil visualiza√ß√µes üéâ (e nesse exato momento tem mais de `100` pessoas acessando o TabNews ü§ù ). Ta muito massa demaaaaiss üòç 

<img width="1266" alt="image" src="https://user-images.githubusercontent.com/4248081/203327812-8b03fe6b-bc9d-4990-a364-8f361595bade.png">

>> Coment√°rio de Rafatcb:
Como compara√ß√£o, n√≥s alcan√ßamos a marca de [100 mil acessos em 20 dias recentemente](https://www.tabnews.com.br/filipedeschamps/tabnews-passou-de-100-000-visitas-nos-ultimos-20-dias), e tinha um pico de dois dias com grande destaque:

![image](https://user-images.githubusercontent.com/26308880/203328584-9efeff63-c27c-4b1b-a793-f118492d97a4.png)

Agora, esse pico quase passa batido üòÇ

>> Coment√°rio de filipedeschamps:
@Rafatcb aahahah e verdade, s√≥ da pra ver ele se for√ßar o olho üòÇ üëç 

@aprendendofelipe em paralelo, o que acha de subirmos a barra de TabCoins para aparecer na Home? Algo como um m√≠nimo de 2 TabCoins?

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, criei o #896 para modificar as configura√ß√µes do pool durante o deploy. Agora que o banco est√° mais aliviado n√£o vai fazer diferen√ßa, mas ainda assim pode ser √∫til em um momento futuro, al√©m de abrir possibilidades de outras modifica√ß√µes espec√≠ficas para o momento do build.

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe em paralelo, o que acha de subirmos a barra de TabCoins para aparecer na Home? Algo como um m√≠nimo de 2 TabCoins?

Sim, j√° estava pensando em ajustes para o novo volume de conte√∫dos.

Mas talvez para os 5 conte√∫dos mais recentes (grupo 3) podemos deixar em 1 (hoje est√° em 0). Pois sen√£o em momentos tranquilos s√≥ teremos conte√∫dos antigos na home.

 E tamb√©m diminuir o limite de 7 dias para 3 ou 4. Pois a query precisa calcular o saldo de tabcoins de todos os conte√∫dos para ranquear. E com o novo volume, a quantidade de 7 dias vai ser pesada

>> Coment√°rio de filipedeschamps:
> E tamb√©m diminuir o limite de 7 dias para 3 ou 4. Pois a query precisa calcular o saldo de tabcoins de todos os conte√∫dos para ranquear. E com o novo volume, a quantidade de 7 dias vai ser pesada

Pelo que estou testando aqui, n√£o vai precisar diminuir, o √≠ndice ajudou muito (num n√≠vel que nem eu sei como). Este √© o resultado para 1 semana rodando agora (sem a quantidade de coment√°rios):

```
Execution Time: 11.990 ms
```

Com a quantidade de coment√°rios:

```
Execution Time: 282.519 ms
```

[edit]

Por isso que meu pr√≥ximo objetivo √© otimizar `contents` ü§ù

>> Coment√°rio de filipedeschamps:
Turma, estamos num dos trendings do Github (olha ali qual o reposit√≥rio destacado üòç ) 

<img width="1904" alt="image" src="https://user-images.githubusercontent.com/4248081/203336754-914a817b-4130-4c58-9085-72d2d3444aee.png">

Vi isso por [essa publica√ß√£o](https://www.tabnews.com.br/birobirobiro/filipe-deschamps-tabnews-nos-trendings-do-github) ü§ù

>> Coment√°rio de filipedeschamps:
E os custos na Vercel estabilizaram bastante (est√° alto, mas parou de subir fora do controle):

<img width="1241" alt="image" src="https://user-images.githubusercontent.com/4248081/203337953-84f23ab2-6065-4348-b4e1-76cec055245a.png">

>> Coment√°rio de aprendendofelipe:
> Pelo que estou testando aqui, n√£o vai precisar diminuir, o √≠ndice ajudou muito (num n√≠vel que nem eu sei como). Este √© o resultado para 1 semana rodando agora (sem a quantidade de coment√°rios):

Que maravilha! Depois vou ver com calma o que fizeram nos √≠ndices üöÄ

Ent√£o isso abre margem pra criar mais 2 ou 3 faixas de ranqueamento. Vou planejar aqui.

Por enquanto n√£o vou mudar o limite de 7 dias, mas precisamos acompanhar, pois voc√™ testou com os √∫ltimos 7 dias, mas s√≥ temos 24 horas com alto volume, ent√£o esse tempo pode se multiplicar por 7.

> Turma, estamos num dos trendings do Github (olha ali qual o reposit√≥rio destacado üòç )

Sensacional!!! üòÆüòçüéâüöÄ Parab√©ns Turma!

>> Coment√°rio de filipedeschamps:
> Por enquanto n√£o vou mudar o limite de 7 dias, mas precisamos acompanhar, pois voc√™ testou com os √∫ltimos 7 dias, mas s√≥ temos 24 horas com alto volume, ent√£o esse tempo pode se multiplicar por 7.

Puts √© verdade! N√£o tinha considerado isso ü§ù 

Em paralelo, estou pensando em mostrar os coment√°rios de novo, faz **muita** falta na UX das listas. Vamos fazer um teste para ver se o sistema derrete ou fica ok?

>> Coment√°rio de aprendendofelipe:
> Em paralelo, estou pensando em mostrar os coment√°rios de novo, faz **muita** falta na UX das listas. Vamos fazer um teste para ver se o sistema derrete ou fica ok?

Bora!

>> Coment√°rio de filipedeschamps:
Feito no PR #900 e j√° est√° em Produ√ß√£o ü§ù 

<img width="650" alt="image" src="https://user-images.githubusercontent.com/4248081/203348784-61c3931d-e7ae-470f-a961-9aef8ffe722b.png">

>> Coment√°rio de aprendendofelipe:
> Feito no PR #900 e j√° est√° em Produ√ß√£o ü§ù

Depois nos diga como ficou o banco!

Mais uma boa not√≠cia √© que, olhando as duas √∫ltimas horas, com as √∫ltimas otimiza√ß√µes, estimo que j√° ficaremos quase dentro da cota de 1.000 GB-Hrs mensais... Ainda passa um pouco, mas nem chega aos R$ 1.000,00 mensais (isso pensando no pr√≥ximo per√≠odo, pois com o volume de ontem, esse m√™s j√° est√° totalmente fora da cota).

Bora reduzir isso um pouco mais!

>> Coment√°rio de rodrigoKulb:
N√£o sei como est√£o as visitas mas o n√∫mero de conex√µes com o banco est√° bem est√°vel
![Captura de tela em 2022-11-22 12-26-25](https://user-images.githubusercontent.com/5334261/203353604-8e8a2196-a7e9-41e4-ac96-9116b1693126.png)

>> Coment√°rio de filipedeschamps:
As visitas est√£o √≥timas e est√° bem not√°vel quando foi feito o deploy dos coment√°rios:

<img width="863" alt="image" src="https://user-images.githubusercontent.com/4248081/203366276-3abdf6d8-4710-485d-ab66-94c4729dbaf5.png">

>> Coment√°rio de aprendendofelipe:
> As visitas est√£o √≥timas e est√° bem not√°vel quando foi feito o deploy dos coment√°rios:

Not√°vel, mas totalmente aceit√°vel, n√©?! No tempo de execu√ß√£o das lambdas nem d√° pra ver diferen√ßa. üéâ

>> Coment√°rio de filipedeschamps:
Show! Para estressar um pouco mais o sistema e ficar melhor de identificar as partes lentas da query de conte√∫do, estou voltando todos os coment√°rios (menos na API): #905

>> Coment√°rio de filipedeschamps:
Novamente, √© not√°vel onde foi feito o deploy (pelo menos o pico ali √†s 9h30), mas est√° operando num patamar muito bem e o pr√≥ximo passo agora √© voltar a habilitar na **API** (e ver os testes passarem no CI üôè):

<img width="864" alt="image" src="https://user-images.githubusercontent.com/4248081/203386702-e77599a0-232c-4427-9217-c20a657372f5.png">

>> Coment√°rio de filipedeschamps:
> pr√≥ximo passo agora √© voltar a habilitar na **API**

Plot twist, j√° estava a todo esse tempo retornando os coment√°rios pela API üòÇ  a p√°gina est√°tica usa o mesmo m√©todo que a API usa ü§ù 

Ent√£o no PR #910 eu volto os coment√°rios naquele sub-endpoint `/root` e tamb√©m habilito novamente o fetch adicional pelo SWR na p√°gina de conte√∫do apenas (e n√£o nas `ContentList`).

Enquanto isso, o banco est√° assim:

<img width="867" alt="image" src="https://user-images.githubusercontent.com/4248081/203393021-318e22cc-4395-4586-9c93-9693cb65b4bd.png">

>> Coment√°rio de filipedeschamps:
O deploy do PR #910 teve tamb√©m um commit do @aprendendofelipe para melhorar o ranking da home  e foi feito ali pr√≥ximo das 11h (daqui) e por enquanto est√° ok, mas a din√¢mica desse deploy √© diferente e pode demorar mais para revelar seu impacto, porque o client precisa baixar um novo est√°tico para a feature do `swr` ser habilitada dentro do conte√∫do:

<img width="856" alt="image" src="https://user-images.githubusercontent.com/4248081/203404541-fcc0165e-5201-46cf-9724-bd9e7f1721ce.png">

E caramba como √© importante essa feature, muda completamente a experi√™ncia ver um conte√∫do que voc√™ tem a certeza que est√° fresco ü§ù

>> Coment√°rio de brunofamiliar:
Acabamos de bater o n√∫mero de usu√°rios cadastrados ontem üòÑ. Agora sim!

>> Coment√°rio de rodrigoKulb:
Agora √© s√≥ o @filipedeschamps fazer mais um v√≠deo igual o de ontem para ver se o site segura üòÖÔ∏èüí∏Ô∏èüí∏Ô∏è

>> Coment√°rio de am-castro:
> Me deparei varias vezes com essa tela ja desde que lan√ßou, sem erro em tela, s√≥ no console
> 
> <img alt="image" width="2000" src="https://user-images.githubusercontent.com/18245871/203079247-29b5e21a-5191-4fc5-b7a8-848a4beb91ec.png">

D√° uma olhada nessa issue #906

>> Coment√°rio de filipedeschamps:
@am-castro show! Nesse caso, uma l√≥gica que devemos fazer tamb√©m √© n√£o esconder os dados da lista por falta de retorno da API. E eu n√£o sou muito f√£ destas mensagens que aparecem na tela, acabo preferindo como o GitHub faz que √© quase tudo inline e contextual, no sentido de que a mensagem aparece onde o usu√°rio estiver provavelmente olhando e usando esses Flashes: https://primer.style/react/Flash

E a API recebeu uma pancada de requisi√ß√µes, e por algum motivo o rate limit n√£o pegou e isso refletiu no banco:

<img width="864" alt="image" src="https://user-images.githubusercontent.com/4248081/203429843-33b0116c-873f-4b2f-8013-31ef41a8b4c8.png">

>> Coment√°rio de filipedeschamps:
Turma, vou tentar colocar o Cloudflare na frente. A Vercel n√£o recomenda fazer isso por controle dos est√°ticos, mas estou lendo [este artigo](https://akashrajpurohit.com/blog/how-to-setup-cloudflare-proxy-for-your-website-hosted-on-vercel-or-netlify/) e vamos ver se vai se encaixar nas nossas necessidades.

>> Coment√°rio de aprendendofelipe:
> Turma, vou tentar colocar o Cloudflare na frente. A Vercel n√£o recomenda fazer isso por controle dos est√°ticos, mas estou lendo [este artigo](https://akashrajpurohit.com/blog/how-to-setup-cloudflare-proxy-for-your-website-hosted-on-vercel-or-netlify/) e vamos ver se vai se encaixar nas nossas necessidades.

Ser√° que a Cloudflare agiria em uma rajada t√£o curta? Provavelmente n√£o.

>> Coment√°rio de GTSouza:
Caindo de paraquedas aqui ü™Ç na quest√£o de ataques DoS, talvez seja interessante ter uma camada de WAF.

Vejam que interessante o da AWS https://aws.amazon.com/pt/waf/

Assim teoricamente voc√™ teria um bloqueio de consumo abusivo das APIs antes de elas chegarem a consumir as Lambdas.

>> Coment√°rio de rodrigoKulb:
Pessoal n√£o sei quem viu mas o tabnews foi para primeiro no trending global! üî•Ô∏è

https://github.com/trending/
 
![Captura de tela em 2022-11-23 08-45-43](https://user-images.githubusercontent.com/5334261/203539455-54f92462-4d81-4d16-ab1e-827477b445f6.png)

>> Coment√°rio de aprendendofelipe:
E o @filipedeschamps foi para o topo! üéâ

![image](https://user-images.githubusercontent.com/77860630/203547595-1651993b-05d7-4244-b52d-67253e572169.png)

>> Coment√°rio de aprendendofelipe:
Desde as 22hrs de ontem n√£o tivemos mais nenhum erro e nem timeout nas lambdas.

Se desconsiderar aquela pequena rajada √†s 18:35, ent√£o nas √∫ltimas 24hrs s√≥ tivemos 1 erro e 1 timeout. E isso entre mais de 200.000 invoca√ß√µes das lambdas.

>> Coment√°rio de filipedeschamps:
Sensacional turma, ta tudo muuuito massa üòç esse projeto ta bem vida real, s√≥ que com um detalhe MUITO importante: a gente est√° compartilhando tudo o que est√° acontecendo em detalhes, em p√∫blico, para todo mundo acompanhar. Eu n√£o sei se isso j√° aconteceu no passado com um projeto brasileiro, com as pessoas se comunicando em portugu√™s, muito massa o que estamos fazendo!!!

E como publiquei no TabNews e no post que fiz na comunidade do YouTube, essa galera aqui √© a respons√°vel por tudo isso:

<img src="https://contributors-img.web.app/image?repo=filipedeschamps/tabnews.com.br&max=500">

>> Coment√°rio de filipedeschamps:
> Ser√° que a Cloudflare agiria em uma rajada t√£o curta? Provavelmente n√£o.

Pelos logs, foram 2 mil requests dentro de 30 segundos, o que seria interessante a Clouflare fazer √© entender semanticamente o que aconteceu, por exemplo, o volume natural para aquela rota e o padr√£o igual entre uma request e outra.

De qualquer forma, colocar a Cloudflare na frente traz v√°rios benef√≠cios al√©m de conseguir barrar um ataque massivo, que √© conseguir ter um controle muito refinado da "rede" que passa pelo TabNews, no sentido de bloquear um IP espec√≠fico, redirecionar e rescrever coisas (basicamente o Middleware do Next.js, mas na camada da rede).

>> Coment√°rio de raphox:
Acho que vale dar uma aten√ß√£o a esse TODO aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/1ff8e25690f8985218421ebae81dbab2f9dd580a/pages/pagina/%5Bpage%5D/index.public.js#L66-L68

H√° informa√ß√µes uteis em:

* https://nextjs.org/docs/basic-features/data-fetching/incremental-static-regeneration#using-on-demand-revalidation
* https://on-demand-isr.vercel.app/
* https://github.com/leerob/on-demand-isr/blob/2a9e950f33eb64a4504bf4c49b48d90128635df3/pages/api/webhook.js#L33-L40

>> Coment√°rio de Mr-Guilherme:
@filipedeschamps Como anda a negocia√ß√£o com a Vercel como projeto open source?

>> Coment√°rio de filipedeschamps:
> Acho que vale dar uma aten√ß√£o a esse TODO aqui:

Acho que n√£o vamos ter como fugir do revalidate por conta de "quem paga o custo de tempo para gerar o est√°tico". Fizemos isso no passado da pessoa ao publicar algo gerar os est√°ticos atualizados, mas isso faz a request demorar demais para quem publica, ainda mais considerando que pode precisar ser gerado v√°rios est√°ticos (Relevantes/Recentes/API/Post) e tem ainda as atualiza√ß√µes das TabCoins.


> @filipedeschamps Como anda a negocia√ß√£o com a Vercel como projeto open source?

Acabei de mandar uma mensagem para duas pessoas que eu estava em contato l√° dentro, vamos ver ü§ù

>> Coment√°rio de raphox:
> Acho que n√£o vamos ter como fugir do revalidate por conta de "quem paga o custo de tempo para gerar o est√°tico". Fizemos isso no passado...

Vale lembrar que isso pode ser feito em background em uma fila √∫nica onde um novo job pode anular as anteriores agendadas. Podendo utilizar uma das op√ß√µes:

* https://github.com/bee-queue
* https://github.com/OptimalBits/bull

>> Coment√°rio de MaykonMorais:
Boa noite, pessoal! Andei dando uma olhada nas requests que s√£o realizadas e me surgiu uma d√∫vida: Porque s√£o feitas novas request's sempre que passo o mouse sobre um post? Acredito que s√£o request pra carregar alguns conte√∫dos previamente, mas se eu passar o mouse sobre o post novamente √© feita a mesma request, isso √© realmente necess√°rio? Se h√° a armazenagem desses dados, poderia ser feito uma verifica√ß√£o pra caso essa info j√° esteja armazenada n√£o realizar o request novamente. Acredito que isso diminuiria a quantidade de request.

![image](https://user-images.githubusercontent.com/43121724/203644832-4610e0db-2e4d-4c3a-8b6e-39f2610b96a8.png)

>> Coment√°rio de rodrigoKulb:
Ol√° @MaykonMorais, tudo certo? Fiz o mesmo questionamento aqui, segue o link com a resposta do @filipedeschamps 
https://github.com/filipedeschamps/tabnews.com.br/issues/826#issuecomment-1323664839

>> Coment√°rio de aprendendofelipe:
@MaykonMorais e @rodrigoKulb, isso √© do Next.js.

J√° teve vers√£o que desativa isso quando coloca `prefetch={false}`, mas n√£o √© o caso da que estamos usando agora.

Mas o importante √© que isso praticamente n√£o causa impacto no backend, pois as requisi√ß√µes repetidas s√£o respondidas com 304 ao inv√©s de 200 sempre que n√£o houver um cache novo para baixar. No caso da imagem do @MaykonMorais est√° retornando sempre 200, ent√£o imagino que esteja com o cache desabilitado no DevTools.

E mais, essas requisi√ß√µes de *prefetch* sempre buscam dados do cache, mesmo se o cache estiver obsoleto. Elas s√≥ atingem o banco de dados se ainda n√£o houver cache da p√°gina buscada.

E o motivo para ficar refazendo as requisi√ß√µes √© que a p√°gina pode ter sido revalidada por alguma outra raz√£o (intera√ß√£o de outro usu√°rio), ent√£o ao passar o mouse ir√° receber a vers√£o mais atual nesses casos.

Resumindo, √© como o @filipedeschamps falou, √© para melhorar a UX.

>> Coment√°rio de filipedeschamps:
Turma, em paralelo fiz essa resposta aqui com uma vis√£o geral do nosso **SEO**: https://www.tabnews.com.br/filipedeschamps/142c067f-f98b-42aa-8228-f52a69eddbb3

>> Coment√°rio de filipedeschamps:
Hoje estamos com uma multa de USD 680,00 e o suporte da Vercel ofereceu um cr√©dito de USD 360,00. Vou tentar fazer uma contra proposta ü§ù

<img width="1281" alt="image" src="https://user-images.githubusercontent.com/4248081/203818985-9f3ed1d3-dcf3-4460-951f-efde7b6a2843.png">

>> Coment√°rio de coffeeispower:
Provavelmente a gente vai precisar de olhar pra um heroku da vida se precisar escalar muito

>> Coment√°rio de filipedeschamps:
@coffee-is-power eu estou fazendo um pitch para tentar o patroc√≠nio deles, mas se n√£o conseguirmos, n√£o tem problema, eu assumo a parte que falta da multa **e a gente segue com for√ßa total**. No final das contas, o consumo de processamento fora do controle n√£o foi problema deles, foi nosso e essas bombas explodirem faz parte da maturidade de um sistema.

A gente simplesmente se esqueceu de dimensionar o sistema para o lan√ßamento do v√≠deo üòÇ  (eu pessoalmente n√£o fazia id√©ia que teria tanta tra√ß√£o).

>> Coment√°rio de CarlosZiegler:
Solta um PayPal no ReadME, bora ajudar a pagar isso ai :) 

Eu contribuo :)

>> Coment√°rio de filipedeschamps:
O servidor est√° recebendo alguns erros estranhos, por exemplo:

1) Este usu√°rio https://www.tabnews.com.br/VictorCorrea possui um coment√°rio _"Estou come√ßando a estudar seguran√ßa da informa√ß√£o agora. E eu me impressiono na for√ßa que tem o social hacking, com informa√ß√µes que a gente por livre e expont√¢nea vontade exp√µe na internet."_
2) Mas ao acessar o link, retorna um erro 500: https://www.tabnews.com.br/VictorCorrea/2115040b-ffc7-4a62-80e4-00044938ac92
3) Este √© o erro:
```
Error
    at validator (/var/task/.next/server/chunks/2353.js:3246:20)
    at Object.filterOutput (/var/task/.next/server/chunks/2353.js:757:104)
    at getStaticProps (/var/task/.next/server/pages/[username]/[slug].js:489:122)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Object.renderToHTML (/var/task/node_modules/next/dist/server/render.js:396:20)
    at async doRender (/var/task/node_modules/next/dist/server/base-server.js:699:34)
    at async cacheEntry.responseCache.get.isManualRevalidate.isManualRevalidate (/var/task/node_modules/next/dist/server/base-server.js:804:28)
    at async /var/task/node_modules/next/dist/server/response-cache/index.js:80:36 {
  name: 'ValidationError',
  message: '"body" n√£o pode estar em branco.',
  action: 'Ajuste os dados enviados e tente novamente.',
  statusCode: 400,
  errorId: 'c739c737-caf2-4f0a-8a6f-f01e424ea307',
  requestId: undefined,
  context: undefined,
  errorLocationCode: 'MODEL:VALIDATOR:FINAL_SCHEMA',
  key: 'body',
  type: 'string.empty',
  databaseErrorCode: undefined,
  page: '/[username]/[slug]'
}
RequestId: 31ab2e81-3d5c-4c40-ad2f-498ca84e4952 Error: Runtime exited with error: exit status 1
Runtime.ExitError
```

O curioso √© que al√©m de aparecer o body na lista como esperado, aparece tamb√©m no conte√∫do pai: https://www.tabnews.com.br/LRamony/top-25-ferramentas-de-recon-para-seguranca-da-informacao

E tamb√©m pegando o retorno pela API:

https://www.tabnews.com.br/api/v1/contents/VictorCorrea/2115040b-ffc7-4a62-80e4-00044938ac92

No banco de dados, a linha do conte√∫do parece normal, este √© o body:

```
Estou come√ßando a estudar seguran√ßa da informa√ß√£o agora.
E eu me impressiono na for√ßa que tem o social hacking, com informa√ß√µes que a gente por livre e expont√¢nea vontade exp√µe na internet.
```

E este comportamento come√ßou a aparecer do nada e mais links diretos de publica√ß√£o est√£o sofrendo isso:

<img width="433" alt="image" src="https://user-images.githubusercontent.com/4248081/203850746-e5962dec-4ef1-4b14-b647-cb67664c4c36.png">

Estou me perguntando se a Vercel possa estar fazendo algum cache parcial dos dados, dado que isto est√° acontecendo na gera√ß√£o da p√°gina est√°tica.

Utiliza√ß√£o do processamento do banco nas √∫ltimas 24 horas:

<img width="867" alt="image" src="https://user-images.githubusercontent.com/4248081/203851320-1ffacdfb-9219-41c2-acc5-07947c27ef99.png">

>> Coment√°rio de filipedeschamps:
> Solta um PayPal no ReadME, bora ajudar a pagar isso ai :)
> 
> Eu contribuo :)

ahhaha show meu caro! Vamos ver se a Vercel aceita a proposta do patroc√≠nio.

---

Em paralelo, vou for√ßar um deploy para limpar o cache dos est√°ticos ü§ù

>> Coment√°rio de filipedeschamps:
Fazer um novo deploy n√£o consertou o problema, continua dando erro 500: https://www.tabnews.com.br/VictorCorrea/2115040b-ffc7-4a62-80e4-00044938ac92

Algu√©m tem algum palpite?

>> Coment√°rio de filipedeschamps:
S√£o v√°rios erros, mas acho que s√≥ **duas** publica√ß√µes est√£o com esse problema, esta √© a outra:

https://www.tabnews.com.br/marinaToscano/0c1ce3c5-d8a8-4bdd-a7d2-f4facb758392

Mesmo comportamento, tudo funciona:

https://www.tabnews.com.br/api/v1/contents/marinaToscano/0c1ce3c5-d8a8-4bdd-a7d2-f4facb758392

<img width="1103" alt="image" src="https://user-images.githubusercontent.com/4248081/203853517-6dbc8088-5527-412a-8cdc-682add8efbd5.png">

>> Coment√°rio de aprendendofelipe:
O problema √© o conte√∫do root que quando chega nessa parte do c√≥digo acaba ficando sem `body`

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/pages/%5Busername%5D/%5Bslug%5D/index.public.js#L378-L379

>> Coment√°rio de aprendendofelipe:
Os dois conte√∫dos `root` foram corrigidos adicionando a palavra "imagem" dentro dos colchetes: `![imagem](https://...)`

Ser√° que tem mais algum conte√∫do assim?

Vamos ter que passar o `removeMarkdown` antes de validar o `body` ou fazer alguma outra valida√ß√£o.

>> Coment√°rio de brunofamiliar:
Tentei verificar pelas requisi√ß√µes algum padr√£o e n√£o consegui identificar esse ponto. Vou tirar a noite de hoje pra atualizar o projeto na minha m√°quina e facilitar essas an√°lises

>> Coment√°rio de filipedeschamps:
> Os dois conte√∫dos `root` foram corrigidos adicionando a palavra "imagem" dentro dos colchetes: `![imagem](https://...)`
> 
> Ser√° que tem mais algum conte√∫do assim?
> 
> Vamos ter que passar o `removeMarkdown` antes de validar o `body` ou fazer alguma outra valida√ß√£o.

Voc√™ √© um g√™nio @aprendendofelipe 



> Tentei verificar pelas requisi√ß√µes algum padr√£o e n√£o consegui identificar esse ponto. Vou tirar a noite de hoje pra atualizar o projeto na minha m√°quina e facilitar essas an√°lises

Sensacional @brunofamiliar mas pe√ßo que veja o coment√°rio do @aprendendofelipe , pois ele matou a charada ü§ù eu tamb√©m fiquei muito focado no conte√∫do em s√≠ tentando achar um padr√£o e analisar o conte√∫do `root` passou despercebido üëç

>> Coment√°rio de brunofamiliar:
√â o maior @aprendendofelipe de todos os tempos!! üòÇüòÇ

>> Coment√°rio de am-castro:
> filipedeschamps

[filipedeschamps](https://github.com/filipedeschamps) Sobre a issue #906 poderia ser opcional o toastify ou at√© mesmo outro modo de alerta. Por isso o service, para gerenciar o modo que aconteceria, baseado nas prefer√™ncias do usu√°rio. Por exemplo, eu prefiro mensagens na tela que mostram at√© o tempo que ir√£o desaparecer, j√° meus amigos preferem um sininho que mostre a mensagem, como esp√©cie de log. No sistema que trabalho, o modo √© opcional.

O ideal √© o usu√°rio ter o retorno, de algum modo sabe. Fiquei clicando em salvar v√°rias vezes, at√© me dar conta de que a requisi√ß√£o estava sendo feita, s√≥ n√£o mostrava nada

>> Coment√°rio de aprendendofelipe:
O site estava fora quase agora. Retornava 429, ou seja, mais de 1000 acessos simult√¢neos. Mas logo voltou. Mais um ataque?

>> Coment√°rio de aprendendofelipe:
Deu 429 em p√°gina est√°tica e n√£o tem nada no console da Vercel. J√° colocou a Cloudflare? Ser√° que √© isso?

>> Coment√°rio de filipedeschamps:
√â exatamente isso @aprendendofelipe estava em call com a Vercel agora, como est√° o seu acesso por ai?

>> Coment√°rio de aprendendofelipe:
Agora est√° normal üëç

>> Coment√°rio de filipedeschamps:
Show! Estou acompanhando do DNS propagar aqui: https://dnschecker.org/#NS/tabnews.com.br

<img width="527" alt="image" src="https://user-images.githubusercontent.com/4248081/204059080-dac060ce-498c-4a8c-be07-041ee8c36fd1.png">

Em paralelo, n√£o deu para visualizar nada no volume de requests entrando por enquanto:

<img width="1725" alt="image" src="https://user-images.githubusercontent.com/4248081/204059124-461161a3-e305-464f-90c1-8ab0389a87d3.png">

As 6 requests com erro s√£o do exato mesmo bug do `body` que, depois de limpo, fica em branco, da√≠ editei a publica√ß√£o para consertar ü§ù

>> Coment√°rio de filipedeschamps:
O DNS ainda est√° propagando, mas por enquanto tudo est√° ok e eu acabei de contratar a vers√£o PRO da Cloudflare para ser poss√≠vel colocar algumas configura√ß√µes adicionais.

Em paralelo, vou marcar um call com outra pessoa l√° dentro da Vercel para apresentar mais sobre o projeto.

No mais, recebi esse email aqui (e n√£o parece ser preocupante):

<img width="648" alt="image" src="https://user-images.githubusercontent.com/4248081/204063917-279e4d4a-6f5e-4e59-85d6-349f43d36e36.png">

>> Coment√°rio de filipedeschamps:
> O site estava fora quase agora. Retornava 429, ou seja, mais de 1000 acessos simult√¢neos. Mas logo voltou. Mais um ataque?

To vendo aqui que isto pode estar sendo causado pelo proxy do Cloudflare, onde as requests est√£o vindo com o ip s√≥ do range dos servidores deles, ent√£o est√° disparando mais `429` que o normal.

Ent√£o essa fun√ß√£o vai ter que saber interpretar os headers da Cloudflare:

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/models/controller.js#L25

**[edit]**

Implementa√ß√£o no PR #976

>> Coment√°rio de filipedeschamps:
@aprendendofelipe em paralelo, pequei um bugzinho nada urgente de UX onde d√° para usar o CTRL+Enter para dar m√∫ltiplos posts.

>> Coment√°rio de filipedeschamps:
Acredito que foi ajustado. Este √© o gr√°fico do meu ip, onde ele foi escondido pelo proxy da Cloudflare logo depois que colocamos ela no ar por volta das 13h (daqui). Depois, por volta das ~18h eu desliguei o proxy da Cloudflare e meu ip voltou a aparecer (mas da√≠ ficamos sem a prote√ß√£o deles). E da√≠ a partir das ~19h eu fiz o deploy e reabilitei o proxy, e o meu ip continuou aparecendo nos logs ü§ù 

Lembrando que, o que √© salvo no banco de dados para o controle do nosso Firewall, n√£o √© o ip completo, √© uma m√°scara üëç 

<img width="1089" alt="image" src="https://user-images.githubusercontent.com/4248081/204070782-3fa81a1a-585b-4528-9bc3-ea707db6079c.png">

>> Coment√°rio de filipedeschamps:
Mas isso causou um outro problema: est√° come√ßando a entrar `ipv6` e a m√°scara quebra.

>> Coment√°rio de rodrigoKulb:
@filipedeschamps chegamos a fazer algum teste de DDOS? N√£o conhecia o proxy Cloudflare para ataques. Seria legal mostrar na pr√°tica funcionando. Testei fazer um wget aqui com 1.000 requisi√ß√£o no tabnews e rodou normal nas 1.000. Temos outra forma de testar?

>> Coment√°rio de fitinge:
Tenho bastante problemas com os custos de projetos maiores na vercel, assim como voc√™ est√° tendo agora @filipedeschamps 
Inclusive tinha criado uma postagem sobre isso: https://www.tabnews.com.br/fitinge/custos-projetos-nextjs-na-vercel-alternativas

>> Coment√°rio de filipedeschamps:
Aparentemente tudo est√° funcionando: nenhum log de erro e com suporte a `IPv4` e `IPv6`, agora ambos mascarados, mas vou continuar a ficar colado nos logs e no email do `contato@`:

![image](https://user-images.githubusercontent.com/4248081/204105466-d40ac36d-de6b-4d88-b33b-ad5e6681f82d.png)

>> Coment√°rio de filipedeschamps:
Numa vis√£o geral dos logs da **Axiom**, a quantidade de requests que est√£o entrando est√° **reduzindo bastante** e posso especular 4 coisas:

1. A implementa√ß√£o est√° quebrada, por√©m por enquanto n√£o tive nenhum retorno e cadastros, publica√ß√µes, upvotes ainda est√£o acontecendo.
2. A Cloudflare est√° barrando `bots` maliciosos que poderiam estar escaneando o site, ela faz isso automaticamente.
3. A Axiom n√£o tem suporte a `IPv6`, por√©m quase descartado essa possibilidade, pois eu estou vendo nos cabe√ßalhos que est√° entrando ips nesse formato.
4. A Cloudflare est√° fazendo o **cache** de certas requests e n√£o est√° mais passando para Vercel, e eu acho que esta possa ser a alternativa mais prov√°vel. O que acham?

<img width="431" alt="image" src="https://user-images.githubusercontent.com/4248081/204106219-e1d2d237-6a47-4599-801e-b1acdfc68674.png">


Sobre o cache da Cloudflare, eu digo por conta desta imagem abaixo (eu n√£o sei ainda exatamente o que ela est√° nos salvando em quest√£o de bandwith):

<img width="343" alt="image" src="https://user-images.githubusercontent.com/4248081/204106230-3cf440c8-8c70-4137-8fb9-73972183ac11.png">


# Ajuda

Turma, voc√™s conseguem me ajudar a testar se est√° tudo certo? As vezes a propaga√ß√£o de IP pode influenciar nessas coisas, ent√£o qualquer teste de qualquer regi√£o √© v√°lido ü§ù

>> Coment√°rio de gabrielsozinho:
Testar seria usar o site? Por aqui (Bel√©m) est√° tudo normal. Estou usando normalmente, inclusive consegui comentar e dar "up vote".

>> Coment√°rio de 33gustavo33:
Se testar significa usar o site, Aqui (Brasil/RS) est√° normal tamb√©m.

>> Coment√°rio de aprendendofelipe:
Est√°ticos e API aqui em Londrina tudo normal! üéâ

> @aprendendofelipe em paralelo, pequei um bugzinho nada urgente de UX onde d√° para usar o CTRL+Enter para dar m√∫ltiplos posts.

Verei isso depois üòâ

>> Coment√°rio de filipedeschamps:
Muito obrigado pela ajuda turma!!! O volume dos logs estabilizou, mas est√° operando em outro patamar. Continuo com a teoria de que a Cloudflare est√° cacheando algumas requests e n√£o enviando mais para Vercel.

<img width="431" alt="image" src="https://user-images.githubusercontent.com/4248081/204107776-056beb6d-748c-400e-bf3d-bd341841bd08.png">

---



> @filipedeschamps chegamos a fazer algum teste de DDOS? N√£o conhecia o proxy Cloudflare para ataques. Seria legal mostrar na pr√°tica funcionando. Testei fazer um wget aqui com 1.000 requisi√ß√£o no tabnews e rodou normal nas 1.000. Temos outra forma de testar?

N√≥s n√£o, mas j√° fizeram por n√≥s v√°rias vezes üòÇ  ainda n√£o estressei as seguran√ßas do Cloudflare, mas tem muita coisa legal! E por enquanto `1.000` requisi√ß√µes (dependendo de em quantos segundos voc√™ fizer ela e qual endpoint), n√£o ir√° disparar nosso rate-limiter.



> Tenho bastante problemas com os custos de projetos maiores na vercel, assim como voc√™ est√° tendo agora @filipedeschamps Inclusive tinha criado uma postagem sobre isso: https://www.tabnews.com.br/fitinge/custos-projetos-nextjs-na-vercel-alternativas

Show meu caro! Vou conversar com eles e repasso qual foi a evolu√ß√£o no nosso caso.

>> Coment√°rio de filipedeschamps:
Este gr√°fico d√° para ver melhor o novo patamar (a partir das ~11h daqui):

<img width="577" alt="image" src="https://user-images.githubusercontent.com/4248081/204107820-8319783f-36ff-49bd-9174-73cd2d7d289e.png">

O interessante √© que as **visitas √∫nicas**, vistas pelo ponto de vista dos logs, n√£o teve altera√ß√£o (os dois gr√°ficos est√£o usando o mesmo range de `6` horas):

<img width="574" alt="image" src="https://user-images.githubusercontent.com/4248081/204107841-6df0f21c-777b-4866-877d-1e38281919ac.png">

>> Coment√°rio de aprendendofelipe:
Na Cloudflare voc√™ deve conseguir as respostas se √© o cache deles que est√° causando essa redu√ß√£o

![image](https://user-images.githubusercontent.com/77860630/204107914-6de5b17c-a455-486f-a233-96802b4602fd.png)

>> Coment√°rio de filipedeschamps:
@aprendendofelipe gr√°fico da Cloudflare no mesmo per√≠odo de `6` horas:

<img width="1323" alt="image" src="https://user-images.githubusercontent.com/4248081/204107969-e9ab68d6-cf53-4bf1-bf41-c4a13f54e4a6.png">

>> Coment√°rio de aprendendofelipe:
Se a resolu√ß√£o do gr√°fico do Axiom for de 1 minuto, ent√£o os dados a partir de 11hrs parecem bater (requisi√ß√µes sem cache na Cloudflere mais ou menos igual ao volume na Vercel).

Ent√£o olhando a propor√ß√£o com e sem cache na Cloudflare, parece que a redu√ß√£o na Vercel n√£o √© por causa do cache.

>> Coment√°rio de filipedeschamps:
@aprendendofelipe conferi aqui e na Axiom a resolu√ß√£o √© de 1 minuto para o gr√°fico de 6 horas üëç 

Em paralelo, o que eu notei no gr√°fico de popular regions √© que a regi√£o `gru1` (sa-east-1 / SP) diminuiu e a regi√£o `iad1` (us-east-1 / Washington) aumentou. Isso n√£o explica a queda total de volume, mas achei curioso, √© como se a Cloudflare estivesse se comunicando com a AWS por l√° (o que √© ruim se ela estiver batendo em algum endpoint da API).

>> Coment√°rio de aprendendofelipe:
Eu tive mesmo a impress√£o da API estar demorando um pouco mais para responder. S√≥ n√£o tinha comentado porque podem ser diversos outros fatores. Mas j√° que comentou, compare os tempos desse endpoint:

https://www.tabnews.com.br/api/v1/contents?strategy=new&page=50

Aqui voc√™ mostrou os tempos antes e depois do PR https://github.com/filipedeschamps/tabnews.com.br/pull/823#issuecomment-1319403721, s√≥ que depois disso baixou ainda mais o tempo com a cria√ß√£o dos √≠ndices.

E agora parece que est√° um pouco pior do que na sua captura.

>> Coment√°rio de aprendendofelipe:
> No mais, recebi esse email aqui (e n√£o parece ser preocupante):
> 
> <img alt="image" width="648" src="https://user-images.githubusercontent.com/4248081/204063917-279e4d4a-6f5e-4e59-85d6-349f43d36e36.png">

Est√° dentro do estimado. S√≥ lembrando que esse mesmo volume ser√° cobrado com um valor maior na Upstash.

>> Coment√°rio de aprendendofelipe:
Para ver se a redu√ß√£o est√° relacionada com `bots` ou outro bloqueio de seguran√ßa, basta ver os *Threats* na aba *Security*.

>> Coment√°rio de filipedeschamps:
Teve um aumento sim:

<img width="1582" alt="image" src="https://user-images.githubusercontent.com/4248081/204109130-57a3670d-3d8c-4949-a1e3-a8a676db26e8.png">

E threats n√£o teve nenhuma, mas encontrei isso aqui:

<img width="1053" alt="image" src="https://user-images.githubusercontent.com/4248081/204109183-bccdcfda-7927-4636-a85d-af03e33de11a.png">

>> Coment√°rio de filipedeschamps:
Uma observa√ß√£o, √© que o aumento de lat√™ncia do endpoint n√£o casa com o hor√°rio de virada da Cloudflare (que foi por volta das ~11h daqui), mas casa com um aumento de processamento no banco:

<img width="875" alt="image" src="https://user-images.githubusercontent.com/4248081/204109315-9dc0c08b-6cfe-4d4d-8158-e6eb461cb1c9.png">

>> Coment√°rio de filipedeschamps:
Crawler del√≠cia rodando contra o `/api/v1/contents` üòÇ  precisamos colocar cache nessas rotas e deixar tudo est√°tico como as p√°ginas:

<img width="1574" alt="image" src="https://user-images.githubusercontent.com/4248081/204109469-5fd8c4bf-c824-4259-9157-333b2be361a0.png">

>> Coment√°rio de aprendendofelipe:
> Uma observa√ß√£o, √© que o aumento de lat√™ncia do endpoint n√£o casa com o hor√°rio de virada da Cloudflare (que foi por volta das ~11h daqui), mas casa com um aumento de processamento no banco:

Que bom que √© isso!

> Crawler del√≠cia rodando contra o `/api/v1/contents` üòÇ 

Voc√™ pediu pra testarem üòú

>> Coment√°rio de rodrigoKulb:
Sugest√£o de parceria com a vercel, podemos criar uma p√°gina intermediaria explicando como funciona a parceria deixando o projeto com maior transpar√™ncia. 

Essa parceria poderia ter uma dura√ß√£o de 1 ano, pelo menos para sustentar essa etapa do projeto!

Caso a Vercel n√£o tenha interesse de fechar essa parceria, podemos fechar com alguma empresa que **pague** a hospedagem do projeto.

![Captura de tela em 2022-11-27 10-59-22](https://user-images.githubusercontent.com/5334261/204139358-9d63da46-fe2e-44c0-918c-7b45ce7d5255.png)

>> Coment√°rio de aprendendofelipe:
Passamos de 1 milh√£o, turma!!!

![image](https://user-images.githubusercontent.com/77860630/204422532-dc8c86ea-96e3-4671-932d-dd8df9185469.png)

>> Coment√°rio de filipedeschamps:
Desafio do dia: tentar dormir depois de ler essa mensagem aqui üòÖ

![image](https://user-images.githubusercontent.com/4248081/204657273-7a04bb74-2d4d-408a-83f8-c649c998ae10.png)

>> Coment√°rio de rodrigoKulb:
@filipedeschamps como ficou a negocia√ß√£o com a Vercel, acha que vale fazer uma parceria?

Sobre essa conta eu me comprometo com 20% ai! Depois passa uma forma de transfer√™ncia pra voc√™! A vaquinha online pode ser uma boa op√ß√£o.

>> Coment√°rio de filipedeschamps:
@rodrigoKulb voc√™ √© sensacionaaaaaal üòç pinguei o respons√°vel da Vercel hoje e ele pediu mais uma semana, pois est√° em um evento. Ent√£o tenho vamos marcar um call semana que vem ü§ù  sugiro aguardarmos o call, pois existe ainda a possibilidade de estorno üëç

>> Coment√°rio de CarlosZiegler:
Joga o PayPal a√≠ e bora levantar essa grana, al√©m do suporte da vercel se
der certo eu sou de colocar um bot√£o de doa√ß√£o, para investir no projeto :)


Em ter., 29 de nov. de 2022 √†s 23:15, Filipe Deschamps <
***@***.***> escreveu:

> @rodrigoKulb <https://github.com/rodrigoKulb> voc√™ √© sensacionaaaaaal üòç
> pinguei o respons√°vel da Vercel hoje e ele pediu mais uma semana, pois est√°
> em um evento. Ent√£o tenho vamos marcar um call semana que vem ü§ù sugiro
> aguardarmos o call, pois existe ainda a possibilidade de estorno üëç
>
> ‚Äî
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/826#issuecomment-1331390826>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AJIOGU7KGALSQYOIIGWXXDDWKZ6B3ANCNFSM6AAAAAASGV7EUY>
> .
> You are receiving this because you were mentioned.Message ID:
> ***@***.***>
>
--

>> Coment√°rio de filipedeschamps:
Turma, voc√™s s√£o demais ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è como falei na Live, n√£o sei o que fazer sobre essa quest√£o das doa√ß√µes, mas dado a quantidade de pedidos, o email para o Paypal √© este: contato@filipedeschamps.com.br

E independente do que acontecer, a ajuda de voc√™s ir√° fazer **muita** diferen√ßa a tirar um baita peso das minhas costas ü§ù 

Depois fa√ßo um levantamento de todos todas as doa√ß√µes e todos os custos atuais: Vercel, AWS, Upstash e Mailgun üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps o projeto precisa ser autossuficiente, ele n√£o pode gerar prejuizo para nenhum dos membros, agora no inicio estamos na fase de ajustes e estrat√©gias, acho v√°lido. Mas precisamos montar sistema de parcerias / doa√ß√µes para conseguir bancar os custos de infra.

Conforme falei 20% da multa paga!
![Captura de tela em 2022-12-01 16-36-28](https://user-images.githubusercontent.com/5334261/205144366-2bd1cc97-3e22-42dd-9725-a601cee4c66c.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb n√£o me aguentei e gravei um v√≠deo resposta: https://youtu.be/swGPqzzyjGY

>> Coment√°rio de silvaezequias:
@filipedeschamps sei que esse n√£o √© o melhor local pra isso mas n√£o sei onde mais mostrar: https://www.tabnews.com.br/ApoloChase/sites-e-grupos-de-livros-de-graca
Acho que isso vai contra os termos do TabNews, pirataria.
Se puder me listar nomes de moderadores do TabNews para que eu possa repassar futuramente quaisquer problemas relacionados a isso, agrade√ßo desde j√°.

>> Coment√°rio de brunofamiliar:
@CarlosZiegler na react conf agora galera: https://www.youtube.com/watch?v=5TEWMO9nQQg

>> Coment√°rio de filipedeschamps:
**Turma, n√≥s fomos aceitos no programa de projetos open source da Vercel** üéâ

Eu ainda n√£o consegui negociar o estorno da multa, mas √© o que estou lidando neste exato momento ü§ù 

Em paralelo, a pessoa l√° t√° bem impressionada com o uso do TabNews e inclusive habilitou 2 recursos `Beta` na nossa conta que √© o `Monitoring` e `Logs`. Isso vai contribuir ainda mais para otimizarmos o servi√ßo üëç

>> Coment√°rio de rodrigoKulb:
@filipedeschamps s√≥ completando a d√∫vida que voc√™ ficou sobre os 20% da multa, se receber o estorno utilize para os custos mensais do projeto! üöÄÔ∏è 

PS: Postei um artigo no tabnews ontem https://www.tabnews.com.br/rodrigoKulb/boas-praticas-para-criar-um-pull-request-no-projeto-tabnews-com-br segura a fila de PRs agora hahaha!

Bora Brasil üáßüá∑Ô∏èüáßüá∑üáßüá∑Ô∏èÔ∏è

>> Coment√°rio de CarlosZiegler:
@rodrigoKulb Muito massa e bem detalhado os passos para um PR, isso t√° documentado no projeto, digo com esses detalhes e tal ? Se a respondia eh n√£o, acho bem v√°lido :)

>> Coment√°rio de rodrigoKulb:
Total @CarlosZiegler! Depois podemos criar um **√≠ndice** para facilitar todas as postagens sobre o desenvolvimento do tabnews. Essa **Issue** ta parecendo um chat do **Discord** hahaha! Virou o chat oficial do projeto hahaha!!

>> Coment√°rio de filipedeschamps:
> @filipedeschamps s√≥ completando a d√∫vida que voc√™ ficou sobre os 20% da multa, se receber o estorno utilize para os custos mensais do projeto! üöÄÔ∏è

Fechad√≠ssimo meu caro üòç  ent√£o engatando outros custos, eu loguei no servi√ßo de emails que enviamos, o Mailgun, e o gr√°fico abaixo √© a quantidade de disparos diariamente, olha que legal depois do lan√ßamento (saiu de uma m√©dia de `60` emails por dia, para um pico de `4.079`):

<img width="1390" alt="image" src="https://user-images.githubusercontent.com/4248081/205751335-4e52447a-f76c-4345-abff-c067394403ac.png">

N√≥s estamos neste plano que custa `$35 / m√™s`

<img width="245" alt="image" src="https://user-images.githubusercontent.com/4248081/205751873-e8be4a90-b2f8-452e-abf6-df770e1e078a.png">

Agora que o site vai voltar para um n√≠vel de uso mais normal/natural, vamos ficar dentro desse plano sem problemas ü§ù

>> Coment√°rio de filipedeschamps:
E a fatura da AWS no √∫ltimo ciclo fechou em `CAD $66.20`. Aumentou consideravelmente por conta da inst√¢ncia do banco de dados e esse ciclo vai fechar maior, porque o upgrade pegou o parcial do m√™s.

Uma coisa a considerar √© se vale a pena a gente manter a infra na regi√£o de SP (que √© mais cara) e migrar para `us-east` (que √© mais barata, mas mais longe do Brasil). Digo isso, porque estamos com duas camadas adicionais que causam uma lat√™ncia natural e inevit√°vel: Cloudflare e Middleware (com rate-limit secund√°rio, que bate numa inst√¢ncia de Redis).

>> Coment√°rio de CarlosZiegler:
Quais s√£o os servi√ßos que est√£o sendo usados no momento? Digo qual servi√ßo e para qual finalidade? Talvez possamos repensar algumas estrat√©gias n√£o ?

>> Coment√°rio de CarlosZiegler:
Poderia colocar quais servi√ßos e os valores pagos, para termos uma no√ß√£o de custos com o projeto.

>> Coment√°rio de aprendendofelipe:
Sobre o banco em S√£o Paulo ou Norte da Virg√≠nia... Em SP √© o dobro do pre√ßo, n√©?

S√≥ que se mudar o local do banco, √© melhor mudar tamb√©m as lambdas da Vercel para a mesma regi√£o.

No uso normal do sistema s√≥ seria percept√≠vel um pequeno aumento na lat√™ncia ao publicar ou votar nos conte√∫dos e no cadastro/login.

Na navega√ß√£o pelos conte√∫dos das primeiras p√°ginas (relevantes ou recentes) n√£o deve ser percebida nenhuma diferen√ßa por causa do cache na CDN da Vercel.

Outra quest√£o sobre o banco... Como est√° a utiliza√ß√£o da inst√¢ncia nos √∫ltimos dias? Com as otimiza√ß√µes e com a prote√ß√£o da Cloudflare, ainda √© necess√°rio manter essa inst√¢ncia com mais mem√≥ria? S√≥ mudou a quantidade de mem√≥ria, n√©? Se estiver muito subutilizada, talvez compense voltar para a anterior.

>> Coment√°rio de aprendendofelipe:
> Poderia colocar quais servi√ßos e os valores pagos, para termos uma no√ß√£o de custos com o projeto.

Vou colocar aproximadamente o que eu lembro e da√≠ o @filipedeschamps complementa ou corrige se eu errar algo (valores mensais):

Vercel = n√£o sei como ficar√° com a parceria (era $40 antes do lan√ßamento).
Cloudflare = $20
PostgreSQL (homologa√ß√£o) = $14
PostgreSQL (produ√ß√£o) = $105 ($30 antes do lan√ßamento)
Mailgun = $35
Axiom = $0 ou $99 (acho que $99)
Upstash = Vari√°vel (cobrado por comandos de leitura/grava√ß√£o e por armazenamento)
Backup do banco = ???

Posso estar esquecendo de algo

[Edit] Corrigi os valores do banco, pois tinha calculado com proxy

>> Coment√°rio de rodrigoKulb:
Vou tabelar abaixo assim que confirmar com o @filipedeschamps atualizo os valores, tudo mensal?

Servi√ßo |  Valor
:--------- | -------:
Vercel | $ 40,00 / m√™s
Cloudflare | $ 20,00  / m√™s
PostgreSQL (homologa√ß√£o)  |  $ 14,00  / m√™s
PostgreSQL (produ√ß√£o)  |  $105,00  / m√™s
Mailgun | $35,00  / m√™s
Axiom | $99,00  / m√™s
Upstash | ??
Backup do banco | ??
**Total** |  **$ 313,00  / m√™s**

>> Coment√°rio de Jeiel0rbit:
Ent√£o s√£o voc√™s que est√£o "afundando os demais que est√£o hospedado". Brincadeira a parte, sugiro uma campanha para apoiar a causa, seguido com uma boa explica√ß√£o.  Aviso seja dado no YouTube, Discord (n√£o oficial), e-mail e no pr√≥prio Tabnews (com dialog se poss√≠vel). 

[Tip]

![Screenshot_20221205-205948.png](https://user-images.githubusercontent.com/72875404/205772668-e5456974-e34f-4c17-b962-4962fc1ffa23.png)

[Em tradu√ß√£o livre]

Fonte: https://www.vercel-status.com/

> Me perdi em alguns coment√°rios, perdoe me se estou repetitivo com outro coment√°rio se existente.

>> Coment√°rio de filipedeschamps:
Fiz uma publica√ß√£o bem grande sobre o estado atual do TabNews e os pr√≥ximos passos: https://www.tabnews.com.br/filipedeschamps/tabnews-atinge-1-5-milhoes-de-views-e-futuro-do-projeto-alerta-de-textao

E conectado ao assunto sobre redu√ß√£o de custo, estava pensando: agora que temos rate-limit direto pela Cloudflare, ser√° que vale a pena removermos a Upstash? Com a Upstash conseguimos fazer um rate-limit customizado por endpoint, coisa que nossa conta atual da Cloudflare n√£o permite (s√≥ podemos criar 2 regras). Mas ao mesmo tempo, nossa regra na Cloudflare est√° com um limite que eu considero baixo e suficiente para barrar e cobrir ataques, sem deixar eles escalarem para um problema maior:

<img width="333" alt="image" src="https://user-images.githubusercontent.com/4248081/206026322-0d7579e9-0d62-464b-a6ee-56d68ab0abc5.png">

Especulo que conseguimos baixar ainda mais e ainda assim fornecer uma API saud√°vel para qualquer `client`. E decidi expor esses valores aqui, porque √© muito f√°cil de estressar e descobrir eles, seja qual for o valor.

O que acham?

>> Coment√°rio de aprendendofelipe:
Sobre n√£o passar pelo Upstash todos os endpoints, acho que agora d√° pra fazer isso tranquilamente!

Mas n√£o tem nenhum custo fixo e pagamos apenas conforme o uso, certo?  Se for isso mesmo, poderia por enquanto manter os c√≥digos e configura√ß√µes apenas de stand-by para ser mais f√°cil de voltar a direcionar para o Redis algum endpoint que precisar de aten√ß√£o especial.

>> Coment√°rio de CarlosZiegler:
Nao daria para adicionar isso como feature toggle ? E caso precise , ligar ela ? 

https://martinfowler.com/articles/feature-toggles.html

>> Coment√°rio de filipedeschamps:
> Mas n√£o tem nenhum custo fixo e pagamos apenas conforme o uso, certo? Se for isso mesmo, poderia por enquanto manter os c√≥digos e configura√ß√µes apenas de stand-by para ser mais f√°cil de voltar a direcionar para o Redis algum endpoint que precisar de aten√ß√£o especial.

Correto, o pagamento √© conforme o uso ü§ù 

Sobre as vari√°veis de ambiente, podemos deixar l√° total. Sobre a parte do c√≥digo, como podemos fazer esse controle? O que acha de na vari√°vel `RATE_LIMIT` colocar uma chave para "ligar e desligar", conforme sugerido pelo @CarlosZiegler ?

>> Coment√°rio de filipedeschamps:
@AugustoResende conforme combinado, estou removendo os coment√°rios aqui nessa issue, e caso queira conversar de forma privada em contato@tabnews.com.br para calibrarmos uma segunda publica√ß√£o l√° no TabNews, me coloco a 100% de disposi√ß√£o para lhe ajudar, inclusive eu ficaria extremamente feliz que isso acontecesse, combinado? ü§ù

>> Coment√°rio de aprendendofelipe:
O middleware vai permanecer pegando todos os caminhos, certo?

Talvez s√≥ adicionar algo assim, l√° ap√≥s o condicional que verifica o host:

```js
const listaDeCaminhosLimitados = []

if (!listaDeCaminhosLimitados.includes(request.nextUrl.pathname)) {
  return NextResponse.next();
}
```

E se for necess√°rio voltar algum endpoint para o Upstash, √© s√≥ adicionar no array.

>> Coment√°rio de filipedeschamps:
Hmm interessante, eu estava pensando em adicionar uma condicional aqui para verificar por aquela chave/feature flag:

https://github.com/filipedeschamps/tabnews.com.br/blob/9ab4433273eab71296a1cd14783a4698fd2749a7/infra/rate-limit.js#L7-L11

Da√≠ n√£o precisaria mexer em c√≥digo, seria s√≥ em vari√°vel de ambiente e for√ßar um novo deploy.

[edit] mas tamb√©m n√£o vai dar certo, pois vamos aumentar o escopo do `middleware` para todos est√°ticos tamb√©m.

>> Coment√°rio de aprendendofelipe:
> Da√≠ n√£o precisaria mexer em c√≥digo, seria s√≥ em vari√°vel de ambiente e for√ßar um novo deploy.

A `listaDeCaminhosLimitados` pode vir das vari√°veis de ambiente üëç

>> Coment√°rio de aprendendofelipe:
No PR #1101 fiz uma sugest√£o de implementa√ß√£o.

Retirei o `matcher` do `config`, ent√£o o que est√° valendo √© a configura√ß√£o espec√≠fica da *branch* `rate-limit-paths-env` nas vari√°veis na Vercel.

Com isso, s√≥ para teste, essa vers√£o est√° com rate-limit do Upstash tamb√©m no caminho `/recentes`, al√©m do `/api`:

https://tabnews-1jscf0m4s-tabnews.vercel.app/recentes

>> Coment√°rio de CarlosZiegler:
Daria para implementar esse carinha aqui : https://www.getunleash.io

Assim vc tem um painel para ativar/desativar features. Tem plano free para Open Source S2

>> Coment√°rio de aprendendofelipe:
> Daria para implementar esse carinha aqui : https://www.getunleash.io
> 
> Assim vc tem um painel para ativar/desativar features. Tem plano free para Open Source S2

Legal esse servi√ßo @CarlosZiegler, mas acho que √© muito al√©m do que o necess√°rio para voltar a habilitar o rate-limit do Upstash em algum endpoint espec√≠fico, se √© que vamos precisar fazer isso.

Talvez eu n√£o tenha entendido a melhor maneira de utiliz√°-lo, pois ter√≠amos que consultar ao Unleash em todas as requisi√ß√µes para verificar se √© o caso ou n√£o de passar pelo Upstash.

Ent√£o, se entendi direito, vai aumentar o custo ou a lat√™ncia, ou mesmo os dois.

>> Coment√°rio de CarlosZiegler:
Ent√£o a ideia seria usa run vari√°vel de ambiente para ligar/desligar a feature de rate limit ou algo mais cr√≠tico, por√©m essa ferramenta ajuda em demais feature para caso aconte√ßa um pico conseguir desligar features cr√≠ticas ou algo nesse sentido, como consumo de uma determinada api ou desabilitar coment√°rio etc...

>> Coment√°rio de filipedeschamps:
Turma, para dar um desfecho sobre o estorno da multa, a Vercel confirmou que n√£o ir√° estornar e o patroc√≠nio vale somente daqui para frente ü§ù

>> Coment√°rio de rodrigoKulb:
A postagem sobre o **TabNews atinge 1,5 Milh√µes de Views** bateu **100 tabcoins**, isso √© um recorde?

Pelo menos o layout n√£o quebrou com 3 d√≠gitos hahaha!

![Captura de tela em 2022-12-07 22-16-22](https://user-images.githubusercontent.com/5334261/206332450-7dec67e3-e1c2-4f97-9acc-af21c919bd4f.png)

>> Coment√°rio de boemekeld:
Acompanho o projeto desde o in√≠cio e gostaria de ter conseguido participar mais.

Pe√ßo desculpas se esses pontos j√° foram discutidos anteriormente, mas dado o cen√°rio atual, e mesmo considerando o patrocinio da Vercel, gostaria de deixar algumas sugest√µes, pensando na infraestrutura mais a longo prazo.

**Sobre o banco SQL** - o AWS RDS √© robusto (talvez o mais de todos servi√ßos), por√©m tem algumas desvantagens principalmente quando usado com uma aplica√ß√£o Serverless. N√£o sei exatamente como est√° configurado no caso do TabNews, mas independente disso, mesmo com tudo que a AWS lan√ßou nos √∫ltimos anos (Aurora Serverless V2, RDS Proxy, etc), continua n√£o sendo minha primeira op√ß√£o. Minha sugest√£o aqui seria substituir por um servi√ßo de banco SQL voltado para serverless, como o PlanetScale. Explico os motivos abaixo:
 - Banco distribuido - com poucos cliques √© poss√≠vel habilitar r√©plicas (somente leitura) do banco em m√∫ltiplas regi√µes, reduzindo a lat√™ncia (ao menos de leitura), sem um aumento significativo de custo ou esfor√ßo de configura√ß√£o como na AWS;
 - Branch - o sistema de branch facilita a automa√ß√£o, o CI/CD e o processo de migrations nas altera√ß√µes na base;
 - Picos de acesso - ambiente criado nativamente para lidar com picos de acesso sem gerar custos absurdos ou deixar de atender requisi√ß√µes;
 - Amig√°vel para ser consumida pelo edge - pode ser utilizado tamb√©m diretamente da camada Edge (atrav√©s da fetch API);
 - Custos menores - √© claro que isso depende de como a aplica√ß√£o est√° programada, mas acredito que o TabNews teria rodado com folga no plano de $29 durante os picos do lan√ßamento;
 - Constante evolu√ß√£o, mais r√°pida que a AWS, esse ano vimos features importantes sendo lan√ßadas, como o Boost de queries e a replica do banco em outras regi√µes.

**Hospedagem da API**
Para termos de compara√ß√£o de custos, a multa de $40 por 100 GB-Horas da Vercel custaria $6 se fosse paga diretamente a AWS  (https://aws.amazon.com/lambda/pricing/ considerando $0.0000166667 por cada GB-segundo), isso sem contar com os 400.000 GB-segundo mensais do free tier ou a economia de 17% que pode ser alcan√ßada com o Compute Savings Plans (pagamento adiantado). 
Existem ainda programas de cr√©ditos voltados para Startups e projetos Opensource que podem chegar a altos valores (como 10K USD para ser utilizado em 2 anos) que poderiam reduzir muito o custo com a hospedagem da API.
√â uma migra√ß√£o um pouco trabalhosa (o painel da AWS √© sempre sofrido), por√©m atualmente existem boas ferramentas para ajudar com isso (como Github Actions e o Serverless Framework). E a parte dos cr√©ditos envolve uma certa burocracia, mas pode compensar.
- https://aws.amazon.com/blogs/opensource/aws-promotional-credits-open-source-projects/
- https://www.joinsecret.com/offers/aws-credits-startups

**Hospedagem Front-end**
Apesar das vantagens da Vercel, como a usabilidade do painel, logs e analytics, recomendaria migrar para o Cloudflare Workers principalmente para ter acesso a outros servi√ßos Edge da Cloudflare (como o KV que poderia ser utilizado para reduzir ou at√© mesmo eliminar a necessidade do Upstash, diminuindo ainda mais os custos).

Estou na torcida e gostaria de colaborar mais com o projeto, espero que essas sugest√µes possam ajudar de alguma maneira. Se entenderem que alguma delas faz sentido, certamente conseguirei me envolver mais pois √© a minha √°rea üôÇ

>> Coment√°rio de filipedeschamps:
@boemekeld muito legal ver voc√™ aqui de novo meu caro, ainda mais com um coment√°rio sensacional como estes! Ontem eu abri o Draft da pr√≥xima Milestone e acredito que ficar√° melhor conversar por l√°, pois ela √© focada em Performance e Seguran√ßa: https://github.com/filipedeschamps/tabnews.com.br/issues/1140

Ent√£o estou fechando esta issue aqui e **MUITO OBRIGADO** por todo mundo que participou desta aventura. Espero ter pr√≥ximas aventuras assim voc√™s, pois √© **exatamente deste tipo de situa√ß√£o** que os conhecimentos mais raros s√£o acessados... fora que tudo fica mais gostoso quando s√£o voc√™s que est√£o aqui ü§ù 

Por fim, este √© o print das views dos √∫ltimos 30 dias e agora o projeto entrou num est√°gio natural e saud√°vel de ficar mais calmo, onde teremos mais tranquilidade para ajustar o que precisa ser ajustado, para da√≠ sim tentar conquistar o pr√≥ximo crescimento, mas desta vez muito mais preparados üëç üí™ üéâ

<img width="1243" alt="image" src="https://user-images.githubusercontent.com/4248081/208497329-9758ef63-6242-43a1-a988-2f521df50a6c.png">

---

[edit]

Pico de 1.8 milh√µes de views:

![image](https://user-images.githubusercontent.com/4248081/209725976-3a7f312b-f090-437c-ab84-dac04e33d8b5.png)
</issue_826_V√≠deo de lan√ßamento conseguiu derrubar a API (mais ou menos) ü§ù>

<issue_827_Erro "A Client-side exception has occurred" ao ficar ocioso dentro do t√≥pico.>
![Screenshot_2](https://user-images.githubusercontent.com/56397295/203076566-daf04387-c618-48d1-b705-4fa642d9a882.png)

>> Coment√°rio de alangabrielbs:
aqui abri um post e tambem recebi o erro

<img width="1439" alt="image" src="https://user-images.githubusercontent.com/48570772/203078728-72e891d0-38eb-4b0e-b11a-b5fe14baad88.png">

>> Coment√°rio de filipedeschamps:
Show turma, muito obrigado por reportar os erros! E sugiro centralizarmos nessa issue #826 daqui para frente ü§ù
</issue_827_Erro "A Client-side exception has occurred" ao ficar ocioso dentro do t√≥pico.>

<issue_828_N√£o consigo criar minha conta :(>
8cdd6e97-0dff-4108-b395-aa2b82af4f08

>> Coment√°rio de filipedeschamps:
Show Lucas! O v√≠deo de lan√ßamento derrubou tudo :) em breve ir√° normalizar e estou aqui em cima dos logs ü§ù

>> Coment√°rio de filipedeschamps:
Em paralelo, vou fechar essa issue para centralizar nesta daqui #826 ü§ù
</issue_828_N√£o consigo criar minha conta :(>

<issue_829_Um erro interno n√£o esperado aconteceu.>
Tentei fazer o meu cadastro cadastro e a seguinte mensagem surgiu.

Um erro interno n√£o esperado aconteceu.
Informe ao suporte este valor: 86a554f6-f47c-43ea-a982-2e6697efb50b

>> Coment√°rio de iurynathan:
Provavelmente o backend est√° com problema, tamb√©m recebi o mesmo error.

9ca70f63-2e3d-46d0-91ba-5f7eb10fa2b7

>> Coment√°rio de thiagomdiniz:
N√£o sei se √© relacionado ao mesmo problema, mas depois de ficar um tempo nas paginas ocorreu isso (durante algum request interno/autom√°tico).

![image](https://user-images.githubusercontent.com/29825093/203082780-643fe4ee-7510-4000-8301-519d20749707.png)

>> Coment√°rio de JonathanArgentao:
#826

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_829_Um erro interno n√£o esperado aconteceu.>

<issue_830_[Feature] Adicionar uma op√ß√£o para salvar postagens para ler mais tarde>
Ter a possibilidade de salvar as publica√ß√µes em uma cole√ß√£o, semelhante a op√ß√£o de salvar do Instagram.

![image](https://user-images.githubusercontent.com/44148461/203080496-f29b7b26-4b3c-4a70-b680-18a14cb995b5.png)

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o. Acredito que podemos considerar ser uma duplicada do Issue #645, que engloba tamb√©m a possibilidade do usu√°rio criar listas distintas.

>> Coment√°rio de MarcosLage:
Feature necess√°ria poder favoritar para ler depois, ter um bot√£o no fim da pagina para voltar ao topo.

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_830_[Feature] Adicionar uma op√ß√£o para salvar postagens para ler mais tarde>

<issue_831_Erro: 503 em todas as rotas da api>
## Contexto

Entrei no tabnews como rotina e nenhum conteudo apareceu:

![error-tabnews](https://user-images.githubusercontent.com/63757378/203081588-a9fb5772-1496-4714-9b4e-dc26ef8ec12b.png)

Fui verificar o console pra ver se tinha algo de errado e percebi que todas as requests na api retornava um 503 

![error-tabnews-console](https://user-images.githubusercontent.com/63757378/203081707-ff34d5d6-84d5-4283-9f93-187d98fa645d.png)

## Observa√ß√£o

√â a primeira vez no dia que eu tentei entrar no site, n√£o tive nenhum acesso com api - nem usando clientes externos - ontem n√£o fiz nenhuma requisi√ß√£o no tabnews de forma geral.
N√£o creio que √© problema na minha rede pois isso s√≥ est√° ocorrendo no tabnews.

>> Coment√°rio de felipsbreno:
#826

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_831_Erro: 503 em todas as rotas da api>

<issue_832_Erro ao cadastrar novo usu√°rio>
Ao tentar realizar a autentica√ß√£o do token recebido por e-mail para valida√ß√£o do cadastro, recebi o seguinte erro:
![image](https://user-images.githubusercontent.com/114552566/203088779-f1584b8b-cfe5-480f-b2aa-9726434be7b5.png)


ap√≥s isso tentei cadastrar novamente utilizando o mesmo email, para ver se seria encaminhado um novo token, por√©m recebi a seguinte mensagem:   **6433b69b-153d-4f9f-82a6-2c9222fc27a9**

![image](https://user-images.githubusercontent.com/114552566/203088667-73aae286-808e-41d9-aaf9-d10c8ee32dbf.png)

>> Coment√°rio de Just1Dav:
Passando pelo mesmo problema aqui, tentei v√°rias vezes acessar pelo link enviado no email e sempre d√° o mesmo erro na valida√ß√£o do token. Erro `error_id`.

>> Coment√°rio de rodrigooler:
same error.

API -> https://www.tabnews.com.br/api/v1/users

```sh
{"name":"InternalServerError","message":"Um erro interno n√£o esperado aconteceu.","action":"Informe ao suporte o valor encontrado no campo 'error_id'.","status_code":503,"error_id":"8fc61dfc-7e49-486c-ba56-d4bad3367924","request_id":"48d5c4ed-4f39-403c-ac6d-5a5a377c13f7","error_location_code":"INFRA:DATABASE:QUERY"}
```

>> Coment√°rio de johnvilela:
Tambem obtive o erro, a api foi chamada com os dados do form corretamente mas retornou um erro 500 dpeois de uns 30 segundos

>> Coment√°rio de junque1r4:
#826 Est√° down pela quantidade no lan√ßamento, acompanhe por l√° o andamento, j√° tem muitos issues desse erro abertas!

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_832_Erro ao cadastrar novo usu√°rio>

<issue_833_Erro ao realizar login>
Tentando realizar login, notei que a sess√£o √© realizada com sucesso por√©m quando a busca por usu√°rio excede o tempo limite ele redireciona para a p√°gina de perfil com informa√ß√µes undefined.
![image](https://user-images.githubusercontent.com/20118730/203089189-7960876e-883c-4d8a-8b6b-2385017472a3.png)
![image](https://user-images.githubusercontent.com/20118730/203089094-1e918a92-fbd8-41d2-840a-af26b45bfbc7.png)

>> Coment√°rio de junque1r4:
#826 Est√° down pela quantidade no lan√ßamento, acompanhe por l√° o andamento, j√° tem muitos issues desse erro abertas!

>> Coment√°rio de nicolasteofilo:
Que nem o @junque1r4 falou, essa baixa deve se ter dado pela grande quantidade de pessoas acessando o servi√ßo agora... Mas j√°j√° deve voltar ao normal

>> Coment√°rio de pessjr:
Sim, eu j√° estava imaginando que esse fosse o motivo, por√©m eu penso que tem algo nesse fluxo que n√£o est√° batendo.
Se eu fa√ßo login e sou autenticado, por√©m o usu√°rio por alguma raz√£o n√£o retorna, ele n√£o deveria me deixar ser redirecionado para a tela de usu√°rio.

>> Coment√°rio de aprendendofelipe:
Vou encerrar essa issue, pois acredito ser um problema que j√° foi resolvido.

Qualquer coisa √© s√≥ reabrir ü§ù
</issue_833_Erro ao realizar login>

<issue_834_Erro de cadastro>
![image](https://user-images.githubusercontent.com/1930069/203091014-4b05725a-4a4d-434b-b489-2ecce0a0b3c6.png)

>> Coment√°rio de johnvilela:
Tambem obtive esse erro, n√£o consegui criar minha conta, a chamada na api foi feita corretamente mas n√£o obtive resposta

>> Coment√°rio de felipsbreno:
#826

>> Coment√°rio de junque1r4:
#826 Est√° down pela quantidade no lan√ßamento, acompanhe por l√° o andamento, j√° tem muitos issues desse erro abertas!

>> Coment√°rio de propimentel:
Vou acompanhar pela https://github.com/filipedeschamps/tabnews.com.br/issues/826, valeu!
</issue_834_Erro de cadastro>

<issue_835_Erro ao se Cadastrar>


>> Coment√°rio de junque1r4:
#826 Est√° down pela quantidade no lan√ßamento, acompanhe por l√° o andamento, j√° tem muitos issues desse erro abertas!

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_835_Erro ao se Cadastrar>

<issue_836_Erro no cadastro>
Hoje eu vi o video de lan√ßamento do produto e achei a id√©ia muito interessante, logo corri para me cadastrar e me veio essa mensagem:
![image](https://user-images.githubusercontent.com/47667256/203093332-2193062e-2bfe-4e42-a626-1e103715c9c4.png)

>> Coment√°rio de thiagopabreu:
![image](https://user-images.githubusercontent.com/47667256/203093864-dd2798b7-7038-4abb-9e57-8b146e507325.png)
tentei novamente e agora essa mensagem

>> Coment√°rio de junque1r4:
#826 Est√° down pela quantidade no lan√ßamento, acompanhe por l√° o andamento, j√° tem muitos issues desse erro abertas!

>> Coment√°rio de berutodo:
mesmo erro aqui

>> Coment√°rio de buenoleo1982:
Mesmo erro aqui, c√≥digo
`Um erro interno n√£o esperado aconteceu. Informe ao suporte este valor: 419a3a60-332b-47d3-b755-d3764f602bbf`

>> Coment√°rio de adrian7123:
mesmo erro

>> Coment√°rio de manotroll:
Voc√™ realizou muitas requisi√ß√µes recentemente. Informe ao suporte este valor: aaa96c5e-bbeb-402a-ae87-046d19640fc1
mandei um email pra eles sobre esse erro :D
mais um na fila

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_836_Erro no cadastro>

<issue_837_Um erro interno n√£o esperado aconteceu 'error_id'. (2b336774-7b0d-4f2e-8dbc-efa3e740ed36)>
Um erro interno n√£o esperado aconteceu. Informe ao suporte o valor encontrado no campo 'error_id'. (2b336774-7b0d-4f2e-8dbc-efa3e740ed36)

>> Coment√°rio de felipsbreno:
Esse problema j√° √© conhecido e est√° sendo discutido nesta issue #826 .

pode acompanhar o andamento l√°

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_837_Um erro interno n√£o esperado aconteceu 'error_id'. (2b336774-7b0d-4f2e-8dbc-efa3e740ed36)>

<issue_838_Erro 503 em contents>
Ol√°,

Encontrei um erro que ocorre a uma chamada de api quando acessa o site e fica aguardando em torno de 1 minuto ocorre novamente uma chamada para https://www.tabnews.com.br/api/v1/contents?strategy=relevant

Parece ser algo intermitente.

![image](https://user-images.githubusercontent.com/58091964/203097331-6c7e168a-9e68-4764-9555-cf9953bb49e8.png)
![image](https://user-images.githubusercontent.com/58091964/203097546-ce3fcd6f-178d-4f51-8e69-d0afba7429dc.png)

Deixando o problema acima de lado, parab√©ns pelo trabalho com o site de forma geral pessoal!

>> Coment√°rio de felipsbreno:
Esse problema j√° √© conhecido e est√° sendo discutido nesta issue #826  .

pode acompanhar o andamento l√°

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_838_Erro 503 em contents>

<issue_840_Application error: a client-side exception has occurred (see the browser console for more information).>
For some reason: 

![image](https://user-images.githubusercontent.com/51419598/203096164-39935bc1-40b7-433c-9203-6953dcdf93a9.png)

![image](https://user-images.githubusercontent.com/51419598/203096281-9d6c8936-31aa-4450-89df-ce7f30c8817f.png)

> **Note** it is was thrown several times on post and home page.

I did start scrolling and this unknown exception was thrown; I make use of several extensions but none of them are active on this website, except for those automatic like Adblock, I never had any problems on other websites.

This also appears when tring to back through the browser left arrow:

![image](https://user-images.githubusercontent.com/51419598/203098783-73f098f3-aec2-421d-b548-c4161fa26ed4.png)

### Environment

![image](https://user-images.githubusercontent.com/51419598/203098233-4a6b08a6-a64a-48e1-ab00-07775080d7fa.png)

<!--StartFragment-->

Google Chrome | 107.0.5304.107¬†(Official Build)¬†Ôºà64 „Éì„ÉÉ„ÉàÔºâ¬†(cohort: Stable)
-- | --
Â§âÊõ¥Â±•Ê≠¥ | 294f9da25eeda7ddca937d7c70b92d53a71745dc-refs/branch-heads/5304@{#1197}
OS | Windows¬†10 Version 21H2 (Build 19044.2006)
JavaScript | V8¬†10.7.193.22
„É¶„Éº„Ç∂„Éº „Ç®„Éº„Ç∏„Çß„É≥„Éà | Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36
„Ç≥„Éû„É≥„Éâ„É©„Ç§„É≥ | "C:\Program Files\Google\Chrome\Application\chrome.exe" --profile-directory="Profile 1" --flag-switches-begin --flag-switches-end
ÂÆüË°å„Éï„Ç°„Ç§„É´„ÅÆ„Éë„Çπ | C:\Program Files\Google\Chrome\Application\chrome.exe


Any tips or ideas on how to fix that would be helpful, thanks.

>> Coment√°rio de felipsbreno:
Hi @alexrintt,

This problem already is know and it is being discussed in #826 

You can to accompany the progress over there

>> Coment√°rio de alexcmgit:
Thanks, Breno! Since it's already addressed I'll close this issue.
</issue_840_Application error: a client-side exception has occurred (see the browser console for more information).>

<issue_841_Um erro interno n√£o esperado aconteceu. Informe ao suporte o valor encontrado no campo 'error_id'.>
![image](https://user-images.githubusercontent.com/105822034/203099386-bd7a87f3-b738-476b-8015-187edb677950.png)

>> Coment√°rio de brunofamiliar:
> ![image](https://user-images.githubusercontent.com/105822034/203099386-bd7a87f3-b738-476b-8015-187edb677950.png)

@lesoname , aperta vai em inspecionar elemento do seu navegador na aba network (rede). Vai listar todos os endpoints que deram erro e o c√≥digo. S√≥ ressaltando, a aplica√ß√£o est√° um pouco inst√°vel devido ao lan√ßamento #826

>> Coment√°rio de lesoname:
> > ![image](https://user-images.githubusercontent.com/105822034/203099386-bd7a87f3-b738-476b-8015-187edb677950.png)
> 
> @lesoname , aperta vai em inspecionar elemento do seu navegador na aba network (rede). Vai listar todos os endpoints que deram erro e o c√≥digo. S√≥ ressaltando, a aplica√ß√£o est√° um pouco inst√°vel devido ao lan√ßamento #826

Ent√£o vou esperar. Valeu amigo!
</issue_841_Um erro interno n√£o esperado aconteceu. Informe ao suporte o valor encontrado no campo 'error_id'.>

<issue_842_Aplication Error>
Navegador: Firefox
Vers√£o: 107.0 (64 bit)

At√© agora n√£o consegui replicar o erro, aconteceu quando eu estava rolando a pagina.
![erro1](https://user-images.githubusercontent.com/84931896/203100006-e5a65f79-b52e-4833-8f47-bdf10a90c4f2.png)
![erro2](https://user-images.githubusercontent.com/84931896/203100028-38aa93ac-3aad-41a3-aaa5-b1ce2751a253.png)
![erro3](https://user-images.githubusercontent.com/84931896/203100036-8d0935c0-1ffc-494e-9791-d10ec77a684b.png)

>> Coment√°rio de VictorManhani:
Este erro est√° sendo revisado na issue #826.

>> Coment√°rio de aprendendofelipe:
Duplicata com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja o mesmo problema.

Obrigado!
</issue_842_Aplication Error>

<issue_845_Erro na tentativa de realizar login>
<img width="1499" alt="Captura de Tela 2022-11-21 √†s 13 25 16" src="https://user-images.githubusercontent.com/26626451/203107579-e5e970ec-9bec-412a-8a18-85a693ee3689.png">

Boa tarde, pessoal. Estou tendo problema ao tentar realizar login na plataforma.

Minha conta √© nova. Detalhes do erro est√° no print acima.

>> Coment√°rio de notsogreatdavi:
Creio que seja por conta do que foi comentado na issue #826 mais cedo. Se for isso, o jeito √© esperar por enquanto.

>> Coment√°rio de dami-i:
Aqui parece que o sistema de cadastro est√° fora do ar. Aparente problema no banco de dados.

Resposta:
```json
{
  "name": "InternalServerError",
  "message": "Um erro interno n√£o esperado aconteceu.",
  "action": "Informe ao suporte o valor encontrado no campo 'error_id'.",
  "status_code": 503,
  "error_id": "ba4ff10e-7388-489b-bb34-afb9fe7f7ba0",
  "request_id": "ecd85991-4daf-4d39-ae1f-f154fb09e092",
  "error_location_code": "INFRA:DATABASE:QUERY"
}
```

![image](https://user-images.githubusercontent.com/68955399/203111056-a8c4a2e1-5800-44ff-a643-02dd0b03b0d7.png)

![image](https://user-images.githubusercontent.com/68955399/203111472-cd2eb949-cbba-4650-9862-c3d42bf35110.png)

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_845_Erro na tentativa de realizar login>

<issue_846_Erro de Login>
O site fica congelado ao fazer login e/ou recuperar senha...

Um erro interno n√£o esperado aconteceu. Informe ao suporte o valor encontrado no campo 'error_id'. (00a23a32-1316-4285-a33b-3b43f3693df0)

>> Coment√°rio de felipsbreno:
Acredito que este erro tem rela√ß√£o com oque foi discutido nesta issue #826 

Pode acompanhar por l√°, se for isso ser√° preciso aguardar.

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja duplicidade.

Obrigado!
</issue_846_Erro de Login>

<issue_847_Sem permiss√£o para fazer login>
Tive alguns dos problemas j√° relatados por outros usu√°rios para realizar o cadastro na plataforma. Por√©m, consegui depois de uma ou duas tentativas sem sucesso.

Meu problema agora se deve ao fato de ter n√£o ter conseguido ativar minha conta com o link recebido por e-email. Em todas as tentativas demorou muito e acabou ocorrendo erro. E agora diz que o token n√£o foi encontrado ou expirou.

Ent√£o ao tentar realizar o login estou recebendo uma mensagem de erro informando que n√£o tenho permiss√£o para isso:

![image](https://user-images.githubusercontent.com/2224686/203117650-8e42397b-b85b-4601-8ca4-256709b945be.png)

E n√£o sei onde posso obter um novo token de ativa√ß√£o.

>> Coment√°rio de aprendendofelipe:
Oi @Casara, Imagino que seu usu√°rio no TabNews seja `Casara` mesmo, correto?

@filipedeschamps, o usu√°rio `Casara` est√° sem nenhuma *feature*. Imagino que no momento que ele estava ativando a conta o sistema deve ter ca√≠do logo ap√≥s a remo√ß√£o de `read:activation_token`, mas antes de concluir a inclus√£o das novas *features*.

Precisamos resolver esse *TODO* ou, no m√≠nimo, inverter, fazendo a inclus√£o das novas antes de remover `read:activation_token`:

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/models/activation.js#L97-L109

>> Coment√°rio de Scemist:
Estou com o mesmo problema, e em complemento, n√£o consigo cadastrar de novo, pois meu usu√°rio j√° est√° "sendo usado" pelo cadastro pendente.

>> Coment√°rio de Casara:
> Oi @Casara, Imagino que seu usu√°rio no TabNews seja `Casara` mesmo, correto?
> 
> @filipedeschamps, o usu√°rio `Casara` est√° sem nenhuma _feature_. Imagino que no momento que ele estava ativando a conta o sistema deve ter ca√≠do logo ap√≥s a remo√ß√£o de `read:activation_token`, mas antes de concluir a inclus√£o das novas _features_.
> 
> Precisamos resolver esse _TODO_ ou, no m√≠nimo, inverter, fazendo a inclus√£o das novas antes de remover `read:activation_token`:
> 
> https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/models/activation.js#L97-L109

@aprendendofelipe Sim, meu usu√°rio √© `Casara`.

>> Coment√°rio de aprendendofelipe:
> Estou com o mesmo problema, e em complemento, n√£o consigo cadastrar de novo, pois meu usu√°rio j√° est√° "sendo usado" pelo cadastro pendente.

@Scemist, seu usu√°rio √© esse mesmo `Scemist`? Se for, esse usu√°rio possui a *feature* `read:activation_token`, ent√£o voc√™ pode fazer a ativa√ß√£o ou a recupera√ß√£o da senha.

>> Coment√°rio de filipedeschamps:
Show turma! E @aprendendofelipe obrigado pela investiga√ß√£o!

@Casara acabei de incluir na sua conta as features necess√°rias para fazer o login, pe√ßo que tente novamente: https://www.tabnews.com.br/login

@Scemist neste caso sugiro voc√™ seguir o que o @aprendendofelipe falou ü§ù

>> Coment√°rio de Scemist:
@aprendendofelipe, deu tudo certo, ao tentar fazer o login o link foi enviado e confirmado. Obrigado!

>> Coment√°rio de filipedeschamps:
Em paralelo turma, respondi todos os emails sobre problema de cadastro/login que o suporte do TabNews recebeu. Foram mais de 100 emails. Vamo que vamo!! ü§ù üëç

>> Coment√°rio de Casara:
@filipedeschamps deu tudo certo aqui tamb√©m. Obrigado!
</issue_847_Sem permiss√£o para fazer login>

<issue_852_Link desatualizado no Footer do site>
No footer h√° o link "Contribuir" que leva para [esse post](https://www.tabnews.com.br/filipedeschamps/quem-deseja-acesso-ao-repositorio-privado-do-tabnews), que agora, o reposit√≥rio sendo p√∫blico, n√£o faz mais sentido.

Sugiro que leve diretamente pra c√°, pro reposit√≥rio do Github.
</issue_852_Link desatualizado no Footer do site>

<issue_854_[Sugest√£o] -  Tags para cada post>
Criar tags/categorias para cada post, dessa forma podendo ser poss√≠vel filtrar posts que falam sobre um mesmo assunto, facilitando a busca.

Como por exemplo: Posts sobre JavaScript teriam uma tag `javascript`.

>> Coment√°rio de Poveii:
Creio que isso pode at√© ajudar o SEO do TabNews quando pesquisado, porque seria as palavras chaves da publica√ß√£o.

>> Coment√°rio de Rafatcb:
Essa ideia foi sugerida tamb√©m no Issue #742

>> Coment√°rio de ropoko:
> Essa ideia foi sugerida tamb√©m no Issue #742

Ah, n√£o tinha encontrado nenhuma issue com essa sugest√£o, vou fechar aqui.
</issue_854_[Sugest√£o] -  Tags para cada post>

<issue_856_Sugest√£o Login (Loading)>
Sujest√£o na hora de fazer login, colocar um loading ou qualquer outra forma de vizuali√ß√£o, demonstrando que os dados est√£o sendo processados, n√£o somente esconder o button

>> Coment√°rio de bernardoeuler:
Acho que consigo implementar, seria uma boa.

>> Coment√°rio de aprendendofelipe:
Implementado no #1501 üéâ
</issue_856_Sugest√£o Login (Loading)>

<issue_858_Primeira Publica√ß√£o que fa√ßo e n√£o consigo>
![image](https://user-images.githubusercontent.com/44447117/203140513-f0d045f9-3659-463d-900f-e1cfcc267eb1.png)

>> Coment√°rio de Rafatcb:
O @filipedeschamps derrubou a API momentaneamente, ent√£o agora n√£o √© poss√≠vel fazer nada. Voc√™ pode acompanhar o progresso no Issue #826

>> Coment√°rio de jhon4than:
Ok , vou fechar essa issue
</issue_858_Primeira Publica√ß√£o que fa√ßo e n√£o consigo>

<issue_859_[Sugest√£o] - Separa conte√∫dos por categorias>
Separar cada tema por categorias ou at√© linguagens por exemplo...
API
C#
JAVA
REACT
JAVASCRIPT
DEVOPS

>> Coment√°rio de VacariGabriel:
Essa mesma ideia foi sugerida na issue https://github.com/filipedeschamps/tabnews.com.br/issues/742

>> Coment√°rio de rodrigoKulb:
@jhon4than conforme informado pelo @VacariGabriel j√° estamos falando sobre esse assunto na Issue #742 a mais antiga sobre o assunto, poderia finalizar essa para seguirmos a discuss√£o l√°? Obrigado!

>> Coment√°rio de aprendendofelipe:
@jhon4than, obrigado pela sugest√£o! üí™

Estou fechando por ser duplicada. Combinado? ü§ù
</issue_859_[Sugest√£o] - Separa conte√∫dos por categorias>

<issue_860_[Discuss√£o] Endere√ßos can√¥nicos>
Alguns criadores de conte√∫do hospedam seu conte√∫do em sites pr√≥prios e evitam a republica√ß√£o para o Google n√£o entender como conte√∫do duplicado e ferir o SEO do site.

Pensando nisso, alguns sites com Dev.to e Hashnode possuem a funcionalidade de voc√™ especificar qual √© o endere√ßo can√¥nico daquele conte√∫do (caso exista), assim o Google [entende que n√£o √© conte√∫do duplicado](https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls).

Sei que ainda h√° muito trabalho pela frente com o TabNews, mas o que pensam sobre esta quest√£o?

Os sites que comentei possuem uma quantidade not√°vel de conte√∫do publicado meramente pelo efeito de espalhar o nome pela web, ent√£o ser√° que esta funcionalidade faria mais mal do que bem para o TabNews?

>> Coment√°rio de aprendendofelipe:
@DouglasdeMoura e @jvretamero, obrigado por levantar essa quest√£o! üëç

Particularmente eu n√£o acho que isso deveria ser implementado. Ou pelo menos n√£o por enquanto, pois √© algo que impacta bastante nos objetivos do TabNews e depende de decis√µes que ainda n√£o foram tomadas.

Ser√° que √© interessante ter r√©plicas de conte√∫dos no TabNews ou deveria ter apenas um texto que chame aten√ß√£o para o conte√∫do original que consta como fonte ou, talvez, abrir a possibilidade de ter somente um link para o conte√∫do externo, sem exigir texto nenhum?

Caso seja de fato o autor do conte√∫do que esteja propositalmente criando uma r√©plica do seu conte√∫do para ter mais visibilidade, por que o TabNews deveria direcionar os mecanismos de busca para um outro site ao inv√©s de direcionar para o TabNews mesmo? Lembrando que em breve teremos o Revenue Share. Ser√° que os usu√°rios do TabNews n√£o preferem que seja feito o contr√°rio, ou seja, preencher o endere√ßo do TabNews no blog?

Ter mais esse campo tamb√©m pode piorar a experi√™ncia dos usu√°rios. Alguns usu√°rios n√£o entendem nem como preencher o campo "Fonte".

E o pior de tudo eu acho que √© o fato do endere√ßo que vai ser preenchido n√£o estar no controle do TabNews, o que vai abrir brecha para um mau uso do servi√ßo (ou mesmo por erro dos usu√°rios) podendo impactar o SEO.

J√° temos uma decis√£o para ser tomada com rela√ß√£o aos endere√ßos can√¥nicos, pois cada coment√°rio tem seu pr√≥prio link que cont√©m todos as respostas para esse coment√°rio, o que tamb√©m pode impactar o SEO como conte√∫do duplicado (https://github.com/filipedeschamps/tabnews.com.br/issues/1074#issuecomment-1335687516). Nessa quest√£o eu acredito que o melhor seria definir o endere√ßo can√¥nico de todos os coment√°rios como sendo o endere√ßo do conte√∫do root, que √© um endere√ßo que disponibiliza todos os coment√°rios. Mas e como far√≠amos se o conte√∫do root estivesse com um endere√ßo can√¥nico externo?

Para mim isso precisa ser bem debatido antes de ser implementado. ü§ù

>> Coment√°rio de filipedeschamps:
> Ser√° que √© interessante ter r√©plicas de conte√∫dos no TabNews ou deveria ter apenas um texto que chame aten√ß√£o para o conte√∫do original que consta como fonte ou, talvez, abrir a possibilidade de ter somente um link para o conte√∫do externo, sem exigir texto nenhum?

Entre escolher ter mais um campo ou um texto que fa√ßa o convite para acessar o conte√∫do original, eu prefiro o convite.

Sobre a possibilidade de ter um link somente para um conte√∫do externo, sem exigir texto (como no HackerNews), acho uma √≥tima escolha tamb√©m. N√£o sei como fazer a melhor UX nesse caso, se √© melhor da lista externa abrir o link direto, ou sempre abrir o link da publica√ß√£o dentro do TabNews primeiro.

>> Coment√°rio de DouglasdeMoura:
Na quest√£o de publicar um link, direto, acho que ficaria bacana um link direto para isso no menu, mais ou menos assim:

![image](https://user-images.githubusercontent.com/564542/212751188-4ef50e66-b628-43bf-857c-9598acf2e316.png)

![image](https://user-images.githubusercontent.com/564542/212751372-390ba3b3-33a8-4f6c-89c4-cfcb90256797.png)

Realmente, agora discutindo com voc√™s, acho que essa seria uma melhor experi√™ncia para convidar os usu√°rios a verem conte√∫dos em outras URLs.

>> Coment√°rio de feliperfranco:
> Na quest√£o de publicar um link, direto, acho que ficaria bacana um link direto para isso no menu, mais ou menos assim:
> 
> ![image](https://user-images.githubusercontent.com/564542/212751188-4ef50e66-b628-43bf-857c-9598acf2e316.png)
> 
> ![image](https://user-images.githubusercontent.com/564542/212751372-390ba3b3-33a8-4f6c-89c4-cfcb90256797.png)
> 
> Realmente, agora discutindo com voc√™s, acho que essa seria uma melhor experi√™ncia para convidar os usu√°rios a verem conte√∫dos em outras URLs.

N√£o gosto da ideia do convite pois n√£o quero tirar o usu√°rio do tabnews, quero que ele leia o conte√∫do no tabnews e que apenas o google saiba que o conte√∫do original est√° em site.
</issue_860_[Discuss√£o] Endere√ßos can√¥nicos>

<issue_861_Erro ao cadastrar>
Tentei cadastrar aqui pela primeira vez e deu isso aqui:
"Voc√™ realizou muitas requisi√ß√µes recentemente. Informe ao suporte este valor: 4b4aaf60-ec13-419e-b206-d7ae5328e6a6"

>> Coment√°rio de LucianoLimaS:
Mesmo erro aqui comigo: Voc√™ realizou muitas requisi√ß√µes recentemente. Informe ao suporte este valor: 8f7fb033-bece-4fd6-a258-e2ff2cf7d2dc

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o seja o mesmo problema.

Obrigado!
</issue_861_Erro ao cadastrar>

<issue_863_Error Many Requests ao salvar coment√°rio>
Erro ao postar um coment√°rio:
![image](https://user-images.githubusercontent.com/38855507/203143711-aa75eaa2-784e-4223-b336-4217f3da67ec.png)

Achei estranho pois eu apenas comentei uma publica√ß√£o e recebi esse erro, eu at√© esperava isso se estivesse postando mais conte√∫dos, por√©m n√£o foi o caso. Isso est√° correto? caso sim desconsiderar a issue. 

Link: https://www.tabnews.com.br/sestrem/supabase-banco-de-dados-pouco-conhecido-no-brasil-porem-extremamente-poderoso

>> Coment√°rio de iaglourenco:
O mesmo ocorre ao tentar se cadastrar
![image](https://user-images.githubusercontent.com/24625361/203144463-9d33afa3-d1c3-4f54-9305-f6d46fbf1796.png)

>> Coment√°rio de VacariGabriel:
Parece que a API foi derrubada. Sugiro acompanhar essa issue https://github.com/filipedeschamps/tabnews.com.br/issues/826

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o tenha rela√ß√£o.

Obrigado!
</issue_863_Error Many Requests ao salvar coment√°rio>

<issue_864_N√£o recebo o link para confirmar o cadastro>
De forma resumida, a linha do tempo foi

- Me cadastrei (com dificuldades pois a p√°gina estava intermitente)
- Recebi o link para confirma√ß√£o no e-mail
- N√£o consegui utilizar (novamente a intermit√™ncia)
- O link expirou
- Esperei
- Tentei fazer o login
- O site disse que foi enviado um novo link para confirma√ß√£o do e-mail
- Dessa vez n√£o recebi nada (nem caixa de spam ou lixo eletr√¥nico)
- J√° faz algumas horas que o site apenas me exibe a mensagem "_Voc√™ realizou muitas requisi√ß√µes recentemente. Tente novamente mais tarde ou contate o suporte caso acredite que isso seja um erro._"

Desde ent√£o n√£o consigo concluir meu cadastro

>> Coment√°rio de gabrielsozinho:
A API est√° offline porque o TabNews estava recebendo muitos acessos. Voc√™ pode acompanhar o que est√° acontecendo aqui: #826

>> Coment√°rio de aprendendofelipe:
Duplicidade com #826

Estou encerrando todas que dizem respeito ao mesmo problema, mas fique √† vontade para reabrir caso n√£o tenha rela√ß√£o.

Obrigado!

>> Coment√°rio de fetuffani:
Estou reabrindo pois mesmo depois da API voltar a funcionar, ainda n√£o recebo o email de confirma√ß√£o.

Tentei ontem de noite, n√£o recebi. Tentei hoje cedo e tamb√©m n√£o recebi o link para confirmar o cadastro.

Estou num loop eterno de tentar fazer login e receber a mensagem "_O seu usu√°rio ainda n√£o est√° ativado. Verifique seu email, pois acabamos de enviar um novo convite de ativa√ß√£o._".
</issue_864_N√£o recebo o link para confirmar o cadastro>

<issue_866_Elemento desaparece e origina "undefined" no t√≠tulo>
Que bom que os contribuintes est√£o entusiasmados com o projeto! Eu havia visitado o site anteriormente, mas n√£o me recordo se este comportamento j√° existia. Ao abrir uma p√°gina de usu√°rio (tabnews.com.br/user), esperar carregar completamente e o header desaparecer√°; o t√≠tulo, sendo obtido deste, torna-se indefinido. Imagino que talvez o problema esteja ligado √† suspens√£o da API que est√° anunciada no topo, pois, como refer√™ncia, n√£o ocorria tal sumi√ßo no passado: https://web.archive.org/web/20221027024033/https://www.tabnews.com.br/viinilv
Agora, vers√£o arquivada hoje no mesmo padr√£o: https://web.archive.org/web/20221121203814/https://www.tabnews.com.br/gpoleszuk  
Demonstra√ß√£o: https://user-images.githubusercontent.com/90973263/203154547-1d48ff9e-e41a-4e72-a6e0-56a0309b4920.mp4

>> Coment√°rio de aprendendofelipe:
@kimi-builds, obrigado por reportar! üí™

Eu n√£o entendi bem qual √© o problema, mas acredito que foi algo moment√¢neo devido aos impactos do grande volume de acessos no momento do lan√ßamento. Provavelmente problemas que j√° foram resolvidos.

Por isso vou fechar a issue ü§ù
</issue_866_Elemento desaparece e origina "undefined" no t√≠tulo>

<issue_869_Sugest√£o: op√ß√£o de pesquisar por temas dos t√≥picos>
Aqui uma sugest√£o para implementa√ß√£o no site de uma coisa aparentemente trivial que senti falta - que n√£o sei se n√£o est√° dispon√≠vel de prop√≥sito ou se est√° sendo ou ser√° implementada - que √© a op√ß√£o de pesquisar por assunto nos t√≥picos dos artigos publicados. Seria bastante interessante procurar por assuntos espec√≠ficos para discuss√µes, at√© evitando abrir uma nova discuss√£o de um exato assunto que j√° vem sendo discutido na rede.

√â isto! De resto estou adorando a rede e j√° consumindo muito o material l√° e contribuindo nos debates!

>> Coment√°rio de robertluiz:
Eu ia escrever uma issue agora, da para fazer com google api tipo assim  [Adding Google Custom Search to a headless Ghost blog with a React/Redux front end](https://medium.com/@tony.m.pdx/adding-google-custom-search-to-a-headless-ghost-blog-with-a-react-redux-front-end-b8b79b6dfff7) mas obviamente sem redux

>> Coment√°rio de Rafatcb:
Relacionada (e talvez duplicada): #791 
Duplicada fechada: #441

>> Coment√°rio de volfgam:
Tamb√©m senti falta

>> Coment√°rio de tjbass2021:
Quando pesquisei n√£o encontrei nada, mas vendo agora, vou fechar a issue.
</issue_869_Sugest√£o: op√ß√£o de pesquisar por temas dos t√≥picos>

<issue_870_Rodar c√≥digos diretamente das postagens>
Senhores, boa noite.

N√£o sei o que acham da ideia, mas tenho acompanhado o progresso das tecnologias [WASM](https://en.wikipedia.org/wiki/WebAssembly), e acredito que seja poss√≠vel adicionar uma feature interessante que permitiria rodar snippets de c√≥digo diretamente das postagens.

Eu venho do mundo do Python, ent√£o posso dar exemplos concretos de l√°. No ecossistema Python, existe um projeto chamado [Pyodide](https://pyodide.org) que permite explorar os benef√≠cios da tecnologia WASM para rodar c√≥digos Python diretamente do browser, incluindo os pacotes com depend√™ncias em outras linguagens.

Indo direto ao ponto, o resultado seria algo como o que podemos ver [nesta p√°gina da documenta√ß√£o do pacote Panel](https://panel.holoviz.org/user_guide/APIs.html), onde existem exemplos de snippets escritos que podem ser executados apertando um bot√£o no canto do c√≥digo. Para um cientista de dados como eu seria algo perfeito para escrever artigos interessantes e com maior expressividade. Imagino que para outros devs tamb√©m.

Como fazer? √â aqui que preciso da ajuda de todos, mas tenho algumas pistas positivas:
1 - Olhando no repo GitHub que hospeda a doc podemos ver que [o texto base da p√°gina](https://github.com/holoviz/panel/blob/master/doc/user_guide/APIs.md) √© tamb√©m em um Markdown parecido (ou id√™ntico, talvez) ao usado no TabNews.
2- Olhando mais atentamente a vers√£o Raw podemos notar algumas tags que parecem referenciar o Pyodide: `{pyodide}`

Ser√° que podemos nos inspirar para criar uma feature parecida? O que acham?

>> Coment√°rio de guilherssousa:
Parece uma ideia agridoce: 

O WebAssembly j√° √© suportado por **quase** todos os major browsers, por√©m seria necess√°rio tamb√©m implementar uma verifica√ß√£o de c√≥digo-fonte pra evitar c√≥digo parasita de ser executado no ambiente do browser. Mesmo que seja uma execu√ß√£o sandbox, existiria um certo perigo, n√£o?

>> Coment√°rio de apachaves:
N√£o tenho certeza de quais seriam os perigos de rodar c√≥digos usando tecnologia WASM, sabendo que o mesmo n√£o estaria rodando em nenhum servidor. Acredito que o pessoal aqui com experi√™ncia em Javascript deva ter mais experi√™ncias com c√≥digos rodando no ambiente do browser unicamente.

De maneira pragm√°tica, talvez o melhor seria ent√£o listar aqui os riscos para discutirmos se seria poss√≠vel mitig√°-los.

>> Coment√°rio de coffeeispower:
O rust tem o rust playground por sinal, e menos uma dor de cabe√ßa
</issue_870_Rodar c√≥digos diretamente das postagens>

<issue_871_Erro no contador de tempo da reposta do post>
O contador de tempo das respostas no post informe "minutos" quando na verdade s√≥ se passaram alguns segundos.

Como podem verificar no anexo abaixo, o √∫ltimo (que tem o tempo marcado em vermelho) foi feito por mim a seguir ao post do **RafaelAllacoes**.


![image](https://user-images.githubusercontent.com/63875039/203173478-d53be136-17b7-4a70-8273-21f952b28329.png)

>> Coment√°rio de Rafatcb:
Uma vez eu vi isso acontecendo no meu computador porque o Windows ficou com um hor√°rio errado no GMT certo (por exemplo, √†s 14:00 GMT-3 o rel√≥gio estava 13:00 GMT-3). Alterei a data aqui para ver se isso "reproduz" o problema dessa issue e realmente reproduz. A quest√£o √©: como tratar?

Vi no Reddit que eles colocam "em X minutos" ao inv√©s de "h√° X minutos":

!["in 30 minutes"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0f756bdf-eda5-4dc7-96dd-6284330c3545)

No Hacker News a p√°gina n√£o carrega e eu recebo um erro: _"We're having some trouble serving your request. Sorry!"_ No Instagram e no YouTube n√£o consegui reproduzir o problema, a data continuou correta.

N√≥s usamos a fun√ß√£o [`formatDistanceToNowStrict`](https://date-fns.org/v2.16.1/docs/formatDistanceToNowStrict) do `date-fns` para formatar a dist√¢ncia entre as datas, e adicionamos manualmente um `${dist√¢ncia} atr√°s`.

https://github.com/filipedeschamps/tabnews.com.br/blob/4c5593c8ef3d5f9adea1e476a8370e3681d3ba2b/pages/interface/components/PastTime/index.js#L24-L34

Como isso poderia ser corrigido? Acho que o jeito do Reddit n√£o resolveria nada (escrever `em ${dist√¢ncia}`).

>> Coment√°rio de aprendendofelipe:
Para o funcionamento da biblioteca [`next-swr`](https://www.npmjs.com/package/next-swr), que usamos para revalidar os dados obsoletos, ela precisa saber quando o dispositivo local est√° com a hora incorreta. Ent√£o √© feita uma requisi√ß√£o ao servidor espec√≠fica para determinar o *offset* entre o rel√≥gio local e do servidor.

Na pr√≥xima vers√£o da biblioteca eu vou deixar esse *offset* dispon√≠vel para ser usado onde for necess√°rio, e com isso esse problema poder√° ser resolvido facilmente sem adicionar novas requisi√ß√µes para sincroniza√ß√£o dos rel√≥gios.
</issue_871_Erro no contador de tempo da reposta do post>

<issue_872_Bug com teclado mobile>
Teclado usado:

‚Ä¢ Google.

Sistema operacional usado:

‚Ä¢ Android (V.: 11).

Bug:

‚Ä¢ Ao digitar no f√≥rum, h√° problemas de exibi√ß√£o de texto ou mau comportamento das caracteres, quando as sugest√µes do teclado est√£o ativados.

> Jeiel Miranda.

>> Coment√°rio de ermesonqueiroz:
@Jeiel17 teria como gravar a tela e colocar aqui? Pra ficar mais f√°cil entender o que de fato est√° acontendo.

>> Coment√°rio de Jeiel0rbit:
> @Jeiel17 teria como gravar a tela e colocar aqui? Pra ficar mais f√°cil entender o que de fato est√° acontendo.

Aqui est√°:

https://user-images.githubusercontent.com/72875404/203188376-f77e4804-6aeb-4441-b702-78a774886ec0.mp4

>> Coment√°rio de aprendendofelipe:
Ol√° @Jeiel17, esse √© um problema j√° conhecido com a biblioteca `ByteMD`.

Recomendo acompanhar via #648
</issue_872_Bug com teclado mobile>

<issue_873_Sugest√£o: retornar do navegador>
**Eu**, como usu√°rio leitor do tabnews,
**Desejo** manter a altura de rolagem da p√°gina de not√≠cias (ex. Relevantes ou Recentes)
**Quando** eu entrar sem querer em uma not√≠cia e retornar para a p√°gina anterior atrav√©s do bot√£o retornar do navegador
**Para** que eu corrija minha a√ß√£o ou continue procurando outros t√≠tulos de onde eu parei

>> Coment√°rio de aprendendofelipe:
Implementado em #1176
</issue_873_Sugest√£o: retornar do navegador>

<issue_874_[Sugest√£o] Criar temas para o TabNews>
Eu, como usu√°rio leitor do tabnews,
Desejo alterar o tema do site para dark
Quando eu entrar nas configura√ß√µes de perfis
Para agradar aos usu√°rios que tem dificuldade com temas claros.

>> Coment√°rio de felipsbreno:
@RafaMoralles 

Tem esse [PR](https://github.com/filipedeschamps/tabnews.com.br/pull/377) para adicionar o tema dark.

Acredito que ser√° mergeado em breve.

>> Coment√°rio de RafaMoralles:
Muito obrigado, vou acompanhar a thread
</issue_874_[Sugest√£o] Criar temas para o TabNews>

<issue_876_Feature: Implementar nosso pr√≥prio validador>
Bom, para validarmos alguns campos nas requisi√ß√µes usamos o **Joi** para essa tarefa. Diante disso, acho interessante criarmos o **nosso pr√≥prio validador** para suprir apenas em contextos que faz necess√°rio sem carregar algo extra.

>> Coment√°rio de Rafatcb:
Depois de um ano desde o lan√ßamento oficial do TabNews, n√£o me parece que surgiu a necessidade de criar um validador do zero. As bibliotecas existem para facilitar e permitir que nos concentremos no que √© essencial para o projeto.

Podemos, ent√£o, fechar esse issue?
</issue_876_Feature: Implementar nosso pr√≥prio validador>

<issue_877_Sugest√£o: Funcionalidade de den√∫ncia/reportar conte√∫dos>
## Motiva√ß√£o
A sugest√£o surge da necessidade de reportar postagens e/ou coment√°rios que possam ser de cunho ofensivo ou que n√£o estejam alinhados com os termos de uso do TabNews.

## Ideia

Adicionar um bot√£o onde o usu√°rio possa reportar uma postagem informando um motivo sobre o qual ele acredita que a postagem n√£o est√° seguindo as regras da comunidade e os termos de uso do TabNews. Ao clicar no bot√£o, o usu√°rio ser√° redirecionado para uma p√°gina que listar√° alguns motivos comuns para uma postagem ser reportada, como discurso de √≥dio, postagem de cunho comercial, conte√∫do nocivo, al√©m de uma op√ß√£o que permita que o usu√°rio informe uma raz√£o customizada para o acontecimento.

√â interessante tamb√©m sugerir de que um post denunciado tenha seu alcance limitado para que seu conte√∫do possa ser revisado antes que tome muita propor√ß√£o na plataforma.

## Sugest√µes de UI

Op√ß√£o de Reportar em postagem original:
![image](https://user-images.githubusercontent.com/47110995/203209335-660d9b2d-053f-415d-b0fa-fdec297e164a.png)

Op√ß√£o de Reportar em coment√°rio aninhado:
![image](https://user-images.githubusercontent.com/47110995/203209885-2cc5a00b-0a73-481e-bace-cda29dd614f4.png)

Tela para informar a raz√£o da den√∫ncia:
![image](https://user-images.githubusercontent.com/47110995/203211972-a8cb5897-ca2b-4aaf-a5a3-82bbc340f10a.png)

>> Coment√°rio de Rafatcb:
Isso √© importante mesmo e eu vou um pouco al√©m. Inicialmente, pode ficar disponibilizado para quem tem X TabCash ‚Äî para evitar spam de reports, deixando apenas para usu√°rios que teoricamente entendem melhor a comunidade, ou seja, s√£o mais "confi√°veis" ‚Äî mas futuramente ser uma funcionalidade compr√°vel, j√° que tanto TabCoins quanto TabCash s√£o/ser√£o gast√°veis.

PS: A parte de limitar para os "usu√°rios confi√°veis" √© importante considerando que voc√™ sugeriu limitar o alcance da publica√ß√£o. E, atualmente, acredito que "limitar" seria apenas tirar da Home (Relevantes).

>> Coment√°rio de guilherssousa:
> deixando apenas para usu√°rios que teoricamente entendem melhor a comunidade

Acho isso um ponto important√≠ssimo tamb√©m! Tem at√© outra forma de fazer isso, mas seria um pouco de overengineering pro tamanho atual do site, que seria deixar que esses usu√°rios mais confi√°veis tamb√©m participassem nesse processo de modera√ß√£o, assim o veredito fica mais fundamentado pois passou pelas m√£os de v√°rias pessoas. Muitos lugares fazem isso, principalmente jogos!

>> Coment√°rio de nwildner:
Hoje apareceu um caso em concreto para essa feature. User [monujan](https://www.tabnews.com.br/monujan) fez 2 posts, ambos com um bando de spam:

1. [Movers and Packers India](https://www.tabnews.com.br/monujan/movers-and-packers-india)
2. [Moving and Storage Company](https://www.tabnews.com.br/monujan/moving-and-storage-company)

Tem cara de ser bot.

>> Coment√°rio de aprendendofelipe:
@nwildner, obrigado por reportar!

Algum moderador j√° excluiu o usu√°rio:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/7565b109-9923-4085-86c9-c3364cd71677)

Realmente precisamos melhorar as ferramentas de modera√ß√£o, pois, por exemplo, os moderadores n√£o t√™m acesso ao hist√≥rico de modera√ß√£o, ent√£o n√£o √© simples saber quem moderou e quais eram os conte√∫dos das mensagens.

S√≥ ficam os registros no banco de dados, mas acredito que os moderadores deveriam ter essas informa√ß√µes, isso al√©m da maneira integrada para os usu√°rios reportarem. üëç

>> Coment√°rio de Rafatcb:
Agora que temos #1466 , acho que faz sentido incluir uma op√ß√£o de Reportar o perfil de um usu√°rio diretamente para os casos de abuso no nome de usu√°rio ou descri√ß√£o.

Uma implementa√ß√£o inicial pode ser assim:

1. No frontend, exibir a op√ß√£o de reportar no menu _kebab_ (os tr√™s pontinhos) tanto no perfil do usu√°rio quanto de publica√ß√µes. Assim, fica padronizado e n√£o h√° preocupa√ß√£o extra em responsividade e "muita informa√ß√£o na tela".
2. Ao clicar em reportar, permitir o usu√°rio informar uma mensagem sobre o que ele v√™ de problema ali.
3. Ao reportar, enviar a requisi√ß√£o para o backend.
4. No backend, validar e enviar um email para contato@tabnews.com.br.

Hoje esse procedimento √© feito manualmente: quando um usu√°rio do TabNews v√™ algo indevido, envia um email para o contato@tabnews.com.br, ent√£o essa forma simples permite que seja implementada mais facilmente, al√©m de ser bem √∫til.

Depois esse processo pode ser elaborado conforme vamos adicionando novas funcionalidades na plataforma:

* Enviar uma notifica√ß√£o para os moderadores na pr√≥pria plataforma.
* Permitir que os moderadores enviem uma mensagem para o usu√°rio ao remover uma publica√ß√£o ou realizar _nuke_ / suspender o usu√°rio. (Hoje, quando eu apago uma publica√ß√£o, preciso deixar um coment√°rio por um tempo para a pessoa poder acessar e ler pelo e-mail, caso tenha notifica√ß√£o por e-mail ativada).
* Permitir que os usu√°rios acompanhem as den√∫ncias que fizeram para verem se foi resolvido ou se ele denunciou algo que n√£o deveria, assim aprendendo com os erros. Essa mec√¢nica existe no Stack Overflow: https://stackoverflow.com/users/flag-summary/current.

O que voc√™s acham de implementar algo mais simples de in√≠cio e depois incrementar?

>> Coment√°rio de aprendendofelipe:
√ìtimas sugest√µes, @Rafatcb üí™

Baseado na observa√ß√£o de que alguns usu√°rios entendem que o voto negativo √© uma forma de reportar conte√∫dos que ferem os termos, fiquei pensando se √© necess√°rio um bot√£o de reportar. Como alternativa, caso o report seja permitido apenas para os usu√°rios com certa experi√™ncia, pode ser aproveitado o voto negativo, onde pode surgir um menu dando a op√ß√£o de selecionar o motivo de ter dado um voto negativo.

Com isso, dependendo do motivo de ter negativado, a modera√ß√£o √© acionada. Se for um caso que exija alguma a√ß√£o da modera√ß√£o, ao corrigir o problema, o moderador poderia ganhar as TabCoins que o autor perdeu, equilibrando melhor a economia e retribuindo aos moderadores.

Dependendo do tipo de a√ß√£o da modera√ß√£o, acho que pode ser exigido algum consenso, ent√£o poderia ser necess√°ria a confirma√ß√£o da a√ß√£o do primeiro moderador por um segundo moderador, e dividir a retribui√ß√£o em TabCoins.

Mas essas ideias tem como requisito a implementa√ß√£o de alguma forma de notificar aos moderadores.

Tamb√©m existem ideias que podemos considerar em:
- #27 
- #1198

>> Coment√°rio de vitoropereira:
Acho o tema muito interessante, mas √© essencial que tenhamos extremo cuidado ao relatar as a√ß√µes. √Äs vezes, uma pessoa pode estar apenas expressando uma opini√£o, mesmo que um tanto agressiva. Com uma comunidade j√° estabelecida, munida de um sistema eficiente de avalia√ß√£o e um algoritmo s√≥lido para classificar as postagens, talvez seja o suficiente para realizar essas avalia√ß√µes.

A ideia √© que as postagens de qualidade permane√ßam em destaque por mais tempo, enquanto as de menor qualidade se movam rapidamente para tr√°s. Isso acontece de forma natural, impulsionada pela pr√≥pria comunidade. Deixo como exemplo um coment√°rio que, na minha vis√£o, demonstra como isso pode funcionar bem. (https://www.tabnews.com.br/Tor/2dcd6404-e94a-4da8-8336-c476305b9731).

Eu mesmo j√° experimentei ter uma postagem minha questionado por um "moderador", que alegou viola√ß√£o das regras, embora meu texto fosse, na verdade, um "Pitch". Atualmente, muitas postagens s√£o do tipo "Pitch", e se a comunidade demonstra aprova√ß√£o atrav√©s de Tabcoins e avalia√ß√µes positivas, ent√£o, isso torna o conte√∫do mais relevante. Se, por outro lado, a comunidade n√£o aprecia, as postagens perdem relev√¢ncia √† medida que perdem Tabcoins.

Aqui, pelo que me lembro √© a comunidade que dita as regras, e talvez seja necess√°rio mais esfor√ßo para promover essa ideia. Devemos explicar de maneira mais clara como e por que os Tabcoins s√£o importantes. No final das contas, a comunidade √© quem tem o poder de decis√£o, e um pouco mais de esclarecimento sobre como funciona pode ser muito √∫til.

>> Coment√°rio de RodrigoDornelles:
acho que seria interessante um self-moderation, onde voc√™ pode descrever o texto do porque reportar e a propria comunidade avaliar isso, e ter um n√∫mero minimo de tabcoins para poder fazer isso.

>> Coment√°rio de horticonecta:
Estou comentando, pois acredito que seja necess√°rio aumentar o foco nessa issue, recentemente venho me deparando com um aumento gradual de divulga√ß√£o de links de casas de apostas ou relacionados a apostas no tabnews.

Come√ßaram com postagens que rapidamente eram negativadas e exclu√≠das, mas de um tempo pra c√° vejo que est√£o realizando a divulga√ß√£o via coment√°rios e nas postagens antigas com temas relacionados aos esportes, mas √†s vezes √© postado dentro de uma postagem sem rela√ß√£o. 

Acho essa t√°tica mais dif√≠cil da comunidade perceber, pois n√£o √© todo mundo que tem o h√°bito de olhar a aba de coment√°rios recentes.

Por isso a implementa√ß√£o do bot√£o denunciar seria de relev√¢ncia. 
![print46](https://github.com/user-attachments/assets/d026dd6e-8154-41ff-bec7-0d73045f11c9)
</issue_877_Sugest√£o: Funcionalidade de den√∫ncia/reportar conte√∫dos>

<issue_878_Sugest√£o: Notifica√ß√£o de respostas dentro da plataforma>
Acredito que um bot√£o de notifica√ß√£o seria mais interessante que receber um aviso via e-mail, mais pr√°tico e r√°pido para interagir.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_878_Sugest√£o: Notifica√ß√£o de respostas dentro da plataforma>

<issue_879_Criar √≠ndices para queries mais frequentes>
O objetivo √© otimizar a utiliza√ß√£o de recursos, melhorando tempo de resposta do banco de dados, o que impactar√° positivamente no n√∫mero de conex√µes simult√¢neas.

Um dos problemas discutidos na #826 √© a aus√™ncia de √≠ndices para as [queries mais frequentes](https://github.com/filipedeschamps/tabnews.com.br/issues/826#issuecomment-1322480535) da aplica√ß√£o em produ√ß√£o.

Ao maximizar a utiliza√ß√£o de √≠ndices nas queries mais frequentes o time ganha tempo para pensar melhor nos problemas de performance mais dif√≠ceis de resolver.

>> Coment√°rio de filipedeschamps:
Total, estou analisando aqui e tentando entender onde est√£o os gargalos dentro das queries. Vou mandando um query planner por query, d√° uma acompanhada @aprendendofelipe 


## findChildrenTree()

√â o que monta a √°rvore de respostas, onde faz essa query (exemplo com uma publica√ß√£o com `43` respostas):

https://github.com/filipedeschamps/tabnews.com.br/blob/d7ed796b62678b260a3684e8827824995c611191/models/content.js#L772-L779


```
| QUERY PLAN |
| --- |
| Result  (cost=8076.76..8121.65 rows=171 width=254) (actual time=44.467..489.827 rows=43 loops=1) |
|   CTE children |
|     ->  Recursive Union  (cost=0.29..7693.44 rows=171 width=637) (actual time=0.016..22.113 rows=43 loops=1) |
|           ->  Index Scan using contents_pkey on contents  (cost=0.29..8.30 rows=1 width=637) (actual time=0.015..0.016 rows=1 loops=1) |
|                 Index Cond: (id = 'c1c79d7f-e373-45a9-b79a-9c0c9c441f61'::uuid) |
|                 Filter: ((status)::text = 'published'::text) |
|           ->  Hash Join  (cost=0.33..768.17 rows=17 width=637) (actual time=5.239..5.513 rows=10 loops=4) |
|                 Hash Cond: (contents_1.parent_id = children_1.id) |
|                 ->  Seq Scan on contents contents_1  (cost=0.00..736.19 rows=8397 width=637) (actual time=0.002..4.833 rows=8388 loops=4) |
|                       Filter: ((status)::text = 'published'::text) |
|                       Rows Removed by Filter: 333 |
|                 ->  Hash  (cost=0.20..0.20 rows=10 width=16) (actual time=0.004..0.005 rows=11 loops=4) |
|                       Buckets: 1024  Batches: 1  Memory Usage: 10kB |
|                       ->  WorkTable Scan on children children_1  (cost=0.00..0.20 rows=10 width=16) (actual time=0.001..0.002 rows=11 loops=4) |
|   ->  Sort  (cost=383.32..383.75 rows=171 width=250) (actual time=23.829..23.885 rows=43 loops=1) |
|         Sort Key: children.published_at |
|         Sort Method: quicksort  Memory: 47kB |
|         ->  Hash Join  (cost=5.56..376.98 rows=171 width=250) (actual time=22.214..23.793 rows=43 loops=1) |
|               Hash Cond: (users.id = children.owner_id) |
|               ->  Seq Scan on users  (cost=0.00..346.61 rows=6161 width=26) (actual time=0.008..1.098 rows=6208 loops=1) |
|               ->  Hash  (cost=3.42..3.42 rows=171 width=240) (actual time=22.150..22.151 rows=43 loops=1) |
|                     Buckets: 1024  Batches: 1  Memory Usage: 24kB |
|                     ->  CTE Scan on children  (cost=0.00..3.42 rows=171 width=240) (actual time=0.018..22.137 rows=43 loops=1) |
| Planning Time: 0.250 ms |
| Execution Time: 489.904 ms |
```

Tempo de execu√ß√£o fica na m√©dia de **500ms**.

>> Coment√°rio de filipedeschamps:
## Balance Operations

Query que est√° dentro da stored procedure `get_current_balance()` (exemplo com uma publica√ß√£o com `70` TabCoins):

```sql
SELECT
	COALESCE(sum(amount), 0)
FROM
	balance_operations
WHERE
  balance_type = 'content:tabcoin'
  AND recipient_id = 'c1c79d7f-e373-45a9-b79a-9c0c9c441f61'
;
```

```
| QUERY PLAN |
| --- |
| Aggregate  (cost=2484.59..2484.60 rows=1 width=8) (actual time=43.052..43.053 rows=1 loops=1) |
|   ->  Seq Scan on balance_operations  (cost=0.00..2484.59 rows=2 width=4) (actual time=42.404..43.041 rows=69 loops=1) |
|         Filter: ((balance_type = 'content:tabcoin'::text) AND (recipient_id = 'c1c79d7f-e373-45a9-b79a-9c0c9c441f61'::uuid)) |
|         Rows Removed by Filter: 79331 |
| Planning Time: 0.079 ms |
| Execution Time: 43.073 ms |
```

O tempo de execu√ß√£o aqui estava alternando entre **50ms** e **8ms** (o que pode pesar bastante no caso de uma lista de conte√∫dos).

>> Coment√°rio de lemuelroberto:
@filipedeschamps , para a primeira eu j√° acertei os √≠ndices, por√©m s√≥ produ√ß√£o pode dizer se realmente vai funcionar.

Se quiser pode dar uma olhada aqui: https://explain.depesz.com/s/WTVL

Em instantes eu subo uma PR com √≠ndices para a primeira.

>> Coment√°rio de filipedeschamps:
Show! Depois me explica que neg√≥cio legal √© esse que voc√™ colocou no link! Eu tava para fazer o PR sobre o Balance Operations, vou fazer para voc√™ dar uma olhada ü§ù

>> Coment√°rio de lemuelroberto:
@filipedeschamps , enviei um e-mail com o t√≠tulo "Posso ajudar?" para contato@tabnews.com.br. Se quiser trocar ideia s√≠ncrona √© s√≥ me dar um salve l√°.

>> Coment√°rio de filipedeschamps:
@lemuelroberto showwww!! O email literalmente abarrotou com o problema da API hoje, eu vou demorar para conseguir limpar eles, mas seria legal a gente ter uma conversa sim! ü§ù 

Em paralelo, fiz o PR #880 para o Balance Operations, veja o que acha.

>> Coment√°rio de mvares:
@filipedeschamps, existe alguma possibilidade para fazer doa√ß√µes para o projeto?

>> Coment√°rio de filipedeschamps:
@migueloliveiraz n√£o tinha pensado nisso e n√£o tenho a resposta no momento, mas **muito** obrigado por se disponibilizar üòç

>> Coment√°rio de mvares:
@filipedeschamps, queria discutir acerca do backend do projeto de uma mais profunda. Tenho alguns pontos que referem-se √† forma em que foi `constru√≠do`. Para isso, √© preciso uma issue ou algo mais hight-level como discord?

>> Coment√°rio de filipedeschamps:
@migueloliveiraz h√° um discord n√£o oficial do TabNews, pe√ßo que veja: https://www.tabnews.com.br/Ezequias/junte-se-a-nossa-comunidade-no-discord

Mas n√£o estou conseguindo participar de forma s√≠ncrona, ent√£o sugiro come√ßar lendo o di√°rio de desenvolvimento: https://github.com/filipedeschamps/tabnews.com.br/wiki

Sugiro tamb√©m mantermos essa issue sobre os √≠ndices que estamos criando ü§ù

>> Coment√°rio de lemuelroberto:
@filipedeschamps , para a query findChildrenTree(), minha sugest√£o √© reescrev√™-la tentar combina√ß√µes de √≠ndices e testar em homologa√ß√£o para ver se para o postgres come√ßa a utilizar o √≠ndice ao inv√©s de optar por um seq scan.

Acredito que vale a pena buscar mais especificamente por performance e utiliza√ß√£o de √≠ndice em CTE recursiva. Esse tipo de pergunta, se trouxer bem os detalhes com o schema, query e  query plan, acredito que o stackoverflow √© um √≥timo lugar para algu√©m bem experiente ajudar.

>> Coment√°rio de aprendendofelipe:
> Total, estou analisando aqui e tentando entender onde est√£o os gargalos dentro das queries. Vou mandando um query planner por query, d√° uma acompanhada @aprendendofelipe

@filipedeschamps, s√≥ agora estou chegando nisso üòÖ

Mas o @lemuelroberto mandou muito bem! ü§ùüöÄ

>> Coment√°rio de lemuelroberto:
@filipedeschamps @aprendendofelipe , fechando a issue.
Se julgarem que faz sentido mant√™-la aberta, √© s√≥ reabrir, e fico √† disposi√ß√£o para aprofundarmos a discuss√£o.
</issue_879_Criar √≠ndices para queries mais frequentes>

<issue_883_Filipedechamps/tabnews>

</issue_883_Filipedechamps/tabnews>

<issue_884_[FEATURE] Favoritar postagens>
User Story: Eu como usu√°rio gostaria de poder favoritar postagens que gostei para rever depois.

Fica a sugest√£o ;)

>> Coment√°rio de Rafatcb:
Duplicada do #830 e #645

>> Coment√°rio de aprendendofelipe:
@brendo10x obrigado pela sugest√£o! üí™

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_884_[FEATURE] Favoritar postagens>

<issue_885_[FEATURE] Bot√µes de compartilhar nas redes sociais>
User Story: eu como usu√°rio gostaria de poder clicar no bot√£o de compartilhar (twitter, WhatsApp, etc..) a postagem nas minhas redes sociais para que meus amigos vejam tamb√©m.

Fica a dica ;)

>> Coment√°rio de FdClemente:
Boas, Estou a testar esse sistema, mas quais redes socias sugerias colocar?

![image](https://user-images.githubusercontent.com/51190714/203278384-cd903adc-7137-46d2-94f0-1985d9b8d456.png)

Estes √© os que j√° pus, ainda falta colocar mais bonitinhos

>> Coment√°rio de brendo10x:
Opa, ficaria bacana se colocasse o bot√£o do LinkedIn, Twitter e WhatsApp. Acredito que sejam as redes sociais que dariam um "boom" nas postagens do TabNews.

>> Coment√°rio de FdClemente:
https://github.com/filipedeschamps/tabnews.com.br/pull/888

J√° fiz agora √© aguardar üòÅ

>> Coment√°rio de brendo10x:
Rapaz, o omi √© r√°pido, viu. Kkkk
Show de bola, obrigado por implementar!!

>> Coment√°rio de ErickCReis:
Um tempo atr√°s j√° iniciaram a implementa√ß√£o dessa feature (https://github.com/filipedeschamps/tabnews.com.br/pull/814) e acabaram optando por algo mais simples que est√° nesse PR: https://github.com/filipedeschamps/tabnews.com.br/pull/875

>> Coment√°rio de Rafatcb:
Acredito que podemos fazer um √∫nico bot√£o, para ficar mais simples, e assim concentrar a discuss√£o no issue #813 ou #1398 (talvez fosse melhor, inclusive, fechar um destes, porque cada um aborda uma parte diferente da mesma coisa).

>> Coment√°rio de Rafatcb:
Bom, para organizar o reposit√≥rio, vou fechar este issue e orientar seguir a discuss√£o no #813. Obrigado pela sugest√£o!
</issue_885_[FEATURE] Bot√µes de compartilhar nas redes sociais>

<issue_886_[FEATURE] Visualizar postagens via shell>
User Story: eu como usu√°rio gostaria de poder visualizar as postagens no terminal para ver de forma √°gil e simples.

Obs: n√£o somente visualizar, mas disponibilizar comandos para interagir com o TabNews via shell de comandos no terminal.

Obs: fica a dica ;)

>> Coment√°rio de Rafatcb:
Acho que isso sai do escopo do projeto. O TabNews possui uma API para outras pessoas fazerem integra√ß√£o como desejarem.

>> Coment√°rio de thisiscleverson:
Existe dois projeto com essa proposta.

1. https://github.com/henriquetied472/tabshell-cli
2. https://www.tabnews.com.br/finn/clinews-uma-interface-de-terminal-para-o-tabnews

>> Coment√°rio de Rafatcb:
@aprendendofelipe seguindo com o objetivo de organizar as issues, me parece que essa est√° fora do escopo.

Al√©m disso, como j√° foi mencionado, existem alguns projetos que a comunidade fez para isso. Alguns outros exemplos s√£o:

* [Pitch: Yet another TabNews CLI. Este estou fazendo em Go. - cetorres](https://www.tabnews.com.br/cetorres/pitch-yet-another-tabnews-cli-este-estou-fazendo-em-go)
* [Pitch: Tabnews no terminal - vadolasi](https://www.tabnews.com.br/vadolasi/estou-desenvolvendo-um-editor-de-codigo-online)

>> Coment√°rio de aprendendofelipe:
Exato @Rafatcb! üí™

Fechando...
</issue_886_[FEATURE] Visualizar postagens via shell>

<issue_887_[FEATURE] TabNews na vers√£o mobile Android>
User Story: eu como usu√°rio gostaria de poder ter o  TabNews na vers√£o mobile Android para visualizar as postagens no celular.

Obs: Indico essas ferramentas para vers√£o mobile: Flutter ou React

>> Coment√°rio de thisiscleverson:
Existe uma iniciativa de um projeto mobile do TabNews.

Post: https://www.tabnews.com.br/higor/aplicativo-do-tabnews
reposit√≥rio: https://github.com/higorpo/tabnews-mobile

>> Coment√°rio de danielkv:
Eu me interesso em fazer parte do projeto. Trabalho com RN e posso ajudar a comunidade a desenvolver. S√≥ precisamos uma documenta√ß√£o da API.

>> Coment√°rio de thisiscleverson:
Existe duas documenta√ß√£o da api n√£o oficial do TabNews. Uma √© do @coffee-is-power e a outra do @gabrielsozinho.

1. https://coffee-is-power.github.io/tabnews-openapi/
2. https://www.tabnews.com.br/GabrielSozinho/documentacao-da-api-do-tabnews

>> Coment√°rio de danielkv:
Ah show, vou dar uma olhada! Quem estiver interessado em seguir esse projeto em RN, podemos iniciar! Pelo que vi o projeto que j√° estava em andamento em Flutter acho que ficou meio abandonado, est√° parado h√° uns 6 meses

>> Coment√°rio de coffeeispower:
Eu tenho um app mobile na minha conta do GH,s√≥ ver l√° tabnews-mobile em Flutter

>> Coment√°rio de danielkv:
> Eu tenho um app mobile na minha conta do GH,s√≥ ver l√° tabnews-mobile em Flutter

Voc√™ chegou a publicar o app?

>> Coment√°rio de coffeeispower:
Ainda n√£o est√° pronto, falta v√°rias features e tem muitos bugs

>> Coment√°rio de coffeeispower:
Mas eu pretendo que se torne a app oficial do tabnews

>> Coment√°rio de danielkv:
> Ainda n√£o est√° pronto, falta v√°rias features e tem muitos bugs

Haha acontece com os melhores devs! Ent√£o, n√£o tenho muito conhecimento em Flutter, por isso sugeri em RN.

>> Coment√°rio de coffeeispower:
Algumas screenshots:
![Screenshot_20221122-131851_TabNews.png](https://user-images.githubusercontent.com/92828847/203324045-fb812171-7c3e-4efd-b6ab-9f995f125425.png)![Screenshot_20221122-131908_TabNews.png](https://user-images.githubusercontent.com/92828847/203324036-a2ca04de-b17d-431a-99bb-1f3aa1525f31.png)

>> Coment√°rio de thisiscleverson:
@coffee-is-power , Ta ficando muito bom o app.

>> Coment√°rio de coffeeispower:
@danielkv o problema do RN e a pulveriza√ß√£o do js, precisa de lib pra tudo! S√≥ pra rodar o app no celular e preciso rodar uns 5 comandos.

>> Coment√°rio de coffeeispower:
E tamb√©m o flutter usa o skia pra renderizar os widgets inv√©s de usar os componentes do sistema, ent√£o fica consistente em todas as plataformas

>> Coment√°rio de danielkv:
> @danielkv o problema do RN e a pulveriza√ß√£o do js, precisa de lib pra tudo! S√≥ pra rodar o app no celular e preciso rodar uns 5 comandos.

> E tamb√©m o flutter usa o skia pra renderizar os widgets inv√©s de usar os componentes do sistema, ent√£o fica consistente em todas as plataformas

eu utilizo Expo pra desenvolver, n√£o sofro mais com isso. haha. Mas n√£o tenho nada contra Flutter n√£o. Como trabalho com React / React Native h√° mais de 6 anos, tenho mais afinidade com a tecnologia. Apesar de achar o Flutter um puta Framework, n√£o me sinto seguro em iniciar um projeto com ele sozinho, mais por experiencia mesmo.

Nem mesmo gosto de entrar em discuss√£o que um √© melhor por conta disso e aquilo. Acho que os 2 tem suas vantagens e desvantagens. O melhor mesmo √© o que funciona! Se Flutter funcionar, perfeito. Se RN funcionar, √≥timo.

Caso queira ajuda em alguma coisa do projeto, pode contar comigo, n√£o tenho muita XP com Flutter, mas bastante XP em v√°rias outras tecnologias e arquiteturas. Fico a disposi√ß√£o!

>> Coment√°rio de coffeeispower:
Bom como qualquer coisa que quiser aprender,s√≥ faz qualquer coisa independente se for √∫til ou n√£o, s√≥ cria um projeto e escreve c√≥digo. Foi assim que aprendi dart.

>> Coment√°rio de danielkv:
> Bom como qualquer coisa que quiser aprender,s√≥ faz qualquer coisa independente se for √∫til ou n√£o, s√≥ cria um projeto e escreve c√≥digo. Foi assim que aprendi dart.

Claro irm√£o! Assim mesmo que se aprende. Assim como se aprofundar nas tecnologias que j√° se sabe.

>> Coment√°rio de avuenja:
Estamos desenvolvendo um tamb√©m, onde j√° tem um app dos testes em alpha para baixar no release.

Segue algumas das features.

## Features:

- [x] Dark mode
- [x] Leitura de conte√∫dos
- [x] Pull To Refresh
- [x] Infite Scroll
- [x] Visualiza√ß√£o de Coment√°rios das publica√ß√µes
- [x] Login do usu√°rio
- [x] Meus conte√∫dos
- [x] Gerencimaneto de conta
- [x] Cria√ß√£o de conta pelo App
- [x] Resposta dos conte√∫dos
- [x] Postagens de conte√∫dos
- [x] Visualiza√ß√£o do perfil de outros usu√°rios
- [x] Favoritos (local database)
- [ ] Op√ß√£o ler mais tarde (local database)
- [ ] Buscar conte√∫dos (?)

Quem puder contribuir, √© sempre bem vindo. E √© muito legal que o pessoal est√° muito animado, e criando seus pr√≥prios clientes do TabNews.

**Reposit√≥rio**: https://github.com/avuenja/tabnews-app

>> Coment√°rio de DiegoRamosGomes:
> Eu me interesso em fazer parte do projeto. Trabalho com RN e posso ajudar a comunidade a desenvolver. S√≥ precisamos uma documenta√ß√£o da API.

Eu passo pela mesma coisa que vc e por isso comecei a fazer um APP em RN, caso queira dar uma olhada
https://github.com/DiegoRamosGomes/tabnews-app

>> Coment√°rio de avuenja:
@DiegoRamosGomes muito bom meu querido! Lembro de voc√™ ter comentado no post l√°, que ia fazer para treinar o RN.

Vou acompanhar! Bora pra cima! üëäüèª

>> Coment√°rio de aprendendofelipe:
Turma, considerando que j√° existem diferentes vers√µes de aplicativos que se utilizam da API do TabNews, podemos dar essa issue como encerrada. ü§ù
</issue_887_[FEATURE] TabNews na vers√£o mobile Android>

<issue_890_N√£o recebo o link para confirmar o cadastro>
depois da API voltar a funcionar, ainda n√£o recebo o email de confirma√ß√£o.

Tentei ontem de noite, n√£o recebi. Tentei hoje cedo e tamb√©m n√£o recebi o link para confirmar o cadastro.

Estou num loop eterno de tentar fazer login e receber a mensagem "_O seu usu√°rio ainda n√£o est√° ativado. Verifique seu email, pois acabamos de enviar um novo convite de ativa√ß√£o._".

PS: N√£o consegui reabrir minha outra issue #864

>> Coment√°rio de Enr1coFreitas:
Estava ocorrendo o mesmo problema comigo, portanto refiz o login e recebi a mesma mensagem que ti. Por√©m recebi o e-mail de confirma√ß√£o e deu tudo certo.
Recomendo ir testando e efetuando login at√© o recebimento do e-mail de confirma√ß√£o.

>> Coment√°rio de gabrielsozinho:
Verifique a sua caixa de lixeira e spam, talvez o email tenha ido parar l√°. üëçüèª

>> Coment√°rio de fetuffani:
> Verifique a sua caixa de lixeira e spam, talvez o email tenha ido parar l√°. üëçüèª

J√° verifiquei e n√£o se encontra em nenhuma caixa, nem de spam, nem lixo eletronico

>> Coment√°rio de gabrielsozinho:
Uma solu√ß√£o √© voc√™ criar uma nova conta usando o `seuemail+seuusername@gmail.com`. Assim voc√™ vai receber um c√≥digo (no email mesmo). S√≥ acho que voc√™ n√£o vai conseguir usar o mesmo username que queria, al√©m disso, quando for logar voc√™ vai precisar usar o email dessa forma que cadastrou.

>> Coment√°rio de aprendendofelipe:
Oi @fetuffani, voc√™ fez mais um teste hoje ap√≥s o almo√ßo? No per√≠odo da manh√£ a API novamente ficou fora do ar por alguns minutos e voc√™ pode ter tentado justo nesse hor√°rio.

>> Coment√°rio de fetuffani:
> Oi @fetuffani, voc√™ fez mais um teste hoje ap√≥s o almo√ßo? No per√≠odo da manh√£ a API novamente ficou fora do ar por alguns minutos e voc√™ pode ter tentado justo nesse hor√°rio.

Acabei de fazer um novo teste e ainda n√£o recebo o email de confirma√ß√£o.
Quer que envie algum dado da conta? Acredito que minha conta possa estar em alguma esp√©cie de deadlock

>> Coment√°rio de Enr1coFreitas:
Ent√£o provavelmente o seu cadastro n√£o foi efetivado. Tente com outro e-mail, deve funcionar...

>> Coment√°rio de aprendendofelipe:
@fetuffani, qual √© o provedor de email que est√° utilizando?

>> Coment√°rio de fetuffani:
> Ent√£o provavelmente o seu cadastro n√£o foi efetivado. Tente com outro e-mail, deve funcionar...

O cadastro foi efetivado sim, tanto que n√£o consigo utilizar o mesmo email ou username



> @fetuffani, qual √© o provedor de email que est√° utilizando?

Estou usando o @outlook.com

>> Coment√°rio de aprendendofelipe:
@fetuffani, acabei de fazer um cadastro utilizando outlook.com e, apesar do primeiro email ter sido marcado como lixo eletr√¥nico, eu recebi tamb√©m o segundo email de ativa√ß√£o, que √© enviado ao tentar fazer login sem ativar a conta.

Ent√£o, a princ√≠pio, os emails est√£o sendo entregues.

Tenta pesquisar por "Ative seu cadastro no TabNews" dentro do Outlook para ver se a mensagem n√£o foi parar em alguma pasta mais escondida.

Alguma chance de ter cometido algum erro de digita√ß√£o no endere√ßo de email na hora do cadastro? Da√≠ pode estar preenchendo o mesmo endere√ßo incorreto se estiver utilizando o autopreenchimento.

>> Coment√°rio de fetuffani:
> Tenta pesquisar por "Ative seu cadastro no TabNews" dentro do Outlook para ver se a mensagem n√£o foi parar em alguma pasta mais escondida.
> 
> Alguma chance de ter cometido algum erro de digita√ß√£o no endere√ßo de email na hora do cadastro? Da√≠ pode estar preenchendo o mesmo endere√ßo incorreto se estiver utilizando o autopreenchimento.

Ent√£o, eu consegui fazer o cadastro pouco antes da API ter sido desligada por excesso de atividade, chegou o email de ativa√ß√£o normalmente. Quando fui fazer a verifica√ß√£o, a API estava desligada j√° e n√£o consegui verificar. No dia seguinte tentei acessar o link e a chave de verifica√ß√£o j√° havia expirado. Agora quando tento fazer o login ele diz que foi enviado uma nova chave por√©m n√£o recebo nada.

Ou seja, n√£o √© problema de recebimento ou de digita√ß√£o do email j√° que o primeiro eu cheguei a receber, s√≥ n√£o consegui confirmar pois a API estava offline e a chave expirou

>> Coment√°rio de aprendendofelipe:
@fetuffani, por favor, envie um email para contato@tabnews.com.br informando essa *issue* e avise a gente por aqui quando enviar.

@filipedeschamps, por favor, depois que o @fetuffani enviar o email, responda para ele pra gente ver se ele consegue receber essa resposta ou onde vai parar essa mensagem.

>> Coment√°rio de fetuffani:
> @fetuffani, por favor, envie um email para [contato@tabnews.com.br](mailto:contato@tabnews.com.br) informando essa _issue_ e avise a gente por aqui quando enviar.

Fiz o envio do email usando o mesmo endere√ßo que usei pra cadastrar, fico aguardando resposta

Desde j√°, obrigado pela ajuda! Se precisarem de algo ou informa√ß√£o a mais, fico feliz em ajudar!

>> Coment√°rio de filipedeschamps:
Turma, respondi o email e tamb√©m vou ca√ßar nos logs do Mailgun para entender o que est√° acontecendo ü§ù

>> Coment√°rio de filipedeschamps:
Identifiquei porque @fetuffani n√£o estava recebendo mais emails: por algum motivo, o Mailgun recebeu um `complaint` do seu provedor. Isso pode ter acontecido por alguma a√ß√£o manual sem querer, ou por conta de servidor conversando com servidor mesmo üòÇ 

@fetuffani pe√ßo que tente novamente üëç

>> Coment√°rio de fetuffani:
> Identifiquei porque @fetuffani n√£o estava recebendo mais emails: por algum motivo, o Mailgun recebeu um `complaint` do seu provedor. Isso pode ter acontecido por alguma a√ß√£o manual sem querer, ou por conta de servidor conversando com servidor mesmo üòÇ
> 
> @fetuffani pe√ßo que tente novamente üëç

Que estranho hahah, √∫nica coisa que fiz foi mover o email da caixa de de spam para a caixa de entrada.

Mas enfim, consegui receber a resposta e fazer a ativa√ß√£o da conta!

Agrade√ßo a ajuda @filipedeschamps @aprendendofelipe @gabrielsozinho @Enr1coFreitas !

Estou marcado a issue como resolvida!
</issue_890_N√£o recebo o link para confirmar o cadastro>

<issue_891_Sugest√£o: Separar Conte√∫do de Coment√°rios nas p√°ginas de perfil.>
## Ideia 

A sugest√£o √© que coment√°rios e conte√∫dos originais sejam exibidos separadamente, em um formato de abas ou com tags para filtrar esses conte√∫dos.

## Motiva√ß√£o

A maior raz√£o para se adicionar essa feature √© que melhora a experi√™ncia na hora de checar perfis que interagem muito com a comunidade, pois assim voc√™ poder√° escolher se prefere ver seus posts originais ou seus coment√°rios, sem ter que ficar lidando com pagina√ß√£o para achar o conte√∫do desejado.

## Exemplo
Um grande exemplo de site que faz essa separa√ß√£o √© o Reddit: 

Nele, voc√™ inicia com uma vis√£o com todas as atividades (como o TabNews mostra, por agora) e tamb√©m existem en√©simas op√ß√µes para filtrar o conte√∫do, com destaques para Postagens e Coment√°rios.
![image](https://user-images.githubusercontent.com/47110995/203310186-18f14ac5-ab9d-495d-a844-5b901a91f7d1.png)

>> Coment√°rio de Rafatcb:
√â uma boa ideia e eu concordo, j√° dei minha opini√£o na _issue_ duplicada: #807

>> Coment√°rio de aprendendofelipe:
Boa @guilherssousa! Recomendo centralizar a discuss√£o na #807

>> Coment√°rio de aprendendofelipe:
Por organiza√ß√£o, estou fechando a duplicada. ü§ù
</issue_891_Sugest√£o: Separar Conte√∫do de Coment√°rios nas p√°ginas de perfil.>

<issue_893_[FEATURE] Separar Post e Peguntas, adicionar categorias, √°rea de perguntas urgentes(com recompensa)>
**Separar Post e Perguntas**
Criar uma parte de perguntas e outra de posts(artigo,tutorial) pois est√° confuso

**Adicionar categorias**
Adicionar categorias tanto para posts e perguntas ou adicionar tags e separa por elas,

**√Årea de perguntas urgentes**
Criar uma √°rea de perguntas urgentes que a pessoa que est√° perguntando pode oferecer tabcoins para a melhor resposta  como recompensa ou pagar para colocar sua pergunta l√°.

>> Coment√°rio de yuriveiga:
@DaniloCarSan acredito que algo parecido foi sugerido na task #742 sobre a parte de Adicionar categorias. Caso voc√™ tenha alguma ideia referente √† esse t√≥pico acho v√°lida a sua contribui√ß√£o l√° =)

>> Coment√°rio de klawdyo:
Interessante a ideia de usar tabcoins para destacar sua pergunta. Como ela estaria em destaque, com certeza geraria mais visualiz√ß√µes e provavelmente mais respostas. Inclusive a parte de pagar pela melhor resposta tamb√©m √© interessante.

J√° existe uma coisa parecida em andamento, que √© voc√™ usar seus tabcoins para inserir postagens pagas, estilo propaganda. Ent√£o eu acho que √© relacionado. Pelo menos internamente.

Para este caso, acho que j√° vi algu√©m fazer isso l√° no site. O cara colocou "pago x coins pela respostas". A√≠ nesse caso a pessoa vai na resposta e aperta x vezes pra repassar aqueles coins.

>> Coment√°rio de aprendendofelipe:
@DaniloCarSan, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser duplicada, ent√£o recomendo centralizar a discuss√£o na #742.

Combinado? ü§ù
</issue_893_[FEATURE] Separar Post e Peguntas, adicionar categorias, √°rea de perguntas urgentes(com recompensa)>

<issue_895_[UX] Melhorar mensagem de confirma√ß√£o ao alterar `username`>
1-Fiz um coment√°rio em uma postagem;
2-Resolvi mudar meu nome de usu√°rio;
3-O coment√°rio foi apagado mas as coins geradas foram mantidas. 

Nao sei se esse era mesmo o comportamento esperado mas

"escrever coment√°rio->mudar nome de usu√°rio->escrever coment√°rio->mudar nome de usu√°rio....."

Resulta em coins sem participa√ß√£o efetiva.

>> Coment√°rio de filipedeschamps:
Fala meu caro, muito interessante! Quando voc√™ quer dizer "coment√°rio foi apagado", voc√™ usou o comando de apagar o coment√°rio, ou a URL para o seu coment√°rio mudou (e a antiga est√° dando `404`)?

Qual seu usu√°rio no TabNews para eu poder avaliar?

>> Coment√°rio de Rafatcb:
Tentei reproduzir no ambiente de [staging](https://tabnews-1y5i5q50q-tabnews.vercel.app/) e ao apagar o coment√°rio, as TabCoins eram removidas. Caso algu√©m queira testar, sugiro usar esse link (https://tabnews-1y5i5q50q-tabnews.vercel.app/) ao inv√©s do site em produ√ß√£o.

>> Coment√°rio de brunofamiliar:
> Tentei reproduzir no ambiente de [staging](https://tabnews-1y5i5q50q-tabnews.vercel.app/) e ao apagar o coment√°rio, as TabCoins eram removidas. Caso algu√©m queira testar, sugiro usar esse link (https://tabnews-1y5i5q50q-tabnews.vercel.app/) ao inv√©s do site em produ√ß√£o.

Realmente em staging, quando removo o coment√°rio o tabcoins s√£o retirados. Eu n√£o consegui acompanhar toda thread dessa feature #352; mas acredito que este √© o comportamento correto @filipedeschamps certo? Porque sen√£o pode gerar um "faturamento" falso de tabcoins, visto que tabcoins s√£o ganhas apenas quando √© gerado valor na plataforma

>> Coment√°rio de fgandraf:
Usu√°rio antigo: fgandraf
Usu√°rio novo: felipeGandra
Postagem: https://www.tabnews.com.br/JhowBR/resumao-clean-code

@filipedeschamps Quando fiz o coment√°rio e mudei o nome de usu√°rio, ele apenas desapareceu da postagem. Ent√£o fiz novamente (gerando novas 2 coins). Agora, entrei para verificar e est√° aprecendo os dois.

![image](https://user-images.githubusercontent.com/41455881/203332949-1261687c-15b3-43c4-a7d2-0129e46e50ba.png)

>> Coment√°rio de brunofamiliar:
> 

Esse problema realmente vai acontecer, ainda n√£o foi implementado uma tratativa; por isso o alerta:

![image](https://user-images.githubusercontent.com/32016729/203333182-e7767df4-e6b5-49d9-b25f-346a23cba75d.png)

O problema n√£o √© nas coins, e sim no coment√°rio

>> Coment√°rio de filipedeschamps:
Show turma, ent√£o √© isso mesmo! Ao mudar o nome de usu√°rio a URL absoluta antiga (com o username antigo) de fato deixa de existir, mas o conte√∫do nesse caso n√£o √© apagado.

>> Coment√°rio de fgandraf:
> > 
> 
> Esse problema realmente vai acontecer, ainda n√£o foi implementado uma tratativa; por isso o alerta:
> 
> ![image](https://user-images.githubusercontent.com/32016729/203333182-e7767df4-e6b5-49d9-b25f-346a23cba75d.png)

Eu vi esse alerta mas como fiz um "coment√°rio" em uma publica√ß√£o, n√£o pensei que quebraria. De qualquer maneira, vou excluir um dos duplicados e verificar se as coins s√£o recalculadas.

>> Coment√°rio de fgandraf:
Pronto! exclui a duplicada e as coins foram recalculadas corretamente.
Ficando ent√£o apenas a sugest√£o para mudar o texto para algo como "Isto ir√° quebrar todas as URLs das sua publica√ß√µes e coment√°rios" (ou "postagens e coment√°rios")
Valew turma!

>> Coment√°rio de fgandraf:
Ah! talvez limitar a quantidade de vezes que um usu√°rio pode mudar o nome (m√°ximo 2 por exemplo, ou talvez, limitar por tempo: 1 altera√ß√£o a cada X meses)

>> Coment√°rio de filipedeschamps:
Isso √© um excelente ponto de UX @fgandraf  e quando escrevi essa mensagem, assumi de forma errada que as pessoas sabiam que cada publica√ß√£o teu seu link √∫nico (basta clicar no hor√°rio da publica√ß√£o) ü§ù

>> Coment√°rio de votanruchel:
Para os links quebrados acredito que inv√©s de limitar o usu√°rio a trocar o nickname x vezes, criar uma esp√©cie de permalink na qual mesmo com o nickname antigo continuaria funcionando e os novos passariam a conter o novo nickname, claro que teria que implementar uma tratativa para um novo usu√°rio n√£o poder utilizar o nickname legado de outro usu√°rio.

>> Coment√°rio de aprendendofelipe:
Editei o t√≠tulo para corresponder ao que est√° pendente na issue, que √© melhorar a mensagem aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/4e4d030cd4c0c2e240c96e5cfea16e43604aa223/pages/perfil/index.public.js#L81-L86

>> Coment√°rio de ErickBessa:
@aprendendofelipe Gostaria de contribuir com essa issue, sabe se tem algu√©m atuando nela? Caso n√£o tenha ningu√©m e eu siga com a modifica√ß√£o, o que acha da mensagem "_Isto ir√° quebrar todas as URLs de seus conte√∫dos e coment√°rios_." ser implementada? Ela segue a sua sugest√£o de trocar "publica√ß√µes" por "conte√∫do" e segue a sugest√£o do @fgandraf de adicionar tamb√©m "coment√°rios".

>> Coment√°rio de aprendendofelipe:
> o que acha da mensagem "_Isto ir√° quebrar todas as URLs de seus conte√∫dos e coment√°rios_." ser implementada?

"Conte√∫dos" j√° abrange publica√ß√µes e coment√°rios, mas pela motiva√ß√£o da issue, √© melhor colocar "publica√ß√µes e coment√°rios". E acho que "Isso" fica mais correto no lugar de "Isto".

`Isso ir√° quebrar todas as URLs de suas publica√ß√µes e coment√°rios.`
</issue_895_[UX] Melhorar mensagem de confirma√ß√£o ao alterar `username`>

<issue_897_Adicionar 2fa no tabnews>
2FA e uma coisa que eu acho importante pra seguranca de qualquer conta, o fato de s√≥ ter e-mail, nome de usu√°rio e senha e um pouco assustador, n√£o e muito seguro.
Eu quero tentar implementar 2FA no tabnews, vai ser um √≥timo exerc√≠cio!

>> Coment√°rio de aprendendofelipe:
@coffee-is-power, obrigado pela proposta! üí™

Por organiza√ß√£o, vou fechar essa issue, e vamos centralizar a conversa no #1171, que j√° possui mais intera√ß√µes. Combinado? ü§ù
</issue_897_Adicionar 2fa no tabnews>

<issue_898_Problema se responsividade na tela p√≥s cadastro>
Como podemos ver nos prints abaixo, existe um problema de responsividade na tela que aparece ap√≥s o cadastro no site quando acessado pelo celular. Acho que s√≥ est√° acontecendo quando o email utilizado for muito grande.

![IMG_20221122_111700](https://user-images.githubusercontent.com/29122454/203337214-533d8611-b03f-46af-a05c-f1e5cd73afc4.jpg)
![IMG_20221122_111637](https://user-images.githubusercontent.com/29122454/203337220-adf8f327-6f4f-4124-8e23-d0fa06e5c1e9.jpg)

Talvez seja poss√≠vel resolver com alguma configura√ß√£o de overflow no container da mensagem.

>> Coment√°rio de coffeeispower:
O melhor jeito seria reduzir o tamanho da fonte dependendo do tamanho da tela.

>> Coment√°rio de GabrielCastilhoV:
Al√©m de diminuir o texto, seria interessante adicionar quebra de palavras usando o CSS.
`word-break: break-word;`

Eu posso fazer essa issue?

>> Coment√°rio de aprendendofelipe:
Acredito que o que est√° pendente na issue √© a melhoria da responsividade nesse trecho:

https://github.com/filipedeschamps/tabnews.com.br/blob/4e4d030cd4c0c2e240c96e5cfea16e43604aa223/pages/cadastro/confirmar/index.public.js#L17

A p√°gina que apresenta o problema √© a:

https://www.tabnews.com.br/cadastro/confirmar

>> Coment√°rio de emerson-oliveira:
J√° tem algu√©m resolvendo essa task ou posso assumir ?

>> Coment√°rio de Rafatcb:
> J√° tem algu√©m resolvendo essa task ou posso assumir ?

@emerson-oliveira Pode fazer, sem problemas. As vezes acontece de duas pessoas contribu√≠rem para a mesma coisa, mas n√£o √© necessariamente ruim.

>> Coment√°rio de aprendendofelipe:
> As vezes acontece de duas pessoas contribu√≠rem para a mesma coisa, mas n√£o √© necessariamente ruim.

Isso mesmo, muitas vezes a melhor solu√ß√£o √© a combina√ß√£o das diferentes ideias. ü§Ø

Vale a pena acrescentar que n√£o √© necess√°rio pedir permiss√£o e nem assumir compromisso de fazer nenhuma contribui√ß√£o üòâüí™
</issue_898_Problema se responsividade na tela p√≥s cadastro>

<issue_899_[FEATURE] - Cria√ß√£o de rascunhos na cria√ß√£o de um novo conte√∫do>
**Cria√ß√£o de uma nova funcionalidade de rascunho na cria√ß√£o de um novo conte√∫do.**
-- Seria bacana uma implementa√ß√£o de rascunhos ao iniciar a cria√ß√£o de um novo conte√∫do.
-- Nem sempre temos a ideia ou o conte√∫do 100% preparado, e poder salvar um rascunho, ideias ou at√© mesmo anota√ß√µes seria uma funcionalidade bem bacana para que pudessemos testar e verificar a usabilidade.

>> Coment√°rio de coffeeispower:
O tabnews j√° tem isso, se voc√™ sair da p√°gina de criar post, ele guarda o texto e voc√™ pode publicar mais tarde.

>> Coment√°rio de Enr1coFreitas:
@coffee-is-power Bacana! Verifiquei e realmente j√° possui essa funcionalidade, provavelmente com o uso do localStorage.
Por√©m para uma futura implementa√ß√£o seria bacana, uma p√°gina com rascunhos, caso o usu√°rio, queira realizar mais de um rascunho.

>> Coment√°rio de aprendendofelipe:
@Enr1coFreitas, obrigado pela sugest√£o! üí™

Vou fechar essa issue para concentrarmos na #960, em que h√° mais intera√ß√µes. ü§ù
</issue_899_[FEATURE] - Cria√ß√£o de rascunhos na cria√ß√£o de um novo conte√∫do>

<issue_901_[FEATURE]: No editor MarkDown, adicionar compatibilidade com equa√ß√µes LaTeX>
Adicionar compatibilidade do MarkDown com equa√ß√µes LaTeX, uma poss√≠vel solu√ß√£o seria integrar a API da [MathJax](https://www.mathjax.org/) ao interpretador MarkDown que √© usado no projeto.

O MathJax tamb√©m tem um [Getting Started](https://www.mathjax.org/#gettingstarted) explicando como isso poderia ser feito no projeto web.

>> Coment√°rio de leonardoSaaads:
Excelente requisi√ß√£o. Iria pedir exatamente isso.

>> Coment√°rio de rafaelbarbosas:
Citando o que @filipedeschamps falou na [live de fechamento da 5¬™ milestone](https://youtu.be/5BOJ3nrtrYo?t=2844): "o bytemd √© o editor de markdown que a gente est√° usando [...], mas o gihub est√° fazendo um componente oficial de markdown [dentro do [primer](https://github.com/primer)], tanto pra editar markdown, quanto pra visualizar". Ent√£o estamos esperando esse componente ficar pronto.

(Novos componentes Markdown: [MardownEditor](https://primer.style/react/drafts/MarkdownEditor) e [MarkdownViewer](https://primer.style/react/drafts/MarkdownViewer) )

Como aqui no github j√° conseguimos usar f√≥rmulas de LaTeX ‚Äî $\sqrt{3x-1}+(1+x)^2$, por exemplo, gerado pelo c√≥digo ```$\sqrt{3x-1}+(1+x)^2$```, ou com o bloco de c√≥digo iniciado com "\```math" ‚Äî √© s√≥ esperar lan√ßarem essa feature no primer que a implementa√ß√£o no TabNews vai ser bem simples.

>> Coment√°rio de aprendendofelipe:
@PaulimRiss, obrigado pela sugest√£o! üí™

Foi implementado em #1323
</issue_901_[FEATURE]: No editor MarkDown, adicionar compatibilidade com equa√ß√µes LaTeX>

<issue_902_Sugest√£o + PR: Adicionar Issue Templates>
Abri um PR #892 onde crio e explico toda a raz√£o do uso de Issue Templates para padronizar e direcionar a cria√ß√£o de isseus no reposit√≥rio do Tabnews!

>> Coment√°rio de aprendendofelipe:
@guilherssousa, obrigado por levantar esse debate, e pelo PR! üí™

Comentei no PR, mas acho melhor trazer para c√°. Eu gostaria de saber a opini√£o da Turma sobre a outra alternativa de template, que √© usando [formul√°rio](https://docs.github.com/pt/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository#creating-issue-forms) (`.yml` no lugar de `.md`).

Eu gosto do formul√°rio porque podemos separar bem o que √© ajuda para o preenchimento (e at√© o que deve ser verificado antes de abrir a issue) e o que √© a informa√ß√£o que realmente precisamos que seja preenchida. Um bom exemplo √© o [bug_report](https://github.com/vercel/next.js/issues/new?assignees=&labels=template%3A+bug&projects=&template=1.bug_report.yml) ou as [outras as op√ß√µes](https://github.com/vercel/next.js/issues/new/choose) do Next.js.

Inclusive existe o PR #1005 do @yuric18 que usa essa outra alternativa.

>> Coment√°rio de aprendendofelipe:
Em complemento ao texto que j√° se encontra no in√≠cio dos templates, acham que vale a pena adicionar uma caixa de sele√ß√£o obrigat√≥ria (no final) com algo como "Pesquisei e n√£o encontrei nenhuma discuss√£o relacionada"?

Ou uma caixa ~de sele√ß√£o~ suspensa, dando tamb√©m a op√ß√£o "Encontrei e estou citando as issues relacionadas"?

Faz sentido?

>> Coment√°rio de Rafatcb:
@aprendendofelipe acho que uma caixa de sele√ß√£o obrigat√≥ria ser√° √≥tima.
</issue_902_Sugest√£o + PR: Adicionar Issue Templates>

<issue_903_Link de corfirma√ß√£o indo sempre pra junk do email>
demorei um tempo para achar o link de confirma√ß√£o, n√£o sei como pode ser resolvido, mas pode ser um problema para novos usu√°rios futuros. Por√©m acredito que isso se resolva com a popularidade do site

>> Coment√°rio de GTSouza:
Talvez seja resolvido com a configura√ß√£o DKIM e SPF (configura√ß√£o no DNS do dom√≠nio)

Valida√ß√£o:
https://toolbox.googleapps.com/apps/checkmx/check?domain=tabnews.com.br&dkim_selector=

Sugest√£o:
https://support.google.com/a/answer/174124

>> Coment√°rio de aprendendofelipe:
@eramoss, obrigado por reportar! üí™

Acredito que o problema pode ter ocorrido nos primeiros dias ap√≥s o lan√ßamento devido a grande mudan√ßa no volume de emails disparados, mas nunca mais ningu√©m reportou nada parecido.

Por isso vou fechar a issue. ü§ù
</issue_903_Link de corfirma√ß√£o indo sempre pra junk do email>

<issue_904_Criar avisos>
Criar avisos visuais ao usu√°rio, como "Perfil salvo", etc.
Melhor m√©todo √© utilizar o Toastify, com retorno de erros do backend como array.

>> Coment√°rio de refeals:
Se estiver falando [desse](https://fkhadra.github.io/react-toastify/introduction), sou super a favor! Essa lib √© muito boa!

>> Coment√°rio de am-castro:
J√° estou com a m√£o na massa kkk, mas dou dev angular, to meio perdido aqui.

>> Coment√°rio de am-castro:
Deu certo, j√° vou subir.
O que tem que melhorar agora √© o retorno do backend

>> Coment√°rio de am-castro:
Bom, n√£o fiz no projeto todo porque, como disse anteriormente, n√£o mecho em React e sim em Angular, mas deu pra implementar. O ideal √© fazer um service que voc√ä s√≥ precise chamar o service por exemplo:
`this.toastService.success('Menssagem');`
E aplicar no projeto todo.
Toastify j√° funcionando, enviando mais de uma mensagem para retorno do usu√°rio (message e action)

[Minha pull request](https://github.com/filipedeschamps/tabnews.com.br/pull/906)

>> Coment√°rio de am-castro:
![Preview](https://user-images.githubusercontent.com/16366137/203390012-3e191aca-ebc4-4f2d-a9cf-3b292a365a82.png)

Quando clica em enviar, retorna o json do conte√∫do que foi enviado, mas era pra retornar uma mensagem "Conte√∫do salvo com √™xito" pelo backend.
Com isso, os toastify s√≥ ir√£o retornar quando der erro, pois s√≥ nos erros est√£o sendo retornadas mensagens.
Segue a imagem linkada no "preview" para visualiza√ß√£o quando houver erro.

>> Coment√°rio de Rafatcb:
O TabNews utiliza o Primer, que apesar de ter documenta√ß√£o para [Toasts](https://primer.style/components/toast), n√£o tem implementa√ß√£o no React. Por isso, usamos outro componente: [Flash](https://primer.style/components/flash).

Al√©m disso, agora existe o feedback ao salvar o perfil: https://github.com/filipedeschamps/tabnews.com.br/pull/1548

Sobre a imagem das toasts no exemplo de erro do formul√°rio, acredito que o erro fique melhor sendo exibido pr√≥ximo ao campo, seguindo o padr√£o da documenta√ß√£o do [Text input](https://primer.style/components/text-input), e n√£o h√° necessidade em mostrar o erro de forma duplicada (no campo + toast).

Podemos encerrar esse issue?

>> Coment√°rio de aprendendofelipe:
Acredito que Toasts ser√£o necess√°rios futuramente, mas n√£o √© um problema em aberto.

Fechando a issue... ü§ù
</issue_904_Criar avisos>

<issue_907_[Feature] Vers√£o GraphQL da API>
Eae devs!

Voc√™s tamb√©m acham que seria uma boa adi√ß√£o uma vers√£o GraphQL da atual API do TabNews?

Ao meu ver algumas vantagens seriam:

- Escolher exatamente a informa√ß√£o desejada;
- Melhor controle de versionamento da API;
- Mais amig√°vel para quem est√° desenvolvendo;

Caso tenham mais alguma sugest√£o podem comentar para complementar ainda mais a ideia.

>> Coment√°rio de brendo10x:
Opa, a grande vantagem do GraphQL √© que c/ um √∫nico endpoint eu consigo atender diferentes necessidades. N√£o se faz necess√°rio desenvolver v√°rios endpoints..

>> Coment√°rio de SeltikHD:
Bem comentado @brendo10x, outra vantagem que tamb√©m n√£o comentei √© documenta√ß√£o, devido ao Schema que se √© criado, o pr√≥prio GraphQL j√° diz os campos e fun√ß√µes dispon√≠veis pra consulta.

Uma biblioteca que tenho em mente pra fazer o backend em GraphQL √© o Apollo, algu√©m alguma ideia de mais alguma que de pra colocar ir complementar a API?

>> Coment√°rio de nordyc:
Principalmente se usar um Apollo, consegue criar uma boa documenta√ß√£o e com ambiente de teste
</issue_907_[Feature] Vers√£o GraphQL da API>

<issue_908_Loading page>
Seria interessante adicionar um loading no projeto, para desaparecer quando for carregado.

`https://codepen.io/akai/pen/oNpOVP`

>> Coment√°rio de Rafatcb:
N√£o sei para onde √© exatamente essa sugest√£o, mas hoje vi que temos dois tipos de carregamento:

1. Progressbar para p√°ginas (https://github.com/filipedeschamps/tabnews.com.br/pull/616).
2. Loading para a√ß√µes em bot√µes (https://github.com/filipedeschamps/tabnews.com.br/pull/1501).

Ent√£o me parece que essa issue j√° foi conclu√≠da, certo?

>> Coment√°rio de aprendendofelipe:
Considerando a data da sugest√£o, que foi na √©poca do lan√ßamento, per√≠odo em que o volume de acessos foi muito grande e o sistema ficou inst√°vel, acredito que a inten√ß√£o era usar um loading como fallback das p√°ginas est√°ticas que ainda n√£o tinham cache (`fallback: true` no `getStaticPaths` do Next).

Como usamos `fallback: 'blocking'`, quando algu√©m acessa uma p√°gina que ainda n√£o est√° em cache, o Next n√£o devolve nada at√© que a p√°gina seja gerada no servidor. Normalmente isso √© muito r√°pido, mas se ocorre em um momento de instabilidade, por exemplo com lentid√£o no banco de dados, isso prejudica a experi√™ncia.

Mesmo tendo a `Progressbar`, como em boa parte dos sistemas, o progresso dela n√£o tem rela√ß√£o com o progresso real da navega√ß√£o, ent√£o ela para de crescer se a navega√ß√£o demorar mais do que determinado tempo (acho que 200ms).

Naquele momento do lan√ßamento, esse loading simples talvez fosse uma solu√ß√£o emergencial interessante, mas nas condi√ß√µes atuais normais, acredito que at√© pode fazer sentido usar `fallback: true`, mas com um fallback mais elaborado. Talvez usando Skeleton, mas n√£o vejo isso como uma dor que mere√ßa uma issue aberta tanto tempo, ent√£o estou fechando. ü§ù
</issue_908_Loading page>

<issue_909_[FEATURE] Pesquisar por t√≠tulo da postagem>
User Story: Como usu√°rio gostaria de pesquisar por t√≠tulo da postagem para encontrar o post desejado.

>> Coment√°rio de natanael-b:
N√£o √© exatamente o que vc quer mas como o TabNews adiciona todo o o t√≠tulo na tag title, basta pesquisar no google, inurl:https://www.tabnews.com.br/ e o termo, por exemplo, digamos que eu queira ver o conte√∫do sobre Lua:

```yaml
inurl:https://www.tabnews.com.br/ Lua
```
 
[Como fica](https://www.google.com/search?q=inurl%3Ahttps%3A%2F%2Fwww.tabnews.com.br%2F+Lua)
 
**Edit:** Eu fiz uma p√°gina pra facilitar:
 
 https://natanael-b.github.io/tabnews.html

>> Coment√°rio de klawdyo:
Pode usar "site:" tamb√©m.

Ex.:

> site:tabnews.com.br como usar jwt

>> Coment√°rio de Rafatcb:
A barra de pesquisa foi implementada em Julho/2023 (https://github.com/filipedeschamps/tabnews.com.br/pull/1472). N√£o √© uma pesquisa que se restringe √† busca por t√≠tulo, mas me parece que resolve a dor original, ent√£o poder√≠amos encerrar essa issue.

>> Coment√°rio de aprendendofelipe:
@brendo10x, obrigado pela proposta! üí™

Concordo com o @Rafatcb sobre a necessidade original ter sido atendida. üëç

Em um futuro devemos desenvolver um sistema de busca pr√≥prio, que permita incluir filtros espec√≠ficos, mas com a demanda atual n√£o vale a pena o custo/benef√≠cio.

Vou fechar a issue, mas qualquer coisa podemos reabrir. ü§ù
</issue_909_[FEATURE] Pesquisar por t√≠tulo da postagem>

<issue_911_Separar coment√°rios e posts>
Acho ideal separar esses dois, n√£o s√≥ por √≠cone.

O que acho incr√≠vel √© que posso estudar React agora na pr√°tica, vou tentar criar essa separa√ß√£o com TABS, podendo clicar em um tab para ver publica√ß√µes e no outro tab para ver coment√°rios do usu√°rio!

![image](https://user-images.githubusercontent.com/16366137/203405523-cd77d948-60ab-4673-b29a-0706bd5ed47b.png)

>> Coment√°rio de aprendendofelipe:
Boa @am-castro!

Recomendo dar continuidade por essa duplicada #807

>> Coment√°rio de am-castro:
Obrigado, vou fechar essa issue e acompanhar a #807

>> Coment√°rio de am-castro:
Obrigado, vou fechar essa issue e acompanhar a #807
</issue_911_Separar coment√°rios e posts>

<issue_912_[Feature] RSS feed and Dark mode!>


>> Coment√°rio de lucasalberto01:
Eu estava olhando justamente o tema dark e j√° tem uma PR sobre isso #377

>> Coment√°rio de ErickCReis:
O TabNews j√° tem suporte a RSS: https://www.tabnews.com.br/rss
Foi implementado nesse PR: https://github.com/filipedeschamps/tabnews.com.br/pull/621
</issue_912_[Feature] RSS feed and Dark mode!>

<issue_913_[Infra][Proposta de melhoria] Utilizar PostgreSQL Connection Pooling em produ√ß√£o>
Considerando o problema do n√∫mero de conex√µes como um todo - #826 - um problema conhecido de deployments serverless √© um consumo maior do n√∫mero de conex√µes com banco de dados, uma vez que o reuso de uma mesma conex√£o em m√∫ltiplas requisi√ß√µes √© n√£o trivial.

Uma solu√ß√£o cl√°ssica para esse problema √© a utiliza√ß√£o de Connection Pooling. O [PgBouncer](https://www.pgbouncer.org/) √© uma solu√ß√£o open source muito utilizada pela comunidade PostgreSQL, o [Amazon RDS Proxy](https://aws.amazon.com/rds/proxy/faqs/) √© uma solu√ß√£o gerenciada da Amazon e tem algumas outras op√ß√µes no mercado.

Essa √© uma solu√ß√£o com baixo custo de desenvolvimento pois √© apenas na camada de infra. A aplica√ß√£o se conecta ao Pooler como se estivesse conectando ao banco, e o Pooler faz uma gest√£o mais eficiente das conex√µes com o banco de dados.

Considerando o problema, fico √† disposi√ß√£o para aprofundar na discuss√£o.

>> Coment√°rio de aprendendofelipe:
Boa @lemuelroberto! No PR #715 eu sugeri a utiliza√ß√£o do PgBouncer. J√° o RDS Proxy eu vi que teria algumas complica√ß√µes no nosso caso, ent√£o nem comentei.

Mas agora com a experi√™ncia que tivemos nesses dois dias, e dado o alto custo de manter as lambas conectadas ao pool e aguardando o banco ter recursos para responder as consultas, acho que ainda n√£o √© o momento de usarmos algo como o PgBouncer.

Acho que √© uma ideia que vai contra o que √© dito em #915. Por favor, me corrija se n√£o fizer sentido o que eu disse! ü§ù

>> Coment√°rio de lemuelroberto:
@aprendendofelipe , que maravilha que j√° discutiram o uso de um Pooler como o PgBouncer. Acredito que pode ajudar bastante na manuten√ß√£o e gerenciamento mais saud√°vel das conex√µes com o banco de dados.

Com rela√ß√£o ao timeout mais restrito proposto em #915 e a utiliza√ß√£o de um Pooler, s√£o estrat√©gias complementares.

De um lado, timeouts mais restritos for√ßam uma previsibilidade maior da qualidade do servi√ßo pois protege a infraestrutura como um todo em um momento de maior tr√°fego ou em um momento que a infraestrutura esteja sofrendo por qualquer que seja a raz√£o, como por exemplo a indisponibilidade do banco de dados.

Do outro lado temos a gest√£o mais adequada das conex√µes com o banco de dados considerando a caracter√≠stica do deployment da aplica√ß√£o que √© ef√™mera (serverless). O uso de PgBouncer √© muito comum, e recomendado, por exemplo em aplica√ß√µes PHP tradicionais, que tamb√©m abrem e finalizam as conex√µes com o banco a cada nova requisi√ß√£o HTTP.

Desse modo, a proposta de limitar mais o timeout da aplica√ß√£o e a gest√£o das conex√µes com o banco de dados s√£o complementares e juntas podem representar uma melhora significativa em momentos em que a infra tem mais demanda, resultando numa melhor garantia da qualidade de servi√ßo.

>> Coment√°rio de lemuelroberto:
@filipedeschamps @aprendendofelipe , fechando a issue.
Se julgarem que faz sentido mant√™-la aberta, √© s√≥ reabrir, e fico √† disposi√ß√£o para aprofundarmos a discuss√£o.
</issue_913_[Infra][Proposta de melhoria] Utilizar PostgreSQL Connection Pooling em produ√ß√£o>

<issue_914_[Question] Tem algo no roadmap para migrar para typescript ?>
Typescript agora vai ser o padr√£o para as novas aplica√ß√µes em nextjs. Parece ser esse o caminho que o next est√° adotando junto com uma boa parte do mercado

>> Coment√°rio de coffeeispower:
Mas assim, e como dizem, typescript is JavaScript but you type more

>> Coment√°rio de lucasalberto01:
@coffee-is-power ou menos... Porque o autocomplete funciona melhor XD

>> Coment√°rio de pedroarm:
Acredito que por se tratar de um projeto open source, seria interessante a implementa√ß√£o das tipagens. Al√©m do mercado estar cada vez mais aderindo √† tecnologia, o typescript facilita ao contribuir com o c√≥digo de outro coleguinha sem gastar dias para entender o que um m√©todo espera ou retorna.

>> Coment√°rio de Rafatcb:
N√£o temos nada sobre TypeScript no roadmap, e o Filipe falou um pouco sobre o porqu√™ decidiu seguir com JavaScript no in√≠cio do projeto [aqui](https://www.tabnews.com.br/filipedeschamps/d70220d2-ff19-4cbf-8b8c-50e1e563980b) e o assunto tamb√©m j√° foi mencionado no issue https://github.com/filipedeschamps/tabnews.com.br/issues/319.

Vale lembrar tamb√©m que a forma como o projeto est√° estruturado j√° protege de alguns erros de tipagem: temos testes automatizados e validadores na entrada e sa√≠da da API.

Creio que hoje seja mais importante criar a documenta√ß√£o da API (https://github.com/filipedeschamps/tabnews.com.br/issues/555) do que adicionar tipagem na base de c√≥digo, por exemplo, mas nada impede que futuramente o TypeScript seja adicionado. Em algumas partes do c√≥digo, usamos JSDoc para facilitar o desenvolvimento.

Como n√£o temos planos para adicionar TypeScript no momento, vou fechar este issue.
</issue_914_[Question] Tem algo no roadmap para migrar para typescript ?>

<issue_915_[Infra][Proposta de melhoria] Definir limite de tempo m√°ximo de execu√ß√£o mais restritos em produ√ß√£o>
Cada escolha, uma ren√∫ncia. Geralmente os padr√µes do tempo m√°ximo de execu√ß√£o, ou timeout, s√£o muito maiores do que n√≥s usu√°rios consideramos adequado para carregar uma p√°gina ou para uma API responder com dados.

Um ponto importante nessa balan√ßa da escolha do timeout √© o custo que isso imp√µe para a infra em momentos de pico de tr√°fego, pois quanto maior o timeout, maior o n√∫mero de conex√µes ativas com o banco de dados e sim por diante.

Quando consideramos a precifica√ß√£o de plataformas serverless como a Vercel, segurar requisi√ß√µes abertas implica em custo financeiro direto e imediato.

O padr√£o da Vercel para o Maximum Execution Duration √© 10s para o plano Hobby e 60s para o plano Pro. E √© justamente por isso que o custo foi √†s alturas no momento de pico ontem: https://github.com/filipedeschamps/tabnews.com.br/issues/826#issuecomment-1322222580.

Minha sugest√£o √© [limitar o Maximum Execution Duration (maxDuration)](https://vercel.com/docs/project-configuration#project-configuration/functions/description/functions-property-with-serverless-functions) ao m√≠nimo aceit√°vel. Sendo bem sincero, acredito que entre 1 e 2 segundos √© um bom equil√≠brio entre experi√™ncia para o usu√°rio e controle de custos de infra.

Fico √† disposi√ß√£o para aprofundar a discuss√£o.

>> Coment√°rio de filipedeschamps:
Show, faz sentido! O link ali sobre como limitar acredito que n√£o esteja levando para o lugar certo ü§ù 

E como limite, talvez 10 segundos seja algo mais seguro ü§ù

>> Coment√°rio de ErickCReis:
> O link ali sobre como limitar acredito que n√£o esteja levando para o lugar certo

Acho que vc j√° deve ter achado, mas encontrei esse link [aqui](https://vercel.com/docs/project-configuration#project-configuration/functions/description/functions-property-with-serverless-functions)

Aparentemente √© algo bem simples de se implementar e deve ajudar muito.

>> Coment√°rio de aprendendofelipe:
Boa @lemuelroberto, mas acredito que podemos implementar um limite vari√°vel, pois se uma ou outra requisi√ß√£o demorar mais, n√£o ser√° problema, mas quando uma certa quantidade de requisi√ß√µes come√ßar a demorar demais, reduzimos esse limite por um tempo para a conta n√£o explodir.

Mesmo que optarmos por deixar o limite padr√£o em 10s fixo, ainda causar√° preju√≠zo em caso de uma rajada com milhares de requisi√ß√µes simult√¢neas, pois a simultaneidade impede a Vercel ou qualquer outro sistema de rate-limit de identificar rapidamente o ataque.

Podemos definir um intervalo de alguns milissegundos para que o banco responda em condi√ß√µes normais. Mas sempre que esse limite de tempo passar, entramos no modo protegido, em que usamos um Redis para guardar a informa√ß√£o se outras requisi√ß√µes simult√¢neas est√£o demorando. Se for um ataque, j√° retornamos o erro sem esperar o limite da lambda.

O que acha?

>> Coment√°rio de lemuelroberto:
@filipedeschamps @ErickCReis , de fato errei no link kkkk
√â o link que o Erick colou mesmo.

>> Coment√°rio de lemuelroberto:
@aprendendofelipe , de fato, pode ser necess√°rio configurar timeout um pouco maior para rotas espec√≠ficas. Por√©m pensando no padr√£o, o limite de 1 segundo j√° √© bem alto considerando o que √© esperado em termos da experi√™ncia para o usu√°rio, m√©tricas de sa√∫de da aplica√ß√£o e objetivos de servi√ßo (SLO).

Considerando isso, @filipedeschamps , o padr√£o da Vercel para o plano Hobby j√° √© 10 segundos, e num momento de maior stress, timeouts grandes implicam numa cascata de aumento de tempo de processamento, mais especificamente de tempo de espera pois o banco ser√° o gargalo. Quando o sistema consome todas as conex√µes dispon√≠veis com o banco o que percebemos √© um grande n√∫mero de requisi√ß√µes aguardando uma conex√£o com o banco que esteja dispon√≠vel e a consequ√™ncia √© uma alta taxa de requisi√ß√µes em timeout n√£o importa qu√£o alto seja o limite de tempo. Em modelos de precifica√ß√£o como o da Vercel o impacto financeiro se torna um problema.

>> Coment√°rio de lemuelroberto:
> Mesmo que optarmos por deixar o limite padr√£o em 10s fixo, ainda causar√° preju√≠zo em caso de uma rajada com milhares de requisi√ß√µes simult√¢neas, pois a simultaneidade impede a Vercel ou qualquer outro sistema de rate-limit de identificar rapidamente o ataque.

Hoje o limite j√° ser√° de 10 segundos se o plano for o Hobby. O @filipedeschamps deve ter melhor a m√©trica de quanto √© o tempo de processamento das requisi√ß√µes. Minha sugest√£o √© limitar a aplica√ß√£o para responder em no m√°ximo t segundos, onde t √©, por exemplo o tempo de resposta da aplica√ß√£o em 95% das requisi√ß√µes. Ent√£o com as m√©tricas que o @filipedeschamps coletar da aplica√ß√£o, se ela responder em at√© 1 segundo para, por exemplo 95% das requisi√ß√µes, esse seria o limite para a configura√ß√£o maxDuration.

Ainda sobre esse ponto, a estrat√©gia de rate-limit vem pra resolver um problema espec√≠fico que √© um "abuso" pontual da aplica√ß√£o por parte de um IP ou usu√°rio. Desse modo, √© uma solu√ß√£o complementar ao timeout, pois resolvem problemas diferentes, mas no mesmo contexto de qualidade de servi√ßo e resili√™ncia da aplica√ß√£o.

Considerando "abusos" pontuais, pode ser utilizadas solu√ß√µes como AWS Shield para IPs (ou faixas) espec√≠ficos. Essa mesma solu√ß√£o tamb√©m serve para ataques mais sofisticados como DDoS que chegam de v√°rios IPs e a√≠ a solu√ß√£o de rate-limit ajudar√° pouco.

>> Coment√°rio de lemuelroberto:
@filipedeschamps @aprendendofelipe , fechando a issue.
Se julgarem que faz sentido mant√™-la aberta, √© s√≥ reabrir, e fico √† disposi√ß√£o para aprofundarmos a discuss√£o.
</issue_915_[Infra][Proposta de melhoria] Definir limite de tempo m√°ximo de execu√ß√£o mais restritos em produ√ß√£o>

<issue_917_[ Error ] Quando tento acessar da erro.>
![IMG_20221122_214844.jpg](https://user-images.githubusercontent.com/81159579/203449469-125a1a84-9364-41cd-99ba-9e4507dd0d7a.jpg)
 
Esse erro aparece quando tento logar.

>> Coment√°rio de coffeeispower:
Isso deve ser algum bug no tabnews, todos os usu√°rios deveriam ter a feature de create session, a n√£o ser que voc√™ tenha sido banido.

>> Coment√°rio de Rafatcb:
@Kaduh15 ap√≥s o cadastro, um e-mail de confirma√ß√£o √© enviado, voc√™ chegou a clicar no link para confirmar o e-mail?

>> Coment√°rio de Kaduh15:
Quando criei a conta olhei meu email e cliquei no link para confirmar o email mas por conta instabilidade na hora deu um erro que n√£o me recordo, ent√£o tentei logar e foi enviado outro link no email e esse aparentemente deu tudo certo.

>> Coment√°rio de aprendendofelipe:
@Kaduh15, se o problema j√° estiver resolvido, √© interessante fechar a *issue* üëç

>> Coment√°rio de Kaduh15:
Ainda estou com o mesmo problema

>> Coment√°rio de iurisilvio:
Tenho o mesmo problema. Criei a conta durante o pico inicial e n√£o consegui logar desde ent√£o. Acho que n√£o confirmei a conta e n√£o consigo fazer agora.

>> Coment√°rio de Kaduh15:
@iurisilvio ainda est√° com problemas? Consegui resolver enviando um e-mail para contato@tabnews.com.br e eles resolveram

>> Coment√°rio de iurisilvio:
Continua ruim por aqui. Mandei agora email, obrigado!
</issue_917_[ Error ] Quando tento acessar da erro.>

<issue_918_D√∫vida sobre propriedade intelectual>
Boa noite, eu gostaria de saber se existe alguma documenta√ß√£o sobre o que √© permitido ou n√£o para criar com a api.
Duvidas como:
Posso utlizar a api do tabnews para projetos e utilizar esses projetos de maneira comercial? Se n√£o, qual o limite para esse uso?
Posos utilizar os assets do tabnews para a cria√ß√£o de um aplicativo do tabnews?

>> Coment√°rio de coffeeispower:
Na minha opini√£o use o bom senso

>> Coment√°rio de lsprdev:
https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/termos-de-uso/index.public.js 

https://github.com/filipedeschamps/tabnews.com.br/blob/main/LICENSE

Suas respostas est√£o aqui
</issue_918_D√∫vida sobre propriedade intelectual>

<issue_919_Sugest√£o de funcionalidade - "Mostrar senha">
Uma funcionalidade/melhoria na UI sobre algo que particularmente gosto bastante de utilizar.

**A sua sugest√£o de funcionalidade est√° relacionada a algum problema? Por favor descreva.**
Permitir visualiza√ß√£o da senha antes de clicar em Enviar, nas telas de Login/Cadastro

**Descreva a funcionalidade que gostaria**.
Bot√£o para mostrar a senha durante o Login / Cadastro

**Descreva as alternativas que considerou***.
Adicionar um bot√£o com √≠cone de olho aberto/fechado ou um texto de "Mostrar senha"/"Esconder senha"

**Contexto adicional***
![image](https://user-images.githubusercontent.com/62081192/203461614-c14a1805-0591-4f3d-b3d6-54ad6f2e024b.png)
![image](https://user-images.githubusercontent.com/62081192/203461813-204995ce-6ffa-4a1e-9389-d2873e633514.png)

Utilizei o template de Issue presente no PR [#892](https://github.com/filipedeschamps/tabnews.com.br/pull/892#pullrequestreview-1190990951) como base

>> Coment√°rio de nicolasteofilo:
Interresante, acho que vou aderir fazer essa funcionalidade, achei bem interessante...

>> Coment√°rio de aprendendofelipe:
Implementado em #1297 üöÄ
</issue_919_Sugest√£o de funcionalidade - "Mostrar senha">

<issue_920_Sugest√£o para um sistema de notifica√ß√£o>
Ol√° Boa noite devs

Seria interessante criar um sistema de notifica√ß√£o para notificar as respostas dos usu√°rios nos post ex
caso eu crie um post sobre uma duvida referente alguma tecnologia, ent√£o eu receber uma notifica√ß√£o por comentario referente a uma solu√ß√£o sugerida em alguma duvida para pingar aqui mesmo perfil sabe.. sabemos que chega a notifica√ß√£o via e-mail, por√©m aqui na aplica√ß√£o ficaria massa, pois quando logasse poderia se organizar com base nas notifica√ß√µes recebidas aqui!

>> Coment√°rio de coffeeispower:
D√° pra imaginar como isso iria funcionar, da pra fazer como o discord, tem a API rest pra mandar mensagens e etc e tem o websocket que manda eventos para o client

>> Coment√°rio de Joao620:
Mas temos que nos lembrar que nosso cliente √© um site. E notifica√ß√µes vinda de sites n√£o funcionam ainda com IOS

>> Coment√°rio de Rafatcb:
Notifica√ß√µes dentro da plataforma realmente seriam um √≥timo adendo. Acredito que possamos concentrar a discuss√£o nesse issue: #878. Existe tamb√©m o issue #523, sobre receber notifica√ß√µes de outras publica√ß√µes.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_920_Sugest√£o para um sistema de notifica√ß√£o>

<issue_922_[Feature request] - SSO (Single Sign On)>
Acham v√°lido a cria√ß√£o de um user a partir de um provider como google, apple id, github e etc?

>> Coment√°rio de GoulartNogueira:
Acho que o termo correto da feature seria **SSO** (Single Sign On). Entendo que OAuth √© s√≥ um protocolo. Uma _forma_ de fazer o SSO.

H√° pouco tempo eu habilitei o SSO com Google no meu site.
D√° pra fazer tudo gratuito, mas √© necess√°rio uma conta no Gmail respons√°vel pelo site. E essa parte n√£o deveria ser distribu√≠da pela comunidade.

**Precisamos de algu√©m com acesso admin do GCP e Github do Tabnews para configurar os fluxos de OAuth.**
@filipedeschamps, pode nos indicar um respons√°vel?

>> Coment√°rio de GoulartNogueira:
Como sugeriram no #952, eu acho que **Google** + **Github** ia ficar bem massa!
1 √© pouco, 2 √© bom, 3 √© demais. Concordam?

Aqui est√£o os respectivos tutoriais:

https://developers.google.com/identity/gsi/web/guides/overview
https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps

Al√©m disso, precisamos fazer os ajustes no front (para mostrar os bot√µes de SSO) e back (para o fluxo de autentica√ß√£o).

# Tarefas:

- [ ] Habilitar SSO com Google
- [ ] Habilitar SSO com Github
- [ ] Alterar front para incluir os bot√µes de SSO nas telas de login e cadastro.
- [ ] Alterar base de dados (usu√°rios) para vincular o ID Google + ID Github ao ID do usu√°rio
- [ ] Backend pra fazer tudo isso funcionar

Volunt√°rios?

>> Coment√°rio de r3nanp:
@GoulartNogueira, valeu pela corre√ß√£o e a desenvolver a ideia!

>> Coment√°rio de ceelsoin:
@GoulartNogueira existem maneiras para que isso possibilite desenvolver local, √© poss√≠vel utilizar um gateway de login, como o Keycloak, que √© open source e tem a possibilidade rodar local atrav√©s de um container Docker. (https://www.keycloak.org/getting-started/getting-started-docker) sendo assim poderia ser desenvolvido sem os administradores do repo proverem nenhuma chave secreta e trabalhamos totalmente desacoplados atrav√©s dados sandbox local.

E implementando o protocolo OIDC √© poss√≠vel conectar o login no keycloak que por sua vez ir√° administrar a conex√£o com os provedores externos (Google, Github, Facebook) para login (eles chamam isso de federar). Existem outras vantagens, como ele j√° prover toda a infraestrutura de login, recupera√ß√£o de senha, autentica√ß√£o de dois fatores e cadastro. Por√©m apesar de gratuito, existe a necessidade de hospedar ele na pr√≥pria infraestrutura.

Ah! Eu me voluntario pra isso

>> Coment√°rio de gabriellhuver:
Fiz uma poc bem simples de login/cadastro via google para treinar/estudar, criei utilizando o react-oauth/google e a pr√≥pria estrutura do projeto sem alterar modelo de banco, o link da PR est√° abaixo.

Explicando a implementa√ß√£o...

Frontend: o react-oauth/google no front cria o bot√£o de login basta inserir a client-id do google e no callback do bot√£o vem um JWT com os dados que vem do google que √© enviado para uma rota nova criada no backend `/api/v1/sessions/google` que continua o fluxo de login.

Backend: foi criado uma rota customizada de login `/api/v1/sessions/google` que ao inv√©s de receber um usuario/senha ele recebe um JWT, o google tem uma API para a valida√ß√£o dessa  [JWT](https://developers.google.com/identity/gsi/web/guides/get-google-api-clientid) que vem do front , depois de validado existem dois cen√°rios para o login, um usu√°rio que j√° foi criado anteriormente e um usu√°rio que √© novo. Um usu√°rio que j√° existe basta fazer o login utilizando o email e o cadastro j√° existente e caso n√£o tenha cria um cadastro com os dados vindo do google.

![image](https://user-images.githubusercontent.com/15951901/206827624-2029df57-1803-4749-9948-b5028903b3a1.png)

[Pull Request - Teste Tabnews implementa√ß√£o google oauth](https://github.com/filipedeschamps/tabnews.com.br/pull/1123)
 
Ah e caso fique interessante dessa forma, me disponibilizo a fazer.

>> Coment√°rio de rachzy:
Algu√©m topa dar continuidade? √â uma excelente ideia! Vamos implementar, pelo menos, o SSO do GitHub. O que acham?
</issue_922_[Feature request] - SSO (Single Sign On)>

<issue_924_Bug: Postagens exclu√≠das s√£o mantidas na listagem de postagens do usu√°rio>
> _**Atualiza√ß√£o:**_
> Depois de um tempo, a postagem sumiu da listagem

Eu exclu√≠ uma resposta minha em um post, mas ela continuou sendo listada na minha p√°gina de usu√°rio, e ainda clic√°vel.

Quando tentei acess√°-la com um clique, obtive uma p√°gina de erro em branco, somente exibindo a seguinte mensagem:

```
Application error: a client-side exception has occurred (see the browser console for more information).
```

O que mostra no console:
![image](https://user-images.githubusercontent.com/68955399/203596334-06ea64ef-5385-47dd-857d-1ab702026a1f.png)

N√£o √© f√°cil identificar o erro pelo console, porque os assets foram afetados pela minifica√ß√£o no build.

Esse √© o permalink do post exclu√≠do: https://www.tabnews.com.br/dami/c45b1065-3f46-4640-ae0c-298dbd6551b2

Reparem que a postagem exclu√≠da aparece rapidamente, em um flash, antes de ser substitu√≠da pela mensagem de erro.

Ser√° que √© s√≥ um caso de n√£o-intercepta√ß√£o de um erro 404?

>> Coment√°rio de nicolasteofilo:
No console aqui n√£o apareceu estes erros interceptados por voc√™, a requestfoi feita normalmente e retorna o erro 404, sem dados nenhum para serem exibidos em tela, tamb√©m n√£o cheguei a perceper nenhum delay no front-end da p√°gina, o not foud apareceu quase que instant√¢neo

>> Coment√°rio de dami-i:
> No console aqui n√£o apareceu estes erros interceptados por voc√™, a requestfoi feita normalmente e retorna o erro 404, sem dados nenhum para serem exibidos em tela, tamb√©m n√£o cheguei a perceper nenhum delay no front-end da p√°gina, o not foud apareceu quase que instant√¢neo

Isso foi replicando a situa√ß√£o com uma postagem sua ou acessando o permalink ali em cima?

>> Coment√°rio de aprendendofelipe:
Oi @dami-i, isso deve ter ocorrido por tr√™s fatores:

O primeiro n√£o √© um problema, mas sim algo caracter√≠stico do Next.js, pois utilizamos `next/link` paras as navega√ß√µes, e com isso o Next.js faz um pr√©-carregamento das p√°ginas, mesmo que elas estejam obsoletas. Ent√£o voc√™ estava vendo a vers√£o em cache das p√°ginas.

O segundo fator √© que ap√≥s carregar a p√°gina ocorre a revalida√ß√£o dos dados pelo client via `SWR`. E com isso gerava o erro ap√≥s um tempo, pois n√£o est√° previsto o retorno 404 via `SWR`. Precisamos arrumar esse BUG.

O terceiro fator √© um problema que est√° ocorrendo na CDN da Vercel, em que eles n√£o est√£o propagando a revalida√ß√£o das p√°ginas quando navegamos via `next/link`, ou seja, o que deveria acontecer √© que ap√≥s voc√™ navegar a primeira vez para a p√°gina obsoleta, em segundo plano deveria ser cacheada uma vers√£o atualizada (que nesse caso seria 404), mas isso n√£o est√° ocorrendo. Ent√£o com esse BUG da CDN, s√≥ com F5 voc√™ for√ßa a revalida√ß√£o das p√°ginas.

Obs. Mesmo com F5, no primeiro acesso voc√™ ver√° a p√°gina obsoleta, mas se esperar o tempo necess√°rio para a revalida√ß√£o da p√°gina ocorrer em segundo plano, na pr√≥xima navega√ß√£o a p√°gina j√° estar√° atualizada.

Sobre o problema na CDN, por enquanto acho que devemos aguardar a solu√ß√£o pela Vercel. S√≥ se eles n√£o resolverem isso logo, a√≠ a gente deve mudar a abordagem das navega√ß√µes, mas isso seria muito ruim, pois perder√≠amos uma das grandes vantagens de usar o Next.js.

>> Coment√°rio de dami-i:
Obrigado pelo retorno e pela explica√ß√£o, @aprendendofelipe. Que bom que a causa desse bug j√° √© conhecida.

>> Coment√°rio de filipedeschamps:
E eu adicionaria ao que o @aprendendofelipe escreveu que removemos a atualiza√ß√£o autom√°tica da lista temporariamente, e isto ir√° contribuir em voc√™ ver uma lista obsoleta. Assim que publicarmos umas otimiza√ß√µes no backend iremos habilitar esse recurso novamente ü§ù 

E o bug de n√£o tratar o erro do SWR de fato √© o que est√° mais machucando o frontend hoje.

>> Coment√°rio de aprendendofelipe:
Turma, vou fechar essa issue porque acredito que, fora a quest√£o normal de cache, os problemas citados n√£o est√£o mais presentes. ü§ù
</issue_924_Bug: Postagens exclu√≠das s√£o mantidas na listagem de postagens do usu√°rio>

<issue_925_[feat] Controle de publica√ß√µes e feeding mal intencionado.>
Imagino que por conta da plataforma ter a proposta de ser recompensadora, atitudes como essa ser√£o recorrentes. J√° vi alguns casos, mas tirei print somente desse.
Seria interessante ter uma maneira dos usu√°rios poderem reportar ou a partir dos downvotes, remover as tabcoins gerados por aquela d√∫vida. 
Tamb√©m notei que o downvote custa o mesmo valor do upvote, dai fiquei desapontado quando dei o downvote e zerou minhas coins kkkkk

![image](https://user-images.githubusercontent.com/49521694/203623030-69d08302-42d4-4280-8000-a38e2f231dc5.png)

>> Coment√°rio de filipedeschamps:
@fabiuhp excelente ponto! O benef√≠cio entre downvote e upvote √© o mesmo: `1` TabCash... ent√£o como resultado final para quem est√° qualificando, n√£o faz diferen√ßa, mas eu entendo total o impacto psicol√≥gico.

O que poder√≠amos talvez fazer √©: se uma publica√ß√£o recebeu downvotes ao ponto dela ser **deletada**, as TabCoins usadas para downvote poderiam voltar para o usu√°rio que qualificou (mas n√£o voltaria para quem tomou o downvote).

O que acha?

>> Coment√°rio de fabiuhp:
Bacana @filipedeschamps , mas tenho algumas d√∫vidas. 
Com quantos downvotes um topico √© deletado?
N√£o acha que seria interessante o downvote n√£o ter valor? Visto que no exemplo do print, eu poderia ter dado diversos downvotes. E caso o t√≥pico seja realmente deletado por n√£o acrescentar valor ou por apenas ser spam, os usu√°rios que ajudaram a filtrar, serem recompensados com essa tabcoin? E caso a publica√ß√£o n√£o seja, nada aconte√ßa? Dai dessa forma impede que sejam distribuidos downvotes sem motiva√ß√µes.

>> Coment√°rio de filipedeschamps:
> Com quantos downvotes um topico √© deletado?

Nenhum, hoje √© feito manualmente.

> N√£o acha que seria interessante o downvote n√£o ter valor?

Voc√™ diz: n√£o consumir valor de TabCoins? Teriamos que tomar cuidado com isso, pois hoje o controle da plataforma √© de quem cria os conte√∫dos, e n√£o de quem apenas l√™.

>> Coment√°rio de fabiuhp:
> Nenhum, hoje √© feito manualmente.

Miss√£o dif√≠cil essa ein kkkk

> Voc√™ diz: n√£o consumir valor de TabCoins? Teriamos que tomar cuidado com isso, pois hoje o controle da plataforma √© de quem cria os conte√∫dos, e n√£o de quem apenas l√™.

Isso, n√£o consumir. E caso o t√≥pico em quest√£o seja realmente deletado, recompensar quem apontou o downvote com 1 TabCoin. Caso n√£o seja deletado, nada acontece.

Como evitar comportamentos maliciosos de quem dar downvote em tudo por ser liberado? Poderia liberar esse downvote infinito a partir de `n` TabCoins conquistadas. Poderia haver um limite di√°rio?
S√£o casos a serem pensados, por que atualmente eu vejo um problema parecido onde trabalho, onde podem acontecer de pessoas criarem milhares de publica√ß√µes no f√≥rum, buscando apenas conquistar os pontos de exp.
Vejo exemplos de post assim: "aaaaaaaaaaaaa", "abrindo pergunta", "letra de musica qualquer".

√â dif√≠cil pensar em recompensas quando envolvem casos assim.

Imagina um cen√°rio onde algum usu√°rio crie algum tipo de automa√ß√£o para post's? Existe tantas possibilidades kkkk

>> Coment√°rio de aprendendofelipe:
Quando n√£o houver mais um ganho fixo de TabCoins por postagem, ou seja, quando o valor inicial depender da reputa√ß√£o das postagens anteriores, isso n√£o vai mais ser vi√°vel, pois o usu√°rio n√£o ir√° ganhar nada com essas publica√ß√µes e ainda pode ficar com saldo negativo.

Sobre devolver as TabCoins de quem qualificou negativamente um conte√∫do que foi apagado, ~eu acho uma boa!~ Pensei melhor e n√£o acho que seja boa ideia tornar mais vantajoso dar votos negativos do que positivos.

>> Coment√°rio de Rafatcb:
> O que poder√≠amos talvez fazer √©: se uma publica√ß√£o recebeu downvotes ao ponto dela ser deletada, as TabCoins usadas para downvote poderiam voltar para o usu√°rio que qualificou (mas n√£o voltaria para quem tomou o downvote).

@filipedeschamps acho que faz sentido. Precisaremos tomar cuidado ao apagar automaticamente uma publica√ß√£o, caso isso venha a ocorrer um dia. Por exemplo, eu posso acumular 20 TabCoins e dar 10 negativos em uma publica√ß√£o de algu√©m que eu n√£o gosto, ela ser apagada, e eu receber o valor de volta.

Tamb√©m ser√° preciso prestar aten√ß√£o se o usu√°rio simplesmente apagar uma publica√ß√£o negativada e fazer outra igual. J√° vi algo similar acontecendo, onde o usu√°rio fez uma publica√ß√£o num hor√°rio que n√£o chamou aten√ß√£o, depois apagou e republicou. Esse caso que presenciei n√£o foi danoso, mas me fez pensar nos casos ruins que podem vir a acontecer.

---

Uma coisa que est√° dif√≠cil esses dias √© de recompensar os bons conte√∫dos e classificar os ruins. Tem muito coment√°rio do tipo "vlw", e inclusive publica√ß√µes que infelizmente tomaram uma propor√ß√£o muito grande enquanto estavam na Home e acabaram com v√°rios coment√°rios assim. Mas, sei que n√£o estamos no modo "definitivo" da economia, ent√£o estou classificando as coisas como consigo.

>> Coment√°rio de fabiuhp:
> Por exemplo, eu posso acumular 20 TabCoins e dar 10 negativos em uma publica√ß√£o de algu√©m que eu n√£o gosto, ela ser apagada, e eu receber o valor de volta.

Um downvote por usu√°rio por t√≥pico. Impossibilitando a possibilidade de dar 10 downvotes. Tem que passar por uma filtragem de 10 usu√°rios, como foi o exemplo que voce citou.

>> Coment√°rio de aprendendofelipe:
Eu acredito que n√£o precisamos apagar automaticamente nenhuma publica√ß√£o (casos graves s√£o apagados manualmente), mas sim criar um mecanismo que estimule o dono da publica√ß√£o apagar por conta pr√≥pria se ela n√£o for bem aceita.

Se um usu√°rio postou algo que foi negativado, ele n√£o consegue postar mais nada enquanto estiver com saldo de TabCoins negativo. Mas ele tamb√©m pode recuperar o saldo negativado de suas TabCoins caso apague a publica√ß√£o por conta pr√≥pria, ou seja, ele tem a op√ß√£o de voltar ao zero a zero.

Isso junto do fato de ningu√©m ganhar TabCoins iniciais enquanto n√£o tiver boa reputa√ß√£o, deve resolver a maioria do problemas de conte√∫dos sem valor.

P.S. Na quest√£o de reputa√ß√£o talvez seja melhor ter duas reputa√ß√µes diferentes, a de conte√∫dos e de coment√°rios, pois coment√°rios normalmente recebem menos votos, ent√£o isso baixaria a reputa√ß√£o de quem comenta bastante, mesmo que coment√°rios de qualidade

>> Coment√°rio de AugustoSavi:
> Eu acredito que n√£o precisamos apagar automaticamente nenhuma publica√ß√£o (casos graves s√£o apagados manualmente), mas sim criar um mecanismo que estimule o dono da publica√ß√£o apagar por conta pr√≥pria se ela n√£o for bem aceita.
> 
> Se um usu√°rio postou algo que foi negativado, ele n√£o consegue postar mais nada enquanto estiver com saldo de TabCoins negativo. Mas ele tamb√©m pode recuperar o saldo negativado de suas TabCoins caso apague a publica√ß√£o por conta pr√≥pria, ou seja, ele tem a op√ß√£o de voltar ao zero a zero.
> 
> Isso junto do fato de ningu√©m ganhar TabCoins iniciais enquanto n√£o tiver boa reputa√ß√£o, deve resolver a maioria do problemas de conte√∫dos sem valor.
> 
> P.S. Na quest√£o de reputa√ß√£o talvez seja melhor ter duas reputa√ß√µes diferentes, a de conte√∫dos e de coment√°rios, pois coment√°rios normalmente recebem menos votos, ent√£o isso baixaria a reputa√ß√£o de quem comenta bastante, mesmo que coment√°rios de qualidade

Uma alterativa seria mostrar os pontos de reputa√ß√£o dos usu√°rios ao lado de suas perguntas e respostas como stackoverflow, reddit, etc...

>> Coment√°rio de aprendendofelipe:
>  Uma alterativa seria mostrar os pontos de reputa√ß√£o dos usu√°rios ao lado de suas perguntas e respostas como stackoverflow, reddit, etc...

Mas nada impede que um usu√°rio com boa reputa√ß√£o publique algo sem valor. Ent√£o acho que n√£o podemos misturar a reputa√ß√£o do usu√°rio com a do conte√∫do pra n√£o influenciar a percep√ß√£o dos leitores

>> Coment√°rio de AugustoSavi:
> > Uma alterativa seria mostrar os pontos de reputa√ß√£o dos usu√°rios ao lado de suas perguntas e respostas como stackoverflow, reddit, etc...
> 
> Mas nada impede que um usu√°rio com boa reputa√ß√£o publique algo sem valor. Ent√£o acho que n√£o podemos misturar a reputa√ß√£o do usu√°rio com a do conte√∫do pra n√£o influenciar a percep√ß√£o dos leitores

Ter sua reputa√ß√£o baixada n√£o seria um impeditivo para publicar algo sem valor?

>> Coment√°rio de aprendendofelipe:
> > > Uma alterativa seria mostrar os pontos de reputa√ß√£o dos usu√°rios ao lado de suas perguntas e respostas como stackoverflow, reddit, etc...
> > 
> > 
> > Mas nada impede que um usu√°rio com boa reputa√ß√£o publique algo sem valor. Ent√£o acho que n√£o podemos misturar a reputa√ß√£o do usu√°rio com a do conte√∫do pra n√£o influenciar a percep√ß√£o dos leitores
> 
> Ter sua reputa√ß√£o baixada n√£o seria um impeditivo para publicar algo sem valor?

Sim, deveria ser um impeditivo, com certeza.

O que eu disse √© que n√£o acho que deveria mostrar a reputa√ß√£o do autor nas publica√ß√µes. A reputa√ß√£o do autor √© uma coisa diferente da reputa√ß√£o de uma publica√ß√£o desse autor.

>> Coment√°rio de FilipeMarch:
As solu√ß√µes que eu tenho enxergado envolvem dificultar mais o ganho de tabcoins. √â como se estiv√©ssemos jogando modo medium, e vamos jogar agora um pouco no hard. Mas acho que ainda d√° pra se divertir.


**Ideia 1**
Pensei nesse comportamento do primeiro coment√°rio: 

0- Todo coment√°rio por padr√£o √© iniciado sem ganho de tabcoin. Por ex:
1- Algu√©m comenta "legal o t√≥pico", ela ganha 0 tabcoin. 
2- Algu√©m d√° um upvote no coment√°rio, o coment√°rio passa a ter 2tabcoins.
3- Outra pessoa d√° um upvote no mesmo coment√°rio, o coment√°rio passa a ter 3tabcoins.

Assim, a maior parte desses coment√°rios "vlw flw", "legal", "mt bom", permaneceriam em 0tabcoin, porque por qual raz√£o voc√™ gastaria 1tabcoin pra esse tipo de coment√°rio?

Isso diminui o incentivo dos irm√£os de buscarem ganhar 1tabcoin atrav√©s de coment√°rios muito pequenos.

**Ideia 2**

Quando voc√™ cria uma nova conta, voc√™ come√ßa com 3tabcoins especiais (que s√≥ servem para criar post):

- Todo post voc√™ gasta 1tabcoin. Assim voc√™ n√£o vai criar um post sem pensar duas vezes se isso tem algum valor.
- Se voc√™ tiver qualquer tabcoin especial (as 3 que vc ganhou quando criou sua conta) e voc√™ cria um post, as tabcoins especiais s√£o gastas.
- Voc√™ n√£o pode usar uma tabcoin especial para dar upvote em outros posts/coment√°rios. Apenas pode gast√°-las criando posts.
- Quando voc√™ cria um post, seu saldo de tabcoins especiais √© verificado, e voc√™ gasta 1tabcoin especial. Caso n√£o tenha nenhuma tabcoin especial, ser√° gasto das tabcoins normais.

Isso diminui o incentivo de criar posts (pois cada post envolve gastar 1tabcoin do seu saldo, ao inv√©s de ganhar 1. Assim, voc√™ sabe que somente outros usu√°rios v√£o tornar seu saldo positivo).

A cada 24h ou 1 semana, n√£o sei, todos os usu√°rios sem nenhuma tabcoin ganham 1tabcoin especial. Assim, se voc√™ torrou todas suas tabcoins especiais (criando 3 posts que n√£o geraram nenhum valor e n√£o recebeu nenhum upvote, zerando seu saldo), voc√™ √© perdoado e voc√™ pode tentar mais uma vez. 

**RESULTADOS**

Esse cara da screenshot que voc√™s mandaram nem teria conseguido criar 10 t√≥picos. Ele teria criado tr√™s t√≥picos, gastado suas 3tabcoin especiais e fim. Ele tem que criar um t√≥pico, **ser validado pela comunidade**, e ent√£o ganhar o direito de criar mais t√≥picos.

Eu ainda concordo que downvote + delete a partir de um certo threshold √© interessante, mas temos que ter cuidado com as din√¢micas que isso possa causar na comunidade. A gente tem que se unir ao m√°ximo e evitar downvote, a n√£o ser que sejam conte√∫dos realmente danosos (spam, golpes, etc)

>> Coment√°rio de aprendendofelipe:
@FilipeMarch, a ideia 1 √© f√°cil de burlar utilizando mais de um usu√°rio, coisa que j√° est√° acontecendo.

A ideia 2 √© complicada porque, ou vai limitar quem realmente tem conte√∫do de valor para postar ou n√£o vai limitar ningu√©m.

E n√£o entendi a raz√£o para evitar downvote. Essa √© a maneira de qualificar os conte√∫dos. Downvote n√£o √© o mesmo que denunciar o conte√∫do. Mas l√≥gico que conte√∫dos com saldo muito negativo s√£o os primeiros candidatos a serem analisados pela modera√ß√£o.

Mas se ver algo que n√£o ache que tenha valor concreto, pode ganhar seu TabCash com um downvote, pois isso melhora o ranqueamento.

O que n√£o podemos √© criar um ambiente de competi√ß√£o, mas sim de colabora√ß√£o.

>> Coment√°rio de fabiuhp:
Mas cara, se alguem criar 3 conteudos de valor real, obviamente eles vao receber coins. √â improvavel alguem que crie conteudo decente ficar sem tabcoins.

>> Coment√°rio de FilipeMarch:
> @FilipeMarch, a ideia 1 √© f√°cil de burlar utilizando mais de um usu√°rio, coisa que j√° est√° acontecendo.

Concordo que √© f√°cil de burlar, mas √© como o muro da sua casa! √â s√≥ algu√©m botar uma cadeira ou uma escada que d√° pra pular! Mas s√≥ o trabalho de ter que carregar uma escada pra burlar o sistema j√° faz muita gente desistir. Os mais motivados com certeza n√£o v√£o considerar isso um grande problema. 

> A ideia 2 √© complicada porque, ou vai limitar quem realmente tem conte√∫do de valor para postar ou n√£o vai limitar ningu√©m.

Acho que essa ideia ir√° dificultar uma pessoa que nunca criou nenhum valor na plataforma (s√≥ criou a conta) de postar 10 t√≥picos um atr√°s do outro, porque ele n√£o tem saldo para isso. Ela pode tentar obter saldo atrav√©s de um m√©todo justo para criar mais t√≥picos.

> E n√£o entendi a raz√£o para evitar downvote. Essa √© a maneira de qualificar os conte√∫dos. Downvote n√£o √© o mesmo que denunciar o conte√∫do. Mas l√≥gico que conte√∫dos com saldo muito negativo s√£o os primeiros candidatos a serem analisados pela modera√ß√£o.
> 
> Mas se ver algo que n√£o ache que tenha valor concreto, pode ganhar seu TabCash com um downvote, pois isso melhora o ranqueamento.
> 
> O que n√£o podemos √© criar um ambiente de competi√ß√£o, mas sim de colabora√ß√£o.

Sim, a ideia √© essa mesmo! 

Eu ainda incrementaria mais regras ao custo de criar t√≥picos: pode ser um custo vari√°vel, que depende de v√°rios fatores:

- Inicialmente o custo de criar um t√≥pico √© 1tabcoin. 
- Se voc√™ cria um n√∫mero de t√≥picos muito acima da m√©dia de outros criadores de t√≥picos, o custo pra voc√™ aumenta. Por exemplo, suponha que aqueles usu√°rios que criaram t√≥picos com 5 ou mais upvotes na √∫ltima semana criaram em m√©dia 1 t√≥pico por dia. Se voc√™ tenta postar 2 t√≥picos no mesmo dia, seu custo ser√° 1tabcoin no primeiro t√≥pico, 2 tabcoins no segundo t√≥pico (porque voc√™ t√° tentando criar t√≥pico 2x acima da m√©dia de outros criadores da mesma semana). 

Os efeitos que enxergo s√£o: conforme as pessoas criam menos t√≥picos, o custo pra criar t√≥picos se torna mais barato. Se as pessoas come√ßam a criar muitos t√≥picos, o seu custo aumenta, e assim a gente come√ßa a prezar pela qualidade ao inv√©s da quantidade.

Ent√£o na pr√°tica o que aconteceria com esse rapaz que criou 10 t√≥picos em uma √∫nica hora?
O primeiro t√≥pico custou 1tabcoin, o segundo t√≥pico custou 2 tabcoins, o terceiro t√≥pico custou 3tabcoins... ou seja, voc√™ vai mitigar o spam dessa maneira.  

E se seus t√≥picos fossem leg√≠timos e fossem gerar muito valor, voc√™ nem iria se importar de post√°-los porque sabe que seria recompensado.

>> Coment√°rio de filipedeschamps:
Em paralelo, uma coisa que eu acredito que ir√° dificultar a conversa √© que hoje n√£o √© poss√≠vel utilizar o TabCash, ent√£o psicologicamente ele n√£o tem valor, e s√≥ as TabCoins tem. Mas quando o sistema de Revenue Share for implementado (ou outra feature que use o TabCash), essa percep√ß√£o vai ser equalizada, onde se voc√™ gastar TabCoins para negativar uma publica√ß√£o mas com isso ganhar 1 TabCash, a conta fecha. O problema, eu imagino, √© que hoje as pessoas est√£o sentindo algo negativo ao ver as TabCoins diminuirem, porque de fato n√£o h√° nenhum efeito colateral positivo para elas nesta a√ß√£o.

>> Coment√°rio de Rafatcb:
Voltando √† men√ß√£o espec√≠fica no in√≠cio dessa issue, eu estava relendo os termos de uso, e o t√≥pico 6 come√ßa com:

> O usu√°rio se compromete em n√£o realizar publica√ß√µes com foco **exclusivo** comercial (...)

Acredito que esse ponto poderia ser mais elaborado para deixar claro o que √© uma publica√ß√£o com foco exclusivo comercial, porque por exemplo, eu interpreto as publica√ß√µes da print como se encaixando nessa descri√ß√£o, mas essa interpreta√ß√£o √© subjetiva.

>> Coment√°rio de MatheusGarvao:
Eu escrevi umas ideias e coloquei l√° no TabNews, por√©m fui redirecionado para este Issue, talvez ela consiga dar uma ajuda nessa resolu√ß√£o do problema.

Como o Filipe citou, hoje TabCash n√£o √© utilizada para nada, mas e se, al√©m de poder usar ela para a Revenue Share, ela tamb√©m servir como uma moeda de convers√£o e limita√ß√£o, dificultando um pouco de ter spam de um usu√°rio novo e facilitando um moderador de poder punir de alguma forma essas pessoas...

A minha ideia inicial ficou mais ou menos assim, mas seria necess√°rio uma adapta√ß√£o para encaixar a ideia 2 do FilipeMarch, que eu gostei bastante a prop√≥sito.

## A ideia

    Toda publica√ß√£o custa 1 tabCash, e retorna 2 tabCoins.

    Cada rea√ß√£o (like ou deslike) custa 2 tabCoins, e retorna 1 tabCash.

    Limite de 1 rea√ß√£o por coment√°rio/publica√ß√£o.

    Cada coment√°rio acima de x caracteres ganhar apenas 1 tabCoin.
*esse acima de x caracteres √© pass√≠vel de mudan√ßa, as vezes um coment√°rio relevante n√£o precisa ter uma quantidade m√≠nima de caracteres, pensei nisso apenas para evitar spam de coment√°rios.*


    Cada rea√ß√£o positiva recebida, gerar 1 tabCoin para quem recebeu a curtida (sistema s√≥ ativado se o post houver mais de 10 rea√ß√µes positivas).

*Sistema de rea√ß√µes positivas acima n√£o vale para coment√°rios, coment√°rios apenas geram 1 tabCoin por postar ele e geram 1 tabCash para a pessoa que der alguma rea√ß√£o nele, por√©m n√£o afeta quem publicou o coment√°rio.*

    Toda conta come√ßar com 1 tabCash.

## Explica√ß√µes

Todo novo usu√°rio, come√ßando com 1 tabCash, poder√° fazer 1 publica√ß√£o e comentar a vontade antes de reagir a de outros.

O intuito desse sistema, √© dar mais valor a rea√ß√£o da pessoa, colocando um peso maior j√° que seria limitado apenas a uma rea√ß√£o por post/coment√°rio.

Se notar bem, ele entra em um loop sem nunca poder ficar sem nenhum coin na conta, e caso futuramente fique, ser poss√≠vel recuperar com coment√°rios e recebendo rea√ß√µes positivas nos posts j√° realizados.

o loop seria: 

    1 tabCash transforma em 2 tabCoins ao publicar algo.
    2 tabCoins transforma em 1 tabCash ao curtir algo.

Isso limitando a quantidade de posts "spam", deixando um valor maior aos likes e possivelmente recompensando por posts bem desenvolvidos (+ de 10 likes), aumentando o limite de publica√ß√µes ou likes a medida que a pessoa √© mais engajada na comunidade.

Eu n√£o sei se eu fui muito al√©m, se minha ideia √© ruim ou se ficou dif√≠cil de compreender, qualquer d√∫vida eu posso responder ou tentar deixar visivelmente melhor, mas fiz um pequeno gr√°fico mostrando as rela√ß√µes:

![ideiaSistema](https://user-images.githubusercontent.com/100000464/204575413-95fdb6a7-7509-4e62-9a07-f968822a4e73.png)

>> Coment√°rio de JamesIslan:
A discuss√£o aqui sobre esse t√≥pico t√° realmente muito interessante, ent√£o eu gostaria de levantar mais uma quest√£o acerca da atitude a ser tomada com posts considerados "irrelevantes": E se, ao inv√©s de excluir um post que a pr√≥pria comunidade classifica como "irrelevante" atrav√©s dos _downvotes_, fosse implementado um sistema que oculta essas publica√ß√µes na p√°gina inicial e nas op√ß√µes de pesquisa que vir√£o futuramente? O Reddit implementa algo semelhante mas apenas com coment√°rios, ocultando os coment√°rios que recebem muitos _downvotes_, mas dando a possibilidade de visualiz√°-lo, caso o usu√°rio queira.  
O motivo de eu levantar esse t√≥pico √© que como falado [nesse t√≥pico](https://www.tabnews.com.br/gabrielTapes/discussao-os-comentarios-aumentam-o-valor-e-a-relevancia-de-um-conteudo), os coment√°rios tamb√©m exercem um importante papel em educar os usu√°rios sobre os erros que cometem, ou os termos que violam, muitas vezes sem saber direito. Ou seja, mesmo um post com muitos _downvotes_ pode ter um valor agregado nos coment√°rios, que advertem o dono do post sobre os erros que cometeu. Dessa forma, ao mesmo tempo que o conte√∫do do site fica mais limpo, n√£o se remove esse post completamente, o que possibilita ele de ser citado em um poss√≠vel "manual de como n√£o agir".

>> Coment√°rio de rcarubbi:
Por que n√£o implementar um limite que permita apenas um downvote por artigo? Reconhe√ßo que, ao utilizar a plataforma, n√£o li os termos de uso e acabei dando m√∫ltiplos downvotes em conte√∫dos posicionados acima dos meus artigos na tentativa de aumentar sua visibilidade. Essa pr√°tica resultou no banimento da minha conta e na exclus√£o de todos os meus artigos, dos quais j√° n√£o possuo c√≥pias. Caso a plataforma contasse com mecanismos para evitar esse tipo de comportamento, poderia atuar de forma preventiva, promovendo uma experi√™ncia mais equilibrada para todos os usu√°rios ao inv√©s de ter uma postura punitiva contra os desavisados.

Gostaria encarecidamente de solicitar a recupera√ß√£o da minha conta ou, ao menos, uma c√≥pia dos arquivos em markdown dos artigos que compartilhei, para que eu possa disponibiliz√°-los em outra plataforma.

>> Coment√°rio de Rafatcb:
@rcarubbi Temos o limite de tr√™s votos na mesma publica√ß√£o a cada 72 horas. Essa prote√ß√£o de manipula√ß√£o de votos de forma "autom√°tica" certamente √© algo que podemos melhorar.

> Gostaria encarecidamente de solicitar a recupera√ß√£o da minha conta ou, ao menos, uma c√≥pia dos arquivos em markdown dos artigos que compartilhei, para que eu possa disponibiliz√°-los em outra plataforma.

Por favor, envie um e-mail para `contato@tabnews.com.br` com o seu nome de usu√°rio, utilizando o e-mail da conta que foi banida.
</issue_925_[feat] Controle de publica√ß√µes e feeding mal intencionado.>

<issue_927_Barra de busca>
Utilizando a plataforma percebi que ela n√£o tem uma barra de busca de buscas para procurar posts com conte√∫dos espec√≠ficos. Por exemplo poderia existir uma barra no topo da p√°gina em que poderiamos procurar por termos (por exemplo "Javascript") e filtrar os posts que tivessem Javascript no seu conte√∫do.

>> Coment√°rio de Jeiel0rbit:
> Utilizando a plataforma percebi que ela n√£o tem uma barra de busca de buscas para procurar posts com conte√∫dos espec√≠ficos. Por exemplo poderia existir uma barra no topo da p√°gina em que poderiamos procurar por termos (por exemplo "Javascript") e filtrar os posts que tivessem Javascript no seu conte√∫do.

Concordo. Isso j√° √© um planejamento futuro criado. J√° existem tipos de sugest√µes similares. Thanks pela, mais uma.

>> Coment√°rio de luiz-leite-dev:
acabei de [criar um mecanismo de pesquisa program√°vel](https://www.hostmidia.com.br/tutoriais/como-usar-a-busca-do-google-no-meu-site/):
https://cse.google.com/cse?cx=c78b7565990294f01

seria s√≥ incluir isso na barra de t√≠tulo do tabnews:
`<script async src="https://cse.google.com/cse.js?cx=c78b7565990294f01"></script><div class="gcse-search"></div>`

>> Coment√°rio de aprendendofelipe:
Estou direcionando as conversas sobre as funcionalidade de pesquisa para essa issue porque ela √© a mais antiga que est√° aberta, mas recomendo verem tamb√©m o que foi discutido em algumas das duplicadas, como a #1084

>> Coment√°rio de mthmcalixto:
O @mpedroni #1084 chegou perto do que eu cheguei em #1454 tamb√©m, mas existe contras e pr√≥s entre usar o [MeiliSearch](https://www.meilisearch.com/), veja uma compara√ß√£o utilizando o [Typesense](https://typesense.org/): [Compare Algolia vs ElasticSearch vs Meilisearch vs Typesense](https://typesense.org/typesense-vs-algolia-vs-elasticsearch-vs-meilisearch/)

>> Coment√°rio de mpedroni:
> O @mpedroni #1084 chegou perto do que eu cheguei em #1454 tamb√©m, mas existe contras e pr√≥s entre usar o [MeiliSearch](https://www.meilisearch.com/), veja uma compara√ß√£o utilizando o [Typesense](https://typesense.org/): [Compare Algolia vs ElasticSearch vs Meilisearch vs Typesense](https://typesense.org/typesense-vs-algolia-vs-elasticsearch-vs-meilisearch/)

Eu gosto da ideia de usar essas ferramentas tipo Meilisearch e Typesense. Por√©m, como discutido na issue #1084, esse tipo de ferramenta implica um custo de manuten√ß√£o. Visto que a plataforma √© gratuita e (at√© onde eu sei kk) n√£o gera renda, acredito que o ideal seria procurarmos solu√ß√µes que n√£o gerem mais custos para o Deschamps, visto que todo o custo do Tabnews sai do bolso dele. 

Apesar de o Meilisearch e o Typesense apresentarem melhores resultados nas buscas, eu acho que vale a pena utilizar os recursos de full-text search do pr√≥prio PostgreSQL (tamb√©m discutido na issue #1084) seja mais interessante por agora e, caso n√£o seja suficiente, avaliar a utiliza√ß√£o de um servi√ßo externo (e os custos envolvidos nisso).

>> Coment√°rio de mthmcalixto:
> > O @mpedroni #1084 chegou perto do que eu cheguei em #1454 tamb√©m, mas existe contras e pr√≥s entre usar o [MeiliSearch](https://www.meilisearch.com/), veja uma compara√ß√£o utilizando o [Typesense](https://typesense.org/): [Compare Algolia vs ElasticSearch vs Meilisearch vs Typesense](https://typesense.org/typesense-vs-algolia-vs-elasticsearch-vs-meilisearch/)
> 
> Eu gosto da ideia de usar essas ferramentas tipo Meilisearch e Typesense. Por√©m, como discutido na issue #1084, esse tipo de ferramenta implica um custo de manuten√ß√£o. Visto que a plataforma √© gratuita e (at√© onde eu sei kk) n√£o gera renda, acredito que o ideal seria procurarmos solu√ß√µes que n√£o gerem mais custos para o Deschamps, visto que todo o custo do Tabnews sai do bolso dele.
> 
> Apesar de o Meilisearch e o Typesense apresentarem melhores resultados nas buscas, eu acho que vale a pena utilizar os recursos de full-text search do pr√≥prio PostgreSQL (tamb√©m discutido na issue #1084) seja mais interessante por agora e, caso n√£o seja suficiente, avaliar a utiliza√ß√£o de um servi√ßo externo (e os custos envolvidos nisso).

O que eu entendi, Typesense crie um servi√ßo e retorna os resultados da pesquisa com base nas consultas enviadas, acredito que seja mais barato do que fazer consulta diretamente no banco de dados, imagina a busca sendo chamada todo tempo no banco de dados iria sobrecarregar ele, usando o Typesense voc√™ consegue em tempo real o que escreve.

>> Coment√°rio de aprendendofelipe:
Considerando que:

1. Uma implementa√ß√£o bem feita de um sistema de buscas pr√≥prio vai envolver novos custos ou a exibi√ß√£o de an√∫ncios;
2. Mesmo optando por assumir novos custos, ainda dependemos de algu√©m dedicando um bom tempo para a implementa√ß√£o da funcionalidade;
3. √â importante ter um sistema de busca integrado ao TabNews que ajude aos usu√°rios e nos permita algum controle sobre seu funcionamento.
4. Talvez mais dif√≠cil do que implementar, seja gerenciar todas as possibilidades de indexa√ß√£o para que o sistema realmente ajude aos usu√°rios a encontrar o que procuram.
5. A melhor maneira de pesquisar conte√∫dos no TabNews atualmente √© usando o Google. O que est√° longe do ideal, j√° que envolve a exibi√ß√£o de an√∫ncios, pode levar os usu√°rios para outros sites, e n√£o nos fornece dados mais precisos sobre quem queria encontrar algo especificamente no TabNews.
6. As pesquisas pelo TabNews no Google ajudam a melhorar o nosso SEO, o que atrai mais visualiza√ß√µes para os nossos conte√∫dos, mesmo de usu√°rios que n√£o estavam pesquisando diretamente pelo termo TabNews.
7. Sempre vamos precisar dedicar esfor√ßos para mante um bom desempenho em SEO.
8. O tempo e conhecimento dedicado para gerenciar o sistema de buscas pr√≥prio pode trazer melhores resultados ser for direcionado para melhorar o SEO.
9. O Google fornece algumas maneiras de integrar o seu sistema de busca ao TabNews, mas, como qualquer outra op√ß√£o, envolve custos ou a exibi√ß√£o de an√∫ncios.
10. N√£o temos como saber se vale a pena usar a vers√£o sem an√∫ncios do pr√≥prio Google (ou de qualquer outro servi√ßo) ou se vale mais a pena ter um servidor pr√≥prio, pois n√£o temos no√ß√£o de qual seria o volume de utiliza√ß√£o, o que implica que primeiro precisamos ter algum sistema de busca que nos forne√ßa bons dados sobre a sua utiliza√ß√£o.
11. Fornecer uma forma de pesquisar diretamente no banco de dados do TabNews provavelmente n√£o seria perform√°tico (podendo prejudicar a experi√™ncia em outras funcionalidades), e provavelmente n√£o traria bons resultados para a maioria dos usu√°rios que n√£o soubessem usar bem a ferramenta. Por isso essa funcionalidade, se implementada, teria que primeiramente ser colocada em teste apenas para uma parte dos usu√°rios.

Ent√£o eu gostaria de saber:

**Enquanto ningu√©m implementa algum sistema mais robusto que possa ser disponibilizado de maneira geral, voc√™s acham que j√° ajudaria aos usu√°rios se integrarmos o sistema do Google, mesmo mantendo os an√∫ncios?**

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/02d55a95-0c33-4303-b944-3b0fe2d0098d)

Eu acredito que j√° ajudaria alguns usu√°rios, mas o principal √© que ter√≠amos dados sobre a utiliza√ß√£o para avaliar se vale a pena implementar algo pr√≥prio, se vale manter os an√∫ncios do Google (que podem at√© trazer alguma receita) ou se vale a pena pagar para o Google para remover os an√∫ncios, o que √© pouco prov√°vel, j√° que custa $5 a cada 1.000 pesquisas.

>> Coment√°rio de mthmcalixto:
> Considerando que:
> 
> 1. Uma implementa√ß√£o bem feita de um sistema de buscas pr√≥prio vai envolver novos custos ou a exibi√ß√£o de an√∫ncios;
> 2. Mesmo optando por assumir novos custos, ainda dependemos de algu√©m dedicando um bom tempo para a implementa√ß√£o da funcionalidade;
> 3. √â importante ter um sistema de busca integrado ao TabNews que ajude aos usu√°rios e nos permita algum controle sobre seu funcionamento.
> 4. Talvez mais dif√≠cil do que implementar, seja gerenciar todas as possibilidades de indexa√ß√£o para que o sistema realmente ajude aos usu√°rios a encontrar o que procuram.
> 5. A melhor maneira de pesquisar conte√∫dos no TabNews atualmente √© usando o Google. O que est√° longe do ideal, j√° que envolve a exibi√ß√£o de an√∫ncios, pode levar os usu√°rios para outros sites, e n√£o nos fornece dados mais precisos sobre quem queria encontrar algo especificamente no TabNews.
> 6. As pesquisas pelo TabNews no Google ajudam a melhorar o nosso SEO, o que atrai mais visualiza√ß√µes para os nossos conte√∫dos, mesmo de usu√°rios que n√£o estavam pesquisando diretamente pelo termo TabNews.
> 7. Sempre vamos precisar dedicar esfor√ßos para mante um bom desempenho em SEO.
> 8. O tempo e conhecimento dedicado para gerenciar o sistema de buscas pr√≥prio pode trazer melhores resultados ser for direcionado para melhorar o SEO.
> 9. O Google fornece algumas maneiras de integrar o seu sistema de busca ao TabNews, mas, como qualquer outra op√ß√£o, envolve custos ou a exibi√ß√£o de an√∫ncios.
> 10. N√£o temos como saber se vale a pena usar a vers√£o sem an√∫ncios do pr√≥prio Google (ou de qualquer outro servi√ßo) ou se vale mais a pena ter um servidor pr√≥prio, pois n√£o temos no√ß√£o de qual seria o volume de utiliza√ß√£o, o que implica que primeiro precisamos ter algum sistema de busca que nos forne√ßa bons dados sobre a sua utiliza√ß√£o.
> 11. Fornecer uma forma de pesquisar diretamente no banco de dados do TabNews provavelmente n√£o seria perform√°tico (podendo prejudicar a experi√™ncia em outras funcionalidades), e provavelmente n√£o traria bons resultados para a maioria dos usu√°rios que n√£o soubessem usar bem a ferramenta. Por isso essa funcionalidade, se implementada, teria que primeiramente ser colocada em teste apenas para uma parte dos usu√°rios.
> 
> Ent√£o eu gostaria de saber:
> 
> **Enquanto ningu√©m implementa algum sistema mais robusto que possa ser disponibilizado de maneira geral, voc√™s acham que j√° ajudaria aos usu√°rios se integrarmos o sistema do Google, mesmo mantendo os an√∫ncios?**
> 
> ![image](https://user-images.githubusercontent.com/77860630/249534398-02d55a95-0c33-4303-b944-3b0fe2d0098d.png)
> 
> Eu acredito que j√° ajudaria alguns usu√°rios, mas o principal √© que ter√≠amos dados sobre a utiliza√ß√£o para avaliar se vale a pena implementar algo pr√≥prio, se vale manter os an√∫ncios do Google (que podem at√© trazer alguma receita) ou se vale a pena pagar para o Google para remover os an√∫ncios, o que √© pouco prov√°vel, j√° que custa $5 a cada 1.000 pesquisas.

Como pode ver os exemplos do [Typesense](https://typesense.org/) em outro t√≥pico que eu abri, ele consegue pesquisar em mais de 32 milh√µes de dados e ele faz isso em quest√£o de segundos, tudo que ele faz √© consulta nos dados que foi fornecido do arquivo .json.

Em quest√£o do SEO, isso com [Sitelinks search box](https://developers.google.com/search/docs/appearance/structured-data/sitelinks-searchbox) √© poss√≠vel fazer um bom SEO, algo como /search={query} e o pr√≥prio Google pode substituir o {query} pela palavra que foi buscada e iria fazer muito mais pessoas.

Tudo que o Typesense faz √© abrir uma posta e ent√£o voc√™ pode adicionar "documentos" e ele vai indexar esses dados, depois √© tudo mais simples, basta fazer uma na "API" do Typesense e pronto, ele retorna e com ele √© poss√≠vel buscar posts relevantes etc...

>> Coment√°rio de mpedroni:
> > Considerando que:
> > 
> > 1. Uma implementa√ß√£o bem feita de um sistema de buscas pr√≥prio vai envolver novos custos ou a exibi√ß√£o de an√∫ncios;
> > 2. Mesmo optando por assumir novos custos, ainda dependemos de algu√©m dedicando um bom tempo para a implementa√ß√£o da funcionalidade;
> > 3. √â importante ter um sistema de busca integrado ao TabNews que ajude aos usu√°rios e nos permita algum controle sobre seu funcionamento.
> > 4. Talvez mais dif√≠cil do que implementar, seja gerenciar todas as possibilidades de indexa√ß√£o para que o sistema realmente ajude aos usu√°rios a encontrar o que procuram.
> > 5. A melhor maneira de pesquisar conte√∫dos no TabNews atualmente √© usando o Google. O que est√° longe do ideal, j√° que envolve a exibi√ß√£o de an√∫ncios, pode levar os usu√°rios para outros sites, e n√£o nos fornece dados mais precisos sobre quem queria encontrar algo especificamente no TabNews.
> > 6. As pesquisas pelo TabNews no Google ajudam a melhorar o nosso SEO, o que atrai mais visualiza√ß√µes para os nossos conte√∫dos, mesmo de usu√°rios que n√£o estavam pesquisando diretamente pelo termo TabNews.
> > 7. Sempre vamos precisar dedicar esfor√ßos para mante um bom desempenho em SEO.
> > 8. O tempo e conhecimento dedicado para gerenciar o sistema de buscas pr√≥prio pode trazer melhores resultados ser for direcionado para melhorar o SEO.
> > 9. O Google fornece algumas maneiras de integrar o seu sistema de busca ao TabNews, mas, como qualquer outra op√ß√£o, envolve custos ou a exibi√ß√£o de an√∫ncios.
> > 10. N√£o temos como saber se vale a pena usar a vers√£o sem an√∫ncios do pr√≥prio Google (ou de qualquer outro servi√ßo) ou se vale mais a pena ter um servidor pr√≥prio, pois n√£o temos no√ß√£o de qual seria o volume de utiliza√ß√£o, o que implica que primeiro precisamos ter algum sistema de busca que nos forne√ßa bons dados sobre a sua utiliza√ß√£o.
> > 11. Fornecer uma forma de pesquisar diretamente no banco de dados do TabNews provavelmente n√£o seria perform√°tico (podendo prejudicar a experi√™ncia em outras funcionalidades), e provavelmente n√£o traria bons resultados para a maioria dos usu√°rios que n√£o soubessem usar bem a ferramenta. Por isso essa funcionalidade, se implementada, teria que primeiramente ser colocada em teste apenas para uma parte dos usu√°rios.
> > 
> > Ent√£o eu gostaria de saber:
> > **Enquanto ningu√©m implementa algum sistema mais robusto que possa ser disponibilizado de maneira geral, voc√™s acham que j√° ajudaria aos usu√°rios se integrarmos o sistema do Google, mesmo mantendo os an√∫ncios?**
> > ![image](https://user-images.githubusercontent.com/77860630/249534398-02d55a95-0c33-4303-b944-3b0fe2d0098d.png)
> > Eu acredito que j√° ajudaria alguns usu√°rios, mas o principal √© que ter√≠amos dados sobre a utiliza√ß√£o para avaliar se vale a pena implementar algo pr√≥prio, se vale manter os an√∫ncios do Google (que podem at√© trazer alguma receita) ou se vale a pena pagar para o Google para remover os an√∫ncios, o que √© pouco prov√°vel, j√° que custa $5 a cada 1.000 pesquisas.
> 
> Como pode ver os exemplos do [Typesense](https://typesense.org/) em outro t√≥pico que eu abri, ele consegue pesquisar em mais de 32 milh√µes de dados e ele faz isso em quest√£o de segundos, tudo que ele faz √© consulta nos dados que foi fornecido do arquivo .json.
> 
> Em quest√£o do SEO, isso com [Sitelinks search box](https://developers.google.com/search/docs/appearance/structured-data/sitelinks-searchbox) √© poss√≠vel fazer um bom SEO, algo como /search={query} e o pr√≥prio Google pode substituir o {query} pela palavra que foi buscada e iria fazer muito mais pessoas.
> 
> Tudo que o Typesense faz √© abrir uma posta e ent√£o voc√™ pode adicionar "documentos" e ele vai indexar esses dados, depois √© tudo mais simples, basta fazer uma na "API" do Typesense e pronto, ele retorna e com ele √© poss√≠vel buscar posts relevantes etc...

O problema de usar o Meilisearch/Typesense √© que existem custos envolvidos na manuten√ß√£o, n√£o √© a toa que o que gera renda pra eles √© o servi√ßo gerenciado (a ferramenta em si √© open source e √© poss√≠vel rodar por conta pr√≥pria uma inst√¢ncia). A√≠ entra a quest√£o: utilizar a ferramenta como um servi√ßo gerenciado (que tem um custo e n√£o √© barato) OU rodar uma inst√¢ncia em uma m√°quina pr√≥pria em algum cloud provider? Ambos os casos tem custos envolvidos, n√£o s√≥ pra pagar a ferramenta em si (seja gerenciado ou rodando em uma m√°quina na AWS, por exemplo, que custa dinheiro) mas para manter isso funcionando (caso d√™ alguma problema) e para manter os dados sincronizados entre as bases de dados do Tabnews e da ferramenta (pensa que a cada novo post, coment√°rio, like ou edi√ß√£o a gente teria que atualizar a base de dados da ferramenta).

>> Coment√°rio de aprendendofelipe:
Enquanto ningu√©m implementa algo melhor, voc√™s acham que compensa inserir a barra do Google no header?

Serviria para ajudar no m√≠nimo quem n√£o se deu conta de que poderia pesquisar diretamente no Google?

Serviria para fornecer alguma estat√≠stica para nos basear na hora de implementar o nosso sistema pr√≥prio?

>> Coment√°rio de mthmcalixto:
@mpedroni N√£o precisa atualizar com novos dados, existe mais ou menos uns 10k de posts, s√≥ inserir esses 10k e depois em tempo em tempo atualizar, cada 1k de posts, 2k de posts e atualizar. Tudo que precisa √© ter s√≥ o t√≠tulo, n√£o precisa talvez criar um sistema completo de busca, mas algo simples e r√°pido.

@aprendendofelipe por ser algo que exista em todo site, as pessoas talvez nem sabe que pode buscar no google usando "site:"

Sim, ser√° interessante ter estat√≠sticas para essa implementa√ß√£o.

>> Coment√°rio de mpedroni:
> @mpedroni N√£o precisa atualizar com novos dados, existe mais ou menos uns 10k de posts, s√≥ inserir esses 10k e depois em tempo em tempo atualizar, cada 1k de posts, 2k de posts e atualizar. Tudo que precisa √© ter s√≥ o t√≠tulo, n√£o precisa talvez criar um sistema completo de busca, mas algo simples e r√°pido.
> 
> @aprendendofelipe por ser algo que exista em todo site, as pessoas talvez nem sabe que pode buscar no google usando "site:"
> 
> Sim, ser√° interessante ter estat√≠sticas para essa implementa√ß√£o.

entendo, mas a√≠ acho que usar uma ferramenta de busca n√£o faria mais tanto sentido se n√£o for pra ter os dados atualizados. Independente da frequ√™ncia que os dados forem envidados e do qu√£o consistente as bases ser√£o entre si, isso ainda geraria custo n√©

>> Coment√°rio de mpedroni:
> Enquanto ningu√©m implementa algo melhor, voc√™s acham que compensa inserir a barra do Google no header?
> 
> Serviria para ajudar no m√≠nimo quem n√£o se deu conta de que poderia pesquisar diretamente no Google?
> 
> Serviria para fornecer alguma estat√≠stica para nos basear na hora de implementar o nosso sistema pr√≥prio?

eu acho que √© uma boa sim... nem que seja um redirect pra uma pesquisa do Google com o tempo pesquisado e filtrando apenas os resultados do Tabnews. Na minha opini√£o, o problema de usar o Google √© o usu√°rio ter que sair do Tabnews pra pesquisar algo... se for poss√≠vel utilizar a pesquisa do Google sem tirar o usu√°rio de dentro do Tabnews, pra mim √© uma excelente solu√ß√£o para o problema.

De fato um ponto importante a ser levado em considera√ß√£o √© como obter dados disso para ter no√ß√£o do uso e do impacto que a feature vai gerar. Eu n√£o sei se essa barra do Google que tu falou fornece algum tipo de estat√≠stica √∫til pra validar isso (na vers√£o gratuita pelo menos kkk), mas isso √© algo que pode ser contornado com uma pesquisa de satisfa√ß√£o simples.

Acredito que, pra esse primeiro momento, a solu√ß√£o ideal para isso seria sim incluir a pesquisa do Google na plataforma e, caso isso n√£o forne√ßa os dados necess√°rios para avaliar se √© uma solu√ß√£o boa o suficiente, planejar e rodar uma pesquisa de satisfa√ß√£o pr√≥pria com os usu√°rios (talvez valha a pena rodar essa pesquisa independentemente dos dados gerados pela pesquisa do Google).

Isso gera outro problema: planejar e rodar a pesquisa de satisfa√ß√£o kkkk. Sinceramente, n√£o vejo que seja algo muito complexo implementar essa pesquisa de satisfa√ß√£o, e acredito ser a solu√ß√£o com melhor custo/benef√≠cio pra termos uma ideia de pra onde devemos seguir.

O que voc√™s acham?

>> Coment√°rio de aprendendofelipe:
> N√£o precisa atualizar com novos dados

Precisa atualizar!

A frequ√™ncia at√© pode ser debatida, caso a sincroniza√ß√£o n√£o v√° ser em tempo real, mas precisa ser tudo automatizado.

> n√£o precisa talvez criar um sistema completo de busca, mas algo simples e r√°pido.

Acho que o crit√©rio deve ser uma boa UX. N√£o compensa ter um sistema de busca s√≥ por ter.

----------------

> o problema de usar o Google √© o usu√°rio ter que sair do Tabnews pra pesquisar algo... se for poss√≠vel utilizar a pesquisa do Google sem tirar o usu√°rio de dentro do Tabnews, pra mim √© uma excelente solu√ß√£o para o problema.

Essa barra √© inserida via JavaScript no pr√≥prio site. N√£o precisaria sair do TabNews.

Outra coisa que acho interessante √© que testei uma configura√ß√£o em que aparecem resultados tanto do pr√≥prio TabNews, como aqui do reposit√≥rio. E gostei bastante dessa op√ß√£o.

> De fato um ponto importante a ser levado em considera√ß√£o √© como obter dados disso para ter no√ß√£o do uso e do impacto que a feature vai gerar. Eu n√£o sei se essa barra do Google que tu falou fornece algum tipo de estat√≠stica √∫til pra validar isso (na vers√£o gratuita pelo menos kkk), mas isso √© algo que pode ser contornado com uma pesquisa de satisfa√ß√£o simples.

O Google fornece as estat√≠sticas do servi√ßo Pesquisa Program√°vel.

> planejar e rodar uma pesquisa de satisfa√ß√£o pr√≥pria com os usu√°rios 

Seria muito interessante se for feita por algu√©m de UX üëç

>> Coment√°rio de mpedroni:
@aprendendofelipe concordo com todos os pontos que tu colocou na resposta acima desta üëçüèª 

Sobre a pesquisa, de fato precisar√≠amos de uma pessoa de UX pra conseguir ser mais assertiva e gerar valor com a pesquisa. N√£o acho que seja dif√≠cil encontrar algu√©m disposto a ajudar (talvez caiba at√© um post no Tabnews sobre isso e ver se tem algu√©m interessado ou que conhe√ßa algu√©m que pode se interessar, j√° que acredito que a maioria dos usu√°rios s√£o devs).

Tu achas que s√≥ com as estat√≠sticas que a Pesquisa Program√°vel fornece √© poss√≠vel a gente responder, al√©m de quest√µes do tipo "quantos usu√°rios est√£o usando a ferramenta de busca", "termos mais pesquisados",  perguntas como: os resultados apresentados s√£o relevantes? O usu√°rio conseguiu encontrar o que procurava? Se n√£o encontrou, foi porque ainda n√£o existe post sobre o tema ou o post n√£o foi recomendado para o usu√°rio? √â f√°cil e pr√°tico utilizar esse m√©todo de pesquisa?

>> Coment√°rio de aprendendofelipe:
As estat√≠sticas que ter√≠amos seriam apenas para basear a decis√£o se vale a pena gerenciar por nossa conta ou contratar um servi√ßo de busca e, nesse caso, qual servi√ßo seria mais adequado de acordo com o volume de utiliza√ß√£o.

>> Coment√°rio de mthmcalixto:
@aprendendofelipe Sei que existe uma complexidade para fazer o sistema de busca mas acredito que n√£o seja imposs√≠vel e a pr√≥pria comunidade iria ajudar com isso, mas como pode ver esses testes feitos pela Typesense ([Typesense Benchmarks](https://typesense.org/docs/overview/benchmarks.html)) , est√£o mexendo com milh√µes de dados e v√°rias consultas de pesquisa simult√¢neas.

TabNews n√£o tem tantos posts assim, com isso eu acredito que o custo para manter um servidor de Typesense rodando em uma m√°quina n√£o ser√° t√£o custoso como achamos que ser√°... Dever√≠amos apenas discutir como iria atualizar os dados dele.

Ao usar o Google tamb√©m teremos uma "busca" sem atualiza√ß√£o, o Google n√£o vai indexar ao mesmo tempo que √© criado um post, est√° agora discutindo em criar um sistema de feedback e isso saiu fora do assunto do t√≥pico, que ser√° a cria√ß√£o do sistema de busca.

Usando o Typesense tudo que precisaremos inicialmente √© rodar ele em uma porta, indexar dados nele e fazer uma barra de busca no site chamando essa url que ele est√° rodando, nada mais. N√£o iria mexer em quase nada no c√≥digo do TabNews, poderia reaproveitar componentes j√° feito.

Dei uma olhada e o Typesense consegue atualizar um dado, criar um novo dado:

[Indexar um √∫nico documento](https://typesense.org/docs/0.24.1/api/documents.html#index-a-single-document)
[Upsert um √∫nico documento](https://typesense.org/docs/0.24.1/api/documents.html#upsert-a-single-document)

Com essas duas formas √© poss√≠vel adicionar ao banco de dados e ao mesmo tempo adicionar na busca.

>> Coment√°rio de aprendendofelipe:
Oi @mthmcalixto, n√£o precisa de permiss√£o pr√©via para propor qualquer solu√ß√£o. ü§ù

Se quiser implementar, no pior dos casos voc√™ ir√° aprender alguma coisa nova. J√° no melhor dos casos, n√≥s teremos um sistema de busca pr√≥prio para o TabNews üëç

Manda ver! üí™

>> Coment√°rio de mthmcalixto:
> Oi @mthmcalixto, n√£o precisa de permiss√£o pr√©via para propor qualquer solu√ß√£o. ü§ù
> 
> Se quiser implementar, no pior dos casos voc√™ ir√° aprender alguma coisa nova. J√° no melhor dos casos, n√≥s teremos um sistema de busca pr√≥prio para o TabNews üëç
> 
> Manda ver! üí™

@aprendendofelipe Fiz alguns testes para demostrar que √© poss√≠vel e pode ser aprimorado se implementado.

https://youtu.be/UXFmMKRUmAw

Como pode olhar, tudo acontece em tempo real, como as consultas j√° est√£o gravadas, foram indexadas. Tudo √© mais r√°pido e como eu disse acima, podemos usar [Indexar um √∫nico documento](https://typesense.org/docs/0.24.1/api/documents.html#index-a-single-document) sempre que precisar adicionar um novo post na busca e isso vai ocorrer em tempo real, tamb√©m podemos [Upsert um √∫nico documento](https://typesense.org/docs/0.24.1/api/documents.html#upsert-a-single-document) para adicionar se aquele post √© relevante ou n√£o e colocar ele em "pesquisas quentes" vamos assim dizer.

O melhor √© que mexeu apenas nos arquivos header, claro que precisa criar uma p√°gina "pesquisa" mas isso √© a a√ß√£o depois da busca, tamb√©m n√£o foi configurado API, ap√≥s deixar o servidor do Typesense rodando, basta passar as informa√ß√µes dele e ele faz o resto usando um adaptador que eles mesmo fizeram para react.

Nesse exemplo meio que n√£o iria existir a p√°gina "pesquisa" passando "=query", mas podemos tamb√©m ao digitar ali aparecer os t√≥picos no lugar do conte√∫do em tempo real.

Tamb√©m j√° pensando em tags, achei interessante> https://github.com/filipedeschamps/tabnews.com.br/issues/1373#issuecomment-1519288852

>> Coment√°rio de aprendendofelipe:
Turma, se puderem, deem uma opinada sobre como ficou o resultado do PR #1472 

https://tabnews-git-searchbox-tabnews.vercel.app/

>> Coment√°rio de aprendendofelipe:
Turma, considerando que o que foi implementado no PR #1472 (e #1475) est√° nos atendendo bem para a demanda atual (m√©dia de 300 pesquisas di√°rias), acredito que podemos dar essa issue como encerrada.

Acredito que futuramente haver√° demanda de novas funcionalidades relacionadas, ent√£o o assunto pode voltar quando for necess√°rio.

Muito obrigado aos que contribu√≠ram com a discuss√£o. üí™
</issue_927_Barra de busca>

<issue_928_Implementar protocolo ActivityPub>
Seria interessante que a gente pudesse implementar o protocolo ActivityPub sendo compat√≠vel com diversas outras redes sociais federadas como inst√¢ncias do Mastodon.

https://github.com/BasixKOR/awesome-activitypub

https://activitypub.rocks/

https://codeberg.org/fediverse/delightful-fediverse-apps
</issue_928_Implementar protocolo ActivityPub>

<issue_930_Confetes üéä (anima√ß√£o)>
No meu Linux (Mint) ap√≥s publicar, os confetes s√£o liberados lentamente. Enquanto no meu Android (11) os confetes rodam normalmente, sem "lag".

[Issue, j√° existe? I am sorry].

>> Coment√°rio de lucasalberto01:
Eu estou utilizando o pop_os e os confetes est√£o indo normalmente :thinking:

>> Coment√°rio de Jeiel0rbit:
> Eu estou utilizando o pop_os e os confetes est√£o indo normalmente :thinking: 

Seu √© Linux (Mint) tamb√©m? Fa√ßa um favor de especificar o sistema operacional.

>> Coment√°rio de Rafatcb:
Tenho um notebook um pouco mais antigo, Windows 10, com i7 7500U, 8GB RAM e GeForce 940mx que quando eu usava, a anima√ß√£o n√£o era fluida tamb√©m, inclusive a de voto negativo. No meu notebook mais novo, n√£o lembro de ter visto ela travar alguma vez.

Acredito que seja um problema de performance mesmo, n√£o deveria travar, j√° que √© uma anima√ß√£o simples.

>> Coment√°rio de Joao620:
@Jetrom17 eu tenho um Linux mint 20.3 ~~eu acho~~, em um computador Phenom II (para ver se √© s√≥ uma quest√£o de performance mesmo). Mais tarde eu testo e respondo aqui

>> Coment√°rio de coffeeispower:
acredito que seja problema do driver de video, a lib provavelmente usa webgl pra renderizar as anima√ß√µes

>> Coment√°rio de Jeiel0rbit:
> acredito que seja problema do driver de video, a lib provavelmente usa webgl pra renderizar as anima√ß√µes

E tem solu√ß√£o?

>> Coment√°rio de Joao620:
@Jetrom17 √©, no meu linux mint 20.03, rodando num phenom ii, firefox 106, n√£o teve problema nenhum com a anima√ß√£o. Entra [aqui](http://alampros.github.io/react-confetti/) que √© uma demonstra√ß√£o do react-confetti, a lib usada para isso e v√™ se tem problemas grandes de performance.

E @coffee-is-power, pelas minhas pesquisa a lib n√£o usa webgl n√£o, fazendo um profile rapidinho eu vi muito uso das fun√ß√£o de _fill_ e _draw_ do canvas, e o meu computador tem problemas de driver e roda webgl com glitch. Mas talvez tenha uma fun√ß√£o no c√≥digo com isso que eu n√£o tenha visto

>> Coment√°rio de Jeiel0rbit:
> @Jetrom17 √©, no meu linux mint 20.03, rodando num phenom ii, firefox 106, n√£o teve problema nenhum com a anima√ß√£o. Entra [aqui](http://alampros.github.io/react-confetti/) que √© uma demonstra√ß√£o do react-confetti, a lib usada para isso e v√™ se tem problemas grandes de performance.
> 
> E @coffee-is-power, pelas minhas pesquisa a lib n√£o usa webgl n√£o, fazendo um profile rapidinho eu vi muito uso das fun√ß√£o de _fill_ e _draw_ do canvas, e o meu computador tem problemas de driver e roda webgl com glitch. Mas talvez tenha uma fun√ß√£o no c√≥digo com isso que eu n√£o tenha visto

Ok, irei conferir. Darei retorno em breve mencionando novamente.
</issue_930_Confetes üéä (anima√ß√£o)>

<issue_931_Google Search est√° reclamando de textos pequenos na vers√£o Mobile>
N√£o sei se a instabilidade teve alguma coisa a ver com essa mensagem, mas acho melhor registrarmos aqui para investigarmos depois:

<img width="629" alt="image" src="https://user-images.githubusercontent.com/4248081/203658171-a6335824-5546-4cf5-bcc4-be9be9b25362.png">

Especulo que aquela home tempor√°ria quando tirei o site do ar possa ter causado isso.

Em paralelo, a quantidade de buscas vindas do Google teve um pico bastante alto nos √∫ltimos dias (gr√°fico de 6 meses):

<img width="1444" alt="image" src="https://user-images.githubusercontent.com/4248081/203658552-2905238f-c98c-4316-b817-0d355dc5483d.png">

>> Coment√°rio de filipedeschamps:
N√£o reclamou mais ü§ù
</issue_931_Google Search est√° reclamando de textos pequenos na vers√£o Mobile>

<issue_932_[question] : O Tabnews tem um discord ou um grupo no telegram ?>
Eu procurei para ver se o @filipedeschamps tinha algum server no discord mas n√£o encontrei nenhum link :cry: 

Acham interessante criar um grupo no telegram ou um server no discord para discutir coisas do tabnews e poder ficar em call ?

>> Coment√°rio de thisiscleverson:
A comunidade criou um grupo no discord.
Segue o link: https://www.tabnews.com.br/caiodomingues/recebendo-noticias-diretamente-no-discord

>> Coment√°rio de lucasalberto01:
Eu vi a publica√ß√£o mas parece ser somente um bot no discord :c N√£o tem nenhum server do discord nos coment√°rios ou no post

>> Coment√°rio de gabrielsozinho:
Acho que ele confundiu os links, mas aqui est√°: https://www.tabnews.com.br/Ezequias/junte-se-a-nossa-comunidade-no-discord üòÅüëçüèª

>> Coment√°rio de coffeeispower:
Sinceramente uma comunidade do tabnws nao faz sentido porque o tabnews j√° √© lugar de conversar, √© uma comunidade gerando valor.

>> Coment√°rio de Rafatcb:
Para discuss√µes de desenvolvimento, sugest√µes e bugs me parece que o melhor lugar √© o GitHub, para ficar com o hist√≥rico e facilitar a busca e refer√™ncias por meio do n√∫mero da issue/PR. Lembrando que problemas de seguran√ßa devem ser enviados para o e-mail `contato@tabnews.com.br`, de forma privada.

Agora, discord ou outra comunidade para outros tipos de conversa, realmente n√£o tem nada oficial, mas alguns membros da comunidade chegaram a criar canais assim (como j√° mencionado acima). Isso pode ser pesquisado pela pr√≥pria busca do www.tabnews.com.br.

@aprendendofelipe acho que podemos fechar essa issue.
</issue_932_[question] : O Tabnews tem um discord ou um grupo no telegram ?>

<issue_934_üë£ Imagens Tabnews>
Estaria nos planos de Tabnews?

![Screenshot_20221123-214801.png](https://user-images.githubusercontent.com/72875404/203670434-4f0b7616-e592-4263-a0b8-eea2daa3176c.png)

Bots registraram fortemente o conte√∫do. Aquela quando voc√™ compartilha o link os metadados s√£o lidos. N√£o seria interessante ser registrado na aba de imagens em mecanismo de pesquisa conte√∫dos que cont√©m imagens?¬ø?¬ø?
</issue_934_üë£ Imagens Tabnews>

<issue_935_[FEATURE] Exibir total de visualiza√ß√µes do post>
Como usu√°rio gostaria de visualizar o total de visualiza√ß√µes do meu post para verificar o engajamento.

Fica a dica :D

>> Coment√°rio de Rafatcb:
Acho que podemos concentrar essa discuss√£o aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1115
O issue apontado √© mais novo, mas j√° tem alguns coment√°rios discutindo sobre. O que acha, @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb! üí™

@brendo10x, obrigado pela sugest√£o! üí™

Vou fechar essa issue para concentrarmos l√° na #1115. ü§ù
</issue_935_[FEATURE] Exibir total de visualiza√ß√µes do post>

<issue_936_suporte a express√µes matem√°ticas>
Existe algum plano para dar suporte a express√µes matem√°ticas?

O github d√° suporte, exemplo a seguir: $\theta_B^{2} = \frac{1}{e}$.

N√£o sei exatamente a biblioteca de renderiza√ß√£o utilizada no tabnews, mas existem op√ß√µes como [KaTex](https://github.com/KaTeX/KaTeX), e [MathJax](https://github.com/mathjax/MathJax) para javascript.

Acredito que o ByteMD tenha suporte, vide o [playground](https://bytemd.js.org/playground/) com a op√ß√£o `math` nos plugins.

Caso poucas publica√ß√µes utilizem este recurso, acredito que seja poss√≠vel o criador do conte√∫do selecionar alguma op√ß√£o "Habilitar KaTex" por exemplo, e enviar os arquivos de renderiza√ß√£o (css e javascript do KaTex) somente para as p√°ginas que utilizem esse recurso. 
Dessa forma n√£o √© necess√°rio enviar os arquivos em todas as p√°ginas, o que economizaria em tempo de loading.

Segue um [comparativo](https://www.intmath.com/cg5/katex-mathjax-comparison.php) entre a velocidade do KaTex e do MathJax.

>> Coment√°rio de aprendendofelipe:
@demetrius-mp, obrigado pela sugest√£o! üí™

Foi implementado em #1323
</issue_936_suporte a express√µes matem√°ticas>

<issue_937_[FEATURE] Possibilidade de marca√ß√£o / salvar posts interessantes para leitura posterior>
Como o t√≠tulo j√° diz, seria interessante adicionar um bot√£o / √≠cone para marcar um post para leitura posterior, ou para ficar salvo no meu perfil.

>> Coment√°rio de leocunhadev:
√â uma √≥tima sugest√£o, mas acredito ser duplicidade do Issue #645.

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_937_[FEATURE] Possibilidade de marca√ß√£o / salvar posts interessantes para leitura posterior>

<issue_938_[Feature] Link e √¢ncora para coment√°rios>
Disponibilizar um id de coment√°rio e uma √¢ncora com o mesmo para que possa citar mensagens colocando um link para a pessoa seguir diretamente para coment√°rio espec√≠fico.

Inicialmente o link seria feito manualmente, no futuro poderia ser feita a cita√ß√£o automaticamente com o todo ou partes da mensagem.

>> Coment√°rio de Rafatcb:
Voc√™ pode copiar o link do coment√°rio onde est√° o tempo em que ele foi publicado:

![Coment√°rio do TabNews](https://user-images.githubusercontent.com/26308880/203764783-53eff4e7-b662-4488-bba3-ac3aa53ce6a1.png)

E ao acessar o link, fica como se fosse uma publica√ß√£o raiz: https://www.tabnews.com.br/Jetrom/97ad2d5f-6ee4-4c40-895a-a288409355b0
</issue_938_[Feature] Link e √¢ncora para coment√°rios>

<issue_939_[Feature] Buscar imagens de usu√°rio do Gravatar>
Buscar a imagem de usu√°rio do [Gravatar](https://br.gravatar.com/) conforme o email cadastrado.

Poderiam ser utilizados os pacotes do npm para isso, por exemplo: [https://www.npmjs.com/package/gravatar](https://www.npmjs.com/package/gravatar) ou utilizar a pr√≥pria API diretamente.

>> Coment√°rio de coffeeispower:
O tabnews n√£o vai ter avatares, o Filipe deschamps j√° falou isso no tabnews

>> Coment√°rio de Jeiel0rbit:
@joaocabraldev interessante isso. Desconhecia sobre essa plataforma.

>> Coment√°rio de Rafatcb:
Isso precisa ser estudado um pouco melhor antes da decis√£o ser tomada. J√° vi alguns debates na Stack Exchange sobre os riscos de privacidade, por exemplo:

* [Is Gravatar a privacy risk? (2010)](https://meta.stackexchange.com/questions/44717/is-gravatar-a-privacy-risk)
* [Off-site avatar images are a privacy risk (2019)](https://meta.stackexchange.com/questions/328966/off-site-avatar-images-are-a-privacy-risk)

E o TabNews se preocupa tanto com a privacidade que n√£o faz uso de cookies de terceiros nem nada do tipo üëç

>> Coment√°rio de Jeiel0rbit:
> Isso precisa ser estudado um pouco melhor antes da decis√£o ser tomada. J√° vi alguns debates na Stack Exchange sobre os riscos de privacidade, por exemplo:
> 
> * [Is Gravatar a privacy risk? (2010)](https://meta.stackexchange.com/questions/44717/is-gravatar-a-privacy-risk)
> * [Off-site avatar images are a privacy risk (2019)](https://meta.stackexchange.com/questions/328966/off-site-avatar-images-are-a-privacy-risk)
> 
> E o TabNews se preocupa tanto com a privacidade que n√£o faz uso de cookies de terceiros nem nada do tipo üëç

Uma pena os v√≠deos do Filipe Deschamps ser no YouTube.

>> Coment√°rio de fabiosvm:
Que pena! N√£o consigo imaginar nenhuma quest√£o de seguran√ßa ou privacidade sobre o gravatar. S√≥ n√£o exigir que o usu√°rio TENHA um cadastro l√°, o site/app do TabNews apenas usaria o link do gravatar do usu√°rio se n√£o der 404. Inclusive apenas nos caso de falta de um imagem de avatar do pr√≥prio.

Lembrando como √© o link do Gravatar:

```
 "https://www.gravatar.com/avatar/" + md5(email)
```

Esse √© o meu: [https://www.gravatar.com/avatar/8a0f96138345dc870b03c1557c2c2569](https://www.gravatar.com/avatar/8a0f96138345dc870b03c1557c2c2569)
</issue_939_[Feature] Buscar imagens de usu√°rio do Gravatar>

<issue_940_[Feature] Acompanhar T√≥pico>
Digamos que tenha um t√≥pico levantado que ainda n√£o tenha respostas , mas que eu quero ficar por dentro do engajamento, por exemplo: algu√©m criou o t√≥pico "quero saber mais sobre x assunto", visto que eu tamb√©m tenho interesse, gostaria de acompanhar a evolu√ß√£o do t√≥pico.

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o. J√° foi dada algumas vezes, parece existir interesse da comunidade e faz sentido para mim.

Dito isso, creio que podemos concentrar a discuss√£o no issue https://github.com/filipedeschamps/tabnews.com.br/issues/523.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_940_[Feature] Acompanhar T√≥pico>

<issue_941_UX - Confus√£o sobre o que √© a "fonte" da publica√ß√£o>
Hoje reparei pela terceira vez que uma pessoa confundiu o significado de "fonte" ao criar uma publica√ß√£o, colocando um link para uma fonte do Google. Acho que podemos pensar em algo para deixar mais claro que √© a fonte da not√≠cia, a refer√™ncia, e n√£o uma fonte de tipografia.

![Publica√ß√£o com fonte para um link do Google Fonts](https://user-images.githubusercontent.com/26308880/203782609-eddbcdc6-d893-4509-a87d-b0b49d1a58b5.png)

Atualmente, nosso formul√°rio para criar uma publica√ß√£o est√° assim:

![Um campo para o t√≠tulo, um para o corpo e um para a fonte, sem orienta√ß√µes](https://user-images.githubusercontent.com/26308880/203802576-ab7af424-9072-45dd-9a88-0e406066072e.png)

>> Coment√°rio de coffeeispower:
complicado... portugues sendo portugues, em ingles tem source e font mas em portugues traduz para a mesma palavra, ent√£o confunde as pessoas.

>> Coment√°rio de lucasmiqueias:
Fonte Bibliogr√°fica, talvez esse seja um termo n√£o amb√≠guo que pode ser utilizado.
No pratenses, talvez possa ter (Exemplo: Wikipedia, Medium...)

OBS: O input de Fonte Bibliogr√°fica poderia ser dentro da √°rea de texto. Como ele est√° separado, acabamos acreditando (por quest√£o de acessibilidade) que √© um input necess√°rio.

>> Coment√°rio de ValadaresX:
Me confundi hoje escrevendo um post. Super valido ser mais descritivo.

>> Coment√°rio de aprendendofelipe:
Ser√° que complementar o `placeholder` ajudaria?

Talvez algo como:

`Fonte (opcional, exemplo: https://origem.site/noticia)`

>> Coment√°rio de aprendendofelipe:
Ou

`https://fonte.opcional.da/noticia`

>> Coment√°rio de Rafatcb:
> Ser√° que complementar o `placeholder` ajudaria?
> 
> Talvez algo como:
> 
> `Fonte (opcional, exemplo: https://origem.site/noticia)`

Parece uma boa ideia. Melhor do que o placeholder que temos hoje `Fonte (opcional)` e √© uma modifica√ß√£o simples.

>> Coment√°rio de Rafatcb:
Como comentei em https://github.com/filipedeschamps/tabnews.com.br/issues/1529#issuecomment-1847647347, recomendo quem for corrigir isso, dar uma olhada na documenta√ß√£o do [TextInput](https://primer.style/components/text-input) para ver como essa tela ficaria com labels, indicador de campo obrigat√≥rio, e placeholder de exemplo. O formul√°rio est√° aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/4e4d030cd4c0c2e240c96e5cfea16e43604aa223/pages/interface/components/Content/index.js#L444-L507

E lembra de ver como fica no coment√°rio tamb√©m, n√£o apenas na publica√ß√£o principal.
</issue_941_UX - Confus√£o sobre o que √© a "fonte" da publica√ß√£o>

<issue_942_RegEx para validar e-mail no campo de recupera√ß√£o de senha>
Aparentemente n√£o h√° um tratamento do input de recupera√ß√£o de senha. Testei com um texto simples, sem @ e fui encaminhado para a p√°gina que avisa que um e-mail foi enviado.

Parab√©ns pelo projeto!

>> Coment√°rio de Rafatcb:
N√£o √© recomendado usar RegEx para valida√ß√£o de e-mails porque √© algo extremamente complexo e pass√≠vel de erros, como mencionado aqui: [How can I validate an email address using a regular expression?](https://stackoverflow.com/questions/201323/how-can-i-validate-an-email-address-using-a-regular-expression)

Dito isso, acho que n√£o temos necessidade de validar o e-mail porque j√° existe um e-mail de confirma√ß√£o para verificar se este realmente existe. O que acho legal √© ter uma lista de poss√≠vel erros de digita√ß√£o para auxiliar o usu√°rio no cadastro/login, que j√° existe hoje:

https://github.com/filipedeschamps/tabnews.com.br/blob/af2788f427a3db54088f6da326b79b609a1670ac/pages/perfil/index.public.js#L261-L413

Inclusive, isso j√° est√° duplicado no projeto:

https://github.com/filipedeschamps/tabnews.com.br/blob/af2788f427a3db54088f6da326b79b609a1670ac/pages/cadastro/index.public.js#L213-L365

Ent√£o acho que podemos aproveitar para realizar esse `TODO` üëç. Pode ser feito um _hook_ para essa sugest√£o, e acho interessante mudar o nome da fun√ß√£o tamb√©m, porque lendo apenas ele, n√£o consegui entender o que a fun√ß√£o fazia.

PS: A alternativa de ser um m√≥dulo _open source_ tamb√©m √© interessante.

>> Coment√°rio de bertonni:
Entendi, mas essa verifica√ß√£o ocorre na hora de redefinir a senha tamb√©m? Porque, caso haja um erro de digita√ß√£o nesse campo, o usu√°rio vai receber uma mensagem de que o e-mail foi enviado, sendo que este e-mail nunca vai chegar, certo? Caso n√£o seja nenhuma das op√ß√µes listadas.

>> Coment√°rio de filipedeschamps:
Interessante, na verdade existe uma valida√ß√£o pelo Joi, que come√ßa aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/pages/api/v1/recovery/index.public.js#L22

Depois vem para c√°:

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/models/validator.js#L114

Nesse caso √© preciso entender se o Joi de fato est√° validando um `@` por conta da din√¢mica desse valor que o @Rafatcb apontou.

>> Coment√°rio de Rafatcb:
> Entendi, mas essa verifica√ß√£o ocorre na hora de redefinir a senha tamb√©m? Porque, caso haja um erro de digita√ß√£o nesse campo, o usu√°rio vai receber uma mensagem de que o e-mail foi enviado, sendo que este e-mail nunca vai chegar, certo? Caso n√£o seja nenhuma das op√ß√µes listadas.

Acabei de realizar o teste e, caso voc√™ informe um e-mail errado para recuperar a senha, aparece o erro:

> O "email" informado n√£o foi encontrado no sistema.

>> Coment√°rio de bertonni:
Massa. Muito obrigado pelas respostas. Eu havia sugerido uma RegEx porque o campo aceita um texto sem @, s√≥ quest√£o de UX mesmo =)

Parab√©ns mais uma vez pelo projeto. T√° massa

>> Coment√°rio de aprendendofelipe:
Fechando a issue, pois entendi que o assunto foi resolvido. üí™

Qualquer coisa √© s√≥ reabrir ü§ù
</issue_942_RegEx para validar e-mail no campo de recupera√ß√£o de senha>

<issue_943_Autocomplete salvando campo errado no primeiro cadastro com Chromium>
Quando cadastrei tabnews no browser Brave [Version 1.45.127 Chromium: 107.0.5304.110 (Official Build) (64-bit)](https://brave.com/latest/) pedi para salvar meu login/pass na ferramenta de credenciais do Chromium e quando fui usar no login percebi que usou meu username e n√£o meu email como precisava para logar, creio que podemos trocar para que o default salvo seja o correto, ou seja, o email.

>> Coment√°rio de GoulartNogueira:
N√£o √© problema do navegador.
No Firefox tamb√©m tive esse comportamento.

>> Coment√°rio de GoulartNogueira:
Eu *ACHO* que se mudar a odem dos campos no cadastro, resolve o problema.

Hoje est√°:

> Nome do Usu√°rio
> Email
> Senha

Minha hip√≥tese √© que o navegador armazena sempre o primeiro campo do formul√°rio.
Ent√£o minha sugest√£o √© colocar:

> Email
> Nome do Usu√°rio
> Senha


Algum dev front confirma minha hip√≥tese?

>> Coment√°rio de GoulartNogueira:
Se algum dev quiser contribuir com o projeto, pode testar essa hip√≥tese.
Se resolver, faz o pull request!

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb, a solu√ß√£o (#1584) j√° est√° rodando em produ√ß√£o! üöÄüöÄüöÄ
</issue_943_Autocomplete salvando campo errado no primeiro cadastro com Chromium>

<issue_944_Sugest√£o: Fixar um conte√∫do no perfil>
## A sua sugest√£o de funcionalidade est√° relacionada a algum problema? Por favor descreva.

Eu gostaria de criar v√°rios conte√∫dos sobre o mesmo tema e gostaria de criar um √∫nico post onde eu consiga centralizar todas as postagens, assim, existiria um acesso f√°cil aos conte√∫dos, mas atualmente essa funcionalidade n√£o est√° presente.

## Descreva a funcionalidade que gostaria.

Adicionar uma op√ß√£o de fixar um conte√∫do no perfil do usu√°rio, para que os usu√°rios que entrem em seu perfil consigam ver a publica√ß√£o em destaque.

## Descreva as alternativas que considerou.
Como citado em v√°rias outras issues como #891 e #807, outra solu√ß√£o seria separar os conte√∫dos entre postagens originais e coment√°rios.

>> Coment√°rio de Rafatcb:
Na √©poca em que essa sugest√£o foi feita, ainda n√£o existia a descri√ß√£o no perfil do usu√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/1466). Acho que essa funcionalidade deixou de fazer sentido, visto que agora voc√™ pode destacar o que quiser ali.

A discuss√£o de filtro de conte√∫do raiz e coment√°rio √© boa tamb√©m, mas ainda n√£o foi implementada, e como voc√™ disse, podemos concentrar a discuss√£o sobre isso no issue https://github.com/filipedeschamps/tabnews.com.br/issues/807.

Acredito que fa√ßa sentido fechar o issue agora.

>> Coment√°rio de aprendendofelipe:
@guilherssousa, obrigado pelas sugest√µes! üí™

Vamos seguir a recomenda√ß√£o do @Rafatcb! üëç

Vou fechar a issue ü§ù
</issue_944_Sugest√£o: Fixar um conte√∫do no perfil>

<issue_945_[Feature] Salvar/Favoritar Posts>
Um implementa√ß√£o interesante seria para salvar/favoritas os posts que gostamos para reaproveitar o conteudo em um outro momento e n√£o perdemos com o tanto de publica√ß√µes que ir√£o adentrar no site.

>> Coment√°rio de Tiago321123:
sim, √© o que mais quero!!

>> Coment√°rio de ViniUme:
Eu tamb√©m, j√° achei posts que s√£o valiosos demais para perder

>> Coment√°rio de leocunhadev:
Primeira coisa que eu vi faltar, j√° perdi algumas coisas muito interessantes.

>> Coment√°rio de leocunhadev:
√â uma √≥tima sugest√£o, mas acredito ser duplicidade do Issue #645.

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_945_[Feature] Salvar/Favoritar Posts>

<issue_948_[UX] Troca de nome de usu√°rios um pouco confusa>
- Criei minha conta utilizando o username 'GuilhermeAis';
- Quis trocar o username para 'guilhermeias';
- Recebi o erro dizendo que j√° existe esse username.

Por mais que haja a diferen√ßa de CamelCase pra lowercase, esse comportamento √© o esperado?

### Detalhes da requisi√ß√£o:
response: 
![image](https://user-images.githubusercontent.com/73388069/203822524-cc715f05-dd72-4650-ba40-dd0c8eb9a98b.png)

headers:
![image](https://user-images.githubusercontent.com/73388069/203822556-cef456be-66f2-4c8a-9b63-c76e26ca17b8.png)

>> Coment√°rio de Rafatcb:
Acredito que o nome de usu√°rio seja considerado o mesmo porque a URL n√£o diferencia o _case_ do texto, ent√£o a p√°gina gerada para cada usu√°rio `https://tabnews.com.br/usuario` seria a mesma coisa para `GuilhermeAis` e `guilhermeias`, logo, n√£o poderia ter dois usu√°rios diferentes com esses nomes.

Apesar disso, como o nome do usu√°rio √© exibido em outros lugares de acordo com o _case_ salvo, acredito que deveria ser poss√≠vel sim mudar o nome para um _case_ diferente.

Existe um teste que confirma o comportamento atual, mas acho que poder√≠amos mudar isso:

https://github.com/filipedeschamps/tabnews.com.br/blob/af2788f427a3db54088f6da326b79b609a1670ac/tests/integration/api/v1/users/%5Busername%5D/patch.test.js#L185-L215

>> Coment√°rio de guilhermeais:
Sim, eu dei uma olhada nesse teste e vi que tamb√©m:

No c√≥digo, o username que vem da query string, parece que respeita o camelCase, da uma olhada:
`pages/api/v1/users/[username]:62`
![image](https://user-images.githubusercontent.com/73388069/203831575-7282486f-42ab-47a9-9a79-64695b5c1837.png)


Agora, tem uma valida√ß√£o do usu√°rio que ele padroniza para o o lowercase:
`models/user.js:458`
![image](https://user-images.githubusercontent.com/73388069/203831667-f67f9beb-188e-46eb-90d5-964426d3253e.png)


Igual voc√™ falou, como o nome √© exibido em outros lugares respeitando o case, talvez seria legal poder trocar

>> Coment√°rio de Rafatcb:
> No c√≥digo, o username que vem da query string, parece que respeita o camelCase

Me expressei mal. O c√≥digo diferencia sim, mas o navegador n√£o. Ent√£o ao acessar a p√°gina, voc√™ pode digitar o nome do seu usu√°rio como quiser ‚Äî foi isso o que eu quis dizer anteriormente.

>> Coment√°rio de guilhermeais:
> > No c√≥digo, o username que vem da query string, parece que respeita o camelCase
> 
> Me expressei mal. O c√≥digo diferencia sim, mas o navegador n√£o. Ent√£o ao acessar a p√°gina, voc√™ pode digitar o nome do seu usu√°rio como quiser ‚Äî foi isso o que eu quis dizer anteriormente.

Ah sim!! Agora entendi a sua resposta 100% 

Mas enfim... Por mais que seja um detalhe, eu preferiria poder mudar o username pra lowercase, haha! Talvez seja uma boa mudar a valida√ß√£o pra comparar tamb√©m o case que a string est√°.
Ser√° que vale a pena alterar e abrir um PR? ü§î

>> Coment√°rio de Lorenzobattistela:
Existe alguma maneira de a troca de nome de usu√°rio n√£o quebrar o URL? 

Por exemplo, se eu tiver uma conta com 20 publica√ß√µes e quiser trocar o usu√°rio, provavelmente n trocaria pra n quebrar os links de todas elas.

N√£o √© um problema grave, mas existe essa possibilidade?

>> Coment√°rio de filipexyz:
> Existe alguma maneira de a troca de nome de usu√°rio n√£o quebrar o URL?
> 
> Por exemplo, se eu tiver uma conta com 20 publica√ß√µes e quiser trocar o usu√°rio, provavelmente n trocaria pra n quebrar os links de todas elas.
> 
> N√£o √© um problema grave, mas existe essa possibilidade?

Ao meu ver isso √© um fato que quem quiser trocar de nome vai ter que lidar. Acontece em todos os lugares da internet.
O pr√≥prio GitHub j√° √© um grande exemplo... Trocou teu username, quebrou o link de tudo onde teus reposit√≥rios estavam configurados.
</issue_948_[UX] Troca de nome de usu√°rios um pouco confusa>

<issue_949_[Sugest√£o] Alterar fluxo de contribui√ß√£o, merge e deploy>
Agora, com o aumento de contribuidores e tamb√©m dos usu√°rios do TabNews, eu acho que vale a pena aquela estrat√©gia de termos uma *branch* intermedi√°ria. Principalmente para n√£o ficar invalidando o cache a todo momento no ambiente de produ√ß√£o.

Na verdade a intermedi√°ria at√© poderia ser a pr√≥pria `main` e a√≠ deixamos outra *branch* para produ√ß√£o.

A ideia seria criar uma *branch* `production` e deixar a `main` um pouco mais din√¢mica. Din√¢mica apenas no sentido de, na hora de aprovar e fazer *merge* dos PRs, n√£o precisar se preocupar se √© o melhor momento para fazer *deploy* em produ√ß√£o. N√£o digo que devemos relaxar com as revis√µes dos PRs.

Ent√£o a `main` dispararia apenas o *deploy* no ambiente de homologa√ß√£o, e quando for o melhor momento para o *deploy* em produ√ß√£o, fazemos o *merge* da `main` na `production` com as contribui√ß√µes acumuladas.

O que acham?

>> Coment√°rio de aprendendofelipe:
Isso tamb√©m ajudaria com as contribui√ß√µes que n√£o mudam nada no ambiente de produ√ß√£o, mas que iriam invalidar os caches ao serem aprovadas, como, por exemplo, as que s√≥ alteram a documenta√ß√£o.

>> Coment√°rio de Rafatcb:
Faz sentido para mim. Imagino que, num cen√°rio onde 3 PRs fossem mergeados quase que ao mesmo tempo (digamos que com um intervalo de cinco minutos entre cada um), seria melhor ter um lote de atualiza√ß√µes enviadas uma √∫nica vez, fazendo uso da branch `production`, certo?

Pergunto porque nunca usei o Next, ent√£o n√£o sei se entendi exatamente o que est√° acontecendo hoje.

>> Coment√°rio de aprendendofelipe:
> Faz sentido para mim. Imagino que, num cen√°rio onde 3 PRs fossem mergeados quase que ao mesmo tempo (digamos que com um intervalo de cinco minutos entre cada um), seria melhor ter um lote de atualiza√ß√µes enviadas uma √∫nica vez, fazendo uso da branch `production`, certo?

Isso mesmo @Rafatcb, os 3 merges iriam ocorrer na `main` e s√≥ depois seria feito o *merge* da `main` na `production`. Com isso os novos *commits* aprovados passariam todos de uma vez para a `production`, resultando em um √∫nico *deploy* no ambiente de produ√ß√£o na Vercel.

> Pergunto porque nunca usei o Next, ent√£o n√£o sei se entendi exatamente o que est√° acontecendo hoje.

N√£o tem rela√ß√£o com o Next.js em si, mas sim na maneira como fazemos *deploy* na Vercel.

>> Coment√°rio de coffeeispower:
Talvez era melhor renomear a main pra staging e criar a branch production. Fica mais claro o que cada coisa faz

>> Coment√°rio de aprendendofelipe:
> Talvez era melhor renomear a main pra staging e criar a branch production. Fica mais claro o que cada coisa faz

Oi @coffee-is-power, mudar o nome da *branch default* n√£o mudaria o fluxo, ent√£o poderia ser qualquer coisa que deixasse claro para os contribuidores que √© ali que eles devem clonar, criar o PR etc.

Mas n√£o acredito que `staging` deixaria isso mais claro do que `main`. Poderia ser outro nome, mas no momento n√£o estou vendo nenhum ganho em renomear a `main`. Tamb√©m n√£o criaria outra *branch* para configurar como *default* , pois acho que isso iria quebrar o hist√≥rico de contribui√ß√µes.

A minha proposta n√£o muda o que j√° estamos fazendo com a `main`, que √© s√≥ mergear o que j√° estiver totalmente testado e aprovado. S√≥ vai mudar que esse *merge* n√£o vai mais disparar um *deploy* no ambiente de produ√ß√£o. O deploy em produ√ß√£o s√≥ vai acontecer quando a `main` for mergeada na `production`.

Os testes devem continuar sendo realizados nas *branchs* originais dos contribuidores, onde, agora com a nova configura√ß√£o do reposit√≥rio, est√° mais f√°cil de testar e fazer *deploy* diretamente delas.

Faz sentido?

>> Coment√°rio de yuric18:
Tive conhecimento do projeto hoje, fiquei bem interessado nele e em contibuir com ele.

Por√©m, senti falta de um `CONTIBUTING.md` descrevendo qual o fluxo ideal para contribui√ß√£o e tamb√©m de templates para abertura de issues/features requests.

Pretendo abrir um merge essa semana adicionando esses templates para ajudar. 
De repente, segurar um pouco o CONTRIBUTING.md at√© que a defini√ß√£o desse issue seja feita üòÑ , o que acham?

>> Coment√°rio de cezarmezzalira:
@aprendendofelipe cai de paraquedas aqui, mas li todas as respostas e achei interessante o modelo de duas branchs: `main` para contribui√ß√£o e `production` para deploy em produ√ß√£o.

Isso vai de encontro com modelo [trunk-based](https://www.atlassian.com/continuous-delivery/continuous-integration/trunk-based-development) que a Atlassian sugere como melhor modelo atualmente para ambientes de CI/CD.

A ideia do modelo trunk-based √© que os existam commits apenas em uma √∫nica branch, incentivando commits pequenos, com cobertura de testes e que podem ser facilmente incorporados a branch main. Al√©m disso, √© sugerido o merge di√°rio dessa branch com a branch de produ√ß√£o, fazendo com que o c√≥digo que est√° no reposit√≥rio est√° como production ready a qualquer momento.

Em teoria, como o projeto j√° tem pipelines de teste automatizado e alta cobertura de de testes, seria um caminho f√°cil.

Vale a pena a leitura do artigo no link acima para entender mais detalhes.

O que me dizem?

>> Coment√°rio de aprendendofelipe:
> Pretendo abrir um merge essa semana adicionando esses templates para ajudar.
> De repente, segurar um pouco o CONTRIBUTING.md at√© que a defini√ß√£o desse issue seja feita üòÑ , o que acham?

@yuric18, nada impede de j√° criar o PR. Mas se acha melhor esperar a ideia estar melhor definida, √© o caminho que eu faria tamb√©m.

> Em teoria, como o projeto j√° tem pipelines de teste automatizado e alta cobertura de de testes, seria um caminho f√°cil.

@cezarmezzalira, infelizmente a boa cobertura de testes por enquanto √© s√≥ para a API.

Mas o modelo que temos hoje j√° est√° sim muito alinhado com o desenvolvimento baseado em troncos. Guardadas as particularidades por ser um projeto colaborativo.

Minha proposta de separar a `main` da `production` s√≥ aproxima um pouco mais desse modelo por permitir que mudan√ßas pontuais j√° aprovadas possam ir sendo mescladas sem preocupa√ß√£o se √© um bom momento para *deploy* em produ√ß√£o.

>> Coment√°rio de yuric18:
@aprendendofelipe

#1004 e #1005. Abri uma issue e um PR, marquei ele como WIP (tinha esquecido rsrs). A issue eu abri separada pra n√£o misturar os assuntos, pois j√° aproveitei pra colocar templates de Issue e PR.

>> Coment√°rio de cezarmezzalira:
> Minha proposta de separar a `main` da `production` s√≥ aproxima um pouco mais desse modelo por permitir que mudan√ßas pontuais j√° aprovadas possam ir sendo mescladas sem preocupa√ß√£o se √© um bom momento para _deploy_ em produ√ß√£o.

Nesse caso, pensando por outro lado, a ideia do Filipe √© sempre trabalhar por Milestone. 

Isso me faz pensar que o modelo [git-workflow](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow) tamb√©m seria interessante, haja visto que a branch `main` vai conter as releases e a branch principal seria a `development`, que seria base para novas branch's de trabalho e tamb√©m para uma branch intermediaria de `release`, que ap√≥s as devidas valida√ß√µes, acaba sendo mergeada tanto na `main` quanto na `development`. 

Por√©m, existe um trade off que o projeto entraria numa esp√©cie de freezing at√© a pr√≥xima `release` ser mergeada na `development`.

O que me dizem sobre essa outra abordagem?

>> Coment√°rio de aprendendofelipe:
Fechando essa issue porque a solu√ß√£o n√£o me parece mais fazer sentido com o volume atual de contribui√ß√µes
</issue_949_[Sugest√£o] Alterar fluxo de contribui√ß√£o, merge e deploy>

<issue_950_Tab - TabCoins>
Os "like" e "no like", os tabCoins continuam a funcionar para gastar na mesma p√°gina. N√£o era para ter um limite?

>> Coment√°rio de JonathanArgentao:
Se eu entendi bem sua pergunta, a resposta √©: voc√™ pode gastar quantas tabcoins quiser em uma mesma publica√ß√£o, at√© chegar a 1. N√£o tem limite para gastar na mesma publica√ß√£o.

>> Coment√°rio de Jeiel0rbit:
> Se eu entendi bem sua pergunta, a resposta √©: voc√™ pode gastar quantas tabcoins quiser em uma mesma publica√ß√£o, at√© chegar a 1. N√£o tem limite para gastar na mesma publica√ß√£o.

E n√£o deveria ter?

>> Coment√°rio de JonathanArgentao:
No projeto n√£o √© previsto ainda, por enquanto todos s√£o livres pra usar suas tabcoins como quiserem, mas se quiser sugerir essa mudan√ßa, com um bom argumento, acho que a comunidade poderia discutir.

>> Coment√°rio de Alexbrazdasilva:
N√£o, pois como as tabcoins s√£o "dif√≠ceis" de conseguir, cada usu√°rio dever√° regrar as suas coins.

Voc√™ recebe coins por ter feito um coment√°rio ou um post :arrow_right: Se o post ou coment√°rio de outro usu√°rio for relevante pra voc√™, voc√™ "gasta" suas coins pra valorizar

-- Essa √© a parte bacana, na minha opini√£o.

>> Coment√°rio de Jeiel0rbit:
@Alexbrazdasilva e @JonathanArgentao  publiquei essa discuss√£o aqui. Contribuem por favor. 

https://www.tabnews.com.br/Jetrom/tabnews-tabcoins-bonus

>> Coment√°rio de Jeiel0rbit:
![Screenshot_20221124-203355-898.png](https://user-images.githubusercontent.com/72875404/203874664-17716626-ae57-42ab-9419-0f42b8de1d55.png)

Como podes ver, estou tendo dificuldade para pontuar outros posts que quero, por sugerir limite de tabCoins.
</issue_950_Tab - TabCoins>

<issue_951_[UX/UI] - Melhoras para listagem de t√≥picos>
# Listagem de t√≥pico
![image](https://user-images.githubusercontent.com/65882994/203867063-6122aed3-e9c5-4593-b3cb-93f5ef97f46f.png)


# Muita Informa√ß√£o
A tela inicial est√° jogando muita coisa de uma vez para o usu√°rio olhar, o que poss√≠velmente o deixa com uma sensa√ß√£o de confus√£o, isso pode ser resolvido facilmente com uma margem maior separando cada t√≥pico.

# Ilustra√ß√£o
√â interessante permitir os criadores dos t√≥piucos colocarem uma ilustra√ß√£o no come√ßo de cada t√≥pico para que o usu√°rio n√£o precise ler t√≥pico por t√≥pico pra saber qual deles lhe interessa.

# Prot√≥tipo
Acredito que algo deste tipo j√° ficaria interessante:
![test](https://user-images.githubusercontent.com/65882994/203865695-8fa22e25-6197-40ea-9c83-1f012203fb9c.png)

# Outra ideia

Outra ideia seria se inspirar em listagem de outros sites populares que seguem esse estilo de blog, como o [Medium](https://medium.com/). Acho que essas linhas transparente pra separar cada t√≥pica deixa a tela bastante agrad√°vel.

>> Coment√°rio de coffeeispower:
Acho que uma thumb era melhor, 

O design que eu t√¥ pensando e que ele pega a thumb e coloca no fundo da listagem do conte√∫do, e quando VC passa o mouse ele revela a thumb inteira

E tamb√©m isso precisa ser controlado porque podem trollar e colocar p ou algo assim, tem sistemas que conseguem detectar isso, mas nada e perfeito. Tem que lembrar que o site e controlado pelos usu√°rios

>> Coment√°rio de Rafatcb:
N√£o acho que tenha muita informa√ß√£o. Na verdade, acho que o TabNews lida muito bem em mostrar apenas o essencial, dando um destaque para o t√≠tulo, o que facilita de ler apenas t√≠tulos em um _scan_ r√°pido no site.

Colocar imagens deixaria muito polu√≠do, com ainda mais coisas na tela e menos informa√ß√µes √∫teis. Como usu√°rio do site, eu entro para ver o que ainda n√£o vi, ent√£o quanto mais publica√ß√µes couberem na minha tela sem precisar dar scroll e com uma leitura f√°cil, melhor. Inclusive, o fato de diferenciar publica√ß√µes visitadas das n√£o visitadas contribui positivamente com meu desejo de _ver o que ainda n√£o vi_.

O TabNews √© inspirado no [Hacker News](https://news.ycombinator.com/).

>> Coment√°rio de brunoinds:
Quando entro no TabNews, quase que instantaneamente sinto a falta da thumb nos artigos. Sem imagens, d√° at√© pregui√ßa de abrir o artigo.  Imagens valem mais que mil palavras e √© a chave para que a primeira vista, chame a aten√ß√£o. √â extremamente essencial e creio que deveria ser uma prioridade no time de FrontEnd. Deve-se quanto antes implementar uma thumb pra os posts.

A implementa√ß√£o mais simples seria usar a primeira imagem adicionada no corpo do artigo. Um parse do Markdown e recuperar a primeira imagem para ser a thumbnail.

>> Coment√°rio de Rafatcb:
Como este issue n√£o teve intera√ß√µes para avan√ßar o assunto, estou fechando-o para organizar o reposit√≥rio. De forma geral, ser√° bem dif√≠cil realizar uma grande mudan√ßa na UI do TabNews porque cada pessoa ter√° um gosto, e a interface atual tem atendido bem o p√∫blico do site.

Agrade√ßo pela colabora√ß√£o dos que participaram neste issue. No momento atual do TabNews, os esfor√ßos est√£o direcionados para o Milestone 7 https://github.com/filipedeschamps/tabnews.com.br/issues/1490.
</issue_951_[UX/UI] - Melhoras para listagem de t√≥picos>

<issue_952_[Feature] Cadastro com google/github>
## Descri√ß√£o do problema

O TabNews ainda n√£o possui cadastro com essas plataformas. Creio que ficaria bem mais din√¢mico a entrada de novos usu√°rios se a plataforma possu√≠sse alguma forma de login que pudesse ser feita com um auth em alguma dessas plataformas.

>> Coment√°rio de vitucordeiro:
Google: Oauth2 para autentica√ß√£o para o uso da API do Google.

>> Coment√°rio de nicolasteofilo:
Realmente, √© bem prov√°vel  que quase todo dev tenha uma conta no GitHub, iria facilitar bastante mesmo

>> Coment√°rio de GoulartNogueira:
J√° solicitado aqui: #922 

Para organizar melhor, sugiro fechar esta issue aqui e centralizarmos a conversa por l√°.
(por simples quest√£o de cronologia)
</issue_952_[Feature] Cadastro com google/github>

<issue_953_[Feature] Login n√£o persiste>
Ap√≥s a realiza√ß√£o do login, j√° tive problemas algumas vezes ao abrir uma nova aba ou clicar em uma nova publica√ß√£o depois de alguns minutos.
</issue_953_[Feature] Login n√£o persiste>

<issue_954_[Feature] Acessibilidade - Tradutor virtual.>
## Descri√ß√£o do problema
Adi√ß√£o de um tradutor virtual dentro do TabNews pode ajudar o site a ser mais inclusiva com a comunidade surda.

## Sugest√£o de Solu√ß√£o
- N√£o sei dizer ainda se o pessoal consegue fazer algum tipo de parceria privada, mas de ferramentas que oferecem esse tipo de solu√ß√£o a melhor que existe hoje pra mim √© o plugin da [Hand Talk](https://www.handtalk.me/br/plugin/). 
- Caso parcerias como estas n√£o sejam poss√≠veis existe o [VLibras](https://www.gov.br/governodigital/pt-br/vlibras) que √© uma solu√ß√£o gratuita e feita pelo governo.

>> Coment√°rio de Rafatcb:
Acho que n√£o entendi direito. Por que o TabNews precisa fazer algo para ser mais inclusivo com a comunidade surda se todo conte√∫do do site √© em texto/imagem, n√£o existe v√≠deo nem √°udio (ao menos por enquanto)? O que seria "traduzido"?

>> Coment√°rio de avoguga:
> Acho que n√£o entendi direito. Por que o TabNews precisa fazer algo para ser mais inclusivo com a comunidade surda se todo conte√∫do do site √© em texto/imagem, n√£o existe v√≠deo nem √°udio (ao menos por enquanto)? O que seria "traduzido"?

Coe Rafa, seria traduzido o portugu√™s para libras. Hoje a maioria das pessoas surdas n√£o entendem muito bem o portugu√™s ou t√™m dificuldades para ler e escrever. Muita gente que usa Libras n√£o se alfabetizaram em l√≠ngua portuguesa e por isso, ocorre que elas passam a depender da L√≠ngua de Sinais para se comunicar e obter informa√ß√£o no geral t√° ligado?  √â dif√≠cil para muitos entender a estrutura gramatical da l√≠ngua portuguesa j√° esta √© muito diferente da estrutura gramatical de Libras e por isso existe esse incentivo para o uso de tradutores virtuais. √â uma quest√£o de inclus√£o mesmo. Ent√£o acho valido a galera pensar e refletir sobre alguma a√ß√£o a ser realizada sobre isso.

>> Coment√°rio de andreluizdacunha:
@avoguga, parab√©ns, falou tudo!
O surdo pr√©-lingu√≠stico, aquele que perdeu a audi√ß√£o antes de ser alfabetizado, tem muita dificuldade de entender o portugu√™s.
Libras √© uma l√≠ngua visual!
Seria muito bom mesmo buscarmos alternativas.
</issue_954_[Feature] Acessibilidade - Tradutor virtual.>

<issue_956_UX - P√°gina de redirecionamento ao logar>
Hoje vi no TabNews uma publica√ß√£o que, resumidamente, era um "oi", e isso estava escrito nela:

> Desculpa por esse primeiro post meio estranho, mas sinceramente estava meio indeciso sobre o que postar

Ao logar, a pessoa √© redirecionada para a p√°gina de [criar uma publica√ß√£o](https://www.tabnews.com.br/publicar). Talvez a pessoa do exemplo anterior tenha imaginado que **precisasse** publicar algo.

Pensei em duas alternativas para melhorar esse fluxo de login:

1. **A ideal:** redirecionar para a p√°gina que o usu√°rio estava antes de ir para o Login. O motivo: isso n√£o altera o fluxo que a pessoa j√° estava. Por exemplo, pode ser que ela estivesse lendo uma publica√ß√£o, quisesse dar um voto ou comentar algo, ent√£o ser√° redirecionada de volta para a publica√ß√£o. N√£o sei qu√£o complexo isso √©.
2. **A simples:** redirecionar para a _home_. O motivo: √© a p√°gina com os principais conte√∫dos do momento.

>> Coment√°rio de aprendendofelipe:
@Rafatcb voc√™ foi citado no post comemorativo üéâ

https://www.tabnews.com.br/FelipeBarso/tabnews-dark-mode-e-novas-funcionalidades-do-editor

Vou fechar a issue, ok? üëç
</issue_956_UX - P√°gina de redirecionamento ao logar>

<issue_957_Conta n√£o verificada pelo email n√£o foi descartada>
Eu fiz um cadastro com um email errado e ent√£o n√£o verifiquei a conta pelo email. 

Agora eu quero o username daquela conta, ent√£o eu criei uma conta de email com o endere√ßo que eu tinha colocado (aquele errado) e tentei recuperar a senha mas eu n√£o recebo o email de recupera√ß√£o e tamb√©m n√£o consigo usar o username.

(o endere√ßo errado aparece como uma conta na hora de solicitar nova senha)

>> Coment√°rio de Rafatcb:
Recentemente conheci a extens√£o [pg_cron](https://github.com/citusdata/pg_cron) para o PostgreSQL. Faz sentido utiliz√°-la e remover os usu√°rios que possuem apenas a feature `read:activation_token` h√° mais de 48 horas, por exemplo?

```sql
DELETE
  users
WHERE ARRAY['read:activation_token'::varchar] = features
AND created_at < NOW() - INTERVAL '48 hours';
-- Precisaria tratar tamb√©m o "activate_account_tokens" para caso
-- algum dos usu√°rios removidos tenham um token n√£o expirado.
```

Dessa forma, quem n√£o ativar a conta em 48 horas (ou X horas) ter√° que cadastrar novamente.

>> Coment√°rio de aprendendofelipe:
Uma outra abordagem √© verificar isso no momento da cria√ß√£o de um usu√°rio.

Na cria√ß√£o, caso o `username` coincida com um existente, mas que n√£o foi ativado dentro da validade do token de ativa√ß√£o, ent√£o libera o uso desse `username` para a nova conta, independentemente de ser o mesmo ou outro endere√ßo de email.

>> Coment√°rio de Rafatcb:
√â uma boa op√ß√£o, e mais simples.
</issue_957_Conta n√£o verificada pelo email n√£o foi descartada>

<issue_958_[Feature] [UX] Permitir redimensionar o campo de postagens e respostas>
Uma altera√ß√£o simples: permitir redimensionar verticalmente o editor onde se escrevem as postagens e respostas.

Em uma busca r√°pida na documenta√ß√£o do ByteMD e CodeMirror, isso parece ser poss√≠vel alterando diretamente o CSS: a documenta√ß√£o do CodeMirror tem um [exemplo](https://codemirror.net/5/demo/resize.html) de autoresize infinito. Na minha opini√£o o melhor dos mundos seria combinar isso com um `maxHeight`, dessa forma daria para deixar ele redimensionar automaticamente at√© certo limite pr√©-definido.

>> Coment√°rio de aprendendofelipe:
@dineiar, obrigado pela sugest√£o! üí™

Isso foi implementado no #1348
</issue_958_[Feature] [UX] Permitir redimensionar o campo de postagens e respostas>

<issue_959_[Feature] Rotacionar os assuntos relevantes>
Poder√≠amos adicionar relev√¢ncia por dia/semana/m√™s para que os assuntos relevantes dentro da tabnews possam ser recomendados mais facilmente recomendados e encontrados

>> Coment√°rio de aprendendofelipe:
Oi @KitsuneSemCalda, ainda n√£o temos hist√≥rico suficiente para sabermos quais seria as melhores maneiras de classificar os conte√∫dos como relevantes. Ent√£o estamos ajustando o algoritmo conforme vamos entendendo a intera√ß√£o dos usu√°rios com o sistema.

Por enquanto n√£o temos as varia√ß√µes de ranqueamento, pois ainda precisamos ajustar melhor o ranqueamento principal.

Sobre rotacionar os assuntos, eles s√£o rotacionados, mas entra no mesmo caso, que ainda estamos fazendo os ajustes conforme o aprendizado. J√° deu para perceber que com o volume atual ser√° vi√°vel uma rota√ß√£o mais r√°pida, ent√£o vamos fazer isso. üëç

Tudo est√° p√∫blico aqui no GitHub e o algoritmo atual ocorre nesta consulta:

https://github.com/filipedeschamps/tabnews.com.br/blob/fa27bf9c7203d948eea2d889abd35b649697198b/models/queries.js#L1-L1

>> Coment√°rio de Rafatcb:
Me parece que o algoritmo do TabNews evoluiu bem ao longo desse ano de vida, e o Relevantes est√° bem diversificado. Para atender demandas espec√≠ficas, acho mais adequado concentrar os esfor√ßos no issue https://github.com/filipedeschamps/tabnews.com.br/issues/742, porque as tags v√£o permitir filtrar conte√∫dos de um tema espec√≠fico, nem que seja um "recentes", sem rankeamento.

Faz sentido, @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
Faz sentido @Rafatcb, pois o ranqueamento foi evoluindo conforme o sistema foi permitindo novas consultas, e isso deve continuar acontecendo.

N√£o vejo necessidade de manter a issue aberta. ü§ù
</issue_959_[Feature] Rotacionar os assuntos relevantes>

<issue_960_[Feature] Rascunho de postagens>
√ìtima iniciativa a do TabNews!

Seria muito interessante para as pessoas que desejam produzir postagens longas se a ferramenta tivesse uma feature de salvamento de postagens como rascunho. Desse modo a se√ß√£o de escrita poderia ser particionada permitindo postagens com maior grau de curadoria e refino.

Abaixo tem um print de onde o bot√£o poderia ficar.

![image](https://user-images.githubusercontent.com/16859514/204007169-3a2640e2-d48e-4cf9-b591-651c87fe070f.png)

>> Coment√°rio de KitsuneSemCalda:
se n√£o me engano at√© daria para salvar no local storage do navegador para fazer isso

>> Coment√°rio de dioggosoares:
A ideia seria pra conteudo extenso como o amigo postou e o localstorage n√£o √© t√£o bom para dados extensos assim, a ideia seria usar a flag 'draft' no banco seria o ideal, creio que nem seria trabalhoso implementar, talvez j√° at√© tenha algum PR fazendo isso s√≥ esperando aprova√ß√£o, eu uma olhada la @brunoruas2

>> Coment√°rio de brendo10x:
O ideal seria no banco de dados. E o Post poderia ter status = ACTIVE, DRAFT ou INACTIVE.

>> Coment√°rio de brunoruas2:
Vou ver se tem algu√©m trabalhando no tema, boa ideia @dioggosoares !

>> Coment√°rio de mthPiltz:
H√° algu√©m trabalhando na ideia? Se n√£o gostaria de fazer.

>> Coment√°rio de victorhcb:
> O ideal seria no banco de dados. E o Post poderia ter status = ACTIVE, DRAFT ou INACTIVE.

Se n√£o me engano j√° existe essa op√ß√£o de status draft, s√≥ n√£o sei se est√° sendo utilizado de alguma forma no site ainda

>> Coment√°rio de rafaelbarbosas:
√≥tima ideia!

Eu, como bom hiperativo, penso em mil coisas ao mesmo tempo -- e escrevo as mil coisas ao mesmo tempo, tamb√©m! Seria bom ter a op√ß√£o de escrever v√°rios rascunhos, at√© pra deixar salvo algum texto que voc√™ at√© achou que seria legal, mas n√£o teve tempo de desenvolver bem.

Um problema seria o espa√ßo no BD: a pessoa pode criar muitos rascunhos que n√£o v√£o virar postagens, e acabar gastando um espa√ßo que poderia ser mais √∫til para os outros usu√°rios. Poderia, at√© mesmo, acabar usando o tabnews como um bloco de anota√ß√µes. Talvez, se colocar um limite na quantidade de rascunhos isso se resolva.

>> Coment√°rio de brunoruas2:
Pra isso eu resolveria colocando um tempo de vida pro rascunho. At√© 30 dias pra publicar ou algo assim.

@rafaelbarbosas O que acha?

>> Coment√°rio de rafaelbarbosas:
@brunoruas2 , √© uma boa solu√ß√£o.

Tamb√©m d√° pra usar o Gist do GitHub, da√≠ as anota√ß√µes ficam sob responsabilidade do usu√°rio. Porque, se voc√™ pensar no escopo do tabnews, talvez seja uma funcionalidade meio "estranha", ent√£o n√£o faz sentido isso ficar gravado no BD.

Tem tamb√©m o problema de adicionar muitas funcionalidades e deixar o app "carregado". Essa funcionalidade de v√°rios rascunhos pode ser uma que poucos v√£o usar, talvez seja mais √∫til apenas um rascunho.

Pra saber mesmo, teria que fazer uma pesquisa.

>> Coment√°rio de fabiosvm:
Eu gostaria muito de ver essa feature no TabNews. Acabei de sentir a necessidade.

>> Coment√°rio de emerson-oliveira:
Para o momento eu acredito que a melhor op√ß√£o seja uma extens√£o removendo essa responsabilidade do site.
A op√ß√£o de adicionar no localstorage √© bem interessante, mas existe alguns pontos:

**Limita√ß√£o de tamanho:** O localstorage armazena no m√°ximo 5MB por origem. 
**Seguran√ßa:** O site pode ficar vulner√°vel a ataques XSS
</issue_960_[Feature] Rascunho de postagens>

<issue_961_[FEATURE] Rolagem infinita das postagens>
Como usu√°rio gostaria que a p√°gina de listagem de postagens trouxesse mais conte√∫dos a medida em que fa√ßo scroll na p√°gina.

- Inicialmente pode ser um bot√£o de 'carregar mais'.

Dica a dica :D

>> Coment√°rio de Rafatcb:
N√£o sei se isso faz sentido para o TabNews. Um dos objetivos do site √© se distanciar das redes sociais e suas t√©cnicas para prender usu√°rios. O coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074 n√£o aborda diretamente esse assunto, mas fala sobre o esp√≠rito de deixar a pessoa livre. O scroll infinito √© algo que incita a pessoa a ficar ali "vendo s√≥ mais um pouquinho".

Um outro issue que levanta um problema similar √© o https://github.com/filipedeschamps/tabnews.com.br/issues/1530, sobre um bot√£o para navegar para a pr√≥xima publica√ß√£o, e a comunidade est√° pendendo mais para o lado de n√£o ter isso.

>> Coment√°rio de aprendendofelipe:
Dado que a ideia n√£o atraiu ningu√©m para o debate em mais de um ano, e nem mesmo surgiram outras sugest√µes citando rolagem infinita, acredito que podemos fechar essa issue, pois isso n√£o deve ser implementado no m√©dio prazo.

O que acham?

>> Coment√°rio de Rafatcb:
Seguindo com o coment√°rio do @aprendendofelipe, como n√£o houve pronunciamento contr√°rio, estou fechando aqui para organizar o reposit√≥rio. Obrigado pela sugest√£o, Brendo.
</issue_961_[FEATURE] Rolagem infinita das postagens>

<issue_963_PWA APP>
Acho que poderia ser feito uma forma de usar o site como PWA no m√≥bile, tentei colocar o aplicativo na √°rea de trabalho do meu celular, mas n√£o consegui.
</issue_963_PWA APP>

<issue_965_[FEATURE] Contruibuidor de cria√ß√£o de conte√∫do>
Seria interessante eu poder adicionar algum outro usu√°rio da plataforma como parceiro de escrita.

Eu gostaria de escrever sobre uma lib interna que desenvolvemos na empresa em que eu trabalho, por√©m n√£o fiz ela sozinho e gostaria que meu colega tamb√©m estivesse vinculado de alguma forma na plataforma tabnews,  pois vou lhe pedir ajuda para lembrar algumas coisas que implementamos e provavelmente o mesmo vai me ajudar a construir o conte√∫do.
</issue_965_[FEATURE] Contruibuidor de cria√ß√£o de conte√∫do>

<issue_967_Editor Markdown sem suporte para Autocomplete>
## Contexto
Eu estava lendo esse coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/493#issue-1303907543 e percebi que um dos planos para a pr√≥xima Milestone √© _"O poder de marcar as pessoas enquanto escreve o conte√∫do"_. Pra implementar isso, eu fui pesquisar mais sobre o editor usado que √© o [ByteMD](https://github.com/bytedance/bytemd) e percebi que ele n√£o tem suporte para Autocomplete, que √© na maioria das vezes a fun√ß√£o usada para marcar pessoas ou itens enquanto digita.
Duas op√ß√µes que eu pensei de forma superficial √©:
 1. Construir um plugin para o ByteMD que d√° esse suporte de autocomplete
 2. Migrar para o editor de texto do [Primer](https://primer.style/react/drafts/MarkdownEditor) quem tem suporte √† isso.

O MarkdownEditor do Primer est√° com a tag de `Draft` e provavelmente vai sofrer bastante atualiza√ß√µes conforme o tempo, acredito que usar ele no lugar do ByteMD √© muito mais vantajoso pois ele tem muito mais features que o ByteMD, segue uma pequena lista:
 - Formata√ß√£o (atalhos de teclado e bot√µes da barra de ferramentas)
 - Uploads de arquivos (arrastar e soltar, colar, clicar para fazer upload)
 - Sugest√µes inline (emojis, @men√ß√µes e #refer√™ncias)
 - Respostas salvas
 - Colagem de markdown (ou seja, cole o URL no texto selecionado para criar um link)
 - Edi√ß√£o de lista (crie um novo item de lista em Enter)
 - Recuando o texto selecionado

Quanto ao design do editor, n√£o se diferencia muito do design usado no tabnews:

![Representa√ß√£o do Editor de Texto do Primer](https://user-images.githubusercontent.com/63757378/204041661-5a35933b-7c91-44d1-892f-0d9c00228177.png)


Aqui est√° o Link dele: https://primer.style/react/drafts/MarkdownEditor
Link do MarkdownViewer: https://primer.style/react/drafts/MarkdownViewer

>> Coment√°rio de MathGoOli:
Eu gostaria que o TAB news tivesse como editar texto igual o notion.

>> Coment√°rio de aprendendofelipe:
@silvaezequias, obrigado pela sugest√£o! üí™

Como ela surgiu primeiro na issue #648, vamos centralizar as conversas sobre o editor de markdown por l√°. üëçü§ù
</issue_967_Editor Markdown sem suporte para Autocomplete>

<issue_970_Erros ortogr√°ficos>
Eu percebi que a plataforma usa o code mirror como area de texto. O problema √© que (at√© onde eu sei) ele n√£o tem (ou ainda n√£o tem implementado) a possibilidade de ativar o corretor ortogr√°fico. Sendo assim tenho percebido muitos posts com erros de portugu√™s, e eu n√£o acho que seria legal a gente corrigindo o pessoal atrav√©s dos coment√°rios.

Hoje em dia muitas pessoas esperam que o corretor d√™ aquela filtrada nos erros, sendo assim aumentaria e muito a qualidade dos posts se o editor de texto tivesse essa funcionalidade.

>> Coment√°rio de aprendendofelipe:
√â verdade @drocha87, usamos o ByteMD, que √© baseado no CodeMirror V5, mas existe uma nova vers√£o sendo desenvolvida como [HashMD](https://github.com/pd4d10/hashmd) e que usar√° o CodeMirror V6, onde esse problema deve ser superado.

Ent√£o a solu√ß√£o para o TabNews deve ser a troca do editor ou aguardar a nova vers√£o. E as discuss√µes sobre isso podem ser centralizadas na #648.

Vou fechar essa aqui ü§ù
</issue_970_Erros ortogr√°ficos>

<issue_971_[Feature] - Adicionar o link do Github em seu cadastro>
Pessoal o que voc√™s acham de cadastrar o link do seu perfil do github no perfil do tabnews?

Essa informa√ß√£o poderia ser exibida dentro dos seus posts de uma forma sutil, pois ai fica f√°cil de ter acesso aos c√≥digos de exemplo e at√© de seguir essa pessoa l√° no github. 

Desculpe o exemplo simples:
![image](https://user-images.githubusercontent.com/13180552/204050109-b71c6a19-a0fc-4102-bcad-120443ab69f5.png)

Aonde est√° o icone vermelho poderia ser o icone do github com um link para direcionar para o perfil da pessoa que escreveu o post.

>> Coment√°rio de FilipeRicardo:
Faria mais sentido o usu√°rio ter uma p√°gina pr√≥pria, igual no github, onde ele pudesse editar, e caso queira, colocar o link do github, usando o mesmo padr√£o das p√°ginas dos artigos.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Pedro!

Como hoje existe uma √°rea de Descri√ß√£o no perfil do usu√°rio (https://github.com/filipedeschamps/tabnews.com.br/pull/1470), onde a pessoa pode colocar os links que deseja, estarei fechando este issue pelo mesmo motivo que o https://github.com/filipedeschamps/tabnews.com.br/issues/1371 foi fechado, ok?
</issue_971_[Feature] - Adicionar o link do Github em seu cadastro>

<issue_972_Diferenciar autor do post nos coment√°rios do mesmo>
O `TabNews` √© maravilhoso em sua simplicidade. Mas tem um ponto que eu sempre me atrapalho quando vou ver algum artigo: **quem comentou foi o autor do post?**

Eu acredito que n√£o seja t√£o complicado de fazer isso, e vai deixar a sess√£o de coment√°rios muito mais organizada!

Seguindo o padr√£o das cores `azul` *(TabCoins)* e `verde` *(TabCash)*, daria pra estilizar algo parecido com isso:

![Print da tela](https://i.imgur.com/DjbtMzy.png)

>> Coment√°rio de miguel5g:
Hey @igorroc, admito que tamb√©m j√° fiquei confuso em rela√ß√£o a isso, acho que isso seria uma adi√ß√£o legal.

>> Coment√°rio de miguel5g:
Fala pessoal, acredito que nigu√©m tentou implementar ainda, ent√£o fiz alguns testes aqui e acho que da para implementar sem muitos problemas, o meu c√≥digo ta alguns commits atrasadoas, mas caso seja isso que vou mostrar posso abrir uma pr pronta em breve :smile: 

![image](https://user-images.githubusercontent.com/53842126/206064680-6390f78c-554e-4587-9b70-4d76c72e7c24.png)

Tem um √∫nico bug que √© quest√£o da borda cinza no primeiro coment√°rio do dono do post, ele fica assim pois a altera√ß√£o de content mode ocorre internamente, e ele continua recebendo as props `frame=true`, eu n√£o sei se √© uma feature ou bug, mas depois que recarrega a p√°gina e atualiza o estado pai ele fica igual o de baixo, algu√©m sabe informar?

>> Coment√°rio de Rafatcb:
Me surgiu uma d√∫vida quanto √† implementa√ß√£o: se eu estiver no link de um coment√°rio, o usu√°rio real√ßado deve ser o autor desse coment√°rio ou o autor do conte√∫do raiz?

>> Coment√°rio de aprendendofelipe:
> Me surgiu uma d√∫vida quanto √† implementa√ß√£o: se eu estiver no link de um coment√°rio, o usu√°rio real√ßado deve ser o autor desse coment√°rio ou o autor do conte√∫do raiz?

Acredito que deveria ser destacado o autor do conte√∫do principal da p√°gina visitada, seja coment√°rio ou raiz.

Numa vers√£o mais elaborada, poderia diferenciar o autor do conte√∫do raiz e do coment√°rio visitado, mas pode n√£o ficar com uma boa UX.

E pelo bem da UX, devemos pensar nisso ao mesmo tempo que pensamos como identificar usu√°rios novos e tamb√©m os poss√≠veis verificados.

>> Coment√°rio de Rafatcb:
Talvez colocar um label como o GitHub faz, mas do lado do nome do usu√°rio, pode ser uma op√ß√£o mais vi√°vel do que usar cores para isso, porque o label √© mais explicativo e ainda pode ter um Tooltip, apesar de n√£o chamar tanta aten√ß√£o (pode ser um label colorido, mas a√≠ tem que tomar cuidado pra n√£o virar um carnaval). 

![Interface do GitHub para o coment√°rio do autor de um issue](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/3facec49-a3bc-473a-9769-ac9617190caa)

Se for usar cores no nome do usu√°rio, acho que precisar√≠amos deixar de usar o azul como padr√£o e usar algo mais neutro (cinza, por exemplo), mas ainda seria importante ter alguma explica√ß√£o do que a cor significa.

>> Coment√°rio de Rafatcb:
Abri o PR #1589 com uma implementa√ß√£o similar ao que √© no GitHub. No PR est√° com o texto `Autor` mas deixei imagens de como seria com `Autor(a)`:

| Autor | Autor(a) |
|--- | --- |
| ![Nome "Betty3", Label e tooltip "Autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/7f6b658d-f027-414e-b055-deecd6c6b8be) | ![Nome "Betty3", Label e tooltip "Autor(a)"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/fdc1f78c-7bb2-4a42-9c00-914dc779c5bf) |
| ![Nome "rafael", Label e tooltip "Autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/5e9a7130-831f-4b58-8e2b-604f8aa6394c) | ![Nome "rafael", Label e tooltip "Autor(a)"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/97196c8e-e9c4-4f00-9936-85eaefdd68f7)

>> Coment√°rio de aprendendofelipe:
> Se for usar cores no nome do usu√°rio, acho que precisar√≠amos deixar de usar o azul como padr√£o e usar algo mais neutro (cinza, por exemplo), mas ainda seria importante ter alguma explica√ß√£o do que a cor significa.

Acho que pode ser mais interessante usar cores nos labels, n√£o no nome do autor.

> Abri o PR #1589 com uma implementa√ß√£o similar ao que √© no GitHub. No PR est√° com o texto `Autor` mas deixei imagens de como seria com `Autor(a)`:

"Autor" fica melhor, tanto visualmente, como para ferramentas de acessibilidade.
</issue_972_Diferenciar autor do post nos coment√°rios do mesmo>

<issue_973_Posso dar mais de um UpVote>
N√£o sei dizer se √© proposital ou n√£o, mas atualmente √© permitido enviar mais de um UpVote para um post.

Acredito que o melhor seria limitar a quantidade de UpVotes em 1 para cada post, e existir alguma forma de mostrar ao usu√°rio que aquele post j√° recebeu o seu UpVote

>> Coment√°rio de coffeeispower:
Isso √© o sistema de tabcoins, se voc√™ tiver tabcoins suficientes voc√™ pode dar um tabcoin e o dono do post recebe um tabcoin, se voc√™ retirar um tabcoin, voc√™ perde tabcoins e o autor tambem perde 1 tabcoin. Voc√™ ganha tabcoins postando coisas ou comentando em posts

>> Coment√°rio de aprendendofelipe:
Fala @igorroc, obrigado pelas sugest√µes! üí™

Sobre limitar os votos, no passado foi implementado o limite de 1 voto por IP em cada conte√∫do, mas percebemos que 1 s√≥ voto era pouco, ent√£o agora o limite √© de 3 votos por IP, mas isso ainda pode ser alterado futuramente. De qualquer forma, ainda √© poss√≠vel dar mais votos, bastando usar outro IP, mas tudo fica registrado, ent√£o qualquer abuso vai acabar com a exclus√£o dos usu√°rios envolvidos.

Sobre mostrar ao usu√°rio que o post j√° foi votado, hoje foi aberta a issue #1510 especificamente sobre isso, ent√£o vou fechar a sua e qualquer novidade podemos conversar na espec√≠fica. Combinado? ü§ù
</issue_973_Posso dar mais de um UpVote>

<issue_974_[Feature] Possibilidade de modificar posts de outros usu√°rios.>
Seria muito interessante se as pessoas pudessem adicionar ou corrigir informa√ß√µes no post de outros usu√°rios, claramente sendo aplicado **somente se/quando o dono do post permitir a modifica√ß√£o**.

Assim, faria os posts terem a oportunidade de serem mais completos e organizados caso o dono permita aquela modifica√ß√£o!

>> Coment√°rio de silvaezequias:
#714

>> Coment√°rio de eusolomax:
Obrigado, n√£o tinha visto esta issue antes!
</issue_974_[Feature] Possibilidade de modificar posts de outros usu√°rios.>

<issue_975_[ERRO] Sem permiss√£o ‚Äúread:session‚Äù p√≥s ativa√ß√£o>
![C6CD0484-B044-4598-8098-E568EF3FF077](https://user-images.githubusercontent.com/33969883/204065255-ac0b6b5b-4d44-42c0-a17d-baf968515fc7.jpeg)

Criei minha conta, e ativei o cadastro atrav√©s da verifica√ß√£o de e-mail. Porem, quando tento logar da esse erro:

>  Voc√™ n√£o possui permiss√£o para executar esta a√ß√£o. Verifique se este usu√°rio j√° ativou a sua conta e recebeu a feature "read:session".

(enviei o print e escrevi o erro pra ficar mais f√°cil de pesquisarem o issue se algu√©m tiver o mesmo)

>> Coment√°rio de mardenrafael:
Estou tendo o mesmo problema...

>> Coment√°rio de Rafatcb:
Esse erro aconteceu na √©poca de lan√ßamento do TabNews, onde houveram muitos cadastros, intera√ß√µes, instabilidade na plataforma, a API fico readonly por um per√≠odo... Pode ser que a verifica√ß√£o tenha se perdido no meio disso tudo. Estou supondo isso porque n√£o vi mais reclama√ß√µes por esse motivo.

@aprendendofelipe Pode dar tua opini√£o? Pensei em fechar o issue, mas talvez voc√™ tenha mais informa√ß√µes sobre isso.

>> Coment√°rio de aprendendofelipe:
Realmente esse problema ocorreu com frequ√™ncia no momento do lan√ßamento, mas o que permitia que ele ocorresse j√° foi corrigido em #1439
</issue_975_[ERRO] Sem permiss√£o ‚Äúread:session‚Äù p√≥s ativa√ß√£o>

<issue_978_A falta de "DarkMode" incomoda um pouco.>
como grande parte dos desenvolvedores, acho que um tema claro nem sempre √© bem vindo aos olhos kkkk
seria muito bom se adicionassem a op√ß√£o de temas escuros ao TabNews

>> Coment√°rio de silvaezequias:
https://github.com/filipedeschamps/tabnews.com.br/pull/377

>> Coment√°rio de ghost:
> como grande parte dos desenvolvedores, acho que um tema claro nem sempre √© bem vindo aos olhos kkkk seria muito bom se adicionassem a op√ß√£o de temas escuros ao TabNews

Meus olhos agradecem.

>> Coment√°rio de Rafatcb:
O modo escuro j√° foi implementado, dividido em alguns PRs, mas a maior parte da discuss√£o foi abordada aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1199. Foi algo bem pedido e por isso acabaram surgindo sugest√µes duplicadas no GitHub.

@aprendendofelipe (marcando para fechar esse issue).
</issue_978_A falta de "DarkMode" incomoda um pouco.>

<issue_979_Elogios, Sugest√µes, Dicas.>
Criei uma publica√ß√£o detalhando:

https://www.tabnews.com.br/felipeoz/elogios-sugestoes-dicas

Abra√ßo

>> Coment√°rio de lucas-williams:
Opa, deixo aqui como sugest√£o um "side bar" para as principais d√∫vidas dos membros da comunidade, ou seja, uma √°rea vis√≠vel que direcione de maneira simplificada quest√µes como:

- Como reportar falhas de seguran√ßa?
- Como fazer elogios ou reclama√ß√µes?
- Sugest√µes e dicas de aperfei√ßoamento da plataforma e etc.
- Principais noticias da semana

Qual seria o objetivo do sidebar?
Evitar que membros criem tabnews repetidas na plataforma tornando o ambiente "flodado".

>> Coment√°rio de lucas-williams:
Minha outra sugest√£o seria a possibilidade de integrar um "sistema de avatar", onde os membros poderiam criar ou personalizar avatares nas suas fotos de perfil.

>> Coment√°rio de Rafatcb:
As sugest√µes que est√£o na publica√ß√£o do TabNews s√£o:

> Categorias, Assuntos ou Temas

Podemos marcar como duplicada de https://github.com/filipedeschamps/tabnews.com.br/issues/742, pois a discuss√£o est√° sendo concentrada l√°.

> Busca

J√° implementado.

> TabCoin e TabCash em Blockchain

O assunto j√° foi tratado, de certa forma, e tem uma grande discuss√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/11. O issue est√° fechado mas com tag de repescagem. Tamb√©m tem uma sugest√£o aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1438.

Tendo em vista, ent√£o, a organiza√ß√£o do reposit√≥rio, podemos fechar essa issue?

As outras sugest√µes realizadas em coment√°rios tamb√©m j√° foram feitas em issues diferentes.
</issue_979_Elogios, Sugest√µes, Dicas.>

<issue_980_minhas sugest√µes para contribuir com a comunidade.>
Eu tive uma √≥tima impress√£o ao entrar na comunidade, por isso quero contribuir com o que for. N√£o sei se j√° foi pautado essas ideias antes por aqui mas vamos l√°.

Tem alguns pontos que eu gostaria de comentar.

1)  sistema de buscas
2) sistema de perguntas

1 - seria incr√≠vel ter algum sistema de buscas na plataforma, j√° que assim caso tenhamos alguma d√∫vida ou quisermos adiquirir algum tipo de conhecimento podemos procurar r√°pidamente pelas postagens, foi algo que senti bastante falta por aqui e acho ser necess√°rio.

2 - sistema de perguntas, al√©m das postagens compartilhando alguns conhecimentos seria interessante. J√° que quando criamos alguma postagem estamos sujeitos ao ganho de tabcoins quando fizessemos uma pergunta em busca de algum conhecimento pagariamos os nossos tabcoins por ele. Pensei em fazer minhas perguntas com postagens normais mas n√£o faria sentido eu ganhar por fazer alguma pergunta sentiria como se estivesse trapaceando *risos*

por enquanto esses s√£o os pontos que tenho a comentar, logo trarei novas ideias se as tiver.

>> Coment√°rio de wellyton-xs:
Outra coisa que acho que seria √≥tima, algum tipo de sistema de estrelinha ou salvar um post ou discuss√£o para poder reler ou comentar mais tarde, seria bastante interessante.

>> Coment√°rio de Rafatcb:
Com o objetivo de organizar os issues abertos no reposit√≥rio, vou sugerir issues para direcionar os assuntos e permitir fechar essa como duplicada:

1. A busca j√° foi implementada (https://github.com/filipedeschamps/tabnews.com.br/pull/1472)
2. https://github.com/filipedeschamps/tabnews.com.br/issues/1026: Apesar de abordar dois assuntos (acho que seria mais produtivo a issue ser editada e focar apenas na parte das perguntas, pois j√° h√° outro para notifica√ß√£o), ela vai um pouco mais a fundo sobre o sistema de perguntas. Sua ideia sobre isso gastar TabCoin para fazer perguntas pode ser colocada l√°.
3. https://github.com/filipedeschamps/tabnews.com.br/issues/645

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Pelos menos nas primeiras vers√µes, a quest√£o de perguntas pode ser uma tag espec√≠fica, combinada com tags do assunto sobre a d√∫vida.

Por organiza√ß√£o, vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_980_minhas sugest√µes para contribuir com a comunidade.>

<issue_981_[Sugest√µes] Labels nos posts>
Seria interessante a implementa√ß√£o de labels, melhorando o filtro de conteudo.

Exemplo:
![image](https://user-images.githubusercontent.com/13632826/204096052-2f48046c-4d30-43cf-92f9-7669eccfb992.png)
![image](https://user-images.githubusercontent.com/13632826/204096063-9826173f-97a5-4234-b7d9-f4d6f4595110.png)
![image](https://user-images.githubusercontent.com/13632826/204096176-b4e24eb9-9a85-4cbe-a38a-ed5332e3deca.png)


Obs: √â s√≥ um exemplo, toda quest√£o de est√©tica pode melhorar.

>> Coment√°rio de peeeuzin:
Tava pensando isso mesmo, estou implementando `search` (#982) para API e isso pode ser uma boa implementar essa ideia junto com `search` para ajudar os usu√°rios a pesquisar conteudos facilmente

>> Coment√°rio de Dev-Lyh:
Fiz um post sobre isso no TabNews.
Foi antes de ver que j√° tinha uma `issue` registrada.
Realizei alguns designs de como que ficariam as labels na parte do conte√∫do em si, mas tamb√©m, gostei muito do conceito da sua √∫ltima ideia, bate bem com o resto do design do TabNews. Vou deixar aqui o link do meu post no TabNews e tamb√©m deixarei aqui quais foram os meus designs preferidos por mesclarem com o design system do TabNews.

### *Qualquer feedback √© bem vindo. N√£o vejo a hora dessa implementa√ß√£o acontecer kkkk*

## Design 1:
![Tags abaixo do t√≠tulo, lado direito](https://github.com/Dev-Lyh/AAGXNBA9CVU37VNTTXX/blob/master/Desktop%20-%203.png?raw=true)

## Design 2:
![Tags abaixo do conte√∫do, lado direito](https://github.com/Dev-Lyh/AAGXNBA9CVU37VNTTXX/blob/master/Desktop%20-%204.png?raw=true)

### **Link para o post:** [Algumas ideias de como as labels ficariam no TabNews](https://www.tabnews.com.br/devlyh/algumas-ideias-de-como-as-labels-ficariam-no-tabnews)

>> Coment√°rio de Suburbanno:
@Dev-Lyh Bem mais interessantes as sugest√µes, obrigado. Resta apenas o @filipedeschamps e a comunidade tratar essa sugest√£o com carinho e implementar, estou sentindo falta disso l√°.

>> Coment√°rio de evertonrj:
Com toda certeza essa feature trar√° um UP para o tabnews.

Talvez seja interessante definir alguns par√¢metros para fica bem organizado a estrutura de tags.

minha dica l√° no tabnews.

https://www.tabnews.com.br/oAnalista/tags-para-classificar-os-posts

>> Coment√°rio de aprendendofelipe:
@Suburbanno, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser duplicada, ent√£o recomendo centralizar a discuss√£o na #742.

Combinado? ü§ù
</issue_981_[Sugest√µes] Labels nos posts>

<issue_983_[SUGEST√ÉO] Salvar posts para depois>
√â necessario uma forma de salvar posts que no momento n√£o tem tempo para ler e ler ele depois

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_983_[SUGEST√ÉO] Salvar posts para depois>

<issue_986_Recaptcha para evitar bots>
Para evitar que bots criam posts e ganham `TabCoins`/`TabCash` de forma autom√°tica, precisamos adicionar algum `reCAPTCHA` ou um "verificador de bots" para que n√£o aconte√ßa.

>> Coment√°rio de coffeeispower:
Tem 2 op√ß√µes aqui,da pra colocar o recaptcha sempre, at√© da primeira vez que cria a conta, ou colocr quando √©, por exemplo, a 3 vez que cria uma conta do mesmo IP

>> Coment√°rio de peeeuzin:
> Tem 2 op√ß√µes aqui,da pra colocar o recaptcha sempre, at√© da primeira vez que cria a conta, ou colocr quando √©, por exemplo, a 3 vez que cria uma conta do mesmo IP

Sem contar que existe reCAPTCHA invisiveis e d√° pra colocar esse tipo de reCAPTCHA sempre quando cria um post

>> Coment√°rio de gabrielsozinho:
Mas e a API? Se for pra fazer spam, a pessoa faria spam atrav√©s da API que √© p√∫blica.

>> Coment√°rio de peeeuzin:
> Mas e a API? Se for pra fazer spam, a pessoa faria spam atrav√©s da API que √© p√∫blica.

o reCAPTCHA da google retorna um `token` para poder acessar a API.

Recomendo acessar a [documenta√ß√£o](https://developers.google.com/recaptcha/docs/verify) do reCAPTCHA

>> Coment√°rio de aprendendofelipe:
@peeeuzin, obrigado pela sugest√£o! üí™

N√≥s temos prote√ß√£o da Cloudflare, ent√£o ela j√° nos ajuda diariamente a enfrentar os bots. Dependendo da situa√ß√£o ela j√° exige desafios, a maioria √© invis√≠vel para os usu√°rios.

Tamb√©m existem diferentes mecanismos implementados no c√≥digo do TabNews para evitar abusos. Obviamente nenhum nos protege 100%.

Vou fechar a issue, mas qualquer novidade, √© s√≥ reabrir. Combinado? ü§ù
</issue_986_Recaptcha para evitar bots>

<issue_987_[SUGEST√ÉO] Menu fixo / bot√£o flutuante>
Acompanhando algumas postagens riqu√≠ssimas em conte√∫do, acabo descendo muito na p√°gina e sinto falta de um menu fixo ou de um bot√£o flutuante para voltar ao topo novamente.

>> Coment√°rio de gabrielsozinho:
Eu particularmente sou mais a favor do bot√£o flutuante, isso porque eu sinto que com um menu fixo a tela acaba perdendo espa√ßo.

Atualmente a interface do meu TabNews √© assim, acho bastante agrad√°vel (apesar de ter um grande contraste).
![interface do meu tabnews](https://user-images.githubusercontent.com/90806505/204114205-41f339fa-8da4-486e-9de7-ff45ee81e853.png)

Personalizei assim usando as extens√µes Dark Reader e Stylus. Inclusive usando o Stylus voc√™ consegue deixar o menu fixo.

>> Coment√°rio de Rafatcb:
O bot√£o de voltar ao topo foi implementado no come√ßo de 2023! Parece que esqueceram de fechar a issue.

A implementa√ß√£o est√° aqui: https://github.com/filipedeschamps/tabnews.com.br/pull/1039

>> Coment√°rio de aprendendofelipe:
@GHCMelo, obrigado pelas sugest√µes! üí™

A discuss√£o sobre o header fixo ainda est√° em aberto no #1225, ent√£o √© melhor concentrarmos l√° ü§ù

E o bot√£o j√° foi implementado, como o @Rafatcb citou üëç

Por organiza√ß√£o, estou fechando essa issue ü§ù
</issue_987_[SUGEST√ÉO] Menu fixo / bot√£o flutuante>

<issue_989_Markdown -  Sugest√µes de novos comandos para a plataforma>
Ol√°, seja bem-vindo! Utilize est√° √°rea para sugerir que novos comandos de markdown sejam incorporados a plataforma.

Abra√ßos.

>> Coment√°rio de leydsonandrey:
Marcador de texto

```
==texto √† ser marcado==
```

>> Coment√°rio de lucas-williams:
F√≥rmulas matem√°ticas:. N√£o encontrei comandos que permitisse escrever tais f√≥rmulas:

 $Y = \beta_0 + \beta_1 x + \epsilon$

>> Coment√°rio de rafaelbarbosas:
> F√≥rmulas matem√°ticas:. N√£o encontrei comandos que permitisse escrever tais f√≥rmulas:

Foi exatamente para dar essa sugest√£o que eu entrei aqui.
Adicionar os comandos:

```markdown
```math
```

e o inline \$ [equa√ß√£o aqui] \$

>> Coment√°rio de 33gustavo33:
> Marcador de texto
>
> ```
> ==texto √† ser marcado==
> ```

@SureAndrey, d√° pra usar a tag html **mark** pra essa finalidade, √© s√≥ escrever:
```html
<mark>texto a ser marcado</mark>
```

>> Coment√°rio de aprendendofelipe:
@lucas-williams, obrigado pela issue! üí™

Vou fechar ela porque est√° bem gen√©rica, o que dificulta as discuss√µes. ü§ù

Mas a compatibilidade com f√≥rmulas matem√°ticas, que foi o item mais pedido aqui, j√° foi implementado em #1323 üëç
</issue_989_Markdown -  Sugest√µes de novos comandos para a plataforma>

<issue_990_[Feature] - Dei upvotes/downvotes? üòï>
Gostaria de sugerir aqui que fosse inclu√≠do um "contador" de upvotes/downvotes ou simplesmente um indicador informando se um post/coment√°rio j√° recebeu um upvote/downvote meu, pois acontece que as vezes fico confuso se dei up/downvote ou n√£o em determinado post/coment√°rio.

>> Coment√°rio de wallasfmorais:
Talvez poderia ser tratado com uma estrat√©gia diferente. 
N√£o cheguei ainda a ver se j√° foi discutido isso anteriormente ou n√£o, mas n√£o seria melhor ser um toggle? Explico:
N√£o faz sentido a mesma pessoa dar up/down vote mais de uma vez em uma mesma publica√ß√£o a n√£o ser com uma n√£o t√£o boa inten√ß√£o (mesmo que a inten√ß√£o seja no fundo positiva [gostei tanto que vou dar 2 upvote] apenas cria desequil√≠brio). Ent√£o quanto tentar novamente dar o vote remove o vote, ... !

>> Coment√°rio de GoulartNogueira:
> N√£o faz sentido a mesma pessoa dar up/down vote mais de uma vez em uma mesma publica√ß√£o

Discordo. O Medium, por exemplo, n√£o tem downvote e eles permitem upvotes ilimitados.
E a ideia do tabnews √© justamente ter um "custo" no upvote. Voc√™ gasta tabCoins para votar, ent√£o se um usu√°rio gostou muito de um post e quiser gastar 10 moedas. Est√° 100% no seu direito!

>> Coment√°rio de natanael-b:
> O Medium, por exemplo, n√£o tem downvote e eles permitem upvotes ilimitados
 
A ideia de upvote do medium √© completamente diferente da do TabNews n√£o d√° pra comparar
 
> Voc√™ gasta tabCoins para votar, ent√£o se um usu√°rio gostou muito de um post e quiser gastar 10 moedas. Est√° 100% no seu direito!

O principal problema desse modo de pensar √© que ele ignora o "Efeito Felipe Neto" algu√©m que acumulou 1000 Tab Coins em uma ou mais contas pode descarregar de uma vez s√≥ num post por exemplo, isso pode creditar uma resposta prejudicial a comunidade (exemplo, spam, dissemina√ß√£o de pragas virtuais, informa√ß√£o errada) ou mesmo levar ao limbo um usu√°rio sem que ele viole nada, em outras palavras pode levantar ideias muito erradas e trazer o cancelamento do Twitter pro TabNews o que √© o oposto da plataforma
 
Importante lembrar que TabCoins **n√£o** funcionam como dinheiro, **TabCash** sim, TabCoins √© o poder de incentivar ou punir uma ideia isso s√≥ funciona se o poder de cada conta for nivelado

>> Coment√°rio de natanael-b:
@filipedeschamps o que pensa sobre o assunto? √â algo importante que pode definir a sa√∫de da plataforma

>> Coment√°rio de Rafatcb:
Duplicada: https://github.com/filipedeschamps/tabnews.com.br/issues/752

>> Coment√°rio de Rafatcb:
Tem uma issue mais recente que teve mais aten√ß√£o da comunidade, recebendo algumas sugest√µes de como exibir essa informa√ß√£o: https://github.com/filipedeschamps/tabnews.com.br/issues/1510, recomendo concentrar a discuss√£o l√°.

>> Coment√°rio de aprendendofelipe:
Seguindo a sugest√£o do @Rafatcb, vamos concentrar a discuss√£o na #1510. ü§ù

Vou encerrar essa aqui üòâ
</issue_990_[Feature] - Dei upvotes/downvotes? üòï>

<issue_991_Follow, UnFollow, Notifica√ß√£o>
S√≥ de olhar d√° para notar qu√£o o tabnews realmente √© diferente da internet de "hoje", essa proposta realmente encanta o olhar de qualquer amante da internet, da verdadeira internet.

--- **Notifica√ß√£o** ---

    Mas tem algo que eu me acostumei muito com a internet, e isso √© a notifica√ß√£o. N√£o por e-mail, mas no pr√≥prio site, como aquele <sino> que fica sempre l√° no cabe√ßalho. E quando clica aparece as ultimas postagens das pessoas que voc√™ "Segue" ou mais Visualizar/l√™.
    
    Me bateu uma curiosidade muito grande, se o tabnews vai fazer algo como isso. Um meio do sistema interpretar os assuntos e autores que certo usu√°rio mais visualiza, e ent√£o formar um 'algoritmo' sobre isso, para que ele sempre tenha uma boa recomenda√ß√£o na sua barra de notifica√ß√£o, ou at√© mesmo em uma se√ß√£o a parte.
    
--- **Follow** ---

    Meio que ao incrementar as notifica√ß√µes, eu acredito que algo como o follow poderia existir, ou algo do g√™nero. Eu tamb√©m pensei que pudesse haver um meio de unir o follow com os coins e cashs, meio que para seguir voc√™ gastasse algo, para ser um pouco diferente do padr√£o, e talvez ganhar algo quando receber seguidos. Mas claro, precisaria de um meio de "Segurar" isso, j√° que um mesmo usu√°rio poderia criar varias contas, s√≥ para conseguir seus coins/cash.
    
    Eu realmente adoro essa parte que a internet criou, a parte de "Seguir" e fazer parte dos "conte√∫dos" das pessoas que voc√™ realmente gosta. Realmente acharia muito top algo assim.
    
    J√° que os Ups, que lembram muito o like, j√° est√£o de p√©, realmente seria muito agrad√°vel ter o complemento do Follow E Notif.

--- **Conclus√£o** ---

Vamos juntos evoluir ao maximo essa ideia, a ideia do tabnews, UP!!

>> Coment√°rio de Rafatcb:
S√£o boas sugest√µes. Me parece que podemos concentrar as discuss√µes sobre cada uma individualmente nos seguintes issues:

* https://github.com/filipedeschamps/tabnews.com.br/issues/878
* https://github.com/filipedeschamps/tabnews.com.br/issues/523

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_991_Follow, UnFollow, Notifica√ß√£o>

<issue_993_[FEATURE] Descri√ß√£o no perfil do usu√°rio>
Ser√° muito legal se puder criar uma pequena descri√ß√£o pr√≥pria no perfil, para se apresentar e dizer quais tem√°ticas gosta de discutir. Isso pode vir junto com a sugest√£o de follow!

>> Coment√°rio de otaviolms:
Show, al√©m de poder adicionar por exemplo um link de portfolio ou mesmo perfil do GitHub

>> Coment√°rio de rubensflinco:
Pessoal Pull Request Aberto, aguardando Revis√£o e Merge:
https://github.com/filipedeschamps/tabnews.com.br/pull/1471

>> Coment√°rio de aprendendofelipe:
@braiansmarzaro, obrigado pela sugest√£o! üí™

A descri√ß√£o no perfil dos usu√°rios j√° foi implementada de maneira preliminar no PR #1470.

Ainda faltam ajustes, mas √© melhor centralizar a conversa na issue onde a discuss√£o avan√ßou mais (#1466). Ent√£o vou fechar essa. Combinado? ü§ù
</issue_993_[FEATURE] Descri√ß√£o no perfil do usu√°rio>

<issue_994_Como fa√ßo para contribuir no Tabnews?>
Ol√° gente, estou tentando contribuir com o tabnews no Github para melhorar a dashboards da p√°gina de status, por√©m, quando eu do **npm run dev** aparece o seguinte erro:

```error during connect: this error may indicate that the docker daemon is not running: Get "http://%2F%2F.%2Fpipe%2Fdocker_engine/v1.24/containers/json?all=1&filters=%7B%22label%22%3A%7B%22com.docker.compose.project%3Dinfra%22%3Atrue%7D%7D": open //./pipe/docker_engine: The system cannot find the file specified.```

Como fa√ßo para resolver este erro?

>> Coment√°rio de gustta03:
essa mensagem indica que o servi√ßo do docker n√£o est√° iniciado, verifica o seu docker desktop. ele est√° aberto?

>> Coment√°rio de pietrobs:
Boa tarde! Estava com esse problema agora mesmo.

A √∫nica solu√ß√£o foi desinstalar e instalar o docker novamente, mas dessa vez configurando corretamente o terminal do linux (WSL 2) que a instala√ß√£o sugere!

>> Coment√°rio de Rafatcb:
Como esse issue √© antigo, estou fechando ele por falta de acompanhamento. Para quem ter um problema parecido, confirme se o Docker est√° executando na m√°quina. Lembre-se de ler a [documenta√ß√£o do Docker](https://docs.docker.com/config/daemon/troubleshoot/) para verificar se seu problema est√° l√°.
</issue_994_Como fa√ßo para contribuir no Tabnews?>

<issue_995_[TabCoins] Concentra√ß√£o versus Distribui√ß√£o>
SUGEST√ÉO DE MELHORIA:

Um usu√°rio deveria poder dar apenas 1 upvote ou 1 downvote por publica√ß√£o. Isso for√ßaria usu√°rios com muitas TabCoins a DISTRIBUIR suas TabCoins para muitos bons conte√∫dos diferentes, ao inv√©s de dar a este usu√°rio o poder de CONCENTRAR seus TabCoins para uma √∫nica publica√ß√£o de um √∫nico usu√°rio.

Visto que o TabCoin √© o item de principal valor da plataforma, permitir ao usu√°rio usar todos os seus TabCoins para votar em uma √∫nica publica√ß√£o abre margem para manipula√ß√£o, pois ele pode dar MUITOS downvotes para desfavorecer uma publica√ß√£o, ou super favorecer uma √∫nica publica√ß√£o.

Ou seja: PARA O BEM DE TODA COMUNIDADE, devemos premiar a DISTRIBUI√á√ÉO de recursos, e impedir a transfer√™ncia CONCENTRADA de recursos.

Com concentra√ß√£o: PODER GERA PODER.
Com distribui√ß√£o: PODER GERA PREMIA√á√ÉO DISTRIBU√çDA PERMEANDO TODA A COMUNIDADE.

>> Coment√°rio de coffeeispower:
sinceramente, isso depende da pessoa, porque tabcoins √© como dinheiro, voc√™ gasta como quiser, e quando voc√™ posta alguma coisa √© o equivalente a imprimir dinheiro

>> Coment√°rio de lucas-williams:
Exatamente como mencionado pelo @coffee-is-power , os tabcoins funcionam parecidos com dinheiro. Eu por exemplo tenho 100, mas n√£o gastaria todos eles pra acabar com uma publica√ß√£o! Por√©m, se eu acumular muitos coins, eu poderia dar muitos downvotes em algu√©m e isso n√£o me prejudicaria nos meus coins por exemplo, ent√£o nesse aspecto, seria interessante limitar a quantidade e up/downvotes.

>> Coment√°rio de johnathanmelo:
Exatamente pela TabCoin ser como dinheiro que eu sugeri essa melhoria. 

No mundo real, n√£o temos essa limita√ß√£o nas transf√™ncias de dinheiro, e isso gera uma s√©rie de problemas e desigualdade social, privilegiando os mais ricos.

Como nesse ambiente digital n√≥s podemos controlar as regras, penso que seria uma √≥tima melhoria visando o bem da comunidade e impedindo super usu√°rios de manipular o mecanismo.

>> Coment√°rio de 33gustavo33:
> No mundo real, n√£o temos essa limita√ß√£o nas transf√™ncias de dinheiro, e isso gera uma s√©rie de problemas e desigualdade social, privilegiando os mais ricos.

N√£o vejo muito problema nisso, pois os mais ricos no TabNews seriam as pessoas que produziram **valor concreto** pra comunidade.

Por√©m, eu tamb√©m acho que deveria ter um limite de TabCoins, por√©m n√£o um limite de 1 tabcoin, mas um limite de 5 tabcoins ou algo assim.

>> Coment√°rio de johnathanmelo:
> Por√©m, eu tamb√©m acho que deveria ter um limite de TabCoins, por√©m n√£o um limite de 1 tabcoin, mas um limite de 5 tabcoins ou algo assim.

Concordo 100%. Meu ponto √© que deve existir ALGUM limite nos upvotes e downvotes, para n√£o potencializar o poder dos ricos em TabCoins, e for√ßar eles a distribuir melhor os votos entre outras publica√ß√µes relevantes para a comunidade.

>> Coment√°rio de Rafatcb:
Hoje temos um limite de 3 votos a cada 72 horas. Na √©poca em que esse issue foi criado, a quantidade de votos numa publica√ß√£o era ilimitada.

Apesar disso, esse tipo de situa√ß√£o ainda est√° em discuss√£o, podemos fechar este issue para focar a discuss√£o no issue abaixo:

* https://github.com/filipedeschamps/tabnews.com.br/issues/1166
</issue_995_[TabCoins] Concentra√ß√£o versus Distribui√ß√£o>

<issue_997_[sugest√£o] - √°rea semelhante ao Product Hunt>
Ol√° devs! Essa semana tive uma ideia, e se o tabnews possibilitasse a divulga√ß√£o de projetos assim como o Product Hunt.
Na minha vis√£o seria muito interessante uma comunidade brasileira para validar novos produtos.

>> Coment√°rio de filipedeschamps:
Acho √≥timo e poderia aproveitar o prefixo Pitch e filtrar por isso, tem **muita coisa legal j√°**: https://www.google.com/search?q=site%3Atabnews.com.br+pitch&oq=site%3Atabnews.com.br+pitch&aqs=chrome..69i57j69i58.5531j1j7&sourceid=chrome&ie=UTF-8

>> Coment√°rio de Rafatcb:
Kleidimilson, obrigado pela sugest√£o!

Acredito que a implementa√ß√£o de tags (https://github.com/filipedeschamps/tabnews.com.br/issues/742), permitindo listar os conte√∫dos delas, resolveria esse problema. Bastaria existir e usar a tag `Pitch`, como o Filipe mencionou. Por esse motivo, estou fechando o issue para concentrarmos a discuss√£o no outro.

Se eu entendi errado, por favor me corrija e reabrimos o issue se necess√°rio.
</issue_997_[sugest√£o] - √°rea semelhante ao Product Hunt>

<issue_998_[FEATURE] Exibi√ß√£o de mensagem de instabilidade/manuten√ß√£o>
Minha sugest√£o √© exibir de forma fixa mensagens de instabilidade ou manuten√ß√£o programada na p√°gina do TabNews. Fica melhor assim ao inv√©s de cadastrar um post, pois acaba se perdendo na listagem e as pessoas n√£o visualizam. 

Fica a dica :D

>> Coment√°rio de Rafatcb:
Apesar desse tipo de mensagem s√≥ ter sido usada assim que o TabNews foi lan√ßado (pelo o que me lembro), existe um issue sobre o assunto:

* https://github.com/filipedeschamps/tabnews.com.br/issues/1181

Acho que podemos fechar este e concentrar a discuss√£o l√°.

>> Coment√°rio de aprendendofelipe:
@brendo10x, obrigado pela sugest√£o! üí™

Isso ainda est√° pendente, mas podemos concentrar na #1181, onde o Filipe j√° inseriu mais detalhes ü§ù
</issue_998_[FEATURE] Exibi√ß√£o de mensagem de instabilidade/manuten√ß√£o>

<issue_999_[SUGEST√ÉO] Aba de sugest√µes para ajudar com o spam na √°rea principal de tabs.>
Boa noite!

Passei praticamente o dia todo lendo tabs hoje. Notei que boa parte das publica√ß√µes s√£o sugest√µes que deveriam estar aqui no reposit√≥rio.

Publica√ß√µes no estilo: "acho que poderiam acrescentar um x em y lugar..."

Na minha opini√£o, al√©m de afogarem as outras publica√ß√µes, n√£o oferecem valor concreto ao usu√°rio, _e sim ao projeto_ como plataforma. Tenho certeza que todas as sugest√µes s√£o bem-vindas, mas ser√° que n√£o vale a pena criarmos uma se√ß√£o separada apenas para isso? Um "Sugest√µes" ao lado de recentes, por exemplo.

Estou chegando agora! Se isso j√° tiver sido debatido por voc√™s aqui, pe√ßo que por favor fechem o issue.

Se for para frente, me disponibilizo para ajudar na implementa√ß√£o.

Obrigado!

>> Coment√°rio de gu-maia:
Nesse mesmo sentido, caso implementado, seria interessante implementar tamb√©m uma ferramenta para que moderadores possam mover o conte√∫do para a aba correta.

>> Coment√°rio de Rafatcb:
Geralmente, quando h√° sugest√µes, os usu√°rios s√£o direcionados para o reposit√≥rio, pois fica mais f√°cil de organizar e ter um hist√≥rico sobre tudo o que foi discutido, al√©m de men√ß√µes diretas ao c√≥digo e sugest√µes de implementa√ß√£o.

No lan√ßamento do TabNews, realmente muitas publica√ß√µes eram sobre sugest√µes por dois motivos: 

1. Surgiram muitas pessoas interessadas no projeto, querendo mostrar como ele poderia melhorar.
2. O projeto era muito novo, apenas com o "b√°sico" funcionando, ent√£o muitas sugest√µes j√° estavam no planejamento como _dark mode_, busca etc.

Tendo em vista o comportamento do TabNews hoje, onde √© relativamente raro ver uma sugest√£o, acho que podemos fechar este issue.

>> Coment√°rio de aprendendofelipe:
@gu-maia obrigado pela sugest√£o! üí™

Concordo com o @Rafatcb, ent√£o vou fechar a issue por enquanto ü§ù
</issue_999_[SUGEST√ÉO] Aba de sugest√µes para ajudar com o spam na √°rea principal de tabs.>

<issue_1000_[SUGEST√ÉO] Notifica√ß√µes gerais>
No momento, quando voc√™ recebe um coment√°rio num post ou algu√©m responde algum coment√°rio seu, voc√™ n√£o tem visibilidade disso, s√≥ tomando conhecimento caso verifique periodicamente. Isso gera um atrito enorme caso um usu√°rio interaja em diversos posts diferentes, tendo que verificar todos eles pra ver se existe alguma atividade nova.

>> Coment√°rio de gabrielsozinho:
@friaca hoje voc√™ √© notificado no email sobre novos coment√°rios nos seus conte√∫dos.

>> Coment√°rio de friaca:
Sim, mas n√£o concorda que notificar no e-mail n√£o √© t√£o pr√°tico quanto na pr√≥pria plataforma? E se eu n√£o estiver logado no e-mail, ou n√£o tiver o costume de ficar verificando meu e-mail, ou N outras possibilidades. Notifica√ß√£o na pr√≥pria plataforma √© muito mais c√¥modo e deixa a UX bem melhor.

>> Coment√°rio de gabrielsozinho:
Concordo totalmente! Pensei que voc√™ n√£o sabia que era notificado no e-mail, por isso aquele coment√°rio. üòÖ

>> Coment√°rio de GabrielVictorF:
Acabei de postar sobre isso na plataforma e quando vim aqui j√° tinha conte√∫do sobre isso üòÖ, que bom que essa ideia √© apoiada.

>> Coment√°rio de Rafatcb:
Tem v√°rios issues sobre essa sugest√£o de notifica√ß√£o no reposit√≥rio, mas n√£o me lembro de ter visto uma com discuss√£o substancial ou sugest√µes de implementa√ß√£o. Acho que podemos concentrar a discuss√£o aqui:

* https://github.com/filipedeschamps/tabnews.com.br/issues/878

@aprendendofelipe se voc√™ souber algum issue melhor, por favor, me corrija.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1000_[SUGEST√ÉO] Notifica√ß√µes gerais>

<issue_1002_Contador de votos continua exibido ap√≥s a exclus√£o da publica√ß√£o>
Ap√≥s a dele√ß√£o da publica√ß√£o o contador de votos e o bot√£o de responder continua vis√≠vel

![image](https://user-images.githubusercontent.com/59406899/204168040-e5f6ba84-6297-435d-8ab1-adfdc65360cd.png)

MacOs Ventura
Google Chrome Vers√£o 107.0.5304.110
</issue_1002_Contador de votos continua exibido ap√≥s a exclus√£o da publica√ß√£o>

<issue_1003_Seguran√ßa: Checagem de IP's Cloudflare>
Notei que foi criado um arquivo em models/ip.js com o objetivo de recuperar o IP do cliente. O header **cf-connecting-ip** permite h√° qualquer usu√°rio mal intencionado definir qual IP ele quer que o sistema interprete (caso tenha o IP real, por tr√°s do cloudflare).

O ideal seria antes de olhar para o **cf-connecting-ip** checar se o IP da request realmente est√° dentro dos blocos do Cloudflare. Talvez a aplica√ß√£o possa fazer um request para obter os blocos de IP's do cloudflare quando ela sobre de forma autom√°tica.

Para isso pode utilizar os endere√ßos abaixo:

- Blocos IPv4: https://www.cloudflare.com/ips-v4
- Blocos IPv6: https://www.cloudflare.com/ips-v6

Durante a semana, tentarei realizar a implementa√ß√£o! Por√©m caso algu√©m queira tentar, fiquem √† vontade.

>> Coment√°rio de filipedeschamps:
@hiagodotme show de bola! O `cf-connecting-ip` n√£o representa o IP real deles? Considerando que todas as requests est√£o passando pelo Proxy deles, eu especulei que este era um cabe√ßalho que seria injetado por eles, independente se o `client` enviar isso como cabe√ßalho, exatamente como o `x-forwarded-for` quando √© enviado por um servidor que voc√™ confia.

De qualquer forma, **por favor** nos ajude a testar este recurso meu caro e muito obrigado por criar a issue ü§ù

>> Coment√°rio de hiagodotme:
@filipedeschamps exatamente o cloudflare vai injetar e descartar caso algu√©m envie. O problema seria algu√©m descobrir os IPs da vercel e chamar sem passar pelos proxies da Cloudflare, a√≠ a pessoa conseguiria manipular o seu IP.

A proposta √© apenas criar uma regra pra aceitar o header desde que o ip que esteja fazendo o request seja de um bloco v√°lido da cloudflare. Caso contr√°rio, ignore o cf-connecting-ip e recupera o ip real da conex√£o.

Durante a semana penso em como fazer, por√©m n√£o √© um problema t√£o grande uma vez que pra se aproveitarem disso a pessoa precisaria saber o IP p√∫blico de sua aplica√ß√£o na Vercel. Tem um outro esquema do cloudflare que a aplica√ß√£o s√≥ aceita conversar com os servidores deles a√≠ dispensaria essa tratativa..

>> Coment√°rio de filipedeschamps:
Show!!! Faz total sentido ü§ù üëç

>> Coment√°rio de aprendendofelipe:
Fala @hiagodotme, tudo certo? Obrigado pelas dicas! üí™

S√≥ hoje cheguei nessa issue, mas acredito que tudo relacionado j√° foi resolvido, conforme relatado em #1150.

Ent√£o vou fech√°-la, mas qualquer coisa podemos reabrir. ü§ù
</issue_1003_Seguran√ßa: Checagem de IP's Cloudflare>

<issue_1004_[DOCS] Open Source>
Ol√°, tudo bem?

Tomei conhecimento deste projeto ontem e fiquei bem interessado no projeto e em contribuir com ele. Quando fiz o meu fork, j√° de imediato notei a falta de alguns arquivos que podem ser interessantes para quem quiser contribuir com o projeto e n√£o tenha tanta experi√™ncia no mundo OSS, como por exemplo um CONTRIBUTING.md.

Al√©m disso, creio que seja interessante criar uma padroniza√ß√£o de abertura de ISSUES, sejam elas para report de um BUG ou solicita√ß√£o de uma feature (FEATURE REQUEST).

>> Coment√°rio de yuric18:
Ah, depois pretendo criar l√° no tabnews.com.br ensinando o processo ;)

>> Coment√°rio de aprendendofelipe:
@yuric18, obrigado pela sugest√£o! üí™

Sobre o `CONTRIBUTING.md`, vamos centralizar o debate na #605.

Sobre `ISSUE_TEMPLATE`, vamos centralizar na #902.

Como essas duas s√£o mais antigas, vou fechar essa aqui como duplicada. ü§ù
</issue_1004_[DOCS] Open Source>

<issue_1006_[Sugest√£o] Redirecionar os hiperlinks para uma nova aba do Navegador>
Ol√°, boa noite, tudo j√≥ia?

Percebi que ao clicar em um hiperlink, est√° sendo carregado na pagina atual, e n√£o criando uma nova pagina em branco com o conte√∫do do link referenciado.

Seria bem interessante que o link que for aberto, abra em outra aba do navegador, com isso n√£o perdemos o progresso da leitura naquele momento.

>> Coment√°rio de efeeseao:
Posso trabalhar nessa funcionalidade.

>> Coment√°rio de giovaniif:
Cara isso seria muito util mesmo, √© bem ruim perder a refer√™ncia de onde voc√™ estava, tanto pra quem fez o tab quanto pra quem est√° lendo. üöÄ

>> Coment√°rio de Rafatcb:
Temos um issue aberto sobre isso (https://github.com/filipedeschamps/tabnews.com.br/issues/477) com um coment√°rio do Filipe agregando pra discuss√£o: https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074

>> Coment√°rio de aprendendofelipe:
Vamos seguir com a sugest√£o do @Rafatcb e centralizar a discuss√£o na #477 üëç
</issue_1006_[Sugest√£o] Redirecionar os hiperlinks para uma nova aba do Navegador>

<issue_1007_[FEATURE] Lista de posts j√° lidos>
Uma sugest√£o seria em criar uma p√°gina que trouxesse uma lista dos posts j√° lidos, para que voc√™ n√£o tenha necessariamente que interagir ou salvar para ler mais tarde, mas quando precisar relembrar ou revisitar algum conte√∫do, ser√° muito mais f√°cil de buscar.

>> Coment√°rio de Rafatcb:
N√£o me parece que ter uma lista de posts j√° lidos ajudaria a revisitar um conte√∫do, porque pelo menos no meu caso, acabo visitando praticamente todas as publica√ß√µes. Apesar disso, acho que essa sugest√£o pode ser feita no seguinte issue:

* https://github.com/filipedeschamps/tabnews.com.br/issues/518

Atualmente a diferencia√ß√£o de publica√ß√£o √© feita por meio do `:visited`, ou seja, local no navegador, mas me parece que ainda existe a possibilidade de implementar isso de forma "por conta", o que permitiria ter uma p√°gina com a lista de conte√∫dos visitados.

Acredito que a melhor solu√ß√£o para esse tipo de situa√ß√£o √© ter uma lista de conte√∫dos mesmo:

* https://github.com/filipedeschamps/tabnews.com.br/issues/645

Faz sentido fechar este issue para concentrar nos outros?

>> Coment√°rio de aprendendofelipe:
@otaviolms, obrigado pela sugest√£o! üí™

Concordo com o @Rafatcb que √© melhor concentrarmos nas outras issues. üëç

Vou fechar essa aqui ü§ù
</issue_1007_[FEATURE] Lista de posts j√° lidos>

<issue_1008_[Sugest√£o] Exibir anima√ß√£o de up / downvote imediatamente.>
A implementa√ß√£o atual deixa sensa√ß√£o que a p√°gina √© "pesada/travada" o que acaba deixando a sensa√ß√£o menos prazerosa. 

https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/components/TabCoinButtons/index.js#L66

(aproveitar e dar um refactoring nesse componente por que parece uma cama de gato)

>> Coment√°rio de Rafatcb:
N√£o sei se o melhor √© "fingir que deu certo", porque a l√≥gica para tentar novamente depois (caso d√™ errado) seria complexa, afinal, o usu√°rio pode n√£o ter mais TabCoins dispon√≠veis.

Eu cheguei a usar o TabNews na estrada e, ao clicar no voto positivo, n√£o ter nenhum feedback realmente me atrapalhou, porque fiquei clicando mais vezes achando que n√£o estava funcionando. Para resolver o meu problema, acho que simplesmente melhorar a visibilidade do estado de "desabilitado" no up/down j√° seria o suficiente. No Desktop consigo ver pelo cursor, mas no mobile n√£o.

Tanto no modo claro quanto no modo escuro n√£o est√° muito f√°cil de distinguir.
</issue_1008_[Sugest√£o] Exibir anima√ß√£o de up / downvote imediatamente.>

<issue_1009_Search>
Sobre a implementa√ß√£o de busca, quero saber primeiramente aos contribuintes no c√≥digo, se **implementa√ß√£o de busca** j√° foi requisitada aqui. Do contr√°rio n√£o darei **PR** duplicado aqui. Avise me se j√° h√°.

>> Coment√°rio de avoguga:
J√° foi requisitada sim fera, da uma olhada em:

#791 e #441
</issue_1009_Search>

<issue_1010_[Sugest√£o] Ter um player de video para reproduzir>
Ter um player de videos para reproduzir conteudo do YouTube ou outras plataformas. e tambem para por gifs do giphy
</issue_1010_[Sugest√£o] Ter um player de video para reproduzir>

<issue_1011_[Sugest√£o] Tabs colaborativos>
O Tabnews √© uma plataforma colaborativa sensacional com a possibilidade das mais diversas implementa√ß√µes, pensando nisso, gostaria de deixar aqui uma sugest√£o de futuramente incrementar na plataforma o recurso de criar "tabs colaborativos", onde o autor de um determinado post teria a possibilidade de receber incrementos (como se fosse um "git push") de outros colaboradores ao post oficial, no qual, para que uma altera√ß√£o pudesses ser aplicada, ela teria que ser aprovada pelo dono do tab em um primeiro momento.
Sei que √© um recurso um pouco mais avan√ßado, mas que representaria muito bem a proposta que a plataforma veio trazer üòÅ

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Lucas! Tem dois issues que v√£o por caminhos diferentes mas parecem atingir este, que √© um pouco mais gen√©rico:

* https://github.com/filipedeschamps/tabnews.com.br/issues/965
* https://github.com/filipedeschamps/tabnews.com.br/issues/714

Estou fechando este issue para concentrar a discuss√£o nos outros, que s√£o mais espec√≠ficos.
</issue_1011_[Sugest√£o] Tabs colaborativos>

<issue_1013_[Sugest√£o] Cadastrar o TabNews como criador verificado no Brave para possibilitar a doa√ß√£o ao site e aos publicadores de conte√∫do>
O navegador Brave possui um sistema de recompensa com Bat, uma criptomoeda. Pode ser interessante a verifica√ß√£o para permitir o uso de doa√ß√£o no site. Vejo que seria uma vantagem sem efeitos colaterais.

>> Coment√°rio de Rafatcb:
Eu acho que o certo n√£o √© cadastrar o TabNews como um criador, porque o conte√∫do l√° prov√©m dos usu√°rios. Provavelmente deveria funcionar como no GitHub, onde √© poss√≠vel doar diretamente para os usu√°rios:

![Doa√ß√£o para o Filipe Deschamps pelo GitHub](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/f565f893-10ae-4634-906e-b94d8b25673c)

Eu fui criar um cadastro como _creator_ para testar como funciona, mas me parece que s√≥ √© poss√≠vel em alguns sites espec√≠ficos:

![Site pr√≥prio, YouTube, Twitch, Twitter, Vimeo e Reddit](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/97810e8b-708c-4b34-b30c-1fa755d55345)

Dito isso, n√£o sei como funciona no GitHub e n√£o me parece poss√≠vel habilitar de forma "justa" no TabNews.

>> Coment√°rio de Rafatcb:
Como ningu√©m colaborou no assunto em mais de um ano, e minha investiga√ß√£o ficou sem respostas o longo dessas tr√™s semanas, estou fechando o issue para organizar o reposit√≥rio.

Caso algu√©m encontre uma informa√ß√£o adicional ou o Brave mude o funcionamento e permita que o TabNews libere a doa√ß√£o de BAT para os usu√°rios, podem comentar aqui com informa√ß√µes que reabrimos o issue.

Obrigado pela sugest√£o, Braian!
</issue_1013_[Sugest√£o] Cadastrar o TabNews como criador verificado no Brave para possibilitar a doa√ß√£o ao site e aos publicadores de conte√∫do>

<issue_1015_Proposta de melhorias para TabNews>
[Proposta de melhorias para TabNews](https://www.tabnews.com.br/MatheusComino/proposta-de-melorias-para-tabnews)

>> Coment√°rio de Rafatcb:
O lado positivo de ter as coisas no GitHub √© o hist√≥rico, mas infelizmente essa Issue aponta para uma publica√ß√£o removida no TabNews.

Visando diminuir a quantidade de issues abertos no reposit√≥rio, recomendo fechar essa.

@aprendendofelipe

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb, muito obrigado pela ajuda na organiza√ß√£o das issues! üí™üí™üí™

Principalmente nas semanas pr√≥ximas ao lan√ßamento do TabNews o volume de issues foi muito grande e, infelizmente, muitas ficaram sem a merecida aten√ß√£o.

Fechando... ü§ù
</issue_1015_Proposta de melhorias para TabNews>

<issue_1016_Categoriza√ß√£o de publica√ß√µes e Filtros de publica√ß√£o.>
Ol√°! Seria interessante ter a possibilidade de adicionar tags nas publica√ß√µes, podendo ent√£o categoriza a publica√ß√£o com uma ou v√°rias categorias, e ter um filtro em que pudesse filtrar quais publica√ß√£o eu quero ver no momento.

>> Coment√°rio de ceelsoin:
@LucasBispoMenezes  eu at√© iria al√©m, eu acho que a estrutura que temos de posts e da pr√≥pria plataforma combina muito bem com o modelo de subreddits da plataforma reddit, claro a gente poderia encontrar a nossa pr√≥pria identidade pra isso, mas acho um modelo muito massa

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o e foi feita repetidas vezes, ent√£o √© realmente desejada pela comunidade. Dito isso, acho melhor concentrarmos a discuss√£o aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/742. A issue j√° tem alguns coment√°rios e sugest√µes de implementa√ß√£o.

>> Coment√°rio de aprendendofelipe:
Acatando a sugest√£o do @Rafatcb, vamos centralizar na #742. üëç

Fechando essa aqui... ü§ù
</issue_1016_Categoriza√ß√£o de publica√ß√µes e Filtros de publica√ß√£o.>

<issue_1017_[FEATURE] TabNews Challenger>
Como descrevi no `tab` "Desafios para todos!", seria √≥timo uma √°rea de desafios.

>> Coment√°rio de JiroRauwers:
Coloca o link do `tab`.

>> Coment√°rio de decaidenza:
https://www.tabnews.com.br/DecaiDenza/desafios-para-todos
Esqueci de colocar. Espero ajudar ainda mais nesse quesito de desafios.

>> Coment√°rio de Rafatcb:
Hoje um usu√°rio pode criar, por conta pr√≥pria, uma publica√ß√£o que envolva algum tipo de desafio. No meu ponto de vista, algo mais elaborado e espec√≠fico demandaria muito esfor√ßo por um retorno pequeno, ao menos hoje.

Seria bom ter outras opini√µes.

>> Coment√°rio de aprendendofelipe:
Me parece algo que seria resolvido com as tags (#742), n√£o √©?

Vamos concentrar a discuss√£o por l√°, at√© porque aqui n√£o houve muito engajamento com a ideia. ü§ù
</issue_1017_[FEATURE] TabNews Challenger>

<issue_1019_Antivirus detecta PUP ao abrir o tabnews em qualquer browser>
Por mais que possa ser um falso positivo, um warning de PUP ao acessar o tabnews.com.br pega mal pra caramba.
Para reproduzir o problema basta ter instalado algum antivirus que fa√ßa este tipo de detec√ß√£o e acessar o tabnews.com.br

>> Coment√°rio de Jeiel0rbit:
Deschamps n√£o se responsabiliza por isso. Esse relat√≥rio deve ser feito ao antiv√≠rus instalado. Procure saber ou acompanhar mais a reputa√ß√£o do seu antiv√≠rus. Provavelmente um falso-positivo como bem disseste.

Saiba mais sobre PUP: https://www.avast.com/pt-br/c-what-is-pup#topic-2

√â poss√≠vel que o seu sistema j√° esteja infectado, mas n√£o pelo Tabnews.

>> Coment√°rio de coffeeispower:
Windows be like:
</issue_1019_Antivirus detecta PUP ao abrir o tabnews em qualquer browser>

<issue_1021_[FEATURE] Implementa√ß√£o de dados estruturados>
# Contexto

O projeto iniciou sem adicionar a estrutura de dados para melhorar as pesquisas org√¢nicas dos buscadores.
https://search.google.com/test/rich-results/result?id=H-5sN2csaaBrh4AK-e10_A

O recomendado √© adicionar os seguintes dados estruturados por p√°gina:
Home: 
https://schema.org/Organization
https://schema.org/WebSite
https://schema.org/ItemList

Exemplo:
~~~html
<script  type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://www.tecmundo.com.br/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://www.tecmundo.com.br/busca?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
</script>

<<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "ItemList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "name": "Twitter: roubo de dados de 5,4 mi de usu√°rios teve v√°rios hackers ",
        "position": 1,
        "url": "https://www.tecmundo.com.br/seguranca/255045-twitter-roubo-dados-5-4-mi-de-usuarios-teve-varios-hackers.htm"
      },
      {
        "@type": "ListItem",
        "name": "Chrono Trigger recebe linda homenagem em 2.5D feita por f√£s; confira!",
        "position": 2,
        "url": "https://www.tecmundo.com.br/voxel/255038-chrono-trigger-recebe-linda-homenagem-2-5d-feita-fas-confira.htm"
      },
      {
        "@type": "ListItem",
        "name": "O Urso √© uma met√°fora improv√°vel sobre luto e trauma (cr√≠tica)",
        "position": 3,
        "url": "https://www.tecmundo.com.br/minha-serie/255051-urso-metafora-improvavel-luto-trauma-critica.htm"
      },
      {
        "@type": "ListItem",
        "name": "A√ß√µes da Apple caem ap√≥s problemas nas f√°bricas de iPhone",
        "position": 4,
        "url": "https://www.tecmundo.com.br/mercado/255082-acoes-apple-caem-problemas-fabricas-iphone.htm"
      },
      {
        "@type": "ListItem",
        "name": "Black Friday 2022: Mercado Livre tem crescimento de 19% nas vendas",
        "position": 5,
        "url": "https://www.tecmundo.com.br/mercado/255088-black-friday-2022-mercado-livre-registra-crescimento-19-vendas.htm"
      },
      {
        "@type": "ListItem",
        "name": "Fal√™ncia da FTX ser√° contada em miniss√©rie do Amazon Prime Video",
        "position": 6,
        "url": "https://www.tecmundo.com.br/mercado/255041-falencia-ftx-contada-minisserie-amazon-prime-video.htm"
      },
      {
        "@type": "ListItem",
        "name": "Pr√≥ximos jogos da DC devem se conectar aos filmes e s√©ries de TV",
        "position": 7,
        "url": "https://www.tecmundo.com.br/voxel/255071-proximos-jogos-dc-devem-conectar-filmes-series-tv.htm"
      },
      {
        "@type": "ListItem",
        "name": "Maior vulc√£o ativo do mundo entra em erup√ß√£o no Hava√≠ ap√≥s 38 anos",
        "position": 8,
        "url": "https://www.tecmundo.com.br/ciencia/255085-maior-vulcao-ativo-mundo-entra-erupcao-havai-38-anos.htm"
      },
      {
        "@type": "ListItem",
        "name": "Cyber Monday da Alura com 20% off na matr√≠cula",
        "position": 9,
        "url": "https://www.tecmundo.com.br/produto/255084-cyber-monday-alura-20-off-matricula.htm"
      },
      {
        "@type": "ListItem",
        "name": "Black Friday 2022: veja produtos mais vendidos na Amazon",
        "position": 10,
        "url": "https://www.tecmundo.com.br/mercado/255081-amazon-divulga-produtos-vendidos-black-friday-2022.htm"
      }
    ]
  }
  </script>


~~~



Postagem:
https://schema.org/NewsArticle
https://schema.org/WebSite

Exemplo:
~~~html
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://www.tecmundo.com.br/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://www.tecmundo.com.br/busca?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
</script>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": "Twitter: roubo de dados de 5,4 mi de usu√°rios teve v√°rios hackers ",
    "publisher": {
      "@type": "Organization",
      "name": "TecMundo",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.tecmundo.com.br/desktop/assets/static/publisher-logo.png",
        "height": 60,
        "width": 600
      }
    },
    "author": { "@type": "Person", "name": "Jorge Marin" },
    "articleBody": "Uma viola√ß√£o de dados feita atrav√©s de uma vulnerabilidade do Twitter que permitiu a venda de 5,4 milh√µes de dados de usu√°rios da rede social, anunciada em julho passado, pode ter sido bem pior do que o oficialmente relatado. O 9to5Mac teve acesso a evid√™ncias de que o mesmo ataque foi explorado por diversos hackers, que venderam os dados na dark web.A vulnerabilidade ‚Äì que permitia que qualquer pessoa inserisse um n√∫mero de telefone ou endere√ßo de email e descobrisse na hora o twitterID associado ‚Äì foi descrita pela primeira vez em janeiro deste ano pela plataforma HackerOne. O ID, um n√∫mero de uso interno do Twitter, pode ser facilmente convertido em um identificador do usu√°rio da rede social.Com essas informa√ß√µes, qualquer indiv√≠duo mal-intencionado seria capaz de construir facilmente um banco de dados, combinando o twitterID com endere√ßos de email e n√∫meros de telefone. Em agosto, o Twitter admitiu a vulnerabilidade, mas disse apenas que ela havia sido corrigida, omitindo sua explora√ß√£o.&nbsp;O que h√° de novo sobre a viola√ß√£o de dados no Twitter?A configura√ß√£o explorada pelos hackers. (Fonte: Twitter/captura de tela.)Na quinta-feira (24), houve sugest√µes no Twitter de que os mesmos dados pessoais expostos desde o in√≠cio do ano foram na verdade&nbsp;acessados por v√°rios hackers e n√£o apenas um como se imaginava.&nbsp;O site comprovou isso, ao ver um conjunto de dados com as mesmas informa√ß√µes, por√©m em um formato diferente, revelado por um pesquisador de seguran√ßa que garantiu se tratar ‚Äúdefinitivamente um agente de amea√ßa diferente‚Äù.&nbsp;A estimativa √© de que esses atores de amea√ßas tenham conseguido baixar cerca de 500 mil registros por hora, vendendo os bancos de dados por cerca de US$ 5 mil (R$ 27 mil) na dark web. O especialista de seguran√ßa que tuitou essa den√∫ncia teve sua conta suspensa. O 9to5Mac tentou esclarecer o assunto diretamente com o Twitter, mas a equipe de rela√ß√µes com a m√≠dia foi demitida por Elon Musk.",
    "image": {
      "@type": "ImageObject",
      "url": "https://tm.ibxk.com.br/2022/11/28/28084939172065.jpg?ims=1200x675"
    },
    "datePublished": "2022-11-28T18:30:00",
    "dateModified": "2022-11-28T16:19:00",
    "articleSection": ["Seguran√ßa", "Twitter", "Redes sociais"],
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://www.tecmundo.com.br/seguranca/255045-twitter-roubo-dados-5-4-mi-de-usuarios-teve-varios-hackers.htm"
    }
  }
</script>

~~~
---

>> Coment√°rio de mrfelipelima:
Fala @emerson-oliveira!
Eu realmente acredito que essa implementa√ß√£o pode ser √∫til! Dei uma pesquisada aqui nas Issues do repo e vi que o @filipedeschamps e o @rodrigoKulb j√° discutiram isso no passado na issue #393, mas no contexto das AMPs. E naquele momento resolveram n√£o implementar pois o Google n√£o iria mais dar aten√ß√£o, s√≥ que para as AMPs.

Hoje olhando a postagem [Desempenho no Google Discover](https://www.tabnews.com.br/FelipeBarso/tabnews-desempenho-no-google-discover) no pr√≥prio TabNews, comentei a mesma coisa sobre o uso dados estruturados. Ainda acho que pode ser v√°lido para melhorar o desempenho do site nas pesquisas, n√£o apenas do Google, visto que outros motores tamb√©m utilizam dessa marca√ß√£o.

>> Coment√°rio de Rafatcb:
Pessoal, por enquanto essa altera√ß√£o est√° "em espera", conforme comentado em https://github.com/filipedeschamps/tabnews.com.br/pull/1785#pullrequestreview-2266713876. Quem entender do assunto, pode ver o que foi feito no PR para comentar se faz sentido ou n√£o. Eu deixei meus coment√°rios no pr√≥prio PR (https://github.com/filipedeschamps/tabnews.com.br/pull/1785).

Destaco que havia considerado usar as seguintes estruturas:

- [BreadcrumbList](https://developers.google.com/search/docs/appearance/structured-data/breadcrumb)
- [DiscussionForumPosting](https://developers.google.com/search/docs/appearance/structured-data/discussion-forum)
- [Organization](https://developers.google.com/search/docs/appearance/structured-data/organization) (n√£o tenho certeza se √© adequado)
- [ProfilePage](https://developers.google.com/search/docs/appearance/structured-data/profile-page)

E que n√£o descobri a forma correta de usar o `@id` ([_node identifier_](https://www.w3.org/TR/2014/REC-json-ld-20140116/#node-identifiers)).
</issue_1021_[FEATURE] Implementa√ß√£o de dados estruturados>

<issue_1024_undefined:undefined bug>
Oi, bug simples, mas n sei como arrumar, mas basicamente, fassa um post e tente da um upvote em seu proprio post, ele alerta undefined undefined,

>> Coment√°rio de filipedeschamps:
@PanDabStudios voc√™ poderia testar novamente? Est√°vamos passando por uma instabilidade dado a uma manuten√ß√£o que fizemos ü§ù

>> Coment√°rio de yunger7:
Tenho quase certeza que isso ocorreu devido a queda mencionada em #1025, fui editar um conte√∫do e tamb√©m apareceu `Undefined undefined:undefined`. Logo em seguida dei um refresh e o TabNews estava fora do ar.
</issue_1024_undefined:undefined bug>

<issue_1025_TabNews est√° fora do ar?>
<img width="1440" alt="Untitled" src="https://user-images.githubusercontent.com/47532063/204401488-cc14e0ce-5d82-4c17-83f6-7fb1b4c3071c.png">

>> Coment√°rio de filipedeschamps:
Estava fora do ar sim! Fizemos uma manuten√ß√£o aqui do nosso lado, mas o acesso j√° deve ter sido reestabelecido. Se puder confirmar, seria show! E obrigado por abrir essa issue ü§ù

>> Coment√°rio de brunozilio:
Voltou, vou fechar a issue aqui. Obrigado @filipedeschamps!
</issue_1025_TabNews est√° fora do ar?>

<issue_1026_Sistema de notifica√ß√µes / Sistema de perguntas separadas>
<h1>Voc√™s poderiam adicionar um sistema de notifica√ß√µes, por ex.</h1>

# Que tipo de notifica√ß√µes?
- Simples, sempre q voc√™ for respondido, ser√° enviado uma notifica√ß√£o.
- Coisas a mais que poderiam ser adicionadas nesse sistema:
- - Sons de notifica√ß√£o assim como o do Whatsapp ( em tempo real )

<h1>O sistema de perguntas poderia ser como o do Stackoverflow</h1>

# Perguntas
 - Algo simples, assim como os posts normais, por√©m dedicado totalmente a perguntas e repostas.
 - Conter um campo de busca que procura pelos argumentos de t√≠tulo de cada postagem, dando prefer√™ncia aos  _**Mais Respondidos**_
 - Motivo:
 - - Eu fiz uma publica√ß√£o recomendando meu m√≥dulo NPM, e l√° mesmo respondi com uma pergunta, provavelmente o usu√°rio n√£o ver√° e n√£o teremos a p√°gina dedicada a algo de perguntas e repostas. Traduzindo, meu post se perdeu na vastid√£o de publica√ß√µes.
 
<div align="center">
  <img src="https://media.discordapp.net/attachments/1045802171146453124/1046940839760375908/unknown.png?width=783&height=498">
</div>

>> Coment√°rio de hanufu:
S√≥ o fato de ter um bot√£o onde lista as notifica√ß√µes de coment√°rios etc, j√° ajudaria bastante, eu mesmo tenho que ficar verificando o e-mail para saber se algu√©m comentou nos meus posts.

>> Coment√°rio de shuhikari:
Al√©m de dar um up, vou coletar os outros t√≥picos que tamb√©m falam de notifica√ß√µes. 

Poder√≠amos montar um dossi√™ numa discuss√£o √∫nica, acho a featura ultra v√°lida.

Outros locais mencionados:
#1000 #738 #920 #1116 


@filipedeschamps j√° tem algum tipo de roadmap referente a essa funcionalidade ou ainda est√° em aberto a discuss√£o?

>> Coment√°rio de Rafatcb:
Como j√° temos o issue https://github.com/filipedeschamps/tabnews.com.br/issues/878 falando sobre notifica√ß√£o dentro da plataforma, podemos editar este para ser referente apenas √† parte de "sistema de perguntas"?

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Pelos menos nas primeiras vers√µes, a quest√£o de perguntas pode ser uma tag espec√≠fica, combinada com tags do assunto sobre a d√∫vida.

Por organiza√ß√£o, vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1026_Sistema de notifica√ß√µes / Sistema de perguntas separadas>

<issue_1029_Error de l√≥gica ou bem pensado?>
Atualmente estou com -224 tabCoins. Veja minhas publica√ß√µes e ver√°s que n√£o h√° "downvote". Post em que eu apaguei, foi por pedido de Deschamps, mais outros por n√£o ter percebido a viola√ß√£o das regras. Desde ent√£o estou andando nas linhas dos termos de uso, mas est√° muito dificultoso para mim. Seria bug, error l√≥gico ou bem pensado ao fazer isso?

![Screenshot_20221129-144750.png](https://user-images.githubusercontent.com/72875404/204606034-b586426d-71bd-48fa-bb10-fd7aa54bcf38.png)

User: https://www.tabnews.com.br/Jetrom


Se foi bem pensado, fecharei "minha boca". (Paci√™ncia).
</issue_1029_Error de l√≥gica ou bem pensado?>

<issue_1030_Nome de usu√°rios mesmo que o de paginas>
Atualmente est√° permitindo que o usu√°rio tenha nome de paginas do sistema (recentes, contato) e quando vai acessar a pagina do usu√°rio vai pro perfil

Images do ocorrido:
![image](https://user-images.githubusercontent.com/4248081/204617725-4f1e3f7a-a348-48ff-869d-a28b5999fe5f.png)


![image](https://user-images.githubusercontent.com/65042811/204616838-5e37cb67-2379-494c-819a-ff273ac88e48.png)

>> Coment√°rio de filipedeschamps:
`contato` n√£o deveria deixar, pois est√° nesta lista:

https://github.com/filipedeschamps/tabnews.com.br/blob/306bc05efd9854512598c4ce96554e8d7ebf5b73/models/user.js#L194

Voc√™ n√£o recebeu uma mensagem de erro?

E `recentes` n√£o encontrei na lista que bloqueia, √© necess√°rio cadastrar, belo achado üòç ü§ù üëç

>> Coment√°rio de potatowski:
Eu tive a suposi√ß√£o que com contato iria acontecer o mesmo que recentes, testei aqui e deu realmente erro

>> Coment√°rio de aprendendofelipe:
Resolvido em #1045

>> Coment√°rio de aprendendofelipe:
Oi @potatowski, obrigado por reportar esse problema! üöÄ
</issue_1030_Nome de usu√°rios mesmo que o de paginas>

<issue_1032_[SUGEST√ÉO] Ter um outro nome de usu√°rio, como um nickname ou apelido>
Atualmente, ao trocar o usu√°rio na plataforma, √© disparada a seguinte mensagem: 
![image](https://user-images.githubusercontent.com/78393422/204649496-f97bc214-1cae-445e-bd94-406673954d74.png)

O que faz total sentido e gera a necessidade de uma tratativa para que as urls n√£o quebrem de uma hora pra outra.
Uma sugest√£o √© adotar um outro tipo de nome de usu√°rio, como um "nickname" ou apelido, similarmente ao que ocorre no Twitter.
Talvez dessa forma, apesar de n√£o resolver o problema diretamente, a altera√ß√£o de um nickname seja algo que ocorra com mais frequ√™ncia e consequentemente a quebra de urls se torne menos frequente.

>> Coment√°rio de Rafatcb:
A refer√™ncia para essa tomada de decis√£o foi o GitHub. O GitHub tamb√©m quebra os links caso voc√™ mude o seu "username", mas permite adicionar um "Nome", e acho que nada impede termos isso no TabNews tamb√©m.

Um outro issue relacionado √© esse:

* https://github.com/filipedeschamps/tabnews.com.br/issues/723

>> Coment√°rio de aprendendofelipe:
Acredito que podemos fechar essa issue, pois um outro nome n√£o resolveria a quebra de links ao se alterar o username.

E agora √© poss√≠vel colocar seu nome (ou os dados que quiser) na p√°gina do perfil, ent√£o acredito que isso atenda de forma parecida com o que o GitHub faz.

Vou fechar tamb√©m por inatividade, j√° a ideia n√£o atraiu muita aten√ß√£o.

Mas qualquer coisa reabrimos, se for necess√°rio ü§ù
</issue_1032_[SUGEST√ÉO] Ter um outro nome de usu√°rio, como um nickname ou apelido>

<issue_1034_Email de recupera√ß√£o de senha n√£o chega>
Bom, criei uma conta por√©m n√£o chegou o email de ativa√ß√£o. E quando eu clico em recuperar senha aparece a mensagem dizendo que foi enviado uma nova senha, por√©m o email nunca chega com a tal senha.  O mesmo acontece quando tento fazer login, fala que a conta n√£o est√° ativada e que enviaram um link para a ativa√ß√£o da mesma, por√©m o link nunca chega...

>> Coment√°rio de filipedeschamps:
@Hanufu por favor, envie um email para contato@tabnews.com.br atrav√©s do email utilizado na conta para eu investigar ü§ù üëç
</issue_1034_Email de recupera√ß√£o de senha n√£o chega>

<issue_1035_(CHORE) @TODO move suggestEmail function to a separate file to make it reusable>


>> Coment√°rio de imLeonam:
![image](https://user-images.githubusercontent.com/66780830/204693346-532f75ca-9948-41fe-b26e-eb1e5258679d.png)

>> Coment√°rio de imLeonam:
PR: https://github.com/filipedeschamps/tabnews.com.br/pull/1036

>> Coment√°rio de imLeonam:
Hope i can help with that !!

>> Coment√°rio de Rafatcb:
Parece que isso j√° entrou em produ√ß√£o no PR https://github.com/filipedeschamps/tabnews.com.br/pull/1429. Essa issue pode ser fechada, certo @aprendendofelipe ?

Arquivo: https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/interface/utils/email-suggestion.js

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb! E obrigado @imLeonam! üí™

Fechando... ü§ù
</issue_1035_(CHORE) @TODO move suggestEmail function to a separate file to make it reusable>

<issue_1037_[FEATURE] - LInks _blank>
basicamente eu notei que o tabnews n√£o est√° tratando os links da forma ideal, portatno sugiro a captura e a adi√ß√£o de  target blank em todos os links compartilhados na plataforma

>> Coment√°rio de JonathanArgentao:
√â proposital a princ√≠pio, aqui tem o ponto de vista que o Filipe deu.
https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074

>> Coment√°rio de YrllanBrandao:
certo, n√£o tinha visto isso, obrigado!
</issue_1037_[FEATURE] - LInks _blank>

<issue_1038_Permitir ignorar publica√ß√µes>
Criei uma resposta em um post sobre este assunto.

Acho o mais vi√°vel, uma op√ß√£o de "ignora postagem", assim as postagens teria n√∫meros no t√≠tulo, mostrando total de view e quanto destas views clicaram em ignorar.

Da uma lida por favor üòå

https://www.tabnews.com.br/FabioSmuu/61795cdb-3002-47ab-970e-033ec14ec72b

>> Coment√°rio de Rafatcb:
F√°bio, obrigado pela sugest√£o!

Provavelmente isso sofrer√° o mesmo problema que a sugest√£o https://github.com/filipedeschamps/tabnews.com.br/issues/1382. Citando o coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1382#issuecomment-1602751913:

> Os conte√∫dos (e as listas de conte√∫dos) do TabNews s√£o exibidos em p√°ginas est√°ticas. Ainda n√£o existem p√°ginas personalizadas para cada usu√°rio, e, provavelmente, isso deve demorar para entrar no radar, tanto pela exig√™ncia de muito mais performance do back-end, quanto de reformula√ß√£o total do sistema.

>> Coment√°rio de aprendendofelipe:
Acho que essa issue tamb√©m pode ser fechada por falta de ades√£o da Turma.

Mas qualquer coisa reabrimos ü§ù
</issue_1038_Permitir ignorar publica√ß√µes>

<issue_1040_[FEATURE/SUGEST√ÉO] Publica√ß√£o compartilhada/v√°rios autores>
Op√ß√£o de contribui√ß√£o na publica√ß√£o, ou seja, a mesma publica√ß√£o ser de v√°rios usu√°rios, pois √© comum ver um poste e logo abaixo os alguns coment√°rios postando conte√∫do para compor o post, isso evitaria duplica√ß√£o e melhor visualiza√ß√£o do conte√∫do sendo que o mesmo estaria centralizado.

>> Coment√°rio de Rafatcb:
Essa sugest√£o me parece misturar duas outras sugest√µes:

* https://github.com/filipedeschamps/tabnews.com.br/issues/965
* https://github.com/filipedeschamps/tabnews.com.br/issues/714

Acho que podemos fechar este e concentrar a discuss√£o nos outros, mais espec√≠ficos.

Lembrando que n√£o √© errado algu√©m comentar algo que complemente a publica√ß√£o original, isso permite um tom diferente da publica√ß√£o original, um ponto de vista do pr√≥prio autor do coment√°rio e tamb√©m que ele ganhe TabCoins com isso.
</issue_1040_[FEATURE/SUGEST√ÉO] Publica√ß√£o compartilhada/v√°rios autores>

<issue_1042_Deschamps quero sua aten√ß√£o>
Queria que o Deschamps me respondesse aqui sobre isso. 

https://www.tabnews.com.br/SimithCahori96/all-lives-matter

Recebi -16 downvote. Agora estou com -203 tabCoins.

Como recebi essa quantidade? Por fazer o **certo**. A publica√ß√£o n√£o estava de acordo com a plataforma que foi destinado a ter "valor concreto", segundo Deschamps diz. E outros usu√°rios n√£o gostaram disso e foram contra mim. Agora a publica√ß√£o foi removida pelo autor ou por um moderador e fiquei com -203 tabCoins.

![Screenshot_20221130-101533.png](https://user-images.githubusercontent.com/72875404/204806434-65932daa-b51b-4081-8cb3-0d989bff105b.png)

Essa imagem √© √∫nica que tenho por ter salvo o cache do navegador.

>> Coment√°rio de filipedeschamps:
@Jetrom17 obrigado meu caro, vou avaliar a movimenta√ß√£o de TabCoins contra este seu coment√°rio ü§ù

>> Coment√°rio de filipedeschamps:
@Jetrom17 fiz o rastreio de tudo que aconteceu e de fato estas negativa√ß√µes n√£o se justificam. Vou lhe propor o seguinte: na pr√≥xima Milestone vamos implementar uma ferramenta para um moderador conseguir resetar as TabCoins de uma publica√ß√£o e com esta feature irei resetar este post, devolvendo a voc√™ as TabCoins, combinado? Eu s√≥ pe√ßo que aguarde um pouco para que seja poss√≠vel fechar a Milestone atual (que ser√° feito em Live hoje) e depois abrir uma nova ü§ù

>> Coment√°rio de Jeiel0rbit:
@filipedeschamps 

> Vou lhe propor o seguinte: na pr√≥xima Milestone [...] irei resetar este post, devolvendo a voc√™ as TabCoins, combinado? 

Certo. Isso me √© justo.

> Milestone vamos implementar uma ferramenta para um moderador

Seenhor Deschamps, como fa√ßo para ser um de seus moderadores volunt√°rios? 

> Eu s√≥ pe√ßo que aguarde um pouco para que seja poss√≠vel fechar a Milestone atual (que ser√° feito em Live hoje)

 Live vai ser p√∫blico no YouTube ou termo "live" √© referente a outra coisa, da qual, desconhe√ßo?
</issue_1042_Deschamps quero sua aten√ß√£o>

<issue_1043_Listar conte√∫dos por quantidades de TabCoins, visualiza√ß√µes, coment√°rios etc.>
como o titulo sugere, a possibilidade de filtrar de acordo coma quantidade de tabcoins, maior para menor e vice versa

>> Coment√°rio de Poveii:
√â uma boa ideia. Para um futuro que tenhamos mais configura√ß√µes em rela√ß√£o a filtragem dos posts, tipo inv√©s de ter s√≥ a aba de recentes que mostram os posts recentes, teria um bot√£o para indicar par√¢metros para uma filtragem mais profunda e avan√ßada. Mas de toda forma √© uma boa! ^^

>> Coment√°rio de Rafatcb:
@aprendendofelipe Me parece que tanto a busca de conte√∫dos no geral, quanto de conte√∫dos do usu√°rio fazem uso do `findWithStrategy`:

https://github.com/filipedeschamps/tabnews.com.br/blob/4e4d030cd4c0c2e240c96e5cfea16e43604aa223/models/content.js#L191-L196

Se eu estiver certo, podemos fechar aqui e focar a discuss√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/1388, j√° que s√≥ ser√° necess√°rio criar novas estrat√©gias e depois implementar no frontend em locais diferentes. Faz sentido?

>> Coment√°rio de aprendendofelipe:
@Rafatcb, eu tamb√©m acho que podemos fechar aqui e manter a #1388, ent√£o j√° estou fechando ü§ù

Mas √© bom deixar registrada nossas restri√ß√µes atuais com rela√ß√£o a essa ideia. N√≥s n√£o temos os dados de visualiza√ß√µes no nosso banco (apenas no analytics e limitado a 12 meses) e n√£o temos cache do saldo de TabCoins.

E esses indicadores isoladamente n√£o dizem muita coisa, mas a combina√ß√£o entre eles √© capaz de pegar um contexto melhor, por isso acredito que a prioridade deva ser melhorar o ranqueamento de relevantes antes de disponibilizar outros ranqueamentos.

### Cache de saldos de TabCoins

Para que o ranqueamento se atualize em tempo real, queremos evitar o cache enquanto for poss√≠vel. Por isso computamos os saldos em tempo real, mas isso sempre acontece em um n√∫mero restrito de conte√∫dos, de acordo com cada consulta. Sempre √© filtrado por tempo e, √†s vezes, tamb√©m pelo usu√°rio.

Classificar todos os conte√∫dos pelo saldo exigiria computar em tempo real o saldo de todos conte√∫dos publicados, o que monopolizaria o uso do banco de dados, prejudicando o desempenho de todo o sistema.
</issue_1043_Listar conte√∫dos por quantidades de TabCoins, visualiza√ß√µes, coment√°rios etc.>

<issue_1044_[FEATURE/SUGEST√ÉO] Possibilidade de mencionar usu√°rios nos coment√°rios>
Apesar de poder responder diretamente nos coment√°rios, uma coisa que senti falta foi a possibilidade de mencionar usu√°rios diretamente nos coment√°rios.
As vezes a galera tem d√∫vida que a gente sabe quem pode ajudar, mas n√£o consegue mencionar a pessoa em espec√≠fico.

E da mesma forma que hoje √© notificado por e-mail quando algu√©m responde uma postagem ou um coment√°rio seu, poder√≠amos colocar pra notificar quando for mencionado.

Sugerindo aqui, mas vou estudar tamb√©m pra tentar contribuir com implementa√ß√£o dessa funcionalidade.
Meu conhecimento em Node.js n√£o √© alto, mas jogando a l√≥gica aqui, pode ser que a galera complemente.

:v: :smile:

>> Coment√°rio de gpaiva00:
Ol√° @rein4nl1m e @filipedeschamps. Essa funcionalidade √© bem interessante e posso ajudar a implementar. Existe algo que nos impe√ßa de adicionar essa funcionalidade hoje? Vamos discutir aqui. ü§ù
</issue_1044_[FEATURE/SUGEST√ÉO] Possibilidade de mencionar usu√°rios nos coment√°rios>

<issue_1046_[FEATURE/SUGEST√ÉO] - Blog pessoal no Tabnews>
Adicionar uma feature para utilizar o Tabnews como um blog pessoal,
ou alguma forma que seja poss√≠vel listar apenas as postagens pessoais.
Atualmente no link pessoal apresenta as postagens e coment√°rios.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Leanderson!

N√£o acho que seja ideal o TabNews focar em possibilitar ser usado como blog pessoal, pois as regras do TabNews devem ser respeitadas, e j√° aconteceu de usu√°rios publicarem o mesmo conte√∫do em ingl√™s e portugu√™s para ter no pr√≥prio blog, ou de ser banido por infringir alguma regra e "perder" as publica√ß√µes.

Eventualmente haver√° a distin√ß√£o de conte√∫do raiz e coment√°rios por causa da sugest√£o https://github.com/filipedeschamps/tabnews.com.br/issues/807, para melhorar a visualiza√ß√£o no pr√≥prio perfil do usu√°rio. Ent√£o, estou fechando este issue como duplicado do issue mencionado para concentrarmos a discuss√£o l√°.
</issue_1046_[FEATURE/SUGEST√ÉO] - Blog pessoal no Tabnews>

<issue_1047_[FEATURE/SUGEST√ÉO] - Permitir cadastros atrav√©s do Google/Facebook/...>
Permitir que usuarios se cadastrem atrav√©s das apis do Google, por exemplo, para que se possa aumentar a seguran√ßa e fiabilidade do site.

>> Coment√°rio de ceelsoin:
Relacionado com a #922
</issue_1047_[FEATURE/SUGEST√ÉO] - Permitir cadastros atrav√©s do Google/Facebook/...>

<issue_1048_[bug] Os caracteres '<' e '>' n√£o s√£o mostrados corretamente em blocos de c√≥digo>
Quando estava comentando em uma publica√ß√£o do tabnews coloquei um bloco de c√≥digo que continha os operadores de compara√ß√£o > e <, lendo o c√≥digo para revisar vi que nas partes do c√≥digo onde tinha o caractere < aparecia a sequ√™ncia &lt e para > &gt, resolvi fazer alguns testes no mesmo coment√°rio editando e constatei que isso s√≥ ocorre em blocos de c√≥digo mesmo, para o restante do texto os caracteres aparecem normalmente.

link do post em quest√£o: https://www.tabnews.com.br/joelcarneiro/o-problema-dos-numeros-primos-na-programacao

>> Coment√°rio de filipedeschamps:
@Gabriel-Tapes muito obrigado por vir publicar isso aqui! O @aprendendofelipe est√° no meio de uma implementa√ß√£o que pode estar influenciando isto e esta issue ir√° contribuir para considerarmos mais casos. Caso note outros, nos avise.

E importante notar que nada no conte√∫do original est√° sendo alterado, √© apenas na hora de visualizar, ent√£o n√£o se preocupe que os seus conte√∫dos est√£o √≠ntegros ü§ù

>> Coment√°rio de aprendendofelipe:
Oi @Gabriel-Tapes, acho que agora est√° tudo certo com a sua publica√ß√£o.

Se puder verificar, acho que j√° n√£o precisa daquele coment√°rio.

Vou encerrar a issue, ok?
</issue_1048_[bug] Os caracteres '<' e '>' n√£o s√£o mostrados corretamente em blocos de c√≥digo>

<issue_1049_[SUGEST√ÉO] Tab coins e tempo decorrido da postagem de coment√°rios tamb√©m valerem para o ranking de posts relevantes>
Como a premissa do tabnews √© de ter conte√∫do relevante e de coment√°rios terem a mesma relev√¢ncia de posts, coisa que acho incr√≠vel, n√£o faria sentido que para um post ser relevante tamb√©m se considerasse se os coment√°rios s√£o relevantes? Por exemplo, no post que fala exatamente de como funciona o ranking de relevantes [ü§î [DUVIDA] Como funciona o Ranking de Posts Relevantes](https://www.tabnews.com.br/Diegiwg/duvida-como-funciona-o-ranking-de-posts-relevantes), o post em si n√£o √© relevante por si s√≥, pois √© apenas uma pergunta, o que faz ele relevante √© um dos coment√°rios, onde √© dada uma tabela que acaba com a d√∫vida em quest√£o, isso daria tamb√©m mais sentido a up votes em coment√°rios. 

Atualmente funciona assim:
<table>
<thead>
<tr>
<th>Grupo</th>
<th>Saldo m√≠n.</th>
<th>Tempo m√°x.</th>
<th>Qtd. reservada</th>
<th>Qtd. m√°x</th>
<th>Excedente para o grupo</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>12</td>
<td>36 horas</td>
<td>10 mais novos</td>
<td>10</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>7</td>
<td>1 dia</td>
<td>10 mais novos</td>
<td>20</td>
<td>4</td>
</tr>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>12 horas</td>
<td>5 mais novos</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>4</td>
<td>11</td>
<td>3 dias</td>
<td>10 mais novos</td>
<td>10</td>
<td>6</td>
</tr>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>3 dias</td>
<td>10 mais novos</td>
<td>10</td>
<td>6</td>
</tr>
</tr>
<tr>
<td>6</td>
<td>0</td>
<td>1 semana</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>

Adicionando os coment√°rios ao ranking, poderia ou adicionar mais crit√©rios baseado nos coment√°rios, ou aumentar o n√∫mero de tab coins para que os posts n√£o se encaixem sempre nos grupos 1, 2 e 4 devido a ser mais f√°cil. A √∫nica coisa realmente problem√°tica da abordagem proposta seria que coment√°rios ruins, que tendem a receber down votes poderiam prejudicar o ranqueamento do post em si, mas n√≥s n√£o vimos tantos casos de coment√°rios com muitos down votes at√© agora, ent√£o talvez nem se torne um problema muito grande.
</issue_1049_[SUGEST√ÉO] Tab coins e tempo decorrido da postagem de coment√°rios tamb√©m valerem para o ranking de posts relevantes>

<issue_1050_Erro ao tentar criar uma Pull request>
@filipedeschamps depois que o projeto ficou publico n√£o consigo enviar PRs, sabe se preciso configurar algo?

![Captura de tela em 2022-12-01 00-34-34](https://user-images.githubusercontent.com/5334261/204959909-13c50699-fc58-47c0-8457-b475d86e5f73.png)

>> Coment√°rio de filipedeschamps:
@rodrigoKulb show! Agora o reposit√≥rio volta ao fluxo normal de um reposit√≥rio open source, onde voc√™ precisa fazer um **Fork** aqui deste reposit√≥rio (que √© uma c√≥pia que fica vinculada com a origem), clonar este Fork para a sua m√°quina, fazer as altera√ß√µes, fazer o push para este Fork, e da√≠ abrir o PR ü§ù 

Se ficou muito denso a explica√ß√£o, me avise üëç
</issue_1050_Erro ao tentar criar uma Pull request>

<issue_1051_Criar permiss√£o para visualiza√ß√£o de publica√ß√µes removidas>
_Essa sugest√£o √© relacionada a **ferramentas de modera√ß√£o**._

J√° tivemos alguns usu√°rios que receberam "nuke" na plataforma, al√©m de alguns que apenas tiveram uma publica√ß√£o ou outra removida. O problema disso √© que as evid√™ncias somem: se um usu√°rio for reincidente e um moderador diferente encontrar a publica√ß√£o, fica sem saber o que j√° aconteceu at√© ent√£o. Tamb√©m pode acontecer de um usu√°rio apagar a publica√ß√£o e republicar mais de uma vez. Ent√£o sugiro criar a permiss√£o para visualizar publica√ß√µes removidas e quem tem essa permiss√£o pode:

1. Visualizar as publica√ß√µes removidas ao acessar o link delas, mas mostrar que est√° removida, da mesma forma que um usu√°rio tem a tag `nuked`;
2. Visualizar o link e nome da publica√ß√£o raiz, ao inv√©s de exibir `[N√£o dispon√≠vel]`, mas tamb√©m identificar com uma tag de que foi removida;
3. Visualizar as publica√ß√µes removidas no perfil do usu√°rio, com uma tag identificando elas;
4. Talvez diferenciar uma publica√ß√£o removida por um terceiro ou removido por quem publicou. Pode aparecer isso no _hover_ da tag.

Com essa sugest√£o, vem uma d√∫vida: √© poss√≠vel fazer esse tipo de acesso diferenciado ou o cache das p√°ginas atrapalha os pontos 1 e 3?

>> Coment√°rio de aprendendofelipe:
Penso que √© muito importante disponibilizar um hist√≥rico de modera√ß√£o para a consulta pelos moderadores. E tamb√©m disponibilizar publicamente dados n√£o sens√≠veis sobre isso.

Inclusive deveria haver um campo para explicar/justificar o ocorrido no momento da a√ß√£o moderadora. E futuramente poderia ser obrigado a mais de um moderador concordar com a a√ß√£o antes dela ser aplicada.

Mas tenho d√∫vidas se √© legal os moderadores terem f√°cil acesso ao conte√∫do de posts j√° apagados.

Existe a possibilidade de recuperar esses conte√∫dos, mas acho que s√≥ deve ser utilizado em casos muito s√©rios.

Sobre a pergunta final... N√£o daria pra utilizar a mesma URL, pois hoje √© permitido criar novas publica√ß√µes com o mesmo slug de conte√∫dos apagados. S√≥ se mudar essa regra, mas a√≠ cria dificuldade com o cache de p√°ginas est√°ticas.

>> Coment√°rio de Rafatcb:
> Penso que √© muito importante disponibilizar um hist√≥rico de modera√ß√£o para a consulta pelos moderadores. E tamb√©m disponibilizar publicamente dados n√£o sens√≠veis sobre isso.

Justo. Penso futuramente num hist√≥rico de edi√ß√µes dispon√≠vel tamb√©m, mas acho que o trabalho para esse cen√°rio seria consideravelmente maior.

> Inclusive deveria haver um campo para explicar/justificar o ocorrido no momento da a√ß√£o moderadora. E futuramente poderia ser obrigado a mais de um moderador concordar com a a√ß√£o antes dela ser aplicada.

Concordo, a justificativa √© uma boa forma do usu√°rio saber o motivo tamb√©m. Alguns motivos poderiam ser padr√£o, para facilitar para o moderador e j√° ter uma boa mensagem de orienta√ß√£o ao usu√°rio.

Segue a mesma linha de racioc√≠nio que o Stack Overflow para as [justificativas de fechamento](https://stackoverflow.com/help/closed-questions) e [votos de fechamento](https://stackoverflow.com/help/privileges/close-questions).

> Mas tenho d√∫vidas se √© legal os moderadores terem f√°cil acesso ao conte√∫do de posts j√° apagados.

No Stack Overflow, quem tem mais de 10.000 de reputa√ß√£o ganha acesso √† algumas [ferramentas de modera√ß√£o](https://stackoverflow.com/help/privileges/moderator-tools), dentre elas est√° a possibilidade de ver publica√ß√µes removidas. Note que isso n√£o significa que o usu√°rio √© moderador, √© um usu√°rio comum que alcan√ßou 10.000 de reputa√ß√£o. Isso me faz pensar que faz sentido os moderadores verem publica√ß√µes removidas, mas acho o debate v√°lido.
</issue_1051_Criar permiss√£o para visualiza√ß√£o de publica√ß√µes removidas>

<issue_1052_[FEATURE] Implementar RSS>
Implementar RSS, de forma a permitir a leitura das postagens off-line.

>> Coment√°rio de Rafatcb:
Temos esse RSS: https://www.tabnews.com.br/recentes/rss

A implementa√ß√£o foi feita aqui: https://github.com/filipedeschamps/tabnews.com.br/pull/621

>> Coment√°rio de mgunther:
Perfeito!
Funciona maravilhosamente bem!
Seria interessante colocar na p√°gina um √≠cone informando a sua exist√™ncia/ativa√ß√£o.
No rodap√© talvez?
Obrigado!

>> Coment√°rio de Rafatcb:
> Seria interessante colocar na p√°gina um √≠cone informando a sua exist√™ncia/ativa√ß√£o. No rodap√© talvez?

Faz sentido essa sugest√£o. Acho que poderia deixar a issue aberta e apenas trocar o t√≠tulo dela. Estamos com tantos links no rodap√© que talvez fique ruim colocar mais um ali, mas o link do RSS deveria ser acess√≠vel por algum lugar sim üëç
</issue_1052_[FEATURE] Implementar RSS>

<issue_1054_[Feature] Modo de revis√£o>
Ol√° amigos.
Primeiramente, parabens pelo TabNews! 

## posposta: 

** Problema: **

Escrevo postagens longas e detalhadas,
Escrever, revisar, adicionar gr√°ficos de mermaid 

coisas que juntas podem levas horas, adorei todo TABNEWS, mas sinto falta de um mode de salvar o conte√∫do parcialmente para ser completado depois. 
 
 ** Solu√ß√£o: **
 
 Minha proposta √©:
 
 1. adicionar um bot√£o de salvar na tela de postagem de artigo: 
 
![image](https://user-images.githubusercontent.com/5364466/205071348-297c5f1e-4036-4b67-9394-c37c9b39ac23.png)

 2. adicionar um bot√£o de publicar para os post n√£o publicados: 
 
 ![image](https://user-images.githubusercontent.com/5364466/205071938-b456e6dc-578d-495a-900d-a95e46d9440c.png)

>> Coment√°rio de edumats:
Eu publiquei meu primeiro artigo no TabNews, mas fiquei com medo de perder o meu trabalho digitando no site da TabNews, pois fa√ßo v√°rias revis√µes e corre√ß√µes, ent√£o acabei escrevendo tudo no site da Hashnode e depois colando no TabNews para ser publicado.

Eu vi que o conte√∫do que escrevo na p√°gina "Publicar conte√∫do" do TabNews fica salvo, mesmo fechando a aba do navegador e reabrindo. Acho que deveria ficar mais claro para o usu√°rio que o conte√∫do ficar√° salvo. Assim, acredito que os usu√°rios ficariam mais tranquilos para elaborar melhor os posts ao inv√©s de tentar escrever e publicar em uma tacada s√≥.

>> Coment√°rio de Rafatcb:
Como foi dito, hoje o conte√∫do fica salvo no `localStorage`, e poderia ficar mais claro que foi salvo realmente, mas acho que podemos fechar esse issue como duplicado de:

* https://github.com/filipedeschamps/tabnews.com.br/issues/960
</issue_1054_[Feature] Modo de revis√£o>

<issue_1055_Op√ß√£o de pesquisar usuario/post>
Algo que sinto bastante falta √© a op√ß√£o de pesquisar no TabNews
Caso voc√™ queira procurar posts sobre um conte√∫do espec√≠fico dentro do site, voc√™ ir√° precisar percorrer post por post e ir filtrando manualmente aqueles que falam sobreo que voc√™ quer, o que n√£o √© nada pr√°tico
Al√©m de que, para voc√™ achar um usu√°rio espec√≠fico, voc√™ ir√° precisar achar um post dele, o que tamb√©m dificulta muito

Uma op√ß√£o de pesquisar posts e usu√°rios seria extremamente √∫til e n√£o deve ser a coisa mais imposs√≠vel de ser feita, visando o que o TabNews j√° √©

Postei sobre isso no site e algumas pessoas tamb√©m concordaram com essa e outras sugest√µes
Aqui o link do post: https://www.tabnews.com.br/Luciano655/denunciar-usuarios-e-barra-de-pesquisa-no-tabnews

Espero que levem em considera√ß√£o!

>> Coment√°rio de CristinoCg:
Eu tamb√©m acho. Foi a primeira coisa que quis procurar e n√£o consegui achar. √â muito dif√≠cil ter que recuar um monte de p√°ginas at√© encontrar um artigo e voc√™ n√£o sabe onde ele est√° hhh

>> Coment√°rio de kaiopiola:
UPzasso nessa solicita√ß√£o, seria maravilhoso uma barra de pesquisa!

>> Coment√°rio de aprendendofelipe:
@Luciano655dev, obrigado pela sugest√£o! üí™

Estou fechando por ser duplicada com a #927.

Sugiro centralizar a conversa por l√°. Combinado? ü§ù
</issue_1055_Op√ß√£o de pesquisar usuario/post>

<issue_1056_Corretor ao escrever um post>
Quando voc√™ escreve um post um pouco mais longo, √© normal que voc√™ precise verificar se uma palavra ou outra est√£o corretas antes de apertar no bot√£o de "publicar"
A quest√£o √© que, diferentemente de outras plataformas, como o pr√≥prio GitHub onde estou escrevendo isso, o TabNews n√£o disponibiliza um corretor enquanto voc√™ escreve (linhas vermelhas em baixo das palavras, etc)
Isso dificulta muito na hora de revisar uma postagem longa, que voc√™ precisa ler cuidadosamente cada palavra para n√£o correr o perigo de errar alguma letra e n√£o precisar ir editanto o post diversas vezes
Acredito que seja algo bastante simples de ser feito, certamente deve existir alguma lib ou at√© mesmo alguma fun√ß√£o do pr√≥prio navegador que disponibilize esse recurso
Tamb√©m tem gente que falou que tinha uma extens√£o que j√° fazia isso, mas curiosamente a mesma n√£o pegava no TabNews

Fiz um post no site falando sobre essa e outras sugest√µes, algumas pessoas concordaram comigo
Link: https://www.tabnews.com.br/Luciano655/denunciar-usuarios-e-barra-de-pesquisa-no-tabnews

Espero que levem em considera√ß√£o!

>> Coment√°rio de Rafatcb:
Realmente seria √∫til ter um corretor na caixa de texto, mas como isso j√° foi sugerido na issue https://github.com/filipedeschamps/tabnews.com.br/issues/970, acho que podemos concentrar a discuss√£o l√°.

Vale mencionar tamb√©m que temos outros problemas com o editor atual, como mencionado em https://github.com/filipedeschamps/tabnews.com.br/issues/648.

E n√£o sei se o GitHub tem esse tipo de corretor ortogr√°fico. Aqui, para mim, n√£o aparece nenhuma marca√ß√£o quando escrevo algo errado.

>> Coment√°rio de aprendendofelipe:
Obrigado @Luciano655dev e @Rafatcb! üí™

Acredito que as discuss√µes sobre o editor de texto podem ser unificadas na #648.

No m√≠nimo as discuss√µes relacionadas ao que n√£o podemos resolver sem a troca do editor, ou colaborando diretamente no reposit√≥rio do ByteMD (que em sua nova vers√£o est√° sendo desenvolvido como [HashMD](https://github.com/pd4d10/hashmd)).

√â o caso da verifica√ß√£o ortogr√°fica, que nem √© o editor em si que faz, mas sim o navegador, mas no ByteMD n√£o d√° pra habilitar. Ent√£o vou fechar essa aqui. ü§ù
</issue_1056_Corretor ao escrever um post>

<issue_1057_Selos de verificado nas contas>
L√° no site teve um problema que um perfil estava postando not√≠cias e todos achavam que era bot, at√© que o @filipedeschamps explicou que se tratava de uma conta oficial. Mesmo assim, antes disso, isso causava uma pequena confus√£o
Para evitar esse tipo de acontecimento, um selo de verifica√ß√£o em algumas conta seria uma boa ideia
Isso ajudaria a distinguir perfis falso de reais, etc

Para n√£o transformar o selo de verificado em uma grande burocracia, eles poderiam ser dados apenas a contas selecionadas ou aqueles que contribu√≠ram com o projeto
Talvez at√© ter diferentes selos para quem tem quantidade X de TabCash, para quem contribuiu, para contas oficiais, etc...
Ou, se n√£o quiser complicar, apenas para algumas contas espec√≠ficas como disse antes

Isso traria uma ajuda imensa e evitaria v√°rios motivos de desentendimentos em rela√ß√£o a identidade
fiz um post com essa e outras sugest√µes no TabNews, aqui o link: https://www.tabnews.com.br/Luciano655/denunciar-usuarios-e-barra-de-pesquisa-no-tabnews

Espero que levem em considera√ß√£o!

>> Coment√°rio de Rafatcb:
Acho essa preocupa√ß√£o legal, e inclusive acabou gerando alguns coment√°rios na issue https://github.com/filipedeschamps/tabnews.com.br/issues/1289. Mesmo ela sendo uma issue mais recente, acho que poder√≠amos concentrar o assunto por l√°. Que tal @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
@Luciano655dev, obrigado pela sugest√£o! üí™

Vamos seguir a sugest√£o do @Rafatcb de manter o debate na #1289. ü§ù
</issue_1057_Selos de verificado nas contas>

<issue_1058_Favoritar/Salvar post>
J√° me vi diversas vezes na situa√ß√£o em que quero guardar um post para v√™-lo depois, como aqueles que falam sobre a API do TabNews ou qualquer outro assunto distinto
Para fazer isso atualmente, preciso copiar o link da postagem e salva-lo em outro lugar, como em um servidor privado do Discord ou em um arquivo de bloco de notas, o que n√£o √© nem um pouco pr√°tico

Assim como o Instagram ou YouTube, criar uma op√ß√£o de "Salvar" para os posts ajudaria muito nessa quest√£o, ou pelo menos adicionar uma aba que te permite ver as postagens que voc√™ j√° curtiu, certamente ajudaria um grande n√∫mero de pessoas com algo relativamente simples de ser implementado

Escrevi essa e outras sugest√µes l√° no site e algumas pessoas concordaram comigo
Aqui o link: https://www.tabnews.com.br/Luciano655/denunciar-usuarios-e-barra-de-pesquisa-no-tabnews

Espero que leve em considera√ß√£o!

>> Coment√°rio de theJoseNeto:
Sugeri algo parecido aqui. https://www.tabnews.com.br/ojotaneto/opcao-de-salvar-postagens-no-tabnews tamb√©m

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_1058_Favoritar/Salvar post>

<issue_1065_[FRONT] Op√ß√£o de receber email desalinhada>
√â um detalhe pequeno mas o elemento pai do texto de receber email deveria ter um ```align-items: center;```. Isso ou transformar a label em um elemento de bloco.
![image](https://user-images.githubusercontent.com/82411251/205188156-a96f54f8-0606-4e4c-badb-1d5f909ce1b1.png)
</issue_1065_[FRONT] Op√ß√£o de receber email desalinhada>

<issue_1066_[FEATURE/SUGEST√ÉO] Disponibilizar a documenta√ß√£o da API do tabnews via Swagger ou outra ferramenta>
Acho que seria interessante e at√© estimularia a galera a se utilizar mais das APIs se houvesse uma documenta√ß√£o mais expl√≠cita e de f√°cio acesso. Acho que o Swagger 2 (ou OpenAPI 3) serviriam bem. Al√©m de ser uma abordagem legal pra apenas abrir a p√°gina e experimentar as requests, √© uma maneira bem automatizada de manter a documenta√ß√£o sempre atualizada.

Tamb√©m h√° a possibilidade de usar ferramentas como o [Read The Docs](https://readthedocs.org), mas acho que seria mais trabalhoso.

A lib que eu vi o pessoal mais utilizando √© essa aqui: [next-swagger-doc](https://github.com/jellydn/next-swagger-doc). Eu experimentei e n√£o tive problemas

Tamb√©m tem o [Redoc](https://github.com/Redocly/redoc) que parece ser interessante e mais bonitinho at√© ahha A maior vantagem dele √© que a interface mobile √© bem boa

>> Coment√°rio de EduardoSpek:
O usu√°rio coffeeispower j√° desenvolveu uma muito bacana:

[Documenta√ß√£o da API do TabNews](https://coffee-is-power.github.io/tabnews-openapi/)

Veja tamb√©m o post que ele fez sobre a documenta√ß√£o l√° no TabNews:

[Post feito pelo coffeeispower](https://www.tabnews.com.br/coffeeispower/pitch-minha-documentacao-da-api-do-tabnews)

>> Coment√°rio de joseribeiroejrs:
Algu√©m sabe como anda a an√°lise do PR dele? Isso ao meu ver √© algo essencial e que vai ajudar muitooooo. Tamb√©m senti muita falta disso.

>> Coment√°rio de gabrielsozinho:
@joseribeiroejrs vai ser analisado na pr√≥xima milestone,

>> Coment√°rio de aprendendofelipe:
@yuhrao, obrigado pelas sugest√µes! üí™

Vou fechar essa issue para centralizarmos na #555. Combinado? ü§ù
</issue_1066_[FEATURE/SUGEST√ÉO] Disponibilizar a documenta√ß√£o da API do tabnews via Swagger ou outra ferramenta>

<issue_1071_Sugest√£o de Usabilidade para o Tabnews - Parte 1>
Segue as ideias:

# <img src = "https://iili.io/HJiNdvI.jpg">
# <img src = "https://iili.io/HJieN7p.jpg">
# <img src = "https://iili.io/HJieZT7.jpg">
# <img src = "https://iili.io/HJik0Ff.jpg">
# <img src = "https://iili.io/HJsqniN.jpg">
# <img src = "https://iili.io/HJsUI4e.jpg">

https://www.tabnews.com.br/Chitaum/sugestao-de-usabilidade-para-o-tabnews-parte-2

>> Coment√°rio de Rafatcb:
Sobre as sugest√µes:

1. Foto de perfil aparecendo na publica√ß√£o: Acho que n√£o temos um issue sobre isso.
2. Notifica√ß√µes: https://github.com/filipedeschamps/tabnews.com.br/issues/738
3. Salvar publica√ß√£o: https://github.com/filipedeschamps/tabnews.com.br/issues/645
4. Funcionamento do site: https://github.com/filipedeschamps/tabnews.com.br/issues/1380
5. Pesquisa: J√° implementado.

@aprendendofelipe acha que faz sentido editar esse issue para ficar apenas sobre o primeiro ponto?

>> Coment√°rio de aprendendofelipe:
Eu acredito que adicionar fotos de perfil nos conte√∫dos (ou na lista de conte√∫dos) √© algo fora dos planos do TabNews. Acho que esse √© um dos pontos que tentamos fazer diferente. J√° foi falado mais de uma vez sobre n√£o dar mais import√¢ncia ao autor do que ao conte√∫do... Uma refer√™ncia:

https://github.com/filipedeschamps/tabnews.com.br/issues/328#issuecomment-1180867579

Outra refer√™ncia √© a #530, onde foi descartada a ideia de colocar o username do autor no final da linha (onde atualmente fica o "tempo de publica√ß√£o"), pois isso daria mais destaque ao autor, imagina uma foto ent√£o...

Nada impede da pessoa colocar fotos na p√°gina de perfil (eu mesmo coloquei). Mas por enquanto a foto precisa estar hospedada em outro local.

Para ter uma maneira oficial de adicionar a foto ao perfil, precisamos primeiro de um sistema de armazenamento de arquivos pr√≥prio. O armazenamento pr√≥prio est√° no radar para permitir fotos nas publica√ß√µes sem depender de hospedagens externas. E quando isso estiver implementado, tamb√©m vai facilitar adicionar fotos na descri√ß√£o do perfil. Mas mesmo estando no radar, n√£o √© algo priorit√°rio por enquanto.

Ent√£o n√£o vejo motivo para deixar a issue aberta, j√° que esse ponto n√£o deve ser implementado (pelo menos n√£o no curto prazo), e que os outros pontos j√° possuem issues pr√≥prias.

Concordam?

>> Coment√°rio de Rafatcb:
Seguindo o que foi discutido nos coment√°rios, e como n√£o houve nenhuma resposta contr√°ria, estou fechando o issue para organizar o reposit√≥rio.

Obrigado pelas sugest√µes, iihieiii!
</issue_1071_Sugest√£o de Usabilidade para o Tabnews - Parte 1>

<issue_1072_Abrir a comunidade de discuss√µes do reposit√≥rio>
Ache que seria bacana configurar no reposit√≥rio a parte de discuss√£o assim poder√≠amos evitar varias issues que s√£o apenas ideias de at√© mesmo votar em algumas antes de se tornar uma issue.

>> Coment√°rio de Rafatcb:
Isso chegou a ser discutido em https://github.com/filipedeschamps/tabnews.com.br/issues/480 , mas o issue foi fechado. Atualmente o https://github.com/filipedeschamps/tabnews.com.br/issues/598 est√° aberto com a mesma sugest√£o.

>> Coment√°rio de acamilateixeira:
@Rafatcb  obrigada! vou fechar essa.
</issue_1072_Abrir a comunidade de discuss√µes do reposit√≥rio>

<issue_1073_busca no site e onde est√° meu artigo?>
Bom dia.<br>
Quero deixar aqui minhas felicita√ß√µes pois foi muito acertiva a ideia para o site. <br>
Mas tamb√©m acho que est√° faltando algo "construtiva",
Campo de busca e notifica√ß√µes para o usu√°rio:<br>
* 1-saber que sua postagem, foi publicada e n√£o est√° em avalia√ß√£o "notifica√ß√£o"<br>
* 2-poder buscar por tabs de sua prefer√™ncia <br>
Obs:.fiz um post e n√£o o acho no site.<br>
Bom dia e parab√©ns.

>> Coment√°rio de mpedroni:
Ol√°! Abri uma issue (#1084) com uma ideia para resolver o problema da busca no site. Quero implementar mas n√£o fa√ßo ideia de como ser√° a aceita√ß√£o disso kkkk ent√£o, se puderem comentar o que pensam sobre, ou se algu√©m j√° teve alguma experi√™ncia com o servi√ßo que propus e queira compartilhar algo, ser√° muito bem vindo!

>> Coment√°rio de Rafatcb:
Hoje, ao publicar um conte√∫do, voc√™ √© redirecionado para a publica√ß√£o e confetes aparecem na p√°gina. Se for para Recentes, a princ√≠pio a publica√ß√£o n√£o aparecer√° por causa do cache, mas ao dar F5 ela aparece.

@aprendendofelipe consegue confirmar se tem uma forma melhor de lidar com isso? Edit: N√£o sei se √© esse o problema: https://github.com/filipedeschamps/tabnews.com.br/issues/1376.

Sobre o segundo ponto, a busca j√° foi implementada: https://github.com/filipedeschamps/tabnews.com.br/pull/1472

>> Coment√°rio de aprendendofelipe:
> Obs:.fiz um post e n√£o o acho no site.

Nem todas publica√ß√µes v√£o para a p√°gina de relevantes.

Na p√°gina `/recentes` as publica√ß√µes ficam classificadas pelo tempo de publica√ß√£o, ent√£o ela deve ter aparecido ali logo ap√≥s o cache da p√°gina ter sido invalidado, ou seja, no primeiro acesso ap√≥s 10 segundos. Se o cache j√° estiver obsoleto, nem precisa de F5, pois o `next-swr` buscar√° os dados recentes em segundo plano e atualizar√° a p√°gina quando eles estiverem dispon√≠veis.

Na √©poca ainda n√£o havia o item <kbd>Meus conte√∫dos</kbd> no menu, ent√£o nem todos sabiam que dava para listar seus conte√∫dos ao clicar no seu username. Nessa p√°gina, `/[username]` na √©poca da issue e `/[username]/conteudos/1` hoje, vale o mesmo sobre o cache.

N√£o ficou claro em que momento n√£o encontrou seu conte√∫do, mas se a procura levou mais do que o tempo de invalida√ß√£o do cache, era para ter encontrado na sua pr√≥pria lista (e nos recentes), ent√£o pode ter procurado apenas nos relevantes. A n√£o ser que sua publica√ß√£o tenha sido exclu√≠da pela modera√ß√£o, caso em que n√£o iria encontr√°-la em nenhum lugar.

Dado que hoje a UX est√° melhor para localizar seus pr√≥prios conte√∫dos, que j√° temos uma barra de busca, e que, fora os pedidos pelo sistema de busca que j√° est√° dispon√≠vel, n√£o houve casos semelhantes de dificuldades para localizar suas pr√≥prias publica√ß√µes, vou encerrar a issue, mas podemos reabrir se surgirem novas informa√ß√µes. ü§ù
</issue_1073_busca no site e onde est√° meu artigo?>

<issue_1074_[SEO] N√£o indexar conte√∫dos mal avaliados>
Gostaria de saber a opini√£o da turma a respeito de indicar aos mecanismos de pesquisa para n√£o indexar conte√∫dos mal avaliados.

Isso n√£o impede a cria√ß√£o de conte√∫dos sem valor concreto, mas evita que esses conte√∫dos prejudiquem o SEO.

Seria s√≥ setar a tag na p√°gina do conte√∫do se ele estiver abaixo de um limiar de tabcoins:¬†

```js
<meta name="robots" content="all" />
```

~~Hoje esse limiar poderia ser de 2 ou 3 tabcoins.~~

[**Edit**] Com as melhorias nas prote√ß√µes da economia, atualmente podemos deixar esse limite em 0 ou -1.

O que pensam sobre isso?

>> Coment√°rio de aprendendofelipe:
Outro caso que acredito que seria bom configurar para n√£o indexar √© a p√°gina de coment√°rio (conte√∫do children).

[**Edit 2**] Falo em n√£o indexar a **p√°gina** do coment√°rio, mas o texto do coment√°rio deve sim ser indexado, s√≥ que associado √† p√°gina do conte√∫do **raiz** correspondente.

Isso porque o mecanismo de pesquisa pode identificar como conte√∫do duplicado, j√° que todo coment√°rio tamb√©m est√° presente na p√°gina do conte√∫do root.

Outro problema relacionado a isso √© que um usu√°rio que faz alguma pesquisa no Google pode ser direcionado para a p√°gina do coment√°rio ao inv√©s de ir para a p√°gina do conte√∫do principal. E isso pode ser confuso para algu√©m n√£o acostumado com o TabNews.

[Edit] Ou ser√° que para os coment√°rios faz sentido usar a tag can√¥nica?

```js
<link
  rel="canonical"
  href="https://example.com/blog/original-post"
  key="canonical"
/>

>> Coment√°rio de silvaezequias:
> [Edit] Ou ser√° que para os coment√°rios faz sentido usar a tag can√¥nica?

Eu acho que para os coment√°rios pode aplicar a mesma ideia usada nos conte√∫dos pai: sobre indexar se atingir um limite de tabcoins
Porque existem coment√°rios que superam quase que 2x o valor do conte√∫do pai e seria interessante indexar esses

> Hoje esse limiar poderia ser de 2 ou 3 tabcoins.

Gosto da ideia de ser um valor baixo inicialmente, s√≥ que eu acho que com o estado atual do tabnews esse valor deve ser um pouquinho mais alto como 6 ou 7. √â muito f√°cil achar posts que n√£o s√£o muito profundos com 5 tabcoins e por ai vai

> Outro problema relacionado a isso √© que um usu√°rio que faz alguma pesquisa no Google pode ser direcionado para a p√°gina do coment√°rio ao inv√©s de ir para a p√°gina do conte√∫do principal. E isso pode ser confuso para algu√©m n√£o acostumado com o TabNews.

Mas os coment√°rios, como uma p√°gina indexada, estariam com o t√≠tulo do conte√∫do principal n√£o √©? Talvez poderia implantar um sistema de apenas destacar (com um scroll automatico, talvez) o coment√°rio (na mesma p√°gina do conte√∫do) pra que o usu√°rio n√£o fique perdido.

>> Coment√°rio de Rafatcb:
Hoje vale considerar que a n√£o-indexa√ß√£o de determinados conte√∫dos impedir√° a busca pelo site, que usa o mecanismo de buscas do Google.

N√£o indexar conte√∫dos pode diminuir bastante os resultados da busca pela plataforma (talvez n√£o seja o desejado). E se tamb√©m n√£o indexar coment√°rios, e o coment√°rio for bem avaliado mas a publica√ß√£o n√£o, n√£o encontraremos ele.

N√£o indexar coment√°rios far√° com que voc√™ precise buscar pelo termo na p√°gina (Ctrl+F) para encontrar o coment√°rio ap√≥s abrir o link. Um exemplo:

![Busca do TabNews](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/92cb76c6-d43f-4fae-85a3-2b0728f1d0eb)

O resultado da busca acima leva para [uma publica√ß√£o](https://www.tabnews.com.br/samuhmatos/qual-e-o-melhor-orm-na-sua-opniao-para-node), mas o texto exibido √© de [um coment√°rio](https://www.tabnews.com.br/rafael/357a2f34-ef2f-4441-912d-77530070064d).

>> Coment√°rio de aprendendofelipe:
> Mas os coment√°rios, como uma p√°gina indexada, estariam com o t√≠tulo do conte√∫do principal n√£o √©?

Isso @silvaezequias, o t√≠tulo do conte√∫do principal aparece na p√°gina do coment√°rio, mas acredito que n√£o seja a melhor "boas vindas" que podemos dar para quem visita o TabNews pela primeira vez.

O Google foi respons√°vel por trazer mais da metade dos visitantes nos √∫ltimos 12 meses. Acho que funciona melhor quando o Google direciona para a p√°gina do conte√∫do raiz daquele coment√°rio. E esse ponto deve ser melhor resolvido usando a tag can√¥nica. üëç

> Hoje vale considerar que a n√£o-indexa√ß√£o de determinados conte√∫dos impedir√° a busca pelo site, que usa o mecanismo de buscas do Google.

Isso mesmo @Rafatcb, a ideia √© limitar o alcance de conte√∫dos mal avaliados, dando mais chance de se encontrar os bem avaliados, o que deve melhorar a taxa de cliques e posicionamento nos mecanismos de busca.

Mas os limiares que eu tinha sugerido (2 ou 3) n√£o fazem sentido no TabNews de hoje. Naquela √©poca n√£o t√≠nhamos os mecanismos atuais de prote√ß√£o da economia, e muitos conte√∫dos ruins tenham saldo positivo. Tanto que o @silvaezequias sugeriu usar valores ainda mais altos (6 ou 7). Hoje eu colocaria como limiar de n√£o indexa√ß√£o algo como 0 ou -1 (vou editar l√° em cima).

Acredito que seja uma medida bem melhor do que excluir os conte√∫dos ruins por nossa conta (melhor deixar a decis√£o de excluir para o autor). Al√©m de que ao melhorarmos nosso sistema de ranqueamento, isso pode criar casos em que um conte√∫do negativado ainda √© relevante devido aos coment√°rios.

Bom citar que falo da relev√¢ncia do conte√∫do e n√£o de viola√ß√µes dos termos. Em casos de viola√ß√µes os conte√∫dos devem sim ser exclu√≠dos.

> N√£o indexar conte√∫dos pode diminuir bastante os resultados da busca pela plataforma (talvez n√£o seja o desejado).

A ideia √© s√≥ deixar de indexar conte√∫dos que prejudiquem o SEO. Mais especificamente:

- Melhorar o posicionamento do site nos resultados, aumentando assim as visitas;
- Mostrar conte√∫dos com mais chances de atrair novos usu√°rios org√¢nicos;
- N√£o mostrar conte√∫dos que prejudiquem a primeira impress√£o de novos visitantes;

Um exemplo do √∫ltimo ponto s√£o os clickbaits. Mesmo que a comunidade j√° tenha negativado a publica√ß√£o, o Google n√£o enxerga isso.

O Google inicialmente s√≥ percebe um aumento nos cliques e, por isso, aumenta momentaneamente o alcance dessas publica√ß√µes (em detrimento de outras), mas nos dias seguintes isso causa uma grande redu√ß√£o do alcance (como penalidade), pois o Google percebe que quem clicou nos links n√£o gostou do que viu (usu√°rio saiu logo do site, clicou em "n√£o ver mais resultados assim" etc.), ent√£o o Google diminui as recomenda√ß√µes em geral do site, n√£o apenas das publica√ß√µes que causaram o comportamento ruim.

Normalmente demora para voltar ao n√≠vel de antes do clickbait, ent√£o o preju√≠zo com a diminui√ß√£o no alcance acaba sendo muito maior do que algum ganho de novos visitantes org√¢nicos que conheceram o TabNews por clickbaits.

> E se tamb√©m n√£o indexar coment√°rios, e o coment√°rio for bem avaliado mas a publica√ß√£o n√£o, n√£o encontraremos ele.
>
> N√£o indexar coment√°rios far√° com que voc√™ precise buscar pelo termo na p√°gina (Ctrl+F) para encontrar o coment√°rio ap√≥s abrir o link. Um exemplo:

N√£o indexar coment√°rios √© uma p√©ssima ideia, e entendo que √© uma interpreta√ß√£o poss√≠vel do que eu falei. üòï N√£o tive sucesso em deixar claro que falava de n√£o indexar a **p√°gina** do coment√°rio üòÖ, tanto que em poucos minutos eu editei sugerindo usar a tag can√¥nica. Vou editar de novo deixando mais claro que o texto do coment√°rio deve ser indexado, mas ser associado com a p√°gina do conte√∫do raiz e n√£o como uma p√°gina isolada. üëç

>> Coment√°rio de Rafatcb:
> Hoje eu colocaria como limiar de n√£o indexa√ß√£o algo como 0 ou -1 (vou editar l√° em cima).

Faz sentido para mim.

> N√£o indexar coment√°rios √© uma p√©ssima ideia, e entendo que √© uma interpreta√ß√£o poss√≠vel do que eu falei. üòï N√£o tive sucesso em deixar claro que falava de n√£o indexar a **p√°gina** do coment√°rio üòÖ

No exemplo que dei, estava querendo mencionar o caso de uma publica√ß√£o raiz que n√£o fosse indexada (por estar com Tabcoins abaixo do crit√©rio definido) e o coment√°rio com uma boa quantia de TabCoins. Com a "nota de corte" sendo `0` ou `-1`, isso deve acontecer menos, mas provavelmente ainda acontecer√°.

Um exemplo: a publica√ß√£o [Ajuda na Escolha do Framework: Next.js ou React.js?](https://www.tabnews.com.br/Leodev/ajuda-na-escolha-do-framework-next-js-ou-react-js) est√° com 0 TabCoins, mas o coment√°rio mais votado tem 4. Seria poss√≠vel encontr√°-lo, se n√£o estiv√©ssemos indexando as p√°ginas com TabCoins menor ou igual a zero, e estivessemos usando a tag can√¥nica nos coment√°rios?

Eu acho que faz sentido n√£o entrar diretamente no coment√°rio pelo Google (j√° passei por isso e √© meio estranho mesmo), s√≥ estou com essa d√∫vida mesmo.
</issue_1074_[SEO] N√£o indexar conte√∫dos mal avaliados>

<issue_1075_Bot√£o "Publicar novo conte√∫do" na barra de navega√ß√£o.>
N√£o foi dif√≠cil achar o item de menu "Publicar novo conte√∫do" localizado no √≠cone de usu√°rio no canto superior direito, mas um lugar mais √≥bvio seria localizado imediatamente na barra de navega√ß√£o, inclusive de uma cor que o destaque.

>> Coment√°rio de gabrielew:
√â interessante, mas talvez onde esta seja bom, pois pessoas que realmente querem publicar ir√£o procurar.
"Achismo"

>> Coment√°rio de TheSirion:
> √â interessante, mas talvez onde esta seja bom, pois pessoas que realmente querem publicar ir√£o procurar. "Achismo"

Eu acho o contr√°rio. Acho que um bot√£o mais vis√≠vel e f√°cil de localizar √© interessante e conveniente. Dever√≠amos _incentivar_ os usu√°rios a criar conte√∫do, e n√£o dificultar. Se o conte√∫do acabar por ser de baixa qualidade, temos outros mecanismos para lidar com isso.

>> Coment√°rio de fabiosvm:
Pode n√£o ser uma boa compara√ß√£o, mas o [Stack Overflow](https://stackoverflow.com/) destaca seu bot√£o `Ask Question` ap√≥s o login.

![image](https://user-images.githubusercontent.com/3144754/206026737-c6ebc16c-825d-48ee-9aae-48c27a1eaf06.png)

>> Coment√°rio de ermesonqueiroz:
Implementando essa feature, o que seria feito com o bot√£o j√° existente?
Seria mantido ou removido?

>> Coment√°rio de fabiosvm:
O do menu quando clica no √≠cone de usu√°rio? Talvez remover.

S√≥ um detalhe: acho que esse bot√£o "Publicar novo conte√∫do" deve aparecer em dois lugares: na home quando o usu√°rio estiver logado e em "Meus conte√∫dos".

>> Coment√°rio de ermesonqueiroz:
> O do menu quando clica no √≠cone de usu√°rio?

Isso.

> S√≥ um detalhe: acho que esse bot√£o "Publicar novo conte√∫do" deve aparecer em dois lugares: na home quando o usu√°rio estiver logado e em "Meus conte√∫dos".

N√£o entendi muito bem, esse bot√£o n√£o iria ficar na barra de navega√ß√£o do usu√°rio logado, assim como temos no GitHub?

![image](https://user-images.githubusercontent.com/111156073/225157842-b4d8cd73-afcf-427f-9a9d-4158dcd5a446.png)

>> Coment√°rio de aprendendofelipe:
Pessoal, o que trava isso por enquanto √© a falta de um header exclusivo para telas pequenas, pois n√£o h√° mais espa√ßo para adicionar nada.

Mas isso logo deve mudar com um PR em andamento, e seria legal ter mais gente contribuindo com a conversa no #1279 

L√° eu sugeri adicionar ao header o bot√£o de publicar, ent√£o essa adi√ß√£o poder√° facilmente se extender √† vers√£o em tela grande.

Por favor, opinem tamb√©m sobre essa minha sugest√£o https://github.com/filipedeschamps/tabnews.com.br/pull/1279#issuecomment-1465284802

>> Coment√°rio de fabiosvm:
> > O do menu quando clica no √≠cone de usu√°rio?
> 
> Isso.
> 
> > S√≥ um detalhe: acho que esse bot√£o "Publicar novo conte√∫do" deve aparecer em dois lugares: na home quando o usu√°rio estiver logado e em "Meus conte√∫dos".
> 
> N√£o entendi muito bem, esse bot√£o n√£o iria ficar na barra de navega√ß√£o do usu√°rio logado, assim como temos no GitHub?
> 
> ![image](https://user-images.githubusercontent.com/111156073/225157842-b4d8cd73-afcf-427f-9a9d-4158dcd5a446.png)

Se ficar na barra, ent√£o atende o que falei. O bot√£o ficar√° em qualquer p√°gina que tem a barra.

>> Coment√°rio de aprendendofelipe:
No #1349 o @victorhcb implementou um bot√£o no header de dispositivos com telas maiores üéâ

Ent√£o vou encerrar aqui ü§ù
</issue_1075_Bot√£o "Publicar novo conte√∫do" na barra de navega√ß√£o.>

<issue_1076_Adicionar suporte ao asciinema>
O [asciinema](https://asciinema.org/) √© uma plataforma para compartilhar grava√ß√µes de terminal feitas em SVG. √â um jeito bem bacana de compartilhar, visualmente, como fazer as coisas no terminal (voc√™s podem ver um exemplo do uso em um artigo meu [aqui](https://dev.to/douglasdemoura/use-this-npm-script-to-create-your-editorconfig-files-1e3c)).

>> Coment√°rio de Rafatcb:
No seu artigo do dev.to, voc√™ precisou incluir por meio do script? Por exemplo, adicionando `<script async id="asciicast-569727" src="https://asciinema.org/a/569727.js"></script>` no artigo?

>> Coment√°rio de aprendendofelipe:
Por enquanto √© poss√≠vel exibir a grava√ß√£o do asciinema usando SVG:

```md
<img src="https://raw.githubusercontent.com/OrKoN/newsletter-cli/master/demo.svg?sanitize=true">
```

ou


```md
![](https://raw.githubusercontent.com/OrKoN/newsletter-cli/master/demo.svg?sanitize=true)
```

Que resulta em:

<img src="https://raw.githubusercontent.com/OrKoN/newsletter-cli/master/demo.svg?sanitize=true">

Assim como para inserir qualquer imagem no TabNews, √© preciso fornecer a URL de onde o arquivo foi hospedado.

Algumas desvantagens desse m√©todo s√£o:

- A performance, pois o processamento do SVG pode ser pesado, principalmente se houver mais de um na mesma publica√ß√£o. 
- N√£o √© poss√≠vel copiar o conte√∫do do terminal.

---

Eu acredito que adicionar o texto em um bloco de c√≥digo (como no exemplo abaixo) nos atende bem, seja na apresenta√ß√£o (did√°tica, acessibilidade, vis√£o completa etc.) ou pela indexa√ß√£o pelos mecanismos de busca:

```shell
# Rodar apenas /tests/api/v1/_use-cases/registration-flow.test.js
npm run test:watch -- registration-flow

# Rodar todos os testes de "users" da api "v1"
npm run test:watch -- v1/users/

# Rodar apenas /tests/api/v1/users/[username]/patch.test.js
npm run test:watch -- username./patch

# tests/integration/api/v1/contents/[username]/[slug]/get.test.js
npm run test:watch -- contents/.username./.slug./get
```

>> Coment√°rio de Rafatcb:
Eu concordo que texto cumpre bem o papel, apesar do svg "gif" parecer mais bonito. Esse SVG que voc√™ publicou s√≥ come√ßou a rodar para mim depois que abri o link do SVG em uma nova guia para ver se o problema era o GitHub.

O caso de uso que enxergo que isso poderia ser √∫til seria para mostrar alguma ferramenta pelo terminal, mas a√≠ acho que um GIF satisfaz essa necessidade sem precisar adicionar uma tag `<script> ou depender de um `<svg>`, que pode dar problemas como eu relatei no primeiro par√°grafo.

>> Coment√°rio de Rafatcb:
Seguindo o que foi discutido nos coment√°rios sobre como colocar esse tipo de informa√ß√£o num conte√∫do do TabNews, vamos seguir sem a adi√ß√£o do asciinema diretamente, para n√£o adicionar uma nova depend√™ncia de um script de terceiros para ter um desempenho melhor nas buscas ao colocar o c√≥digo em texto e um exemplo em GIF (ou SVG).

Obrigado pela sugest√£o, Douglas! Estou fechando o issue para a organiza√ß√£o do reposit√≥rio.
</issue_1076_Adicionar suporte ao asciinema>

<issue_1077_Permitir a adi√ß√£o de URLs can√¥nicas para o conte√∫do>
Algumas vezes, o usu√°rio tem um blog pr√≥prio e deseja republicar o conte√∫do no TabNews. Nestes casos, √© preciso definir a [URL can√¥nica](https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls?hl=pt-br) daquele conte√∫do, de modo que o artigo n√£o apare√ßa, de maneira duplicada, nos resultados de pesquisa.

## Exemplo

Como adicionar uma URL can√¥nica no [dev.to](https://dev.to/):
![image](https://user-images.githubusercontent.com/564542/205396847-74369c5f-1e7e-4798-bed9-d2b1c177ca99.png)

>> Coment√°rio de aprendendofelipe:
@DouglasdeMoura, vamos centralizar a discuss√£o nessa #860 que √© mais antiga. Combinado? ü§ù
</issue_1077_Permitir a adi√ß√£o de URLs can√¥nicas para o conte√∫do>

<issue_1078_[REPORT]Bug Redirecionamento>
**ATEN√á√ÉO: JA REPORTEI PELO EMAIL POREM COMO JA SE PASSARAM 24H E N√ÉO TIVE RETORNO ACHEI POR BEM ABRIR UMA ISSUES PARA REPORTAR**

Meio que sem querer descobri que existe uma forma de jogar qualquer usuario LOGADO no Tabnews para um link externo segue o link

`https://tabnews.com.br/login?redirect=https://tabnews.com.br/login?redirect=https://www.youtube.com/watch?v=uv3ghuwSSf0`
OBS.: Caso n√£o redirecione 2 vezes ele te joga pra dentro do Tabnews e ignora o redirecionamento externo.

Como e visto quanto compartilhado o link (N√£o usei encurtador no segundo redirecionamento em um exemplo real seria um ponto crucial para capturar mais usuarios)
![Screenshot_2](https://user-images.githubusercontent.com/8114976/205405016-02642266-b7b7-4b2f-b9cd-a5a97d0bf16f.png)

>> Coment√°rio de filipedeschamps:
@cybernerd007 show, eu vi o seu email mas n√£o tive tempo de reportar. N√£o atuei de imediato nesta quest√£o por n√£o considerar cr√≠tica (que √© acessar ou alterar alguma informa√ß√£o privada fora do seu escopo de usu√°rio). Ent√£o iria incluir ela dentro da pr√≥xima Milestone sobre Performance e Seguran√ßa.

Mas posso estar enganado na minha avalia√ß√£o, ent√£o pergunto: ela √© cr√≠tica?

Obrigado ü§ù

>> Coment√°rio de cybernerd007:
Me dediquei 5 minutinhos para fazer esse pequeno exemplo...
coloca o mouse em cima do [LINK TESTE](https://tabnews.com.br/login?redirect=https://tabnews.com.br/login?redirect=https://tabnews-seven.vercel.app/) e verifica a URL que aparece...(n√£o usei nenhum encurtador mais poderia)
agora clicka nele(no link)....
Bom essa pagina FAKE que eu fiz seria para coletar os dados porem ela n√£o funciona ja que e para uma simples demostra√ß√£o.

agora pensa, ja imaginou aparecer um **E-mail** escrito fulano respondeu seu post e o link e esse **FAKE** ou ate mesmo **Compartilhado no whatsapp**.

ai eu te devolvo a pergunta: voc√™ cairia? agora alguem desatento cairia?
se a resposta for sim para **UMA** e **MEDIA** se for sim para as **DUAS** e **GRAVE**... agora se for n√£o absulutamente e baixa kkkk

fico feliz por ajudar a comunidade, estou SEMPRE a disposi√ß√£o...

>> Coment√°rio de cybernerd007:
**LEMBRANDO O USUARIO TEM QUE ESTAR LOGADO PARA FUNCIONAR**

>> Coment√°rio de Gabriel-Tapes:
Uma outra forma de explorar o bug seria mandando um link de login que redireciona para uma falsa p√°gina de login, assim seria poss√≠vel obter email e senha do usu√°rio. √â claro que o usu√°rio facilmente poderia perceber ao olhar a URL da p√°gina, mas tenho certeza que pouqu√≠ssimos verificam sempre a URL em p√°ginas que visitam frequentemente como redes sociais, ent√£o muitos cairiam.

>> Coment√°rio de filipedeschamps:
@cybernerd007 o @aprendendofelipe fez o PR #1081 que lida com este tipo de situa√ß√£o e acabamos de fazer o deploy.

Voc√™ pode realizar uma nova bateria de testes? ü§ù 

Caso precise criar novos conte√∫dos, voc√™ pode usar a √∫ltima branch de Homologa√ß√£o: https://tabnews-8kgcqlch1-tabnews.vercel.app/

Caso contr√°rio, voc√™ j√° pode testar em produ√ß√£o: https://www.tabnews.com.br/

>> Coment√°rio de cybernerd007:
@filipedeschamps Fiz os testes e foi **CORRIGIDO** üéâüéâüéâ

Vou ficar com o link do ambiente de homologa√ß√£o para continuar com os testes anteriores....

fico feliz em poder ajudar a deixar nosso pedacinho de internet mais seguro.

**FICO A DISPOSI√á√ÉO**

>> Coment√°rio de filipedeschamps:
Sensacional meu caro! Pe√ßo perd√£o por n√£o conseguir responder seu email a tempo, eu toco sozinho aquele email e toda carga do restante do TabNews e da vida t√° bem pesada üòÖ

Bom, muito obrigado @cybernerd007 por encontrar a falha, @Gabriel-Tapes por participar e @aprendendofelipe por consertar ü§ù
</issue_1078_[REPORT]Bug Redirecionamento>

<issue_1079_[FEATURE/SUGEST√ÉO] desfazer upvotes/downvotes>
Acabei de passar por um problema de misclick e acabei dando downvotes em um coment√°rio o qual n√£o tinha necessidade, o problema √© que n√£o existe forma de desfazer esta a√ß√£o.

A ideia seria alem de ter como desfazer esta a√ß√£o, por mais que seja algo que possa ocorrer poucas vezes, √© importante pois pode tirar ou dar tabcoins indevidamente da pessoa.

isso tbm permite que postagens que est√£o recebendo donwvotes, apos serem ajustadas, possam ser retiradas.

>> Coment√°rio de AndreLuisOvidio:
Isso acabou de ocorrer comigo, minha cabe√ßa associou o bot√£o de downvote com o bot√£o de fechar coment√°rios, algo parecido com o bot√£o de fechar pastas no vscode:
 
![image](https://user-images.githubusercontent.com/74057361/205449088-4ad0deb4-1bd0-4365-9707-7d4ed00db41e.png)

![image](https://user-images.githubusercontent.com/74057361/205449124-fc762225-2005-415b-983f-2f8c1a367576.png)

>> Coment√°rio de alberto255345:
Acho que √© necess√°rio. Principalmente em um sistema de transa√ß√£o.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Temos a issue #1183 em que a discuss√£o avan√ßou um pouco mais, ent√£o vamos fechar essa aqui e direcionar o debate para l√° ü§ù
</issue_1079_[FEATURE/SUGEST√ÉO] desfazer upvotes/downvotes>

<issue_1083_"Access denied" ao acessar o site>
Esteou desenvolvendo um projeto de utilizar a API do tabnews para criar uma interface para o terminal: https://github.com/vadolasi/tabnews-cli

Durante os meus testes, eu realmente acabo fazendo bastante chamas as vezes. Mas ultimanente, tenho recibido muitos bloqueios, e agr quando fui tentar acessar o site me deparei com a seguinte tela:

```
Access denied Error code 1020
You cannot access tabnews.com.br. Refresh the page or contact the site owner to request access.

Troubleshooting information
Copy and paste the Ray ID when you contact the site owner.

Ray ID: 773deb033d099acb
```

>> Coment√°rio de cybernerd007:
Recomendo enviar um email para `contato@tabnews.com.br` com seu `IP` e relatando o ocorrido.
isso tb ja aconteceu cmg kkkkk

>> Coment√°rio de filipedeschamps:
@vadolasi obrigado pelas informa√ß√µes, de fato seu CLI est√° fazendo muitas chamadas, principalmente `GET` contra o endpoint `/api/v1/user`. Veja o gr√°fico abaixo, mesmo dentro do rate limit, voc√™ estava fazendo em m√©dia `400` requests a cada 30 segundos:

![image](https://user-images.githubusercontent.com/4248081/205457279-3cd44180-00de-4590-a3d8-1d6afc9c2a0e.png)

Fora do rate limit voc√™ fez em m√©dia `1.600` requests por minuto contra o mesmo endpoint:

<img width="836" alt="image" src="https://user-images.githubusercontent.com/4248081/205457372-b4a1dbf5-7ed1-48a6-9ecb-d9102c06a173.png">

Eu pe√ßo encarecidamente que voc√™ avalie o que o seu CLI est√° fazendo para precisar de tantas chamadas, principalmente contra o endpoint `/api/v1/user` (que deveria ser chamado s√≥ em situa√ß√µes espec√≠ficas).

**[edit]**

IP liberado

>> Coment√°rio de vadolasi:
Vou dar uma olhada, certamente √© algum bug. Perd√£o pelo transtorno e
obrigado pelas informa√ß√µes!

Em s√°b., 3 de dez. de 2022 √†s 15:59, Filipe Deschamps <
***@***.***> escreveu:

> @vadolasi <https://github.com/vadolasi> obrigado pelas informa√ß√µes, de
> fato seu CLI est√° fazendo muitas chamadas, principalmente GET contra o
> endpoint /api/v1/user. Veja o gr√°fico abaixo, mesmo dentro do rate limit,
> voc√™ estava fazendo em m√©dia 400 requests a cada 30 segundos:
>
> [image: image]
> <https://user-images.githubusercontent.com/4248081/205457279-3cd44180-00de-4590-a3d8-1d6afc9c2a0e.png>
>
> Fora do rate limit voc√™ fez em m√©dia 1.600 requests por minuto contra o
> mesmo endpoint:
>
> [image: image]
> <https://user-images.githubusercontent.com/4248081/205457372-b4a1dbf5-7ed1-48a6-9ecb-d9102c06a173.png>
>
> Eu pe√ßo encarecidamente que voc√™ avalie o que o seu CLI est√° fazendo para
> precisar de tantas chamadas, principalmente contra o endpoint /api/v1/user
> (que deveria ser chamado s√≥ em situa√ß√µes espec√≠ficas).
>
> ‚Äî
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/1083#issuecomment-1336219088>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AJMHKFHJVCQONNHGMD4PEHLWLOJ77ANCNFSM6AAAAAASS3GDJE>
> .
> You are receiving this because you were mentioned.Message ID:
> ***@***.***>
>

>> Coment√°rio de coffeeispower:
Cl√°ssico...
</issue_1083_"Access denied" ao acessar o site>

<issue_1084_Ideia de implementa√ß√£o para busca de `contents` publicados>
## Contexto

Acredito que se faz necess√°rio no TabNews um mecanismo de busca eficiente e preciso para que os usu√°rios consigam encontrar o que precisam, al√©m de evitar a duplica√ß√£o de `contents`. Por conta disso, quero abrir essa discuss√£o e propor uma solu√ß√£o para esse problema.

## Solu√ß√µes existentes

Implementar esse tipo de solu√ß√£o do zero acredito ser invi√°vel devido a complexidade envolvida nesses tipos de mecanismos de busca, al√©m de n√£o ser o diferencial do TabNews, n√£o tendo necessidade ser algo desenvolvido "internamente". Portanto vejo que faz sentido utilizar algum servi√ßo existente, sendo necess√°rio avaliar os custos necess√°rios para tal.

Indo mais direto ao ponto, imagino que os servi√ßos mais conhecidos que resolveriam esse problema de busca s√£o o [Algolia](https://www.algolia.com/) e o [ElasticSearch](https://www.elastic.co/elasticsearch/). Ambos servi√ßos tem "fama" de ter altos custos de utiliza√ß√£o e n√£o s√£o ferramentas _open source_ (o Algolia √© _closed source_ e o ElasticSearch √© distribu√≠do sob a licen√ßa SSPL que, [segundo a Open Source Initiative](https://opensource.org/node/1099), n√£o se trata de uma licen√ßa _open source_.

## Solu√ß√£o Proposta

Uma outra solu√ß√£o que poderia resolver o problema em quest√£o √© o [MeiliSearch](https://www.meilisearch.com/), que √© um sistema _open source_ (licen√ßa MIT) e que acredito fazer sentido no contexto do TabNews. O MeiliSearch possui um servi√ßo em nuvem pr√≥prio (uma esp√©cie de MeiliSearch gerenciado) que √© pago, por√©m √© poss√≠vel rodar o MeiliSearch em um container e utiliz√°-lo sem custo adicional al√©m dos recursos computacionais necess√°rios para rodar ele.

## Conclus√£o

Acredito que utilizar uma solu√ß√£o desse tipo fa√ßa sentido no TabNews visto que, na minha vis√£o, um sistema de busca eficiente √© um ponto importante para a aceita√ß√£o e continua√ß√£o do projeto.

N√£o deixem de contribuir com as suas opini√µes sobre isso!

>> Coment√°rio de italosll:
Busca de tabs √© a feature cuja aus√™ncia mais me incomoda, me d√° a sensa√ß√£o de que os conteudos passados ser√£o perdidos, porqu√™ n√£o h√° uma forma de alcan√ßa-los...  Infelizmente n√£o tenho qualifica√ß√£o para opinar sobre a melhor forma de implementar esse servi√ßo...

>> Coment√°rio de mpedroni:
> Busca de tabs √© a feature cuja aus√™ncia mais me incomoda, me d√° a sensa√ß√£o de que os conteudos passados ser√£o perdidos, porqu√™ n√£o h√° uma forma de alcan√ßa-los... Infelizmente n√£o tenho qualifica√ß√£o para opinar sobre a melhor forma de implementar esse servi√ßo...

Concordo... e, como falei, acredito que deva ser um sistema de busca mais robusto porque, do meu ponto de vista, encontrar conte√∫dos espec√≠ficos dentro do TabNews deveria ser uma feature core, e acredito que o MeiliSearch consegue entregar isso com um bom custo benef√≠cio.

Quero come√ßar a implementar essa solu√ß√£o mas n√£o sei como funciona o processo, se a gente s√≥ implementa e abre o PR ou se √© necess√°rio abrir a issue primeiro e discutir a proposta com o @filipedeschamps e com a comunidade (acredito que a segunda op√ß√£o fa√ßa mais sentido kkk)

>> Coment√°rio de jjpaulo2:
@mpedroni gostei da sua ideia.

Talvez o primeiro passo seja transformar o campo `title` em um index do postgres, e caso o postgres venha a se tornar um gargalo, podemos enviar esses index pra algum banco de busca, como o caso do MeiliSearch.

>> Coment√°rio de mpedroni:
@jjpaulo2 pode ser uma boa... o √∫nico problema que vejo nisso √© a limita√ß√£o que esse tipo de busca, pois as buscas precisariam ser muito exatas e pouco flex√≠veis para se encontrar os posts relevantes, sem contar que seria √∫til poder incluir o conte√∫do do post na busca tamb√©m.

De qualquer forma, concordo contigo de que esse seria um bom primeiro passo para essa feature e ver se s√≥ isso j√° resolve o problema.

Uma outra coisa, saberias dizer se o index no banco de dados tamb√©m ajuda para buscas do tipo LIKE (`title LIKE "%query%"`) ou apenas para buscas exatas (`title = query`)?

>> Coment√°rio de jjpaulo2:
@mpedroni at√© onde eu conhe√ßo o postgres, o ideal √© usar o m√≥dulo `pg_trgm` e criar indexes baseados no gin.

Podemos fazer essa tentativa e validar a feature. Encontrei um artigo falando sobre esses index de texto aqui:

https://niallburkley.com/blog/index-columns-for-like-in-postgres/

>> Coment√°rio de mpedroni:
Excelente! Achei muito promissor o `pg_trgm`, ainda n√£o conhecia. Vamos validar essa feature sim e ver se h√° realmente necessidade de utilizar uma solu√ß√£o mais parruda tipo o MeiliSearch ou se o `pg_trgm` j√° resolve

>> Coment√°rio de jjpaulo2:
Pelo que eu vi aqui √© mais f√°cil do que parece adicionar essa extens√£o. A ferramenta de migrations que o projeto t√° usando d√° suporte √† instala√ß√£o de extens√µes.

https://salsita.github.io/node-pg-migrate/#/extensions

Acho que agora √© s√≥ mandar a ver @mpedroni. A partir da pr√≥xima semana, eu consigo ajudar codando algo que for necess√°rio.

>> Coment√°rio de jjpaulo2:
Posso ajudar nessa quest√£o de configurar o banco com a extens√£o, o index e construir as querys üòÑ

Podemos fechar um escopo pra essa busca? Que tal nesse momento inicial fechar a busca apenas pelo t√≠tulo da postagem?

>> Coment√°rio de codigocafe:
@mpedroni e @jjpaulo2 , voc√™s j√° viram essa fun√ß√£o nativa de banco "full-text search"?  

Veja o v√≠deo do Dias de Dev. 

https://youtu.be/zjNPAPknZgE

>> Coment√°rio de jjpaulo2:
@codigocafe os indexes GIN/GiST s√£o a forma de construir buscas full-text no postgres üòÑ

>> Coment√°rio de codigocafe:
@jjpaulo2 , desculpa, mas n√£o entendo muito de Postgres, mas o GIN/GiST resolveria este problema? Outra d√∫vida √© se dessa forma a busca iria acarretar em um sobrecarga no DB?

>> Coment√°rio de mpedroni:
> Pelo que eu vi aqui √© mais f√°cil do que parece adicionar essa extens√£o. A ferramenta de migrations que o projeto t√° usando d√° suporte √† instala√ß√£o de extens√µes.
> 
> https://salsita.github.io/node-pg-migrate/#/extensions
> 
> Acho que agora √© s√≥ mandar a ver @mpedroni. A partir da pr√≥xima semana, eu consigo ajudar codando algo que for necess√°rio.

@jjpaulo2 Fechoou! Eu estou estudando um pouco sobre isso para poder come√ßar a implementar algo, al√©m de estudar um pouco sobre o pr√≥prio projeto. Acredito que essa semana consigo subir alguma coisa, a√≠ abro um PR vinculado com essa issue a gente vai contribuindo l√°. Pode ser?



> Posso ajudar nessa quest√£o de configurar o banco com a extens√£o, o index e construir as querys üòÑ
> 
> Podemos fechar um escopo pra essa busca? Que tal nesse momento inicial fechar a busca apenas pelo t√≠tulo da postagem?

Achei uma √≥tima ideia

>> Coment√°rio de mpedroni:
> @jjpaulo2 , desculpa, mas n√£o entendo muito de Postgres, mas o GIN/GiST resolveria este problema? Outra d√∫vida √© se dessa forma a busca iria acarretar em um sobrecarga no DB?

@codigocafe ent√£o, tamb√©m n√£o sou um grande entendedor de Postgres, mas acredito que as buscas nesse caso teriam um desempenho bom por conta de estarem usando um √≠ndice feito pra esse tipo de busca (no artigo que o @jjpaulo2 d√° de ver bem isso). Nesse caso, acredito que o que poderia sobrecarregar o banco seriam muitas consultas concorrentes, e nesse caso acredito que ter√≠amos que pensar em algum tipo de escalabilidade, seja utilizando cache ou r√©plicas de leitura do banco de dados.

De qualquer forma, acredito que seja algo que precisar√≠amos testar na pr√°tica pra ver como o banco vai se comportar

>> Coment√°rio de jjpaulo2:
@codigocafe sobrecarregar a ponto de derrubar, eu acredito que n√£o. Mas vai aumentar razoavelmente o consumo, porque provavelmente vai ser uma feature bastante usada.

>> Coment√°rio de mpedroni:
pessoal, eu estava navegando aqui pelo reposit√≥rio e encontrei uma ferramenta desenvolvida pelo @Karyton , dispon√≠vel nesse [repo](https://github.com/Karytonn/tabnews-google-search). Basicamente, trata-se de uma extens√£o para o navegador que faz buscas no Google com o formato `${query} site:tabnews.com.br`. Dessa forma, o Google retorna apenas os resultados sob o dom√≠nio `tabnews.com.br`.

Confesso que fiquei admirado com a efici√™ncia das buscas e fiquei me perguntando se, nesse momento, realmente se faz necess√°rio implementar um sistema de busca pr√≥prio ou utilizar a extens√£o ou o pr√≥prio Google j√° resolveria o problema (com buscas mais eficientes inclusive)?

PS: Vi em um post no TabNews algu√©m falar que os conte√∫dos postados levam cerca de 1 dia para serem indexados

PS 2: Na minha opini√£o, vale a pena utilizar o Google para buscar posts do TabNews, que al√©m de n√£o gerar custo nenhum pro TabNews, √© extremamente eficiente e resolve o problema tranquilamente. O √∫nico problema que vejo √© que √© uma "feature" escondida. Acho que seria interessante ter pelo menos uma barra de busca dentro do TabNews que, assim que o usu√°rio fizer uma pesquisa, ele √© redirecionado para o Google com a pesquisa j√° feita. Acredito ser o melhor custo benef√≠cio entre valor gerado (usu√°rio encontrar o que procura) e custo para manter (nesse caso, de gra√ßa).

PS 3: [Aqui um exemplo da busca utilizando o Google](https://www.google.com/search?q=domain-driven+design+site%3Atabnews.com.br). Pesquisei pelo termo "Domain-Driven Design", filtrando apenas por resultados do TabNews.

>> Coment√°rio de aprendendofelipe:
@mpedroni, obrigado pela sugest√£o! üí™

Obrigado tamb√©m aos que contribu√≠ram na discuss√£o! ü§©

Apesar da conversa nessa issue ter se desenvolvido bastante, eu j√° direcionei diversas outras issues parecidas para a #927, que √© mais antiga, ent√£o recomendo centralizarmos a conversa l√°.

Vou fechar essa aqui. Combinado? ü§ù
</issue_1084_Ideia de implementa√ß√£o para busca de `contents` publicados>

<issue_1086_Estrelas como no Github, para guardar como favorito>
[FEATURE/SUGEST√ÉO]
Poder dar "estrela" para guardar como favorito e ler depois, assim como no Github.

>> Coment√°rio de emerson-oliveira:
## [Sugest√£o / Melhoria] Implementar Funcionalidade de Favoritos

### Descri√ß√£o:
Recentemente, encontrei um site chamado [CodeBites](https://www.codebites.dev/), que √© um agregador de artigos de blogs para desenvolvedores. Uma das funcionalidades que me chamou a aten√ß√£o foi a capacidade de adicionar postagens como favoritas. Acredito que seria muito √∫til se pud√©ssemos desenvolver uma funcionalidade similar em nosso site.

## Proposta
Minha sugest√£o √© implementar uma funcionalidade de favoritos em nosso site, similar ao que o CodeBites faz. Isso permitiria aos nossos usu√°rios marcar artigos de seu interesse para leitura futura.

## Benef√≠cios
Ao implementar essa funcionalidade, poder√≠amos:
1. Aumentar o engajamento dos usu√°rios, pois eles teriam a facilidade de salvar conte√∫dos de interesse.
2. Tornar nosso site um recurso mais personalizado e √∫til para nossa comunidade de usu√°rios.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1086_Estrelas como no Github, para guardar como favorito>

<issue_1087_Tabcoin Erro>
Bom hoje estava com 1tabcoin decidi apagar um comentario que era 1tabcoin logo pensei 1-1= 0... mas para a minha surpresa ficou -1 tabcoin fiquei sem entender pq ele n√£o passou pelo ZERO j√° que comentario voc√™ ganha 1tabcoin acredito ser um erro.

>> Coment√°rio de cybernerd007:
PS.: fiz alguns testes e realmente ele n√£o esta passando pelo ZERO ele esta pulando direto para o -1

>> Coment√°rio de 33gustavo33:
toda vez que voc√™ apaga um coment√°rio/post voc√™ perde **2** tabcoins.

Como voc√™ tinha 1 tabcoin, ent√£o faz sentido que voc√™ tenha ficado com -1 tabcoin.
$(1 - 2 = -1)$

>> Coment√°rio de filipedeschamps:
Adicionando mais alguns pontos:

1. Toda vez que voc√™ deleta uma publica√ß√£o (`root` ou `child`), voc√™ perde as TabCoins originais que ganhou criando ela, ou seja, hoje `2` TabCoins.
2. Al√©m disso, se uma publica√ß√£o possu√≠a TabCoins **positivas**, voc√™ tamb√©m perde elas.
3. Mas se uma publica√ß√£o possu√≠a TabCoins negativas, ao deletar, voc√™ continua sendo negativado por elas.
</issue_1087_Tabcoin Erro>

<issue_1088_Colocar os artigos criados no perfil>
N√£o consigo encontrar um artigo que criei, poderiam colocar no perfil do usu√°rio para ficar f√°cil de achar, para editar, deletar ou algo do tipo.

>> Coment√°rio de jjeanjacques10:
@guxtavodev J√° temos os artigos criados no perfil, s√≥ ir no menu e selecionar seu nickname. Ser√° apresentada uma lista com seus artigos.

![image](https://user-images.githubusercontent.com/32225403/205665183-c7e54e26-87e9-4a64-a16d-2b97480fd99c.png)

>> Coment√°rio de Jeiel0rbit:
> @guxtavodev J√° temos os artigos criados no perfil, s√≥ ir no menu e selecionar seu nickname. Ser√° apresentada uma lista com seus artigos.
> 
> ![image](https://user-images.githubusercontent.com/32225403/205665183-c7e54e26-87e9-4a64-a16d-2b97480fd99c.png)
> 

N√£o s√≥ os artigos como os coment√°rios feitos.

>> Coment√°rio de jjeanjacques10:
Concordo, talvez adicionar 2 abas, uma para as publica√ß√µes e outra para os coment√°rios. Assim fica bem separado.

>> Coment√°rio de rodrigoKulb:
Ol√° @guxtavodev conforme apresentado pelo @jjeanjacques10 os artigos e coment√°rios s√£o listados na aba do perfil. Voc√™ pode verificar que todos os coment√°rios tamb√©m ficam nessa √°rea!

Se deseja sugerir **separa os coment√°rios dos artigos** em ABAS, sugiro finalizar essa Issue como resolvida ou alterar o titulo da mesma. 

Muito obrigado ‚ù§Ô∏è!
</issue_1088_Colocar os artigos criados no perfil>

<issue_1089_Adequar interface para lidar melhor com coment√°rios e conte√∫dos apagados>
Ap√≥s a dele√ß√£o da publica√ß√£o o contador de votos e o bot√£o de responder continua vis√≠vel

>> Coment√°rio de ermesonqueiroz:
Uma alternativa seria exibir algo similar ao componente exibido na home quando n√£o h√° nenhum conte√∫do, ou redirecionar o usu√°rio para a p√°gina inicial.

>> Coment√°rio de aprendendofelipe:
Acredito que o ideal seria adequar a interface para corresponder ao mesmo que vai acontecer ao acessar as p√°ginas em qualquer momento futuro ao da exclus√£o. Similar ao que ocorre no GitHub.

Se for exclu√≠do o conte√∫do principal, mesmo se estivermos na URL de um coment√°rio, deveria direcionar para a p√°gina home ou 404.

Quando for exclu√≠do um coment√°rio no final de uma thread, apenas remover o conte√∫do.

J√° a exclus√£o de um conte√∫do no meio da √°rvore √© o ponto que precisamos de mais adequa√ß√£o, pois hoje n√£o lidamos bem com isso, e acabamos n√£o mostrando mais os filhos desse conte√∫do, mas dever√≠amos mostrar.

Ent√£o precisamos adequar a interface para mostrar a √°rvore completa, e identificar os locais ocupados por conte√∫dos j√° apagados, mas que possuem filhos. **Talvez** algo **baseado** no que o @ermesonqueiroz fez no #1336 para a exclus√£o de coment√°rios, mas sem o "com sucesso" na mensagem.

>> Coment√°rio de mateusvrs:
Boa noite, h√° pessoas trabalhando em tal issue atualmente? Caso contr√°rio, ser√° que poderia me engajar no assunto e propor uma solu√ß√£o. Agora, a pouco tempo, por n√£o ter verificado a issue corrente, fiz uma proposta de solu√ß√£o na issue #1777, que, pelo motivo abordado foi fechada. Poderia trabalhar melhor na minha descri√ß√£o de solu√ß√£o e apresentar uma proposta final?

>> Coment√°rio de Rafatcb:
Mateus, pode propor uma solu√ß√£o, sim. Acredito que uma implementa√ß√£o como a sugerida pelo @aprendendofelipe seja a ideal, estou em d√∫vida apenas sobre a parte

> Se for exclu√≠do o conte√∫do principal, mesmo se estivermos na URL de um coment√°rio, deveria direcionar para a p√°gina home ou 404.

Da forma como o TabNews funciona, onde tudo √© um conte√∫do, n√£o vejo por que tratar uma publica√ß√£o principal diferente de coment√°rios; continuar conseguindo acessar os coment√°rios de uma publica√ß√£o removida me parece bom, mantendo o comportamento de conte√∫dos removidos levarem para uma p√°gina 404.

>> Coment√°rio de mateusvrs:
√ìtimo @Rafatcb, vou analisar e comparar as solu√ß√µes propostas e pensar um pouco nessa quest√£o do 404 e ent√£o apresentar minha proposta. Obrigado pela aten√ß√£o!
</issue_1089_Adequar interface para lidar melhor com coment√°rios e conte√∫dos apagados>

<issue_1090_Mixed content / insecure passive content>
Quando acessei [essa](https://www.tabnews.com.br/Rodrigo182/livros-gratuitos-de-programacao) publica√ß√£o, o Firefox me deu o seguinte aviso:
![ilustration](https://i.imgur.com/ybKJQfr.png)

Clicando no saiba mais, ele me levou para essa p√°gina que fala mais sobre o problema: [Mixed content blocking in Firefox](https://support.mozilla.org/en-US/kb/mixed-content-blocking-firefox?as=u&utm_source=inproduct&redirectslug=how-does-content-isnt-secure-affect-my-safety&redirectlocale=en-US). 

N√£o sei at√© que ponto um atacante pode explorar essa falha, mas pesquisando sobre isso, ocorre porque o criador daquela publica√ß√£o colocou alguns links que usam `http`.

As solu√ß√µes mais simples que eu encontrei foram:
1. Adicionar `Content-Security-Policy: upgrade-insecure-requests` no cabe√ßalho da resposta.
2. Ou adicionar uma tag `meta` na se√ß√£o `head`:  `<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">`.

Assim, o navegador automaticamente ir√° procurar os links via `https`.

Fonte: https://web.dev/i18n/en/fixing-mixed-content/
<br>
N√£o implementei pois uso o Codespaces pra desenvolver e nem consigo reproduzir a falha, ele deve ter alguma forma de impedir as requisi√ß√µes `http`.

>> Coment√°rio de rodrigoKulb:
Ol√° @gabrielsozinho √≥tima observa√ß√£o mas acredito que n√£o seja o problema dos links com http:// o problema todo est√° em um coment√°rio que colocou uma imagem de origem http://

![Captura de tela em 2022-12-07 22-56-23](https://user-images.githubusercontent.com/5334261/206337757-eb51d1da-5bcf-45c7-98db-f48da9a66ead.png)

Para evitar esse tipo de problema podemos bloquear imagens que n√£o utilizaram https como origem, at√© porque o usu√°rio pode acabar estragando uma postagem apenas colocando uma imagem sem https.

>> Coment√°rio de gabrielsozinho:
@rodrigoKulb Boa! Era exatamente isso. Eu alterei o coment√°rio para usar https como origem e dando refresh saiu o aviso. 
>Para evitar esse tipo de problema podemos bloquear imagens que n√£o utilizaram https como origem, at√© porque o usu√°rio pode acabar estragando uma postagem apenas colocando uma imagem sem https.

Se aquela "solu√ß√£o" que eu apresentei ali funcionar da mesma forma que o site diz, acredito que resolveria o problema, pois todos os arquivos seriam requisitados a partir de https.

>> Coment√°rio de rodrigoKulb:
@gabrielsozinho preciso fazer os testes, mas pelo que eu entendi adicionando isso o conte√∫do n√£o vai ser baixado pelo browser e vai aparecer um alerta no console informando que o conte√∫do foi bloqueado.

Assim o aviso de falha de seguran√ßa vai sumir mas a imagem n√£o ser√° carregada.

Acredito que podemos tratar isso na origem do cadastro do coment√°rio / not√≠cia. Com um aviso ou sugerindo a altera√ß√£o para https.

>> Coment√°rio de rodrigoKulb:
S√≥ pra teste coloquei uma imagem aqui no git com http ele cria uma nova imagem hospedada no github dentro do https
<img src="http://media-cdn.tripadvisor.com/media/photo-s/15/a4/9b/77/legacy-hotel-at-img-academy.jpg">
![Captura de tela em 2022-12-07 23-22-49](https://user-images.githubusercontent.com/5334261/206340896-3903d54c-5aaa-4a4f-9e4d-f48802649e15.png)

>> Coment√°rio de rodrigoKulb:
Outro ponto esse erro √© **grave** qualquer um pode quebrar um artigo / not√≠cia colocando uma imagem de um servidor inseguro. @aprendendofelipe e @filipedeschamps precisamos de uma aten√ß√£o nesse ponto.

@gabrielsozinho acho que vale adicionar isso no header para depois adicionar o aviso na postagem.

>> Coment√°rio de rodrigoKulb:
@gabrielsozinho voc√™ estava certo, apenas adicionado esse header 
`<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">`
Resolve o problema fiz o teste no meu servidor, a imagem √© carregada pelo https mesmo colocando http.

![Captura de tela em 2022-12-07 23-47-34](https://user-images.githubusercontent.com/5334261/206343786-a232ddfd-aa98-4f79-a563-64ba4c203087.png)

>> Coment√°rio de gabrielsozinho:
Obrigado @rodrigoKulb pelas pesquisas e testes! Eu acabei de abrir um PR implementando essa tag.

Tamb√©m criei uma publica√ß√£o no ambiente de homologa√ß√£o, para quando aquele PR for pra Preview, a gente conseguir testar: [https://tabnews-khg31eip0-tabnews.vercel.app/gsozinhos/test-mixed-content](https://tabnews-khg31eip0-tabnews.vercel.app/gsozinhos/test-mixed-content) (este link est√° em um deploy feito ontem (07/12)).

>> Coment√°rio de gabrielsozinho:
Resolvido por #1110.

>> Coment√°rio de cybernerd007:
@rodrigoKulb @gabrielsozinho fiz uns testes e o erro persiste
![Screenshot_2](https://user-images.githubusercontent.com/8114976/206769043-eeafda52-711a-4d6e-981e-863e96f43553.png)

>> Coment√°rio de gabrielsozinho:
@cybernerd007 Voc√™ n√£o est√° usando a URL de um deploy antigo?

>> Coment√°rio de cybernerd007:
@gabrielsozinho utilizei esse aqui https://tabnews-khg31eip0-tabnews.vercel.app/M0DERADOR/teste

>> Coment√°rio de cybernerd007:
Meu navegador eu ativei pra ele for√ßar a conex√£o HTTPS sempre porem quando eu desativei para fazer o teste ele simplesmente carregou normalmente como esta no print que mandei.... LEMBRANDO ESSA CONFIGURA√á√ÉO E OPCIONAL NOS NAVEGADORES ENT√ÉO PODE ATINGIR O USUARIO FINAL....

>> Coment√°rio de gabrielsozinho:
>@gabrielsozinho utilizei esse aqui https://tabnews-khg31eip0-tabnews.vercel.app/M0DERADOR/teste

@cybernerd007 √â por isso, essa √© a URL preview do `login-redirect`. Olha aqui a lista de deploys para preview mais recentes: [https://github.com/filipedeschamps/tabnews.com.br/deployments/activity_log?environment=Preview](https://github.com/filipedeschamps/tabnews.com.br/deployments/activity_log?environment=Preview)

Pela URL mais recente n√£o existe mais isso: [https://tabnews-e7tweb4hc-tabnews.vercel.app/M0DERADOR/teste](https://tabnews-e7tweb4hc-tabnews.vercel.app/M0DERADOR/teste)

>> Coment√°rio de aprendendofelipe:
> @gabrielsozinho utilizei esse aqui https://tabnews-khg31eip0-tabnews.vercel.app/M0DERADOR/teste

Voc√™ precisa acessar uma vers√£o do sistema em que a atualiza√ß√£o j√° existe. Esse deploy √© de 2 dias atr√°s e a solu√ß√£o entrou no ar somente ontem.

>> Coment√°rio de cybernerd007:
Erro meu, esqueci de pegar a ultima Deloy para fazer o teste foi mal pessoal...

>> Coment√°rio de aprendendofelipe:
> Erro meu, esqueci de pegar a ultima Deloy para fazer o teste foi mal pessoal...

√â mais prov√°vel, mas n√£o √© 100% de certeza que o √∫ltimo deploy vai ter todos os √∫ltimos commits, pois nada impede fazer um deploy em homologa√ß√£o a partir de uma branch desatualizada

>> Coment√°rio de rodrigoKulb:
Estou esperando sair o curso de github do @aprendendofelipe üòÖÔ∏è
</issue_1090_Mixed content / insecure passive content>

<issue_1091_Op√ß√£o de seguir dentro do tabnews follow>
N√£o encontrei outra issue.

N√£o tem muito oque encher lingui√ßa, mas √© not√≥tio que existem pessoas que todo dia est√£o colocando algo interessante e relevante, quase um newsletter, e detrimento de outras pessoas que s√≥ postam coisas aleat√≥rias.
Seria interessante existir uma guia, onde ficasse apenas as postagens das pessoas que ja consideramos relevantes.

ou seja, add SEGUIR



https://www.tabnews.com.br/drmarco/opcao-de-seguir-dentro-do-tabnews-follow

>> Coment√°rio de nathsouzadev:
Gostaria de pegar essa issue para desenvolver, mas queria validar algumas coisas sobre essa sugest√£o antes de come√ßar a escrever o c√≥digo.

[ ] Usu√°rio pode seguir um outro usu√°rio
[ ] Usu√°rio pode parar de seguir um usu√°rio que est√° seguindo
[ ] Usu√°rio n√£o pode seguir o seu pr√≥prio perfil
[ ] Aba com as publica√ß√µes e respostas dos usu√°rios que voc√™ est√° seguindo

Seriam estas as funcionalidades a serem implementadas?

>> Coment√°rio de Diegiwg:
> 

Opa @nathyts, acredito que seja exatamente isso. N√£o tem muito mais para colocar nessa feature, a n√£o ser uma mostrador de 'seguidores' no perfil do usu√°rio. Mas acredito que isso n√£o seja muito interessante, ent√£o 'apenas' implementar essas quatro features j√° ser√° genial.

>> Coment√°rio de Rafatcb:
Acredito que podemos considerar este issue duplicado do #645, que engloba seguir usu√°rios ou conte√∫do, e ter listas:

* https://github.com/filipedeschamps/tabnews.com.br/issues/645
</issue_1091_Op√ß√£o de seguir dentro do tabnews follow>

<issue_1092_Bug de Pagina√ß√£o>
Uma breve hist√≥ria do acontecido:

Comecei a ler as publica√ß√µes do TabNews √†s 8h de hoje (02/12/2022), tomando meu caf√©zinho, abrindo e lendo conte√∫dos muito interessantes (o pessoal t√° de parab√©ns com as publica√ß√µes de alto conte√∫do e de alta variedade tamb√©m), salvando algumas p√°ginas nos favoritos para ler/reler depois.

Ao chegar no final da terceira p√°gina das publica√ß√µes **Relevantes**, cliquei em **Pr√≥ximo** e me deparo com p√°gina cinco, ao inv√©s da p√°gina quatro.

![bugTabNews](https://user-images.githubusercontent.com/113248738/205703001-c610492c-05ce-4b09-986d-32e2c02a99ae.gif)

>> Coment√°rio de aprendendofelipe:
Oi @crhisdotaraujo, uma possibilidade √© a micro switch do seu mouse estar com defeito.

Chegou a verificar se n√£o est√° disparando os cliques de vez em quando?

√â um defeito pouco comum, mas que acontece.

>> Coment√°rio de gabrielew:
Colocar um debounce enquanto esta buscando a anterior/pr√≥xima tamb√©m ajudaria, @aprendendofelipe ?

>> Coment√°rio de crhisdotaraujo:
Fala @aprendendofelipe, n√£o √© o mouse.
Testei em outros sites a funcionalidade de pagina√ß√£o, anterior/pr√≥ximo, carrossel e em nenhum deles aconteceu a mesma situa√ß√£o de pular uma p√°gina.
Pode ter sido um caso isolado, pois hoje n√£o est√° dando o problema novamente.

>> Coment√°rio de aprendendofelipe:
> Colocar um debounce enquanto esta buscando a anterior/pr√≥xima tamb√©m ajudaria, @aprendendofelipe ?

N√£o ajudaria, pois o componente `Link` do Next.js faz a busca antes do clique, ent√£o a navega√ß√£o √© praticamente instant√¢nea. Por isso que o segundo clique j√° ocorre em um link diferente. Repare que a grava√ß√£o mostra que ocorreram as duas navega√ß√µes, a "instant√¢nea" do primeiro clique e a segunda mais lenta porque n√£o houve tempo de ocorrer o `prefetch`.

@crhisdotaraujo, deve ter sido algo isolado com o seu hardware, pois √© pouco prov√°vel que exista esse bug no Next.js.

>> Coment√°rio de rodrigoKulb:
@crhisdotaraujo fiquei curioso sobre esse problema, consegue nos atualizar se foi resolvido?

Tentei simular aqui com clique duplo e n√£o pulou 2 p√°ginas.

>> Coment√°rio de arubesu:
Simulei aqui tamb√©m e mesmo clicando duas vezes em "pr√≥ximo"/"anterior" n√£o pulou 2 p√°ginas.

>> Coment√°rio de aprendendofelipe:
@rodrigoKulb e @arubesu, acho dif√≠cil voc√™s simularem isso com um mouse que n√£o esteja com defeito, pois a switch √© projetada para evitar a quicada no sinal el√©trico, ou seja, existe um *debounce* mec√¢nico. üëç

√â justamente esse mecanismo que faz o barulhinho "click" que d√° nome ao ato de apertar o bot√£o do mouse. üòâ

No funcionamento normal, ao conseguir enviar o segundo sinal (dar o segundo click), a navega√ß√£o j√° vai ter ocorrido, o scroll j√° vai ter mudado e o cursor n√£o vai estar mais sobre o link.

Mas d√° pra simular, por exemplo, focalizando o bot√£o de navega√ß√£o com a tecla "Tab" e disparando a tecla "Enter".

Obs.: Isso s√≥ ocorre da p√°gina 2 em diante, pois as p√°ginas `/` ou `/recentes` n√£o mant√™m o mesmo elemento selecionado ao navegar para as p√°ginas seguintes.

@crhisdotaraujo, estou fechando aqui, mas se voc√™ ver o defeito ocorrendo em outro hardware, favor nos avisar! ü§ù

Valeu, pessoal!
</issue_1092_Bug de Pagina√ß√£o>

<issue_1093_[FEATURE/SUGEST√ÉO] Separar Posts de coment√°rios no perfil do usu√°rio>
Ao entrar na p√°gina do perfil do usu√°rio, conseguimos ver tudo que ele j√° publicou ou comentou em ordem cronol√≥gica decrescente.
Seria interessante se a gente pudesse ver somente os posts ou somente os coment√°rios, separados por abas. Algo parecido com que temos aqui no GitHub, como o Write e Preview:

![image](https://user-images.githubusercontent.com/34170443/205746892-2a0186e6-53f6-4707-b79c-392fcfc03ac6.png)

Facilitaria pra quando a gente quisesse verificar o conte√∫do que foi produzido e/ou as contribui√ß√µes que o usu√°rio deu nas postagens.

>> Coment√°rio de Diegiwg:
Bom, teria que pegar a query padr√£o que est√° no arquivo ``models/content.js`` e criar dois modos de filtros:
- ``titulo com valor diferente de null`` -> para retornar apenas os Posts
- ``titulo com valor igual a null`` -> para retornar apenas os Coment√°rios

Dai tem que modificar o componente que est√° no arquivo ``pages/interface/components/Content/index.js`` para fazer a divis√£o em abas, e mudar a chamada para esse endpoint com filtros, com os dois filtros.

>> Coment√°rio de rein4nl1m:
> Bom, teria que pegar a query padr√£o que est√° no arquivo `models/content.js` e criar dois modos de filtros:
> 
> * `titulo com valor diferente de null` -> para retornar apenas os Posts
> * `titulo com valor igual a null` -> para retornar apenas os Coment√°rios
> 
> Dai tem que modificar o componente que est√° no arquivo `pages/interface/components/Content/index.js` para fazer a divis√£o em abas, e mudar a chamada para esse endpoint com filtros, com os dois filtros.

Tamb√©m poderia ser utilizado o `parentId` pra melhorar a valida√ß√£o, que tamb√©m vem como `null` pra posts e diferente de `null` pra coment√°rios.

>> Coment√°rio de Karytonn:
Hoje foi linkar o TabNew com meu site e percebi essa mesma necessidade, nesse caso estou pensando em consumir os dados via API (TabNewe √© API First ü§©üöÄüíØ) e formatar no meu client.

...mas uma query de URL j√° seria de bom tamanho!

>> Coment√°rio de aprendendofelipe:
@rein4nl1m, obrigado pela sugest√£o! üí™

Recomendo centralizar a discuss√£o na #807. üëç

Vou fechar essa duplicada. Combinado? ü§ù
</issue_1093_[FEATURE/SUGEST√ÉO] Separar Posts de coment√°rios no perfil do usu√°rio>

<issue_1094_Por que n√£o migrar para NextJS?>
Por que n√£o usar um framework moderno que facilite a cria√ß√£o e atualiza√ß√£o de componentes? Boa parte da web tem usado e com elogios at√© do pr√≥prio Filipe!

>> Coment√°rio de felipsbreno:
@thiagobessimo o projeto j√° est√° usando Next.js.

>> Coment√°rio de rodrigoKulb:
Ol√° @thiagobessimo se a resposta do @felipsbreno resolveu sua d√∫vida favor finalizar essa Issue! Muito obrigado! ‚ù§Ô∏è

>> Coment√°rio de coffeeispower:
???? O tabnews usa next j√° desde o come√ßo.
Acho que e troll
</issue_1094_Por que n√£o migrar para NextJS?>

<issue_1095_Bookmarks>
Uma das features que mais gosto no stack overflow e acho que cairia bem no tab news: os bookmarks.

√Äs vezes n√£o queremos rankear no momento, mas queremos testar depois, ou ler depois.
E ter isso salvo na pr√≥pria conta √© muito bom.

>> Coment√°rio de natanael127:
ops, acabei de ver que j√° tem a sugest√£o:
https://github.com/filipedeschamps/tabnews.com.br/issues/1058
</issue_1095_Bookmarks>

<issue_1097_Extens√£o do Google Chrome para pesquisa no TabNews>
_Orgulhosamente encontrei uma forma simples de contribuir com essa comunidade fant√°stica do TabNews._

**J√° est√° online uma extens√£o do Google Chrome que possibilita fazer buscas no TabNews, o processo √© bem simples e falo mais sobre isso em um post l√° no site.**

POST:
https://www.tabnews.com.br/karytonn/extensao-de-pesquisa-para-o-tabnews

EXTENS√ÉO:
https://chrome.google.com/webstore/detail/tabnews-google-search/mdmnecmcjnlonddbfdhmgcfaggbpdgah

>> Coment√°rio de jjpaulo2:
Ao inv√©s de uma extens√£o pro browser, por que n√£o incluir essa feature no site?

O c√≥digo t√° ai, √© s√≥ forkar e mandar PR üòÑ

>> Coment√°rio de jjpaulo2:
Inclusive existe uma issue que discute isso (#1084).

>> Coment√°rio de Rafatcb:
Fa√ßo a mesma sugest√£o que fiz em #1129

> Como essa √© uma extens√£o externa ao reposit√≥rio, acho esse issue poderia ser fechado, principalmente agora que temos a busca no pr√≥prio [www.tabnews.com.br](http://www.tabnews.com.br/).
</issue_1097_Extens√£o do Google Chrome para pesquisa no TabNews>

<issue_1100_Colocar espa√ßamento no checkbox da tela Editar Perfil>
O bot√£o de checkbox ficou sem espa√ßamento com o texto Receber notifica√ß√µes por email.

Navegadores testados: Chrome e Safari

>> Coment√°rio de rodrigoKulb:
@BianorAraujo √≥tima observa√ß√£o! Acredito que j√° foi aberto uma PR para essa corre√ß√£o a mesma est√° em an√°lise para aprova√ß√£o, voc√™ pode conferir nesse link https://github.com/filipedeschamps/tabnews.com.br/pull/1059#pullrequestreview-1209335740

Se essa resposta resolver sua d√∫vida favor fechar a Issue como resolvida! üéâÔ∏è

>> Coment√°rio de BianorAraujo:
J√° foi resolvido a alguns dias atr√°s!
Obrigado por avisar
</issue_1100_Colocar espa√ßamento no checkbox da tela Editar Perfil>

<issue_1106_ü§î [DUVIDA] Porque o Tabnews n√£o utiliza um ORM para gerir a conex√£o com banco de dados?>
Estava lendo o c√≥digo relacionado a busca de conte√∫dos e percebi que tudo est√° sendo feito em SQL puro, sem o aux√≠lio de uma ORM.

At√© onde sei, para projetos grandes (ou que ser√£o grandes no futuro), o melhor √© usar um ORM, para n√£o se perder nas Querys enormes de SQL. E em NodeJS existe tantos ORM's, tal como o [Prisma](https://www.prisma.io/), [Sequelize](https://sequelize.org/), entre outros: [Top 11 Node.js ORMs, query builders & database libraries in 2022](https://www.prisma.io/dataguide/database-tools/top-nodejs-orms-query-builders-and-database-libraries#introduction).

``Minha d√∫vida √©:`` porque n√£o utilizar um ORM no projeto do Tabnews?

>> Coment√°rio de klawdyo:
Em projetos grandes √© necess√°rio otimizar tudo o que for poss√≠vel devido a quest√µes de performance e custos. N√£o necessariamente esses ORMs fazem isso. Creio que a escolha por fazer as queries manualmente √© com esse objetivo.

>> Coment√°rio de Diegiwg:
> Em projetos grandes √© necess√°rio otimizar tudo o que for poss√≠vel devido a quest√µes de performance e custos. N√£o necessariamente esses ORMs fazem isso. Creio que a escolha por fazer as queries manualmente √© com esse objetivo.

Entendi, achei que, os ORM's s√£o softwares feitos para a √∫nica fun√ß√£o de gerenciar um banco de dados. E, por isso, seus times est√£o focados em estabilidade, escalabilidade e seguran√ßa.

Logo, na minha concep√ß√£o, 'escrever' tudo na m√£o, sem utilizar tais ferramentas, seria o mesmo que escrever todo o servidor Next na m√£o, usando alguma linguagem que n√£o seja Javascipt, para ter o m√°ximo de performance.

>> Coment√°rio de klawdyo:
ORMs s√£o para banco de dados sim. Mas uma query feita √† m√£o voc√™ consegue usar s√≥ o que precisa. Um ORM √© feito para facilitar o uso pelo programador e at√© mesmo fazer com que um programador que n√£o √© muito bom em banco de dados consiga fazer consultas complexas. 

Consultas demasiadamente complexas no banco de dados custam mem√≥ria do servidor. Quando voc√™ faz 1 consulta localmente, voc√™ n√£o observa lentid√£o. Mas quando um site como o tabnews recebe centenas de consultas por minuto, a√≠ qualquer otimiza√ß√£o √© v√°lida.

E o problema do ORM √© que essa facilidade √© conseguida √†s custas da performance da pr√≥pria consulta. 

Claro que n√£o estou falando em rela√ß√£o a uma consulta do tipo `select * from 'users'` ... Mas em consultas realmente complexas, onde voc√™ consegue resolver usando alguns JOINs, o ORM faz 30 consultas para obter um resultado mais f√°cil do programador manipular. √ìbvio que o programdor tamb√©m pode fazer os mesmos joins usando um ORM, por√©m nesse caso o c√≥digo acaba sendo maior que do que o sql puro.

√â uma op√ß√£o de desenvolvimento. 

ORM √© simples de usar? √â. 
ORM pode trazer dados complexos com uma linha de c√≥digo? Pode! Mas isso diminuir√° a performance pois voc√™ n√£o consegue otimizar o SQL.
ORM pode fazer v√°rias joins? Pode. Mas o c√≥digo acaba ficando maior que se usar o sql puro. Ou mais complexo. Ou mais feio. Tanto faz.

Ent√£o o resumo √©: √â uma op√ß√£o do desenvolvedor. Voc√™ perde a facilidade e ganha otimiza√ß√£o.

>> Coment√°rio de rodrigoKulb:
Ol√° @Diegiwg apenas completando a resposta do @klawdyo o @filipedeschamps comentou sobre isso nessa Issue que rolou uma discuss√£o muito massa que vale a leitura:
https://github.com/filipedeschamps/tabnews.com.br/issues/61#issuecomment-879463492

Se essa resposta resolver sua d√∫vida favor fechar a Issue como resolvida! üéâÔ∏è
</issue_1106_ü§î [DUVIDA] Porque o Tabnews n√£o utiliza um ORM para gerir a conex√£o com banco de dados?>

<issue_1107_[D√öVIDA / SUGEST√ÉO] Valida√ß√£o de dados no backend.>
Ol√°!!

Gostaria de saber o motivo, de no login e cadastro por exemplo, as valida√ß√µes de campo v√°lido serem feitas apenas no backend. Exemplo: campo email n√£o informado, ou formato inv√°lido.

Trazer essas valida√ß√µes "padr√µes" **tamb√©m** para o frontend, n√£o iria economizar o uso de servidor? Al√©m de em conex√µes mais lentas melhorar o processo?

Abra√ßo!

![image](https://user-images.githubusercontent.com/40251890/206347724-304bb893-f720-4b8c-83e1-6426d227ca8b.png)

>> Coment√°rio de Rafatcb:
As valida√ß√µes mais simples costumam ficar no frontend para adiantar o processo, mas trazer todas as valida√ß√µes causaria duplica√ß√£o das pr√≥prias valida√ß√µes, dificultando a manuten√ß√£o e √© bem prov√°vel que em algum momento as valida√ß√µes ficassem diferentes porque algu√©m s√≥ alterou em um dos lados.

Apesar disso, a valida√ß√£o do campo ser obrigat√≥rio ou n√£o √© bem simples e poderia estar no frontend sim. Inclusive, os campos no cadastro deveriam ter o indicador de campo obrigat√≥rio, de acordo com as recomenda√ß√µes na [documenta√ß√£o do TextInput](https://primer.style/components/text-input#anatomy), e o Login tamb√©m deveria, mas n√£o me lembro se os sites e aplica√ß√µes costumam mostrar que o login e senha s√£o "obrigat√≥rios" para entrar.

>> Coment√°rio de aprendendofelipe:
> Gostaria de saber o motivo, de no login e cadastro por exemplo, as valida√ß√µes de campo v√°lido serem feitas apenas no backend.

Um motivo importante √© que no backend temos testes e no frontend ainda n√£o.

> Trazer essas valida√ß√µes "padr√µes" **tamb√©m** para o frontend, n√£o iria economizar o uso de servidor?

Quanto ao processamento no servidor a diferen√ßa seria irris√≥ria, j√° quanto ao tr√°fego de dados, seria maior, pois o c√≥digo de valida√ß√£o seria trafegado sempre, enquanto validando no servidor s√≥ existe tr√°fego extra quando os dados n√£o passam na valida√ß√£o.

> Al√©m de em conex√µes mais lentas melhorar o processo?

Acho que esse √© o ponto que pode estar a favor de validar no client. Quando tivermos testes no frontend acho que pode valer a pena levar algumas valida√ß√µes para o client **se isso melhorar a UX** por trazer um feedback mais r√°pido.

Mas ser√° preciso testar, pois com o processamento na *edge*, talvez n√£o haja diferen√ßa significativa de UX que justifique a manuten√ß√£o extra por ter valida√ß√£o em diferentes locais.

Vou fechar a issue, mas qualquer coisa podemos reabrir ü§ù
</issue_1107_[D√öVIDA / SUGEST√ÉO] Valida√ß√£o de dados no backend.>

<issue_1108_Remover conte√∫dos negativados + Economia>
## Contexto

Eu estava discutindo com o @gabrielsozinho sobre um sistema (que remove automaticamente um conte√∫do se ele atingir o limite m√°ximo de tabcoins negativadas) e ele colocou um ponto interessante sobre _"uma pessoa com muitos tabcoins pode deletar qualquer conte√∫do que ela quiser negativando-o v√°rias vezes"_, ent√£o eu disse a ele que as transa√ß√µes de tabcoins s√£o registradas no banco de dados e d√° pra criar esse sistema se baseando nesses registros: https://github.com/filipedeschamps/tabnews.com.br/blob/9ab4433273eab71296a1cd14783a4698fd2749a7/models/balance.js#L23-L37
E se 70% das pessoas que avaliaram, avaliaram negativamente, deleta o conte√∫do a partir disso.

Para esse sistema, √© necess√°rio colocar um limite de avalia√ß√µes que precisa ser atingido antes de deletar o conte√∫do, exemplo: Essa regra de "_deletar o conte√∫do quando tiver ao menos 70% de downvotes_"  s√≥ vai valer se o conte√∫do tiver pelo menos 10 contribui√ß√µes (de pessoas diferentes), porque assim cabe a comunidade julgar o conte√∫do como sem valor e o conte√∫do perde o risco de ser deletado com poucas contribui√ß√µes logo quando publicado.

---

Um outro sistema que eu comentei com ele √© de: "**Aumentar o custo da contribui√ß√£o quando atingir um limite m√°ximo de contribui√ß√µes**", Exemplo: Se eu dei 4 downvotes, na quinta vez o custo aumentaria de 2 para 3, e assim, 3 tabcoins meus seriam debitados (o conte√∫do receberia apenas **1 downvote** e eu receberia apenas 1 tabcash, como normalmente √©). De acordo com que a quantidade de contribui√ß√µes (no mesmo conte√∫do) vai aumentando, esse custo tamb√©m vai aumentando pra dificultar que apenas uma pessoa negative um conte√∫do e tire a relev√¢ncia dele.

>> Coment√°rio de Rafatcb:
Eu acho que vamos acabar limitando a quantidade de votos ou seguir a sugest√£o do seu √∫ltimo par√°grafo, porque j√° houve casos em que uma √∫nica pessoa colocou um conte√∫do direto na posi√ß√£o 1 da p√°gina Relevantes, e levando o nome **Relevantes** ao p√© da letra, isso n√£o faz sentido.

Sobre remover os conte√∫dos classificados negativamente, algu√©m sabe dizer como o Reddit, Hacker News ou outros sites lidam com isso? Eu sei que o Hacker News deixa um coment√°rio negativo mais acinzentado de acordo com o qu√£o negativo est√° (imagem abaixo) mas n√£o sei o que faz com publica√ß√µes negativas.

![O primeiro coment√°rio est√° com o texto preto, o segundo est√° um cinza bem claro](https://user-images.githubusercontent.com/26308880/206436932-781671bf-052a-44be-a3aa-03a59d94f81d.png)

(isso vai contra a [acessibilidade de contraste](https://developer.mozilla.org/en-US/docs/Web/Accessibility/Understanding_WCAG/Perceivable/Color_contrast))

No Reddit, o coment√°rio e suas respostas ficam escondidas (como se estivesse colapsado), permitindo exibir novamente, mas tamb√©m n√£o sei o que acontece com as publica√ß√µes:

| Escondido | Vis√≠vel |
| --- | --- |
|  ![Coment√°rio escondido](https://user-images.githubusercontent.com/26308880/206437560-299eae0e-2e3d-4c28-9f40-c81d6abbfff8.png) |  ![Coment√°rio vis√≠vel](https://user-images.githubusercontent.com/26308880/206437600-b1d8520b-35e0-4a97-b055-d4d874ea0102.png) |

>> Coment√°rio de Jeiel0rbit:
Sobre Imgur eu sei.

> Giving upvotes makes people happy, so feel free to use them freely! Downvoting discourages participation, so use them with caution.

Esse √© o tipo de regra l√° usado com upvote e downvote.

![](https://help.imgur.com/hc/en-us/article_attachments/204569243/99947-rabbit-season-duck-season-imgu-npal.gif)

>> Coment√°rio de silvaezequias:
>  Eu sei que o Hacker News deixa um coment√°rio negativo mais acinzentado de acordo com o qu√£o negativo est√° (imagem abaixo) mas n√£o sei o que faz com publica√ß√µes negativas.
[...]
 (isso vai contra a [acessibilidade de contraste](https://developer.mozilla.org/en-US/docs/Web/Accessibility/Understanding_WCAG/Perceivable/Color_contrast))

E em quest√£o de contraste, n√£o acho v√°lido de implementar porque isso j√° √© usado para marcar conte√∫dos que j√° foram lidos pelo usu√°rio, talvez alterar a cor do t√≠tulo de forma que n√£o deixe ele destacado seja melhor. Ou talvez um fundo avermelhado bem fraquinho como se indicasse "erro" (inclusive, tem um component no primer que faz isso https://primer.style/react/Flash);

![Primer Flash Component](https://user-images.githubusercontent.com/63757378/206490918-d553acab-d372-4d42-aa57-912d459f0fc3.png)

Gostei tamb√©m dessa ideia de compactar o conte√∫do e deixar a op√ß√£o de descompactar ele, interessante.
</issue_1108_Remover conte√∫dos negativados + Economia>

<issue_1109_Adicionar contador de "Visitas" nos posts>
Acredito que, seria muito interessante para os autores, se tivesse um contador em seus posts, que mostra-se a quantidade de visitas (total) que o post recebeu.

N√£o acho interessante ser uma informa√ß√£o 'publica', seria uma informa√ß√£o que iria aparecer apenas para o dono do post, como uma m√©trica pessoal.

Exemplo simples, com uma √∫nica string extra, logo no in√≠cio do post:
![a11](https://user-images.githubusercontent.com/15692310/206452587-4e60f71a-5e72-4a4d-95d1-2c5c27905030.PNG)

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o. Acho que podemos marcar como dupllicada da #1115 que, apesar de ser mais nova, recebeu mais aten√ß√£o:

* https://github.com/filipedeschamps/tabnews.com.br/issues/1115

>> Coment√°rio de aprendendofelipe:
@Diegiwg, obrigado pela sugest√£o! üí™

Como o @Rafatcb mencionou, vamos concentrar o debate na #1115 ü§ù
</issue_1109_Adicionar contador de "Visitas" nos posts>

<issue_1111_Discuss√£o>
Algu√©m concorda ao criar uma aba de discuss√£o? 

Deixar **issue** para desenvolvimento da plataforma.

>> Coment√°rio de gabrielsozinho:
Isso j√° foi sugerido antes nas issues #598 e #480. Olha o que o Filipe respondeu: https://github.com/filipedeschamps/tabnews.com.br/issues/480#issuecomment-1182525179.

>> Coment√°rio de Jeiel0rbit:
> Isso j√° foi sugerido antes nas issues #598 e #480. Olha o que o Filipe respondeu: https://github.com/filipedeschamps/tabnews.com.br/issues/480#issuecomment-1182525179.

Poxa vida. Pelo menos um formul√°rio de bug... Ok...
</issue_1111_Discuss√£o>

<issue_1114_Adicionar uma descri√ß√£o dos bot√µes>
N√£o sei se s√≥ aconteceu comigo, mas acho bastante importante adicionar alguma informa√ß√£o nos bot√µes de "like" e "deslike" dos posts
![Captura de tela 2022-12-08 231754](https://user-images.githubusercontent.com/45810581/206609091-612e705b-256a-4092-8566-0b3918ecbf8f.png)
At√© por que a gente passa o mouse por cima, e n√£o mostra nada, e como aconteceu comigo eu fiquei clicando que nem maluco, pra saber o que acontecia, e s√≥ depois que vim perceber que ali era o bot√£o de adicionar tabcoin na publica√ß√£o kkk Essas pequenas coisas ajudam bastante, n√£o s√≥ a quem usa entender, mas na acessibilidade.

>> Coment√°rio de B-Schmitz:
![Screenshot_2](https://user-images.githubusercontent.com/26826885/225015950-b8321522-57d4-44e6-ad2f-fbe0929c7974.png)
![Screenshot_3](https://user-images.githubusercontent.com/26826885/225015958-a390b4ed-236c-4d36-920f-9bf8b5562d17.png)

Alguma sugest√£o de posi√ß√£o ou texto, como deve aparecer?

>> Coment√°rio de filipedeschamps:
Sugiro testar em Mobile para ter certeza que o texto n√£o ficar√° cortado, pois se eu n√£o me engano, ele ir√° aparecer depois do `tap` (mas posso estar errado).

>> Coment√°rio de B-Schmitz:
> Sugiro testar em Mobile para ter certeza que o texto n√£o ficar√° cortado, pois se eu n√£o me engano, ele ir√° aparecer depois do `tap` (mas posso estar errado).

No mobile realmente, fica cortado, uma solu√ß√£o seria renderizar o tooltip a direita?

>> Coment√°rio de aprendendofelipe:
J√° est√° praticamente pronto no PR #1277 

S√≥ falta o @PauloIVM resolver os conflitos de merge

>> Coment√°rio de aprendendofelipe:
As mensagens escolhidas foram: "Achei relevante" e "N√£o achei relevante"

>> Coment√°rio de aprendendofelipe:
@Hanufu obrigado pela issue! üí™

J√° foi implementado no PR #1277 ent√£o estou fechando essa aqui, ok? üëç
</issue_1114_Adicionar uma descri√ß√£o dos bot√µes>

<issue_1115_[FEATURE/SUGEST√ÉO] Quantidade de visualiza√ß√µes em uma publica√ß√£o>
Seria interessante a quantidade de visualiza√ß√µes das p√°ginas, assim a pessoa criadora do artigo teria uma no√ß√£o do qu√£o impactante foi sua escrita.

Al√©m de ser poss√≠vel "rankear" as publica√ß√µes mais visualizadas, etc.

>> Coment√°rio de filipedeschamps:
Entrando nesta issue por sugest√£o do @aprendendofelipe atrav√©s [desta publica√ß√£o](https://www.tabnews.com.br/FelipeBarso/b3ca9528-72c3-4fe3-ac99-ffb7f1ac84e9).

Sugiro de in√≠cio implementar isto sem influenciar qualquer tipo de ranking, para tentar tirar um pouco o incentivo de querer burlar este valor (que sempre vai ter abuso).

E implementaria isto de forma simples tamb√©m, mas com o cuidado inicial de:

1) Um tempo m√≠nimo para que um mesmo IP marque uma nova visualiza√ß√£o.
2) Um n√∫mero m√°ximo de visualiza√ß√µes por IP.

>> Coment√°rio de hkotsubo:
Uma d√∫vida: isso seria apenas para publica√ß√µes root?

E para coment√°rios, **caso tenha**, como ficaria? Se eu acesso pelo link direto (por exemplo, `https://www.tabnews.com.br/FelipeBarso/b3ca9528-72c3-4fe3-ac99-ffb7f1ac84e9`, isso contaria como uma visualiza√ß√£o para este post, certo?

Mas e se eu acesso o *parent* dele (no caso, `https://www.tabnews.com.br/filipedeschamps/2c7ef957-0e6c-4ad2-a5b2-a0da2714a87f`), isso conta como visualiza√ß√£o somente para o *parent*, ou tamb√©m para os filhos?

>> Coment√°rio de filipedeschamps:
Excelente pergunta @hkotsubo ! Talvez a l√≥gica inicial (e que pode ser melhorada no futuro) poderia ser: toda vez que um conte√∫do √© acessado pela "raiz da p√°gina" (como no seu exemplo), deveria contabilizar uma visualiza√ß√£o para ele. Pelo que lembro, √© a mesma p√°gina que renderiza um conte√∫do root ou uma resposta singular, ent√£o se ela fizer um `POST` para um endpoint de visualiza√ß√µes, vai funcionar automaticamente para os dois casos.

Agora, o que eu faria √© somente mostrar a visualiza√ß√£o do primeiro n√≥ de conte√∫do (e n√£o na √°rvore das respostas).

>> Coment√°rio de aprendendofelipe:
> Sugiro de in√≠cio implementar isto sem influenciar qualquer tipo de ranking

Concordo totalmente que n√£o deve haver nenhum tipo de ranking nesse sentido. N√£o s√≥ por ser f√°cil de burlar, mas tamb√©m porque esse tipo de indicador n√£o diz muito sobre a qualidade do conte√∫do, al√©m de estimular clickbait. Se fosse para usar no ranking, talvez teria que rastrear coisas como tempo de perman√™ncia na p√°gina, tempo de rolagem etc.

Penso que agora √© legal mostrar o alcance das publica√ß√µes apenas como feedback para os autores. Ent√£o **dependendo da forma que for implementado** pode ser melhor mostrar esses dados em um primeiro momento apenas para o autor de cada publica√ß√£o.


> Uma d√∫vida: isso seria apenas para publica√ß√µes root?

Pensando em come√ßar da forma mais simples poss√≠vel, acho melhor come√ßar contando apenas para o primeiro n√≥ de cada p√°gina, independentemente de ser root.

>> Coment√°rio de filipedeschamps:
> Penso que agora √© legal mostrar o alcance das publica√ß√µes apenas como feedback para os autores. Ent√£o **dependendo da forma que for implementado** pode ser melhor mostrar esses dados em um primeiro momento apenas para o autor de cada publica√ß√£o.

Sugiro mostrar de forma 100% p√∫blica, mesmo que isso crie um novo problema. Vai dar um "ar muito mais vivo" para o TabNews.

> Pensando em come√ßar da forma mais simples poss√≠vel, acho melhor come√ßar contando apenas para o primeiro n√≥ de cada p√°gina, independentemente de ser root.

100% ü§ù üí™

>> Coment√°rio de hkotsubo:
@aprendendofelipe Talvez fique para outra issue, j√° que a ideia √© simplificar, mas enfim: seria poss√≠vel fazer de forma retroativa?

Pois [lendo aqui](https://www.tabnews.com.br/FelipeBarso/7f415480-950b-4051-8851-103c8e56a487) eu entendi que vc j√° sabe a quantidade de visualiza√ß√µes de cada post, ent√£o sugiro, se poss√≠vel, verificar tamb√©m o qu√£o dif√≠cil seria adicionar esta informa√ß√£o para os posts j√° existentes.

>> Coment√°rio de aprendendofelipe:
> seria poss√≠vel fazer de forma retroativa?

Temos os dados retroativos desde 27 de outubro de 2022, que √© a data que adicionamos o Analytics da Vercel.

A Vercel n√£o fornece esses dados via API (da√≠ a dificuldade de torn√°-los p√∫blicos), mas d√° para fazer um script para raspar os dados tomando cuidado para n√£o cair em algum rate limit, j√° que teria que buscar os dados de cada uma das milhares de publica√ß√µes separadamente.

> Talvez fique para outra issue, j√° que a ideia √© simplificar

Se formos fazer essa raspagem, n√£o podemos demorar, pois os dados ficam guardados apenas por 12 meses, ent√£o daqui pouco mais de um m√™s j√° vamos come√ßar a perder os dados mais antigos.

>> Coment√°rio de aprendendofelipe:
> Sugiro mostrar de forma 100% p√∫blica, mesmo que isso crie um novo problema. Vai dar um "ar muito mais vivo" para o TabNews.

Penso que ao olharmos para nossos pr√≥prios conte√∫dos, temos uma tend√™ncia maior de acompanhar a evolu√ß√£o dos n√∫meros ao longo do tempo, mas ao olhar para os n√∫meros de conte√∫dos de terceiros, olhamos apenas o dado instant√¢neo. De forma similar √† Lei de Zipf, a maioria dos usu√°rios ver√° os piores n√∫meros. E esse efeito ser√° ainda mais forte com os usu√°rios org√¢nicos.

Com isso, vejo dois grandes riscos, tanto em probabilidade como em impacto negativo:

1. Dar um "ar mais morto" do que o real;
2. Estimular comportamentos indesejados;

Poucas publica√ß√µes chegam a n√∫meros altos de visualiza√ß√µes nas primeiras horas, ou seja, os usu√°rios org√¢nicos do TabNews ver√£o muitos n√∫meros baixos e poucos altos. Mesmo entre os usu√°rios espor√°dicos que vem pelo Google, apenas os mais atrasados ver√£o os n√∫meros melhores.

E o pior √© que os usu√°rios ver√£o n√∫meros altos com mais frequ√™ncia nas publica√ß√µes mais pol√™micas, que hoje s√£o a exce√ß√£o, mas podem virar regra se seguirmos os mesmos caminhos das outras redes que focam em cliques a qualquer custo. No TabNews as publica√ß√µes mais relevantes tem cauda longa, ent√£o acabam recebendo mais acessos ao longo de alguns dias ap√≥s terem sido publicadas, pois recebem muitas visitas vindas pelo Google (busca e discover).

Pensando em como podemos mitigar esses riscos... Talvez mostrar os n√∫meros publicamente, mas n√£o em tempo real, ou seja, mostrar os resultados das publica√ß√µes ap√≥s certo intervalo de tempo, talvez 2 dias, uma semana, n√£o sei...

O que pensam sobre esses riscos e formas de mitigar?

>> Coment√°rio de aprendendofelipe:
Apenas para ilustrar o que digo acima, a publica√ß√£o abaixo j√° teve s√≥ hoje de manh√£ bem mais visualiza√ß√µes do que ontem o dia inteiro. Ontem foram 980, e hoje j√° chegou a 1.440.

[Crie GUI modernas e bonitas com Python!](https://www.tabnews.com.br/Dimi/crie-gui-modernas-e-bonitas-com-python)

No total ela j√° tem 2.426 visualiza√ß√µes e continua crescendo. Mas os usu√°rios mais frequentes do TabNews, que viram a publica√ß√£o ontem pela manh√£ (ela foi publicada antes de ontem), teriam encontrado que o alcance dela, em m√©dia, era de menos de 200 visualiza√ß√µes.

Isso porque 76% das visualiza√ß√µes vieram por recomenda√ß√£o do Google (ou 82% vendo s√≥ nas √∫ltimas 24 horas):

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/4ae33635-8067-4b1d-b005-cfd95bb03ced)

>> Coment√°rio de filipedeschamps:
Excelente an√°lise üí™ üí™ üí™ 

Nessas horas, as vozes da minha cabe√ßa dizem o seguinte: √© o tipo de situa√ß√£o com tanta vari√°vel, que √© a mesma coisa que tentar planejar uma jogada de xadrez com 512 colunas. Qualquer movimento que a gente fizer, a vida vai mostrar que t√° tudo "errado".

Vide TabCoins, que come√ßou com um modelo muito frouxo e errado e foi melhorado ao longo do tempo, mas que pensando agora, era o modelo certo de se **come√ßar**, porque era f√°cil qualquer um ver que TabCoins era uma coisa que existia de verdade. Assim... nunca d√° para saber na verdade, mas ter invertido a ordem (ter come√ßado "certo"), talvez n√£o teria sido melhor.

Ent√£o a minha sugest√£o √© implementar de uma forma simples, que **revele** de verdade o que est√° acontecendo nas views, para todo mundo, sem querermos esconder nada, e em cima disso a gente d√° o pr√≥ximo passo, sejam eles:

1) Controlar abuso
2) Pessoas tristes porque tem poucas views, pensar como maximizar.

Estes s√£o problemas bons, e eu prefiro eles do que os problemas de ter entrado numa otimiza√ß√£o prematura ü§ù

>> Coment√°rio de ErickCReis:
Acho que essa feature seria muito interessante.

Eu tamb√©m n√£o tenho certeza sobre os impactos desse n√∫mero na publica√ß√£o e como os usu√°rios v√£o se comportar, mas acho que uma vers√£o inicial e simplificada pode trazer muitas respostas.

Talvez exibir o n√∫mero de visualiza√ß√µes apenas ao acessar a publica√ß√£o possa minimizar os riscos que o @aprendendofelipe  citou, j√° que a listagem n√£o teria essa informa√ß√£o para influenciar o clique do usu√°rio.

--- 

Tamb√©m queria iniciar a discuss√£o sobre infraestrutura e custos dessa funcionalidade.

1. A ideia √© salvar isso no Postgres mesmo? Ou utilizar o Redis √© mais interessante?

Imagino que atualizar esse dado vai ser uma opera√ß√£o muito frequente, e com o Redis da _upstash_ a gente conseguiria "resolver" tudo isso no _edge runtime_ e reduzir os custos.

2. Em uma implementa√ß√£o inicial a gente j√° teria que lidar com limita√ß√£o baseadas em ip al√©m das restri√ß√µes j√° presentes no rate limit do middleware?

Se sim, isso provavelmente elevaria bastante os custos de armazenamento e opera√ß√µes no banco de dados.

3. @aprendendofelipe voc√™ poderia disponibilizar algumas m√©tricas pra gente tentar estimar alguns custos?

N√£o tenho muita experi√™ncia nessa parte, mas acho imagino que os seguintes n√∫meros podem ajudar:
- Publica√ß√µes acessadas em um dia.
- Publica√ß√µes acessadas por usu√°rio por dia (n√£o sei se √© poss√≠vel pegar essa informa√ß√£o).

>> Coment√°rio de aprendendofelipe:
> 3\. @aprendendofelipe voc√™ poderia disponibilizar algumas m√©tricas pra gente tentar estimar alguns custos?

Estamos sem analytics na p√°gina home `/`, mas no restante temos uma m√©dia aproximada de 6k visitantes por dia e 500k visualiza√ß√µes por m√™s, mas isso √© o l√≠quido, pois o Analytics da Vercel faz uma limpeza dos duplicados.

>> Coment√°rio de Rafatcb:
O PR #1598 trouxe algumas informa√ß√µes novas:

https://github.com/filipedeschamps/tabnews.com.br/pull/1598#pullrequestreview-1811528012

> Mas, infelizmente, n√£o podemos usar o middleware da Vercel dessa forma para contabilizar as visitas, pois as p√°ginas de conte√∫dos s√£o est√°ticas e a navega√ß√£o em boa parte das vezes √© SPA.
>
> A grande maioria das 10M requisi√ß√µes mensais √© servida por cache, seja da Vercel ou da Cludflare. O que for servido pelo cache da Vercel a gente at√© poderia contabilizar, mas isso √© cerca de 1/3 do nosso tr√°fego. Os outros 2/3 s√£o respondidos diretamente pela Cloudflare.
>
> E o que for servido pela Vercel tamb√©m n√£o tem rela√ß√£o direta com o n√∫mero de visitas das p√°ginas, pois a maioria das requisi√ß√µes s√£o para pr√©-carregar dados no cache do navegador, e n√£o saberemos pelo middleware se essa p√°gina foi ou n√£o visitada.
>
> Acho que ser√° preciso enviar os dados do client diretamente para um servidor ou endpoint dedicado a fazer essa contabiliza√ß√£o, como os servi√ßos de Analytics fazem.

Que tipo de t√©cnica √© utilizada como prote√ß√£o (pelo Google, Vercel etc.) para garantir que a chamada √† API de analytics √© feita de forma natural, pelo site em quest√£o?

>> Coment√°rio de tiagopaes:
Vou deixar minha sugest√£o para uma poss√≠vel solu√ß√£o para essa feature e para o analytics do tabnews em geral. Por que n√£o usamos um sistema de analytics open-source como foco em privacidade como o plausible por exemplo?

>> Coment√°rio de mthmcalixto:
Como falei em #1803 √© poss√≠vel utilizar com apenas uma API simples e retornar o n√∫mero de visitas que uma postagem teve.

Pelo o que entendi eles guardam os dados por 6 meses, ent√£o depois reinicia e come√ßa contar novamente, poderia salvar os dados antes dos 6 meses, a cada 1 semana, talvez;

Parece que eles cobram apenas por "eventos" e n√£o por visitas que a postagem teve, eventos s√£o para rastrear bot√µes, cliques etc...

Seria ideal retornar as visitas, salvar na DB e ent√£o fazer verifica√ß√£o por baixo entre dias para atualizar o valor de views.

Como mostrei em #1803 √© f√°cil retornar um dado, uma views de visita em uma postagem.

>> Coment√°rio de mthmcalixto:
@aprendendofelipe abri um PR: #1819

>> Coment√°rio de aprendendofelipe:
@mthmcalixto, eu vi, show! üí™

N√£o consegui responder antes porque estamos em um per√≠odo de bastante correria. üòâ

O Umami est√° parecendo uma √≥tima op√ß√£o para reduzir nosso custo com analytics e tem grande potencial para ao mesmo tempo permitir compartilhar os dados estat√≠sticos com os usu√°rios do TabNews. Mas precisamos ir um passo de cada vez, primeiro ver se ele mede direito, depois ver se suporta o volume necess√°rio para deixar os dados p√∫blicos.

### Navega√ß√£o SPA

Precisamos ver se o Umami contabiliza bem as navega√ß√µes via SPA do Next.js. Acredito que isso pode exigir mais configura√ß√µes do que o que est√° no PR #1819. Resolvendo a configura√ß√£o, podemos confirmar a compatibilidade comparando se os dados batem com o analytics atual da Vercel.

Mas, para verificar isso sem precisar de uma conta paga do Umami Cloud e nem auto hospedar o servi√ßo, precisamos come√ßar habilitando ele apenas em algumas p√°ginas. Que tal configurar para coletar os dados apenas da p√°gina de cadastro e de login? Assim podemos testar mantendo o volume dentro do permitido pela conta gratuita.

### Capacidade de leitura

Em paralelo com o teste de compatibilidade com SPA, com a mesma configura√ß√£o a gente j√° consegue come√ßar a testar se a API do Umami √© vi√°vel para deixar os dados p√∫blicos. Esse teste √© importante, pois imagino que o Umami, como qualquer servi√ßo de analytics, seja muito mais otimizado para inser√ß√£o de dados do que para leitura. S√≥ que, para usar como contador p√∫blico de visualiza√ß√µes, a gente precisa que ele funcione bem com um n√∫mero de leituras na mesma ordem de grandeza das inser√ß√µes.

J√° d√° para saber que o rate limit da API da Umami Cloud n√£o seria nem de longe suficiente para nossos momentos de pico. Mas parece que o limite √© por chave, ent√£o talvez daria para rotacionar as chaves entre as diferentes lambdas. Talvez s√≥ d√™ para fazer isso com a conta paga, mas a√≠ √© um passo seguinte nos testes.

### Substitui√ß√£o do Analytics atual

A quest√£o SPA eu tenho quase certeza que conseguimos resolver, ent√£o j√° vai valer a pena usar a Umami Cloud no lugar do Analytics da Vercel, pois isso deve representar cerca de $50 de economia mensal, fora permitir habilitarmos de novo o analytics nas p√°ginas que hoje est√£o sem ('/' e '/publicar').

### Conclus√£o

A d√∫vida maior √© a capacidade de compartilhar os dados, que, dependendo do resultado dos testes, podemos compartilhar quase em tempo real, ou com um cache com tempo maior, de acordo com a capacidade do Umami. Se o problema for mais o rate limit da API da Umami Cloud do que a capacidade do servidor do Umami, podemos pensar em auto hospedar o servi√ßo, mas isso seria uma pena, pois traria custos muito maiores do que na Umami Cloud.

### Ajuda para testar

Ser√° √≥timo se algu√©m puder abrir um PR, ou adequar o #1819, para permitir esses dois testes (SPA e API), mas habilitando para coletar dados apenas das p√°ginas de login e de cadastro, e sem criar um endpoint que forne√ßa os dados das p√°ginas de conte√∫dos (por enquanto), pois primeiro o teste deve ser estressando diretamente a API da Umami Cloud e n√£o a nossa API.

>> Coment√°rio de mthmcalixto:
@aprendendofelipe eu fiz um hook no #1819 e ele vai funcionar com SPA para enviar dados apenas de "login" e "cadastro".

Sobre o rate-limit acredito que seja client-side da cloudflare que limita o envio do usu√°rio, ent√£o vai de usu√°rio para usu√°rio e vai continuar o envio de dados de outros.
</issue_1115_[FEATURE/SUGEST√ÉO] Quantidade de visualiza√ß√µes em uma publica√ß√£o>

<issue_1116_Adicionar campo de "notifica√ß√µes">
Basicamente notificar o usu√°rio quando algu√©m houver respondido o post dele ou o coment√°rio

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1116_Adicionar campo de "notifica√ß√µes">

<issue_1117_SUGEST√ÉO - Favoritar ou seguir as publica√ß√µes>
Seria interessante poder marcar uma publica√ß√£o como favorito e lista-las depois ou at√© mesmo poder seguir uma publica√ß√£o para sempre que algu√©m comentar algo sermos notificado.

>> Coment√°rio de giovanirorato:
Concordo essa √© uma funcionalidade essencial.

>> Coment√°rio de codigocafe:
@gabrielfpereira  e @giovanirorato , voc√™s acham que deve utilizar os TabCoins para adicionar em favoritos - para causar a incentivo de mais publica√ß√µes - ou deixar s√≥ o bot√£o de favoritos sem requerir nada?

>> Coment√°rio de fellipematos:
@gabrielfpereira realmente faz falta algo para acompanhar as postagem, marca como favorito seria uma excelente ou salvar para ler mais tarde. tenho um monte de guia aberta kkkkkk aguardando eu ler e fazer minhas anota√ß√µes.

Em resposta para @codigocafe, acredito que sem cobrar TabCoins.

>> Coment√°rio de antsoftsystems:
Importante implementa√ß√£o, pois devido ao grande volume de publica√ß√µes di√°ria, fica mais complicado achar uma que nos interessou em algum momento, principalmente se for antiga. Obviamente que um sistema de busca facilitaria at√© certo ponto, mas e se voc√™ esquecer o t√≠tulo do post? Favoritar, na minha singela opini√£o, √© bem mais que bem-vindo ao TabNews.
@codigocafe sem cobran√ßa de tabcoins

>> Coment√°rio de ItanuRomero:
Acabei de encontrar um artigo incr√≠vel que eu gostaria de salvar, como estamos com essa ideia?

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_1117_SUGEST√ÉO - Favoritar ou seguir as publica√ß√µes>

<issue_1118_SUGESTAO - usar sentry para monitorar erros e performance na api e frontend>
o [Sentry](https://sentry.io) √© um servi√ßo que permite rastrear erros em aplica√ß√µes, e possui sdks para diversas linguagens e frameworks.

Seria util no tabnews para ter notifica√ß√µes quando *shit hits the fan*

No site do sentry mostra varias informa√ß√µes detalhadas do erros desde a mensagem ate o stack trace e variaveis locais, e tambem mostra informa√ß√µes da maquina tambem pra dar um pouco mais de contexto

O tabnews sendo uma plataforma nova isso pode ajudar a amadurecer.

O sentry √© open source, ent√£o alem da vers√£o SaaS, existe a op√ß√£o de fazer self-hosting

>> Coment√°rio de Rafatcb:
@aprendendofelipe aproveitando que voc√™ est√° investigando alguns problemas com erro ao usar a vers√£o do Node 20, acha que o Sentry te ajudaria?

Lembrando da nossa pol√≠tica de n√£o coletar dados dos usu√°rios (https://github.com/filipedeschamps/tabnews.com.br/issues/237#issuecomment-1084948854), sei que o Sentry coleta algumas informa√ß√µes, como o IP, mas parece ser poss√≠vel n√£o colet√°-las ([documenta√ß√£o sobre como n√£o coletar IP](https://docs.sentry.io/platforms/javascript/enriching-events/identify-user/#ip_address)). Fora que esse problema s√≥ surgiria ao usar o Sentry na parte do frontend.

>> Coment√°rio de aprendendofelipe:
N√£o tenho certeza, mas acredito que n√£o ajudaria nesse caso, pois aparentemente os erros n√£o estavam ocorrendo na aplica√ß√£o, e sim em algo da Vercel (no start das lambdas).

A Vercel at√© deixa um aviso de que o Node 20.x ainda est√° em beta. Ap√≥s alterar para o Node 18.x, n√£o deu mais nenhum erro.

Acho que a gente s√≥ via os erros porque temos configurada integra√ß√£o direta da Vercel com o Axiom. O formato dos erros nem vinham no formato padr√£o dos erros gerados pela aplica√ß√£o.
</issue_1118_SUGESTAO - usar sentry para monitorar erros e performance na api e frontend>

<issue_1119_N√£o √© poss√≠vel acessar um coment√°rio (Erro 500)>
N√£o sei se o @cybernerd007 j√° percebeu, mas existe um coment√°rio dele que n√£o √© poss√≠vel acessar, aparece a seguinte mensagem:
![](https://i.imgur.com/tWx4WfL.png)

Link: https://tabnews-e7tweb4hc-tabnews.vercel.app/M0DERADOR/09114c6b-2503-41d9-9b73-2914292a175d

Olhando pela API, o coment√°rio n√£o √© nada mais (eu acho) que um `</div></code>`.  O curioso √© que eu fiz um coment√°rio com o mesmo conte√∫do e ele √© poss√≠vel acessar: https://tabnews-e7tweb4hc-tabnews.vercel.app/gsozinhos/0c4da1ea-bb7e-4b20-b4b4-b57a5e06f2c0

>> Coment√°rio de cybernerd007:
@gabrielsozinho esse erro eu ja havia tratado com o @filipedeschamps

>> Coment√°rio de gabrielsozinho:
@cybernerd007 ah sim, ent√£o vou fechar essa issue. ü§ô
</issue_1119_N√£o √© poss√≠vel acessar um coment√°rio (Erro 500)>

<issue_1120_SUGEST√ÉO - Melhorar o layout da listagem das tabnews.>
Para melhorar listagem da p√°gina inicial, fiz a sugest√£o da imagem abaixo.

**1** - Foto do perfil, nome do usu√°rio da publica√ß√£o e a data da publica√ß√£o.
**2** - Uma pr√©via da publica√ß√£o.
**3** - Tempo de leitura e a remo√ß√£o do nome do usu√°rio(nome do usu√°rio foi para o item 1).
**4** - Remover a numera√ß√£o da lateral esquerda.
**5** - Uma sutil linha separando as tabnews.

![image](https://user-images.githubusercontent.com/12504110/206852278-a20355f2-49a2-4d49-9473-1206a13fc831.png)

>> Coment√°rio de silvaezequias:
Gostei da ideia **2** de colocar uma pr√©via da publica√ß√£o e tamb√©m da ideia **3** de adicionar um algoritmo para estimar o tempo de leitura.

N√£o gosto da ideia de remover os n√∫meros da lateral pois com eles eu n√£o me perco na hora que estou lendo um conte√∫do (mesmo tendo o sistema que identifica os conte√∫dos j√° lidos).

Gosto da ideia de colocar uma foto de perfil (inclusive penso em implementar um sistema que sincroniza com a imagem do Github), s√≥ que com o est√°gio atual do TabNews, existem coisas que tem mais prioridade de serem implementadas.

>> Coment√°rio de gabrielsozinho:
1. Sobre a foto de perfil, outro dia eu discuti isso com algu√©m (infelizmente n√£o lembro quem), e o ponto que essa pessoa levantou foi que n√£o seria interessante mostrar a foto de perfil da pessoa dentro da publica√ß√£o porque os posts deveriam ser avaliados pelo conte√∫do e n√£o pela "beleza" da pessoa. Isso tamb√©m talvez deixasse a home mais polu√≠da. 
   A alternativa seria mostrar a foto de perfil apenas ao acessar o perfil do usu√°rio.
2. Eu gosto do jeito que √© hoje. E a ideia do TabNews √© poder ler os t√≠tulos de forma linear. Uma ideia que j√° foi sugerida, inclusive por mim, √© adicionar um preview ao passar o mouse por cima da publica√ß√£o, como acontece aqui no Github e at√© no YouTube.
   ![image](https://user-images.githubusercontent.com/90806505/206865440-c9e91f5d-3808-44c6-b40d-a973b0a7a856.png)
3. Seria excelente, Medium √© assim se n√£o me engano.
4. Nesse ponto eu concordo totalmente com o @ezequiaslopesdasilva 
5. Volto ao mesmo ponto que abordei no item 2, a ideia do TabNews √© poder ler os t√≠tulos de forma linear, talvez com a linha isso se torne mais dif√≠cil.
</issue_1120_SUGEST√ÉO - Melhorar o layout da listagem das tabnews.>

<issue_1121_[SUGEST√ÉO] - Aprimoramento de layout e novas funcionalidades>
Ol√° pessoal, gostaria de propor um aprimoramento de layout.
*Al√©m do design, a proposta tamb√©m inclui a cria√ß√£o de algumas funcionalidades que julgo importantes, dentre elas:

1.Tags;
2.Busca de conte√∫dos;
3.Links para agrupamentos do tipo (recentes,recomendado,seguindo (usu√°rios), "criados por mim");
4.Notifica√ß√µes (Mas somente dentro da plataforma, quando o usu√°rio fizer login);

Segue a imagem da minha proposta:

![Desktop - 1 (5)](https://user-images.githubusercontent.com/71492179/206874400-eed4a35b-db91-452b-b75f-5025abce168d.png)


*Esse layout √© um conceito criado no Figma inspirado no Flarum, adaptado √†s caracter√≠sticas do TabNews.
O objetivo √© aprimorar a experi√™ncia do usu√°rio com pitadas de UI/UX adicionando cores e elementos mais destacados.

>> Coment√°rio de aprendendofelipe:
Oi @Robson-Vasconcelos, muito legal essa proposta, n√£o s√≥ o design, mas tamb√©m os elementos que voc√™ adicionou e que ainda n√£o temos no TabNews. Bom trabalho! ü§©

Mas para o come√ßo do TabNews foi decidido seguir o m√°ximo poss√≠vel o design do GitHub.

Na **minha opini√£o** temos algumas vantagens com isso, entre elas:

1. Podemos aproveitar bastante a biblioteca de componentes React do GitHub (Primer);
2. Evitamos algumas decis√µes de UI, UX, acessibilidade etc. que tomariam um tempo que pode ser dedicado para a implementa√ß√£o de funcionalidades;
3. Aproveitamos um design que foi pensado para um p√∫blico muito similar ao do TabNews;
4. Evitamos problemas de falta de identidade entre partes do sistema desenvolvidas por diferentes colaboradores.

Acredito que em algum momento futuro o TabNews pode se distanciar bastante do GitHub para refor√ßar ainda mais a identidade pr√≥pria, ent√£o qualquer proposta √© v√°lida.

Mas eu adoraria ver outras vers√µes de layout em que, por enquanto e dentro do poss√≠vel, n√£o fugissem muito da proposta inicial.

E para trazer mais solu√ß√µes do que problemas, qualquer proposta de layout precisa funcionar bem:

1. Em diferentes tamanhos de tela;
2. Independentemente da cria√ß√£o de novas funcionalidades. 

E volto a frisar que √© s√≥ a minha opini√£o pessoal. üëç

>> Coment√°rio de iihieiii:
Bacana !

>> Coment√°rio de Robson-Vasconcelos:
Obrigado pelo feedback Felipe!.
Gosto de aplicar UI, UX nos meus projetos Front-end e gostei bastante do TabNews por isso fiz a proposta de aprimoramento.
Realmente a proposta inclui novas funcionalidades, naturamente. Dentre elas:

1.Tags;
2.Busca de conte√∫dos;
3.Links para agrupamentos do tipo (recentes,recomendado,seguindo (usu√°rios), "criados por mim");
4.Notifica√ß√µes (Mas somente dentro da plataforma, quando o usu√°rio fizer login);

De qualquer modo, n√£o precisam ser aplicados todos ao mesmo tempo.
Fico √† disposi√ß√£o para ajudar nas implementa√ß√µes do c√≥digo e para contribuir com o projeto em geral. üòÑ
</issue_1121_[SUGEST√ÉO] - Aprimoramento de layout e novas funcionalidades>

<issue_1122_<meta=Descri√ß√£o/>>
Feito uma pesquisa no Google como usu√°rio "pela primeira vez" me deparei com descri√ß√£o do TabNews que n√£o √© a descri√ß√£o quando compartilha a url.

![Screenshot_20221210-191011.png](https://user-images.githubusercontent.com/72875404/206877193-24b5f6ed-e913-4c8c-9241-e2f06928a2c4.png)

Tendo a seguinte d√∫vida sobre isso, digo que est√° certo isto?

Pense comigo; Recomendo a uma pessoa por boca e esta acessa pelo Google e ver√°s uma descri√ß√£o "estranha", pois √© descri√ß√£o de post de usu√°rios.  Zelo pela est√©tica üòÑ

> Nota: Descri√ß√£o muda a cada pesquisa feita.
</issue_1122_<meta=Descri√ß√£o/>>

<issue_1124_SUGEST√ÉO - Progressive Web Apps (PWA)>
Que tal o TabNews permitir a instala√ß√£o como um Progressive Web Apps (PWA)?

Com um PWA, eu posso fixar o TabNews na minha barra de tarefas como se fosse um aplicativo do computador. Al√©m disso, consigo fazer uso dele dentro do meu celular tamb√©m como se fosse um aplicativo, mas, na verdade, est√° abrindo no browser por tr√°s dos panos.

# O que mudaria para o usu√°rio?
Tendo a instala√ß√£o do PWA, seja no desktop ou mobile, teria um link direto na sua p√°gina inicial para o TabNews como se fosse um aplicativo.

## Desktop
Quando abrir o TabNews, o pr√≥prio navegador identifica que o site est√° configurado para PWA e sugere a instala√ß√£o como aplicativo.
![image](https://user-images.githubusercontent.com/4915497/206883816-d1f1e192-b201-497a-a279-93f0e5783133.png)
(Fonte: https://web.dev/learn/pwa/installation/#desktop-installation)

## Mobile
Parecido com o desktop, nos aparelhos m√≥veis existe a op√ß√£o de "Add to Home Page" ou "Adicionar √† P√°gina Inicial" quando √© um PWA.

### iOS
![image](https://user-images.githubusercontent.com/4915497/206883875-4a9ebef7-d4f8-49e2-9337-0c6635363ea6.png)
(Fonte: https://web.dev/learn/pwa/installation/#ios-and-ipados-installation)

### Android
![image](https://user-images.githubusercontent.com/4915497/206883847-7970339f-4ab9-48fc-b0a8-ab7e48e23ff9.png)
(Fonte: https://web.dev/learn/pwa/installation/#android-installation)



Refer√™ncia: https://web.dev/learn/pwa/installation/

>> Coment√°rio de leoferreiralima:
Acabei tendo exatamente essa Ideia, seria muito interessante termos essa op√ß√£o, fica literalmente na palma da m√£o o acesso, Vi que existe um pacote chamado next-pwa que parece bem simples de configurar

>> Coment√°rio de Poveii:
Eu uso a feature de poder criar um atalho do Tabnews pelo Chrome no meu celular a bastante tempo, desde que lan√ßou oficialmente, e at√© agora nada de bugs em rela√ß√£o a isso, √© exatamente como se eu usasse no pr√≥prio navegador. E tem at√© splash screen.

At√© um poss√≠vel App oficial do Tabnews em React Native, poder√≠amos tentar isso.

>> Coment√°rio de aprendendofelipe:
@darnley, obrigado pela sugest√£o! üí™

N√£o aparece para voc√™ a op√ß√£o de instalar? Isso j√° foi implementado h√° muito tempo.

Caso esteja aparecendo, pode encerrar a issue ü§ù

>> Coment√°rio de darnley:
> @darnley, obrigado pela sugest√£o! üí™
> 
> N√£o aparece para voc√™ a op√ß√£o de instalar? Isso j√° foi implementado h√° muito tempo.
> 
> Caso esteja aparecendo, pode encerrar a issue ü§ù

Opa, @aprendendofelipe! Verifiquei aqui e j√° est√° implementado mesmo neste momento. Obrigado por avisar. Diante disso, vou encerrar a issue. üòä
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/4915497/fb972fb4-d8cc-44a6-8221-ce7724f654c9)
</issue_1124_SUGEST√ÉO - Progressive Web Apps (PWA)>

<issue_1125_Acesso a API foi bloqueada pela pol√≠tica do CORS>
Boa tarde turma, tudo beleza?
Seguinte, eu tive uma ideia de site a parte do TabNews, chamado TabSaves (para favoritar algum post que o usu√°rio achou √∫til). Para isso eu precisaria do ID fixo de cada usu√°rio, por√©m, seria necess√°rio a autentica√ß√£o por meio da conta do TabNews (email e senha n√£o seriam armazenados, apenas o ID fixo).
Mas tive um problema com o CORS que n√£o est√° deixando eu fazer o request para a API, no endpoint `/sessions`.

Meu c√≥digo est√° chamando a API assim:
```js
fetch(`https://www.tabnews.com.br/api/v1/sessions`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Accept": "application/json",
      },
      body: JSON.stringify({
        "email": {userMail},
        "password": {userPassword},
      }),
    }).then(res => res.json()).then(json => console.log(json)).catch(err => console.log(err))
```
E o erro que estou recebendo √© esse:
```
Access to fetch at 'https://www.tabnews.com.br/api/v1/sessions' from origin 'http://127.0.0.1:5173' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: It does not have HTTP ok status.
```
### Eu vi que o Filipe j√° tinha resolvido este problema, mas por algum motivo ainda est√° me ocorrendo.

>> Coment√°rio de coffeeispower:
Na verdade o navegador meio que tem raz√£o, porque voc√™ est√° tentando usar os cookies do tabnews para fazer requests n√£o consentizados pelo usu√°rio, por isso que o CORS existe.

Adicione essa op√ß√£o no request:
```js
{
  credentials: "omit",
  ...
}
```

>> Coment√°rio de Dev-Lyh:
Infelizmente, mesmo colocando essa op√ß√£o continua a retornar o mesmo erro.

>> Coment√°rio de danielschmitz:
√© incompatibilidade entre http e https

tente usar "http**s**://127.0.0.1:5173"

>> Coment√°rio de Dev-Lyh:
> √© incompatibilidade entre http e https
> 
> tente usar "http**s**://127.0.0.1:5173"

Desculpa a demora para mandar um feedback, estava sem tempo para verificar o c√≥digo e o GitHub.
Infelizmente, ainda n√£o foi. O que n√£o entendo √© que no React-Native consigo chamar a API normalmente, mas em Node e ReactJS t√° dando esse problema.

>> Coment√°rio de coffeeispower:
Leia sobre o CORS nos navegadores, no react native nao tem esse problema porque n√£o roda em um navegador, ent√£o ele n√£o guarda cookies, vc precisa explicitamente mandar o header `Cookie` no react native.

>> Coment√°rio de Dev-Lyh:
Como eu ainda n√£o consegui fazer minha aplica√ß√£o funcionar, mesmo com a ajuda de voc√™s, irei fechar a issue, j√° que aparentemente deve ser um problema que s√≥ est√° acontecendo comigo, por algum motivo.

Obrigado a todos que tentaram ajudar :)

>> Coment√°rio de aprendendofelipe:
@Dev-Lyh, obrigado por reportar! üí™

N√£o sei se conseguiu contornar de alguma forma, mas uma solu√ß√£o acabou de ir para produ√ß√£o com o merge do PR #1678 üëç

>> Coment√°rio de Dev-Lyh:
Ol√°, @aprendendofelipe!
Na √©poca em que fiz em que comecei o projeto e me deparei com esse erro, parei de desenvolve-lo. Mas essa semana vou ver se consigo dar uma olhada nesse PR para verificar se consigo recome√ßa-lo.
Obrigado por lembrar dessa issue! üòÅ
</issue_1125_Acesso a API foi bloqueada pela pol√≠tica do CORS>

<issue_1126_Separar por tag>
Na minha opini√£o separar os v√°rios posts por tags seria mais efetivo, atualmente se alguem fizer uma pergunta ela ser√° eternamente colocada para baixo por novos posts como tutoriais, not√≠cias, artigos etc.

Ent√£o seria algo bom algo parecido com o sistema do stackoverflow.

>> Coment√°rio de codigocafe:
@PRMSA , essas tags seriam pr√©-definidas ou o usu√°rio iria colocar suas tags / keywords com limite keywords para n√£o inserir uma publica√ß√£o nas tags?  

Possu√≠ uma [issues](https://github.com/filipedeschamps/tabnews.com.br/issues/1136) parecida com esta aqui.

>> Coment√°rio de PRMSA:
poderia ser predefinida com um 'navebar' j√° no site, assim o usu√°rio seria restrito na busca, e o usu√°rio podendo tamb√©m colocar as tags q achar necess√°rio para ajudar em buscas menos restritas al√©m de fornecer mais informa√ß√µes sobre o contexto do post

>> Coment√°rio de codigocafe:
N√£o sei se possui moderador no site, mas seria um trabalho chato para adicionar novos t√≥picos, j√° que a TIC possui uma evolu√ß√£o grande e r√°pida, todos os dias possui assunto novo.

>> Coment√°rio de PRMSA:
adiciona s√≥ os b√°sicos como separar por tipo de post e liguagem de programa√ß√£o.
Tipo de posts: Tutorial, Artigo, Noticia, Perguntas
Linguagem √© auto explicativo j√° as tags q o usu√°rio adicionar √© apenas pra se restringir o q ter√° no post

>> Coment√°rio de codigocafe:
√≥tima ideia.

>> Coment√°rio de rodrigoKulb:
Pessoal estamos com v√°rias Issues sobre esse assunto, vamos unificar a discuss√£o na mais antiga?
#742 
@PRMSA poderia finalizar essa?

>> Coment√°rio de aprendendofelipe:
@PRMSA, obrigado pela sugest√£o! üí™

Como o @rodrigoKulb mencionou, j√° existe uma issue sobre o assunto (#742), ent√£o tamb√©m recomendo continuar a conversa por l√°.

Vou fechar essa aqui. Combinado? ü§ù
</issue_1126_Separar por tag>

<issue_1127_Modo Noturno>
Hoje estava eu navegando pela TabNews a noite, e o que me deu um certo desconforto foi n√£o ter o modo noturno nela.
Seria poss√≠vel implementar algo nesse sentido? Acredito que seria interessante e ajudaria na leitura noturna.

>> Coment√°rio de samuelrvg:
@MaiconLuksik Eu pensei a mesma coisa hoje, j√° ia abrir uma ISSUE para isso.

>> Coment√°rio de danielschmitz:
tem duas extens√µes no chrome, dark mode e dark reader

>> Coment√°rio de saraiva1989:
@filipedeschamps ou admins, Eu iniciei a implementa√ß√£o do dark mode;

![image](https://user-images.githubusercontent.com/40599423/216158568-0563804c-338e-4725-8f3c-d918c721c6cc.png)

![image](https://user-images.githubusercontent.com/40599423/216158625-055c25d2-930c-4e41-affa-44804392da43.png)

Ainda tem alguns ajustes a ser feito, colocar no checkbox um css bonitinho e ajustar algumas coisas mais.

basicamente eu criei um CSS e altero as variaveis dependendo do tema

![image](https://user-images.githubusercontent.com/40599423/216158861-86c971b0-b088-4378-85ec-ff4b147d92d5.png)

![image](https://user-images.githubusercontent.com/40599423/216158891-3fb890fe-3d40-47e6-9cb2-cc24df681732.png)

Gostaria de saber se posso dar continuidade na implementa√ß√£o.

>> Coment√°rio de Rafatcb:
@aprendendofelipe Estava vendo alguns issues do reposit√≥rio, falta algo na implementa√ß√£o do modo noturno ou essa j√° pode ser fechada?

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb! E obrigado pela sugest√£o @MaiconLuksik! üí™

O modo noturno j√° foi implementado e o hist√≥rico est√° distribu√≠do em diferentes PRs e issues, mas um local onde tudo (ou quase tudo) est√° referenciado √© no #1199, ent√£o podemos encerrar esse aqui. ü§ù
</issue_1127_Modo Noturno>

<issue_1128_Sem permiss√£o para fazer login, erro: create:session>
Salve galera, como voc√™s est√£o? 

Estou tendo problemas ao tentar efetuar login no site do tabnews. Ao colocar meu email e senha eu recebo a mensagem de erro abaixo:

"Voc√™ n√£o possui permiss√£o para fazer login. Verifique se este usu√°rio possui a feature "create:session"."

J√° fiz a confirma√ß√£o de senha no meu email tudo certinho, mas ainda sim sem sucesso ao efetuar o login, poderiam me ajudar?

Meu email: xxx

Username: leodots

>> Coment√°rio de filipedeschamps:
@Leodots removi da issue o seu email. Voc√™ poderia enviar um email para contato@tabnews.com.br com o email que utilizou no cadastro?

Um abra√ß√£o!

>> Coment√°rio de leodots:
Filipe informou por e-mail que eu fiz o cadastro em um momento que o site estava passando por instabilidades, e o mesmo corrigiu o problema na minha conta.

Muito obrigado pela ajuda!
</issue_1128_Sem permiss√£o para fazer login, erro: create:session>

<issue_1129_Atualiza√ß√£o da extens√£o de busca [Vers√£o Firefox ‚úÖ]>
## TabNews Google Search

### Update v.0.0.4 ‚úÖ
- Adi√ß√£o de novo m√©todo de encode para evitar a exclus√£o de caracteres fora do conjunto ASCII, como por exemplo `#`.
- Liberado [vers√£o para Firefoxü¶ä](https://addons.mozilla.org/pt-BR/firefox/addon/tabnews-google-search/)

[Saiba mais](https://www.tabnews.com.br/karytonn/extensao-de-pesquisa-para-o-tabnews)

>> Coment√°rio de coffeeispower:
Faz a extens√£o do Firefox funcionar no android

>> Coment√°rio de Karytonn:
> Faz a extens√£o do Firefox funcionar no android

Obrigado pela sugest√£o, vou adicionar ao roadmap de valida√ß√£o e caso se torne um update ent√£o o informo aqui.

>> Coment√°rio de Rafatcb:
Como essa √© uma extens√£o externa ao reposit√≥rio, acho esse issue poderia ser fechado, principalmente agora que temos a busca no pr√≥prio www.tabnews.com.br.
O que acha, @aprendendofelipe ?

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb! E obrigado @Karytonn! üí™

Fechando a issue. ü§ù
</issue_1129_Atualiza√ß√£o da extens√£o de busca [Vers√£o Firefox ‚úÖ]>

<issue_1130_Agradecimento - Firewall>
Obrigado por instalarem o firewall, como tinha sugerido a Cloudflare. √â muito gratificante a equipe atender a seguran√ßa que √© primordial.

![Screenshot_20221212-125116-900.png](https://user-images.githubusercontent.com/72875404/207091280-291adf2e-aa10-4098-a13e-cb8972041f34.png)
</issue_1130_Agradecimento - Firewall>

<issue_1131_[BUG] Conte√∫dos Invis√≠veis com Tags Vazias>
## Contexto
Comentando nesse post: https://tabnews-pggcz5y8n-tabnews.vercel.app/gsozinhos/test-mixed-content percebi que se abrir e fechar uma tag, como exemplo: `<b></b>`, o Markdown Viewer n√£o renderiza nada.
Onde o meu coment√°rio (https://tabnews-pggcz5y8n-tabnews.vercel.app/ezequiastestes/5a66ada5-09b0-45fd-bfd6-80ac4033aa6c) √© um monte de tag B abrindo e fechando sem nada dentro n√£o √© renderizado nada.

## Solu√ß√£o
Fazendo umas pesquisas e alguns testes, encontrei esse regex que remove todas as tags vazias do conte√∫do e da pra fazer a valida√ß√£o:

```js
var regex = /<[^/>][^>]*><\/[^>]+>/
var html = '<p>a tag √† frente est√° vazia</p><text></text><img src="..." />';

var htmlWithoutEmptyTags = html.replace(regex, '');
// <p>a tag √† frente est√° vazia</p><img src='...' />
```

>> Coment√°rio de gabrielsozinho:
@ezequiaslopesdasilva Eu fiz uns testes aqui e li algumas perguntas do Stack Overflow e essa regex que voc√™ usou n√£o funciona para caso as tags tenham um espa√ßo vazio no meio (`<p> </p>`). 

O que eu encontrei foi essa aqui, que consegue identificar o espa√ßo. `/<([^\/>]+|[^\/>]*["\'][^"\'>]*["\'][^\/>]+)>\s*<\/[^>]+>/`. O que acha?

>> Coment√°rio de silvaezequias:
> @ezequiaslopesdasilva Eu fiz uns testes aqui e li algumas perguntas do Stack Overflow e essa regex que voc√™ usou n√£o funciona para caso as tags tenham um espa√ßo vazio no meio (`<p> </p>`).
> 
> O que eu encontrei foi essa aqui, que consegue identificar o espa√ßo. `/<([^\/>]+|[^\/>]*["\'][^"\'>]*["\'][^\/>]+)>\s*<\/[^>]+>/`. O que acha?

Testei aqui e realmente d√° certo. Um problema que ainda persiste √© o de "caractere invis√≠vel": Copiei um caractere que tem nesse site https://fabricioventura.com/caractere e coloquei entre tags e enviou normalmente (continuou invis√≠vel). Esses caracteres era pra serem removidos nessa linha: https://github.com/filipedeschamps/tabnews.com.br/blob/8571878db19d6a00a232c211cdacf99b0061dbd6/models/validator.js#L270

![image](https://user-images.githubusercontent.com/63757378/207131100-e715513d-e3ca-4030-8060-ab7c33c6fd29.png)
![image](https://user-images.githubusercontent.com/63757378/207131166-c50f283d-78ee-4869-841d-9d59cc275c38.png)

Caractere usado: >>`‚†Ä`<<

>> Coment√°rio de cybernerd007:
@ezequiaslopesdasilva esses problemas eu ja havia falado com o @filipedeschamps sobre e ele me falou que seria arrumado numa futura atualiza√ß√£o...

>> Coment√°rio de gabrielsozinho:
> [ttps://fabricioventura.com/caractere](https://fabricioventura.com/caractere) e coloquei entre tags e enviou normalmente (continuou invis√≠vel). Esses caracteres era pra serem removidos nessa linha:

√â uma coisa dif√≠cil de resolver, isso porque devem existir dezenas, centenas ou talvez at√© milhares de caracteres como este. Sei disso porque eu era bastante ligado com jogos e em alguns jogos para dar espa√ßo na name tag era necess√°rio usar alguns desses caracteres, quando o nome n√£o estava dispon√≠vel era s√≥ procurar algum outro e pronto. √â bem dif√≠cil conseguir listar todos.

>> Coment√°rio de silvaezequias:
> √â uma coisa dif√≠cil de resolver, isso porque devem existir dezenas, centenas ou talvez at√© milhares de caracteres como este. Sei disso porque eu era bastante ligado com jogos e em alguns jogos para dar espa√ßo na name tag era necess√°rio usar alguns desses caracteres, quando o nome n√£o estava dispon√≠vel era s√≥ procurar algum outro e pronto. √â bem dif√≠cil conseguir listar todos.

Ent√£o √© melhor fazer uma esp√©cie de "banco de dados" com esses caracteres e quando formos encontrando mais, vamos adicionando l√°. Consigo fazer um pacote npm pra isso se precisar.

>> Coment√°rio de cybernerd007:
n√£o seria mais facil fazer um filtro baseado nas 26 letras e nos 10 numeros?
a logica seria assim pegar o texto e ve o tamanho dele em seguida faz uma compara√ß√£o se n√£o bater com as 26 letras nem com os 10 numeros e s√≥ rejeitar.... caso for permitido < e / ou demais incluir no filtro....

>> Coment√°rio de silvaezequias:
> n√£o seria mais facil fazer um filtro baseado nas 26 letras e nos 10 numeros? a logica seria assim pegar o texto e ve o tamanho dele em seguida faz uma compara√ß√£o se n√£o bater com as 26 letras nem com os 10 numeros e s√≥ rejeitar.... caso for permitido < e / ou demais incluir no filtro....

Mas ai teria que colocar nesse filtro pontua√ß√µes, acentos, emojis, outros caracteres que s√£o aceitaveis no tabnews e que n√£o s√£o invis√≠veis, como por exemplo essa lista com 2 mil: https://www.caracteresespeciais.com/2009/09/lista-com-2-mil-caracteres-especiais.html
Acho que se tornaria um problema se limitar somente √† n√∫meros e letras.

>> Coment√°rio de cybernerd007:
> > n√£o seria mais facil fazer um filtro baseado nas 26 letras e nos 10 numeros? a logica seria assim pegar o texto e ve o tamanho dele em seguida faz uma compara√ß√£o se n√£o bater com as 26 letras nem com os 10 numeros e s√≥ rejeitar.... caso for permitido < e / ou demais incluir no filtro....
> 
> Mas ai teria que colocar nesse filtro pontua√ß√µes, acentos, emojis, outros caracteres que s√£o aceitaveis no tabnews e que n√£o s√£o invis√≠veis, como por exemplo essa lista com 2 mil: https://www.caracteresespeciais.com/2009/09/lista-com-2-mil-caracteres-especiais.html Acho que se tornaria um problema se limitar somente √† n√∫meros e letras.

basta converter o texto em ascii e comparar com a tabela... no caso vai puxar muito recurso mas se for deixar para incluir cada caracter um a um caso deixe algum para tras seria uma brecha perigosa... ou n√£o.

>> Coment√°rio de cybernerd007:
acredito que esse problema muitas pessoas inclusive empresas tem ent√£o seria algo interessante para a comunidade ser feito um modulo resolvendo esse problema para enriquecer ainda mais a comunidade open source... minha opni√£o

>> Coment√°rio de gabrielsozinho:
Eu achei uma lista com caracteres invis√≠veis. Na lista existem 61 desses e mais 7 quebras de linha/separadores: [https://character.construction/blanks](https://character.construction/blanks).

O problema √© que n√£o s√£o todos os caracteres que devem ser substitu√≠dos por `''`, inclusive alguns podem ser √∫teis.

Estou fazendo o teste de todos os caracteres invis√≠veis [nesta publica√ß√£o](https://tabnews-pggcz5y8n-tabnews.vercel.app/gsozinhos/test-mixed-content), e se consigo publicar esse caractere eu edito o coment√°rio com o c√≥digo dele. Parei no `EN SPACE` e esse n√£o foi permitido, depois continuo porque agora eu to bloqueado pelo rate limit.

>> Coment√°rio de 33gustavo33:
N√£o daria pra usar o `remove-markdown` para verificar as tags vazias?
```js
import removeMarkdown from 'models/remove-markdown.js';

const text = "<b></b> <p> </p>"

removeMarkdown(text).trim() // Resultado √© uma string vazia.
```

>> Coment√°rio de silvaezequias:
> @cybernerd007 acredito que esse problema muitas pessoas inclusive empresas tem ent√£o seria algo interessante para a comunidade ser feito um modulo resolvendo esse problema para enriquecer ainda mais a comunidade open source... minha opni√£o

Entendi! Vou fazer um m√≥dulo ent√£o pra tentar resolver esse problema.

> @gabrielsozinho Estou fazendo o teste de todos os caracteres invis√≠veis [nesta publica√ß√£o](https://tabnews-pggcz5y8n-tabnews.vercel.app/gsozinhos/test-mixed-content), e se consigo publicar esse caractere eu edito o coment√°rio com o c√≥digo dele. Parei no EN SPACE e esse n√£o foi permitido, depois continuo porque agora eu to bloqueado pelo rate limit.

Vendo essa sua publica√ß√£o, eu descobri um outro "erro". Vou reportar jaj√°

> @33gustavo33 N√£o daria pra usar o `remove-markdown` para verificar as tags vazias?

A quest√£o de remover tags vazias j√° foi resolvida, o problema mesmo s√£o os caracteres invis√≠veis.

>> Coment√°rio de gabrielsozinho:
> Vendo essa sua publica√ß√£o, eu descobri um outro "erro". Vou reportar jaj√°

Ok. Eu j√° testei com todos os caracteres, pra ver quais s√£o basta ir no [meu perfil](https://tabnews-pggcz5y8n-tabnews.vercel.app/gsozinhos) que vai ter a lista com todos eles. üëç

>> Coment√°rio de aprendendofelipe:
Galerinha, voc√™s s√£o do mal, hein! Hahaha... Eu j√° tinha escrito uma solu√ß√£o. S√≥ n√£o subi porque queria criar bem mais testes antes para n√£o ter como regredir nada, mas voc√™s me apressaram. üòÖ

#1133

>> Coment√°rio de cybernerd007:
> Galerinha, voc√™s s√£o do mal, hein! Hahaha... Eu j√° tinha escrito uma solu√ß√£o. S√≥ n√£o subi porque queria criar bem mais testes antes para n√£o ter como regredir nada, mas voc√™s me apressaram. üòÖ
> 
> #1133

eu tentei avisar kkkkkkk
mas como diria aquele ditado j√° que n√£o pode contra eles, junte se a ele kkkk

>> Coment√°rio de cybernerd007:
@aprendendofelipe acredito que tenha acontecido algum erro na sua deploy pois nada abre e quando vou logar aparece que eu fiz muitas requisi√ß√µes sendo que eu acabei de abrir a pagina...
OBS.: estou na ultima deploy de 11 minutos atras

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe acredito que tenha acontecido algum erro na sua deploy pois nada abre e quando vou logar aparece que eu fiz muitas requisi√ß√µes sendo que eu acabei de abrir a pagina... OBS.: estou na ultima deploy de 11 minutos atras

O @filipedeschamps tirou do ar essa implanta√ß√£o, pois algu√©m estava atacando üëç

>> Coment√°rio de silvaezequias:
#1133
</issue_1131_[BUG] Conte√∫dos Invis√≠veis com Tags Vazias>

<issue_1135_Sugest√£o de redesign do TabNews üò±>
![TabNews redesign](https://user-images.githubusercontent.com/71526510/207656499-b47def8f-de2f-4177-99db-0e5feeb9cb8b.png)

Confira o design no Figma: [link](https://www.figma.com/file/G0p98rf4It7pIbBXQBcmP4/TabNews-Redesign?t=Y1QJNUHivTopOK8d-1)

### Porqu√™ um redesign?

- adiciona uma indentidade visual mais consistente
- melhora a experi√™ncia do usu√°rio, e primeiras impress√µes do site
- transmite maior credibilidade

### Features do novo design

- Adiciona mais visibilidade as moedas do site (TabCoins/TabCash)
- Torna o bot√£o de criar conte√∫do mais vis√≠vel, estimulando mais a cria√ß√£o de valor no site
- Separa melhor barra de navega√ß√£o do site, tornado melhor de se navegar
- Adiciona foto de perfil, assim ficando mais f√°cil a diferencia√ß√£o entre usu√°rios,
- colocando uma barra de pesquisa fica mais f√°cil achar um conte√∫do de interesse (Ideia dos pr√≥prios usu√°rios)
- separa√ß√£o de conteudos adicionando espa√ßamento entre os mesmos tornando a leitura mais f√°cil
- aplicando os valores visuais corretos nos conte√∫dos, aumentando os bot√µes, e dando mais impot√¢ncia aos t√≠tulos
- adi√ß√£o do n√∫mero de visualiza√ß√µes nos conte√∫dos (Ideia dos pr√≥prios usu√°rios)

link do post no TabNews: [link](https://www.tabnews.com.br/tiagoxsavioli/sugestao-de-redesign-do-tabnews)

>> Coment√°rio de fabriciolak:
Tiago, recomendo voc√™ seguir um padr√£o de design system do [Primer](https://primer.style/), pois o tabnews usa e daria mais consist√™ncia ao design.

Tamb√©m seria legal ter a visualiza√ß√£o individual de cada componente, para ter mais detalhes sobre variantes, estados e afins.

P.S.: Eu gostei bastante do design, tanto que gostaria muito de fazer um redesign do tabnews e codar. At√© coloquei na lista de projetos futuros. üëª

>> Coment√°rio de mthmcalixto:
@TiagoXavierSavioli o melhor que eu vi at√© agora haha!

>> Coment√°rio de Rafatcb:
Acho que fazer um redesign por completo seria um "trabalho atoa". √â mais importante focar na melhoria da usabilidade, corre√ß√£o de bugs e novas funcionalidades. Dito isso, nada impede de fazer melhorias pontuais que poderiam ser consideradas "redesigns" de coisas espec√≠ficas. Lembrando que usamos os componentes do Primer com o objetivo de n√£o precisar estilizar as coisas, e se aproximar do design do GitHub.

Por ser algo muito abrangente, acho que faz sentido fecharmos este issue para organizar o reposit√≥rio.
</issue_1135_Sugest√£o de redesign do TabNews üò±>

<issue_1136_Localizar conte√∫do>
Uma boa sugest√£o √© colocar a op√ß√£o de localizar conte√∫do, como a uma gama de assuntos, o usuarios pode localizar seus conteudos para leitura.

>> Coment√°rio de codigocafe:
Pode ser utilizado no formato de nuvem de tags ou colocar um campo de busca para facilitar a localiza√ß√£o de conte√∫dos.

>> Coment√°rio de jjpaulo2:
T√° rolando uma discuss√£o em #1084 sobre busca de conte√∫do. Acho que talvez d√™ pra aproveitar algo de l√°.

>> Coment√°rio de aprendendofelipe:
@EuCesarCarvalho, obrigado pela sugest√£o! üí™

Vou fechar essa por ser duplicada, e recomendo centralizar a discuss√£o nas issues relacionadas abaixo:

- #742 
- #927 

Cominado? ü§ù
</issue_1136_Localizar conte√∫do>

<issue_1137_[Feature Request] Hall da Fama>
# Feature Request
## Hall da Fama
Seria legal ter uma aba que, a priori, estou chamando de `Hall da Fama`.
Para esse hall considerar√≠amos visualiza√ß√µes, `thumbs-up` e coment√°rios (ou poder√≠amos ordenar escolhendo um dos tr√™s par√¢metros como crit√©rios). Tamb√©m acho pertinente ter um crit√©rio de engajamento relacionado com o tempo, afinal, naturalmente, bons posts antigos tendem a ter melhores n√∫mero do que os novos, ent√£o poder√≠amos usar algo como `visualiza√ß√µes/dia`.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, ozzono! J√° temos um issue aberto sobre a possibilidade de listar conte√∫dos de usu√°rios por TabCoins, mas acabei editando ele para ficar mais abrangente e englobar sua sugest√£o tamb√©m, assim podemos concentrar a discuss√£o em um √∫nico issue.

* https://github.com/filipedeschamps/tabnews.com.br/issues/1388
</issue_1137_[Feature Request] Hall da Fama>

<issue_1138_[SUGEST√ÉO - UI/UX] Salvar e retornar estado do scroll nas listagem de t√≥picos.>
Quando estou navegando entre os t√≥picos, √© necess√°rio ficar scrollando para chegar onde eu estava anteriormente √† abrir um t√≥pico. No fim da p√°gina fica bem chatinho toda vez fazer isso e procurar o √∫ltimo artigo visto.

>> Coment√°rio de Rafatcb:
Voc√™ diz para fazer isso ao voltar de p√°gina pelo navegador? Eu senti essa necessidade tamb√©m. Percebi que ao voltar, o scroll est√° posicionado corretamente, mas rapidamente ele vai para o topo.

>> Coment√°rio de SidiBecker:
Exatamente @Rafatcb
</issue_1138_[SUGEST√ÉO - UI/UX] Salvar e retornar estado do scroll nas listagem de t√≥picos.>

<issue_1139_Tag - Meta - Article - Telegram - Sugest√£o>
Como sabem, o Telegram tem um formato que √© poss√≠vel ler um artigo sem sair da plataforma.

Veja na imagem: 

![Screenshot_20221218-174103-629.png](https://user-images.githubusercontent.com/72875404/208318883-c1fbe36d-549f-44e9-8fb8-e4e8cfbded18.png)

![Screenshot_20221218-174121-070.png](https://user-images.githubusercontent.com/72875404/208318533-a7cc9529-d941-42f3-8fa9-77746a958697.png)

Percebi que a tag usado √©:

```js
<meta property="og:type" content="article" />
```

Diferente de um dos posts do TabNews:

![Screenshot_20221218-174137-917.png](https://user-images.githubusercontent.com/72875404/208318597-a1efc224-a756-4033-9c14-87bea5947efd.png)

Tag usado √©:

```js
<meta property="og:site_name" content="TabNews"/>
```

Minha **sugest√£o** √©, poderiam adicionar mais essa tag? N√£o sei se existem conflitos ou √© exibido em outros al√©m do Telegram.

>> Coment√°rio de aprendendofelipe:
@Jetrom17, n√£o entendi qual √© a sua sugest√£o.

As p√°ginas de conte√∫dos do TabNews j√° possuem as tags que voc√™ citou:

```html
<meta property="og:site_name" content="TabNews"/>
<meta property="og:type" content="article" />
```

Al√©m de muitas outras...

>> Coment√°rio de cybernerd007:
> @Jetrom17, n√£o entendi qual √© a sua sugest√£o.
> 
> As p√°ginas de conte√∫dos do TabNews j√° possuem as tags que voc√™ citou:
> 
> ```
> <meta property="og:site_name" content="TabNews"/>
> <meta property="og:type" content="article" />
> ```
> 
> Al√©m de muitas outras...

acredito que ele quer que seja adicionado uma TAG para ficar igual a primeira imagem com o bot√£o "leitura rapida" para que seja possive ele ler dentro do telegram sem a necessidade de sair

>> Coment√°rio de Jeiel0rbit:
> > @Jetrom17, n√£o entendi qual √© a sua sugest√£o.
> > 
> > As p√°ginas de conte√∫dos do TabNews j√° possuem as tags que voc√™ citou:
> > 
> > ```
> > <meta property="og:site_name" content="TabNews"/>
> > <meta property="og:type" content="article" />
> > ```
> > 
> > Al√©m de muitas outras...
> 
> acredito que ele quer que seja adicionado uma TAG para ficar igual a primeira imagem com o bot√£o "leitura rapida" para que seja possive ele ler dentro do telegram sem a necessidade de sair

Exatamente isso. @aprendendofelipe desculpe, n√£o vi esse elemento no post dos usu√°rios, somente na p√°gina home.

>> Coment√°rio de aprendendofelipe:
N√£o era nada que faltava no site, mas precisava ensinar ao Telegram sobre como obter o t√≠tulo, autor, data e corpo dos artigos do TabNews para criar a p√°gina de "leitura r√°pida".

J√° fiz isso e agora √© s√≥ aguardar a aprova√ß√£o deles üëç

>> Coment√°rio de Jeiel0rbit:
> N√£o era nada que faltava no site, mas precisava ensinar ao Telegram sobre como obter o t√≠tulo, autor, data e corpo dos artigos do TabNews para criar a p√°gina de "leitura r√°pida".
> 
> J√° fiz isso e agora √© s√≥ aguardar a aprova√ß√£o deles üëç

Ok, posso marcar como "resolvido", embora no aguardo da aprova√ß√£o?
</issue_1139_Tag - Meta - Article - Telegram - Sugest√£o>

<issue_1140_Milestone 6 - Performance e Seguran√ßa>
Turma, chegou a hora de organizarmos a nova fase do desenvolvimento do TabNews e dar **destaque** a todas as contribui√ß√µes que est√£o acontecendo pela **melhor comunidade open source do Brasil**. Tudo vai seguir da mesma forma que antes, por√©m com uma novidade **muito interessante**: quem ir√° liderar a [Milestone 6](https://github.com/filipedeschamps/tabnews.com.br/milestone/10) √© o @aprendendofelipe üòç üí™ üëç ü§ù

O @aprendendofelipe √© um dos contribuidores mais ativos do projeto, possui acesso de **escrita** e **deploy** e foi o respons√°vel por levar para produ√ß√£o todos os √∫ltimos Pull Requests que a comunidade fez nas √∫ltimas semanas. Dado a isso, realizei um call com ele semana passada onde discutimos alguns pontos do projeto e, de surpresa, fiz o convite para ele liderar esta Milestone e turma, **ele aceitou** üòç üòç üòç Eu fico **genuinamente feliz** com isto, pois assim conseguirei dar mais aten√ß√£o ao curso que estou desenvolvendo sem precisar parar de fazer v√≠deos para o canal ü§ù 

Ent√£o eu irei dar o pontap√© inicial na organiza√ß√£o das tarefas para logo mais para frente passar de fato o bast√£o para o @aprendendofelipe üëç 

Bom, voc√™ j√° deve ter visto no t√≠tulo da issue que o nome desta Milestone √© **Performance e Seguran√ßa** onde, independente de outras implementa√ß√µes que forem feitas, ter este norte nos ajuda a n√£o nos esquecermos do que de fato o projeto est√° mais precisando no momento, principalmente para conseguirmos dar o pr√≥ximo passo que √© a Milestone de Revenue Share. Mas novamente, outras implementa√ß√µes s√£o bem vindas, como a estabiliza√ß√£o da implementa√ß√£o sobre o Dark Mode que diariamente as pessoas est√£o pedindo.

Ent√£o para executarmos esta Milestone sugiro dividirmos as tarefas novamente em 3 categorias:

1. Performance
2. Seguran√ßa
3. Melhorias

~Vou descrever cada uma abaixo, mas esta lista por enquanto √© um **Rascunho** que ir√° pegar itens que j√° foram executados (mas n√£o foram registrados em Milestones) e ir√° dar a estrutura necess√°ria para registrar os novos itens.~

## Performance

Este s√£o os itens que ir√£o melhorar a performance e usabilidade do TabNews e neste ponto h√° muitas oportunidades, principalmente no backend (como cria√ß√£o de √≠ndices no banco de dados).

- #1141
- #1143
- #1145
- #1148
- #1164
- #1375
- #1169
- #1443 
- #1439 
- #1464 
- #1406 
- #1451 
- #1630 
- #1632 

## Seguran√ßa

Esta categoria envolve tanto a seguran√ßa **t√©cnica** do sistema quanto a seguran√ßa da **economia** do TabNews.

Na parte t√©cnica, devemos considerar desde, por exemplo, acessos n√£o autorizados, a estabilidade do sistema e gerenciamento de erro. Na parte da economia, devemos considerar mec√¢nicas para evitar abusos das TabCoins e expor o m√°ximo de informa√ß√£o para as pessoas da comunidade conseguirem identificar manipula√ß√µes, como por exemplo, ~expor quem deu up/down vote~ ([Edit] apenas a modera√ß√£o pode ver quem e como votou).

- #1142
- #1146
- #1147
- #1149
- #1150
- #1151
- #1157
- #1216
- #1180
- #1307
- #1332
- #1154
- #1339 
- #1168
- #1155
- #1166
- #1167  
- #1267 
- #1531 
- #1533 
- #1541 
- #1554  
- #1170 
- #1344 
- #1516 
- #1618 

## Melhorias

Esta √© uma categoria aberta e que deve listar todas as lapida√ß√µes que o projeto vem recebendo.

- #1144
- #1158
- #1159
- #1160
- #1161
- #1162
- #1163
- #1217
- #1218
- #1219
- #1220
- #1221
- #1223
- #1224
- #1280
- #1281
- #1282
- #1283
- #1284
- #1286
- #1287
- #1288
- #1306
- #1308
- #1309
- #1311
- #1331
- #1333
- #1334
- #1335
- #1199
- #1360
- #1361
- #1362
- #496 
- #1386 
- #1390
- #1425 
- #1426 
- #1461 
- #1465 
- #1466 
- #788 
- #927 
- #1557 
- #1489 
- #1499 
- #1508 
- #1521 
- #1525 
- #1548 
- #1549 
- #1559 
- #1560 
- #1532 
- #1422 
- #1565 
- #1572 
- #1570 
- #1188
- #807
- #1573 
- #902 
- #1578 
- #943 
- #1588 
- #1590 
- #1582 
- #1580 
- #1594 
- #1595 
- #1593 
- #972 
- #1602 
- #1236 
- #1596  
- #1380 
- #605 
- #1605 
- #1601 
- #895 
- #1620 
- #1621 
- #1606 
- #1624 
- #1370 
- #1628 
- #1629 
- #1633

>> Coment√°rio de filipedeschamps:
@aprendendofelipe registrei aqui tudo o que eu tinha no meu hist√≥rico (tirando um item que voc√™ executou, mas que sugiro aguardamos um fix naquele m√≥dulo `third party` antes de anunciarmos).

Uma pergunta: por ter `write` no reposit√≥rio, voc√™ consegue editar o corpo da issue ali de cima?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe registrei aqui tudo o que eu tinha no meu hist√≥rico (tirando um item que voc√™ executou, mas que sugiro aguardamos um fix naquele m√≥dulo `third party` antes de anunciarmos).
> 
> Uma pergunta: por ter `write` no reposit√≥rio, voc√™ consegue editar o corpo da issue ali de cima?

Boa @filipedeschamps! Eu consigo editar sim, ent√£o mais tarde vou adicionando os outros PRs üöÄ

>> Coment√°rio de brunofamiliar:
Show! Vou tentar acompanhar mais de perto essa Milestone

>> Coment√°rio de filipedeschamps:
Turma, eu n√£o sei se esqueci de algo, mas acho que cadastrei todos os itens que eu tinha aqui na fila de espera sobre performance e seguran√ßa (dos que podem ficar p√∫blicos, por enquanto).

>> Coment√°rio de aprendendofelipe:
O que acham de adicionar a possibilidade de mostrarmos mensagens na p√°gina de status do sistema?

Acho que seria bom acrescentar isso nessa milestone para podermos deixar avisado por ali durante momentos de instabilidade que podem ocorrer, por exemplo, na migra√ß√£o da regi√£o do BD.

Acho que √© uma boa oportunidade de usarmos a [Edge Config](https://vercel.com/docs/concepts/edge-network/edge-config) para criar essas mensagens sem depender do banco de dados, de servi√ßos externos e nem de um novo deploy.

>> Coment√°rio de gSarciotto:
Duvida, como saberemos se realmente havera uma melhora de performance, nos temos metricas sobre esses items?

>> Coment√°rio de filipedeschamps:
> O que acham de adicionar a possibilidade de mostrarmos mensagens na p√°gina de status do sistema?

Acho massa! A gente poderia fazer um endpoint "mock" que na verdade s√≥ bate no Middleware, busca esse valor e retorna no corpo, dado que agora √© poss√≠vel retornar `Responde Body` pelo Middleware:

https://github.com/filipedeschamps/tabnews.com.br/blob/31dbe19f0cfb4a6d9dcced25d23a9151d2b2cdd9/next.config.js#L3

Vou criar a issue ü§ù 

> Duvida, como saberemos se realmente havera uma melhora de performance, nos temos metricas sobre esses items?

√ìtima pergunta @gSarciotto! Geralmente n√≥s mensuramos com um **antes** e **depois**, veja dois exemplos:

Veja o item **3) Remo√ß√£o de m√∫ltiplas idas ao banco na consulta de `contents`**:
https://www.tabnews.com.br/filipedeschamps/novas-melhorias-mais-contexto-nas-notifacoes-por-email-e-outras-8-melhorias

Veja o item **2) P√°ginas abrindo ainda mais r√°pidas** (implementa√ß√£o monstra feita pelo @aprendendofelipe)
https://www.tabnews.com.br/filipedeschamps/novas-melhorias-rss-e-mais-7-melhorias

>> Coment√°rio de silvaezequias:
O #923 √© considerado uma melhoria para ser adicionado nessa Milestone?

>> Coment√°rio de filipedeschamps:
@ezequiaslopesdasilva com certeza! Na verdade qualquer melhoria pode entrar nesta Milestone ü§ù voc√™ chegou a ver o coment√°rio do @aprendendofelipe l√° no PR?

>> Coment√°rio de filipedeschamps:
Em paralelo, acabei de criar uma publica√ß√£o no TabNews anunciando este draft e um pouco da minha vis√£o sobre o futuro da plataforma: https://www.tabnews.com.br/filipedeschamps/milestone-6-performance-e-seguranca-draft

>> Coment√°rio de sudo-give-me-coffee:
Limitar uma publica√ß√£o a 1 upvote e 1 downvote por usu√°rio seria algo interessante a se fazer, √© uma seguran√ßa anti ataques
 
Considerando as fun√ß√µes de TabCoin x TabCash permitir multiplos up e down votes faz as TabCoins perderem a fun√ß√£o de modera√ß√£o passando a se comportar como avalia√ß√£o subjetiva de conte√∫do ao inv√©s objetiva e torna as TabCash invalidadas uma vez que n√£o mais refletem ao trabalho da pessoa em prol da comunidade mas em prol apenas do que ela fez em benef√≠cio pr√≥prio

>> Coment√°rio de filipedeschamps:
@sudo-give-me-coffee show, voc√™ poderia elaborar inclusive isso nessa issue? https://github.com/filipedeschamps/tabnews.com.br/issues/1166

>> Coment√°rio de brunofamiliar:
Nossa, li bastantes issues e minha mente t√° explodindo ü§Øü§Ø. Quanta coisa perdi, fa√ßo nem ideia como posso ajuda-los kk a barra subiu. Vi que tem muitas issues sem itera√ß√£o, como fica o andamentos destas issues?

>> Coment√°rio de aprendendofelipe:
> Vi que tem muitas issues sem itera√ß√£o, como fica o andamentos destas issues?

Provavelmente est√£o aguardando intera√ß√µes. üí™

Se s√£o assuntos que ainda precisam de mais discuss√£o e/ou falta alguma implementa√ß√£o, elas est√£o ficando abertas para facilitar para quem tenha algo a contribuir, pois, se forem fechadas, v√£o sendo criadas novas issues com o mesmo foco, mas que n√£o consideram as discuss√µes anteriores, e isso dificulta a evolu√ß√£o das solu√ß√µes.

Provavelmente algumas j√° podem ser fechadas, seja porque est√£o fora do radar, mas algumas porque o problema foi resolvido parcialmente. E nesses casos talvez seja melhor abrir novas issues com o problema atualizado, explicando apenas o que falta implementar. J√° em outras √© melhor manter todo o contexto existente at√© a solu√ß√£o mais completa ser implementada. üëç

>> Coment√°rio de brunofamiliar:
> 

Booa Felipe! S√≥ pra me situar, est√£o priorizando a atua√ß√£o em ordem na qual est√£o listadas as atividades nessa milestone, ou n√£o necessariamente?

>> Coment√°rio de aprendendofelipe:
N√£o necessariamente.

As maiores prioridades da milestone j√° foram conclu√≠das, e o que sobrar dessa lista deve ser transferido para a Milestone da Revenue Share

>> Coment√°rio de Rafatcb:
@aprendendofelipe acha que faz sentido encerrar esse issue e a Milestone 6, e organizar a Milestone 7 (#1490)? Precisa de ajuda com algo?

>> Coment√°rio de aprendendofelipe:
Tamb√©m estou com essa d√∫vida sobre organizar aqui ou na 7 tudo que foi feito recentemente. N√£o sei se o Filipe ir√° parar com os v√≠deos para encerramento/abertura das Milestones, mas, at√© pelos tipos de implementa√ß√µes que est√£o sendo realizadas, acredito que n√£o come√ßamos a Milestone 7.

>> Coment√°rio de Rafatcb:
> Tamb√©m estou com essa d√∫vida sobre organizar aqui ou na 7 tudo que foi feito recentemente. 

O que foi feito at√© agora podemos considerar da Milestone 6, j√° que a 7 n√£o foi oficialmente iniciada. Creio que mesmo o issue do FAQ, que foi citado em #1490, pode ser movido para esta lista. O mesmo racioc√≠nio vale para os outros issues resolvidos que foram citados l√°.

> N√£o sei se o Filipe ir√° parar com os v√≠deos para encerramento/abertura das Milestones

Eu j√° n√£o lembrava desses v√≠deos, mas vendo a [playlist](https://www.youtube.com/playlist?list=PLMdYygf53DP7VRIRKmkSdGuDf-6OXcj4H), a Milestone 6 n√£o teve uma live de inaugura√ß√£o.

>> Coment√°rio de filipedeschamps:
Fala turma! Acredito que o foco de produ√ß√£o de v√≠deos acabou ficando no curso e acho mais v√°lido ao inv√©s de uma live sobre a Milestone 7, lan√ßar um v√≠deo no canal.

Estava pensando aqui sobre qual melhor momento, fazer no in√≠cio da Milestone ou no final dela e talvez o momento ideal seja quando o recurso de Revenue Share estiver rodando para valer e da√≠ explicar o que foi feito, como foi feito e convidar a turma para testar. O que acham?

>> Coment√°rio de aprendendofelipe:
Realmente, se for um v√≠deo p√∫blico, √© melhor lan√ßar quando j√° estiver implementada pelo menos alguma vers√£o.

Ent√£o √© melhor fazermos o encerramento da 6 e abertura da 7 em publica√ß√µes no TabNews?

>> Coment√°rio de filipedeschamps:
> Ent√£o √© melhor fazermos o encerramento da 6 e abertura da 7 em publica√ß√µes no TabNews?

Total!! Inclusive posso compartilhar a publica√ß√£o nas minhas redes tamb√©m ü§ù

>> Coment√°rio de aprendendofelipe:
Publiquei o encerramento da Milestone 6:

https://www.tabnews.com.br/FelipeBarso/tabnews-encerramento-da-milestone-6

üéâüéâüéâ
</issue_1140_Milestone 6 - Performance e Seguran√ßa>

<issue_1141_Melhora na performance da pagina√ß√£o de conte√∫dos>
## Contexto

A pagina√ß√£o de conte√∫dos do TabNews utiliza a estrat√©gia de `offset`, onde √© uma estrat√©gia simples de se implementar, por√©m possui um tradeoff de performance que √© precisar percorrer por todos os itens do offset, mesmo que o limite de itens a ser devolvido seja `1`. E eu especulo que isso se agrava, pois para cada linha √© computado o `get_current_balance()`, o que para algumas p√°ginas, n√£o dava mais tempo de processar o retorno dentro de 60 segundos, retornando para o client um `504`.

## Execu√ß√£o

 - #823

>> Coment√°rio de gpoleszuk:
Prezado desenvolvedor.

Primeiro, pe√ßo desculpas pela falta de acentua√ß~ao.

Reporte:
Ao tentar atualizar um rascunho em um comentario, o servidor retornou HTTP 504 apos 60 segundos de espera. Repeti a tentativa algumas vezes pensando ser problema por aqui no navegador. Entao, para gerar evidencias para voces, repeti o processo novamente em 20241129T084200Z utilizando o `curl` com a requisi√ßao gerada pelo navegador. Eu acho que ha algo no conteudo, pois postar algo mais simples, foi rapidamente aceito pelo servidor. A postagem ja foi removida.

Caso seja de vosso interesse, posso enviar a requisi√ßao POST completa que foi enviada para o servidor. Por hora, deixo uma versao sem os cookies de secao nesta postagem temporaria https://pastebin.com/dbFGUd0w (password: bmKQBJPiqH). Expira em pouco menos de 24 horas.

>> Coment√°rio de aprendendofelipe:
@gpoleszuk, muito obrigado por reportar! üí™

O problema foi resolvido com o PR #1822 ü§ù
</issue_1141_Melhora na performance da pagina√ß√£o de conte√∫dos>

<issue_1142_Implementa timeout de 4 segundos no Upstash>
## Contexto e Execu√ß√£o

- #811
</issue_1142_Implementa timeout de 4 segundos no Upstash>

<issue_1143_Adiciona √≠ndices na query do `findChildrenTree` e `balance_operation`>
## Contexto

Esta implementa√ß√£o come√ßou com @lemuelroberto no PR #881 tentando otimizar o m√©todo `findChildrenTree` do model `content`. Junto deste esfor√ßo, eu fiz um outro PR que adicionava um √≠ndice no `balance_operation`.

## Execu√ß√£o

- #882
</issue_1143_Adiciona √≠ndices na query do `findChildrenTree` e `balance_operation`>

<issue_1144_Faz o n√∫mero de conex√µes do banco ficar vermelho quando acima de 70% das conex√µes m√°ximas>
## Contexto

Na [p√°gina de status](https://www.tabnews.com.br/status) do TabNews, a se√ß√£o **Banco de Dados** possui um "threshold" para decidir mostrar os valores com a cor verde (se est√° tudo normal), ou vermelha (se tem algo que precisa de aten√ß√£o). O problema √© que a propriedade `opened_connections` (que mostra a quantidade de conex√µes abertas ao banco) estava com um valor fixo, e ap√≥s o upgrade da inst√¢ncia que usamos e com o volume do lan√ßamento, o valor sempre estava em vermelho, mesmo quando n√£o estava com problema.

## Execu√ß√£o

Este valor precisa ser din√¢mico, at√© para acompanhar automaticamente aumentarmos ou diminuirmos o tamanho da inst√¢ncia.

- #894
</issue_1144_Faz o n√∫mero de conex√µes do banco ficar vermelho quando acima de 70% das conex√µes m√°ximas>

<issue_1145_Melhor performance no processo de `build` (manter conex√£o aberta no `pool`)>
## Contexto e Execu√ß√£o

- #896
</issue_1145_Melhor performance no processo de `build` (manter conex√£o aberta no `pool`)>

<issue_1146_Implementa Cloudflare e ajusta Firewall interno>
## Contexto

N√≥s perdemos a chance de implementa o Cloudflare antes do lan√ßamento, o que foi uma pena, pois antigamente colocar o Cloudflare na frente de uma aplica√ß√£o Next.js/Vercel causava alguns problemas (por isso decidimos n√£o colocar), mas recentemente a integra√ß√£o foi ajustada pelo lado da Cloudflare e tudo est√° rodando 100%.

De qualquer forma, a Vercel aceita apenas `IPv4` e o Cloudflare aceita (tamb√©m) `IPv6`, fora mandar o IP real do cliente por um cabe√ßalho chamado `cf-connecting-ip`. Tudo isto faz nosso backend se confundir, ent√£o uma s√©rie de PRs foram feitos para domar a situa√ß√£o.

## Execu√ß√£o

- #976
- #985
- #988
- #1001
</issue_1146_Implementa Cloudflare e ajusta Firewall interno>

<issue_1147_Para de retornar o `id` no endpoint `/api/v1/recovery`>
## Contexto

- [Postmortem: endpoint "/api/v1/recovery" retornava token sens√≠vel que conseguia burlar o fluxo de altera√ß√£o de senha](https://www.tabnews.com.br/filipedeschamps/postmortem-endpoint-api-v1-recovery-retornava-token-sensivel-que-conseguia-burlar-o-fluxo-de-alteracao-de-senha)

Reportado por @FabricioLR

## Execu√ß√£o

- #1022
</issue_1147_Para de retornar o `id` no endpoint `/api/v1/recovery`>

<issue_1148_Adiciona `stale-while-revalidate` em `GET` `/api/v1/contents`>
## Contexto

Este √© o primeiro endpoint de conte√∫dos que implementamos o cache de `stale-while-revalidate`, sendo que devemos implementar para todos os endpoints de conte√∫do.

## Execu√ß√£o

- #1060
</issue_1148_Adiciona `stale-while-revalidate` em `GET` `/api/v1/contents`>

<issue_1149_Melhora os logs de erro>
## Logs

Com a vinda da Cloudflare, o servi√ßo de logs que usamos chamado Axiom mostra os IPs do Proxy da Cloudflare, e n√£o o IP real do cliente que vem no cabe√ßalho `cf-connecting-ip`. Com isso, √© preciso implementar logs customizados que registram o IP real e tamb√©m montar uma Dashboard que automaticamente organiza/agrupa os dados pelo IP real.

## Execu√ß√£o

- #1064
- #1067
</issue_1149_Melhora os logs de erro>

<issue_1150_Recusa conex√µes que n√£o vierem de `www.tabnews.com.br` em Produ√ß√£o>
## Contexo

A Vercel cria uma nova URL para cada commit/deploy que √© acess√≠vel publicamente, mas agora para o ambiente de Produ√ß√£o n√≥s aceitamos o acesso apenas de requests que vierem do host `www.tabnews.com.br`.

## Execu√ß√£o

- #1070
- #1178
- #1184
- #1185

>> Coment√°rio de filipedeschamps:
Agradecimento especial ao @cybernerd007 por ficar cavucando esse assunto e notar que era poss√≠vel burlar a primeira implementa√ß√£o (a que controlava pelo`host`) e ao @aprendendofelipe por nos dar esse fix como presente de natal ü§ù
</issue_1150_Recusa conex√µes que n√£o vierem de `www.tabnews.com.br` em Produ√ß√£o>

<issue_1151_Impede o redirecionamento para URLs externas no ato de Login>
## Contexto

Caso o usu√°rio tente fazer uma a√ß√£o que precise de Login no TabNews, ele √© redirecionado para a tela de login, com um **redirect** configurado na URL: `/login?redirect=xxxxxxx`. Dado a isso, o pesquisador de seguran√ßa @cybernerd007 descobriu que era poss√≠vel colocar qualquer URL ali, sendo poss√≠vel redirecionar o usu√°rio para fora do site de forma n√£o esperada.

## Execu√ß√£o

- #1081
</issue_1151_Impede o redirecionamento para URLs externas no ato de Login>

<issue_1152_Bug - Cadastro e recupera√ß√£o de senha>
Bom dia, fui tentar recuperar minha senha e deu o seguinte erro:
![image](https://user-images.githubusercontent.com/21311863/208410470-b7a71f0b-c61e-4c2f-a9b9-38ad3d2d9620.png)

Fui tentar cadastrar e o sistema n√£o deixo pois disse que o usu√°rio j√° existe:
![image](https://user-images.githubusercontent.com/21311863/208410725-eda2d085-52bb-47a6-b28e-dbd96c3a6bea.png)

Teria como deletar o usuario do banco para eu me cadastrar novamente? Obrigado

>> Coment√°rio de danielschmitz:
primeiro username tem o L

o outro n√£o

>> Coment√°rio de aprendendofelipe:
@gabrielclimb n√£o existe usu√°rio `gabrielclimb` no TabNews, por√©m existe o usu√°rio `gabrieclimb`.

Sugiro que recupere sua senha utilizando o email e, se for o caso, ap√≥s se logar, altere o nome do usu√°rio pela p√°gina ["Editar Perfil"](https://www.tabnews.com.br/perfil).

Estou fechando a Issue. Ok? ü§ù
</issue_1152_Bug - Cadastro e recupera√ß√£o de senha>

<issue_1153_Atualizar Termos de Uso (e colocar link no cadastro)>
## Contexto

Eu considero que o nosso atual [Termos e Uso](https://www.tabnews.com.br/termos-de-uso) est√° est√°vel e cobriu grande parte dos acontecimentos, mas em alguns pontos sinto que poder√≠amos ser mais exatos e refor√ßar ainda mais o que estamos tentando proteger aqui.

Dado a isso, ao longo das intera√ß√µes que tive com alguns conte√∫dos, fui anotando numa lista solta o que senti falta e cheguei nisto:

1. **Proibir conte√∫dos automatizados:** este ponto deveria ser mais discutido, pois eu pessoalmente n√£o tenho problema com conte√∫dos automatizados desde que fique claro na publica√ß√£o que foi gerado por um rob√¥. Agora, uma outra preocupa√ß√£o de liberar isto √© que facilmente o TabNews pode ser inundado de publica√ß√µes, perdendo rapidamente sua ess√™ncia. Ent√£o talvez de in√≠cio devemos proibir a cria√ß√£o de conte√∫dos de forma automatizada para dar tempo de fazer o sistema receber de uma forma apropriada esses conte√∫dos.
1. **Deixar mais claro que o TabNews n√£o √© um lugar para brincar:** Eu n√£o sei como colocar uma linha divis√≥ria que deixe isso claro, mas devemos ao m√°ximo proteger para que aqui tenha conte√∫dos para quem trabalha ou quer trabalhar¬†com programa√ß√£o¬†ou tecnologia. Eu sei que nem tudo vai diretamente ajudar no trabalho das pessoas, e uma publica√ß√£o com alguma curiosidade ou uma demonstra√ß√£o t√©cnica n√£o ajuda diretamente, mas √© bem vinda, pois pode ajudar na criatividade. Agora um meme eu acho que j√° passa um pouco dessa linha. Por√©m n√£o sei se dever√≠amos colocar isso nos termos, ou deixar apenas a comunidade avaliar como quiser.
1. **Conte√∫do raso:** continuando com o t√≥pico anterior, deixar mais claro que conte√∫dos rasos poder√£o ser removidos, incluindo sem aviso pr√©vio, ou at√© pelo pr√≥prio Firewall. Al√©m disto, em alguns momentos eu removi o conte√∫do da pessoa para ela parar de ser penalizada pela comunidade, onde algumas aceitaram, mas algumas n√£o (ou ficaram confusas de in√≠cio). √â bom colocar que isso pode acontecer.
1. **Spam ou migra√ß√£o de conte√∫do:** isto j√° vi algumas pessoas fazendo v√°rios posts um atr√°s do outro migrando seus conte√∫dos e, por mais honroso que seja para uma plataforma receber os conte√∫dos de um autor, fazer isso em massa ir√° ativar o Firewall e despublicar todos, como j√° aconteceu. Infelizmente n√£o sei como fazer hoje para diferenciar uma migra√ß√£o de conte√∫do de spam, ent√£o pelo menos √© bom deixar claro que existe este mecanismo de prote√ß√£o.
1. **Proibir de pedir dados sens√≠veis:** n√£o sei se √© necess√°rio adicionar isso aos Termos, mas j√° vi pessoas pedindo dados sens√≠veis como email e telefone, e pessoas fornecendo estes dados. Sugiro n√£o abrirmos margem para que isto aconte√ßa, nem quando √© feito de forma genu√≠na entre as duas partes, pois um terceiro pode coletar estes dados.
1. **Proibir testes em produ√ß√£o:** N√£o temos a melhor forma de hoje a pessoa descobrir os endpoits de homologa√ß√£o, mas √© muito ruim n√£o saber diferenciar pelos alertas quem est√° testando uma integra√ß√£o (e criando v√°rios cadastros malucos), de quem est√° bagun√ßando a base. Ent√£o como j√° temos um item sobre reportar falhas, acho bom colocarmos um sobre evitar testes num ambiente que todos usam para valer, incluindo testes de conte√∫do.
1. **Deixar expl√≠cito links de afiliado**: caso seja adicionado algum link afiliado em qualquer publica√ß√£o, voc√™ dever√° deixar isto expl√≠cito antes do link aparecer, ou `inline` com o link, por exemplo adicionado `(Link Afiliado)` no texto do link.

## Execu√ß√£o

### Primeiro passo

Primeira coisa que devemos fazer, independente da atualiza√ß√£o dos termos, √© colocar uma indica√ß√£o que ele existe na p√°gina de cadastro. Ent√£o logo acima do bot√£o de confirmar o cadastro, devemos colocar o seguinte:

> Ao criar um cadastro, voc√™ sinaliza estar de acordo com os [Termos de Uso](https://www.tabnews.com.br/termos-de-uso).

Me inspirei no [Mailgun](https://signup.mailgun.com/new/signup), que inclusive coloca este texto abaixo do bot√£o:

<img width="502" alt="image" src="https://user-images.githubusercontent.com/4248081/208537784-5bceadf3-33f6-47c2-bcac-c01fda080de6.png">

### Segundo passo

O segundo passo √© de fato atualizar os termos e destacar um resumo das altera√ß√µes na se√ß√£o "Hist√≥rico de altera√ß√µes", linkando para o PR que aplicar as altera√ß√µes.

>> Coment√°rio de silvaezequias:
Em quest√£o dos termos, eu queria sugerir: adicionar um ID a todo T√≠tulo ou Subt√≠tulo que tem nos termos pra poder criar um link de redirecionamento para cada t√≥pico, exemplo:

```html
[...]

<h1 id='usuario'>Usu√°rio</h1>
1. O usu√°rio do TabNews √© uma pessoa brutalmente exata...
[...]

<h1 id='direitos-autorais-e-propriedade-intelectual'>Direitos autorais e propriedade intelectual</h1>
1. O usu√°rio possui os direitos autorais e se responsabiliza pelos conte√∫dos...
```
```
https://www.tabnews.com.br/termos-de-uso#usuario
https://www.tabnews.com.br/termos-de-uso#direitos-autorais-e-propriedade-intelectual
```

Isso facilita na hora de frisar um t√≥pico dos termos caso um usu√°rio n√£o esteja cumprindo. 

---

E continuando nessa ideia, se poss√≠vel, adicionar um bot√£o pra identificar cada "redirecionamento" desses, como exemplo:
 
![image](https://user-images.githubusercontent.com/63757378/208542758-6cc45876-88d6-40d7-9a85-ff298a2a7a6a.png)

Um bot√£o que apare√ßa quando passar o mouse em cima, ou quando clicar...

>> Coment√°rio de Rafatcb:
> 1. **Proibir conte√∫dos automatizados**

Acho que poder√≠amos proibir conte√∫dos gerados pelo ChatGPT. J√° vi algumas pessoas publicando um texto gerado pela IA sem colocar fonte ou dizer que de fato foi gerado pela IA. O ChatGPT n√£o √© perfeito e pode gerar "fatos falsos". No Stack Overflow tem uma [discuss√£o](https://meta.stackoverflow.com/questions/421831/temporary-policy-chatgpt-is-banned) sobre esse assunto e uma p√°gina [explicando o motivo do uso do ChatGPT ter sido banido](https://stackoverflow.com/help/gpt-policy), para quem quiser ver mais do impacto numa comunidade maior. Como refer√™ncia, [isso j√° n√£o √© permitido no Hacker News](https://news.ycombinator.com/item?id=33945628)

> 3. **Conte√∫do raso:** continuando com o t√≥pico anterior, deixar mais claro que conte√∫dos rasos poder√£o ser removidos, incluindo sem aviso pr√©vio, ou at√© pelo pr√≥prio Firewall.

Acho esse ponto √≥timo, d√° um espa√ßo maior para a sugest√£o https://github.com/filipedeschamps/tabnews.com.br/issues/1108 ser implementada.

----

Sobre os demais pontos, parecem bons para mim.

>> Coment√°rio de Rafatcb:
Acabei de ver uma publica√ß√£o pedindo recomenda√ß√£o de um site para download de conte√∫do pirata. Obviamente o TabNews n√£o permite isso, mas n√£o encontrei algo bem claro dizendo isso nos Termos de Uso. Acho que podemos adicionar esse ponto tamb√©m.

>> Coment√°rio de SpaceFox1:
Sobre o t√≥pico 1, talvez fosse interessante usar uma abordagem similar ao _discord_, que diferencia _clients_ leg√≠timos de bots nos endpoints, e coloca na frente do nome do usu√°rio uma tag indicando que aquele usu√°rio √© um bot de fato.

>> Coment√°rio de Jeiel0rbit:
###  Sobre n√£o haver **pol√≠tica de privacidade** no TabNews. Fiz um exemplo de como ficaria aba.

![tab1](https://user-images.githubusercontent.com/72875404/224067491-29e839f5-01c5-469c-beea-f58ca9dcd6e3.png)

![tab2](https://user-images.githubusercontent.com/72875404/224067575-37af84fc-6185-4a11-ba28-a73dcc9e2a0c.png)

O que voc√™s acharam? Lembrando que √© apenas um modelo de como ficaria na realidade. Pol√≠tica de privacidade √© importante para esclarecer para os usu√°rios, de como s√£o tratados os dados de forma transparente. Dizer que "n√£o coletamos nada", n√£o √© v√°lido.

>> Coment√°rio de Rafatcb:
Mais um detalhe: talvez proibir publica√ß√µes em ingl√™s (mas permitir cita√ß√µes e fontes)?

Motivo: Vi um usu√°rio agora fazendo publica√ß√µes em ingl√™s e portugu√™s.
![Publica√ß√µes em ingl√™s: [EN] Automating NetSuite Deployments, [EN] Working with TypeScript in NetSuite. Em portugu√™s: [PT] Automatizando publica√ß√µes em NetSuite](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/546080b9-250c-4973-ba1c-cb5603364bfa)

O Filipe j√° falou [em outra ocasi√£o](https://www.tabnews.com.br/filipedeschamps/4111cd97-cb56-4101-bc44-b7b95ae51a6f) que o foco √© apenas pessoas que falam em portugu√™s, e pediu para o autor traduzir a publica√ß√£o.

>> Coment√°rio de Rafatcb:
Com a possibilidade do usu√°rio ter uma √°rea pr√≥pria no perfil dele com a "Descri√ß√£o", surgem alguns problemas que podem ser abordados nos Termos de Uso:

O que podemos ou n√£o ter na descri√ß√£o do usu√°rio? Tudo bem eu colocar um link para o site de uma empresa? E falar mal de algum pol√≠tico? E colocar uma imagem (banner) de uma propaganda para algo que vendo, sou afiliado, ou algum outro tipo de campanha?

>> Coment√°rio de Rafatcb:
Estava refletindo sobre os pontos citados para melhorar os Termos de Uso. Vou citar aqui todos os pontos sobre as mudan√ßas comentadas.

> 1. Proibir conte√∫dos automatizados

Continuamos com essa ideia? Hoje √© muito raro ver um conte√∫do automatizado, o √∫nico que me v√™m √† mente √© uma publica√ß√£o que serve como um "ranking semanal".

Apesar disso, ainda acho que podemos mencionar que conte√∫do gerado por intelig√™ncia artificial n√£o √© permitido. Em alguns casos √© dif√≠cil ter certeza se o texto √© gerado por intelig√™ncia artificial, mas acredito que podemos deixar isso nos Termos de Uso de forma a tentar minimizar esse tipo de situa√ß√£o.

> 2. Deixar mais claro que o TabNews n√£o √© um lugar para brincar

J√° houve v√°rias reclama√ß√µes sobre isso antes do FAQ surgir, e o FAQ existe h√° pouco tempo para dizermos que ele solucionou os problemas.

Acho que podemos melhorar o texto dos Termos de Uso para restringir melhor o tipo de conte√∫do aceito. Talvez n√£o haja necessidade de citar diretamente "memes s√£o proibidos", n√£o tenho certeza.

N√£o sei se voc√™s acham uma boa ideia citar o FAQ nos Termos de Uso para orientar o usu√°rio (perguntas [Que tipo de conte√∫do eu posso publicar no TabNews?](https://www.tabnews.com.br/faq#conteudo-tabnews) e [Que tipo de assunto √© aceito no TabNews?](https://www.tabnews.com.br/faq#assunto-tabnews)).

> 3. Conte√∫do raso

Continuo com a minha opini√£o de antes, concordo.

> 4. Spam ou migra√ß√£o de conte√∫do

N√£o sei como poder√≠amos citar isso nos Termos de Uso, mas acho que seria um pouco parecido com o ponto anterior. Podemos dizer que os conte√∫dos publicados podem ser removidos em caso de suspeita de spam.

Uma orienta√ß√£o para migra√ß√£o de conte√∫do faz mais sentido de ser adicionada ao FAQ.

> 5. Proibir de pedir dados sens√≠veis

Ser√° que realmente devemos proibir isso? Onde ser√° tra√ßada a linha do que √© permitido e o que n√£o √©, dentre as poss√≠veis formas de comunica√ß√£o? (Discord, alguma rede social, telefone, e-mail etc.). E se a pessoa escrever o contato em outro site e dizer "entra aqui para ver meus meios de contato", seria permitido? E se deixar alguma dessas formas de contato no perfil?

O Hacker News permite isso, e tem os seguintes t√≥picos na p√°gina [Legal](https://www.ycombinator.com/legal/):

> You agree to not use the Site to:
> * ...
> * solicit personal information from anyone under the age of 18;
> * harvest or collect email addresses or other contact information of other users from the Site by electronic or other means for the purposes of sending unsolicited emails or other unsolicited communications;

Ser√° que dizermos algo nessa linha j√° n√£o seria o suficiente?

Eu entendo tanto o lado de permitir para possibilitar a liberdade dos usu√°rios em criar novos la√ßos, contratar servi√ßos ou o que quer que seja, quanto o lado de n√£o permitir por quest√µes de seguran√ßa do pr√≥prio usu√°rio que pode n√£o estar ciente dos riscos. Acho que nada impede de proibirmos e acompanharmos a rea√ß√£o da comunidade, mas nesse caso √© importante responder as perguntas do meu primeiro par√°grafo para deixar a regra clara.

> 6. Proibir testes em produ√ß√£o

V√°lido, e temos orienta√ß√µes no FAQ sobre isso.

> 7. Deixar expl√≠cito links de afiliado

V√°lido. Eu ainda adicionaria que, n√£o apenas links de afiliado, mas tamb√©m quando voc√™ est√° falando de um projeto que possui rela√ß√£o direta. Por exemplo, vamos supor que eu trabalhe para a Vercel, e quando algu√©m pede recomenda√ß√µes de hospedagem, eu falo sobre a Vercel. √â importante dizer qual √© a minha rela√ß√£o com a empresa para que a pessoa entenda que possivelmente existe um vi√©s mais forte na minha recomenda√ß√£o.

> 8. Permitir apenas publica√ß√µes e coment√°rios em portugu√™s

Esse ponto eu adicionei em um coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/1153#issuecomment-1645678565), coloquei a numera√ß√£o para facilitar a resposta.

√â bem chato ter um conte√∫do em ingl√™s que, ou recebe votos negativos, ou n√£o recebe aten√ß√£o, e n√£o poder apag√°-lo. √Äs vezes √© algum gringo que veio fazer uma pergunta, as pessoas orientam a usar o portugu√™s, mas ele simplesmente ignora e n√£o usa mais a plataforma.

O ponto 3 pode ajudar nessa situa√ß√£o, mas significaria que precisar√≠amos aguardar a publica√ß√£o receber uma certa quantidade de votos negativos at√© poder apagar.

> 9. Conte√∫do permitido no perfil e em publica√ß√µes

Mencionei no meu √∫ltimo coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/1153#issuecomment-1891147308). O conte√∫do do perfil deve aceitar mais coisas do que numa publica√ß√£o? Por exemplo, n√£o preciso falar apenas de tecnologia nele? Mas como podemos tra√ßar uma linha do que √© proibido e o que n√£o √©? Pol√≠tica, religi√£o, propaganda, etc.

Al√©m disso, acredito que precisamos de uma "proibi√ß√£o geral" que hoje √© feita com base no bom senso. Como citei em outro coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/1153#issuecomment-1452639134), n√£o √© permitido publicar conte√∫dos piratas, conte√∫do +18 ou outras coisas que eu n√£o consigo especificar exatamente. Alguns desses assuntos podem ser sobre tecnologia, mas "com base no bom senso" n√£o permitimos.

---

Edit: Imagino que fa√ßa sentido, junto da altera√ß√£o dos Termos de Uso, j√° implementarmos algum mecanismo para salvar a √∫ltima data que o usu√°rio aceitou os Termos de  Uso e, caso tenha uma altera√ß√£o nos Termos que n√£o foi aceita (data de altera√ß√£o > data de aceite), orientar o usu√°rio a ler e aceitar novamente antes de permitir usar o site.

Talvez o ideal n√£o seja nem basear por datas, j√° que um mesmo dia pode ter mais de uma altera√ß√£o (improv√°vel) ou uma pessoa pode aceitar os termos e, no mesmo dia, ter uma atualiza√ß√£o para novos termos.
</issue_1153_Atualizar Termos de Uso (e colocar link no cadastro)>

<issue_1154_Catch de erro do SWR>
## Contexto

Hoje tanto as p√°ginas de conte√∫do, quanto o `ContentList` e outros lugares, n√£o lidam corretamente quando uma request retorna com erro por dentro do `SWR`, gerando um erro irrecuper√°vel no client-side.

## Execu√ß√£o

Identificar todos os pontos da aplica√ß√£o que usam o `SWR`, por exemplo ao procurar por arquivos que contenham `useSWR` e caso o retorno da request contenha algum erro, sugiro apenas ignorar.

O `SWR` est√° sendo usado primariamente para revalidar o cache de um est√°tico, ent√£o n√£o deveria ter um grande impacto apenas ignorar o erro. Ou se quisermos ser mais arrojado, em casos que o `statusCode` de um response for `404` e a pessoa est√° numa p√°gina de conte√∫do, redirecionar ela para a p√°gina https://www.tabnews.com.br/404

>> Coment√°rio de Demnokkoyen:
Tenho interesse em trabalhar nessa issue e me pergunto se seria interessante extrair todas as requisi√ß√µes realizadas com o SWR em uma camada de servi√ßos na arquitetura, possibilitando melhor manuten√ß√£o quando for necess√°rio realizar algum tipo de tratamento "global" direto na utiliza√ß√£o da API (como √© o caso aqui). O que acham? Posso seguir esse caminho e realizar essa refatora√ß√£o?

>> Coment√°rio de aprendendofelipe:
A biblioteca swr lida bem com erros de requisi√ß√£o. Ent√£o acredito que a motiva√ß√£o dessa issue s√£o os erros que ocorrem quando a interface quebra ao receber novos dados, dependendo da mudan√ßa que ocorre com rela√ß√£o aos dados anteriores, ou seja, o problema √© quando a requisi√ß√£o √© sucesso, mas retorna dados diferentes e a interface n√£o est√° preparada para lidar com a mudan√ßa recebida, indo para um estado inconsistente.

Parte do que quebrava a interface (ou tudo) foi corrigido a um tempo atr√°s quando o componente `PublishedSince` parou de dar erros com datas inv√°lidas, caso que ocorria com conte√∫dos exclu√≠dos. N√£o sei se ainda existe alguma atualiza√ß√£o de dados quebrando a interface. Mas aparentemente n√£o.

Existem outras situa√ß√µes de atualiza√ß√£o de dados que deixam a interface inconsistente e que s√£o menos graves por n√£o apresentar um erro irrecuper√°vel. A maioria j√° foi corrigida anteriormente, mas ainda permanecem algumas relacionadas aos estados da p√°gina de conte√∫dos (issue #1376). Essas inconsist√™ncias s√≥ n√£o est√£o t√£o aparentes porque o `revalidateOnFocus` est√° desativado atualmente.

Independentemente de ainda existir alguma quest√£o que precisaria ser corrigida com o fetcher do swr, se o PR #1374 for aceito, isso n√£o ser√° mais problema, j√° que a partir da√≠ a biblioteca s√≥ ser√° utilizada para obter parte dos dados da p√°gina de status.

Os problemas espec√≠ficos da p√°gina de conte√∫dos podem ser tratados na issue #1376, j√° que n√£o s√£o causados pelo swr.
</issue_1154_Catch de erro do SWR>

<issue_1155_Publica√ß√£o ao ser removida, devolve TabCoins de quem negativou>
## Contexto

Dado a alguns relatos no passado, as pessoas n√£o gostam muito de usar suas TabCoins para negativar uma publica√ß√£o, onde apesar da negativa√ß√£o e positiva√ß√£o gerarem o mesmo n√∫mero de TabCash, eu entendo esta sensa√ß√£o. Mas como esta curadoria √© algo importante principalmente para identificar conte√∫dos que est√£o seriamente quebrando os Termos de Uso, uma das sugest√µes que surgiu foi de, ao remover um conte√∫do, todas as pessoas que deram down vote acabem recebendo estas TabCoins de volta.

Isto n√£o ir√° fazer diferen√ßa para conte√∫dos que est√£o sendo levemente negativados e n√£o ser√£o deletados, mas ir√° fazer muita diferen√ßa quando um conte√∫do for seriamente negativado e possui uma alt√≠ssima probabilidade de ser deletado. Ent√£o acho justo esta mec√¢nica e vai ser algo saud√°vel para a economia, pois a pessoa corretamente sinalizou algo que deveria ser removido.

## Execu√ß√£o

Eu imagino que iremos precisar adicionar uma condicional a mais na fun√ß√£o `creditOrDebitTabCoins()` do model `content`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/content.js#L531-L558

Em paralelo, o model `balance` possui um m√©todo para desfazer uma opera√ß√£o (ela √© usada no ato de Nuke):

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/balance.js#L118-L131

Mas o model n√£o possui hoje uma forma de selecionar as opera√ß√µes negativas contra um certo conte√∫do. Mas d√° para fazer isso s√≥ analisando a tabela `balance_operations`, identificando as linhas com `amount` negativo de um `recipient_id` (que √© o id do conte√∫do).

>> Coment√°rio de eletroswing:
Neste caso, os tabcash ganho tamb√©m seriam removidos? e ao devolver, devolveria diretamente o valor debitadp no post( 1 tabcoin) ou devolveriamos o valor debitado do us√∫ario ( 2 tabcoins)?

>> Coment√°rio de aprendendofelipe:
Bom ponto @eletroswing!

Acho que podemos manter o tabcash ganho. E para isso n√£o virar uma maneira de criar tabcashs do nada, podemos devolver apenas 1 tabcoin para quem qualificou negativamente a publica√ß√£o deletada.

Resumindo, quem qualificar uma publica√ß√£o negativamente vai ganhar um desconto no tabcash (vai custar s√≥ 1 e n√£o 2 tabcoins) caso essa publica√ß√£o venha a ser deletada pelo autor que percebeu que publicou algo n√£o relevante.

>> Coment√°rio de eletroswing:
@aprendendofelipe  estou testando e cheguei numa poss√≠vel query que j√° pega todos os valores negativos de todos conteudos deletados (por usuario) e que pega de um conteudo especifico, se puder dar uma olhada pra comentar, aqui esta: `
SELECT 
  DISTINCT base.originator_id, 
  base.recipient_id, 
  (SELECT 
   	COALESCE(sum(o.amount), 0) 
   	FROM balance_operations as o 
   	WHERE o.balance_type = 'content:tabcoin' 
   	AND o.amount < 0 
    AND o.originator_id=base.originator_id) as Credit 
  FROM balance_operations as base 
  WHERE base.balance_type = 'content:tabcoin'
  AND base.amount < 0 
  AND base.recipient_id = $content_id 
  --aqui definimos o id do conteudo, caso eliminado a clausula AND acima,
  --todas as transa√ß√µes negativas de todos os posts deletados ser√£o retornadas com o valor credit que
  --deve ser creditado na conta do us√∫ario, podendo ser inserido por meio de um include
  AND (
    	SELECT status
    	FROM contents
   		WHERE id=base.recipient_id
    ) = 'deleted'
`

>> Coment√°rio de aprendendofelipe:
@eletroswing desconfio que as queries necess√°rias j√° est√£o prontas e s√≥ precisaria definir direito a regra de neg√≥cio para inserir no c√≥digo.

>> Coment√°rio de eletroswing:
@aprendendofelipe  
> Em paralelo, o model balance possui um m√©todo para desfazer uma opera√ß√£o (ela √© usada no ato de Nuke):

A fun√ß√£o undo(se n√£o me engane se refere a esta originalmente) desfaz uma opera√ß√£o por vez baseado no id da opera√ß√£o, acredito que desfazer todas as opera√ß√µes de down_vote seria um pouco pesado usando ela dependendo do tamanho do conte√∫do, uma vez que pode ser resolvida numa √∫nica query direta do banco de dados, podendo ser chamada ao deletar o conte√∫do e ja desfazendo para todos os usu√°rios de uma vez. Mas em geral, n√£o tenho certeza o que pesaria mais, a query √∫nica ou chamar a query de 'undo' para cada opera√ß√£o

>> Coment√°rio de eletroswing:
@aprendendofelipe , ao registrar o evento gerador, reparei que todos os o eventos s√£o do tipo "content", mas ao retornar o tabcoin, usamos o evento do tipo "user", ent√£o, como deveria ser o registro do evento gerador?

>> Coment√°rio de aprendendofelipe:
Oi @eletroswing, os eventos de exclus√£o de conte√∫dos s√£o do tipo `update:content:text_child` ou `update:content:text_root`. Mas n√£o precisa mudar nada na l√≥gica de cria√ß√£o do evento, que √© criado aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/22a6d3aca8e3c6ec24ffa7a24f5a713c48e1a5f7/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/index.public.js#L143

S√≥ vai ser preciso usar o ID desse evento, obtendo ele de `options.eventId`, e salvar como `originatorId` em todos os registros que ser√£o criados relacionados ao mesmo ato de exclus√£o de um conte√∫do.

Da√≠ a fun√ß√£o que cria o balan√ßo tamb√©m j√° est√° pronta. √â essa aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/balance.js#L23

O que ainda n√£o existe √© a consulta que retorna quais s√£o os Ids de usu√°rios que votaram negativamente no conte√∫do que est√° sendo exclu√≠do.

Da√≠ vai ser inserido um novo fluxo ali onde o Filipe citou:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/content.js#L531-L558

Acho que esse fluxo pode iniciar dentro deste `else`:

```js
    } else {
      amountToDebit = userDefaultEarnings;
    }
```

Assim s√≥ devolve os TabCoins se o conte√∫do estiver zerado ou negativado. Nesse fluxo ser√° realizada a consulta dos Ids, e ser√£o criados os novos registros na tabela `balance_operations`.

Fazer tudo isso em uma s√≥ consulta ao banco seria muito mais perform√°tico, mas muito mais dif√≠cil de fazer manuten√ß√£o e ajustes, ent√£o seria otimiza√ß√£o prematura.

Melhor primeiro fazer funcionar de forma simples, e depois otimizar. üëç

>> Coment√°rio de aprendendofelipe:
> Isto n√£o ir√° fazer diferen√ßa para conte√∫dos que est√£o sendo levemente negativados e n√£o ser√£o deletados, mas ir√° fazer muita diferen√ßa quando um conte√∫do for seriamente negativado e possui uma alt√≠ssima probabilidade de ser deletado. Ent√£o acho justo esta mec√¢nica e vai ser algo saud√°vel para a economia, pois a pessoa corretamente sinalizou algo que deveria ser removido.

Refletindo melhor eu chego na conclus√£o de que quando a pessoa vota positivamente em algo que realmente deveria ser destacado como relevante √© a mesma situa√ß√£o. Ent√£o a retribui√ß√£o deve ser a mesma, como j√° √©.

E se realmente existe algo psicol√≥gico que fa√ßa a quantidade de votos positivos ser maior do que negativos, ent√£o precisamos lidar com isso:
* De in√≠cio precisamos considerar esse desequil√≠brio, ou seja, o sistema precisa entender que um conte√∫do tem grandes chances de ser pouco relevante (ou neutro) se n√£o tiver recebido votos e pior ainda se tiver votos negativos. Algo que tamb√©m j√° √© o que ocorre.
* Em paralelo devemos procurar esclarecer melhor aos usu√°rios, ao menos os que procuram por esclarecimentos, para que n√£o se propaguem ideias como as de que algu√©m deveria economizar TabCoins ou de que se "perde" TabCoins ao qualificar um conte√∫do. Entendo que alguns podem estar usando a palavra "perder" no sentido de "consumir", mas isso pode gerar um entendimento completamente equivocado em quem n√£o se aprofunda na economia do sistema.
* Tamb√©m devemos considerar que ao atingirmos o objetivo de que s√≥ teremos conte√∫dos de qualidade, a quantidade de votos positivos √© esperada ser muito maior do que de votos negativos.

Por isso eu reconsidero minha resposta abaixo:

> > Neste caso, os tabcash ganho tamb√©m seriam removidos? e ao devolver, devolveria diretamente o valor debitadp no post( 1 tabcoin) ou devolveriamos o valor debitado do us√∫ario ( 2 tabcoins)?
> 
> Acho que podemos manter o tabcash ganho. E para isso n√£o virar uma maneira de criar tabcashs do nada, podemos devolver apenas 1 tabcoin para quem qualificou negativamente a publica√ß√£o deletada.

N√£o podemos criar um incentivo maior para quem vota negativamente do que positivamente, pois isso ser√° aproveitado por quem n√£o quiser qualificar honestamente os conte√∫dos, j√° que se ele s√≥ estiver interessado em converter seus TabCoins em TabCash, ser√° muito mais vantajoso sair distribuindo votos negativos para quaisquer conte√∫dos.

Ent√£o n√£o s√≥ retiro a minha ideia de dar um "desconto" no valor do TabCash para quem negativou, mas tamb√©m pe√ßo que pensem um pouco melhor se ao aplicarmos essa regra de devolver os TabCoins n√£o estamos refor√ßando a ideia errada de que votar positivamente ou negativamente traz beneficios diferentes, quando n√£o deveria trazer e deveria ser algo totalmente baseado na avalia√ß√£o da relev√¢ncia do conte√∫do.

>> Coment√°rio de aprendendofelipe:
Vou encerrar esse issue como n√£o planejada, pois ela parte da premissa de que as pessoas n√£o gostam muito de usar suas TabCoins para negativar uma publica√ß√£o, mas olhei os √∫ltimos 100 dias e temos 1 voto negativo para cada 4 positivos.

Ent√£o o que √© proposto colocaria a economia em risco de colapsar, j√° que poderia aumentar os votos negativos ao ponto de frear a gera√ß√£o de TabCoins e inviabilizar o sistema de qualifica√ß√µes.

Estou fechando, mas qualquer coisa abrimos novamente. ü§ù
</issue_1155_Publica√ß√£o ao ser removida, devolve TabCoins de quem negativou>

<issue_1156_√çndices no Banco de Dados>
## Contexto

Antes do lan√ßamento, se eu n√£o me engano o TabNews **n√£o tinha √≠ndices** voltados a **performance** (ele tinha apenas voltado para o `uniqueness` de um conte√∫do), e foi muito interessante ver o comportamento disto em produ√ß√£o üòÖ O gr√°fico abaixo √© o `load` do Postgres no dia do lan√ßamento:

![image](https://user-images.githubusercontent.com/4248081/203327291-51918739-2c6d-4b5f-8294-de68c8e7dc21.png)

No dia seguinte, o problema de processamento estava acontecendo de novo, e ent√£o eu apliquei em produ√ß√£o a segunda parte [desse PR](https://github.com/filipedeschamps/tabnews.com.br/pull/882) que trazia √≠ndice para o `balance_operation`:

![image](https://user-images.githubusercontent.com/4248081/208543209-96da2691-0b10-41ea-8e82-48e3660873ac.png)

O que fez o `load` do gr√°fico li de cima voltar a ficar saud√°vel, literalmente foi aplicar isso aqui abaixo:

```js
exports.up = async (pgm) => {
  await pgm.createIndex('balance_operations', ['balance_type', 'recipient_id']);
};
```

√â um √≠ndice de m√∫ltipla coluna entre `balance_type` e `recipient_id` por conta disso ser usado na procedure `get_current_balance`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/infra/migrations/1655868441752_create-table-balance-operations.js#L47-L84 

Mais especificamente nesta parte:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/infra/migrations/1655868441752_create-table-balance-operations.js#L75-L77

Ent√£o qualquer `WHERE` que queira aproveitar este cache, precisa pedir os dados nesta exata mesma sequ√™ncia.

Bom, escrevi tudo isto para nos animar a procurar mais oportunidades de criar √≠ndices, pois tem **em todos os lugares** do TabNews, desde cria√ß√£o de usu√°rio, cria√ß√£o de conte√∫do, leitura de conte√∫do, verifica√ß√£o de sess√£o ativa, literalmente tudo tem margem para otimiza√ß√£o.

## Execu√ß√£o

Eu sou zero especialista em criar √≠ndices, mas devemos tomar cuidado para n√£o criar √≠ndices que n√£o tragam resultados reais e para isto sugiro utilizar ferramentas auxiliares para comprovar que, o que estamos fazendo, est√° de fato trazendo resultado, e tudo isto pode ser testado com a inst√¢ncia local do Postgres que rodamos com o Docker. As ferramentas auxiliares que coletei foram a seguinte, mas n√£o deixem de complementar com outras sugest√µes:

* https://explain.depesz.com/ (gratuito)
* https://tatiyants.com/pev/#/plans (gratuito)
* https://www.pgmustard.com/ (pago, mas simplesmente sensacional, [video demonstra√ß√£o](https://www.youtube.com/watch?v=v7ef4Fpn2WI))

Sugiro tamb√©m tomar cuidado com √≠ndices de m√∫ltiplas colunas, pois pelo que estudei, as vezes o Postgres consegue se dar muito bem combinando v√°rios √≠ndices separados, e isto √© √≥timo, pois nos d√° mais flexibilidade nas queries.

Fora isso, para certas coisas precisaremos rearquitetar a modelagem, como por exemplo, para o `findChildrenTree()` do `content`, vamos provavelmente adicionar uma coluna `root_id` e indexar tudo por ali.

Bom, qualquer novo PR que for merged sobre √≠ndice, vamos listar ele aqui nessa se√ß√£o de Execu√ß√£o, ent√£o por hora vou listar somente o que j√° foi feito:

- #882

>> Coment√°rio de FabricioFFC:
@filipedeschamps e @aprendendofelipe vcs t√™m habilitado em produ√ß√£o o [slow query log](https://www.eversql.com/enable-slow-query-log-postgresql/)? Ele √© uma boa fonte de informa√ß√µes, para sabermos melhor quais queries precisam ser otimizadas, se tiverem, podem disponibilizar por favor?

Caso precisem de ajudar para habilitar, a refer√™ncia que linkei explica e posso ajudar tamb√©m. Essa √© uma otimiza√ß√£o que j√° fiz no passado e gostaria de ajudar aqui :)

>> Coment√°rio de filipedeschamps:
@FabricioFFC muito massa te ver aqui no reposit√≥rio üòç  para quem n√£o sabe eu e o Fabr√≠cio j√° trabalhamos juntos no passado ü§ù 

E n√£o est√° habilitado, o √∫nico `parameter group` que temos habilitado √© este:

https://github.com/filipedeschamps/tabnews.com.br/blob/2a12cbc2e4c5553f9d858d1ff28e7933756e2447/infra/provisioning/modules/database/main.tf#L90-L93

>> Coment√°rio de FabricioFFC:
@filipedeschamps @aprendendofelipe show! abri uma [PR](https://github.com/filipedeschamps/tabnews.com.br/pull/1316) habilitando, qq coisa s√≥ me avisar.

>> Coment√°rio de filipedeschamps:
@FabricioFFC segue os principais logs:

```sql
duration: 2619.477 ms  execute <unnamed>:
	    WITH
	    latest_published_root_contents AS (
	        SELECT
	            contents.id,
	            contents.owner_id,
	            contents.parent_id,
	            contents.slug,
	            contents.title,
	            contents.status,
	            contents.source_url,
	            contents.created_at,
	            contents.updated_at,
	            contents.published_at,
	            contents.deleted_at,
	            get_current_balance('content:tabcoin', contents.id) as tabcoins
	        FROM contents
	        WHERE
	            parent_id IS NULL
	            AND status = 'published'
	            AND published_at > NOW() - INTERVAL '1 week'
	    ),
	    ranked_published_root_contents AS (
	        SELECT
	            *,
	            COUNT(*) OVER()::INTEGER as total_rows
	        FROM latest_published_root_contents
	        WHERE tabcoins > 0
	        ORDER BY
	            tabcoins DESC,
	            published_at DESC
	    ),
	    group_1 AS (
	        SELECT
	            *,
	            1 as rank_group
	        FROM ranked_published_root_contents
	        WHERE
	            published_at > NOW() - INTERVAL '36 hours'
	            AND tabcoins > 11
	        ORDER BY
	            published_at DESC
	        LIMIT 10
	    ),
	    group_2 AS (
	        SELECT * FROM group_1
	        UNION ALL
	        SELECT
	            *,
	            2 as rank_group
	        FROM ranked_published_root_contents
	        WHERE
	            published_at > NOW() - INTERVAL '24 hours'
	            AND tabcoins > 6
	            AND id NOT IN (SELECT id FROM group_1)
	        ORDER BY
	            rank_group,
	            published_at DESC
	        LIMIT 20
	    ),
	    group_3 AS (
	        (SELECT
	            *,
	            3 as rank_group
	        FROM ranked_published_root_contents
	        WHERE
	            published_at > NOW() - INTERVAL '12 hours'
	            AND id NOT IN (SELECT id FROM group_2)
	        ORDER BY
	            published_at DESC
	        LIMIT 5)
	        UNION ALL
	        SELECT * FROM group_2
	    ),
	    group_4 AS (
	        (SELECT
	            *,
	            4 as rank_group
	        FROM ranked_published_root_contents
	        WHERE
	            published_at > NOW() - INTERVAL '3 days'
	            AND tabcoins > 11
	            AND id NOT IN (SELECT id FROM group_3)
	        ORDER BY
	            published_at DESC
	        LIMIT 10)
	        UNION ALL
	        SELECT * FROM group_3
	    ),
	    group_5 AS (
	        (SELECT
	            *,
	            5 as rank_group
	        FROM ranked_published_root_contents
	        WHERE
	            published_at > NOW() - INTERVAL '72 hours'
	            AND tabcoins > 2
	            AND id NOT IN (SELECT id FROM group_4)
	        ORDER BY
	            published_at DESC
	        LIMIT 10)
	        UNION ALL
	        SELECT * FROM group_4
	    ),
	    ranked AS (
	        SELECT * FROM group_5
	        UNION ALL
	        SELECT
	            *,
	            6 as rank_group
	        FROM ranked_published_root_contents
	        WHERE id NOT IN (SELECT id FROM group_5)
	        ORDER BY
	            rank_group,
	            tabcoins DESC,
	            published_at DESC
	        LIMIT $1
	        OFFSET $2
	    )
	    SELECT
	        ranked.id,
	        ranked.owner_id,
	        ranked.parent_id,
	        ranked.slug,
	        ranked.title,
	        ranked.status,
	        ranked.source_url,
	        ranked.created_at,
	        ranked.updated_at,
	        ranked.published_at,
	        ranked.deleted_at,
	        ranked.tabcoins,
	        ranked.rank_group,
	        ranked.total_rows,
	        users.username as owner_username,
	        (WITH RECURSIVE children AS
	            (SELECT id,
	                 parent_id
	            FROM contents as all_contents
	            WHERE
	                all_contents.id = ranked.id
	                AND all_contents.status = 'published'
	            UNION ALL
	            SELECT
	                all_contents.id,
	                all_contents.parent_id
	            FROM contents as all_contents
	            INNER JOIN children ON all_contents.parent_id = children.id
	            WHERE all_contents.status = 'published'
	            )
	            SELECT count(children.id)::integer
	            FROM children
	            WHERE children.id NOT IN (ranked.id)
	        ) as children_deep_count
	        FROM ranked
	        INNER JOIN users ON ranked.owner_id = users.id
	        ORDER BY
	            rank_group,
	            tabcoins DESC,
	            published_at DESC;
```

```sql
DETAIL:  parameters: $1 = '30', $2 = '0'
duration: 3006.857 ms  execute <unnamed>: 
	      WITH content_window AS (
	      SELECT
	        COUNT(*) OVER()::INTEGER as total_rows,
	        id
	      FROM contents
	      WHERE contents.parent_id IS NOT DISTINCT FROM $3 AND contents.status = $4
	      ORDER BY contents.published_at DESC
	
	      LIMIT $1 OFFSET $2
	      )
	      
	      SELECT
	        contents.id,
	        contents.owner_id,
	        contents.parent_id,
	        contents.slug,
	        contents.title,
	        contents.body,
	        contents.status,
	        contents.source_url,
	        contents.created_at,
	        contents.updated_at,
	        contents.published_at,
	        contents.deleted_at,
	        users.username as owner_username,
	        content_window.total_rows,
	        get_current_balance('content:tabcoin', contents.id) as tabcoins,
	
	        -- Originally this query returned a list of contents to the server and
	        -- afterward made an additional roundtrip to the database for every item using
	        -- the findChildrenCount() method to get the children count. Now we perform a
	        -- subquery that is not performant but everything is embedded in one travel.
	        -- https://github.com/filipedeschamps/tabnews.com.br/blob/de65be914f0fd7b5eed8905718e4ab286b10557e/models/content.js#L51
	        (
	          WITH RECURSIVE children AS (
	            SELECT
	                id,
	                parent_id
	            FROM
	              contents as all_contents
	            WHERE
	              all_contents.id = contents.id AND
	              all_contents.status = 'published'
	            UNION ALL
	              SELECT
	                all_contents.id,
	                all_contents.parent_id
	              FROM
	                contents as all_contents
	              INNER JOIN
	                children ON all_contents.parent_id = children.id
	              WHERE
	                all_contents.status = 'published'
	          )
	          SELECT
	            count(children.id)::integer
	          FROM
	            children
	          WHERE
	            children.id NOT IN (contents.id)
	        ) as children_deep_count
	      FROM
	        contents
	      INNER JOIN
	        content_window ON contents.id = content_window.id
	      INNER JOIN
	        users ON contents.owner_id = users.id
	    
	      ORDER BY contents.published_at DESC
	      ;
```


```sql

DETAIL:  parameters: $1 = '30', $2 = '900', $3 = NULL, $4 = 'published'
duration: 2312.163 ms  execute <unnamed>: 
	      WITH content_window AS (
	      SELECT
	        COUNT(*) OVER()::INTEGER as total_rows,
	        id
	      FROM contents
	      WHERE contents.parent_id IS NOT DISTINCT FROM $3 AND contents.status = $4
	      ORDER BY contents.published_at DESC
	
	      LIMIT $1 OFFSET $2
	      )
	      
	      SELECT
	        contents.id,
	        contents.owner_id,
	        contents.parent_id,
	        contents.slug,
	        contents.title,
	        contents.body,
	        contents.status,
	        contents.source_url,
	        contents.created_at,
	        contents.updated_at,
	        contents.published_at,
	        contents.deleted_at,
	        users.username as owner_username,
	        content_window.total_rows,
	        get_current_balance('content:tabcoin', contents.id) as tabcoins,
	
	        -- Originally this query returned a list of contents to the server and
	        -- afterward made an additional roundtrip to the database for every item using
	        -- the findChildrenCount() method to get the children count. Now we perform a
	        -- subquery that is not performant but everything is embedded in one travel.
	        -- https://github.com/filipedeschamps/tabnews.com.br/blob/de65be914f0fd7b5eed8905718e4ab286b10557e/models/content.js#L51
	        (
	          WITH RECURSIVE children AS (
	            SELECT
	                id,
	                parent_id
	            FROM
	              contents as all_contents
	            WHERE
	              all_contents.id = contents.id AND
	              all_contents.status = 'published'
	            UNION ALL
	              SELECT
	                all_contents.id,
	                all_contents.parent_id
	              FROM
	                contents as all_contents
	              INNER JOIN
	                children ON all_contents.parent_id = children.id
	              WHERE
	                all_contents.status = 'published'
	          )
	          SELECT
	            count(children.id)::integer
	          FROM
	            children
	          WHERE
	            children.id NOT IN (contents.id)
	        ) as children_deep_count
	      FROM
	        contents
	      INNER JOIN
	        content_window ON contents.id = content_window.id
	      INNER JOIN
	        users ON contents.owner_id = users.id
	    
	      ORDER BY contents.published_at DESC
	      ;
```


E nosso maior inimigo √© o `RECURSIVE` e eu especulo que todos esses logs ir√£o sumir quando implementarmos algo como isso:

> Fora isso, para certas coisas precisaremos rearquitetar a modelagem, como por exemplo, para o `findChildrenTree()` do `content`, vamos provavelmente adicionar uma coluna `root_id` e indexar tudo por ali.

>> Coment√°rio de aprendendofelipe:
> Fora isso, para certas coisas precisaremos rearquitetar a modelagem, como por exemplo, para o `findChildrenTree()` do `content`, vamos provavelmente adicionar uma coluna `root_id` e indexar tudo por ali.

Em se tratando de performance, tamb√©m acho que criar o `root_id` deve ser a prioridade.

>> Coment√°rio de FabricioFFC:
@aprendendofelipe e @filipedeschamps muito bom! 

Vou focar essa semana nesse t√≥pico, avaliando a cria√ß√£o do `root_id`. Embora antes dele, preciso aprofundar nas queries, para entender como a cria√ß√£o dele vai ajudar.

Obrigado pela ajuda de vcs!

>> Coment√°rio de aprendendofelipe:
Show @FabricioFFC! üí™

Sobre a cria√ß√£o do `root_id`, a issue #1169 explica melhor, e se tiver qualquer d√∫vida a gente pode ir conversando l√°. ü§ù

Mas l√° n√£o √© s√≥ otimizar a consulta, pois precisa modelar melhor os dados e mudar a regra de neg√≥cio, ent√£o se preferir lidar com os √≠ndices, tamb√©m √© algo que vai ajudar bastante. Eu s√≥ acho melhor come√ßar por l√° porque eliminar essa carga vai facilitar depois medir o impacto dos √≠ndices no desempenho. üëç

>> Coment√°rio de FabricioFFC:
Me parece tamb√©m melhor come√ßar pela #1169, pois a cria√ß√£o de √≠ndice s√≥ valeria agora se tivermos com uma dor latente em produ√ß√£o, que os √≠ndices aliviaria (n√£o me parece ser o caso, se for me avise), j√° que a cria√ß√£o de √≠ndice provavelmente ser√° impactada com a cria√ß√£o do `root_id`.

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, como est√£o os logs agora? Ainda est√° pegando algo acima de 2s?

>> Coment√°rio de aprendendofelipe:
> @filipedeschamps, como est√£o os logs agora? Ainda est√° pegando algo acima de 2s?

@filipedeschamps, quando for olhar os logs, aproveita e tenta ver se houve algum aumento significativo no uso do banco de dados com a mudan√ßa da revalida√ß√£o da p√°gina de conte√∫dos de 10s para 1s. Subi para produ√ß√£o √†s 13:44 e parece que levou um tempo maior para diminuir o n√∫mero de conex√µes abertas com o banco, mas j√° voltou para um patamar s√≥ um pouco acima de antes do deploy.

>> Coment√°rio de aprendendofelipe:
Turma, os logs n√£o vem registrando mais nenhuma query acima de 2s. E a utiliza√ß√£o de CPU do banco dificilmente passa de 10%.

A gente pode diminuir o valor de `log_min_duration_statement` para descobrir outras queries que possam ser otimizadas, mas com essa utiliza√ß√£o de CPU t√£o baixa, acho que podemos dar a issue o como conclu√≠da por enquanto, e voltar a analisar os √≠ndices/queries se algo piorar ap√≥s a implementa√ß√£o da Revenue Share.

O que acham?

>> Coment√°rio de Rafatcb:
Acho que faz sentido diminuir o valor do `log_min_duration_statement` para ficarmos cientes de quais s√£o as pr√≥ximas queries problem√°ticas, e tamb√©m fechar este issue :+1: 

Ent√£o, se houver uma query significativamente lenta, acredito que podemos criar um issue dedicado para ela.

Voc√™ consegue ver como est√£o os endpoints? Pode ser que algum seja lento por executar v√°rias queries separadas, e assim nenhuma query chama a aten√ß√£o no log.

>> Coment√°rio de aprendendofelipe:
> Acho que faz sentido diminuir o valor do `log_min_duration_statement` para ficarmos cientes de quais s√£o as pr√≥ximas queries problem√°ticas,

Olhando os tempos m√©dios de execu√ß√£o das fun√ß√µes lambdas, nenhuma query poderia estar passando de 1s. Podemos deixar para baixar o valor do `log_min_duration_statement` quando realmente precisar, ou aproveitamos quando formos fazer alguma outra altera√ß√£o no `terraform`.

> e tamb√©m fechar este issue üëç

Vou fechar ü§ù

> Ent√£o, se houver uma query significativamente lenta, acredito que podemos criar um issue dedicado para ela.

No momento, n√£o h√°! üéâ

> Voc√™ consegue ver como est√£o os endpoints? Pode ser que algum seja lento por executar v√°rias queries separadas, e assim nenhuma query chama a aten√ß√£o no log.

Se fala dos tempos de resposta das requisi√ß√µes para cada endpoint, n√£o temos essa m√©trica. Isso seria algo para ser coletado e enviado pelo client. Mas acredito que n√£o fala disso, pois n√£o seria muito √∫til para analisar a performance do banco de dados, j√° que boa parte das requisi√ß√µes s√£o atendidas pelo cache.

Se fala do tempo de execu√ß√£o das lambdas, isso eu dei uma olhada. N√£o temos problemas de perfomance com as queries, mas, se fosse o caso de diminuir a utiliza√ß√£o de recursos na Vercel (usamos cerca de 25% da cota mensal), dever√≠amos atacar nesta ordem:

- `GET /[username]/[slug]`: s√≥ 290ms, mas impacta pelo volume de invoca√ß√µes, que chega a 10% da cota;
- `GET /api/v1/contents/rss`: 1839ms, o que faz chegar a 4% da cota, e o problema n√£o √© o BD;
- `GET /api/v1/contents/[username]/[slug]/thumbnail`: s√≥ 390ms, mas impacta pelo volume, que chega a 3% da cota;
- Outras listagens de conte√∫dos, excluindo o RSS, chegam juntas a 2% da cota que temos na Vercel.

Agora, olhando para UX, precisamos atacar nesta ordem:

- `GET /api/v1/contents/rss`: 1839ms, pois puxa mais dados do banco (cont√©m o `body`), precisa remover o `markdown` para criar a `description`, gerar `html` para o `content`, filtrar a sa√≠da com o `validator`, e tudo isso para 30 conte√∫dos.
- `POST /api/v1/contents`: 1514ms, pois faz muitas leituras e grava√ß√µes no banco (talvez d√™ para unificar algumas);

O RSS s√≥ fica no topo aqui porque eu desconsiderei todos os `POST`s/`PATCH`s que envolvem salvar ou verificar a senha, pois s√£o os mais lentos por causa do `bcryptjs`.

Por fim, olhando para SEO, acho que o foco seria:

- `GET /api/v1/contents/rss`: pois √© acessado com frequ√™ncia pelo Google, e o P99 passa de 8s;
- `GET /api/v1/contents/[username]/[slug]/thumbnail`: pois √© acessado por diferentes redes sociais, e o P99 chega a 4s;

Com tudo isso, se for para dar aten√ß√£o para algum endpoint, come√ßaria pelo RSS.

Mas nada disso envolve problemas com alguma query espec√≠fica, mas sim com o que √© executado na lambda, ent√£o de fato essa issue est√° conclu√≠da. üéâüéâüéâ

>> Coment√°rio de Rafatcb:
> Se fala do tempo de execu√ß√£o das lambdas

Era isso mesmo. Obrigado pelos dados ü§ù, excelente resumo.
</issue_1156_√çndices no Banco de Dados>

<issue_1157_Adiciona meta tag `upgrade-insecure-requests`>
## Contexto

- #1090

## Execu√ß√£o

- #1110
</issue_1157_Adiciona meta tag `upgrade-insecure-requests`>

<issue_1158_Alinhar logo do TabNews com o texto do footer>
## Contexto e Execu√ß√£o

- #1053
</issue_1158_Alinhar logo do TabNews com o texto do footer>

<issue_1159_Substitui√ß√£o dos c√≥digos de erro do PostgreSQL por constantes explicativas>
## Contexto e Execu√ß√£o

- #1068
</issue_1159_Substitui√ß√£o dos c√≥digos de erro do PostgreSQL por constantes explicativas>

<issue_1160_Resolve o bug da mensagem "Conte√∫do apagado com sucesso">
## Contexto

- #808

## Execu√ß√£o

- #809
</issue_1160_Resolve o bug da mensagem "Conte√∫do apagado com sucesso">

<issue_1161_Permitir alterar nome do usu√°rio mudando apenas letras entre mai√∫sculas e min√∫sculas e vice-versa>
## Contexto

- #948

## Execu√ß√£o

- #962
</issue_1161_Permitir alterar nome do usu√°rio mudando apenas letras entre mai√∫sculas e min√∫sculas e vice-versa>

<issue_1162_Remo√ß√£o de palavra "conta" duplicada nos termos de uso>
## Contexto e Execu√ß√£o

- #933
</issue_1162_Remo√ß√£o de palavra "conta" duplicada nos termos de uso>

<issue_1163_Impedir que conte√∫dos sejam publicados sem texto vis√≠vel>
## Contexto

- #1131

## Execu√ß√£o

- #1133
</issue_1163_Impedir que conte√∫dos sejam publicados sem texto vis√≠vel>

<issue_1164_Cache da API: Endpoints de Conte√∫do>
## Contexto

O maior motivo que faz as p√°ginas do TabNews abrirem rapidamente √© o fato delas serem estaticamente geradas, onde s√£o revalidadas a cada `10` segundos:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/%5Busername%5D/%5Bslug%5D/index.public.js#L390

Para compensar o fato de uma p√°gina estar desatualizada ao abr√≠-la, no client-side n√≥s fazemos duas requests adicionais para a API, onde uma pega o conte√∫do atualizado:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/%5Busername%5D/%5Bslug%5D/index.public.js#L22-L29

E outra para pegar a lista de respostas:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/%5Busername%5D/%5Bslug%5D/index.public.js#L32-L39

Ou seja, √© feito duas requisi√ß√µes adicionais, que n√£o passam pelo cache, onde a segunda requisi√ß√£o (a que pega o `children`) pode pesar bastante dependendo da quantidade de respostas:

```
/api/v1/contents/[username]/[slug]
/api/v1/contents/[username]/[slug]/children
```

## Execu√ß√£o

Ent√£o a id√©ia √© adicionar o cache de `stale-while-revalidate` no `GET` destes endpoints como foi feito [neste PR](https://github.com/filipedeschamps/tabnews.com.br/pull/1060).

Por√©m um cuidado **muito importante** √© n√£o fazer o cache do usu√°rio que est√° logado (para n√£o cachear a sess√£o dele), por isto no PR citado a cima, n√≥s alteramos de:

```js
async function getHandler(request, response) {
  const userTryingToList = request.context.user;
```

Para:

```js
async function getHandler(request, response) {
  const userTryingToList = user.createAnonymous();
```

Outro detalhe importante √© entender quem deve ser respons√°vel por revalidar o cache, pois do contr√°rio, a p√°gina est√°tica pode estar com um cache na frente da API (n√£o tem problema os caches estarem dessincronizados, desde que o cache da API **sempre** esteja na frente). Ent√£o casos que precisamos considerar e entender o que fazer:

1. Quando algu√©m edita o seu conte√∫do e ele √© um conte√∫do raiz.
2. Quando algu√©m edita o seu conte√∫do, mas ele √© um conte√∫do filho.
   1. Esta a√ß√£o deveria atualizar a lista inteira de filhos? Que √© o `/[username]/[slug]/children` do `root` content?
   2. Esta a√ß√£o deveria atualizar o slug espec√≠fico deste conte√∫do? Que √© o `/[username]/[slug]` do `child` content?
3. Quando algu√©m qualifica algum conte√∫do? O que acontece? Pois a quantidade de TabCoins vem do conte√∫do.
4. Tem outros casos?

E lembrando que passar essa responsabilidade para quem gera uma a√ß√£o, vai penalizar a experi√™ncia dela, a n√£o ser que isso seja colocado numa fila como uma outra pessoa sugeriu no passado, mas sugiro n√£o trazer essa complexidade para agora. Uma outra alternativa seja tirar o `await` da frente do `response.revalidate('...')`

Endpoits relacionados:

- [/api/v1/contents/[username]](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/api/v1/contents/%5Busername%5D/index.public.js)
-[/api/v1/contents/[username]/[slug]/children](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/children/index.public.js)
- [/api/v1/contents/[username]/[slug]/tabcoins](https://github.com/filipedeschamps/tabnews.com.br/tree/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/tabcoins)

Outros endpoits que tamb√©m devem ser est√°ticos, mas que podem ser atualizados pelo `revalidate` do cache (sem ser on-demand):

- [/api/v1/contents/[username]/[slug]/parent](https://github.com/filipedeschamps/tabnews.com.br/tree/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/parent)
- [/api/v1/contents/[username]/[slug]/root](https://github.com/filipedeschamps/tabnews.com.br/tree/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/root)
- [/api/v1/contents/[username]/[slug]/thumbnail](https://github.com/filipedeschamps/tabnews.com.br/tree/main/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/thumbnail)

>> Coment√°rio de DiegoAscanio:
N√£o sei se seria adequado, mas, se for colocado algum controle por hash, onde a API seja a controladora dos hashes e em vez de solicitar o content, o usu√°rio solicita apenas o hash (que estar√° armazenado no banco) em revalidate, para verificar se o hash da API √© o mesmo que possui localmente. Se o hash tiver mudado, a√≠ sim o usu√°rio consome as apis de contents.

Pro caso do endpoint children, o hash incremental seria uma alternativa, pois, se existe uma fun√ß√£o de hash incremental que tanto client quanto api conhe√ßam, entendo que ao ocorrer uma atualiza√ß√£o do incremento do hash, o client solicite o children apenas para os novos conteudos, em vez de solicit√°-lo todo novamente.

√â vi√°vel?

Ponto negativo: acrescenta mais um elemento de estado na aplica√ß√£o.

Ponto positivo: reduz as queries dos clientes para o estritamente necess√°rio, melhorando o desempenho!

>> Coment√°rio de aprendendofelipe:
Implementado no PR #1374 complementado pelos PRs #1385 e #1389.
</issue_1164_Cache da API: Endpoints de Conte√∫do>

<issue_1166_Limitar a quantidade qualifica√ß√µes (TabCoins) por publica√ß√£o>
## Contexto

Hoje qualquer pessoa pode depositar uma quantidade ilimitada de TabCoins em uma √∫nica publica√ß√£o (enquanto essa pessoa possuir saldo). Olhando o que isso possibilitou, n√£o posso dizer que foi saud√°vel para a economia e o ecossistema de publica√ß√µes do TabNews.

E h√° v√°rias formas de abordar este assunto e a sugest√£o que vou dar aqui n√£o √© a forma final que eu gostaria que fosse, mas vai ser um **√≥timo teste** para entender como a economia se comporta, porque ela vai sair de um extremo para o outro que √© **limitar `1` TabCoin por publica√ß√£o, por usu√°rio**. J√° pediram isso no passado e isso deveria ser o limite inicial de todas as contas na verdade.

E talvez ao inv√©s de ser `1` TabCoin por usu√°rio, ser `1` TabCoin por **IP**. Ou um limite `x` por IP.

## Execu√ß√£o

Tudo se inicia no controller do `/api/v1/contents/[username]/[slug]/tabcoins`, no handler do `POST`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/tabcoins/index.public.js#L20

Talvez seja interessante usar o Firewall, assim como foi feito no endpoint de `users`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/api/v1/users/index.public.js#L24

Onde o Firewall buscaria por registros pr√©vios vindos do mesmo IP e decidiria fazer algo a respeito, como por exemplo, negar com um `429`.

### Efeito colateral nos testes

Uma coisa que √© necess√°rio considerar √© o que deveria acontecer com os testes automatizados, pois temos cobertura das qualifica√ß√µes (e elas v√£o ser barradas por essa nova prote√ß√£o):

https://github.com/filipedeschamps/tabnews.com.br/blob/main/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/tabcoins/post.test.js

>> Coment√°rio de gabrielsozinho:
>E talvez ao inv√©s de ser 1 TabCoin por usu√°rio, ser 1 TabCoin por IP. Ou um limite x por IP.

Se a pessoa usasse uma VPN ela conseguiria avaliar mais de uma vez, n√£o √©? Tamb√©m existe o caso de 2 pessoas usarem o TabNews em uma mesma empresa ou resid√™ncia, ai elas n√£o conseguiriam avaliar o mesmo conte√∫do.

A sugest√£o que eu tenho √©: deixar o limite de `1` TabCoin para cada usu√°rio e ter uma esp√©cie de rate-limit elevado por IP, onde mesmo em contas diferentes, o IP n√£o vai conseguir avaliar a mesma publica√ß√£o durante aquele per√≠odo.

Como eu disse, √© s√≥ uma sugest√£o, podem (e devem) existir falhas, outras sugest√µes surgir√£o. üëçüèª

>> Coment√°rio de filipedeschamps:
> Se a pessoa usasse uma VPN ela conseguiria avaliar mais de uma vez, n√£o √©?

Correto, e acredito que quase toda medida de seguran√ßa tenha uma forma de abusar, a quest√£o √© que uma hora o abuso chega num est√°gio de: "vale a pena em quest√£o de custo e tempo?" Se a gente der muito trabalho para algu√©m abusar, isto diminui drasticamente a curva deste abuso, onde quem abusar mesmo assim, devemos ser r√°pidos para identificar e anular a opera√ß√£o.

> Tamb√©m existe o caso de 2 pessoas usarem o TabNews em uma mesma empresa ou resid√™ncia, ai elas n√£o conseguiriam avaliar o mesmo conte√∫do.

Correto! Por isso destaquei _"Ou um limite `x` por IP."_ H√° outros casos tamb√©m que pessoas podem compartilhar o IP, e isto foi uma preocupa√ß√£o quando implementamos o Firewall. No caso de `IPv4`, mesmo quando a gente mascarava ele, a gente n√£o teve problema (isso n√£o quer dizer que n√£o teremos no futuro). Mas de qualquer forma, acho importante colocarmos um limite sobre pessoas que possam estar vinculadas, e por hora, n√£o sei se existe outro valor a n√£o ser que seja o IP.

> A sugest√£o que eu tenho √©: deixar o limite de 1 TabCoin para cada usu√°rio e ter uma esp√©cie de rate-limit elevado por IP, onde mesmo em contas diferentes, o IP n√£o vai conseguir avaliar a mesma publica√ß√£o durante aquele per√≠odo.

Perfeito, o Firewall consegue fazer isso, pois √© o que faz para analisar a quantidade de contas criadas, ou publica√ß√µes criadas ü§ù

>> Coment√°rio de cybernerd007:
Minha sugest√£o √© quando for dado UpVote ou DownVote sej√° adicionado um delay de 1 minuto para se aplicar mais uma a√ß√£o assim vai desencorajar muitos pois levara muito tempo ate 5 minutos depois com os animos j√° calmos o "atacante" deva parar e por meio da sugest√£o que [EU DEI AQUI](https://github.com/filipedeschamps/tabnews.com.br/issues/1167) a propria comunidade possa denunciar o "Atacante" assim Recomendo que seja adicionado um bot√£o denunciar para que fique encarregado a um moderador decidir se foi um "ATAQUE" ou N√£o.

>> Coment√°rio de braiansmarzaro:
Neste mesmo assunto, quero adicionar a Issue #1183 , que destacada o problema de votos _contr√°rios_ que um usu√°rio pode aplicar √† mesma publica√ß√£o.

>> Coment√°rio de rodrigoKulb:
Acabei de ser pego por esse cara hahaha!

![Captura de tela em 2023-03-15 20-47-45](https://user-images.githubusercontent.com/5334261/225470414-3e182d1c-1ea7-41d5-b4c0-2635d5130a50.png)

>> Coment√°rio de aprendendofelipe:
N√£o lembro se vi isso no reposit√≥rio ou no TabNews, mas algu√©m citou que a qualifica√ß√£o agora √© mais confi√°vel, j√° que sabemos que √© mais dif√≠cil que tenha sido manipulada por uma √∫nica pessoa. E eu concordo com isso, mas acho a limita√ß√£o por IP muito f√°cil de burlar, ent√£o sou a favor de limitar por usu√°rio e deixar um limite por IP mais flex√≠vel, mas n√£o sem limite, pois isso tamb√©m pode nos alertar quando algu√©m tentar manipular a economia usando mais de um usu√°rio.

>> Coment√°rio de aprendendofelipe:
Continuando a an√°lise acima, mas agora baseado em dados, tenho uma opini√£o contr√°ria a essa limita√ß√£o...

Mais dif√≠cil de manipular n√£o significa imposs√≠vel, pois parte de quem n√£o gostou da limita√ß√£o acabou dando um jeito. Mas mesmo assim, nos casos que analisei, n√£o √© poss√≠vel afirmar que est√° existindo manipula√ß√£o.

### N√£o tem mais votos duplicados?

Olhando s√≥ ap√≥s 15 de fevereiro, pouco depois do limite de 1 voto a cada 72 horas por IP ser implementado, temos o seguinte:

* Agrupando votante/conte√∫do, temos 193 agrupamentos, ou seja, n√£o foram votos √∫nicos. O total de votos nesses casos soma 431.
* 1/4 dos casos s√£o de um √∫nico usu√°rio que chegou a dar um voto por dia para 1 conte√∫do ao longo de 8 dias (mas nada que pare√ßa manipula√ß√£o indevida).
* Apenas 30 casos tem acima de 3 votos e apenas 6 possuem acima de 4.
* Olhando apenas ap√≥s 15 de abril (mudan√ßa na regra dos ganhos), s√£o 55 casos e 124 votos, onde metade √© daquele mesmo usu√°rio.

### Efeito colateral - Iniciou a queda brusca de votos no sistema

Uma outra parte dos usu√°rios, que n√£o deu um jeito de continuar votando duplicado, pode ter supervalorizado os votos, j√° que n√£o pode dar votos em quantidade proporcional ao valor do conte√∫do, acaba dando apenas 1, mas apenas para quem merecer muito. Concluo isso, pois os votos n√£o foram redistribu√≠dos, j√° que mesmo com a quantidade de TabCoins crescendo, os votos diminu√≠ram 30% se comparar 40 dias antes com 40 dias depois da mudan√ßa. E o n√∫mero de votos foi caindo bastante desde ent√£o. A queda s√≥ parou com a implementa√ß√£o dos novos crit√©rios de ganho de TabCoins em abril, quando comparamos 40 dias antes com 40 dias depois dessa mudan√ßa, temos um aumento de 5% na quantidade de votos. Mas √© importante observar que o n√∫mero de publica√ß√µes dobrou nesse mesmo comparativo de tempo. Se eliminarmos um per√≠odo de explos√£o de usu√°rios que ocorreu bem na mesma √©poca da nova mec√¢nica, e compararmos os 40 dias anteriores com os 40 √∫ltimos dias atuais, a queda na quantidade de votos √© de ~~20%~~ 9% [Edit: Comparando os √∫ltimos 40 dias com os 40 dias anteriores a mudan√ßa da regra de ganho de TabCoins, a queda na quantidade de votos foi de 9%].

[Edit 2] Apesar dos n√∫meros acima serem verdadeiros, as mudan√ßas em quantidade de votos seguem uma tend√™ncia bastante relacionada com o volume de publica√ß√µes, ent√£o a queda de votos ap√≥s a implementa√ß√£o da limita√ß√£o por IP se deve mais pela redu√ß√£o de publica√ß√µes no mesmo per√≠odo. J√° se olharmos o per√≠odo recente existe um descolamento do n√∫mero de votos vs publica√ß√µes, em que nessa rela√ß√£o os votos diminu√≠ram ap√≥s as mudan√ßas das regras em abril e a cerca de um m√™s se estabilizaram em um patamar menor.

### Efeito na confiabilidade dos saldos dos conte√∫dos

Al√©m da diminui√ß√£o de votos, como essa supervaloriza√ß√£o n√£o √© uniforme, ficamos com uma range muito grande de "valor" do voto, pois alguns usu√°rios s√£o muito mais criteriosos do que outros, ent√£o a m√©trica do saldo de votos fica mais imprecisa, pois n√£o temos como saber se os votos de certos conte√∫dos foram dados pelos mais ou menos criteriosos.

Por outro lado, sem um limite de votos por publica√ß√£o, mesmo qua ainda existam diferentes crit√©rios, quem √© mais criterioso e tamb√©m possui mais TabCoins para votar, pode dar mais votos aos conte√∫dos que achar que valem mais. Ent√£o o range do valor de um voto acaba diminuindo, e mesmo que ainda exista, com uma quantidade maior de votos podemos confiar mais na m√©dia. Al√©m de que quem produz conte√∫dos melhores continua tendo mais poder, pois pode dar mais votos para um mesmo conte√∫do, caso queira.

### Experi√™ncia no TabNews

E tudo no sistema funciona de forma mais interessante quando o n√∫mero de votos √© maior, mesmo que o "peso" de 1 voto seja menor, o que √© compensado pela quantidade. E votos com peso menor significa que mesmo quem ainda n√£o consegue criar os conte√∫dos de maior destaque, ainda assim pode receber votos.


### Conclus√£o

A limita√ß√£o da quantidade de votos tinha como um dos objetivos melhorar a confiabilidade da qualifica√ß√£o dos conte√∫dos, mas deu start em um processo de queda na quantidade de votos em geral no sistema, o que n√£o impacta na economia, mas impacta na experi√™ncia de uso do TabNews e piora a confiabilidade da qualifica√ß√£o ao inv√©s de melhorar.

Por isso eu gostaria de propor retirarmos esse limite de 1 voto por publica√ß√£o para ver qual ser√° o comportamento, j√° que agora temos outras seguran√ßas que dificultam a gera√ß√£o de TabCoins sem nenhum esfor√ßo e j√° dificultam a manipula√ß√£o do ranqueamento.

>> Coment√°rio de filipedeschamps:
> Por isso eu gostaria de propor retirarmos esse limite de 1 voto por publica√ß√£o para ver qual ser√° o comportamento, j√° que agora temos outras seguran√ßas que dificultam a gera√ß√£o de TabCoins sem nenhum esfor√ßo e j√° dificultam a manipula√ß√£o do ranqueamento.

Bora!!! Vamos iniciar mais um experimento! Quanto mais fizermos isto, melhor o problema vai ser mapeado ü§ù üí™

>> Coment√°rio de aprendendofelipe:
> Bora!!! Vamos iniciar mais um experimento! Quanto mais fizermos isto, melhor o problema vai ser mapeado ü§ù üí™

Limite alterado de 1 para 3 votos... Vamos acompanhar! ü§ù

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, podemos dar essa issue como conclu√≠da ap√≥s o PR #1441 que fixou o limite em 3 votos?

Acho que o comportamento ficou legal e que n√£o precisaremos de experimentos relacionados por enquanto. üëç

>> Coment√°rio de andrecruzmendes:
Vou sugerir uma ideia, que n√£o precisa ser considerada nessa issue especificamente, at√© porque ainda n√£o sei como funciona a din√¢mica por aqui (acabei de chegar).

A ideia √© a seguinte: em vez de limitar as a√ß√µes dos usu√°rios, podemos definir um modelo matem√°tico que apenas suaviza o impacto delas quando s√£o repetidas.

Por exemplo, o peso dos votos de um mesmo usu√°rio sobre um mesmo conte√∫do poderia seguir uma simples fun√ß√£o logar√≠tmica:

$$ **P = 1 + lg(N)** $$

Onde $N$ √© o n√∫mero de vezes que o usu√°rio executou essa mesma a√ß√£o.

Nesse exemplo:
- 1 voto conta 1
- 2 contam 2
- 3 contam aproximadamente 2,6
- 4 contam 3
- 5 contam aproximadamente 3,3
- 6 contam aproximadamente 3,6
- 7 contam aproximadamente 3,8
- 8 contam 4
- ...
- 1024 contam apenas 11

Assim, o esfor√ßo para ter mais impacto cresce conforme as a√ß√µes se repetem, mas o usu√°rio n√£o fica impedido de agir, portanto n√£o √© desmotivado a votar.

Isso tamb√©m poderia ser aplicado a a√ß√µes realizadas a partir de um mesmo IP, mas precisa ser analisado com aten√ß√£o.

Como eu n√£o tive tempo de analisar o c√≥digo ainda, me perdoem se eu estiver sugerindo algo que n√£o √© aplic√°vel na pr√°tica por n√£o conhecer outras quest√µes que deveria ter considerado. O intuito √© apenas contribuir.

>> Coment√°rio de aprendendofelipe:
Turma, como ningu√©m se op√¥s ao fechamento, estou dando a issue como conclu√≠da. üëç

Recomendo concentrar novas ideias sobre a economia na #1438. ü§ù

Muito obrigado a todos que contribu√≠ram com o assunto. üí™
</issue_1166_Limitar a quantidade qualifica√ß√µes (TabCoins) por publica√ß√£o>

<issue_1167_Mostrar quem qualificou uma publica√ß√£o>
## Contexto

Nas √∫ltimas semanas a coisa mais poderosa que eu percebi no TabNews foi a an√°lise da pr√≥pria comunidade sobre detectar eventuais anomalias, principalmente sobre manipula√ß√£o de TabCoins, isso sem terem informa√ß√£o alguma a n√£o ser detectar isso pela velocidade de crescimento dos valores e a intera√ß√£o entre usu√°rios.

Isso √© fant√°stico, pois s√£o as pessoas protegendo o espa√ßo que elas est√£o gostando de usar. Ent√£o numa conversa com @aprendendofelipe sugeri cada vez mais expormos as informa√ß√µes para munir a comunidade com mais dados e detectar anomalias com muito mais facilidade e precis√£o.

E para isso, a primeira coisa que eu sugiro fazer √©, ao passar o mouse em cima do valor das TabCoins de uma publica√ß√£o, mostrar quem qualificou ela. A d√∫vida que fica √© se iremos mostrar quem qualificou negativamente, pois isso pode inibir esta a√ß√£o (que √© importante), pela pessoa ter medo de persegui√ß√£o. Por outro lado, esconder este dado tamb√©m pode gerar abuso. E agora?

## Execu√ß√£o

Numa vis√£o geral, abrir um novo m√©todo `GET` no endpoint das TabCoins:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/tabcoins/index.public.js#L12-L20

Onde o resultado dos `usernames` deveria voltar **agrupado por IP** e com a soma de cada grupo ordenada de forma decrescente (do maior para o menor). **N√£o devemos retornar na API o IP de cada grupo**, mas √© muito importante devolver agrupado desta forma para as pessoas identificarem contas que podem ter algum v√≠nculo.

Estas informa√ß√µes n√£o est√£o dispon√≠veis na tabela `balance_operation`, mas est√£o `events`.

>> Coment√°rio de cybernerd007:
> E para isso, a primeira coisa que eu sugiro fazer √©, ao passar o mouse em cima do valor das TabCoins de uma publica√ß√£o,
> mostrar quem qualificou ela. A d√∫vida que fica √© se iremos mostrar quem qualificou negativamente, pois isso pode inibir esta > a√ß√£o (que √© importante), pela pessoa ter medo de persegui√ß√£o. Por outro lado, esconder este dado tamb√©m pode gerar abuso.   E agora?

Recomendo exibir os nomes somente em caso do usuario votar mais de 1 vezes pois assim se for um conteudo ruim para a comunidade varias pessoas vao deixar seu downvote porem se for uma unica pessoa isso era mostrar um ataque para inibir tal publica√ß√£o n√£o por que seja algo que viole os termos e sim de carater vinda de puro ego de quem ataca...

minha recomenda√ß√£o e essa independente se for DownVote ou UpVote quando for aplicado mais de 1 vez o nome dele aparecera quando se coloca a setinha do mouse sobre o valor...

assim a privacidade e protegida e em casos excepcionais a propria comunidade consegue constatar algum de m√° f√©

O que acha da ideia?

>> Coment√°rio de filipedeschamps:
Achei muito interessante!!!

>> Coment√°rio de hanufu:
Mas e quanto as pessoas que foram **boicotadas** que ficaram negativadas assim com eu por conta do mal  uso de TabCoins? A final, √© muito dif√≠cil, pensar em criar algo, construir direitinho ver tudo  dando certo, e quando voc√™ menos espera teu post foi boicotado por algu√©m, que tem muitos tabcoins ganhos comentando coisas como "Massa", "gostei". Talvez fosse bom, adicionar algumas "puni√ß√µes", como n√£o poder comentar por X dias, n√£o poder interagir seja de forma positiva ou negativa com outras pubs por X tempo.

>> Coment√°rio de filipedeschamps:
@Hanufu neste caso entra em a√ß√£o entre outro recurso: https://github.com/filipedeschamps/tabnews.com.br/issues/1166

>> Coment√°rio de hkotsubo:
> > E para isso, a primeira coisa que eu sugiro fazer √©, ao passar o mouse em cima do valor das TabCoins de uma publica√ß√£o,
> > mostrar quem qualificou ela. A d√∫vida que fica √© se iremos mostrar quem qualificou negativamente, pois isso pode inibir esta > a√ß√£o (que √© importante), pela pessoa ter medo de persegui√ß√£o. Por outro lado, esconder este dado tamb√©m pode gerar abuso.   E agora?
> 
> Recomendo exibir os nomes somente em caso do usuario votar mais de 1 vezes pois assim se for um conteudo ruim para a comunidade varias pessoas vao deixar seu downvote porem se for uma unica pessoa isso era mostrar um ataque para inibir tal publica√ß√£o n√£o por que seja algo que viole os termos e sim de carater vinda de puro ego de quem ataca...
> 
> minha recomenda√ß√£o e essa independente se for DownVote ou UpVote quando for aplicado mais de 1 vez o nome dele aparecera quando se coloca a setinha do mouse sobre o valor...
> 
> assim a privacidade e protegida e em casos excepcionais a propria comunidade consegue constatar algum de m√° f√©
> 
> O que acha da ideia?

Olha, teve um post que estava bem ruim e eu n√£o lembrava se j√° tinha negativado (pois se passou uns dias), ent√£o fui l√° e negativei (possivelmente pela segunda vez). N√£o foi ataque e nem persegui√ß√£o, foi um esquecimento mesmo.

Pra evitar isso, n√£o seria melhor mostrar tamb√©m (de algum jeito na pr√≥pria interface) que eu j√° votei? Ou talvez, quando eu votar, mostrar um pop-up do tipo "voc√™ j√° votou nesse post, quer mesmo votar de novo?" - Isso evita casos como o meu (que pode ser confundido com persegui√ß√£o), al√©m de gerar um pouco de fric√ß√£o para quem realmente deseja atacar.

>> Coment√°rio de hkotsubo:
Outra coisa, o fato de mostrar quem votou negativo pode inibir os ataques, mas por outro lado, o que acontece com o usu√°rio que deu os negativos? Fora a exposi√ß√£o p√∫blica, n√£o parece ter muita consequ√™ncia (a n√£o ser que ele passe a receber negativos tamb√©m, mas a√≠ o problema s√≥ piorou, pois agora teremos mais ataques).

Pela minha experi√™ncia em outros sites, expor este tipo de coisa tem esse lado ruim, de deixar a pessoa "marcada" pra sempre (e n√£o resolve muito, pois ela simplesmente cria outra conta). Ent√£o expor os votos talvez n√£o resolva tantos problemas assim, e acabe criando outros.

Talvez seja o caso de termos moderadores, e somente estes possam ver quem deu mais que 2 votos no mesmo post? E um sistema que permita aos usu√°rios sinalizarem posts "suspeitos", para posterior investiga√ß√£o pela modera√ß√£o.

>> Coment√°rio de eletroswing:
@filipedeschamps  @aprendendofelipe  Acredito que possa haver uma consulta(ou retornando direto ao montar a page) um novo campo chamado "tabcoins_rank" que retorna um conjunto de 3 usu√°rios que mais influenciaram tabcoins positivos ou negativos, e quando todos forem igual a 1, n√£o retornar nada ou em ordem de qual √© o mais recente. Futuramente, a fun√ß√£o de mostrar ou esconder quem negativou uma publica√ß√£o pode ser comprada por um n√∫mero de tabcash, por exemplo, um usu√°rio quer mostrar quem negativou a publica√ß√£o ter que comprar a feature, e isso j√° poder dispertar uma sensa√ß√£o de "por que o usu√°rio quer mostrar quem negativou" e j√° mostrar uma suposta persegui√ß√£o, sendo ent√£o, mostrar as 3 pessoas que mais deram "like" como padr√£o, e mostrar as 3 pessoas que mais deram "deslike" como uma feature paga por tabcash, o que acham?

>> Coment√°rio de hanufu:
@eletroswing Eu pessoalmente n√£o acho que a ideia de um tabcoin_rank como voc√™ falou, particularmente eu acho anti√©tico, hoje em dia temos que esperar 72 horas basicamente para poder dar mais um voto, seja ele positivo ou negativo, e isso √© uma funcionalidade muito massa pq agora as pessoas n√£o podem mais sair floppando um post s√≥ por vingan√ßa ou algo do tipo... 

Qual seria a usabilidade de uma p√°gina, que retornasse para todos os usu√°rios to TN quem foi a pessoa que mais deu voto, positivo ou negativo? talvez eu esteja com a vis√£o muito limitada, e n√£o consiga enxergar o que voc√™ quer dizer, mas sendo sincero acho que isso s√≥ traria uma forma de caos pra dentro da plataforma.

>> Coment√°rio de eletroswing:
seria mais como mostrar quem qualificou uma publica√ß√£o no facebook, e n√£o necessariamente precisaria ter um endpoint, ao construir a p√°gina poderia ser pego os 3 usu√°rios que mais deram tabcoins em uma pub, pra mostrar, ou quem sabe, de todo o tabnews, mas como voc√™ disse, mesmo s√≥ mostrando quem mais reagiu talvez gere caos dependendo como for implementada.

>> Coment√°rio de hkotsubo:
@eletroswing  Eu ainda acho (vide meus coment√°rios acima) que mostrar quem votou tem mais desvantagens do que vantagens. No caso de abuso (como persegui√ß√£o, ou algu√©m ter v√°rias contas, ou qualquer outro tipo de uso indevido), o que deveria ter - na minha opini√£o - √© uma forma de sinalizar/denunciar para a modera√ß√£o do site (e eles podem investigar melhor, tendo acesso aos dados de vota√ß√£o, por exemplo).

Expor os votos costuma n√£o dar t√£o certo quanto a gente pensa - em experi√™ncias que tenho em outros sites (em especial no Stack Overflow) percebo que muitas pessoas levam os votos pro lado pessoal e acabam perseguindo quem votou (l√° os votos s√£o an√¥nimos, mas tem gente que comenta "_votei negativo por causa disso_" e acaba sofrendo retalia√ß√£o). Ou seja, a transpar√™ncia acaba causando persegui√ß√£o (e acontece muito mais do que a gente imagina). O que acontece muito tamb√©m √© a "persegui√ß√£o disfar√ßada": quem vota muito de alguma maneira que n√£o agrade a maioria acaba ficando "marcado", as pessoas param de votar no conte√∫do dessa pessoa (mesmo que seja de qualidade) ou de interagir com ela, s√≥ porque n√£o concorda com os votos que ela deu.

E se mostrarmos quem votou, as pessoas teriam receio de dar negativo justamente para n√£o se expor, evitar persegui√ß√µes e/ou ser mal vista. E a√≠ poder√≠amos ter posts horr√≠veis, cheios de desinforma√ß√£o e que s√≥ desensinam (ou ainda spam e outras coisas fora das regras do site), e mesmo assim n√£o teriam nenhum negativo.

Vc mencionou o facebook, mas √© um site completamente diferente. Primeiro que n√£o tem voto negativo, e segundo que a ideia l√° √© diferente (no TabNews a ideia toda √© avaliar o valor concreto, a relev√¢ncia do post - ou pelo menos deveria ser). O negativo serve para indicar problemas no conte√∫do (por exemplo, algo que cont√©m muitos erros, ou que vai contra as regras do site, etc). No facebook qualquer porcaria recebe voto, sem crit√©rio algum.

Enfim, n√£o existe sistema perfeito. Mas o tabnews tem a **vantagem de poder aprender com os erros dos sites j√° existentes** (todos com anos de exist√™ncia, e o principal, com milh√µes de usu√°rios, ou seja, seus sistemas de vota√ß√£o j√° foram testados na pr√°tica em larga escala). Ou seja, d√° para saber o que funciona e o que n√£o funciona, e escolher a melhor op√ß√£o baseado no que queremos que o site seja. Dito isso, dados os [objetivos do site](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa), acho que expor os votos √© a pior das op√ß√µes.

>> Coment√°rio de rodrigoKulb:
√ìtimo ponto pessoal!

Como sempre gosto de levantar um pequeno benchmarking, para seguir com uma opini√£o:

<table>
 <tr>
 <th>Site</th> <th>Voto Positivo</th><th>Voto Negativo</th><th>N√£o apresenta</th>
 </tr>
 <tr>
 <td>Stackoverflow</td> <th>-</th><th>-</th><th>1</th>
 </tr>
 <tr>
 <td>Youtube</td> <th>-</th><th>-</th><th>1</th>
 </tr>
 <tr>
 <td>**Instagram</td> <th>1</th><th>-</th><th>-</th>
 </tr>
 <tr>
 <td>Facebook</td> <th>1</th><th>-</th><th>-</th>
 </tr>
 <tr>
 <td>Github</td> <th>1</th><th>-</th><th>-</th>
 </tr>
 <tr>
 <th>Total</th> <th>3</th><th>-</th><th>2</th>
 </tr>
</table>

** opcional para quem habilitar a op√ß√£o.

Uma coisa √© clara, nenhum site levantado aqui apresenta quem fez o **voto negativo**, conforme o @hkotsubo comentou, acredito que exibir as pessoas que deram votos negativos pode acabar expondo e fazer com que as pessoas n√£o votem de forma verdadeira, com medo de receber uma retalia√ß√£o.

De todos os sites, o Stackoverflow √© o mais pr√≥ximo do tabnews, com o sistema de up-vote e down-vote. E n√£o apresenta nenhum nome dos votos.

Acredito que podemos pensar em manter como uma **funcionalidade administrativa**, para membros moderadores. Desta forma facilitando a gest√£o de forma **mais r√°pido** at√© porque essas pessoas j√° possuem essa informa√ß√£o olhando na base de dados.

Outro ponto que gostaria de sugerir aqui, seria deixarmos um tempo para cr√©dito das tabcoins, igual funciona no mercado de a√ß√µes. Se eu comprar e vender as a√ß√µes no mesmo dia. Minha venda ter√° 2 dias para ser creditada.

Desta forma vamos conseguir dificultar ainda mais a manipula√ß√£o dos cr√©ditos para ser utilizado de forma imediata.

>> Coment√°rio de eletroswing:
@hkotsubo @rodrigoKulb  Entendi perfeitamente! Caso fosse implementado, como fun√ß√£o de modera√ß√£o, poderia mostrar todos os tabcoins como se fosse uma tabela de transa√ß√µes de um post? E em rela√ß√£o ao """sistema de a√ß√µes""", se refere ao tabcash?

>> Coment√°rio de rodrigoKulb:
> E em rela√ß√£o ao """sistema de a√ß√µes""", se refere ao tabcash?

N√£o, aos tabcoins mesmo, resumindo seria n√£o creditar imediatamente os tabcoins, dar um prazo de 24hrs para ser creditados. Desta forma as pessoas maliciosas n√£o v√£o conseguir ganhar os tabcoins na mesma hora, precisando aguardar 24hrs.

Exemplo abaixo essa nomenclatura em a√ß√µes chama D+1 D+2

![Captura de tela em 2023-03-13 12-36-30](https://user-images.githubusercontent.com/5334261/224751326-355660ef-cf15-4f29-bd89-1191de0d461b.png)

>> Coment√°rio de hkotsubo:
> Caso fosse implementado, como fun√ß√£o de modera√ß√£o, poderia mostrar todos os tabcoins como se fosse uma tabela de transa√ß√µes de um post?

No caso de ser uma fun√ß√£o de modera√ß√£o, seria uma interface somente para os moderadores, mas a√≠ teria que pensar exatamente o que eles deveriam ver (pois depende muito do que a gente quer que eles analisem). Enfim, acho que seria o caso de abrir outra issue espec√≠fica pra discutir em mais detalhes.

>> Coment√°rio de aprendendofelipe:
Com rela√ß√£o a mostrar quem qualificou, eu tamb√©m n√£o acho boa ideia. Inclusive dever√≠amos deixar claro que essa informa√ß√£o nunca ser√° revelada publicamente para aumentar as chances dos votos serem unicamente baseados na qualidade do conte√∫do.

E nem mesmo os votos positivos deveriam ser p√∫blicos, pois isso tamb√©m pode influenciar comportamentos como votos de retribui√ß√£o por outros votos.

Os abusos mais simples devem ser evitados pela issue #1166, mas para facilitar a detec√ß√£o de outros abusos, acho que podemos mostrar os votos positivos e negativos agrupados por hor√°rio e faixa de IP, sem mostrar a hora exata e nem o IP. Talvez isso poderia come√ßar apenas vis√≠vel para moderadores, e se nenhum problema surgir, ent√£o deixar isso p√∫blico. Mas poder ver o username de quem votou, acho que s√≥ moderadores com feature espec√≠fica poderiam ter acesso a essa informa√ß√£o.

J√° sobre outras quest√µes citadas, acredito que mostrar para o pr√≥prio usu√°rio se ele j√° votou em um conte√∫do √© algo importante que deve ser implementado futuramente, mas n√£o precisa ser nessa milestone, j√° que com a limita√ß√£o de 1 voto por conte√∫do o usu√°rio j√° ter√° essa informa√ß√£o caso tente votar novamente.

>> Coment√°rio de aprendendofelipe:
Que tal darmos a seguran√ßa para os usu√°rios que qualificam os conte√∫dos de que seus votos nunca ser√£o revelados? Podemos encerrar essa issue?

Futuramente podemos fazer duas implementa√ß√µes que tem alguma rela√ß√£o, mas que acredito serem saud√°veis:

1. Quando um usu√°rio visualizar uma publica√ß√£o, mostrar se ele j√° qualificou essa publica√ß√£o.
2. Pensando em identificar poss√≠veis abusos, mostrar no perfil dos usu√°rios como est√° a distribui√ß√£o de seus votos (os dados e os recebidos).

No item 2, n√£o precisa mostrar em quem o usu√°rio votou e nem se foram votos positivos ou negativos. Apenas com a informa√ß√£o da distribui√ß√£o j√° √© poss√≠vel identificar comportamentos abusivos, pois se os votos estiverem concentrados em um ou poucos autores, √© um ind√≠cio de que est√° ocorrendo algum tipo de manipula√ß√£o.

Talvez s√≥ mostrar essa informa√ß√£o ap√≥s uma certa quantidade de votos, pois essa an√°lise s√≥ √© v√°lida com quantidade significativa de votos.

Esse tipo de informa√ß√£o tamb√©m pode ser utilizada por mecanismos autom√°ticos que detectam fraudes no TabNews.

Essas duas implementa√ß√µes podem ficar para um momento mais adiante. O que eu acho importante √© garantir que os votos nunca ser√£o revelados e que apenas mecanismos automatizados ou moderadores poder√£o confirmar fraudes nas qualifica√ß√µes.

>> Coment√°rio de Rafatcb:
Acho que faz sentido fechar o issue sim. Atualmente a p√°gina [Status](https://www.tabnews.com.br/status) (para os moderadores) cumpre parte da necessidade de visualizar quem votou em determinada publica√ß√£o, podendo investigar mais a fundo quando necess√°rio por ferramentas fora do site.

Os PRs relacionados s√£o:

* https://github.com/filipedeschamps/tabnews.com.br/pull/1531
* https://github.com/filipedeschamps/tabnews.com.br/pull/1533
* https://github.com/filipedeschamps/tabnews.com.br/pull/1541
</issue_1167_Mostrar quem qualificou uma publica√ß√£o>

<issue_1168_Parar de calcular TabCoins e TabCash na hora de injetar a sess√£o (e outros lugares)>
## Contexto

Todo endpoint que injeta a sess√£o do usu√°rio puxa do banco para a mem√≥ria da aplica√ß√£o o objeto inteiro do usu√°rio, e isto inclui calcular as `tabcoins` e `tabcash` deste usu√°rio, mesmo que isto n√£o seja usado. Na verdade, na menor parte das vezes que um usu√°rio √© requisitado do banco n√≥s usamos as propriedades `tabcoins` e `tabcash`, ent√£o vou sugerir algo interessante na Execu√ß√£o:

## Execu√ß√£o

Em primeiro lugar, ao injetar uma sess√£o, o usu√°rio inteiro √© puxado aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/authentication.js#L41

Sendo que a √∫nica coisa que usamos, nesse caso, √© a propriedade `features` logo abaixo no `authorization`.

Ent√£o minha sugest√£o √© **nunca** retornar as `tabcoins` e `tabcash` nos m√©todos de busca do `user`, a n√£o ser que isso seja explicitamente requisitado.

### Os m√©todos de `user` que sugiro mexer por enquanto

**`findOneByUsername`**
https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/user.js#L28

**`findOneByEmail`**
https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/user.js#L66

**`findOneById`**
https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/user.js#L105

### Outros m√©todos

Destaco estes 3 ali de cima, pois tem outros, mas n√£o acho que seja importante mexer nisso agora:

**`removeFeatures`**
https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/user.js#L505

**`addFeatures`**
https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/user.js#L566

>> Coment√°rio de gSarciotto:
Tem alguem fazendo isso ou posso pegar?

>> Coment√°rio de aprendendofelipe:
> Tem alguem fazendo isso ou posso pegar?

Oi @gSarciotto, mesmo se j√° tiver algu√©m implementando, nada impede de voc√™ tamb√©m fazer. üëç

Quando temos PRs parecidos abertos, podemos comparar as solu√ß√µes e at√© mesmo aproveitar parcialmente cada uma, se for necess√°rio.

>> Coment√°rio de aprendendofelipe:
Atividade conclu√≠da nos PRs #1396 e #1439
</issue_1168_Parar de calcular TabCoins e TabCash na hora de injetar a sess√£o (e outros lugares)>

<issue_1169_Otimiza√ß√£o de query: `findChildrenTree()` e similares>
## Contexto

Hoje, se eu n√£o me engano, a query mais pesada do sistema inteiro √© esta aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/content.js#L772

Ela monta a √°rvore de respostas de um conte√∫do e, para isso, de forma recursiva ela vai calculando a rela√ß√£o entre os conte√∫dos usando o `parent_id` e isto √© bastante pesado dependendo da quantidade de intera√ß√µes que uma publica√ß√£o receber.

Al√©m disto, este tipo de recurs√£o √© utilizada em outras situa√ß√µes, como por exemplo contar a quantidade de coment√°rios:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/models/content.js#L124-L151

H√° outros lugares dentro deste model que calculamos a quantidade de filhos para colocar em `children_deep_count`.

## Execu√ß√£o

Com isto, sugiro adicionar um novo campo `root_id` na tabela `contents` que cont√©m e **congela** o `id` do primeiro conte√∫do (o conte√∫do `root`), onde este `id` √© replicado para todos os conte√∫dos `children`, para depois colocar um √≠ndice e adicionar na recurs√£o a procura por este campo, onde eu especulo que ir√° acelerar muito o retorno da consulta.

E destaco o fato de "congelar" o `id` no `root_id`, pois hoje a nossa √°rvore de conte√∫dos √© flu√≠da, onde ao alterar o `parent_id` de uma publica√ß√£o existente voc√™ pode mover um n√≥ de conte√∫do de uma discuss√£o para outra. Altas feature massa **que nunca foi usada** e acabou sendo uma otimiza√ß√£o prematura (e que pode ser solucionada de outra formas melhores).

Ent√£o devemos remover a possibilidade de algu√©m conseguir fazer um `PATCH` com essa propriedade, e isto ir√° quebrar todos os testes que envolvem `"parent_id"`, como este:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/patch.test.js#L2612

E para fazer isso, eu iniciaria pelo controller que recebe o `PATCH`. O `body` que √© enviado na request passa por essa valida√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/pages/api/v1/contents/%5Busername%5D/%5Bslug%5D/index.public.js#L68-L75

Onde neste caso, basta remover por completo a linha `parent_id: 'optional'` que ir√° fazer o validator remover esta propriedade antes de passar para frente. Ent√£o a primeira coisa que eu faria √© remover esta linha, rodas os testes e ver o que acontece (e como avan√ßar dali para frente). Por √∫ltimo, eu escreveria um novo teste para provar que enviar um `parent_id` n√£o faz nada com o conte√∫do.

E por hora, o `root_id` n√£o precisa ser retornado na interface p√∫blica da API eu especulo, e seria apenas um recurso interno para otimiza√ß√£o.

Esta altera√ß√£o envolve anunciar uma Breaking Change na API antes de ser aplicada, mas que n√£o ser√° um problema, pois novamente, eu especulo que ningu√©m esteja utilizando esta feature.

>> Coment√°rio de FabricioFFC:
Fiz um teste com o `root_id` e realmente o ganho √© muito bom. Al√©m disso, com ele conseguimos tirar a complexidade do `RECURSIVE` e problemas de performance caso a recurs√£o da √°rvore de `contents` seja grande.

Compara√ß√£o dos resultados dos tempos do `explain`:

|  | Planning time | Execution time |
|--------|--------|--------|
| [Query atual](https://explain.depesz.com/s/8d2a) | 0.360 ms | 1.537¬†ms |
| [Query usando o `root_id`](https://explain.depesz.com/s/18qt) | 0.154 ms | 0.170 ms |

E vale adicionar, que rodei o `explain` com diferentes tamanhos da √°rvore, e conforme ela vai crescendo, a query atual vai degradando, enquanto a query usando o `root_id` n√£o degrada, justamente por n√£o ter o uso da recurs√£o.

>> Coment√°rio de filipedeschamps:
Cara que sensacionaaaal!!!!! Isso vai ser uma das maiores contribui√ß√µes de performance da Milestone e vai dar para habilitar novamente o autorefresh dos conte√∫dos das listas üéâüéâüéâ

>> Coment√°rio de aprendendofelipe:
Turma, andei estudando como otimizar essas consultas, e eliminar as recursivas, e chegue na conclus√£o de que a solu√ß√£o `materialized_path` vai nos atender bem melhor.

Basicamente vamos ter uma coluna do tipo `uuid[]` com todos os `id` superiores ao conte√∫do, do `root_id` at√© o `parent_id`, ao inv√©s de ter apenas o `root_id`. E a cada novo filho que for adicionado s√≥ ser√° preciso concatenar com o array do seu pai. N√£o muito diferente do que ir√≠amos fazer com `root_id`, que era s√≥ usar o mesmo dado do pai.

S√≥ que com isso podemos buscar qualquer √°rvore, pois √© s√≥ filtrar como `WHERE 'conten_id' = ANY(materialized_path)`, o que deve ser muito eficiente com um √≠ndice `gin`.

O que acham?

>> Coment√°rio de filipedeschamps:
Continuando o que foi escrito no https://github.com/filipedeschamps/tabnews.com.br/pull/1413#issuecomment-1549032070

> A complexidade das duas implementa√ß√µes √© a mesma, mas as vantagens s√£o muito maiores para `materialized_path`, pois poderemos buscar qualquer trecho da √°rvore de coment√°rios sem precisar de recursiva.

Geniaaaaal!!!! Faz total sentido!

Minha √∫nica preocupa√ß√£o √© o quanto isto vai otimizar no tempo de toda a request (considerando a entrada dos √≠ndices). Comecei a me perguntar isso depois dos testes l√° no reposit√≥rio do curso, onde montar a √°rvore de filhos era a parte mais r√°pida.

Ent√£o o que acha de tamb√©m implementarmos um log de trace, marcando o tempo, e que seja poss√≠vel criar um gr√°fico no Axiom de cada trecho do c√≥digo? Eu n√£o sei se o Axiom consegue plotar isso, mas se conseguir, seria muito interessante revelar de forma concreta qual a parte que est√° precisando de mais otimiza√ß√£o ü§ù

>> Coment√°rio de aprendendofelipe:
> Ent√£o o que acha de tamb√©m implementarmos um log de trace, marcando o tempo, e que seja poss√≠vel criar um gr√°fico no Axiom de cada trecho do c√≥digo? Eu n√£o sei se o Axiom consegue plotar isso, mas se conseguir, seria muito interessante revelar de forma concreta qual a parte que est√° precisando de mais otimiza√ß√£o ü§ù

Eu acho uma boa, e tinha pensado justamente nisso pra gente entender o PR 18 do curso.dev ü§ù

>> Coment√°rio de FabricioFFC:
Me parece uma boa solu√ß√£o tbm, e atende a necessidade de filtrar n√£o necessariamente pelo `root_id`.

Ainda mais que acredito que o `path` n√£o muda ap√≥s a cria√ß√£o do `content`, pois seria custoso remontar esse `path` com frequ√™ncia.

>> Coment√°rio de aprendendofelipe:
> Ainda mais que acredito que o `path` n√£o muda ap√≥s a cria√ß√£o do `content`, pois seria custoso remontar esse `path` com frequ√™ncia.

Exato! Desde esse commit https://github.com/filipedeschamps/tabnews.com.br/commit/d0b8d00ba34af1bdba40e542f88eff08c8f3874b n√£o √© mais poss√≠vel alterar o `parent_id` de um conte√∫do, ent√£o o `path` tamb√©m nunca vai mudar. Mas mesmo se precisar alterar todos os filhos de um coment√°rio, caso um dia volte a ser poss√≠vel mudar o `parent_id`, ainda vai valer a pena usar o `path`, pois as leituras s√£o em quantidade muito maior do que as grava√ß√µes.

Aproveitando... O `path` resolve a busca de todos os filhos sem precisar da recursiva, mas ainda precisamos lidar com duas coisas:

1. Caso exista um coment√°rio exclu√≠do que possua filhos ainda publicados, esses filhos ser√£o retornados usando a consulta pelo `path`. D√° pra gente excluir eles na sequ√™ncia, mas eu acho que poder√≠amos manter esses filhos no retorno e montar a √°rvore mostrando onde houver respostas para coment√°rios j√° exclu√≠dos. Assim esses coment√°rios n√£o ficam totalmente √≥rf√£os. 

2. Para poder paginar os coment√°rios precisamos ter uma forma padr√£o de ordena√ß√£o deles. No #1413 estou usando um outro array para isso (por enquanto √© montado na recursiva). √â parecido com o array do `path`, mas colocando todos `published_at` acima do item, desde o `root`. Assim d√° pra classificar por data ao mesmo tempo que mant√©m a estrutura da √°rvore. Obs.: Desde o commit https://github.com/filipedeschamps/tabnews.com.br/commit/d66a049d7ab48c459056161c473beca9af90c58c o `published_at` tamb√©m ficou um campo fixo ap√≥s a primeira publica√ß√£o.

>> Coment√°rio de filipedeschamps:
> 1. Caso exista um coment√°rio exclu√≠do que possua filhos ainda publicados, esses filhos ser√£o retornados usando a consulta pelo `path`. D√° pra gente excluir eles na sequ√™ncia, mas eu acho que poder√≠amos manter esses filhos no retorno e montar a √°rvore mostrando onde houver respostas para coment√°rios j√° exclu√≠dos. Assim esses coment√°rios n√£o ficam totalmente √≥rf√£os.

Exato! O princ√≠pio disso acontece quando um coment√°rio pai foi deletado, e voc√™ acessa o filho (aparece como "n√£o dispon√≠vel"):

https://www.tabnews.com.br/filipedeschamps/d23e15c0-419c-4a71-9124-89780a8a8936

Acessando esse conte√∫do ali de cima pela API, mas acessando o `/parent` dele:

https://www.tabnews.com.br/api/v1/contents/filipedeschamps/d23e15c0-419c-4a71-9124-89780a8a8936/parent

Isto √© feito no filtro de sa√≠da:

https://github.com/filipedeschamps/tabnews.com.br/blob/c67630d1719ea82058f6fe7cf4a6492a1ae00f89/models/authorization.js#L233-L239

Eu topo total ent√£o fazer retornar todos os conte√∫dos, mas filtrar eles na sa√≠da ü§ù

>> Coment√°rio de aprendendofelipe:
Testei o desempenho com  as diversas possibilidades de busca de todos os filhos de um conte√∫do e o resumo dos resultados s√£o:

1. Usar `root_id` com ou sem √≠ndice apresentou praticamente os mesmos tempos de execu√ß√£o da recursiva atual.
2. J√° usando `materialized_path` melhorou de formas diferentes.
3. Filtrando por `WHERE 'uuid' = ANY(path)` o √≠ndice n√£o faz diferen√ßa (nunca √© utilizado), mas o tempo de execu√ß√£o j√° cai para metade.
4. Filtrando por `WHERE path @> ARRAY['uuid']::uuid[]` **sem criar o √≠ndice** diminui o tempo de execu√ß√£o um pouco mais do que usando `ANY`.
5. Agora usando `@>` junto do √≠ndice gin no `uuid[]` a redu√ß√£o do tempo de execu√ß√£o foi de cerca de 100x üöÄ

Obs. Pela pequena quantidade de linhas no banco durante meus testes (74), rodei tudo usando `ENABLE_SEQSCAN = OFF`.

Ent√£o vou criar o PR usando `path::uuid[]` j√° com o √≠ndice gin üëç

>> Coment√°rio de aprendendofelipe:
[Edit 2] As primeiras otimiza√ß√µes come√ßaram nos PRs #1400 e #1403...

Com a implementa√ß√£o do caminho materializado e a utiliza√ß√£o da coluna `path` em todos os locais onde utiliz√°vamos recursivas, os PRs #1419, #1421 e #1426 concluem o que era proposto nessa issue üöÄ

[Edit] O PR #1431 corrige o bug causado por conte√∫do √≥rf√£o assumindo lugar do conte√∫do root
</issue_1169_Otimiza√ß√£o de query: `findChildrenTree()` e similares>

<issue_1170_Aumentar prote√ß√£o nos processos de Cadastro e Login>
## Contexto

Apesar de que hoje temos um Firewall que, na medida do poss√≠vel, identifica abusos e desfaz opera√ß√µes, √© interessante dificultarmos abusos (por automa√ß√µes) e com isso veio a id√©ia de implementar um CAPTCHA na hora do Cadastro e Login.

## Execu√ß√£o

Dois pontos a se considerar:

### Seguran√ßa VS Usabilidade

Aqui batemos naquela velha hist√≥ria de, quanto mais seguro um sistema √©, pior √© a usabilidade dele. Ent√£o sugiro n√£o destruirmos a usabilidade simples do TabNews e implementar um CAPTCHA que seja simples de resolver, como aquele de dar um √∫nico clique ou qualquer outra forma que seja simples. Mas a minha preocupa√ß√£o n√£o √© com o client do TabNews, mas sim com clients externos.

### Clients externos

O que fazer neste caso? Pois hoje √© t√£o simples bater na API e criar um usu√°rio, ou criar uma sess√£o. Ao implementar este recurso n√≥s iremos destruir esta funcionalidade para clientes que n√£o possuem uma interface convencional, como um `TUI` (Text-based user interface).

>> Coment√°rio de filipemoraes:
Uma das solu√ß√µes para o frontend do Tabnews seria utilizar o [reCAPTCHA v3](https://developers.google.com/recaptcha/docs/v3) que sequer necessita de qualquer resolu√ß√£o por parte do utilizador. A vers√£o 3 retorna um token e associado a esse token um score com base na intera√ß√£o. Com o token enviado pelo frontend, no backend (atrav√©s da API do Google) √© poss√≠vel recuperar qual o score e decidir se o pedido segue em frente ou ser√° bloqueado. O bom dessa vers√£o √© que o propriet√°rio do software decidi at√© que ponto est√° disposto a arriscar pedidos com baixo score. Outro ponto positivo √© que o utilizador n√£o √© "atormentado" com aquela modal para resolver praticamente um enigma e sequer precisa dar um check em um checkbox e declarar que n√£o √© um bot, √© tudo em background.

### Clients externos
Uma vez que o Tabnews tamb√©m √© utilizador da pr√≥pria API, outra solu√ß√£o seria o utilizador definir um token na √°rea privada e utilizar esse token nos requests. Utilizo essa solu√ß√£o em servi√ßo de terceiros, onde preciso registrar um access token na √°rea de cliente para poder utilizar na API e esse token est√° limitado a X requests por segundo.

### Como utilizar o token na API de cadastro se preciso ter uma conta com um token v√°lido?
Presumo que essa funcionalidade ser√° utilizada por terceiros que j√° estejam previamente registados no Tabnews e com um token v√°lido. O token representa um client v√°lido e que est√° associado a uma conta v√°lida no Tabnews.

### Mesclar as 2 solu√ß√µes
Uma outra solu√ß√£o seria utilizar as 2 op√ß√µes, reCaptcha ou access token. A API poderia identificar se o request possui uma das 2 propriedades e decidir qual strategy utilizar. Para interface gr√°fica espera-se um recaptcha token, via TUI espera-se um access token.

>> Coment√°rio de rodrigoKulb:
Podemos montar um CAPTCHA pr√≥prio que brinca com o usu√°rio, basicamente montando palavras de tecnologia, exemplo:

- php mysql
- banco de dados
- javascript
- postgre

N√£o iria diferenciar caixa alta de caixa baixa. E o resultado dessa API poderia ser ID e um base64 com a imagem contendo o texto da frase. Assim os clientes que utilizaram a API tamb√©m podem utilizar o CAPTCHA!

Apenas completando desta forma vamos bloquear o cadastro / login via rob√¥, ent√£o se algu√©m utilizar a API para cadastro ou login precisar√° de uma pessoa para validar o CAPTCHA.

>> Coment√°rio de eletroswing:
@rodrigoKulb @aprendendofelipe 
> Podemos montar um CAPTCHA pr√≥prio que brinca com o usu√°rio, basicamente montando palavras de tecnologia, exemplo:

Indo um pouco para aspectos t√©cnicos. Tipo, ter uma tabela s√≥ de captchas onde tenho um 'id', o valor, se foi ou n√£o validado podendo ser um enum tipo "n√£o usado", "Invalidado", "Valido" e a conta associada? Assim poderia ter uma m√©trica disso, ou sem alguns campos ou at√©, sem uma tabela em banco de dados?

>> Coment√°rio de aprendendofelipe:
> Apesar de que hoje temos um Firewall que, na medida do poss√≠vel, identifica abusos e desfaz opera√ß√µes, √© interessante dificultarmos abusos (por automa√ß√µes) e com isso veio a id√©ia de implementar um CAPTCHA na hora do Cadastro e Login.

Acho que essa ideia foi antes de conseguirmos bloquear totalmente qualquer acesso direto sem passar pela Cloudflare, ou n√£o foi?

Agora que n√£o tem como desviar da Cloudflare, ser√° que vamos conseguir implementar algo melhor do que o servi√ßo deles? Ou o "implementar" era no sentido de adotar algum servi√ßo do tipo, e n√£o desenvolver algo pr√≥prio?

Se era no sentido de adotar algum servi√ßo, ent√£o j√° est√° feito, pois a Cloudflare j√° identifica e bloqueia os bots, e com impacto quase nulo na experi√™ncia dos usu√°rios.

N√£o acho que valha a pena prejudicar a experi√™ncia dos usu√°rios, sendo que, a princ√≠pio, j√° estamos protegidos em certo n√≠vel contra abusos envolvendo bots, e o melhor √© que ainda permitimos bots que n√£o abusam, como as automa√ß√µes justific√°veis, sejam da Turma ou indexadores, e tamb√©m os aplicativos desenvolvidos pela Turma.

N√£o acho que essa prote√ß√£o da Cloudflare seja perfeita, longe disso, mas acho invi√°vel implementarmos algo com um equil√≠brio melhor.

Caso a ideia seja mesmo implementar algo pr√≥prio, ent√£o alguns pontos que devem ser observados s√£o:

- Permitir a ado√ß√£o opcional por um per√≠odo razo√°vel para dar oportunidade aos aplicativos da Turma se adequarem;
- Para manter a acessibilidade, √© preciso ter diferentes vers√µes, como em √°udio e imagem;
- Precisa ter m√©tricas para sabermos se o sistema est√° sendo efetivo na prote√ß√£o ao mesmo tempo que n√£o est√° prejudicando demais a experi√™ncia dos usu√°rios;
- Enquanto n√£o houver dados suficientes para sabermos que n√£o estamos impedindo acessos leg√≠timos, deve ser f√°cil ignorar o captcha.
- A parte p√∫blica da implementa√ß√£o n√£o pode facilitar burlar a prote√ß√£o.

>> Coment√°rio de aprendendofelipe:
Encerrando a issue devido a implementa√ß√£o do Turnstile no PR #1613.
</issue_1170_Aumentar prote√ß√£o nos processos de Cadastro e Login>

<issue_1171_Implementar Two Factor>
## Contexto

N√£o sei se o Two Factor precisa de muito contexto, mas no que trata do TabNews, devemos poder oferecer isso no Login e na altera√ß√£o de dados cadastrais.

## Execu√ß√£o

- O @coffee-is-power iniciou uma implementa√ß√£o sobre Two Factor no PR #929
- Em paralelo, o @Diegiwg iniciou uma implementa√ß√£o de pedir a senha ao alterar um dado cadastral no PR #1104

Ao alterar um dado cadastral, a gente deveria pedir o Token do Two Factor, ou a senha? O mais seguro √© o Token, correto?

>> Coment√°rio de cybernerd007:
bom tendo em vist√° os ataques recentes do youtubers onde se era roubado a sess√£o e mesmo tendo a verifica√ß√£o em 2 etapas ativas era possivel logar usando a sess√£o roubada, recomendo aqui diminuir a vida ultil da sess√£o do usuario (cookie) assim seria uma SOLU√á√ÉO PALEATIVA PARA EVITAR FUTURAS DORES DE CABE√áA para caso ocorra o roubo de sess√£o dificilmente isso traga um impacto maior ao usuario final.

> Ao alterar um dado cadastral, a gente deveria pedir o Token do Two Factor, ou a senha? O mais seguro √© o Token, correto?

Recomendo pedir os 2 assim como faz o Github quando √© solicitado a exclus√£o de um repositorio, primeiro pede a senha em sequencia pede o token...

o que acha?

>> Coment√°rio de filipedeschamps:
Nas vezes que o GitHub me pede uma segunda autentica√ß√£o, recentemente ele me pede por padr√£o o Token, mas se eu quiser, posso ignorar e colocar apenas a Senha. Acho que pedir a Senha e o Token atrapalha demais a UX.

O que acha de, se o Two Factor estiver desabilitado, pede s√≥ a senha, e se estiver habilitado, pede s√≥ o token?

>> Coment√°rio de cybernerd007:
> Nas vezes que o GitHub me pede uma segunda autentica√ß√£o, recentemente ele me pede por padr√£o o Token, mas se eu quiser, posso ignorar e colocar apenas a Senha. Acho que pedir a Senha e o Token atrapalha demais a UX.
> 
> O que acha de, se o Two Factor estiver desabilitado, pede s√≥ a senha, e se estiver habilitado, pede s√≥ o token?

Show!! Perfeito dessa forma..

>> Coment√°rio de coffeeispower:
Deve ser f√°cil adicionar isso no meu pr.

Tamb√©m uma coisa que ficou meio estranho e que ele adiciona a caixa do c√≥digo no login, acho que seria melhor um dialog, eu vou ver isso depois....

>> Coment√°rio de Rafatcb:
O token do segundo fator de autentica√ß√£o ser√° um c√≥digo enviado via e-mail ou um [TOTP](https://en.wikipedia.org/wiki/Time-based_one-time_password)? Eu estava pesquisando sobre isso agora, e acho que um TOTP traz mais complexidade do que benef√≠cios (digo isso tendo em mente que o issue surgiu no fim de 2022 e estamos no in√≠cio de 2024):

* A maioria das bibliotecas que vi que lidam com isso n√£o possuem atualiza√ß√µes h√° anos, apesar de terem PRs ou Issues abertos.
* Ser√° necess√°rio ter c√≥digos de recupera√ß√£o para conseguir acessar a conta sem ter o TOTP (importante caso o usu√°rio tenha perdido acesso ao dispositivo que cont√©m a chave, por exemplo). Alguns exemplos de sites que usam isso s√£o o GitHub, NPM, LinkedIn, Microsoft, Discord etc.
* Pergunta e resposta no FAQ para orientar o usu√°rio que ficar "trancado para fora" da conta.
* Apesar dos cuidados citados nos √∫ltimos t√≥picos, possivelmente teria um pequeno aumento na necessidade de suporte via e-mail. Se considerarmos que um humano poderia liberar a conta, ent√£o surgiria um novo risco com golpes de engenharia social.

Tamb√©m pesquisei sobre [passkeys](https://safety.google/authentication/passkey/) e parece que isso poderia ser usado como um 2FA. Citando [essa p√°gina do Google](https://support.google.com/accounts/answer/13548313?hl=pt):

> Caso sua conta use a verifica√ß√£o em duas etapas ou se estiver inscrita no Programa Prote√ß√£o Avan√ßada, uma chave de acesso n√£o precisar√° passar pela segunda etapa de autentica√ß√£o, porque ela confirma que o dispositivo est√° em sua posse.

Eu (acho que) nunca usei passkeys, ent√£o n√£o sei dizer quais mecanismos de fallback costumam ser usados no cen√°rio de 2FA caso o usu√°rio n√£o tenha um passkey no dispositivo. As grandes empresas (Google, Microsoft) costumam ter v√°rias formas de autentica√ß√£o (MFA), mas acho que para n√≥s, se/quando formos adicionar uma, o ideal √© escolher a com maior custo-benef√≠cio: a que trar√° menos complexidade ao mesmo tempo que adicionar√° uma nova camada de seguran√ßa.

>> Coment√°rio de coffeeispower:
Mas tambem perder o TOTP √© tipo fechar a gaveta a chave com a chave la dentro, o usuario tem que ter cuidado com isso. Os aplicativos de TOTP evoluiram para evitar isso por exemplo com backups na cloud como no proton pass. Mas acho que da pra implementar os dois e deixar a pessoa escolher como no github.

As bibliotecas de TOTP n√£o tem atualiza√ß√µes n√£o por falta de manuten√ß√£o mas porque simplesmente est√£o acabados, sei que voc√™s tao habituados a cada semana tem um framework da moda mas n√£o √© esse o caso, TOTP √© uma coisa bem estavel, uma vez implementado n√£o precisa ser alterado. Imagina se futebol mudasse o campo de futebol ou a bola todos os anos porque sen√£o consideram um jogo abandonado, j√° teria acabado faz tempo.

>> Coment√°rio de ravenastar-js:
V√°rios especialistas da √°rea de seguran√ßa informam que o uso de 2FA √© importante, pois com 2FA ativado vai inviabilizar / mitigar a maioria de invas√µes / ataques de usu√°rios mal-intencionados nas contas de terceiros, a realidade √© que hoje em dia h√° muitos vazamentos de dados, usu√°rios usam a mesma senha em v√°rias plataformas diferentes ( isso √© triste mas √© a realidade ), usam software pirata o que ocasiona v√°rios riscos de seguran√ßa e entre outras situa√ß√µes, com isso tudo j√° aumenta a chance de um invasor acessar a conta do usu√°rio com tentativa e erro em rela√ß√£o as informa√ß√µes vazadas, OSINT,  metadados e afins... 

Quando o usu√°rio tem 2FA ativado na conta dele, se o invasor tiver login + senha, s√≥ com esses dados o invasor n√£o consegue acessar 100% a conta do usu√°rio sem o c√≥digo TOTP, √≥bvio que os golpistas n√£o s√£o bobos √© melhoraram os golpes, eles sabem que essa seguran√ßa do 2FA √© bem eficaz, ent√£o por isso que eles usam o ataque "Session hijacking" que √© o roubo de sess√£o + engenharia social + phishing... Quando mais camadas de seguran√ßa pra dificultar a vida do invasor, melhor √©, **2FA trar√° seguran√ßa extra para conta do usu√°rio, n√£o complexidade**...

>> Coment√°rio de Rafatcb:
> Mas tambem perder o TOTP √© tipo fechar a gaveta a chave com a chave la dentro, o usuario tem que ter cuidado com isso. 

J√° vi um funcion√°rio de uma academia tendo que cortar um cadeado porque deixaram a chave dentro do arm√°rio. Quando voc√™ lida com pessoas, entende que esse tipo de situa√ß√£o √© bem menos incomum do que parece.

> As bibliotecas de TOTP n√£o tem atualiza√ß√µes n√£o por falta de manuten√ß√£o mas porque simplesmente est√£o acabados, sei que voc√™s tao habituados a cada semana tem um framework da moda mas n√£o √© esse o caso, TOTP √© uma coisa bem estavel, uma vez implementado n√£o precisa ser alterado.

Na verdade, n√£o √© isso. Como eu disse, as bibliotecas que citei possu√≠am v√°rios Issues e PRs abertos h√° anos. Seja para atualizar depend√™ncias (das bibliotecas que tinham), seja por outros motivos.

Veja, por exemplo, a biblioteca [otplib](https://github.com/yeojz/otplib): 37 issues, 48 pull requests e uma documenta√ß√£o offline desde 2020. Isso significa que o projeto n√£o √© mantido. O padr√£o TOTP √© bem estabelecido, mas isso n√£o significa que as bibliotecas n√£o tenham problemas. Inclusive, √© uma op√ß√£o implementarmos n√≥s mesmos a solu√ß√£o, se for necess√°rio, mas sempre tentamos evitar isso para n√£o gastar tempo naquilo que n√£o √© o foco do neg√≥cio.

Agora, veja a biblioteca [totp-generator](https://github.com/bellstrand/totp-generator). Ela existe h√° 8 anos, nenhum Issue ou PR aberto, e o √∫ltimo commit foi h√° duas semanas. Isso √© bom? Isso √© ruim? Precisa avaliar caso a caso. N√£o d√° para generalizar.

E existem v√°rias outras bibliotecas: [speakeasy](https://github.com/speakeasyjs/speakeasy), [otpauth](https://www.npmjs.com/package/otpauth), [otp-io](https://www.npmjs.com/package/otp-io), [notp](https://github.com/guyht/notp) etc.

> Os aplicativos de TOTP evoluiram para evitar isso por exemplo com backups na cloud

Sim, hoje est√° melhor do que um ano atr√°s, por exemplo, quando o Google Authenticator n√£o tinha backup.

> Imagina se futebol mudasse o campo de futebol ou a bola todos os anos porque sen√£o consideram um jogo abandonado, j√° teria acabado faz tempo.

Analogias assim n√£o s√£o agregam valor √† discuss√£o. O "futebol" n√£o faz nada, mas os times cuidam do gramado do campo e trocam ele, por exemplo. Recomendo a leitura: [Argument from analogy](https://en.wikipedia.org/wiki/Argument_from_analogy).

---

> V√°rios especialistas da √°rea de seguran√ßa informam que o uso de 2FA √© importante, pois com 2FA ativado vai inviabilizar / mitigar a maioria de invas√µes / ataques de usu√°rios mal-intencionados nas contas de terceiros

Essa frase precisa de refer√™ncias. 2FA √© literalmente qualquer coisa. O segundo fator de autentica√ß√£o pode ser enviar uma selfie para um e-mail do site e um humano avaliar e considerar v√°lida. A depender do m√©todo escolhido, voc√™ pode apenas ter aumentado a **falta de seguran√ßa** da sua conta. Por esse motivo, √© altamente n√£o recomendado usar 2FA com SMS, por exemplo.

> Quando o usu√°rio tem 2FA ativado na conta dele, se o invasor tiver login + senha, s√≥ com esses dados o invasor n√£o consegue acessar 100% a conta do usu√°rio sem o c√≥digo TOTP

Como eu disse neste e no meu primeiro coment√°rio, 2FA n√£o √© s√≥ TOTP, o envio de um token por e-mail tamb√©m √© 2FA.

---

N√£o me entendam mal. Eu uso TOTP para outros servi√ßos, como mencionei em meu primeiro coment√°rio, e todos me disponibilizam uma forma de "recuperar o TOTP", seja enviando fotos e documentos por e-mail, seja com os c√≥digos de recupera√ß√£o. [Essa resposta](https://security.stackexchange.com/a/241916/250104) fala mais sobre o assunto, mas praticamente n√£o adiciona nada novo ao que eu j√° disse.

>> Coment√°rio de ravenastar-js:
> Como eu disse neste e no meu primeiro coment√°rio, 2FA n√£o √© s√≥ TOTP, o envio de um token por e-mail tamb√©m √© 2FA.

Eu sei disso, hora alguma discordei de voc√™, s√≥ informei que 2FA √© importante, qualquer fator de seguran√ßa extra √© fudamental, por√©m n√£o implementar algo do tipo dar a entender que est√£o "negligenciando seguran√ßa".

>> Coment√°rio de cybernerd007:
Quero deixar uma sugest√£o de se o login for feito em um novo dispositivo que seja enviado um e-mail informando o login em um novo dispositivo, pois infelizmente os usu√°rios geralmente reciclam as senhas e utilizam a mesma em v√°rios servi√ßos que pode ser propensas a vazamento de dados...

Acredito que o Two Factor seja algo indispens√°vel porem "PODE" abrir algumas brechas porem rodarei os testes assim que implementado em homologa√ß√£o.

>> Coment√°rio de lspaulucio:
Fala pessoal, tudo certo com voc√™s?

Estava abrindo uma PR para adicionar TOTP no TabNews e vi que existia essa issue aberta.

Dei uma lida na discuss√£o de voc√™s e seguem algumas considera√ß√µes minhas:

Sobre o coment√°rio do @filipedeschamps 

> O que acha de, se o Two Factor estiver desabilitado, pede s√≥ a senha, e se estiver habilitado, pede s√≥ o token?
Concordo em partes com o Filipe.

Para mim no momento do login, caso o MFA esteja configurado, √© necess√°rio que seja solicitado tanto a senha quanto o token, visto que a ideia do MFA √© ter um outro fator para autenticar o usu√°rio. Caso pe√ßa um ou outro acaba que o MFA n√£o faz muito sentido pois acaba virando um e-mail e "senha/token".

Contudo, para um usu√°rio, que j√° esteja autenticado, realizar alguma altera√ß√£o interna no TabNews que precise de uma confirma√ß√£o/valida√ß√£o do usu√°rio,  acredito que solicitar a senha ou o token seja uma op√ß√£o v√°lida.


Sobre os coment√°rios do @Rafatcb 

> Ser√° necess√°rio ter c√≥digos de recupera√ß√£o para conseguir acessar a conta sem ter o TOTP (importante caso o usu√°rio tenha perdido acesso ao dispositivo que cont√©m a chave, por exemplo). Alguns exemplos de sites que usam isso s√£o o GitHub, NPM, LinkedIn, Microsoft, Discord etc.
Pergunta e resposta no FAQ para orientar o usu√°rio que ficar "trancado para fora" da conta.
Apesar dos cuidados citados nos √∫ltimos t√≥picos, possivelmente teria um pequeno aumento na necessidade de suporte via e-mail. Se considerarmos que um humano poderia liberar a conta, ent√£o surgiria um novo risco com golpes de engenharia social.

Na minha implementa√ß√£o eu n√£o utilizei c√≥digos de recupera√ß√£o para esses casos. O que fiz foi uma altera√ß√£o no fluxo de recupera√ß√£o de conta. Caso o usu√°rio perca o token, basta ele realizar o fluxo normal de recupera√ß√£o. Durante o processo o TOTP √© desabilitado e o usu√°rio precisa realizar a configura√ß√£o novamente.
N√£o pensei nessa quest√£o do FAQ, preciso incluir essa informa√ß√£o l√° :sweat_smile: 

Com rela√ß√£o as bibliotecas, confesso que n√£o tinha parado para analisar isso. Eu usei na implementa√ß√£o as bibliotecas [qrcode](https://www.npmjs.com/package/qrcode) e [otpauth](https://www.npmjs.com/package/otpauth). N√£o sei se foram as melhores op√ß√µes, escolhi elas porque foram uma das primeiras que encontrei pesquisando na internet.
Dei uma olhada r√°pida aqui e vi que a `otpauth` aparenta ser atualizada com frequ√™ncia, a √∫ltima altera√ß√£o foi h√° 19 dias e possui 1 issue. J√° a `qrcode` teve a √∫ltima altera√ß√£o a 1 ano e tem 64 issues abertas. Caso achem importante posso dar uma pesquisada mais a fundo para ver se encontro bibliotecas mais novas/utilizadas.

Sobre passkey, concordo que parece ser um tipo de MFA mais simples e mais agrad√°vel para o usu√°rio. Configurei passkey (n√£o cheguei a ver como funciona a fundo) no GitHub para testar e achei bem legal!!! Ele n√£o pede usu√°rio e senha, utiliza apenas o passkey configurado. Do ponto de vista do usu√°rio acho que √© mais atrativo, inclusive segue a ideia que o @filipedeschamps falou l√° no in√≠cio.
Talvez seja um m√©todo de MFA a ser implementado futuramente no TabNews em, o que acham? :smile: 

Mas mesmo com essas quest√µes de bibliotecas e complexidade levantadas sobre o TOTP, acho importante o TabNews ter um MFA dispon√≠vel para aumentar a seguran√ßa dos usu√°rios.
</issue_1171_Implementar Two Factor>

<issue_1172_Migrar RDS de `sa-east-1` para `us-east-1` (ou outro provider como Supabase)>
## Contexto

Hoje nosso banco de dados est√° hospedado na AWS e sendo servido pelo RDS, onde a inst√¢ncia de Produ√ß√£o est√° em SP (`sa-east-1`) conforme visto no arquivo do Terraform:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/infra/provisioning/production/main.tf#L18-L21

Por√©m como temos mais camadas em cima da API, por exemplo Cloudflare, n√£o sei se valeu a pena esta escolha, pois est√° muito caro. O fato de movermos para o `us-east-1` vai trazer um pouco mais de lat√™ncia, mas nada que ir√° atrapalhar os servi√ßos.

## Execu√ß√£o

N√£o fa√ßo a m√≠nima id√©ia de como fazer isso com pouco trabalho.

E infelizmente, eu coloquei o `state` do Terraform no mesmo arquivo e agora isto tamb√©m est√° grudado em `sa-east-1`:

https://github.com/filipedeschamps/tabnews.com.br/blob/0bbb0f655dc88847fa741001a83d3f3297bf01a1/infra/provisioning/production/main.tf#L9-L15

O que eu estava cogitando era:

1. Come√ßar do zero (com um `state` zerado), mas apontando tudo para `us-east-1`. Levantar a VPC, Banco, tudo l√°.
2. Colocar a API em "read only".
3. Fazer backup do banco que est√° em `sa-east-1`.
4. Migrar os dados para `us-east-1`.
5. Apontar as vari√°veis de ambiente para o novo banco em `us-east-1`.

## D√∫vidas

1. N√£o sei qual a forma mais f√°cil de migrar os dados de um banco para o outro, considerando que √© RDS. Algu√©m j√° teve experi√™ncia com isso?
2. E nessa migra√ß√£o, os √≠ndices s√£o levados/recalculados nessa nova inst√¢ncia?

>> Coment√°rio de cybernerd007:
Bom gostaria de lhe ajudar porem ja faz um bom tempo que n√£o mexo com a AWS mais deixo aqui alguns artigos da porpria AWS sobre esse assunto que pode lhe ajudar....

[Replicar backups automatizados para outra Regi√£o da AWS](https://docs.aws.amazon.com/pt_br/AmazonRDS/latest/UserGuide/USER_ReplicateBackups.html)
[RDS - Backups entre regi√µes ](https://disaster-recovery.workshop.aws/pt/services/databases/rds/rds-backup.html)
[Copiar um snapshot de banco de dados](https://docs.aws.amazon.com/pt_br/AmazonRDS/latest/UserGuide/USER_CopySnapshot.html)
[Migrar uma inst√¢ncia de banco de dados Amazon RDS para outra VPC ou conta](https://docs.aws.amazon.com/pt_br/prescriptive-guidance/latest/patterns/migrate-an-amazon-rds-db-instance-to-another-vpc-or-account.html)

Espero que isso te ajude...

>> Coment√°rio de Eduardo-Miguel:
Ol√°! Eu n√£o tenho experi√™ncia com mudan√ßa de zona na AWS. Mas nosso banco de dados est√° na us-east-1, pois achei mais em conta.
Por√©m, se eu precisasse fazer essa migra√ß√£o faria assim:
1¬∫ Criaria um banco na nova zona;
2¬∫ Escolheria um hor√°rio de menos trafego para pausar aplica√ß√£o;
3¬∫ Faria o backup do banco antigo;
4¬∫ Restauraria no banco novo; e
5¬∫ Apontaria para o banco novo e retomaria a aplica√ß√£o.

Acho que √© uma das melhores formas para n√£o perder nenhum dado durante a manuten√ß√£o.

>> Coment√°rio de aprendendofelipe:
Eu acho que o fluxo normal seria criar uma r√©plica cross region somente leitura do banco e depois promover a r√©plica.

Se existir algum impedimento e realmente for necess√°rio criar um novo banco e restaurar os dados, ent√£o que tal j√° aproveitar e migrar o banco para outro servi√ßo?

O  [Supabase](https://supabase.com) parece ser um √≥timo substituto, pois oferece muitas facilidades e cobra apenas um pouco mais do que a AWS.

Para o banco de dados, al√©m da conex√£o direta ao banco, ganhamos:

- REST;
- GraphQL;
- Realtime (websockets);
- PgBouncer.

E al√©m do banco, temos b√¥nus que ajudam em outras funcionalidades que podem ser implementadas futuramente, como:

- Edge Functions (que podemos usar para invalidar cache na Vercel, enviar emails, etc.);
- Armazenamento de arquivos (imagens);
- Social OAuth providers

O Supabase tamb√©m permitiria a t√£o solicitada busca de conte√∫dos, mas eu usaria outro servi√ßo para isso. Analisaria a [Xata](https://xata.io), mas da√≠ serviria n√£o s√≥ para a busca de conte√∫dos, mas tamb√©m como fonte de dados para a gera√ß√£o das p√°ginas est√°ticas e para alguns dos endpoints da API.

![image](https://user-images.githubusercontent.com/77860630/208991193-ccad570b-f607-456b-b782-dfe1c4bb3796.png)

>> Coment√°rio de filipedeschamps:
@aprendendofelipe show, topo total testarmos o Supabase, principalmente para estarmos preparados para os server components ü§ù  acabei de atualizar o t√≠tulo da issue üëç

>> Coment√°rio de marques-gabriel:
> * Armazenamento de arquivos (imagens);

Pelo que vi, o Storage deles pode ir al√©m de imagens, envolvendo qualquer tipo de arquivo. Incluindo tamb√©m a cria√ß√£o de buckets para objetos. Dessa forma, poderia "substituir" inclusive a implementa√ß√£o de um Amazon S3 no tabnews, estou correto?

>> Coment√°rio de aprendendofelipe:
> > * Armazenamento de arquivos (imagens);
> 
> Pelo que vi, o Storage deles pode ir al√©m de imagens, envolvendo qualquer tipo de arquivo. Incluindo tamb√©m a cria√ß√£o de buckets para objetos. Dessa forma, poderia "substituir" inclusive a implementa√ß√£o de um Amazon S3 no tabnews, estou correto?

Isso mesmo @marques-gabriel! S√≥ citei o armazenamento de imagens porque √© uma funcionalidade que provavelmente ser√° implementada no TabNews üòâ

>> Coment√°rio de filipedeschamps:
Sobre armazenamento de imagens, talvez seja interessante considerar o R2 da Cloudflare que n√£o tem egress: https://www.cloudflare.com/products/r2/

>> Coment√°rio de aprendendofelipe:
@filipedeschamps, para migrar o banco para outra regi√£o (ou para outro provedor) com o m√≠nimo de indisponibilidade, o processo √© criar uma r√©plica somente leitura e depois promover ela.

Pra gente poder criar essa r√©plica, o primeiro passo √© voc√™ setar no `parameter_group` o `rds.logical_replication` com valor `1` e reiniciar o servidor.

√â para tudo continuar funcionando normalmente com essa altera√ß√£o, pois s√≥ estar√° habilitando a possibilidade de replica√ß√£o l√≥gica. 

Se quiser habilitar no banco de homologa√ß√£o, quando tiver feito √© s√≥ avisar que eu crio uma r√©plica no Supabase pra testar. üëç

Falando em Supabase, j√° testei em modo de desenvolvimento e tudo funcionou normalmente. Tamb√©m passou em todos os testes. üéâ

Logo vou fazer um teste em homologa√ß√£o, mesmo antes de criar a r√©plica, pois j√° d√° pra gente testar algumas coisas, como os tempos de resposta. ü§ù

>> Coment√°rio de filipedeschamps:
> Falando em Supabase, j√° testei em modo de desenvolvimento e tudo funcionou normalmente. Tamb√©m passou em todos os testes. üéâ

@aprendendofelipe que not√≠cia sensacional!!!! A plataforma do curso ta sofrendo **muito** com a demora para abrir uma nova conex√£o com o Banco. O TabNews tinha o mesmo problema, mas eu descobri que se eu criasse a inst√¢ncia com uma vers√£o espec√≠fica e depois fizesse o upgrade, esse problema n√£o aparecia. Infelizmente segui a mesma estrat√©gia no curso mas n√£o teve jeito, e as vezes demora at√© 5 segundos para abrir uma conex√£o, muita maluquisse. Estou curioso se o Supabase resolve isso, pois se resolver, √© migra√ß√£o de tudo na certa.

Sobre a r√©plica e a migra√ß√£o para o Supabase, voc√™ consegue detalhar melhor esse fluxo? Como que voc√™ est√° passando da r√©plica para o Supabase?

E sobre o desenvolvimento local, voc√™ seguiu [os passos aqui](https://supabase.com/docs/guides/resources/supabase-cli/local-development)? Achei "complicado", no sentido de que, se for isso, n√£o fica mais transparente subir a aplica√ß√£o com um simples `npm run dev`. Ou tem outra forma de fazer isso?

>> Coment√°rio de aprendendofelipe:
> Sobre a r√©plica e a migra√ß√£o para o Supabase, voc√™ consegue detalhar melhor esse fluxo? Como que voc√™ est√° passando da r√©plica para o Supabase?

Para criar a replica√ß√£o l√≥gica √© o procedimento normal do PostgreSQL, s√≥ acrescenta aquele passo do `parameter_group` por ser RDS. A √∫nica indisponibilidade ser√° esse reset do servidor ao mudar o `parameter_group` . Em homologa√ß√£o d√° pra fazer a qualquer hora, mas em produ√ß√£o √© bom escolher bem o momento.

Ap√≥s a configura√ß√£o da replica√ß√£o, tudo que acontecer no RDS ser√° replicado na outra inst√¢ncia (seja ela outra regi√£o da AWS ou seja qualquer inst√¢ncia PostgreSQL).

Da√≠ √© s√≥ aguardar a sincroniza√ß√£o concluir, ou seja, quando a diferen√ßa dos dados entre as duas inst√¢ncias for de apenas milissegundos.

Quando chegar nessa condi√ß√£o √© s√≥ escolher o melhor momento e mudar as vari√°veis de ambiente na Vercel para direcionar a grava√ß√£o para o novo banco. A partir da√≠ eles n√£o v√£o mais estar sincronizados, pois as grava√ß√µes no novo banco n√£o s√£o enviadas para o antigo (a sincroniza√ß√£o √© unidirecional).

Mas mesmo ap√≥s isso, se ocorrer alguma grava√ß√£o no banco antigo, ela ainda vai ser replicada para o novo. Isso n√£o deveria acontecer, pois ap√≥s o redeploy da Vercel, ningu√©m mais estar√° acessando o banco antigo, ent√£o ele j√° pode ser tirado do ar.

Resumidamente √© isso. A configura√ß√£o da replica√ß√£o √© bem simples. D√° pra se basear nesse tutorial da AWS:

https://aws.amazon.com/pt/premiumsupport/knowledge-center/rds-postgresql-use-logical-replication/

> E sobre o desenvolvimento local, voc√™ seguiu [os passos aqui](https://supabase.com/docs/guides/resources/supabase-cli/local-development)? Achei "complicado", no sentido de que, se for isso, n√£o fica mais transparente subir a aplica√ß√£o com um simples `npm run dev`. Ou tem outra forma de fazer isso?

N√£o segui esses passos pois s√£o para criar um novo projeto. Foi s√≥ adicionar a biblioteca e fazer alguns ajustes nos scripts e nas vari√°veis de ambiente. √â para continuar transparente para os colaboradores.

>> Coment√°rio de filipedeschamps:
> Para criar a replica√ß√£o l√≥gica √© o procedimento normal do PostgreSQL, s√≥ acrescenta aquele passo do parameter_group por ser RDS. A √∫nica indisponibilidade ser√° esse reset do servidor ao mudar o parameter_group . Em homologa√ß√£o d√° pra fazer a qualquer hora, mas em produ√ß√£o √© bom escolher bem o momento.

Show, se eu n√£o me engado, eu tinha antecipado que em algum momento precisar√≠amos adicionar algum `parameter_group` e para evitar de precisar reiniciar o RDS por conta disso, eu j√° tinha colocado no Terraform:

https://github.com/filipedeschamps/tabnews.com.br/blob/cb011513fff6f3fbd57f06de5b23e10ed926d530/infra/provisioning/modules/database/main.tf#L86

O RDS pede para reiniciar ap√≥s a adi√ß√£o do primeiro `parameter_group`, mas os seguintes n√£o, apesar de que acho que isso n√£o vai valer ao adicionar o `logical_replication` dado ao que o artigo que voc√™ linkou ali falou. E esse artigo esclareceu bastante coisa!

Ent√£o numa vis√£o macro: a gente cria o Database l√° na Supabase, roda as migrations nele (para ter as tabelas) e faz a replica√ß√£o dos dados por `SUBSCRIPTION`, correto?

>> Coment√°rio de aprendendofelipe:
> Ent√£o numa vis√£o macro: a gente cria o Database l√° na Supabase, roda as migrations nele (para ter as tabelas) e faz a replica√ß√£o dos dados por `SUBSCRIPTION`, correto?

Exato! E quando a sincroniza√ß√£o estiver em "tempo real", ou seja, j√° tiver clonado os dados antigos e estiver recebendo as grava√ß√µes mais atuais, √© s√≥ direcionar o sistema para o banco novo

>> Coment√°rio de filipedeschamps:
Massa demais!!!

E sobre `localhost`, to pensando aqui: se √© uma inst√¢ncia convencional de Postgres, a gente precisa fazer alguma altera√ß√£o? Assumindo que por hora n√£o vamos usar outros servi√ßos da Supabase.

>> Coment√°rio de aprendendofelipe:
J√° que foi bem f√°cil de migrar, eu achei que seria bom s√≥ porque √© outra imagem do docker e √© o PostgreSQL 15, ent√£o foi bom rodar todos os testes nela e ver tudo passar. Mas d√° pra deixar a mudan√ßa para depois, se achar melhor.

Ah, talvez a inst√¢ncia do Supabase seja um pouco mais pesada que a atual. Tenho impress√£o que o projeto est√° demorando mais para abrir no Gitpod. Mas pode ser pelo tamanho da biblioteca do Supabase que n√£o √© nada pequena.

>> Coment√°rio de aprendendofelipe:
> E sobre `localhost`, to pensando aqui: se √© uma inst√¢ncia convencional de Postgres, a gente precisa fazer alguma altera√ß√£o? Assumindo que por hora n√£o vamos usar outros servi√ßos da Supabase.

Refletindo aqui...

1. Apesar de existirem outras vantagens de migrar para o Supabase, a motiva√ß√£o por enquanto √© apenas financeira, ent√£o inicialmente s√≥ iremos usar o banco de dados.
2. Por j√° vir com diversas extens√µes instaladas (por exemplo para acessar ao banco via HTTP), a imagem docker do Postgres do Supabase tem mais de 1GB. Como compara√ß√£o a imagem que estamos usamos hoje tem menos de 100MB (e a vers√£o dela atualizada para Postgres 15 tem cerca de 130MB).
3. A CLI do Supabase por enquanto tamb√©m n√£o teria nenhuma utilidade para o desenvolvimento local. Talvez seja √∫til nos testes e configura√ß√µes antes e durante a migra√ß√£o, mas tamb√©m d√° pra fazer tudo pelo dashboard web.

Ent√£o realmente √© melhor o foco por enquanto ser em mudar as vari√°veis de ambiente na Vercel direcionando para o PostgreSQL do Supabase (primeiro homologa√ß√£o e depois produ√ß√£o) e manter o desenvolvimento local como est√°.

Conforme forem surgindo as necessidades podemos ir mudando apenas o que for preciso.

1. Se a quest√£o for s√≥ a vers√£o do Postgres, n√≥s podemos usar a imagem atualizada (de ~130MB).
2. J√° se come√ßarmos a usar as extens√µes do Supabase, d√° pra usar a imagem deles mesmo sem a CLI.
3. E se a CLI se tornar √∫til para o desenvolvimento local, ent√£o adicionamos a biblioteca ao projeto.

>> Coment√°rio de filipedeschamps:
Show!!!

Uma curiosidade que bateu √© entender qual o tamanho da inst√¢ncia do plano Pro e quantas conex√µes eles aceitam se conectando direto (ao inv√©s da API em Rest). Voc√™ disse que eles j√° entregam diretamente com o PgBouncer, correto?

To no g√°s aqui no curso, mas em breve quero testar essa migra√ß√£o em homologa√ß√£o ü§ù

>> Coment√°rio de aprendendofelipe:
> Uma curiosidade que bateu √© entender qual o tamanho da inst√¢ncia do plano Pro e quantas conex√µes eles aceitam se conectando direto (ao inv√©s da API em Rest).

Respostas na tabela abaixo (dispon√≠vel aqui ao expandir [See Optimized Compute add-on plans](https://supabase.com/pricing#:~:text=Add%2DOns,with%20add%2Dons.)). 

Os valores s√£o acr√©scimos em cima dos $25 do Pro. Aparentemente s√£o os mesmos valores independentemente da regi√£o. üòâ

S√≥ agora eu notei que nem todas as inst√¢ncias do plano Pro s√£o dedicadas. S√≥ a partir da Large ($100 + $25 = $125). üòñ

Tem que descobrir se √© simples migrar a inst√¢ncia (deveria ser) para ir testando qual √© a capacidade que precisamos. Pode ser que uma inst√¢ncia compartilhada seja suficiente com o n√≠vel de uso atual do TabNews. Para homologa√ß√£o eu testaria a gratuita mesmo.

> Voc√™ disse que eles j√° entregam diretamente com o PgBouncer, correto?

√â s√≥ habilitar o Pool em `/settings/database` e usar as vari√°veis que aparecem nessa mesma tela (acho que s√≥ muda a porta de 5432 para 6543).

![image](https://user-images.githubusercontent.com/77860630/213576601-65351ad4-0775-4901-ba17-cb1b331aeaed.png)

>> Coment√°rio de filipedeschamps:
Hmm interessante. Isso agora me deixou pensando se ao inv√©s de migrarmos para o Supabase, se dever√≠amos apenas adicionar o PgBouncer na nossa inst√¢ncia da AWS e ficar mais "raw" com essa stack. O que acha? N√£o sei o qu√£o complicado √© subir isso usando Terraform.

>> Coment√°rio de aprendendofelipe:
> Hmm interessante. Isso agora me deixou pensando se ao inv√©s de migrarmos para o Supabase, se dever√≠amos apenas adicionar o PgBouncer na nossa inst√¢ncia da AWS e ficar mais "raw" com essa stack. O que acha? N√£o sei o qu√£o complicado √© subir isso usando Terraform.

Voc√™ diz subir uma outra inst√¢ncia na AWS com o PgBouncer? Seriam duas novas inst√¢ncias na AWS se for colocar tamb√©m em homologa√ß√£o, ou seja, mais ou menos dobraria o custo atual com banco de dados.

N√£o entendi se a inten√ß√£o √© fazer isso para aprender a configurar o PgBouncer do zero ou se √© uma desist√™ncia do Supabase por algum motivo. N√£o ficou claro se voc√™ achou interessante algum ponto espec√≠fico ou se foi o geral das informa√ß√µes sobre o Supabase.

Se for s√≥ uma desist√™ncia do Supabase, ent√£o s√≥ mexeria com o PgBouncer se for para aprender mais sobre ele, mas n√£o compensaria manter essas novas inst√¢ncias com a demanda atual. Por outro lado, se for migrar para o Supabase, nem compensa mexer com isso na AWS.

No Supabase √© s√≥ clicar no toggle da imagem abaixo para habilitar o PgBouncer na frente do Postgres, e n√£o tem acr√©scimo no custo. Com o PgBouncer habilitado o sistema pode continuar se conectando diretamente com o banco (o que n√£o faz sentido, mas funciona) ou √© s√≥ trocar a porta nas vari√°veis de ambiente da Vercel e passar a se conectar ao banco atrav√©s do Pool.

![image](https://user-images.githubusercontent.com/77860630/213604254-92da4d34-463f-4b06-991a-a2ebf5dd71b9.png)

E n√£o podemos esquecer que no Supabase tem a possibilidade de se conectar ao banco via REST, o que n√£o tem rela√ß√£o com o PgBouncer. Provavelmente s√≥ daria pra fazer isso na AWS se subir um servidor que se mantenha conectado ao banco e exponha a API.

>> Coment√°rio de aprendendofelipe:
Este deploy em homologa√ß√£o est√° utilizando um banco do Supabase na vers√£o gratuita:

https://tabnews-25tw3pmpu-tabnews.vercel.app/

N√£o fiz a migra√ß√£o dos dados do banco original de homologa√ß√£o, ent√£o vai ser preciso criar um novo usu√°rio dependendo do teste que quiserem fazer.

E tenham em mente que esse banco pode ser apagado a qualquer momento. üòâ

-----

Ainda sobre o Supabase...

Rodei os testes com o ambiente de desenvolvimento conectado remotamente a uma inst√¢ncia gratuita do Supabase e s√≥ tive que ignorar os dois testes que fazem 100 requisi√ß√µes simult√¢neas, pois alcan√ßavam o timeout de 60 segundos.

Os demais testes passaram, s√≥ que levou mais de 30 minutos para rodar todos üòÖ

>> Coment√°rio de aprendendofelipe:
O banco do Supabase est√° na mesma regi√£o que as lambdas da Vercel (sa-east-1), ent√£o est√° com uma lat√™ncia bem menor:

| AWS | Supabase |
| --- | ---|
| ![image](https://user-images.githubusercontent.com/77860630/213752484-68487691-f843-45ac-8286-5f7c89a5f4fa.png) | ![image](https://user-images.githubusercontent.com/77860630/213752382-ad527b22-2ec1-4daa-bac4-ad72d87ac34f.png) |

Apesar da lat√™ncia estar mais baixa, o processamento demora um pouco mais, pois o Supabase est√° em uma inst√¢ncia compartilhada.

Ent√£o uma coisa anula a outra e, no geral, as respostas das requisi√ß√µes est√£o mais ou menos no mesmo patamar.

>> Coment√°rio de filipedeschamps:
> Voc√™ diz subir uma outra inst√¢ncia na AWS com o PgBouncer? Seriam duas novas inst√¢ncias na AWS se for colocar tamb√©m em homologa√ß√£o, ou seja, mais ou menos dobraria o custo atual com banco de dados.

N√£o entendi sobre dobrar o custo com banco de dados, a id√©ia era manter o banco (na verdade reduzir o tamanho do de Produ√ß√£o) e colocar na frente o PgBouncer. Mas fui pesquisar aqui e n√£o √© t√£o simples colocar ele. Na verdade n√£o √© complicado, mas nem se compara com a facilidade do Supabase üòÇ 

> N√£o entendi se a inten√ß√£o √© fazer isso para aprender a configurar o PgBouncer do zero ou se √© uma desist√™ncia do Supabase por algum motivo. N√£o ficou claro se voc√™ achou interessante algum ponto espec√≠fico ou se foi o geral das informa√ß√µes sobre o Supabase.

As vezes eu endoido e tento projetar o que vai acontecer com uma empresa e eu vejo a AWS existindo por muito mais tempo que o Supabase, mas √© besteira pensar assim e mesmo que o Supabase deixe de existir (ou seja adquirido), migrar tudo de novo √© f√°cil ü§ù 

> No Supabase √© s√≥ clicar no toggle da imagem abaixo para habilitar o PgBouncer na frente do Postgres, e n√£o tem acr√©scimo no custo. Com o PgBouncer habilitado o sistema pode continuar se conectando diretamente com o banco (o que n√£o faz sentido, mas funciona) ou √© s√≥ trocar a porta nas vari√°veis de ambiente da Vercel e passar a se conectar ao banco atrav√©s do Pool.

Perfeito! S√≥ uma pena que n√£o tem um Terraform Provider pra deixar essa parte da infra versionada, mas pelo menos √© tudo muito mais simples que AWS ü§ù 

> E n√£o podemos esquecer que no Supabase tem a possibilidade de se conectar ao banco via REST, o que n√£o tem rela√ß√£o com o PgBouncer. Provavelmente s√≥ daria pra fazer isso na AWS se subir um servidor que se mantenha conectado ao banco e exponha a API.

Total!! E esse √© o tipo de feature que seria muito ruim fazer na m√£o (fora ser inseguro), e que faz essa inst√¢ncia ser acess√≠vel pela Edge üòç  To muito curioso para saber a performance de uma request por essa API.


> Rodei os testes com o ambiente de desenvolvimento conectado remotamente a uma inst√¢ncia gratuita do Supabase e s√≥ tive que ignorar os dois testes que fazem 100 requisi√ß√µes simult√¢neas, pois alcan√ßavam o timeout de 60 segundos.
> 
> Os demais testes passaram, s√≥ que levou mais de 30 minutos para rodar todos üòÖ

Puts que massaaaa!! Isso √© uma √≥tima not√≠cia!

Essa inst√¢ncia de homologa√ß√£o est√° com o PgBouncer ligado? Se sim, infelizmente ele n√£o ajudou na velocidade da primeira conex√£o, olha s√≥ :(

<img width="273" alt="image" src="https://user-images.githubusercontent.com/4248081/213872675-23988429-bf10-42fb-9e90-4067778bef6b.png">




> O banco do Supabase est√° na mesma regi√£o que as lambdas da Vercel (sa-east-1), ent√£o est√° com uma lat√™ncia bem menor:
> 
> | AWS | Supabase |
> | --- | ---|
> | ![image](https://user-images.githubusercontent.com/77860630/213752484-68487691-f843-45ac-8286-5f7c89a5f4fa.png) | ![image](https://user-images.githubusercontent.com/77860630/213752382-ad527b22-2ec1-4daa-bac4-ad72d87ac34f.png) |
>
> Apesar da lat√™ncia estar mais baixa, o processamento demora um pouco mais, pois o Supabase est√° em uma inst√¢ncia compartilhada.
> 
> Ent√£o uma coisa anula a outra e, no geral, as respostas das requisi√ß√µes est√£o mais ou menos no mesmo patamar.

A imagem da coluna `AWS` √© do nosso atual homologa√ß√£o? Se sim, da√≠ n√£o d√° para comparar, pois esse banco est√° em `us-east-1`. Ent√£o se colocar na mesma regi√£o vai ficar igual (`1-2ms` ap√≥s a conex√£o aberta).

---

Puts.. nosso maior vil√£o √© o tempo de abertura inicial da conex√£o. Fico no aguardo de voc√™ responder se a inst√¢ncia de homologa√ß√£o l√° em cima est√° com o PgBouncer ligado, e se estiver, se temos alguma outra manobra para melhorar o tempo inicial de conex√£o ü§ù

>> Coment√°rio de filipedeschamps:
Lendo o [config do PgBouncer](https://www.pgbouncer.org/config.html) encontrei essa op√ß√£o:

> **min_pool_size**
> Add more server connections to pool if below this number. Improves behavior when the normal load suddently comes back after a period of total inactivity. The value is effectively capped at the pool size.
> 
> Default: 0 (disabled)

Que por padr√£o vem desabilitado. Seria interessante sempre manter conex√µes quentes com o banco. Tem como colocar essa config no Supabase?

>> Coment√°rio de aprendendofelipe:
> N√£o entendi sobre dobrar o custo com banco de dados, a id√©ia era manter o banco (na verdade reduzir o tamanho do de Produ√ß√£o) e colocar na frente o PgBouncer.

O PgBouncer n√£o √© uma extens√£o que pode ser instalada no Postgres. √â um servidor adicional. Precisa subir uma nova inst√¢ncia (EC2 ou cont√™iner) que vai atuar como se fosse um servidor PostgreSQL, mas que s√≥ lida com as conex√µes e se conecta no banco verdadeiro para fazer as consultas. Por isso dobra o n√∫mero de inst√¢ncias.

> As vezes eu endoido e tento projetar o que vai acontecer com uma empresa e eu vejo a AWS existindo por muito mais tempo que o Supabase, mas √© besteira pensar assim e mesmo que o Supabase deixe de existir (ou seja adquirido), migrar tudo de novo √© f√°cil ü§ù

> S√≥ uma pena que n√£o tem um Terraform Provider pra deixar essa parte da infra versionada, mas pelo menos √© tudo muito mais simples que AWS ü§ù

O Supabase pode ser auto-hospedado, ent√£o talvez seja boa ideia manter o versionamento do que seria necess√°rio para auto-hospedar. Pode ser √∫til caso surjam problemas com a empresa Supabase, mas de qualquer modo servir√° como registro hist√≥rico.

> E esse √© o tipo de feature que seria muito ruim fazer na m√£o (fora ser inseguro), e que faz essa inst√¢ncia ser acess√≠vel pela Edge üòç To muito curioso para saber a performance de uma request por essa API.

Praticamente s√≥ muda que n√£o ocorre a demora da primeira requisi√ß√£o de uma lambda que precisa estabelecer conex√£o com o banco, pois as requisi√ß√µes s√£o feitas via REST para uma inst√¢ncia quente do Supabase que mant√©m a conex√£o sempre aberta com o banco. Fora isso, tem uma inst√¢ncia a mais no caminho da consulta, ent√£o √© para demorar um pouco mais, mas o acr√©scimo de tempo deve ser insignificante.

> Essa inst√¢ncia de homologa√ß√£o est√° com o PgBouncer ligado?

Est√° sim com PgBouncer, por isso est√° mostrando 57 conex√µes dispon√≠veis. Teria um n√∫mero bem menor se n√£o tivesse, acho que seriam menos de 20 conex√µes diretas dispon√≠veis nessa inst√¢ncia b√°sica e compartilhada.

> Se sim, infelizmente ele n√£o ajudou na velocidade da primeira conex√£o, olha s√≥ :(

Mas o PgBouncer realmente n√£o ajuda nada com isso. Para se conectar nele √© o mesmo processo de se conectar diretamente ao banco.

O que ele ajuda √© aumentando o n√∫mero de conex√µes dispon√≠veis. Em situa√ß√µes de alta demanda, mais lambdas ser√£o necess√°rias e ter√£o mais conex√µes dispon√≠veis no Pool. Com isso evitamos que as lambdas fique se desconectando para liberar a conex√£o para outras lambdas, e s√≥ nesse caso vai ser economizando o tempo que leva para estabelecer novas conex√µes. Quem vai estar gerenciando o revezamento de conex√µes ser√° o PgBouncer, mas sem precisar estabelecer novas conex√µes entre a lambda e o Pool e nem entre o Pool e o PostgreSQL.

Mas quando n√£o tem demanda e as lambdas congelam, n√£o tem jeito, ao subirem novamente elas precisam abrir novas conex√µes, seja diretamente com o banco ou com o PgBouncer, e isso sempre vai demorar um pouco mais.

> A imagem da coluna `AWS` √© do nosso atual homologa√ß√£o? Se sim, da√≠ n√£o d√° para comparar, pois esse banco est√° em `us-east-1`. Ent√£o se colocar na mesma regi√£o vai ficar igual (`1-2ms` ap√≥s a conex√£o aberta).

Isso, estou testando e comparando s√≥ homologa√ß√£o. E, sim, colocar o banco de homologa√ß√£o em `us-east-1` deixaria a lat√™ncia igual √† do banco atual de produ√ß√£o, ou seja, iria melhorar a performance, mas essa possibilidade n√£o faz sentido no contexto dessa issue, pois estaria aumentando os custos ao inv√©s de diminuir.

 A compara√ß√£o foi da situa√ß√£o atual (AWS em `sa-east-1`) para uma situa√ß√£o poss√≠vel (Supabase em `us-east-1`), mostrando que ela √© aceit√°vel, pois reduz o custo sem causar preju√≠zo significante para a performance em homologa√ß√£o.

-----

O PgBouncer do Supabase tamb√©m vem com `min_pool_size=0`, mas n√£o precisa habilitar isso para que as conex√µes entre o Pool e o Postgres permane√ßam quentes. Acho que mudar esse par√¢metro s√≥ teria efeito pr√°tico quando o servidor PgBouncer subir na primeira vez, pois a√≠ ele j√° abriria essas X conex√µes com o Postgres, mesmo sem clientes conectados. Mas n√£o muda nada entre as conex√µes das lambdas para o PgBouncer.

-----

Para nunca ter o problema de demora com a primeira ~conex√£o~ consulta com o banco de dados a alternativa √© a API REST ou GraphQL e n√£o o PgBouncer.

>> Coment√°rio de Rafatcb:
Uma pequena atualiza√ß√£o ao issue, o pre√ßo das inst√¢ncias no Supabase mudou, e a quantidade de conex√µes tamb√©m:

![Novos pre√ßos](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/cb077b39-a325-400a-9c87-c82d647b5e60)

[Fonte](https://supabase.com/pricing).

>> Coment√°rio de marques-gabriel:
> Perfeito! S√≥ uma pena que n√£o tem um Terraform Provider pra deixar essa parte da infra versionada, mas pelo menos √© tudo muito mais simples que AWS ü§ù
> 
> >

@filipedeschamps @aprendendofelipe 

Atualizando sobre o `Supabase`: J√° possui [Terraform Provider](https://supabase.com/docs/guides/deployment/terraform)
</issue_1172_Migrar RDS de `sa-east-1` para `us-east-1` (ou outro provider como Supabase)>

<issue_1175_Adicionar link do RSS ao footer>
Muitas pessoas pediram n√£o s√≥ aqui, mas no TabNews por um feed RSS, justamente por n√£o saberem que ele existia. Adicionar ao footer tamb√©m j√° havia sido sugerido antes para dar visibilidade a ele.
</issue_1175_Adicionar link do RSS ao footer>

<issue_1180_Recupera√ß√£o de senha apenas por `email`>
## Contexto

Ap√≥s o [postmortem do `/recovery`](https://www.tabnews.com.br/filipedeschamps/postmortem-endpoint-api-v1-recovery-retornava-token-sensivel-que-conseguia-burlar-o-fluxo-de-alteracao-de-senha) fiquei pensando se √© uma boa escolha deixarmos as pessoas criarem tokens de recupera√ß√£o de senha apenas utilizando o `username` e gostaria de propor avaliarmos deixar a recupera√ß√£o apenas por `email`, por√©m com a possibilidade de pessoas com uma feature de modera√ß√£o conseguirem iniciar o fluxo de recupera√ß√£o por `email` como fallback.

Hoje qualquer pessoa consegue iniciar o fluxo de recupera√ß√£o de senha, enviando ou `email` (dado privado) ou `username` (dado p√∫blico):

https://github.com/filipedeschamps/tabnews.com.br/blob/31dbe19f0cfb4a6d9dcced25d23a9151d2b2cdd9/pages/api/v1/recovery/index.public.js#L16

A id√©ia seria adicionar no controller uma verifica√ß√£o adicional caso seja enviado o `username`, que verifica se o usu√°rio no contexto possui alguma feature de modera√ß√£o, como por exemplo `create:recovery_token:username`. Com isto, se a pessoa esquecer qual email utilizou para criar a conta, qualquer moderador pode iniciar um processo de recupera√ß√£o usando o `username` da pessoa.

E para n√£o confundir os usu√°rios, na interface teremos que remover a parte que sugere o `username` como op√ß√£o:

<img width="551" alt="image" src="https://user-images.githubusercontent.com/4248081/209235523-c4d87f1a-2f89-489b-a296-b351c04c9986.png">

Devemos tamb√©m trocar este autocomplete (caso o usu√°rio esteja logado), do `username` para `email`:

https://github.com/filipedeschamps/tabnews.com.br/blob/31dbe19f0cfb4a6d9dcced25d23a9151d2b2cdd9/pages/cadastro/recuperar/index.public.js#L26

E itens de acessibilidade como este label:

https://github.com/filipedeschamps/tabnews.com.br/blob/31dbe19f0cfb4a6d9dcced25d23a9151d2b2cdd9/pages/cadastro/recuperar/index.public.js#L114

## Execu√ß√£o

- #1290
</issue_1180_Recupera√ß√£o de senha apenas por `email`>

<issue_1181_Mensagem global para an√∫ncios>
## Contexto

No passado n√≥s precisamos algumas boas vezes colocar um banner anunciando uma manuten√ß√£o e, nos casos mais cr√≠ticos, a gente colocava a mensagem hardcoded no `DefaultLayout`:

https://github.com/filipedeschamps/tabnews.com.br/pull/862/files

## Execu√ß√£o

Seguindo a sugest√£o do @aprendendofelipe [nesse coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/1140#issuecomment-1361335045), podemos usar a [Edge Config](https://vercel.com/docs/concepts/edge-network/edge-config) para cadastrar a mensagem e dinamicamente recuperar esse valor pelo Middleware (Edge Functions), ao bater em algum endpoint espec√≠fico. Assim sem deploy algum podemos mostrar/esconder mensagens.

Em paralelo, seria interessante aproveitar e usar a mesma feature para decidir se o site est√° no modo `read only` ou modo `manuten√ß√£o`. N√£o sei exatamente qual o melhor comportamento, mas seria um modo em que travamos a API enquanto fazemos uma manuten√ß√£o mais agressiva como o da issue #1172

>> Coment√°rio de Rafatcb:
Como refer√™ncia, eu gosto do jeito que a Stack Exchange trata esse tipo de situa√ß√£o. √Äs vezes eles tem problemas em atualizar a p√°gina de Status, mas parece que depois que mudaram a p√°gina de status deles, est√° melhor. No site principal, quando est√° em modo de leitura, fica com uma mensagem assim:

![Texto com fundo amarelo no topo do site](https://i.stack.imgur.com/sh7nD.png)

A p√°gina atual de status deles √© https://www.stackstatus.net/

Quando √© algo mais s√©rio, eles mostram uma p√°gina diferente (como [relatado nessa publica√ß√£o do TabNews](https://www.tabnews.com.br/filipedeschamps/o-stack-overflow-esta-atualmente-off-line-para-manutencao-nunca-tinha-visto-esta-tela)):

![O site diz que est√° fora do ar para manuten√ß√£o](https://i.imgur.com/WTeYskS.png)
</issue_1181_Mensagem global para an√∫ncios>

<issue_1183_Criar possibilidade de desfazer voto RECENTE>
# O problema
Atualmente, na avalia√ß√£o de posts e coment√°rios, √© poss√≠vel votar +1 e -1 em um mesmo texto, gastando os _tabcoins_ e n√£o contribuindo de fato para a avalia√ß√£o.
Desse modo, considero importante que a avalia√ß√£o _contraria_ √† anterior fa√ßa o _refund_ da primeira avalia√ß√£o.

Exemplo: Tenho 4 TabCoins, voto +1 e -1 em um determinado post. No final n√£o contribui para a avalia√ß√£o e troquei 4 coins por dois cashs.

# Como penso que deve ser
Para o exemplo acima, o resultado deveria ser a avalia√ß√£o resultante de -1, dois coins trocados por 1 cash, realizando o refund da primeira opera√ß√£o.

# Impacto
Assim, para avalia√ß√µes _sem querer_, ser√° poss√≠vel corrigir sem prejudicar o fluxo real da classifica√ß√£o do post/coment√°rio. Melhorando a qualidade de uso da plataforma

>> Coment√°rio de cybernerd007:
Acredito que isso n√£o √© um bug e sim o esperado pela aplica√ß√£o...

Refletindo sobre essa issue seria mais eficiente limitar por usu√°rio a 1 tabcash por post/coment√°rio...

O que acha da ideia?

>> Coment√°rio de filipedeschamps:
@braiansmarzaro muito obrigado pela sugest√£o meu caro e eu compartilho desta frustra√ß√£o ü§ù 

Ent√£o n√£o quero desconsiderar que clicar errado numa avalia√ß√£o e n√£o poder anular ela seja algo ruim, porque claramente √©, mas voc√™ j√° pensou que, se for poss√≠vel fazer livremente o `refund`, as pessoas v√£o poder mais facilmente abusar do sistema?

Isto porque a p√°gina de Relevantes √© vol√°til, e com o `refund` voc√™ poder√° descarregar as TabCoins de uma publica√ß√£o antiga e carregar elas numa publica√ß√£o nova, que ir√° ser desataca, recebendo ainda mais TabCoins, e que ir√° aumentar o tamanho da "pr√≥xima onda" deste ciclo.

Ent√£o a sugest√£o do `refund` deve vir acompanhada de **outros mecanismos de prote√ß√£o**. Eu consigo pensar em alguns (inspirados em comportamentos do NPM inclusive), mas gostaria de ver a sua vis√£o primeiro, at√© como exerc√≠cio para voc√™ ü§ù

>> Coment√°rio de braiansmarzaro:
> @braiansmarzaro muito obrigado pela sugest√£o meu caro e eu compartilho desta frustra√ß√£o ü§ù 
> Ent√£o a sugest√£o do `refund` deve vir acompanhada de **outros mecanismos de prote√ß√£o**. Eu consigo pensar em alguns (inspirados em comportamentos do NPM inclusive), mas gostaria de ver a sua vis√£o primeiro, at√© como exerc√≠cio para voc√™ ü§ù 

Legal, @filipedeschamps !
_tirei umas f√©rias, estamos voltando √†s atividades!_
O que pensei √© que a a√ß√£o s√≥ fosse poss√≠vel enquanto o usu√°rio permanece na mesma p√°gina, pois assim permite _desfazer_ a a√ß√£o. 
Outra possibilidade √© estabelecer um tempo de _arrependimento_, -talvez de 30 minutos?- para o usu√°rio poder **trocar** o voto. 

N√£o vejo vantagem na implementa√ß√£o de apenas "desistir" do voto, mantendo as Coins, no momento.

>> Coment√°rio de braiansmarzaro:
> O que acha da ideia?

Concordo, @cybernerd007 !
√â uma discuss√£o que abri nos primeiros dias de tabnews. Tamb√©m est√° sendo tratado na Milestone 6 e na Issue #1166 pelo pr√≥prio deschamps

>> Coment√°rio de Rafatcb:
Acredito que podemos concentrar essa discuss√£o no issue abaixo:

* https://github.com/filipedeschamps/tabnews.com.br/issues/1079

"Desfazer ao votar no sentido contr√°rio" √© uma sugest√£o de implementa√ß√£o para o problema principal: possibilitar desfazer o voto.

>> Coment√°rio de aprendendofelipe:
@Rafatcb acredito que aqui a discuss√£o avan√ßou mais, ent√£o editei o t√≠tulo fechei a #1079.
</issue_1183_Criar possibilidade de desfazer voto RECENTE>

<issue_1186_Erro de ortografia na p√°gina /status>
Um pequeno erro de ortografia na palavra "conteudos" da p√°gina de Status:

![image](https://user-images.githubusercontent.com/50326228/209580757-1dc414d6-5df4-4912-be41-c42bfb13552f.png)

>> Coment√°rio de aprendendofelipe:
@GHCMelo, obrigado pela issue e pelo PR #1187!

O @Caixetadev abriu o PR #1246 com a mesma solu√ß√£o, ent√£o j√° fiz o merge colocando voc√™ como coautor üëçü§ù
</issue_1186_Erro de ortografia na p√°gina /status>

<issue_1189_Autentica√ß√£o autom√°tica ao cadastrar-se e confirmar o email>
### Problema
Em diversos sites, √© poss√≠vel observar que quando o cadastro √© feito e vamos confirmar ele no email enviado, somos redirecionados at√© o site em quest√£o e geralmente j√° estamos logados na aplica√ß√£o ao chegar neste ponto.

Atualmente, ao realizar um cadastro no TabNews, depois de redirecionado ao site, o usu√°rio ainda precisa voltar a tela de login, preencher seus dados novamente e ent√£o logar na aplica√ß√£o, coisa que poderia ser feita pelo pr√≥prio site ao confirmar o email e atestar que o cadastro √© v√°lido.

### Conclus√£o
Se o TabNews implementasse essa funcionalidade, a experi√™ncia do usu√°rio seria muito beneficiada e a navega√ß√£o seria mais fluida.

>> Coment√°rio de cybernerd007:
Bom como a ativa√ß√£o e feita somente uma unica vez acredito que isso n√£o tenha impacto real...

>> Coment√°rio de bernardoeuler:
Pode at√© ser uma coisa pequena, mas como foi algo que senti falta na hora de me cadastrar, fiz essa observa√ß√£o. Pra mim, √© algo que ajuda na experi√™ncia de quem for usar, mesmo que uma √∫nica vez.

>> Coment√°rio de rodrigoKulb:
Legal sua observa√ß√£o @bernardoeuler pensando em **seguran√ßa** essa possibilidade poder√° abrir uma **brecha de seguran√ßa**, onde com acesso ao link de ativa√ß√£o qualquer usu√°rio poderia acessar a conta da pessoa.

Como sabemos esse link ficar√° gravado no hist√≥rico do navegador, fora que dependendo da rede a URL acessada pode ser gravada em logs da rede.

Colocando na balan√ßa a seguran√ßa seria prioridade VS a experi√™ncia do usu√°rio.

>> Coment√°rio de bernardoeuler:
Caramba, nem pensei nisso, obrigado pela explica√ß√£o. Faz sentido, a seguran√ßa deve ser priorizada. Vou fechar esta issue ent√£o.
</issue_1189_Autentica√ß√£o autom√°tica ao cadastrar-se e confirmar o email>

<issue_1191_[Feature] Habilitar a defini√ß√£o de uma URL can√¥nica ao post>
Algumas vezes, queremos republicar os posts do blog pr√≥prio no TabNews, mas, para isso, seria necess√°rio definir a URL can√¥nica do post (do mesmo jeito que √© feito dev.to).

![image](https://user-images.githubusercontent.com/564542/209740188-7bee4624-6fdb-4b32-bfaf-080f2b95d66a.png)

>> Coment√°rio de aprendendofelipe:
@DouglasdeMoura, duplicada com sua issue #1077
</issue_1191_[Feature] Habilitar a defini√ß√£o de uma URL can√¥nica ao post>

<issue_1192_[PRODU√á√ÉO]Erro inusitado no email>
OBS.: OS TESTES FORAM FEITOS EM **PRODU√á√ÉO** E **HOMOLOGA√á√ÉO**, FOI UTILIZADO O **MOZILLA** E O **PROJECTO CHROMIUM** NOS TESTES.

Bom como dizem que uma imagem vale mais que mil palavras kkkk

(PRINT EM HOMOLOGA√á√ÉO)
![Screenshot_1](https://user-images.githubusercontent.com/8114976/209756928-9f8f0fd0-b50d-42ef-bcdb-14cf25fdeadf.png)

(PRINT EM PRODU√á√ÉO)
![Screenshot_5](https://user-images.githubusercontent.com/8114976/209756935-aa48e9d0-e6c2-4091-8adf-e0ae6346fe72.png)
no Print acima(EST√Å EM PRODU√á√ÉO) voc√™ pode notar que ele est√° fazendo 2 requests iguais para o `user` fiz uns testes e quando ele s√≥ faz **UMA** ele da **undefined** no email e quando ele faz **DUAS** em um curto espa√ßo de tempo fica undefined...

Bom acredito que seja essa PR que esteja causando esse problema https://github.com/filipedeschamps/tabnews.com.br/pull/804 
no caso ela foi implementada a pouco tempo.
![Screenshot_6](https://user-images.githubusercontent.com/8114976/209757056-16d21c2f-9a29-4659-b680-89f68e3023ac.png)
(Mais precisamente ONTEM)

>> Coment√°rio de aprendendofelipe:
Boa @cybernerd007 üëç

Solu√ß√£o em #1193 ü§ù
</issue_1192_[PRODU√á√ÉO]Erro inusitado no email>

<issue_1194_Sugest√£o para ISSUE e para o REPOSIT√ìRIO>
1. Sugiro o uso **CodeQL Analysis** e/ou **Dependency Review**  para seguran√ßa do reposit√≥rio. Ambos s√£o do Github oficial e atuam de forma diferente, no entanto, seguem a mesma ideia: Procurar vulnerabilidades e informar. 
Mesmo que tenha profissionais na √°rea, automa√ß√£o para ajudar sempre √© bem vindo, em minha opini√£o.
> Acredito que somente o dono ou colaborador tem acesso esse recurso. Se j√° h√°, desconsidere minha sugest√£o.
2. Para **ISSUE**, recomendo uma personaliza√ß√£o r√°pida. J√° tivemos discuss√µes, o pr√≥prio @filipedeschamps j√° comentou sobre isso, ao abrir uma "sala de **discuss√µes**" referente ao reposit√≥rio. Ent√£o pelo menos configure _issue_ capaz de informar um formul√°rio pr√©-personalizado com uma etiqueta quando um usu√°rio abrir uma. Se for sobre "bug", que tenha uma etiqueta de cor vermelha e se for "suggest", que tenha etiqueta de cor azul por **exemplo**.
> Facilita a filtrar sobre o que procuras e deixa mais f√°cil de entender que cada _issue_ significa pelo uso da etiqueta antes de adentrar e ler em uma.

[I am sorry se estou sendo repetitivo em uma outra _issue_ que j√° foi sugerida, se existe]

>> Coment√°rio de Rafatcb:
Acho o ponto 1. bem v√°lido de ser estudado (eu nunca usei essas _actions_  ent√£o n√£o sei se funcionam bem e se s√£o √∫teis).

Sobre o ponto 2, podemos concentrar a discuss√£o num issue espec√≠fico sobre isso: https://github.com/filipedeschamps/tabnews.com.br/issues/902.

>> Coment√°rio de Rafatcb:
@Jetrom17  n√£o quer deixar aberto por causa das sugest√µes do CodeQL Analysis e Dependency Review?

>> Coment√°rio de Jeiel0rbit:
> @Jetrom17  n√£o quer deixar aberto por causa das sugest√µes do CodeQL Analysis e Dependency Review?

Passaram-se 11 meses. N√£o creio que a sugest√£o seja v√°lida. Me desconectei do TabNews h√° mais de um ano. Prov√°vel que eu retorne futuramente, mas n√£o agora.

>> Coment√°rio de aprendendofelipe:
Tamb√©m j√° temos o CodeQL habilitado üëç
</issue_1194_Sugest√£o para ISSUE e para o REPOSIT√ìRIO>

<issue_1196_[PRODU√á√ÉO]Pequeno erro na PR #1193>
Segue um pequeno problema vindo na PR #1193 quando voc√™ se encontra no perfil e desloga da conta ao sair da aba e voltar ele da o erro undefined no username e no email...

Click no link abaixo que voc√™ sera redirecionado para o video que eu fiz e postei no youtube mostrando melhor o problema...

[![Report Falha/Bug ainda persiste PR #1193](https://i9.ytimg.com/vi_webp/izj2XeFtH7E/mqdefault.webp?sqp=CLy5sp0G&rs=AOn4CLBgh95cqunYi15q58LtX_iD6mVsFQ)](https://youtu.be/izj2XeFtH7E)

>> Coment√°rio de cybernerd007:
Quando n√£o se est√° logado e voc√™ troca de aba tambem ocorre esse pequeno problema...
![Screenshot_1](https://user-images.githubusercontent.com/8114976/209935865-b38f3e24-5353-40d7-bbdb-a159e85a95f2.png)

>> Coment√°rio de cybernerd007:
alem do fato desse problema esta dando acesso como se o usuario estivesse logado.
Obs.: esse problema so se propaga no front end.
![Screenshot_2](https://user-images.githubusercontent.com/8114976/209936162-607b3190-7054-43e8-80e2-430f59891103.png)

>> Coment√°rio de cybernerd007:
Solu√ß√£o em #1200

>> Coment√°rio de aprendendofelipe:
Obrigado @cybernerd007 üëç
</issue_1196_[PRODU√á√ÉO]Pequeno erro na PR #1193>

<issue_1197_TabCoins Infinitas adicionando coment√°rios.>
Ol√°, tudo come√ßou quando boicotaram uma publica√ß√£o minha hoje no TabNews, que saiu de 2¬∫ lugar para posi√ß√£o 28 de "Recentes", isso tudo em menos de 3 minutos. Com isso eu fiquei revoltado pois sei que por conta de alguns deslikes em um coment√°rio do meu post, a pessoa se vingou dando v√°rios deslikes no meu post. Me perguntei como ganhar v√°rios tabcoins de forma f√°cil, e sem ser identificado, a principio pensei em criar v√°rios posts mas poderia ocorrer de perceberem por conta do meu nick, ent√£o pensei em criar 2 contas, em uma eu crio o post e na outra eu fa√ßo os coment√°rios. 
A principio foi isso que fiz, mas percebi que rapidamente a publica√ß√£o come√ßou a aparecer em relevantes, e eu n√£o queria isso, pois seria f√°cil de me identificarem. 

Ai que veio a sacada, se eu criar um bot, junto com o ChatGPT, que vai de post em post, copiando seu conte√∫do enviando para a IA como par√¢metro de um texto "Entenda o texto a seguir e elabore algumas considera√ß√µes e perguntas", pegando o resultado da IA e comentando no post. Assim seria poss√≠vel ter tabcoins infinitos

N√£o cheguei a codificar, mas o teste manual que eu fiz me surpreendeu, pois as pessoas se que sabiam que as respostas vinham de uma IA, e como s√£o coment√°rios o m√°ximo que poderia acontecer era algu√©m n√£o gostar e dar deslike. 

Uma conta deveria ter limites de coment√°rios "Limites humanos", ou at√© mesmo s√≥ poderia fazer X coment√°rios em um intervalo Y de tempo.

>> Coment√°rio de filipedeschamps:
@Hanufu muito obrigado pela sua pesquisa e eu entendo perfeitamente sua frustra√ß√£o, tanto que apontei as medidas que estamos tomando para evitar que isso aconte√ßa.

Sobre o limite de coment√°rios em um intervalo de tempo, isso j√° existe e j√° pegou casos de pessoas abusando. √â um sistema que sempre ter que ir melhorando, principalmente se imbutirmos nele algum verificador, como o `fingerprint` que a OpenAI quer disponibilizar.

Agora, uma coisa a se levar em considera√ß√£o √©: independente do que voc√™ utilizar (manual ou autom√°tico), manipular TabCoins de forma artificial vai contra os [Termos de Uso](https://www.tabnews.com.br/termos-de-uso) do site. Ent√£o pe√ßo que envie para contato@tabnews.com.br as contas que utilizou para eu fazer o Nuke delas e evitar que eu acabe fazendo o Nuke de todas as contas relacionadas, incluindo sua conta principal, ou que algum moderador fa√ßa isso por n√£o ter visto esta issue, combido? ü§ù 

No mais, iremos combater o abuso de TabCoins com todas as for√ßas e fico feliz em ter voc√™ do nosso lado para ajudar a testar os limites disso üëç

>> Coment√°rio de hanufu:
Fiz o que foi pedido, mandei um email contendo o link dessa issue, e explicando a situa√ß√£o, espero que d√™ tudo certo! 

Fiquei com alguma d√∫vida, esse √© o primeiro projeto em que eu estou empenhado em melhorar, construir a premissa do TabNews √© sensacional, e eu gostaria de testar coisas do tipo, sou um entusiasta de cyber security, mas n√£o sei por onde come√ßar, e se √© permitido. N√£o h√° nada relacionado a bug hunter? ou alguma forma de contribuir  para a comunidade?  Fiquei muito curioso para testar o limite de coment√°rios programando um bot, mas resolvi n√£o fazer pois tive medo de ser banido ou algo do tipo existe alguma forma segura de testar o tabnews?

>> Coment√°rio de filipedeschamps:
Massa @Hanufu tem como testar sem atrapalhar o ambiente de produ√ß√£o, que √© utilizando o ambiente de homologa√ß√£o. Cada commit produz um ambiente novo, e voc√™ pode sempre pegar a URL do √∫ltimo ambiente por aqui: https://github.com/filipedeschamps/tabnews.com.br/deployments/activity_log?environment=Preview

Clique no bot√£o **View deployment** e voc√™ ser√° levado para a √∫ltima vers√£o do ambiente, que √© uma c√≥pia do ambiente de produ√ß√£o, mas com um banco de dados separado (por conta disto, voc√™ precisar√° fazer um novo cadastro, onde este cadastro poder√° ser aproveitado entre os deploys diferentes de homologa√ß√£o).

>> Coment√°rio de Rafatcb:
Sempre ser√° poss√≠vel burlar o sistema, a diferen√ßa √© o n√≠vel de sofistica√ß√£o exigido para isso. O TabNews melhorou bastante de Dez/2022 para Dez/2023, e v√°rios casos de manipula√ß√£o de votos foram lidados.

Dito isso, creio que podemos fechar o issue por ser um assunto sempre em andamento, e criar issues com propostas mais espec√≠ficas para auxiliar nisso, como foi o caso dos PRs com a implementa√ß√£o do grafo de votos na p√°gina de [Status](https://www.tabnews.com.br/status) (https://github.com/filipedeschamps/tabnews.com.br/pull/1531, https://github.com/filipedeschamps/tabnews.com.br/pull/1533, https://github.com/filipedeschamps/tabnews.com.br/pull/1541).

Faz sentido?

>> Coment√°rio de aprendendofelipe:
√â isso mesmo @Rafatcb üëç

Al√©m disso, ideias de melhorias para a economia podem ser centralizadas na

- #1438
</issue_1197_TabCoins Infinitas adicionando coment√°rios.>

<issue_1198_Modera√ß√£o conseguir anular as TabCoins de um conte√∫do>
## Contexto

Na busca de uma economia saud√°vel, proponho um recurso onde seja poss√≠vel algu√©m da modera√ß√£o conseguir anular os ganhos de TabCoins de uma publica√ß√£o.

Uma coisa que fiquei pensando nos √∫ltimos dias √© sobre o que exatamente fazer com um coment√°rio como "üëç ", pois se removermos ele por n√£o respeitar os termos de uso, por exemplo, ele deixa de ser um demonstrativo de o que n√£o deve se fazer no TabNews. Ent√£o estou pensando que √© melhor ter um coment√°rio simples negativado (para as pessoas verem que isto n√£o √© bem vindo), do que esconder esta intera√ß√£o ao remover o conte√∫do.

E esta funcionalidade acaba sendo importante quando nitidamente um coment√°rio precisa ser negativado, por√©m n√£o foi negativado por ningu√©m por ele estar nas profundezas de alguma outra thread, e algum moderador n√£o est√° com TabCoins suficiente para negativar. Eu j√° me vi nesse cen√°rio, ao abrir um perfil de um usu√°rio, notar alguns coment√°rios sem valor algum, mas n√£o ter TabCoins para negativar.

Ent√£o prefiro dar este furo na economia atrav√©s da modera√ß√£o, do que algu√©m estar se beneficiando de um coment√°rio sem valor.

## Execu√ß√£o

No menu de op√ß√µes de um conte√∫do, adicionar uma nova funcionalidade de "Zerar valor" (ou outra nomenclatura) dispon√≠vel somente para quem tem a feature `update:content:others` (ou outra feature espec√≠fica para isto):

<img width="204" alt="image" src="https://user-images.githubusercontent.com/4248081/209902193-5e3fe462-2376-43ef-8886-6a930d2c4775.png">

Onde o efeito dever√° ser:

1. Criar um `event` registrando isso. Este `event` dever√° ter um nome √∫nico (que ainda n√£o existe).
2. Criar uma `balance_operation` que use este evento como lastro.
3. Penalizar o conte√∫do deixando ele com valor negativo (por exemplo `-1`), e penalizar o autor deste conte√∫do com `-2` TabCoins.
4. Atualizar o `event` com tudo o que aconteceu, para ser poss√≠vel desfazer esta opera√ß√£o.

Uma coisa a se considerar √© penalizar o conte√∫do com `-2` TabCoins e autor do conte√∫do com `-4` TabCoins para o esfor√ßo do autor em criar coment√°rios simples ter resultado negativo (o que prefiro).

>> Coment√°rio de cybernerd007:
Bom recomendo fazer assim se o usuario tiver a feature `update:content:others` suas tabcoins s√£o infinitas, e o peso de um DownVote seja -1 no Comentario/post e -2 para o autor do comentario/post acredito que assim vai reduzir a complexidade da implementa√ß√£o.

>> Coment√°rio de Rafatcb:
Voc√™ pensa nisso como uma solu√ß√£o perp√©tua? A ideia me parece √∫til para ser implementada hoje e usada nos casos √≥bvios, deixando para gastar TabCoins nos casos menos √≥bvios, mas me parece uma solu√ß√£o tempor√°ria. Quando o ganho de TabCoins for reformulado, talvez n√£o precisemos mais dela.

>> Coment√°rio de filipedeschamps:
@cybernerd007 o problema √© que desta forma n√£o fica registrado o lastro correto no sistema, principalmente para conseguir desfazer uma opera√ß√£o como essa caso seja necess√°rio. Adicionei um quarto ponto sobre isso.

@Rafatcb estava pensando como perp√©tua mesmo, tipo um `escape hatch`. Mas quando voc√™ fiz:

> Quando o ganho de TabCoins for reformulado, talvez n√£o precisemos mais dela.

O que isso significa exatamente?

>> Coment√°rio de aprendendofelipe:
Acho que o problema n√£o √© falta de tabcoins infinitos para negativar/moderar, mas sim falta de moderadores infinitos para dar conta de educar os usu√°rios e, pior ainda, dar conta dos bots. Ent√£o isso precisa ser autom√°tico e os moderadores s√≥ precisariam atuar nas exce√ß√µes.

Ainda acredito que os novos usu√°rios n√£o deveriam ganhar tabcoins ao publicar conte√∫dos ou coment√°rios. No come√ßo ganha/perde s√≥ os tabcoins dos votos recebidos.

A reputa√ß√£o seria constru√≠da com os votos recebidos de usu√°rios que j√° constru√≠ram reputa√ß√£o. Poderia ser a m√©dia dos votos dos √∫ltimos X conte√∫dos (ou dos √∫ltimos Y dias). Assim seria muito mais dif√≠cil burlar a economia. Ainda poderiam ocorrer abusos, mas teriam que come√ßar com um usu√°rio real que j√° atingiu boa reputa√ß√£o e que teria muito a perder quando o abuso for pego.

S√≥ contaria para a reputa√ß√£o os conte√∫dos com status publicado. Assim os usu√°rios s√£o fo√ßados a se educar, pois excluir um conte√∫do mal avaliado melhora a reputa√ß√£o e excluir um conte√∫do bem avaliado piora a reputa√ß√£o.

Deveria ter um limite negativo de reputa√ß√£o em que o usu√°rio nem poderia mais publicar nada enquanto n√£o entrar na linha. Ao tentar publicar, o usu√°rio receberia um aviso com o link para o c√≥digo de conduta ou (os termos). E ele seria orientado a remover conte√∫dos negativados para melhorar sua reputa√ß√£o.

E no lado oposto, ap√≥s atingir determinado valor de reputa√ß√£o, ao postar conte√∫do ou coment√°rio o usu√°rio j√° a ganha uma quantidade de tabcoins proporcional √† reputa√ß√£o. Podemos come√ßar com um limiar baixo, talvez bastando a m√©dia de votos ser positiva para o usu√°rio j√° ganhar tabcoins.

Na minha opini√£o n√£o adianta dar mais poderes para os moderadores. Na verdade isso criaria outros problemas sem solucionar os atuais.

>> Coment√°rio de filipedeschamps:
@aprendendofelipe essa id√©ia √© genial! Voc√™ se importa em criar uma issue com esse conte√∫do? ü§ù  talvez esse seja o mecanismo mais importante desta Milestone.

Em paralelo, ainda acredito que um escape hatch seja importante üëç

>> Coment√°rio de Rafatcb:
> O que isso significa exatamente?

@filipedeschamps por "reformula√ß√£o", eu quis dizer sobre a poss√≠vel implementa√ß√£o de sugest√µes como a que o @aprendendofelipe mencionou agora, por exemplo. Vi que algo do tipo j√° foi sugerido/discutido anteriormente, mas n√£o acompanhei por completo para saber se um dia seria implementado.

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe essa id√©ia √© genial! Voc√™ se importa em criar uma issue com esse conte√∫do? ü§ù talvez esse seja o mecanismo mais importante desta Milestone.
> 
> Em paralelo, ainda acredito que um escape hatch seja importante üëç

Vou criar a issue üòâüëç

>> Coment√°rio de aprendendofelipe:
Acho que o PR #1366 eliminou essa necessidade por enquanto. O que acham?

>> Coment√°rio de Rafatcb:
> Acho que o PR https://github.com/filipedeschamps/tabnews.com.br/pull/1366 eliminou essa necessidade por enquanto. O que acham?

Eu incluiria tamb√©m que o PR #1460 ajudou bastante nisso, nas situa√ß√µes onde o coment√°rio √© um conte√∫do curto.

Como n√£o houve nenhuma opini√£o contr√°ria desde Abril, vou fechar o issue para organizar o reposit√≥rio. Caso algu√©m queria argumentar algo defendendo a cria√ß√£o dessa funcionalidade, pode comentar aqui que reabrimos o issue para discuss√£o e poss√≠vel implementa√ß√£o.
</issue_1198_Modera√ß√£o conseguir anular as TabCoins de um conte√∫do>

<issue_1199_Dark Mode>
## Contexto

Inicialmente disponibilizar um controle no Frontend apenas para a pessoa alternar entre os modos de visualiza√ß√£o Claro e Escuro e persistir isto em Local Storage. Em outro momento (quando necess√°rio), fazer esta informa√ß√£o persistir no backend (dentro do perfil do usu√°rio), para ser sincronizado entre os devices.

## Execu√ß√£o

Dado a alguns detalhes t√©cnicos da stack que usamos (Next.js e BytMD), esta implementa√ß√£o n√£o √© t√£o simples, mas procurando no hist√≥rico, encontrei estas duas publica√ß√µes:

- #377
- #916

Lembro que teve uma terceira tentativa, mas n√£o estou conseguindo encontrar... mas posso estar enganado sobre a exist√™ncia dela.

>> Coment√°rio de ozzono:
Oi @filipedeschamps , desconhe√ßo o Next.JS ent√£o vou opinar com o que conhe√ßo do Vue.JS.

Que tal acionar o tema da p√°gina utilizando info do navegador ou do sistema oepracional do usu√°rio? Dessa forma o tema escuro j√° seguiria a prefer√™ncia do usu√°rio, concorda?

Ao menos no VueJS a implementa√ß√£o √© relativamente f√°cil e sou capaz de apostar que o NextJS tb d√° uma forcinha.

>> Coment√°rio de alvesa:
com ideia de remover duplicidades, a mesma issue foi aberta #1127

>> Coment√°rio de saraiva1989:
@filipedeschamps ou admins, Eu iniciei a implementa√ß√£o do dark mode;

![image](https://user-images.githubusercontent.com/40599423/216158568-0563804c-338e-4725-8f3c-d918c721c6cc.png)

![image](https://user-images.githubusercontent.com/40599423/216158625-055c25d2-930c-4e41-affa-44804392da43.png)

Ainda tem alguns ajustes a ser feito, colocar no checkbox um css bonitinho e ajustar algumas coisas mais.

basicamente eu criei um CSS e altero as variaveis dependendo do tema

![image](https://user-images.githubusercontent.com/40599423/216158861-86c971b0-b088-4378-85ec-ff4b147d92d5.png)

![image](https://user-images.githubusercontent.com/40599423/216158891-3fb890fe-3d40-47e6-9cb2-cc24df681732.png)

Gostaria de saber se posso dar continuidade na implementa√ß√£o.

>> Coment√°rio de ozzono:
Eu n√£o aprovo nada, mas acho que ficou √≥timo, mesmo com o checkbox padr√£o.

>> Coment√°rio de saraiva1989:
Eu vou deixar melhor n√£o √© dif√≠cil.
S√≥ n√£o fiz tudo porque n√£o sei se est√° nos moldes do projeto, a√≠ mandei como estou fazendo para ver se faz sentido. Caso fa√ßa eu dou continuidade e devo fazer um PR esse fim de semana ainda .

>> Coment√°rio de aprendendofelipe:
> Gostaria de saber se posso dar continuidade na implementa√ß√£o.

@saraiva1989, n√£o precisa pedir permiss√£o para fazer contribui√ß√µes. üëç

Especificamente sobre o dark mode, vale a pena levar em considera√ß√£o tudo que foi discutido no #377 e #916 para n√£o ficar travado nos mesmos pontos. ü§ù

>> Coment√°rio de saraiva1989:
Eu iniciei ent√£o, estou implementando e fazendo os testes.

Agora vou ter que trabalhar um pouco no dark dos "pre" e no markdown na escrita de artigos

https://user-images.githubusercontent.com/40599423/216204197-888a2a39-a6a3-4b9d-b7f2-4f045eca056b.mp4

>> Coment√°rio de birobirobiro:
> 
> 
> Eu iniciei ent√£o, estou implementando e fazendo os testes.
> 
> 
> 
> Agora vou ter que trabalhar um pouco no dark dos "pre" e no markdown na escrita de artigos
> 
> 
> 
> https://user-images.githubusercontent.com/40599423/216204197-888a2a39-a6a3-4b9d-b7f2-4f045eca056b.mp4
> 
> 
> 
> 

Parab√©ns pela iniciativa! Enquanto a sua PR n√£o chega eu desenvolvi uma maneira alternativa de ter o dark mode direto no navegador:

https://www.tabnews.com.br/birobirobiro/tema-catppuccin-para-o-tabnews

>> Coment√°rio de aprendendofelipe:
Foi implementado no PR #1348, e mais ajustes foram realizados nos PRs #1353 e #1394 üéâ

Obrigado a todos que contribu√≠ram de alguma forma para o dark mode! üí™
</issue_1199_Dark Mode>

<issue_1203_[D√∫vida] TabNews>
A equipe de Deschamps tem acesso as digita√ß√µes quando o usu√°rio est√° criando um pots ou coment√°rios em tempo real?

Ap√≥s "deletado" publica√ß√µes, conta do usu√°rio ou coment√°rios. Fica salvo do lado de voc√™s?

Percebi s√≥ agora que h√° termos de uso. Mas n√£o h√° pol√≠tica de privacidade. Como os dados s√£o tratados? Por exemplo, anal√≠ticos da Vercel.

>> Coment√°rio de filipedeschamps:
> A equipe de Deschamps tem acesso as digita√ß√µes quando o usu√°rio est√° criando um pots ou coment√°rios em tempo real?

Voc√™ diz, enquanto o conte√∫do n√£o foi publicado? N√£o, e o `rascunho` fica apenas na m√°quina local do usu√°rio. S√≥ temos algum dado quando o usu√°rio escolhe enviar para o servidor atrav√©s de um `POST` ou `PATCH`.

> Ap√≥s "deletado" publica√ß√µes, conta do usu√°rio ou coment√°rios. Fica salvo do lado de voc√™s?

Sim, tudo √© um `soft delete` no banco de dados.

> Percebi s√≥ agora que h√° termos de uso. Mas n√£o h√° pol√≠tica de privacidade.

Bom ponto! De fato n√£o temos pol√≠tica de privacidade e dever√≠amos ter ü§ù

> Como os dados s√£o tratados? Por exemplo, anal√≠ticos da Vercel.

Somente salvamos de forma persistente dados do usu√°rio que o sistema precisa para funcionar. Nossa pol√≠tica √©: quanto menos dados tivermos, melhor, pois menos atrativo nosso banco de dados ser√°. E tamb√©m n√£o compartilhamos nenhum dado individual com nenhum terceiro, incluindo o Analytics da Vercel, por conta desta aquisi√ß√£o: https://vercel.com/blog/vercel-acquires-splitbee

>> Coment√°rio de Jeiel0rbit:
> Somente salvamos de forma persistente dados do usu√°rio que o sistema precisa para funcionar. Nossa pol√≠tica √©: quanto menos dados tivermos, melhor, pois menos atrativo nosso banco de dados ser√°. E tamb√©m n√£o compartilhamos nenhum dado individual com nenhum terceiro, incluindo o Analytics da Vercel, por conta desta aquisi√ß√£o: https://vercel.com/blog/vercel-acquires-splitbee

O da Vercel eu entendo. Que bom que ter√° futuramente uma pol√≠tica de privacidade. Quanto mais transpar√™ncia, melhor. Assim como h√° transpar√™ncia o que est√° acontecendo ou o que aconteceu em rela√ß√£o ao TabNews (TN) no GitHub e no pr√≥prio TN.

Marcarei como ~~"conclu√≠do".~~

ü§ù

>> Coment√°rio de Jeiel0rbit:
@aprendendofelipe quero que voc√™ tenha ci√™ncia deste caso. Vejo que as movimenta√ß√µes do TabNews est√£o vindo, atrav√©s de voc√™ ü´µ Ent√£o, talvez possa ajudar a criar uma aba sobre **pol√≠tica de privacidade**. Pois n√£o est√° claro at√© o momento que esta _issue_ foi criada para saber sobre "como nossos dados s√£o tratados?".

>> Coment√°rio de aprendendofelipe:
Ol√° @Jetrom17, a pol√≠tica √© como o @filipedeschamps explicou, mas ainda n√£o existe um texto bem elaborado que possa ser inserido em uma p√°gina espec√≠fica sobre a pol√≠tica de privacidade.

Ent√£o essa √© mais uma das oportunidades de contribui√ß√£o que existem. üí™

Eu n√£o tenho certeza se entendi qual √© a sua d√∫vida, mas se quiser iniciar essa colabora√ß√£o, recomendo abrir uma issue com um t√≠tulo que chame a aten√ß√£o de quem quiser contribuir com o assunto.

Com o texto definido e revisado, a√≠ √© s√≥ abrir um PR com a cria√ß√£o da p√°gina. üëç

>> Coment√°rio de Jeiel0rbit:
#
> Ent√£o essa √© mais uma das oportunidades de contribui√ß√£o que existem. üí™
> 
> Eu n√£o tenho certeza se entendi qual √© a sua d√∫vida, mas se quiser iniciar essa colabora√ß√£o, recomendo abrir uma issue com um t√≠tulo que chame a aten√ß√£o de quem quiser contribuir com o assunto.
> 
> Com o texto definido e revisado, a√≠ √© s√≥ abrir um PR com a cria√ß√£o da p√°gina. üëç
> 
#

Certo, irei fazer uma emula√ß√£o em breve. Fecharei esta _issue_ definitivamente. Estou ciente que o `@filipedeschamps` tenha falado sobre isto.
</issue_1203_[D√∫vida] TabNews>

<issue_1204_Como o uso de tags pode melhorar a organiza√ß√£o e acessibilidade de conte√∫do em um sistema>
Trago uma sugest√£o: adicionar um sistema de tags utilizando um NoSQL na Milestone atual.

Assim, seria adicionada uma nova sess√£o chamada Tags, como mostrado na imagem abaixo:
![Screenshot_1](https://user-images.githubusercontent.com/8114976/210120698-0016995e-a156-49d3-8eb5-f2c19c7be635.png)

O **NoSQL** faria o papel de um cache, armazenando o link, as tags e o t√≠tulo da publica√ß√£o sempre que o usu√°rio publicasse algum conte√∫do. 
Al√©m disso, seria poss√≠vel acessar essas tags atrav√©s de uma API, por exemplo:
 `/api/v1/tags/{tag}/relevante` ou `/api/v1/tags/{tag}/recente`

A adi√ß√£o desse recurso transformaria o Tabnews em um tipo de indexador ou registrador, como uma esp√©cie de Wikipedia mais "cool".

Adicionar um sistema de tags traria uma organiza√ß√£o maior aos posts e um acesso mais f√°cil √†s informa√ß√µes desejadas. Al√©m disso, o uso de uma API para acessar as tags permitiria que outros desenvolvedores integrem essas informa√ß√µes a outras aplica√ß√µes ou sistemas.

>> Coment√°rio de cybernerd007:
Vou deixar um exemplo que eu fiz que e totalmente funcional...

Eu utilizei o `EXPRESS` nesse exemplo.

Esse e o arquivo `index.js`
```
const express = require('express');
const fs = require('fs');
const app = express();

app.get('/api', (req, res) => {
  fs.readFile('./dbs/dbtags.json', (err, data) => {
    if (err) throw err;
    res.json(JSON.parse(data));
  });
});

app.listen(3000, () => {
  console.log('API iniciada na porta 3000');
});
```

Esse arquivo na pasta correspondente `./dbs/dbtags.json`
```
{
    "tags": [
      {
        "id": 1,
        "title": "Como Fazer Post no Tabnews",
        "link": "https://tabnews.com.br",
        "tags": "make, tec",
        "estrategia":"new"
      },
      {
        "id": 2,
        "title": "Como Conectar DB em Javascript?",
        "link": "https://tabnews.com.br",
        "tags": "help, make",
        "estrategia":"old"
      },
      {
        "id": 3,
        "title": "Aprenda a Conseguir Seu Primeiro Emprego",
        "link": "https://tabnews.com.br",
        "tags": "help, job",
        "estrategia":"relevant"
      }
    ]
  }
```

Acessando `http://localhost:3000/api` ele retorna isso:
![Screenshot_1](https://user-images.githubusercontent.com/8114976/210154498-b9392251-e427-4e76-9879-1e5f9a1639c2.png)

Para o arquivo n√£o ficar grande minha ideia e que a cada 24 horas ele pegue os dados salvos e transforme em estaticos e limpe o `dbtags.json` e o arquivo estatico tenha um limite de Tags e um limite de Posts

>> Coment√°rio de cybernerd007:
@filipedeschamps se voc√™ desejar implementar essa fun√ß√£o, estou √† disposi√ß√£o para implement√°-la no c√≥digo, o que pode ajudar a aliviar um pouco a carga do @aprendendofelipe
</issue_1204_Como o uso de tags pode melhorar a organiza√ß√£o e acessibilidade de conte√∫do em um sistema>

<issue_1205_Sugest√£o para altera√ß√£o dos termos de uso>
![Screenshot_20221231-183853.png](https://user-images.githubusercontent.com/72875404/210156114-958ee5ae-6409-4a48-9ab9-58f4cbf38f63.png)

Veja publica√ß√µes desse usu√°rio. Conforme o moderador `@Rafael`, n√£o h√° uma diretriz espec√≠fica sobre uso por I.A. N√£o √© primeira vez que vemos o uso dessas tecnologias em publica√ß√µes, como ChatGPT, abusando e querendo obter TabCoins f√°cil, mais o TabCash. 

Acredito que n√£o devemos banir, mas podemos ter limites do uso. Por exemplo, em algumas publica√ß√µes minhas cito informa√ß√µes da resposta gerada por ChatGPT, no entanto a publica√ß√£o n√£o cont√©m 80% do uso desta tecnologia. 

Mude os termos de uso; n√£o somente para quest√µes de I.A, como tamb√©m respostas da internet, famoso "copia e cola". Por fim, sobre scripts automatizados que fazem publica√ß√µes que abusam da API e da banda larga do servidor TabNews, tenham uma certa restri√ß√£o.

#

Deschamps e sua equipe (incluindo os contribuintes) participam do in√≠cio desta plataforma buscando um "lugar mais limpo na internet". Ent√£o, solicito a mudan√ßa dos termos de uso para 2023 come√ßando um "novo tempo" sobre esta causa mencionado anteriormente.

Atenciosamente;

`@Jetrom`
</issue_1205_Sugest√£o para altera√ß√£o dos termos de uso>

<issue_1206_Possivel Problema em Produ√ß√£o>
Venho reportar aqui um possivel problema, bom em resumo os erros no geral pede para acessar os links abaixo para entender melhor os problemas.

Retirei isso direito dos links que o proprio console me deu...
[ERRO 423](https://reactjs.org/docs/error-decoder.html/?invariant=423)
[ERRO 418](https://reactjs.org/docs/error-decoder.html/?invariant=418)
[ERRO 425](https://reactjs.org/docs/error-decoder.html/?invariant=425)

os erros aparecem somente na pagina de `editar perfil` e na `publicar` 

**Decidi reportar pois achei muito estranho, verifiquei as ultimas deploys e eles contem o mesmo problema**

![Screenshot_1](https://user-images.githubusercontent.com/8114976/210188594-dae16203-4f61-42d5-aac5-115a66f23071.png)

>> Coment√°rio de cybernerd007:
Bom aproveitando o topico eu notei que na pagina `publicar` ele sempre carrega o ultimo comentario(n√£o sei se ele carrega post tambem)... sinceramente n√£o consigo entender o porque tal solicita√ß√£o e feita, por esse motivo deixo registrado aqui tambem...

![Screenshot_2](https://user-images.githubusercontent.com/8114976/210191439-ad159bc8-2d44-4ec6-b7df-2f8f944e8c9b.png)

>> Coment√°rio de cybernerd007:
aproveitando o espa√ßo aquele problema da pagina `editar perfil` solicitar 2 vezes o `user` ainda persiste
![Screenshot_3](https://user-images.githubusercontent.com/8114976/210191761-9d42208b-9d30-432c-8d7c-4262616f4320.png)
</issue_1206_Possivel Problema em Produ√ß√£o>

<issue_1207_Desconsidere essa issue.>
Engano...
</issue_1207_Desconsidere essa issue.>

<issue_1208_Erro ao apresentar "tela preta" indevidamente>
Ao navegar pelo tabnews em dois momentos eu me deparei com o seguinte erro:

![Screenshot from 2023-01-02 21-08-30](https://user-images.githubusercontent.com/56479285/210286664-9c8716ce-4e5f-4904-b537-8e5bfbdecd0a.png)

Ao atualizar a p√°gina algumas vezes, o erro n√£o foi mais mostrado, e sim mostrado a p√°gina 404:

![Screenshot from 2023-01-02 21-13-59](https://user-images.githubusercontent.com/56479285/210286684-10780343-1885-4530-ac88-8863649f40a8.png)

Este erro aconteceu duas vezes:

- A primeira vez aconteceu ao acessar um post que havia sido deletado. Ap√≥s receber a "tela preta" e atualizar a p√°gina algumas vezes eu recebo a p√°gina de 404, ou seja, passou a funcionar como esperado.
-  A √∫ltima vez aconteceu ao acessar um [post](https://www.tabnews.com.br/HerbertGeorgeWells/como-a-algebra-linear-e-utilizada-na-ciencia-da-computacao) que est√° publicado e dispon√≠vel. Neste caso, ao acessar o post recebo a "tela preta", ap√≥s atualizar algumas vezes o post eu comecei a receber 404, continuei atualizando a p√°gina, at√© que a p√°gina retornou o post, como esperado.

Pe√ßo perd√£o se n√£o dei informa√ß√µes o suficientes para ajudar a entender o problema, infelizmente tamb√©m n√£o entendi quando e porqu√™ este erro acontece.

>> Coment√°rio de aprendendofelipe:
@raulpy271, obrigado por reportar. üëç

Isso ser√° solucionado com #1154

>> Coment√°rio de Rafatcb:
@aprendendofelipe visto o andamento da https://github.com/filipedeschamps/tabnews.com.br/issues/1154, podemos fechar aqui?

Pela descri√ß√£o da issue, parece que o problema se encaixava nesse cen√°rio que voc√™ comentou:

> Parte do que quebrava a interface (ou tudo) foi corrigido a um tempo atr√°s quando o componente `PublishedSince` parou de dar erros com datas inv√°lidas, caso que ocorria com conte√∫dos exclu√≠dos.
</issue_1208_Erro ao apresentar "tela preta" indevidamente>

<issue_1209_Criar documenta√ß√£o>
Criar documenta√ß√£o sobre recursos do website, como explicar melhor sobre os TabCoins e TabCash, etc.

>> Coment√°rio de Rafatcb:
Realmente √© uma informa√ß√£o importante, mas acho que isso deve estar num FAQ.

Como o FAQ √© mais abrangente do que apenas essa informa√ß√£o espec√≠fica, tem uma issue espec√≠fica para discutir o que ter nele e acompanhar a implementa√ß√£o: https://github.com/filipedeschamps/tabnews.com.br/issues/1380. Acho legal concentrarmos o assunto l√°.

>> Coment√°rio de aprendendofelipe:
Boa @brenio55 e @Rafatcb! üí™

Vamos centralizar na #1380 ü§ù
</issue_1209_Criar documenta√ß√£o>

<issue_1211_Pequenas Corre√ß√µes de Codigo>
Bom vou reportar 2 problemas e ja vou deixar a solu√ß√£o para eles, pode ser que eu esteja errado mas prefiro pecar pelo excesso...
Esse issue tem a finalidade de deixar o client mais rapido e fazer o Filipe economizar um pouco com a vercel.

# Primeiro Problema

Notei que na pagina do `Perfil` uma request duplicada, segue print:

![Screenshot_1](https://user-images.githubusercontent.com/8114976/210393602-600ef604-fb86-49af-ace7-d810ed6a6d3a.png)

Achei no codigo o problema `/pages/perfil/index.public.js`

![Screenshot_2](https://user-images.githubusercontent.com/8114976/210393874-ed48b040-89b7-415b-9344-9c8de03a980f.png)

Parece que o c√≥digo est√° buscando os dados do usu√°rio duas vezes: uma vez no gancho `useEffect` que √© executado quando o componente √© montado, e outra vez no gancho `useEffect` que √© executado quando a fun√ß√£o `fetchUser` √© atualizada.

Vai uma corre√ß√£o que eu escrevi para solucionar:

<pre>
useEffect(() => {
  if (router && !user && !userIsLoading) {
    router.push(`/login?redirect=${router.asPath}`);
  } else if (user && !userIsLoading) {
    fetchUser();
  }
}, [user, router, userIsLoading]);
</pre>

Assim e gerado um beneficio para o client que a pagina vai carrega mais rapido e para o lado do Filipe que vai economizar um **POUCO** com a vercel kkk

---

# Segundo Problema:

Na pagina `Publicar` eu notei que ele faz um request para pegar o ultimo POST porem ele n√£o faz nada com essa informa√ß√£o.

Obs.: bloqueei a URL para saber se haveria algum impacto e nada aconteceu refor√ßando o que eu havia pensando.

![Screenshot_3](https://user-images.githubusercontent.com/8114976/210394600-b6d73a0f-4663-467f-a85b-545d0eb60e46.png)

Uma corre√ß√£o √© remover esse trecho de codigo...

![Screenshot_5](https://user-images.githubusercontent.com/8114976/210395197-e1b42b48-a4e6-494d-9ef7-353b921c505e.png)


Assim finaliza essa issue... ü§ù
</issue_1211_Pequenas Corre√ß√µes de Codigo>

<issue_1212_Markdown editor com um problema na digita√ß√£o>
Hoje fui escrever um artigo para o tabnews e me deparei com o seguinte erro: sempre que tentava corrigir algo que foi escrito l√° atr√°s, o editor "comia" as letras da frente. 

Exemplo: se escrevi `bon dia`, posicionei o cursor em frente ao `n` e o exclu√≠, tudo funcionou bem. Por√©m, ao tentar adicionar o `m` o editor exclu√≠a o espa√ßo logo √† frente, ficando `bomdia`.

>> Coment√°rio de aprendendofelipe:
Oi @letsaguiar, isso ocorreu em smartphone?

Temos um problema conhecido com a biblioteca ByteMD que de vez em quando faz isso no mobile.

>> Coment√°rio de letsaguiar:
N√£o, foi no desktop mesmo

>> Coment√°rio de Rafatcb:
Esse √© o comportamento da tecla <kbd>Insert</kbd> no [modo "substituir"](https://pt.wikipedia.org/wiki/Insert_(teclado)#Modo_%C2%AB_substituir_%C2%BB) (_overtype_). Consegui reproduzir aqui colocando nesse modo. Voc√™ pode confirmar se foi isso o que aconteceu, @letsaguiar ?

O editor do GitHub n√£o atende essa funcionalidade, mas o do ByteMD sim, ent√£o √© preciso testar no TabNews.
</issue_1212_Markdown editor com um problema na digita√ß√£o>

<issue_1213_Permitir a defini√ß√£o de assinatura>
**Como:**
Usu√°rio do TabNews

**Eu gostaria de:**
Definir uma assinatura que aparecesse em todas as postagens

**Para que:**
 Fique mais f√°cil criar nossa uma pessoal na comunidade e facilitar a identifica√ß√£o das pessoas.

**Descri√ß√£o detalhada:**

Seria interessante no perfil poder definir uma assinatura (com limite de tamanho) para permitir uma melhor identifica√ß√£o do usu√°rio. Coisas simples como por exemplo o cargo que ocupa, ou algum contato em rede social. Isso pode contribuir na forma√ß√£o de uma comunidade.

>> Coment√°rio de Rafatcb:
Como esse issue n√£o teve intera√ß√µes durante esse quase um ano, estou fechando para organizar o reposit√≥rio. Se algu√©m deseja adicionar mais argumentos para defender a adi√ß√£o desse recurso, pode comentar que reabrimos para debate.

Deixando minha opini√£o: acredito que o nome do usu√°rio aparecendo na publica√ß√£o j√° √© o suficiente para a identifica√ß√£o. Hoje, o usu√°rio pode modificar sua descri√ß√£o no perfil para compartilhar qualquer informa√ß√£o que deseja. A descri√ß√£o n√£o existia na √©poca da cria√ß√£o desse issue.

Obrigado pela sugest√£o, Bruno!
</issue_1213_Permitir a defini√ß√£o de assinatura>

<issue_1214_[Sugest√£o] Criar uma forma de acompanhar post's que tiveram intera√ß√£o pelo usu√°rio>
Em alguns momentos consumindo conte√∫do no Tabnews senti vontade de retornar em algumas publica√ß√µes que comentei para ler outras opini√µes acerca daqueles temas, por√©m, me deparei com um problema: n√£o consegui achar uma forma f√°cil de chegar a elas. Com isso, acho importante ter alguma forma de acompanhar publica√ß√µes em que um usu√°rio interagiu para que assim, os di√°logos e contribui√ß√µes sobre aqueles temas se mantenham e n√£o se percam, ainda mais, caso chegarmos em um cen√°rio em que, navegar entre p√°ginas, procurando de uma a uma, se torne invi√°vel. Fun√ß√µes como ‚Äúler mais tarde‚Äù, hist√≥rico ou favoritos s√£o v√°lidas para mim.
</issue_1214_[Sugest√£o] Criar uma forma de acompanhar post's que tiveram intera√ß√£o pelo usu√°rio>

<issue_1216_Definir pelas vari√°veis de ambiente quais endpoints passam pelo rate-limit do Upstash>
## Contexto 

Com isso podemos configurar os caminhos afetados pelo rate-limit de maneira diferente no ambiente de produ√ß√£o e homologa√ß√£o, assim como podemos ter uma configura√ß√£o espec√≠fica para uma *branch* qualquer.

A altera√ß√£o permite uma redu√ß√£o de custos com o Upstash, j√° que para a maioria dos endpoints a Cloudflare j√° nos protege de maneira apropriada.

## Execu√ß√£o

 - #1101
</issue_1216_Definir pelas vari√°veis de ambiente quais endpoints passam pelo rate-limit do Upstash>

<issue_1217_Corrigir o espa√ßamento e alinhamento entre label e checkbox de notifica√ß√µes por email>
## Contexto

- #1065

## Execu√ß√£o

- #1173
</issue_1217_Corrigir o espa√ßamento e alinhamento entre label e checkbox de notifica√ß√µes por email>

<issue_1218_Melhoras de UX - Habilita zoom na vers√£o mobile e restaura scroll da p√°gina ao voltar>
## Contexto e Execu√ß√£o

- #1176
</issue_1218_Melhoras de UX - Habilita zoom na vers√£o mobile e restaura scroll da p√°gina ao voltar>

<issue_1219_Adiciona link para RSS no footer>
## Contexto

- #1175

## Execu√ß√£o

- #1174
</issue_1219_Adiciona link para RSS no footer>

<issue_1220_Refresh autom√°tico dos dados do usu√°rio logado>
## Contexto

- #801

## Execu√ß√£o

- #804,
- #1193 e
- #1200
</issue_1220_Refresh autom√°tico dos dados do usu√°rio logado>

<issue_1221_Corrige a mensagem de recupera√ß√£o de senha>
## Contexto e Execu√ß√£o

#819
</issue_1221_Corrige a mensagem de recupera√ß√£o de senha>

<issue_1222_Preenchimento de tag>
Sugiro que tenha uma possibilidade de ser preenchido automaticamente as tag.

Exemplo:

Ao digitar `<p>` o valor √© fechado automaticamente complementando `</p>`. Assim facilitando a nossa digita√ß√£o, economizando tempo. Assim como h√° em markdown no TabNews. Ao digitar teclas de atalho, h√° o preenchimento. A diferen√ßa que √© usado teclas de atalho para preenchimento r√°pido em markdown `**p**` e seria para tag o uso detectado preenchido autom√°tico `<p></p>`.

>> Coment√°rio de Rafatcb:
Eu n√£o acho que essa ideia ficaria legal na pr√°tica. Deixando de lado a complexidade que traria ao c√≥digo, existem dois aspectos poss√≠veis de como isso seria usado, e acho que n√£o seria bom em nenhum deles:

1. Do ponto de vista da cria√ß√£o de uma publica√ß√£o normal, o ideal √© usar Markdown, e n√£o HTML, ent√£o n√£o tem necessidade de autocompletar tags.
2. Do ponto de vista de compartilhamento de c√≥digo, o ideal n√£o √© escrever pelo TabNews, mas sim por um editor e copiar e colar, fazendo ajustes pontuais se necess√°rio. O pr√≥prio GitHub e o Stack Overflow, que s√£o bem voltados para c√≥digo, n√£o possuem esse tipo de "autocomplete".

Acho que os autocompletes de Markdown que temos hoje j√° s√£o bem legais e √∫teis ‚Äî por exemplo, experimente come√ßar a fazer uma lista `1. item` e dar enter: ir√° aparecer o `2.` na nova linha.
</issue_1222_Preenchimento de tag>

<issue_1223_Obter tamanho correto da janela ao jogar confetes>
## Contexto

Voc√™s j√° devem ter percebido que o TabNews joga confetes quando executamos algumas a√ß√µes como ativa√ß√£o do cadastro, publica√ß√£o de conte√∫do etc.

Mas para os confetes preencherem totalmente a janela precisamos passar as dimens√µes para o componente. Tamb√©m precisamos lidar com um poss√≠vel redimensionamento da janela durante a queda dos confetes.

Com isso t√≠nhamos dois problemas:

1. Est√°vamos observando o redimensionamento das janelas em todas as p√°ginas em que o componente `Confetti` √© utilizado, mesmo que a condi√ß√£o de disparo dos confetes n√£o fosse atingida. E isso disparava renderiza√ß√µes desnecess√°rias ao redimensionar as janelas. 
2. As dimens√µes passadas para o componente `Confetti` eram as dimens√µes da tela e n√£o da janela.

A solu√ß√£o foi criar um componente customizado que verifica as dimens√µes da janela por dentro dele, evitando assim renderiza√ß√µes desnecess√°rias, e agora o componente utiliza altura e largura de maneira corretamente responsiva.

## Execu√ß√£o

- #889
</issue_1223_Obter tamanho correto da janela ao jogar confetes>

<issue_1224_Adicionado bot√£o de rolar para o topo da p√°gina>
## Contexto e Execu√ß√£o

- #1039
</issue_1224_Adicionado bot√£o de rolar para o topo da p√°gina>

<issue_1225_[FrontEnd] Fazer o cabe√ßalho fixar no topo da tela>
Quando o usu√°rio realiza o _scroll_ qualquer pagina, o _header_ n√£o fica preso ao topo da p√°gina, fazendo com que o usu√°rio tenha que subir at√© o topo da p√°gina para conseguir acesso aos bot√µes de home e configura√ß√µes de perfil, e outros bot√µes colocados no _header_. Uma poss√≠vel solu√ß√£o √© colocar as seguintes linhas de _CSS_:

```css
position: sticky;
top: 0;
```

Esse c√≥digo faria com que o _header_ fique preso ao topo da telai dependente do usu√°rio descer a p√°gina ou n√£o, enquanto faz com que no topo da p√°gina n√£o ocorra o risco do _header_ ficar em cima de algum conte√∫do.

>> Coment√°rio de ghost:
#1039

>> Coment√°rio de SpaceFox1:
N√£o acredito que o _pull request_ mencionando acima tenha alguma rela√ß√£o com a sugest√£o, visto que o _pull request_ √© sobre um bot√£o que leva o usu√°rio para o topo da tela e esse _issue_ sobre manter o cabe√ßalho (header) sempre em tela.

>> Coment√°rio de aprendendofelipe:
Eu acho que fixar o header prejudica a experi√™ncia em telas pequenas.

Veja, como exemplo, o quanto pode ser perdido na visualiza√ß√£o de uma imagem:

![image](https://user-images.githubusercontent.com/77860630/222497468-1ed2a110-9d05-4a8e-ae4e-ec52989507a6.png)

>> Coment√°rio de Caixetadev:
> Eu acho que fixar o header prejudica a experi√™ncia em telas pequenas.
> 
> Veja, como exemplo, o quanto pode ser perdido na visualiza√ß√£o de uma imagem:
> 
> ![image](https://user-images.githubusercontent.com/77860630/222497468-1ed2a110-9d05-4a8e-ae4e-ec52989507a6.png)

Vejo o pessoal solicitando a funcionalidade de um header fixo e uma poss√≠vel solu√ß√£o seria a utiliza√ß√£o do header que desaparecem quando a p√°gina √© rolada para baixo e reaparecem quando h√° uma pequena rolagem para cima. Muitos blogs j√° adotaram essa pr√°tica.

aqui esta um exemplo de site que usa: https://blog.rocketseat.com.br/

>> Coment√°rio de SpaceFox1:
Essa ideia de o header s√≥ aparecer quando voc√™ arrasta para cima a tela √© realmente melhor do que somente manter ele fixo na tela a todos os momentos.

>> Coment√°rio de hisirdox:
O header aparecendo atrapalha o foco onde a m√≠dia principal √© texto, com ele oculto somente o conte√∫do principal aparece em tela, o que leva a uma experiencia bem mais agrad√°vel e limpa de leitura, al√©m de o bot√£o de "voltar ao topo" resolver esse problema da navega√ß√£o de conte√∫dos, ele √© praticamente invis√≠vel deixando o espa√ßo de tela vazio e sem janelas desnecess√°rias.

>> Coment√°rio de SpaceFox1:
Da forma como implementei no pull request mencionado (o √∫ltimo mencionado em aberto, e com um link para pre-visualizar como ficaria), o header s√≥ aparece quando voc√™ sobe (scrolla) a pagina para cima, e desaparece completamente quando desce a p√°gina, exatamente como os navegadores mobile se comportam com a barra de URL e abas, que s√≥ aparecem quando subindo na p√°gina e ao descer a tela eles somem, outro problema √© que o bot√£o de voltar ao topo pode causar √© que voc√™ perde a posi√ß√£o do seu scroll para poder navegar entre p√°ginas, ele acaba sendo mais lento de utilizar j√° que tem que esperar toda a anima√ß√£o da p√°gina subindo para poder ter acesso ao bot√£o para voltar para a home, e justamente o fato do bot√£o ser quase invisivel acaba n√£o deixando muito √≥bvio principalmente em tela mobile que ele existe, e tem um poss√≠vel fator a ser considerado, que √©, a maioria dos sites usa um header fixo ou que aparece ao subir a tela, at√© os pr√≥prios navegadores mobile fazem isso, ent√£o fazer o usu√°rio ter que apertar na parte inferior para esperar uma anima√ß√£o para ter acesso ao bot√£o de home, acaba sendo menos intuitivo do que usar o mesmo estilo de scroll usado pelo pr√≥prio aplicativo do navegador e diversos outros sites. Sem contar que na maioria das vezes voc√™ est√° apenas descendo a tela para ver o conte√∫do, o que faz com que o header permane√ßa oculto, deixando o espa√ßo visual completamente livre para a visualiza√ß√£o do mesmo.

>> Coment√°rio de rodrigoKulb:
@emanuelfranklyn legal sua sugest√£o, fico muito feliz em ver a quantidade de contribui√ß√£o que vem aparecendo no git do projeto tabnews.com.br. Como toda a parte de UX acaba gerando grandes pol√™micas.

Gosto sempre de estudar refer√™ncias (Benchmarking) do que j√° √© aplicado no mercado com grandes players de uso global:
- Google Desk: Menu fixo por√©m menor
- Google Mobile: N√£o possui
- Youtube (Desk e Mobile): Menu fixo
- Github (Desk e Mobile):  N√£o possu√≠
- Nytimes (Desk e Mobile): Menu fixo por√©m menor

Nesse pequeno benchmarking temos o seguinte resultado:
<table>
<tr><td>Tipo</td><td>Mobile</td><td>Desktop</td></tr>
<tr><td>Fixo porem menor</td><td>1</td><td>2</td></tr>
<tr><td>Fixo</td><td>1</td><td>1</td></tr>
<tr><td>N√£o possu√≠</td><td>2</td><td>1</td></tr>
</table>

Gostei bastante do resultado apresentado desse bench, talvez podemos seguir com uma poss√≠vel implementa√ß√£o para desktop nesse momento e pensar novamente no mobile em breve com algumas tentativas e um estudo mais aprofundados.

O maior peso nesse bench foi o Google que acabou gerando o desempate, gosto muito de utilizar o Google como refer√™ncia de navega√ß√£o pois ele tem uma preocupa√ß√£o de n√£o segmentar nenhum tipo de usu√°rio, TODOS s√£o poss√≠veis clientes Google. jovens, idosos etc... 

Lembrando que essa √© apenas a minha opini√£o, podemos discutir mais o tema aqui nessa issue.

>> Coment√°rio de SpaceFox1:
@rodrigoKulb achei bastante interessante esse benchmark que voc√™ fez, e gostaria de dar minha opni√£o, eu acho valido usar os produtos google como base, e acho que um fator importante a ser levado em considera√ß√£o √© onde o header √© utilizado, por exemplo no google o header que seria onde a barra de busca se encontra no mobile, e n√£o possue muita utilidade visto que ela se mantem somente na tela onde os links s√£o exibidos, que possue um tamanho de pagina limitado e n√£o muito grande, seria equivalente ao menu recentes e relevantes do tabnews, onde realmente acredito que a barra de header possa ficar somente no topo visto que n√£o √© necessario escrollar bastante para ir do topo ao fim da pagina, porem quando dentro dos posts em si, acho importante j√° que muitos posts acabam sendo altos (muito texto) ou com muitos comentarios, fazendo o tempo de ir de uma parte mais em baixo da pagina at√© o topo mais complicada, por exemplo no youtube que √© um endless scroller √© importante o menu fixo j√° que subir tudo √© lento j√° que voc√™ pode estar muito para baixo no scroll, e isso √© um tema que vejo bastante em varios sites, quando o site possue um conte√∫do que pode apresentar uma grande quantidade de scroll o menu de navega√ß√£o tende a permanecer em facil acesso do usu√°rio, pelomenos √© o que eu acredito, e sobre a preucupa√ß√£o de se o header fixo atrapalharia a visualiza√ß√£o do conte√∫do, acredito que a solu√ß√£o de somente exibir ao arrastar a pagina para cima √© eficiente visto que quando arrastado para baixo a tela inteira √© reservada para o conte√∫do ja no mobile quando subindo o usuario ver√° tanto os menus do browser que aparecem ao subir a tela quanto os menus do tabnews e um simples mini arrastada para baixo faz ambos sumirem.
</issue_1225_[FrontEnd] Fazer o cabe√ßalho fixar no topo da tela>

<issue_1226_[Bug] P√°gina retorna ao topo ap√≥s ser recarregada>
Principalmente em p√°ginas que possuem conte√∫dos extensos, vejo ser um pouco incomodo precisar sempre retornar no ponto exato onde parei a leitura, devido a qualquer recarregamento que acontece (seja manual ou por qualquer outro motivo).

![Gravacao](https://user-images.githubusercontent.com/36301054/211643124-596329ab-268d-428e-8003-08b42325863f.gif)

>> Coment√°rio de ghost:
Estranho, era pra estar mantendo o estado do scroll j√° que `scrollRestoration` est√° setado na config do NextJS.

>> Coment√°rio de ghost:
tem uma PR do ano passado no NextJS que resolve isso: https://github.com/vercel/next.js/pull/37127

>> Coment√°rio de nycolexavier:
esse problema foi resolvido?

>> Coment√°rio de aprendendofelipe:
> esse problema foi resolvido?

Ainda √© um bug que precisa de investiga√ß√£o
</issue_1226_[Bug] P√°gina retorna ao topo ap√≥s ser recarregada>

<issue_1229_[Sugest√£o] Salvar uma publica√ß√£o como favorita>
A ideia seria adicionar uma forma de salvar uma publica√ß√£o como favorita pro usu√°rio.
Eu estava procurando uma publica√ß√£o que vi a algum tempo nos meus favoritos do navegador e n√£o encontrei. Por isso acho que seria interessante algum mecanismo que possibilite favoritar uma publica√ß√£o diretamente na plataforma.

>> Coment√°rio de tigocode:
@rCirelli, concordo com voc√™!
Acredito que uma funcionalidade como essa seria bacana.

>> Coment√°rio de pedrolucaslco:
Agora mesmo quis uma op√ß√£o de salvar uma publica√ß√£o e n√£o existia. Seria bastante interessante para consulta futura.

>> Coment√°rio de luisArthurRodriguesDaSilva:
Po, eu vim aqui escrever uma issue falando do mesmo
Sinal que √© algo bem desej√°vel
Tem mta coisa boa la no tabnews que eu queria salvar mas n posso, ou mando pro wpp que ja tem um monte de outras anota√ß√µes misturadas

>> Coment√°rio de ItanuRomero:
Acabei de encontrar um artigo incr√≠vel que eu gostaria de salvar, como estamos com essa ideia?

>> Coment√°rio de luisArthurRodriguesDaSilva:
Creio q parados kkkk

>> Coment√°rio de ItanuRomero:
Vish, kkkkkkkkk, vou terminar o curso.dev e aprender como mexer na plataforma pra poder fazer um PR aqui criando essa funcionalidade

>> Coment√°rio de aprendendofelipe:
Obrigado pela issue! üëç

Por organiza√ß√£o, estou fechando as duplicadas com a #645 ü§ù
</issue_1229_[Sugest√£o] Salvar uma publica√ß√£o como favorita>

<issue_1231_Erro de persist√™ncia>
Dei downvote em um post que tinha propaganda. A√≠, voltei para a lista de recentes e vi que neste post n√£o tinha avalia√ß√µes neles.

Outro caso foi quando procurava um post. Fui para primeira p√°gina, n√£o achei e fui para segunda p√°gina e tamb√©m n√£o achei. Quando voltei para primeira p√°gina, achei o post.

>> Coment√°rio de aprendendofelipe:
Ol√° @LuhBC-pixel, voc√™ encontrou algum problema de persist√™ncia mesmo considerando que existe cache das p√°ginas?

O que voc√™ descreveu parece normal se levar em considera√ß√£o que existe cache.

>> Coment√°rio de LuhBC-pixel:
√â verdade, esqueci da exist√™ncia do cache.
</issue_1231_Erro de persist√™ncia>

<issue_1232_Barra de pesquisa e Visualiza√ß√µes>
- Seria muito √∫til ter algum mecanismo de pesquisa, pois assim seria mais f√°cil encontrar uma publica√ß√£o ou um usu√°rio em especifico. 
- Minha sugest√£o para visualiza√ß√µes nas publica√ß√µes √© por conta de que acho que ajudaria a ver quais s√£o as publica√ß√µes com t√≠tulos mais chamativos e os assuntos que mais chamam a aten√ß√µes, pois muitas publica√ß√µes s√£o muito interessantes mas n√£o tem coment√°rios.

>> Coment√°rio de desenvolvedormatheus:
Na minha opni√£o, √© legal n√£o ter esse esquema de visualiza√ß√µes pra n√£o terem post muito tempo sobre outros. Assim como est√° temos uma igualdade justa no rank das publica√ß√µes.

>> Coment√°rio de azevgabriel:
Acho relevante tbm, eu queria fazer uma pesquisa no F√≥rum sobre Background Jobs (filas) no Node.js mas n√£o existe essa funcionalidade.

>> Coment√°rio de Irineu333:
Tamb√©m sinto falta de um sistema de pesquisa

>> Coment√°rio de Mezzalir:
Uma barra de pesquisa seria extremamente √∫til.

>> Coment√°rio de aprendendofelipe:
@HenryGuidelli, obrigado pela sugest√£o! üí™

Estou fechando por ser duplicada com a #927.

Sugiro continuarmos a discuss√£o por l√°. Combinado? ü§ù
</issue_1232_Barra de pesquisa e Visualiza√ß√µes>

<issue_1233_Abrir links em tela externa.>
Seria interessante ao clicar num link de dentro de uma publica√ß√£o, manter a TabNews aberta, e abrir em uma nova aba. 
Sem tirar a gente da TabNews (que est√° fixada no meu Browser, e quando clico fica esse novo link fixado).

>> Coment√°rio de luiznasciment0:
Vou mandar uma PR abrangendo essa issue, porque foi uma "dor" que senti enquanto estava utilizando a plataforma

>> Coment√°rio de aprendendofelipe:
@felipemaion, obrigado pela issue!

Vamos centralizar a discuss√£o na issue relacionada #477 üëç

Recomendo ler esse [coment√°rio do Filipe.](https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074)
</issue_1233_Abrir links em tela externa.>

<issue_1234_[Sugest√£o] Tags nas publica√ß√µes>
Inclus√£o de tags nas publica√ß√µes, para posteriormente facilitar a busca por um determinado t√≥pico ou assunto.
Estamos vendo o TabNews crescer bastante, e cada dia mais vejo mais conte√∫dos "n√£o-perec√≠veis" sendo criados, como posts com dicas ou tutoriais, que apenas alguns dias ou horas ap√≥s postado, somem no eterno limbo da p√°gina 2 pra frente dos recentes ou relevantes.
Acho que, para um futuro onde imaginamos o TN com sistema de buscas, come√ßar a ter tags agora pode ser uma boa op√ß√£o para j√° come√ßar a realizar essa indexa√ß√£o internamente e a fun√ß√£o de pesquisa j√° come√ßar com um conte√∫do-base futuramente.

Eu busquei mas n√£o encontrei nada relacionado a isso aqui nas issues, ent√£o se j√° fizeram essa sugest√£o eu pe√ßo que me avisem, para que eu possa apenas incluir o link para a issue mais antiga e fechar essa daqui!

>> Coment√°rio de Dev-Lyh:
Bom dia @kaiopiola! Tudo bem?

Acho que essa issue tem o mesmo intuito desta outra issue j√° aberta: <a href="https://github.com/filipedeschamps/tabnews.com.br/issues/981">[Sugest√µes] Labels nos posts #981</a>

Com tantos usu√°rios do TabNews pedindo essa feature, o Filipe provavelmente vai considerar torn√°-la realidade :)

>> Coment√°rio de kaiopiola:
> Bom dia @kaiopiola! Tudo bem?
> 
> Acho que essa issue tem o mesmo intuito desta outra issue j√° aberta: [[Sugest√µes] Labels nos posts #981](https://github.com/filipedeschamps/tabnews.com.br/issues/981)
> 
> Com tantos usu√°rios do TabNews pedindo essa feature, o Filipe provavelmente vai considerar torn√°-la realidade :)

√â exatamente isso que eu estava pensando, muit√≠ssimo obrigado, vou fechar essa Issue e acompanhar pela #981 !!
</issue_1234_[Sugest√£o] Tags nas publica√ß√µes>

<issue_1236_Links nos artigos n√£o tem o atributo rel="NOFOLLOW">
Ol√° pessoal, venho acompanhando ativamente o **TabNews** e tamb√©m criando conte√∫do l√°, mas identifiquei um ponto que algu√©m pode usar de forma maliciosa, afim de posicionar alguma coisa no google.

Veja s√≥:
Quando escrevemos um texto e colocamos um link externo neste texto ele n√£o adiciona o atributo NOFOLLOW. Isso √© importante porque o n√£o uso do _NOFOLLOW_, quer dizer que o **TabNews** ENDOSSA o conte√∫do externo em termos de SEO.

Uma cita√ß√£o do artigo:

> O Google estava atento a essa mudan√ßa no padr√£o e entendeu que isso desvirtuava a natureza pr√≥pria dos links na internet (e o motivo pelo qual os links eram um fator importante na classifica√ß√£o dos sites) e resolveu agir, criando o valor ‚Äúnofollow‚Äù para o atributo de link ‚Äúrel‚Äù que tem o intuito de sinalizar para o googlebot que o site n√£o endossa o destino daquele link, n√£o passando ‚Äújuice‚Äù, pagerank, for√ßa, etc. N√£o influenciando em seu ranqueamento nos resultados de busca.

Um breve artigo aqui: https://pt.semrush.com/blog/lins-nofollow-beneficiam-seo-ou-nao/

No **TabNews** j√° come√ßo a ver algumas pessoas(de prop√≥sito ou n√£o) utilizando este recurso para melhorar o posicionamento deles com algumas palavras chaves. Veja um exemplo: https://www.tabnews.com.br/bokamoto/pitch-comunidade-indie-hacker-brasileira

Minha sugest√£o √©: Todo link externo que for colocado no artigo, adiciona o `rel="nofollow"` para evitar esse abuso, e ter ainda mais credibilidade no **TabNews** em termos de SEO

O que voc√™s acham?

>> Coment√°rio de Rafatcb:
Acho √≥timo. Parece que precisar√≠amos [escrever um plugin](https://github.com/bytedance/bytemd?tab=readme-ov-file#plugin-system) para o ByteMD.

Vale mencionar que:

- Deve ser poss√≠vel usar ou n√£o usar o `rel="nofollow"`, porque hoje algumas p√°ginas tem seu conte√∫do feito com markdown e interpretadas pelo `Viewer` do ByteMD, ent√£o n√£o h√° necessidade desse cuidado nessas p√°ginas.
- Muito provavelmente essa prote√ß√£o deve ser implementada tanto nos conte√∫dos quanto na descri√ß√£o do perfil do usu√°rio (que, na √©poca da cria√ß√£o desse issue, n√£o existia).
</issue_1236_Links nos artigos n√£o tem o atributo rel="NOFOLLOW">

<issue_1237_[SUGEST√ÉO] Posts mostram um preview de algumas linhas ao passar com o mouse>
Algo que existe em f√≥rums √© mostrar um preview de algumas linhas ou at√© X caracteres ao passar com o mouse no t√≠tulo do post.

Isso daria aos usu√°rios uma ideia melhor do assunto que ser√° tratado no post e acredito que incentive eles a entrarem no post para saber mais. E tamb√©m ajuda a "salvar" posts com t√≠tulos muito curtos ou que n√£o descrevem muito bem o conte√∫do que ser√° tratado, como:

- "Introdu√ß√£o ao Python" (ele vai dar uma introdu√ß√£o completa ou  provavelmente s√≥ focar em um ou outro assunto?)
- "Como sair do Vim?" (Parece uma pergunta de iniciante, mas na verdade faz uma introdu√ß√£o ao editor)

Na pr√≥pria p√°gina de Issues do Github j√° existe essa funcionalidade e tamb√©m f√≥runs de internet tamb√©m t√™m, por exemplo: https://www.hardmob.com.br/forums/227-Programacao-Desenvolvimento

O preview desse exemplo acima √© bem simples, mas √© o meu preferido, simplesmente mostra o conte√∫do do post, sem nenhuma firula.

>> Coment√°rio de gpoleszuk:
Ol√° @edumats e @Rafatcb!

Notei que o simples passar do mouse sobre o t√≠tulo de uma publica√ß√£o no Tabnews baixa todo conte√∫do da mesma em json para a mem√≥ria do navegador. Para reproduzir esse detalhe, deixo uma receita:
- F12 para abrir o inspetor do navegador
- selecione a aba Network
- passar o ponteiro do mouse sobre qualquer link
- observar o tr√°feto de dados. Cada link tem seu conte√∫do json baixado completamente para o navegador.

Outro detalhe. Caso passe o ponteiro do mouse sobre a palavra "Pr√≥ximo >" no fim da listagem dos t√≠tulos dos posts, baixar√° todos os conte√∫dos em um √∫nico json da pr√≥xima p√°gina sem mesmo visit√°-la. O mesmo vale para outros links.

Isso tudo √© normal ou uma anomalia do navegador Google Chrome, ou seja, baixar tudo que o ponteiro do mouse indica para o navegador (n√£o √© cache)? Sabendo desse recurso explorado intensamente pelo navegador, vi tamb√©m como uma facilidade para acessar as postagens antigas em formato cru. Deixei um script baixando lentamente os _posts_ passados.

Fiz um v√≠deo para ilustrar isto, pois h√° um bom tempo tenho notado esse comportamento. Para mim est√° √≥timo do jeito que est√°, pois consigo ler as postagens sem mesmo abr√≠-las renderizadas. Contudo, para o Tabnews, pode ser um consumo extra de processamento/banda todas as vezes que o mouse sequer pairar sobre qualquer link na p√°gina.

[Uploading Screencast from 09-05-2024 01:52:41.webm‚Ä¶]()

PS: Como √© a primeira vez que subo um v√≠deo em um coment√°rio, n√£o sei se ser√° inclu√≠do corretamente, mas acho que a descri√ß√£o ficou clara.

>> Coment√°rio de Rafatcb:
@gpoleszuk esse comportamento √© por causa do componente `Link` do Next.js, com a propriedade [`prefetch={false}`](https://nextjs.org/docs/pages/api-reference/components/link#prefetch). N√£o sei dizer se √© exatamente o ideal, mas creio ser intencional para deixar o carregamento do site mais r√°pido durante a navega√ß√£o.

Seria interessante aproveitar esse comportamento para conseguir exibir os dados no hover, j√° que evitar√≠amos realizar duas requisi√ß√µes sobre o mesmo conte√∫do, mas acho que n√£o √© poss√≠vel acessar esses dados do `prefetch` do Next.js (pesquisei e n√£o encontrei uma forma de fazer isso).

---

O seu v√≠deo n√£o foi carregado, provavelmente voc√™ criou o coment√°rio enquanto ele carregava, ou o GitHub cancelou o carregamento (√†s vezes acontece). Para saber se o carregamento do v√≠deo funcionou antes de publicar seu coment√°rio, pode ver no `Preview` ou identificar pelo markdown se est√° com um link do tipo `https://github.com/filipedeschamps/tabnews.com.br/assets/...`

>> Coment√°rio de gpoleszuk:
@Rafatcb muito grato por seu esclarecimento a respeito do _prefetch_ do Next.js. Eu n√£o conhecia essa funcionalidade e vou ficar mais atento aos _links_ postados no Tabnews. Certamente, o carregamento √© bem r√°pido, deixando todo trabalho para o _browser_ renderizar a p√°gina a partir do json entregue pelo _backend_. Se o recurso est√° intencionalmente habilitado, est√° perfeito, pois voc√™s pensaram muito bem para defin√≠-lo assim.

Agrade√ßo tamb√©m pela sua paci√™ncia para eu aprender corretamente a subir o v√≠deo aqui. Agora foi certinho seguindo sua receita :)

[Screencast from 09-05-2024 01:52:41.webm](https://github.com/filipedeschamps/tabnews.com.br/assets/11140737/5ea246af-1b59-4454-ba91-2f27336d0f91)
</issue_1237_[SUGEST√ÉO] Posts mostram um preview de algumas linhas ao passar com o mouse>

<issue_1238_[Sugest√£o de UX] Bot√£o de "Publicar novo conte√∫do" direto no header>
Fiquei um pouco confuso de primeira sem saber onde ir para criar uma nova publica√ß√£o pelo fato da fun√ß√£o Publicar novo conte√∫do estar vis√≠vel apenas quando se clica na foto de usu√°rio. Acredito que seria mais pr√°tico e intuitivo um bot√£o de "+" ou algo semelhante diretamente no header para um acesso mais r√°pido.

>> Coment√°rio de aprendendofelipe:
@pedrolucaslcosta, obrigado pela issue! üí™

No #1349 o @victorhcb implementou um bot√£o no header de dispositivos com telas maiores üéâ

Ent√£o vou encerrar aqui ü§ù
</issue_1238_[Sugest√£o de UX] Bot√£o de "Publicar novo conte√∫do" direto no header>

<issue_1239_[Melhoria] - Sistema de buscas>
Se t√≥pico estiver duplicado favor ignorar e fechar

A ideia seria implementar um sistemas de buscas pois, achei um artigo bem interessante uns dias atr√°s e quando fui procurar de novo deu maior trabalho para encontrar. Um outro ponto √© quando vejo um artigo interessante e quero ver se h√° alguns parecidos e sem sistema de buscas fica bem complicado de descobrir.

Acredito que com um sistema de buscas iria ajudar bastante.

A iniciativa est√° muito show!! Gostando demais desse projeto! üòÑ

>> Coment√°rio de gabrielccarvalho:
Talvez precise de alguma revis√£o em termos de design, mas acredito que a ideia da issue foi resolvida nesse PR.

>> Coment√°rio de Lukardoso:
√ìtimo, ia sugerir isso agora. Mecanismo de busca facilita muito, ou divis√£o por assunto ou os dois rsrsrs.

>> Coment√°rio de thiagohmcruz:
+1 uma busca mesmo que b√°sica ia fazer bastante diferen√ßa!

>> Coment√°rio de patrick095:
> Talvez precise de alguma revis√£o em termos de design, mas acredito que a ideia da issue foi resolvida nesse PR.

@gabrielccarvalho , coloquei algumas anota√ß√µes no teu PR, n√£o testei nem nada, mas s√£o umas melhorias que podem ser vistas, valeu.

E uma dica que sigo e acho bem legar √©, quando fizer alguma altera√ß√£o no visual do projeto √© sempre bom colocar prints no PR para que quem for avaliar tenha uma no√ß√£o melhor de como ficou a altera√ß√£o.

>> Coment√°rio de matheuswr89:
N√£o sei se isso j√° existe, mas creio que adicionar uma aba "History" onde a gente pode ver todos os post que a gente j√° visualizou, seria uma boa tamb√©m. Pq a√≠ a gente n√£o teria que ir diretamente no sistema de busca e ter que repetir os passos at√© chegar no que queremos ver.

>> Coment√°rio de Rafatcb:
@aprendendofelipe vi que voc√™ fechou alguns issues para concentrar a discuss√£o sobre buscas no #927, ent√£o acho que faz sentido fechar este tamb√©m, certo?

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb! üí™

Direcionando a discuss√£o para:

- #927
</issue_1239_[Melhoria] - Sistema de buscas>

<issue_1240_"Tab Sobre" - Lat√™ncia alta>
Meu Desktop cont√©m 4 GB de RAM (DDR3) e o CPU de 2 n√∫cleos. O Consumo por m√©dia √© de ~54%. Sendo o processador `Intel¬© Celeron¬© CPU  J1800  @ 2.41GHz √ó 2`. Meu sistema operacional √© Linux (Mint) e o navegador usado, Brave (Beta).

Quando acesso aba de **Sobre** h√° uma lat√™ncia alta para ser carregada por completo.  Usei o Dev Tools para verificar. `129.90 ms` √© o dado da demora de resposta do servidor. A solicita√ß√£o enviada foi de `1.98 ms`. No total esperei cerca de 11 segundos para p√°gina ser completada. Al√©m dos coment√°rios √© claro.

https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa

A url a cima pode afetar outros usu√°rios novos, tendo impacto negativo sobre a plataforma. **Solicito** aten√ß√£o da equipe de Deschamps para averiguar o problema.

+ Atualizando esta _issue_, percebi que **sem javascript**, p√°gina carrega cem vezes, mais r√°pido.

Nota: Estou usando DNS (Warp), apenas, da Cloudflare, o mesmo usado no TabNews. Estou no Brasil.

> Espero que essa "gama" de informa√ß√µes podem ter sido explicado melhor, sem perder objetivo do caso.
>> By Jeiel.

>> Coment√°rio de cybernerd007:
Fiquei 2 dias testando/explorando e sem duvida o problema se encontra no **Children** que tem 701 coment√°rios, acredito que seria menos estressante tanto para o navegador do usu√°rio quanto para o servidor carregar por partes quanto o usu√°rio for descendo a pagina...

@filipedeschamps vou marcar voc√™ pois se trata tamb√©m de um problema de seguran√ßa j√° que pode resultar em um DDOS(ou somente sobrecarregar e tornar o site lento/inst√°vel) se aberto algumas abas j√° que por cada solicita√ß√£o e transferido quase 1MB para o cliente

>> Coment√°rio de Ryannnkl:
uma pagina√ß√£o para limitar o n√∫mero de coment√°rios resolveria parte do problema, mas, em contrapartida, n√£o acho que podemos limitar o n√∫mero de coment√°rios dentro de coment√°rios, mesmo que limite o n√∫mero de coment√°rios, o n√∫mero de coment√°rios dentro de outro coment√°rio pode levar a esse mesmo problema.

assim:

![image](https://user-images.githubusercontent.com/48577990/227756971-c9fb758b-f8d8-4627-aeae-6c458d1a5226.png)

>> Coment√°rio de aprendendofelipe:
@Jetrom17, sentiu alguma melhora no √∫ltimos 10 dias? Agora s√≥ est√£o aparecendo cerca de 100 respostas e o restante s√≥ fica vis√≠vel se clicar em "ver mais respostas".

![image](https://user-images.githubusercontent.com/77860630/227784998-c626c0d3-6458-4874-af8e-4420c33032dc.png)


Seria interessante se tivesse testado nos dois dias que ficou limitado a cerca de 20 respostas.

>> Coment√°rio de filipedeschamps:
Eu abri aqui e na minha opini√£o ta **muuuito** mais r√°pido, mesmo puxando do backend tudo.

Sonho por essa feature na plataforma do curso üí™   a aula do `bem-vindo` saiu completamente do controle por conta da quantidade de coment√°rios l√° üëç

>> Coment√°rio de Jeiel0rbit:
Agora melhorou. Essa issue faz 2 meses.

>> Coment√°rio de Jeiel0rbit:
Agora melhorou. Essa issue faz 2 meses.
</issue_1240_"Tab Sobre" - Lat√™ncia alta>

<issue_1241_[Sugest√£o] Ordena√ß√£o de resultado de content pela data de atualiza√ß√£o>
Seria √≥timo poder pegar n√£o s√≥ pela ordem que os contents foram criados ou pela relev√¢ncia, mas tamb√©m pelos mais atualizados, isto √©, aqueles que receberam coment√°rios recentemente, edi√ß√£o ou tabcoins.

Pode ser um feature interessante tanto pela UI quanto pela API disponibilizada. No meu caso, foi pelas consultas da API que senti falta disso.

O endpoint que utilizei foi este: https://www.tabnews.com.br/api/v1/contents?page=1&per_page=100&strategy=new

Talvez haver uma *strategy* para update evite a necessidade de um novo endpoint.

>> Coment√°rio de cybernerd007:
Muito interessante sua sugest√£o, acredito que seja aplicada no futuro mas sem duvida da pra fazer isso que voc√™ falou somente consumindo a API e filtrando ela, fico a disposi√ß√£o pra te ajudar no c√≥digo caso queira...

>> Coment√°rio de TeoCalvo:
@cybernerd007 valeu pela resposta.

Em meus scripts, j√° consigo fazer uma solu√ß√£o de contorno, mas preciso listar todas as `pages` do endpoint. A quest√£o √© que se um post (particularmente os mais antigos) √© atualizado ou ganha mais Tabcoins, mesmo pegando por essa estrat√©gia n√£o vamos ter visibilidade, certo? A n√£o ser que percorra sempre todas as `pages`.  :( 

Por isso pode ser uma boa ideia ter uma strategy=updated_at (algo assim), ordenando os contents pela sua atualiza√ß√£o, seja por edi√ß√£o, tabcoins, childs, etc. Assim evitamos percorrer todas as pages para pegar todos os contents atualizados, trabalhando apenas com as pages mais recentes at√© determinada data/hora. N√£o sei se me fiz entender hehe. Mas √© algo que ajudaria tanto na coleta dos dados (em velocidade), quanto evitaria o escalonamento de minhas requests √† API.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Teo! J√° temos um issue aberto sobre a possibilidade de listar conte√∫dos de usu√°rios por TabCoins, mas acabei editando ele para ficar mais abrangente e englobar sua sugest√£o tamb√©m, assim podemos concentrar a discuss√£o em um √∫nico issue.

* https://github.com/filipedeschamps/tabnews.com.br/issues/1388
</issue_1241_[Sugest√£o] Ordena√ß√£o de resultado de content pela data de atualiza√ß√£o>

<issue_1244_[SUGEST√ÉO] Posts favoritos>
Seria legal um sistema de "favoritar" as publica√ß√µes ou algo parecido pra facilitar a volta em alguma publica√ß√£o posteriormente.

>> Coment√°rio de coffeeispower:
Use os marcadores do navegador, eles existem por algum motivo...

>> Coment√°rio de eletroswing:
@coffee-is-power  e no smartphone? copiar os links em lugares separados certamente n√£o √© legal, al√©m de poder criar "playlists" de posts relacionados como playlist de alguem s√≥ com conteudo de python crawler, e outro com conteudo so de gpt, etc

>> Coment√°rio de aprendendofelipe:
@desenvolvedormatheus, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser duplicada com a #645. Combinado? ü§ù
</issue_1244_[SUGEST√ÉO] Posts favoritos>

<issue_1245_[SUGEST√ÉO] Criar Uma Tab Separada Para Coment√°rios-Respostas No Perfil Dos Usu√°rios>
√â not√°vel que os usu√°rios n√£o usam direto o coment√°rio para um conte√∫do s√≥lido, assim deixando bagun√ßado na visualiza√ß√£o de posts de usu√°rios que gostam de comentar e postar conte√∫dos. Minha sugest√£o √© que tenha 2 tabs, uma para posts e outra para coment√°rios para cada usu√°rios.

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o, mas vi que temos uma igual no reposit√≥rio, j√° com alguns coment√°rios: #807 . Acho melhor concentrar a discuss√£o l√°.

>> Coment√°rio de aprendendofelipe:
@Xnork, obrigado pela sugest√£o! üí™

Isso @Rafatcb, ainda n√£o temos muito avan√ßo sobre isso, mas acredito que a issue #807 seja o melhor lugar para centralizar o assunto. üëç

Fechando essa aqui como duplicada. ü§ù
</issue_1245_[SUGEST√ÉO] Criar Uma Tab Separada Para Coment√°rios-Respostas No Perfil Dos Usu√°rios>

<issue_1248_[Sugest√£o] Potenciais melhorias para o repo do GitHub>
## Contexto

Oi, pessoal, espero que estejam bem! üëãüèª
Adorei o projeto de vcs e tor√ßo para que continuem tocando, mto obrigado por essa contribui√ß√£o para a comunidade.
Dando uma olhada no reposit√≥rio do GItHub, senti falta de algumas funcionalidades como o [Discussions](https://docs.github.com/en/discussions) e o [Projects](https://docs.github.com/en/issues/planning-and-tracking-with-projects).

## Discussions

Essa ferramenta do GitHub faz com que a comunidade possa abrir debates sobre temas ou tirarem d√∫vidas do projeto, mas sem aumentar o n√∫mero de issues para isso.

[Um caso de uso](https://github.com/prisma/prisma/discussions) que eu gosto bastante √© o do [Prisma](https://www.prisma.io/).
![image](https://user-images.githubusercontent.com/7906171/216854584-2a866974-bddb-4435-bc01-6f839900b768.png)

## Projects

√â uma forma de gerenciar os seus reposit√≥rios como projetos unificados, permitindo uma visualiza√ß√£o em Kanban ou em Tabela das issues e PRs de um ou mais reposit√≥rios em uma √∫nica interface.

Seria muito interessante saber o que est√° no backlog ou o que consideram como essencial, para que possamos contribuir de forma mais assertiva com os objetivos priorizados.

Nessa imagem tem um exemplo de um projeto que organizei usando essa ferramenta, achei bem interessante e senti que a equipe conseguiu aumentar o n√≠vel de entendimento do projeto e do que estava em andamento direto pelas issues e PRs, conectando com o desenvolvimento do dia a dia.

![image](https://user-images.githubusercontent.com/7906171/216854333-a2240058-5efc-4672-9ada-66ba410ac6b6.png)

## Considera√ß√µes finais

S√£o apenas sugest√µes, ent√£o fiquem √† vontade para considera√ß√µes, seria legal ouvir alguns pontos. üò¨

Um abra√ßo!

>> Coment√°rio de danielschmitz:
Muito interessante essa ferramenta de Discussions ! As vezes sugiremos features que nem s√£o √∫teis, pelo menos no Discussions d√° pra saber quais o pessoal mais vota! Tenho certeza que o darkmode seria uma das mais votadas. Foram varias issues e PRs sobre o tema

>> Coment√°rio de Rafatcb:
Eu n√£o tenho muito costume em usar Discussions, a visibilidade das discuss√µes acaba sendo um pouco menor do que dos issues. Faz sentido um reposit√≥rio com relativamente pouca intera√ß√£o (caso do TabNews) usar o Discussions? N√£o diluiria as pessoas participando por precisarem procurar em dois lugares, al√©m de ter mais um lugar para verificar e fechar algo como duplicado?

S√£o perguntas sinceras, realmente n√£o sei a resposta.

Sobre o Projects, parece que o TabNews j√° tem algo parecido: o modo como os Milestones s√£o utilizados ditam o que foi e o que ser√° implementado. Um melhor uso das Labels poderia ajudar a entender o que falta uma altera√ß√£o de quem abriu o PR ou o que falta review, por exemplo.

>> Coment√°rio de eng-gabrielscardoso:
@Rafatcb acredito que o discurssions n√£o seja t√£o interessante para o projeto justamente pelo reposit√≥rio n√£o ser o "foco" (quer-se levar pessoas para o TabNews e n√£o o Github), mas a aba Projects seria interessante para manter um fluxo de desenvolvimento melhor. Creio que as issues funcionem mais como um "backlog" e no projects se teria uma vis√£o mais real do estado de desenvolvimento da plataforma. Como voc√™s t√™m mais tempo desenvolvendo devem entender melhor as necessidades do projeto, mas creio que utilizando o Projects seria uma forma muito mais interessante para os devs acompanharem o projeto e.g. todo -> in progress -> in review -> (staging) -> done (in production).

Assim, my opinion (vcs t√™m mto mais xp que eu no projeto), ent√£o gostaria de saber o que acham
</issue_1248_[Sugest√£o] Potenciais melhorias para o repo do GitHub>

<issue_1252_Google Console acusando problemas de CLS em v√°rias p√°ginas>
Turma, olha que interessante que come√ßou a aparecer no Google Console a partir do dia **27 de Janeiro** (apenas em Desktop):


https://user-images.githubusercontent.com/4248081/217318434-0ca4b695-725b-4832-a3bd-e97a9e0c96e0.mov


Ele est√° acusando problema de CLS nas p√°ginas (layout shift):

<img width="1181" alt="image" src="https://user-images.githubusercontent.com/4248081/217317894-15d1f225-f48a-4866-8922-0a489e567e68.png">

Muito estranho, porque o √∫ltimo merge foi feito l√° por volta do dia **10-11 de Janeiro**.

>> Coment√°rio de aprendendofelipe:
Muito estranho, pois realmente o √∫ltimo *deploy* foi em 11/01/2023.

Poderia ser uma mudan√ßa recente na maneira como o Google pontua o CLS, mas a √∫ltima mudan√ßa que divulgaram passou a vigorar em [01/06/2021](https://web.dev/cls/). S√≥ se mudaram agora sem avisar, o que parece ser mais prov√°vel.

Sobre mudan√ßas no c√≥digo do TabNews que poderiam impactar o CLS, o `ByteMD` foi atualizado em outubro e no in√≠cio de dezembro houve uma refatora√ß√£o do `Content` com a cria√ß√£o do componente `Markdown`. Mesmo que o Google demorasse para perceber a mudan√ßa nos conte√∫dos antigos j√° indexados, acho que ter√≠amos o in√≠cio da subida das p√°ginas com problemas muito antes de 27 de janeiro se o problema fosse por aqui, pois os conte√∫dos postados logo ap√≥s as mudan√ßas no c√≥digo n√£o demorariam tanto assim para serem indexados.

Outra coisa estranha √© a propor√ß√£o de p√°ginas com e sem problemas (6.058/1.015). Pela grande quantidade de URLs com problema, s√≥ pode ser algo com as p√°ginas de conte√∫dos, mas se fosse algo do site em si, n√£o ter√≠amos essas 1.015 p√°ginas classificadas como boas. E essas boas n√£o podem ser conte√∫dos antigos indexados que o Google ainda n√£o atualizou, pois existem centenas de p√°ginas que est√£o sendo qualificadas como boas, e esse n√∫mero est√° crescendo, o que me leva a acreditar que √© algo que depende do tipo de conte√∫do publicado.

A primeira coisa que me vem a cabe√ßa s√£o as imagens, mas a propor√ß√£o de conte√∫dos com e sem imagens n√£o deve ser nem perto de 6.058/1.015. E no [PageSpeed Insights](https://pagespeed.web.dev/) at√© acusa que as imagens deveriam ter `width` e `height` expl√≠citos, mas isso n√£o deixa o CLS acima de 0.1 pontos (s√≥ na p√°gina de status que passa disso, chegando a 0.137).

Algo que poderia impactar todas as p√°ginas √© o aparecimento dos links para `Login` e `Cadastrar` no `Header`, que ocorre alguns instantes ap√≥s a primeira renderiza√ß√£o.

Outro pequeno deslocamento ocorre na parte que mostra a quanto tempo o conte√∫do foi publicado.

Tamb√©m pode ter rela√ß√£o com o tamanho do conte√∫do publicado, talvez o visualizador do ByteMD se redimensione em algumas situa√ß√µes.

Mas nada disso mudou recentemente.

>> Coment√°rio de filipedeschamps:
Tudo voltou ao normal e com zero p√°ginas com problema ü§ù 

<img width="1045" alt="image" src="https://user-images.githubusercontent.com/4248081/221311886-bd36c55c-c793-4376-a0df-d752b5706dff.png">
</issue_1252_Google Console acusando problemas de CLS em v√°rias p√°ginas>

<issue_1256_[SUGEST√ÉO] Redirecionamento do login>
Ol√°, pessoal.

Em primeiro lugar, parab√©ns pelo projeto. J√° sou um grande f√£, apesar de n√£o ter interagido na plataforma ainda.

Aqui vai a sugest√£o: em vez de um redirect com avan√ßo no hist√≥rico, ap√≥s o login, usar um redirect com replace do hist√≥rico.

Caso de uso e como reproduzir:
- abrir uma mat√©ria via link (deslogado)
- tentar reagir a alguma coisa
- aparece a tela de login automaticamente; fa√ßa o login
- voc√™ √© redirecionado para a mat√©ria novamente com avan√ßo do hist√≥rico
- ao tentar voltar, voc√™ retornar√° para a tela de login que te enviar√° automaticamente para a mesma mat√©ria, indefinidamente.

Problema: usu√°rio n√£o consegue retornar no hist√≥rico para antes da tela de login. Ao menos n√£o de forma intuitiva.

Solu√ß√£o: replace do hist√≥rico ap√≥s o login. Assim, ao voltar, o usu√°rio n√£o passar√° pelo login e pelo redirect para frente.

>> Coment√°rio de aprendendofelipe:
Ol√° @hgsantana, muito obrigado pela sugest√£o! üí™

Ela foi implementada no #1321 üöÄ

>> Coment√°rio de aprendendofelipe:
@hgsantana voc√™ foi citado no post comemorativo: https://www.tabnews.com.br/FelipeBarso/tabnews-exibir-ocultar-respostas-e-mais-outras-melhorias üéâ
</issue_1256_[SUGEST√ÉO] Redirecionamento do login>

<issue_1258_Motivo por n√£o utilizar o styled-components>
Gostaria de entender o motivo de termos o "styled-components" instalado, mesmo sem utiliz√°-lo em nenhuma etapa do desenvolvimento. 
Tem alguma biblioteca que esteja utilizando? Caso n√£o, poder√≠amos remover ele ou utilizar ele nos componentes.

>> Coment√°rio de coffeeispower:
styled components √© bem controverso, css-in-js √© bem controverso no geral, usaria tailwind no lugar dele, da menos dor de cabe√ßa e consigo separar claramente as se√ßoes dos componentes, tipo, antes do return do html √© a logica, √© so js, e no html tem o conteudo e os estilos.

>> Coment√°rio de aprendendofelipe:
Ol√° @zLucasBiasi, precisamos do `styled-components` para o `primer/react` üëç
</issue_1258_Motivo por n√£o utilizar o styled-components>

<issue_1259_[OTIMIZA√á√ÉO] PageSpeed Insights>
Ol√° pessoal. 
Como curiosidade coloquei o tabnews pra teste de performance do google. O resultado realmente √© muito legal. 
1. [] Webpack bundle otimiza√ßao
https://pagespeed.web.dev/report?url=https%3A%2F%2Ftabnews.com.br%2F&hl=en-CA&form_factor=mobile
![M√©tricas](https://i.imgur.com/GqhkUij.png "M√©tricas")


![M√©tricas](https://i.imgur.com/lzVTgAB.png "M√©tricas")
![M√©tricas](https://i.imgur.com/XDDD4m9.png "M√©tricas")
Webpack Bundle Analyser eh recomenda√ß√£o pra n√£o carregar o arquivo:
https://www.tabnews.com.br/_next/static/chunks/pages/_app-352969391199e5ed.js

2.[x]Outras melhorias s√£o recomendadas. SEO e accessibility √© m√≠nimo. 
Keep up with the good work! üòÄ

Ps. Lighthouse TreeMap
https://googlechrome.github.io/lighthouse/treemap/?gzip=1#H4sIAAAAAAAACrWVwXLaMBCGX4XxGWPJkiUrxzbTnnLopPTS6TBraQ0qRnYtOYTJ8O4VkF7AtBkyPVq7+3+/diX5JWlWfXL3kvT4a0Af0Mz7JrlLViF0/i7LttvtLEDlcOtnut3Mqj5LpkltHTRvSYTB2OAP+l73tgtp6BE30KUGAhyWrYkaY7FpEmxoMEYfj9HJ11N0cn+KGjxV2dbFnLlHM6nbfvKqMYGui0let32UcEPTvH7cW981sHtozUHaulizgWCf8CgZwDZHt2HXHeJnjlysiuHvL4mDDf5z8z36dug1ftiFQxktOCf76VuKFw6fQ+ZDdKYzvRrc2mdd2+xq2zQ+1UKCLAytRK2U0eXsp7+kvYO0xaoDvU4JMjRcEI2KECaKUQ4rSjJNBjfECfzZqJTydnrdx7Jt20d+BcQYwxhVKs+FGeVTTlSRnzngeUHp7RY2YF2qiTKClpIAyzUp8lG6EpzRCzjj74B3sESfLeIBTlmRK6GYorEBWOCVBuQq5xczEEpxKm53Qataq7IgKS05sAIkgKkpL/GKB3k+Akpp8d4mWGfwOQUSu18KDoqrQvN61IEsz8dwywVYd5/JeqH4nH8pUIlPK9N9+5gtqsE25gGcreMLOYrPZVn+P773y7/ThbgN/gTZ6RW9MlUqz3RZPnamTu5numkHUzfQo3XeLlfhyMkqBN262ca6SIlIqCuh8ioHBF5KVTGmiSAoVY2Ki5wKIRiVLJ5gxUZMSXJx44pSkf2P/X4/TSKptstHDMG65fEpb1oNx/8IunT+mMSs3zSFgz30BgAA

>> Coment√°rio de repires:
<img src="https://i.imgur.com/eqd8D3o.png">
Css foi arrumado com sucesso! üëç 


Ainda h√° um arquivo javascript nao utilizado atrapalhando a performance.

<img src="https://i.imgur.com/GNV6BBs.png">

<img src="https://i.imgur.com/mYuNwG6.png">

https://pagespeed.web.dev/analysis/https-www-tabnews-com-br/6hh7wmachm?form_factor=mobile

Arquivo:
https://www.tabnews.com.br/_next/static/chunks/pages/_app-8de2ec7d21863acf.js
Solu√ß√£o:
Use Webpack Bundle Analyzer to detect unused JavaScript code. 
https://github.com/vercel/next.js/tree/canary/packages/next-bundle-analyzer
</issue_1259_[OTIMIZA√á√ÉO] PageSpeed Insights>

<issue_1261_[Feature] - Tempo gasto em escrever artigo>
Talvez n√£o seja relevante pra muitos.
Mas eu vejo as vezes que a galera gasta MUITO tempo fazendo um artigo muito bom e n√£o temos visibilidade nenhuma disso.

Seria interessante saber quanto tempo a pessoa dedicou em um artigo pois vejo um valor gigante nisso.
A pessoa gastou 1, 2, 3 horas do tempo dela pra escrever algo pra outros sem pedir nada em troca (essa pessoa √© maravilhosa demais).

>> Coment√°rio de silviooosilva:
Bem massa a ideia kkkk

>> Coment√°rio de gabrielsozinho:
A ideia em si n√£o √© boa, eu tamb√©m admiro muito pessoas que criam um artigo bem estruturado e rico e informa√ß√µes. No entanto, acredito que essa ideia n√£o v√° pra frente por ser facilmente manipul√°vel, imprecisa e injusta. 

Imagine s√≥ uma situa√ß√£o onde a pessoa escreveu durante menos de 10 minutos o artigo e deixa o computador ligado s√≥ pra aparecer mais tempo, ou ent√£o uma em que uma pessoa passa horas escrevendo em algum outro programa e cola no editor do TabNews fazendo com que pare√ßa que ele demorou poucos minutos pra escrever aquilo. N√£o acha que seria bem injusto?

Tamb√©m acredito que o conte√∫do deve ser avaliado pela sua qualidade, e talvez isso causaria uma interfer√™ncia na decis√£o de se post √© bom ou n√£o. üëçüèª

>> Coment√°rio de CristianoSword:
Concordo com o Gabriel, √© algo muito f√°cil de ser manipulado. √â melhor deixar que seja avaliado pelos tabcoins ou s√≥ pela qualidade mesmo. Amo essas pessoas que gastam seu precioso tempo fazendo artigos maravilhosos, tanto que tenho varios salvos nos meus bookmarks.

>> Coment√°rio de zLucasBiasi:
@gabrielsozinho eu estava fazendo uns testes e consegui fazer um exemplo simples onde o tempo s√≥ continua quando o usu√°rio digita algo, tipo se ele segurar a letra A por exemplo o tempo para de contar, o tempo apenas conta quando o usu√°rio esta digitando realmente. N√£o seria uma solu√ß√£o?

>> Coment√°rio de hkotsubo:
No meu caso, eu prefiro escrever sempre fora do site (usando algum editor, como o Sublime), por v√°rios motivos (o textarea √© pequeno e n√£o d√° pra redimensionar, n√£o h√° o perigo de enviar sem querer antes de terminar, etc). Enfim, eu escrevo tudo no editor, e no final s√≥ copio e colo no site. 

Nesse caso, iria parecer que eu escrevi tudo em um segundo, o que est√° longe de ser verdade (j√° que sou um *slow typist*).

>> Coment√°rio de B-Schmitz:
Seria interessante tamb√©m marcar o tempo de leitura do artigo.

>> Coment√°rio de Rafatcb:
@aprendendofelipe parece que a comunidade j√° escolheu que essa funcionalidade n√£o seria legal para o TabNews. Podemos fechar a issue?

Sobre o tempo de leitura, foi implementado aqui: https://github.com/filipedeschamps/tabnews.com.br/pull/1445

>> Coment√°rio de aprendendofelipe:
Show pessoal, obrigado pelas contribui√ß√µes sobre o assunto! üí™

Vou fechar como "n√£o planejado" ü§ù
</issue_1261_[Feature] - Tempo gasto em escrever artigo>

<issue_1262_Bug: comportamento erratico na ultima linha do editor>
Quando estamos digitando um texto longo no editor de textos, ao atingir o final da area do editor, o mesmo n√£o rola automaticamente, e come√ßamos a digitar as cegas.

Outra situa√ß√£o √© que voc√™ digita uma ultima linha/paragrafo, e quando apaga e clica na linha anterior, o texto ressurge.

Algu√©m j√° experimentou as mesmas situa√ß√µes?

Uso o tabnews apenas do chrome no android.

>> Coment√°rio de Ryannnkl:
o tabnews utiliza um componente chamado [bytemd](https://bytemd.js.org/) e esse campo de texto onde a gente escreve √© integrado nesse componente, o que o torna dif√≠cil de mexer nele de forma √≠ntegra.

o componente do editor no c√≥digo: 
https://github.com/filipedeschamps/tabnews.com.br/blob/f0db9131dd2ae08f6417d48b2d09b99c8baf6243/pages/interface/components/Markdown/index.js#L45-L52

mas como ele aceita props √© poss√≠vel adicionar algumas estiliza√ß√µes como diminuir esse campo de texto nas vers√µes mobile j√° que no desktop n√£o tem esse problema, cabe a galera resolver se pode mexer na estiliza√ß√£o dessa pagina.

se puder eu fico feliz em fazer uma PR.

>> Coment√°rio de iget-master:
√â simplesmente impossivel escrever textos longos nesse editor no mobile. Acho que este tema deveria estar nas prioridades.

Se voce digitar por exemplo

> # Algum titulo

E tentar dar enter para ir na pr√≥xima linha, ele simplesmente n√£o aceita.

Se colocar um ponto final apos a plavra t√≠tulo ele deixa.

Se voc√™ desiste de um texto e tenta apagar, em algum momento o texto que vc apagou ressurge.

Tem algo muito errado, rs

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pela issue! üí™

Esse j√° √© um comportamento conhecido e recomendo continuar a conversa na issue #648, que √© mais antiga.

Vou fechar essa como duplicidade. Ok?
</issue_1262_Bug: comportamento erratico na ultima linha do editor>

<issue_1263_Como testar em mobile?>
Estou tentando trabalhar em cima de um bug que encontrei, mas quando tento debugar remotamente no meu celular, a tela carrega em branco. Alguma dica?

>> Coment√°rio de patogordo:
Se for testar no android e com o chrome existe uma ferramenta do pr√≥prio chrome que possibilita isso, segue o link dela abaixo

https://developer.chrome.com/docs/devtools/remote-debugging/

>> Coment√°rio de iget-master:
A quest√£o n√£o √© essa. O problema √© que n√£o carrega nada, a tela fica em branco. √â como se o webpack n√£o estivesse liberando fora do localhost

>> Coment√°rio de patogordo:
Que estranho, tenta mudar as vari√°veis de ambiente que usam a url localhost no front end para o ip, talvez funcione

>> Coment√°rio de aprendendofelipe:
Encerrando essa issue por inatividade ü§ù

>> Coment√°rio de Rafatcb:
@aprendendofelipe eu tamb√©m passei por essa situa√ß√£o. N√£o consegui hospedar o projeto na rede local mesmo usando o par√¢metro `-H` (acho que no comando do `next`, n√£o lembro agora). Voc√™ j√° passou por isso ou sabe de uma solu√ß√£o?

O m√°ximo que consegui foi realizar a `build` e acessar por ela, mas a√≠ quebra a navega√ß√£o porque sempre redireciona para `https`.

>> Coment√°rio de aprendendofelipe:
Eita, est√° dando `net::ERR_SSL_PROTOCOL_ERROR`. üòï

Vou reabrir a issue para depois investigarmos o motivo. ü§ù

Por enquanto, uma alternativa para testar em diferentes dispositivos √© usar o Codespaces, Gitpod etc. üëç

>> Coment√°rio de Rafatcb:
Uma outra alternativa que descobri por meio [desse coment√°rio do TabNews](https://www.tabnews.com.br/lindias/44236a6f-a023-45a6-9758-a1ed821343f1) √© que d√° para expor a porta pelo pr√≥prio Visual Studio Code, por meio da conex√£o com o GitHub.

Para quem quiser saber mais, pode ler [a documenta√ß√£o](https://code.visualstudio.com/docs/editor/port-forwarding), mas √© bem simples.

>> Coment√°rio de aprendendofelipe:
@iget-master, voc√™ foi citado na publica√ß√£o sobre as novidades do TabNews:

https://www.tabnews.com.br/FelipeBarso/tabnews-novas-correcoes-e-revenue-share-se-materializando üéâ
</issue_1263_Como testar em mobile?>

<issue_1266_Erro ao conectar mensagem "N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o.">
Ao tentar responder a uma quest√£o colocado em um post a mensagem 
`
"N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o." 
`
aparece acima da √°rea de texto e n√£o foi poss√≠vel postar.

A conex√£o n√£o √© o problema, abro todos os posts sem problema e tamb√©m qq p√°gina.

>> Coment√°rio de filipedeschamps:
@teseu interessante, os logs aqui n√£o marcaram nenhum erro interno sobre essa tentativa e esta mensagem aparece quando de fato o `client` n√£o consegue se conectar com o `server`. Ser√° que foi algum proxy no meio que falhou?

E voc√™ tentou de novo? Se sim, recebeu qual mensagem?

>> Coment√°rio de teseu:
Todas as tentativas deram na mesma msgm e eu √± uso proxy aqui. Tb achei deveras estranho, por isso abri uma issue, tomando o cuidado de ver se √± tinha algo parecido antes.

>> Coment√°rio de teseu:
At√© guardei a msgm pra enviar em outro momento, pq ficando assim t√¥ 'proibido' de mandar msgm.

>> Coment√°rio de aprendendofelipe:
@teseu, pode nos passar qual foi mais ou menos o hor√°rio das tentativas? Foi a partir de 19h10?

Acho que seu acesso √† API foi bloqueado por ter atingido o rate-limit. Por isso voc√™ consegue navegar, mas n√£o vai conseguir fazer nada que use a API.

>> Coment√°rio de teseu:
Foi a partir desse hor√°rio mesmo. Mas pq atingi o rate-limit?

>> Coment√°rio de teseu:
Eu √± publiquei nada nos √∫ltimos dias

>> Coment√°rio de aprendendofelipe:
@teseu, na verdade n√£o foi rate-limit, mas a Cloudflare detectou uma vulnerabilidade nas requisi√ß√µes vindas do IP que voc√™ est√° utilizando.

N√£o tenho como saber exatamente o que ela est√° detectando, mas chuto que √© algo que foi ou que est√° sendo enviado nos headers.

Pode ser algum v√≠rus na sua m√°quina que est√° tentando aproveitar alguma vulnerabilidade, mesmo que o TabNews n√£o tenha essa vulnerabilidade espec√≠fica. Mas tamb√©m pode ter sido algo que ocorreu em algum acesso para outros sites. Inclusive pode ter ocorrido com outra pessoa, caso seu IP n√£o seja fixo ou voc√™ esteja em uma rede p√∫blica.

Consegue usar o mesmo equipamento em outra rede para isolar se o problema √© com seu equipamento? Se isso n√£o for poss√≠vel, ent√£o reinicie seu modem para ele obter outro IP.

Depois nos diga o que voc√™ fez e qual foi o resultado. ü§ù

>> Coment√°rio de teseu:
V√≠rus acho dif√≠cil, tenho um comportamento bem avesso a isso, √± precisaria de antiv√≠rus nem no windows, o q √± √© o meu caso na hora da tentativa de postagem.

As abas q tenho abertas no momento tb √± me parecem afetar qq coisa desse tipo, cursos online, coisas relacionadas (tech guide da alura, boracodar da rocketseat, atlas da mongodb, meu email, documenta√ß√£o tailwind, youtube, nada q levante qq suspeita), mas o IP dado pela operadora eu √± sei √© √∫nico de verdade, operadoras nunca podemos confiar.

A rede √© a √∫nica q tenho, j√° q estou em casa e j√° desconectei da vpn do trabalho, mas vou reiniciar o modem como sugerido e testar novamente, qq resultado eu informo.

>> Coment√°rio de teseu:
Ap√≥s reiniciar o modem, espero ter ganho um IP novo, √± conferi qual estava antes, mas tudo permanece.

>> Coment√°rio de aprendendofelipe:
@teseu, seu IP mudou sim. O estranho √© que dos 128 bits do IPv6, apenas 1 bit mudou (o √∫ltimo), mas mudou...

Pode ser algum problema na Cloudflare, mas √© pouco prov√°vel, pois ter√≠amos outros usu√°rios enfrentando o mesmo problema, mas s√≥ tem um √∫nico registro nos logs que veio de um terceiro IP. Voc√™ testou tamb√©m usando a VPN?

>> Coment√°rio de teseu:
A vpn √© apenas pro trabalho, √± uso outra.

Parece um problema fora do alcance imediato de vcs, vou ficar no aguardo de uma resolu√ß√£o. Sem stress, vou focar no code aqui pra nem pensar nisso por agora.

De qq forma agrade√ßo.

>> Coment√°rio de teseu:
Bom o erro permaneceu e aparentemente era a pr√≥pria resposta, √± sei o pq, vou deixar transcrita abaixo para q vcs possam ver.

========================================

Essas s√£o as op√ß√µes de shell dispon√≠veis para configurar no seu vscode. Se vc √± alterou o padr√£o, o seu terminal do SO deve usar o bash como shell e √© esse que deve estar configurado no seu vscode para que funcione da mesma maneira.

Eu uso bash e √© esse q est√° configurado no meu vscode, qdo no windows eu uso um semelhante, o do git bash e √© ele q est√° configurado como padr√£o do vscode.

<pre>
    <code>
"terminal.integrated.shell.windows": "C:\\Program Files\\Git\\bin\\bash.exe"
    </code>
</pre>

ou ainda:

<pre>
    <code>
"terminal.integrated.defaultProfile.windows": "Git Bash",
    "terminal.integrated.profiles.windows": {
        "PowerShell": {
            "source": "PowerShell",
            "icon": "terminal-powershell"
        },
        "Command Prompt": {
            "path": [
                "${env:windir}\\Sysnative\\cmd.exe",
                "${env:windir}\\System32\\cmd.exe"
            ],
            "args": [],
            "icon": "terminal-cmd"
        },
        "Git Bash": {
            "source": "Git Bash",
            "path": "C:\\Program Files\\Git\\bin\\bash.exe",
        }
    },
    </code>
</pre>

e no Linux:


<pre>
    <code>
"terminal.integrated.profiles.linux": {
      "Bash": {
        "path": "/bin/bash",
        "overrideName": true,
        "icon": "terminal-bash",
        "color": "terminal.ansiBlue",
        },
    },
    </code>
</pre>

>> Coment√°rio de teseu:
como podem ver, o github √± detectou a mesma coisa. Vejam os erros na resposta da minha request:

Referrer Policy: Ignoring the less restricted referrer policy ‚Äúorigin-when-cross-origin‚Äù for the cross-site request: https://static.cloudflareinsights.com/beacon.min.js/vaafb692b2aea4879b33c060e79fe94621666317369993 vaafb692b2aea4879b33c060e79fe94621666317369993
Failed to get subsystem status for purpose 
Object { rejected: true, message: Error }
content-script.js:95:21
XHRPOSThttps://www.tabnews.com.br/api/v1/contents
[HTTP/2 403 Forbidden 36ms]

>> Coment√°rio de aprendendofelipe:
@teseu, agora vendo a mensagem que voc√™ estava tentando postar eu entendi a raz√£o da Cloudflare estar bloqueando.

Acho que podemos desativar essa regra espec√≠fica, pois ela protege de uma vulnerabilidade que n√£o est√° presente no TabNews, mas vou investigar melhor primeiro.

Como n√£o √© nada urgente, devo fazer isso ap√≥s o Carnaval.

Obrigado por reportar! üëç

>> Coment√°rio de teseu:
Desde o princ√≠pio a inten√ß√£o era ajudar a plataforma, qdo verifiquei pelo devtools mais informa√ß√µes sobre o erro, fui investigar e percebi q poderia publicar de outra forma, mas essa tb √± deu certo (essa 2¬™ tentativa foi a q enviei aqui, antes usava a nota√ß√£o espec√≠fica do markdown, ao inv√©s de \<code> ou \<pre>,  com \```json, q foi qdo reportei o erro, mas as 2 deram o mesmo resultado).

Na verdade, permanecendo assim, nem sei como enviar trechos de c√≥digo diretamente (claro q posso hospedar aqui no github com os gists), pq √© muito mais interessante e visual incluir na msgm o trecho.

Pra mim, a urg√™ncia era pq parecia q eu √± poderia enviar msgns, mas isso √± √© o caso, aproveite seu feriado e obrigado pela aten√ß√£o.

>> Coment√°rio de aprendendofelipe:
Show @teseu, o mais importante √© que voc√™ estava podendo usar normalmente o TabNews para mensagens que n√£o contivessem o trecho que a Cloudflare bloqueava.

A sua mensagem n√£o continha nenhuma vulnerabilidade real, mas a gente precisava analisar como poder√≠amos editar a regra sem comprometer a seguran√ßa do TabNews.

Agora voc√™ deveria conseguir publicar normalmente. üéâ

Obrigado pela ajuda! üëçü§ó

>> Coment√°rio de aprendendofelipe:
@teseu acho que voc√™ n√£o teve mais esse problema, certo?

Vou fechar a issue, ok? üëç
</issue_1266_Erro ao conectar mensagem "N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o.">

<issue_1267_[Feature] - n√∫mero m√≠nimo de caracteres para ganhar tabcoins>
## Resumo
criar uma limita√ß√£o para que um usu√°rio escreva no m√≠nimo tantos caracteres para poder ganhar tabcoins, tanto na hora de posta um artigo, quanto na hora de criar um coment√°rio.

## Porque?
Eu estava pensando sobre isso, pois existe alguns usu√°rios que apenas cria umas postagens dizendo: "olha esse artigo aqui √© legal recomendo ler LINK" ou coment√°rios dizendo "legal", e eles ganha tabcoins em cima disso, acredito que as pessoas em vez de fazer isso devesse escrever ou explicar o porqu√™ tal assunto √© legal

>> Coment√°rio de hkotsubo:
Isso pode minimizar o problema, mas sempre tem como burlar. N√£o sei como o site conta caracteres, mas imagino que o markdown entre na conta (ou seja, `**oi**` conta como seis caracteres, mesmo que somente dois sejam exibidos).

Se for esse o caso, √© s√≥ encher o texto de `&nbsp;` ou qualquer outro caractere invis√≠vel (e o Unicode est√° cheio dessas bizarrices).

---

Na verdade eu acho que o sistema de vota√ß√£o como um todo deveria ser revisto. Hoje temos uma a√ß√£o incrivelmente f√°cil e que s√≥ depende de mim (postar **qualquer coisa**) dando mais pontos do que a a√ß√£o mais dif√≠cil e que depende dos outros (receber um voto positivo). Deveria ser o contr√°rio, quanto mais f√°cil a a√ß√£o, menos pontos deveria dar (ou at√© mesmo nenhum). Mas a√≠ j√° √© assunto pra outra issue...

>> Coment√°rio de filipedeschamps:
Acompanhando mais de perto o TabNews, acho que o comportamento sugerido pelo @HarukaYamamoto0 **ir√° contribuir sim**. E para calcular a quantidade de caracteres, podemos limpar o Markdown. O @aprendendofelipe usou isso em outras situa√ß√µes para conferir se a publica√ß√£o "estava em branco" (tinha Markdown, mas ele resultava em nada).

Por fim, nenhuma medida √© a medida final ou vai ser a prova de balas... vai ter que ser uma grande malha de abordagens at√© que canse quem n√£o quer gerar valor.

---

@hkotsubo o @aprendendofelipe fez uma proposta no passado do ganho de TabCoins ser progressivo... ou seja, quanto maior a confian√ßa na conta da pessoa, mais TabCoins ela ganha por publica√ß√£o. Ent√£o se a conta √© nova, ela n√£o ganha nada e fica a cargo de outras pessoas qualificarem essas publica√ß√µes iniciais para ela ir ganhando tra√ß√£o e confian√ßa do sistema/comunidade.

>> Coment√°rio de hkotsubo:
> proposta no passado do ganho de TabCoins ser progressivo

Fiz uma busca e n√£o encontrei essa issue. Tem o link?

>> Coment√°rio de filipedeschamps:
No passado a gente conversou por chamada, mas se eu n√£o me engano, foi colocado uma pr√©via num coment√°rio de uma issue em algum lugar. De qualquer forma, isso vai ser oficializado dentro da Milestone atual ainda: https://github.com/filipedeschamps/tabnews.com.br/issues/1140

>> Coment√°rio de aprendendofelipe:
> Fiz uma busca e n√£o encontrei essa issue. Tem o link?

Logo vou criar a issue sintetizando, pois √© um mix de v√°rias conversas, mas acho que os dois pontos que explicam mais s√£o esse coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1198#issuecomment-1367459826 e essa publica√ß√£o no TabNews:

https://www.tabnews.com.br/FelipeBarso/sugestao-mecanica-das-moedas-do-tabnews

>> Coment√°rio de RodrigoGrz:
> Por fim, nenhuma medida √© a medida final ou vai ser a prova de balas... vai ter que ser uma grande malha de abordagens at√© que canse quem n√£o quer gerar valor.

N√£o li todas as issues ainda ent√£o desculpe caso alguem ja tenha comentado isso. Vendo essa quest√£o de quantidade minima de caracteres, acho que seria interessante colocar um filtro nos comentarios que n√£o contribuem, e que tem apenas como objetivo falar "Muito bom, obrigado". Assim um comentario desse tipo poderia diminuir radicalmente j√° que n√£o agrega valor concreto ao conteudo.

>> Coment√°rio de hkotsubo:
@RodrigoGrz Depois que a issue #1381 foi implementada, ficou mais dif√≠cil ganhar TabCoins, e pelo que percebo, diminuiu a quantidade de "_Obrigado_", "_Que legal_" e similares (s√≥ falta algu√©m coletar esses dados pra confirmar, mas pela minha percep√ß√£o, diminuiu).

Ent√£o talvez esta issue acabe ficando com menos prioridade, j√° que o ganho indevido foi - pelo menos em parte - resolvido de outras formas.

>> Coment√°rio de aprendendofelipe:
As mudan√ßas no PR #1366 j√° est√£o limitado o ganho de TabCoins por publica√ß√µes n√£o relevantes. Ent√£o provavelmente podemos fechar essa issue. Concordam?

N√£o tem como evitar totalmente as publica√ß√µes de agradecimento ou que n√£o agregam nada ao conte√∫do, principalmente porque √© normal que uma boa parte dos usu√°rios n√£o tenha nenhum interesse em participar da economia do sistema e nem mesmo em entend√™-la, mas v√£o estar somente consumindo o conte√∫do. E essa parte dos usu√°rios tamb√©m √© muito importante, pois representa boa parte da audi√™ncia do sistema, o que ajuda a viabilizar o Revenue Share.

O mais importante √© que esses conte√∫dos/coment√°rios n√£o prejudiquem a economia e n√£o ofusquem os conte√∫dos relevantes, mas para isso ainda √© preciso algumas mudan√ßas de comportamento que s√≥ devem ocorrer quando os usu√°rio perceberem que n√£o h√° outra raz√£o para ter TabCoins se n√£o for para us√°-los qualificando conte√∫dos e assim obter TabCash, que √© o que poder√° ser utilizado para o Revenue Share.

>> Coment√°rio de filipedeschamps:
Algo me diz que isso ainda pode ter validade. Digo isso, porque me machuca muito quando vejo um coment√°rio "valeu falou" com `1` TabCoin... meio que machuca a credibilidade da economia, sabe? Meio que me lembra a teoria da janela quebrada, onde "se um fez, porque eu n√£o posso"?

Me passaria uma percep√ß√£o mais justa se um coment√°rio muito curto tivesse por padr√£o `0` TabCoins, e o autor tamb√©m ganhasse `0` TabCoins, independente de quem publicou esse coment√°rio.

>> Coment√°rio de aprendendofelipe:
> Algo me diz que isso ainda pode ter validade. Digo isso, porque me machuca muito quando vejo um coment√°rio "valeu falou" com `1` TabCoin... meio que machuca a credibilidade da economia, sabe? Meio que me lembra a teoria da janela quebrada, onde "se um fez, porque eu n√£o posso"?
> 
> Me passaria uma percep√ß√£o mais justa se um coment√°rio muito curto tivesse por padr√£o `0` TabCoins, e o autor tamb√©m ganhasse `0` TabCoins, independente de quem publicou esse coment√°rio.

Mas esse √© um problema do conte√∫do come√ßar com 1 e n√£o com 0 TabCoin, n√£o √©? D√° a falsa ideia de que algu√©m j√° votou positivamente no conte√∫do. Isso eu acho estranho e ainda n√£o entendi qual √© a raz√£o.

J√° ter uma quantidade m√≠nima de caracteres para ganhar TabCoins n√£o vai ter impacto na maioria dos conte√∫dos relevantes, mas deve aumentar a quantidade de caracteres dos n√£o relevantes, ou seja, pode piorar a experi√™ncia ao aumentar a quantidade de caracteres irrelevantes, aumentando o tempo perdido ao ler.

>> Coment√°rio de RodrigoGrz:
Eu acho que poderia fazer um filtro simples por enquanto do tipo:

H√° o comentario teve cerca de (exemplo) 50 caracteres, faz um include do js para ver se tem as palavras chaves como "obrigado", "valeu", e da 0 TabCoin para esse comentario. Porque um comentario valioso n√£o teria somente essa quantidade de caracteres, sabendo que a maior parte tem essas palavras.

>> Coment√°rio de filipedeschamps:
> Mas esse √© um problema do conte√∫do come√ßar com 1 e n√£o com 0 TabCoin, n√£o √©? D√° a falsa ideia de que algu√©m j√° votou positivamente no conte√∫do. Isso eu acho estranho e ainda n√£o entendi qual √© a raz√£o.

Eu acho que come√ßar com `1` √© visivelmente melhor, pelo menos se considerarmos o benef√≠cio da d√∫vida (vamos acreditar que o conte√∫do tem um valor m√≠nimo). Agora, a proposta √© em casos que h√° uma alta probabilidade de n√£o ter valor, por exemplo, se o baseline √© `1`, me d√≥i muito ver um conte√∫do assim com esse valor, e sabendo que o usu√°rio _possa_ ter ganho TabCoin com isso:

https://www.tabnews.com.br/micaelSantiago/fe754a31-ea36-4b79-9961-197846c54154
https://www.tabnews.com.br/alefolibv/c58ba1bf-7b27-48ca-be72-f641752b2135
https://www.tabnews.com.br/luaneduardo/14bca5c2-33af-42fe-ba16-59761bde0609
https://www.tabnews.com.br/luaneduardo/6567a695-33e2-42b4-bd3c-43bd779d4ae3
https://www.tabnews.com.br/Ernesto/72e82f8b-7511-411e-991a-69dcb9e5e96a
https://www.tabnews.com.br/luaneduardo/257d384a-4dfd-444e-893d-0c45810098b2
https://www.tabnews.com.br/luaneduardo/18e62747-0d9c-4a81-9652-4ffc9767ec66
https://www.tabnews.com.br/luaneduardo/dfeaf808-c45a-4749-8ac2-2db40a0878af
https://www.tabnews.com.br/luaneduardo/43c0e1e0-ad9b-4d7c-8195-2544832cddc7
https://www.tabnews.com.br/airtonsena/1a552781-f25c-462b-8d3a-bbe1ec949996
https://www.tabnews.com.br/luaneduardo/d53ac867-1cc0-4040-91d0-e63158e85151

A pessoa pode n√£o ter ganho nada (dado ao novo algoritmo), mas visivelmente seria mais agrad√°vel ver tudo isso com `0` TabCoins, e ter a _garantia_ que a pessoa n√£o tenha ganho nada com esses conte√∫dos.

E sobre o efeito colateral das pessoas enchendo a lingui√ßa, eu topo correr o risco de ver esse problema surgindo na pr√°tica e, se surgir, decidir o que fazer conforme o pattern que aparecer.

>> Coment√°rio de filipedeschamps:
Outra publica√ß√£o onde vejo que s√≥ uma resposta n√£o deveria cair na regra de n√£o ganhar TabCoins (tanto a publica√ß√£o quanto o autor), independente do "xp" da pessoa: https://www.tabnews.com.br/thyagodinizz/aprenda-a-fazer-um-projeto

>> Coment√°rio de aprendendofelipe:
D√∫vidas sobre as regras:

1. Podemos usar um limiar de palavras no lugar de caracteres? Eu acho que √© melhor.
2. Quantas palavras (ou caracteres) seria o limiar para o conte√∫do come√ßar com 0 ou 1 TabCoin?
3. A sugest√£o √© aplicar exatamente as mesmas consequ√™ncias de quando √© uma resposta para si mesmo, certo? Ou seja, nem o autor e nem o conte√∫do ganham TabCoins iniciais, mas ganham/perdem normalmente conforme os votos?

>> Coment√°rio de aprendendofelipe:
Abri o PR #1460 como proposta de solu√ß√£o. Agrade√ßo se puderem revisar üí™

> 1. Podemos usar um limiar de palavras no lugar de caracteres? Eu acho que √© melhor.
>
> 2. Quantas palavras (ou caracteres) seria o limiar para o conte√∫do come√ßar com 0 ou 1 TabCoin?

Para n√£o precisar limpar markdown, html e quaisquer caracteres diferentes, usei a verifica√ß√£o abaixo para conferir se existem pelo menos 5 palavras com no m√≠nimo 5 caracteres:

```js
newContent.body.split(/[a-z]{5,}/i).length < 6
```

Se retornar `true`, ent√£o √© um texto muito curto e n√£o vai ser adicionado TabCoins nem para o usu√°rio e nem para o conte√∫do.

Apesar de eu n√£o estar considerando os caracteres acentuados, as palavras acentuadas ser√£o contabilizadas se tiverem 5 ou mais caracteres antes (ou depois) do acento. N√£o h√° necessidade de exatid√£o nessa verifica√ß√£o, j√° que s√≥ estamos contando as maiores palavras.

Sobre a quantidade escolhida, eu tentei fazer passar na verifica√ß√£o alguns coment√°rios curtos que vi no TabNews e que continham alguma mensagem √∫til. Vamos analisar o resultado e, qualquer coisa, mudamos esses limites.

> 3. A sugest√£o √© aplicar exatamente as mesmas consequ√™ncias de quando √© uma resposta para si mesmo, certo? Ou seja, nem o autor e nem o conte√∫do ganham TabCoins iniciais, mas ganham/perdem normalmente conforme os votos?

Fiz acontecer exatamente a mesma coisa que quando respondemos para n√≥s mesmos.

Essa √© mais uma regra que ter√° que constar no FAQ, mas estou pensando se devemos fazer essa verifica√ß√£o tamb√©m no lado do client, pois assim podemos informar o usu√°rio que a mensagem dele n√£o ganhar√° TabCoins iniciais. Pode ser uma mensagem de confirma√ß√£o que apare√ßa ao clicar em "publicar". E talvez fazer o mesmo para quando o usu√°rio responder para si pr√≥prio, mas nesse caso j√° d√° para mostrar a mensagem ao clicar no bot√£o responder. O que acham?

>> Coment√°rio de filipedeschamps:
> Pode ser uma mensagem de confirma√ß√£o que apare√ßa ao clicar em "publicar". E talvez fazer o mesmo para quando o usu√°rio responder para si pr√≥prio, mas nesse caso j√° d√° para mostrar a mensagem ao clicar no bot√£o responder. O que acham?

Acho super interessante! At√© para enviar ele para algum conte√∫do explicando o que estamos tentando proteger nas publica√ß√µes, ou simplesmente recomenda ele dar TabCoin ao inv√©s de comentar.

>> Coment√°rio de aprendendofelipe:
Adicionei as mensagens de confirma√ß√£o no mesmo PR. Vejam neste coment√°rio como ficou: https://github.com/filipedeschamps/tabnews.com.br/pull/1460#issuecomment-1616818797

> Acho super interessante! At√© para enviar ele para algum conte√∫do explicando o que estamos tentando proteger nas publica√ß√µes, ou simplesmente recomenda ele dar TabCoin ao inv√©s de comentar.

No caso de mensagem curta, preferi recomendar a leitura da publica√ß√£o "sobre", pois muitos usu√°rios come√ßam publicando coment√°rios e acabam n√£o vendo aquele aviso que s√≥ aparece ao publicar conte√∫do "root".

>> Coment√°rio de aprendendofelipe:
@HarukaYamamoto0, voc√™ foi citado no post comemorativo:

https://www.tabnews.com.br/FelipeBarso/tabnews-6-milhoes-de-visualizacoes-e-muita-novidade üéâ

>> Coment√°rio de HarukaYamamoto0:
estou bem feliz que minha sugest√£o foi aceita, mesmo que eu apenas tenha dado apenas a ideia, para mim esse √© o real significado de Open Source üòÅ

>> Coment√°rio de aprendendofelipe:
Vou dar essa issue como conclu√≠da pela implementa√ß√£o do PR #1460 üöÄüéâ

Mas novas melhorias ainda podem ser feitas, como as sugeridas em #1487 ü§ù
</issue_1267_[Feature] - n√∫mero m√≠nimo de caracteres para ganhar tabcoins>

<issue_1269_Improv/Feat: dados do array da fun√ß√£o checkBlockedUsernames em um arquivo externo>
Ano passado tinha aberto uma issue sobre usu√°rio com o nome de paginas, e o felipe me retornou essa fun√ß√£o, e eu pensei recentemente que esse array poderia ser um arquivo externo em uma S3 ou algo do tipo, para evitar que toda vez que fosse adicionado algo nessa lista, n√£o fosse necess√°rio realizar um deploy 

Fun√ß√£o https://github.com/filipedeschamps/tabnews.com.br/blob/306bc05efd9854512598c4ce96554e8d7ebf5b73/models/user.js#L194

>> Coment√°rio de leoferreiralima:
Outra op√ß√£o era ter isso no banco, meio que uma tabela de parametriza√ß√£o, acho que nos dois casos seria que precisar√≠amos talvez por um cache para que n√£o f√¥ssemos sempre no banco ou no S3 buscar o esses dados j√° que eles n√£o v√£o a cada minuto

>> Coment√°rio de aprendendofelipe:
Dada a frequ√™ncia muito baixa de atualiza√ß√£o dessa lista, comparada √† frequ√™ncia alta de leitura, j√° que ocorre, por exemplo, a cada valida√ß√£o de URL dos conte√∫dos, n√£o vejo vantagens de mover essa lista para fora do c√≥digo.

Hoje ela se encontra aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/22a6d3aca8e3c6ec24ffa7a24f5a713c48e1a5f7/models/validator.js#L801-L801

Isso dificultaria a atualiza√ß√£o da lista, pois:

- Seria necess√°rio fazer manualmente com acesso ao banco ou ao armazenamento escolhido (problema de seguran√ßa);
- N√£o poderia ser atualizada pelos pr√≥prios contribuidores dentro dos PRs que necessitem reservar novos nomes;
- [Edit.] Aumentaria bastante o tempo de execu√ß√£o do `validator`.

Quais vantagens voc√™s enxergam?

>> Coment√°rio de Rafatcb:
Bom, como esse issue n√£o teve feedbacks desde Mar√ßo, e eu concordo que isso traria mais dificuldades do que facilidades, estou fechando o issue.

Se algu√©m ter uma ideia melhor, que atenda os pontos mencionados pelo @aprendendofelipe ou traga novos pontos positivos, podem criar coment√°rios aqui com argumentos para continuar o debate e reabrirmos o issue.
</issue_1269_Improv/Feat: dados do array da fun√ß√£o checkBlockedUsernames em um arquivo externo>

<issue_1271_[SEO/ERRO] url's est√£o retornando undefined>
Me deparei com esse problema aqui:

![image](https://user-images.githubusercontent.com/48577990/220500246-4a4ea3ad-ce2e-4648-9952-2fc1a578f0ea.png)

olhando o c√≥digo vi que aqui n√£o est√° funcionando corretamente

https://github.com/filipedeschamps/tabnews.com.br/blob/f0db9131dd2ae08f6417d48b2d09b99c8baf6243/infra/webserver.js#L12-L14

esse if sempre √© executado pelo que entendi isso retorna o *undefined:undefined*

como sugest√£o eu pensei em colocar mais um if e verificar se ocorreu algum erro que retorne undefined e caso ocorra seta a url padr√£o, mas n√£o acho que essa seja a forma mais adequada de resolver o problema, o que voc√™s sugerem?

```js
if (webserverHost.includes("undefined")) {
    webserverHost = 'https://www.tabnews.com.br';
  }
```

>> Coment√°rio de Ryannnkl:
fazendo uns testes percebi que as vari√°veis de ambiente nesse [arquivo](https://github.com/filipedeschamps/tabnews.com.br/blob/f0db9131dd2ae08f6417d48b2d09b99c8baf6243/infra/webserver.js) n√£o reconhecem as vari√°veis de ambiente, pode testar dando log nelas dentro da fun√ß√£o `getHost()`

```js
console.log("vercel_env: ", process.env.VERCEL_ENV);
console.log("database_env: ", process.env.DATABASE_URL);
```
as vari√°veis de ambiente por padr√£o s√£o vis√≠veis apenas pelo lado do servidor, para ser poss√≠vel acess√°-las pelo lado do cliente para ser poss√≠vel no componente Head utilizar o m√©todo `getHost()` seria necess√°rio adicionar o prefixo "NEXT_PUBLIC_"


```env
NEXT_PUBLIC_WEBSERVER_HOST=localhost
NEXT_PUBLIC_WEBSERVER_PORT=3000
NEXT_PUBLIC_VERCEL_ENV = ...
```

n√£o sei se deixar as vari√°veis de ambiente p√∫blicas e principalmente a VERCEL_ENV seja uma boa ideia, ent√£o deixo encargo de voc√™s decidirem o que fazer, deixar publica as vari√°veis, adicionar o if que mencionei ou alguma outra solu√ß√£o.

referencias: 
- https://nextjs.org/docs/basic-features/environment-variables

>> Coment√°rio de aprendendofelipe:
Ol√° @Ryannnkl, o PR #1228 j√° vai corrigir esse problema üëç
</issue_1271_[SEO/ERRO] url's est√£o retornando undefined>

<issue_1272_[ Bug ] - Campos de cadastro/login>
- Os campos de inser√ß√£o de dados, tanto na aba de login quanto de cadastro, possuem um pequeno erro de css quando inserindo dados provenientes do chrome. (A faixa cinza sobrep√µem a sinaliza√ß√£o de sele√ß√£o do campo)


![bugLogin](https://user-images.githubusercontent.com/41527496/220641920-726474fe-b324-44de-8ae2-06946d67ca58.png)

>> Coment√°rio de Ryannnkl:
tabnews utiliza o design system do Github chamado prime e o componente de [Input](https://primer.style/react/TextInput) deles tem esse problema mesmo, mas o tamanho default n√£o tem esse problema:

![image](https://user-images.githubusercontent.com/48577990/220676054-5769b056-fc4b-42f3-ad40-283baed20f56.png)

me faz pensar se n√£o seria vi√°vel "criar um design system" baseado no prime para o tabnews e deixar de depender somente do prime para ter componentes novos ou melhorar os componentes que ja tem, tava tentando criar um alert de quando ocorre um erro mais bonito mas n√£o tem um componente para isso por exemplo, tem o [Flash](https://primer.style/react/Flash) que foi colocado no login quando o login n√£o funciona, mas tem outra pegada o componente de Flash

>> Coment√°rio de aprendendofelipe:
Ol√° @pwccaa, obrigado pela issue! üí™

O problema foi resolvido no PR #1348, ent√£o vou fechar aqui, ok? üëç
</issue_1272_[ Bug ] - Campos de cadastro/login>

<issue_1273_[Feature] Sticky Navbar>
Sugiro a implanta√ß√£o de uma feature para manter a navbar superior fixada quando √© realizado um scroll na p√°gina, conforme comportamento abaixo.

![tabnews](https://user-images.githubusercontent.com/86431106/221322681-054856f7-8468-48d2-b118-4f8db1dbe9b3.gif)

>> Coment√°rio de ojonasplima:
#1225

>> Coment√°rio de hisirdox:
@ojonasplima me explica porque abriu outra issue, com o mesmo assunto, se viu que j√° tem uma aberta discutindo isso

>> Coment√°rio de aprendendofelipe:
@alan-chris, pode ser que o @ojonasplima tenha encontrado a issue #1225 ap√≥s ter aberto essa.

Vou fechar a duplicada üëç
</issue_1273_[Feature] Sticky Navbar>

<issue_1278_[Improvement // Sugest√£o] Aplicar tipos para as tabs>
((Essa issue √© inteiramente uma sugest√£o, sendo aberta para levantar questionamento e uma possibilidade de desenvolvimento))

Acabei reparando que existe uma grande varia√ß√£o de utiliza√ß√µes para as tabs da plataforma, mas nem em todos os casos o modelo estrutural parece suficiente para suprir, em alguns casos podendo ser simples demais, em outros podendo ser complexo demais.

---

**Tipos**

**F√≥rum:** https://www.tabnews.com.br/userbash/google-apps-scripts

> Esse eu considerando o mais importante, pois seria em grande parte quase nenhum conte√∫do agregado √† tab, possuindo apenas uma pergunta, que pode acabar possuindo N respostas, com a unica forma do publicador da d√∫vida indicar qual resolveu seu problema sendo um coment√°rio como "resolveu aqui, obrigado", que muitas vezes pode passar despecebido no poss√≠vel oceano de respostas recebidas.   

**Artigo:**  https://www.tabnews.com.br/caio/como-exatamente-funciona-a-internet-e-como-esse-post-chegou-ate-voce-conteudo-tecnico-mastigado

> Esse sendo totalmente encaix√°vel ao modelo de tab que possui-se hoje, altamente format√°vel, com o √∫nico ponto a se comentar talvez sendo a agrega√ß√£o do p√∫blico nos coment√°rios em rela√ß√£o ao mesmo.

**Relato Pessoal:** https://www.tabnews.com.br/Jhonnyssom/meus-primeiros-passos-em-programacao

> Esse acaba trazendo um conte√∫do extenso e relativamente adequado ao modelo de hoje, mas talvez eliminando a possibilidade de fonte, pois dificilmente seria agregado com base em algum not√≠ci√°rio ou site externo.  

**Compartilhamento de Cursos / softwares** https://www.tabnews.com.br/maion/conteudo-em-portugues-sobre-aprendizagem-profunda-deep-learning

> Esse se trataria principalmente de compartilhamento de links e base descritiva do mesmos (quando √© feita), logo, poderia possuir um template para a inser√ß√£o de links e a respectiva descri√ß√£o, ou algo do g√™nero.

--- 
Obrigado desde j√° pela possibilidade de sugerir algo do tipo a um projeto como esse.

>> Coment√°rio de Ryannnkl:
realmente √© algo que aparenta ser bagun√ßado no feed... acho que um sistema de tags no menu onde a gente possa filtrar por:

- artigo
- duvida
- dicas
- relato
- etc...

resolveria parte desse problema.

>> Coment√°rio de hkotsubo:
Concordo com o que @Ryannnkl  [disse acima](https://github.com/filipedeschamps/tabnews.com.br/issues/1278#issuecomment-1446728928). Para a separa√ß√£o que vc prop√¥s, tags me parecem mais adequadas do que criar v√°rias abas, al√©m de ser mais flex√≠vel. Por exemplo, eu posso fazer um artigo sobre carreira (com as tags "artigo" e "carreira"), mas tamb√©m posso fazer um relato pessoal sobre carreira (a√≠ teria as tags "relato" e "carreira"), etc. Isso ajuda tamb√©m a categorizar melhor os posts (desde que coloque um limite razo√°vel, 5 ou 6 tags no m√°ximo - mais que isso come√ßa a poluir demais e vira ru√≠do).

Inclusive, isso abre a possibilidade de fazer buscas por tags, o que diminui bastante a necessidade de v√°rias abas. Talvez poderia ter abas fixas para tags mais comuns, n√£o sei.

Mas em vez de abas, eu sugiro algo mais geral, como a possibilidade de ordenar posts por crit√©rios diferentes (podendo ser crescente ou decrescente):

- √öltimas Atualiza√ß√µes: posts que tiveram alguma atualiza√ß√£o mais recente (coment√°rio, edi√ß√£o, etc)
- Pontua√ß√£o: ordenar por posts por pontua√ß√£o
- Quantidade de coment√°rios
- Etc...

Com isso, juntamente com as tags e um sistema de busca, qualquer um pode filtrar e ordenar os posts da maneira que quiser. Indo um pouco al√©m, cada usu√°rio poderia salvar seus pr√≥prios filtros personalizados.

>> Coment√°rio de aprendendofelipe:
@EikkoMass, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser relacionada com outra j√° aberta, ent√£o recomendo centralizar a discuss√£o na #742.

Combinado? ü§ù
</issue_1278_[Improvement // Sugest√£o] Aplicar tipos para as tabs>

<issue_1280_Remo√ß√£o de c√≥digo n√£o utilizado no validador>
## Contexto

Haviam dois esquemas de valida√ß√£o de `owner_id` dentro de `validator.js`. O @henriquebcustodio notou e corrigiu isso.

## Execu√ß√£o

- #1243
</issue_1280_Remo√ß√£o de c√≥digo n√£o utilizado no validador>

<issue_1281_Ortografia da palavra "conte√∫dos" na p√°gina de status>
## Contexto

Os r√≥tulos dos dados nos gr√°ficos da p√°gina de status n√£o estavam definidos. Assim a biblioteca `recharts` utilizava a `dataKey` como r√≥tulo.

Isso n√£o impactava em nada para os gr√°ficos de "cadastros" e "respostas", mas o r√≥tulo ficava sem o acento agudo no "√∫" para o gr√°fico de "conte√∫dos".

## Execu√ß√£o

- #1246
</issue_1281_Ortografia da palavra "conte√∫dos" na p√°gina de status>

<issue_1282_Substitu√≠do o caractere de copyright pelo HTML entity>
## Contexto e Execu√ß√£o

- #1247
</issue_1282_Substitu√≠do o caractere de copyright pelo HTML entity>

<issue_1283_Alterados bot√µes de confirma√ß√£o de ingl√™s para portugu√™s>
## Contexto e Execu√ß√£o

- #1249
</issue_1283_Alterados bot√µes de confirma√ß√£o de ingl√™s para portugu√™s>

<issue_1284_Refatora√ß√£o da fun√ß√£o de rolar para o topo>
## Contexto e Execu√ß√£o

- #1250
</issue_1284_Refatora√ß√£o da fun√ß√£o de rolar para o topo>

<issue_1285_Uma √≥tima not√≠cia para o Reposit√≥rio do TabNews e a comunidade de programadores que est√£o l√° üéâ üí™ üòç>
Para a turma que est√° dando **watch** nesse reposit√≥rio, pe√ßo encarecidamente que leia esse an√∫ncio: https://www.tabnews.com.br/filipedeschamps/uma-otima-noticia-para-o-repositorio-do-tabnews-e-a-comunidade-de-programadores-que-estao-la ü§ù

>> Coment√°rio de Caixetadev:
O @aprendendofelipe √© um √≥timo programador e vai ser muito bom pro TabNews ter ele 100% aqui

>> Coment√°rio de filipedeschamps:
Ta sinceramente **MUITO** massa a movimenta√ß√£o no reposit√≥rio nos √∫ltimos dias! Excelente trabalho @aprendendofelipe e comunidade!

E como essa era uma issue comemorativa, vou fechar j√° ü§ù
</issue_1285_Uma √≥tima not√≠cia para o Reposit√≥rio do TabNews e a comunidade de programadores que est√£o l√° üéâ üí™ üòç>

<issue_1286_Acessibilidade dos links para a p√°gina inicial>
## Contexto

Os links para a p√°gina inicial (logo do TabNews) presentes no `Header`e no `Footer` n√£o continham nenhum texto que pudesse ser identificado por leitores de telas, ent√£o `aria-label` foi adicionado em cada um desses links.

## Execu√ß√£o

- #1260
</issue_1286_Acessibilidade dos links para a p√°gina inicial>

<issue_1287_Adiciona `Tooltip` com a data completa na lista de conte√∫dos>
## Contexto e Execu√ß√£o

- #1270
- #1298
</issue_1287_Adiciona `Tooltip` com a data completa na lista de conte√∫dos>

<issue_1288_Novo link para os pr√≥prios conte√∫dos no menu de usu√°rio>
## Contexto

Alguns novos usu√°rios n√£o encontravam facilmente o link para seus conte√∫dos, pois ele era identificado apenas pelo nome do usu√°rio no menu.

Agora ficou mais explicito, pois foi adicionado o item "Meus conte√∫dos" que leva para o mesmo lugar que ao clicar no `username` dentro do menu.

## Execu√ß√£o

- #1274
</issue_1288_Novo link para os pr√≥prios conte√∫dos no menu de usu√°rio>

<issue_1289_Mostrar √≠cone de verificado ao lado do nome do autor nos conte√∫dos>
Passando pelo twitter esses dias e como ta em evid√™ncia isso de selo de verificado, pensei se n√£o seria uma boa colocar uma esp√©cie de selo de verifica√ß√£o para os respons√°veis do tabnews ou para alguma empresa que esteja no tabnews e esteja postando algo seja reconhecida:

exemplo de selo de verificado no twitter:
![image](https://user-images.githubusercontent.com/48577990/222290405-01ec534e-b694-41d2-85e9-6c33035fcfb4.png)

acho que tambem entra na parte de seguran√ßa do site, uma vez que alguma pessoa pode cadastrar uma nova conta com os nomes:

- fillpedeschamps
- filipedeschamps
- felipedechamps

e se passar pelo mesmo

>> Coment√°rio de Rafatcb:
Acho uma preocupa√ß√£o v√°lida, s√≥ n√£o sei se a solu√ß√£o sugerida √© boa. Precisaria ter crit√©rios bem estabelecidos do motivo do verificado existir e quem precisa/pode ter esse selo. Aqui no GitHub, por exemplo, s√≥ existe o verificado para organiza√ß√µes (at√© onde eu sei), mas no TabNews todo mundo √© "usu√°rio".

Uma identifica√ß√£o dos moderadores pode ser legal em publica√ß√µes que ele(a) est√° orientando o usu√°rio sobre os termos de uso, por exemplo, mas desnecess√°rio em uma publica√ß√£o normal, porque atrair√° um destaque sem motivo. E, se for criar o selo apenas para isso, talvez fa√ßa mais sentido algum outro tipo de sistema para a orienta√ß√£o do moderador para o usu√°rio, ao inv√©s de criar um coment√°rio na publica√ß√£o.

Relacionado: https://github.com/filipedeschamps/tabnews.com.br/issues/1057

>> Coment√°rio de Ryannnkl:
acha que uma publica√ß√£o verificada no lugar de um perfil verificado √© uma alternativa melhor?

>> Coment√°rio de Rafatcb:
> acha que uma publica√ß√£o verificada no lugar de um perfil verificado √© uma alternativa melhor?

Se for para as situa√ß√µes que um moderador est√° orientando o usu√°rio, acho melhor outro sistema para isso, como uma mensagem de infra√ß√£o. Isso traria outros benef√≠cios tamb√©m, como o caso da infra√ß√£o n√£o ficar no limbo e poder ser vista por outros moderadores.
</issue_1289_Mostrar √≠cone de verificado ao lado do nome do autor nos conte√∫dos>

<issue_1305_[Feature] Bookmarks>
### Venho por meio deste, n√£o para sugerir, mas para discutirmos como esse sistema funcionaria! 
# Algumas ideias

### Abordagem do "marcador"
Esse sistema n√£o seria complexo, seria algo mais como o do stack overflow, onde um bot√£o seria exibido abaixo das tabcoins para salvar ou n√£o um conte√∫do, juntamente com o n√∫mero de marcadores de um conte√∫do. Adicionaria uma tabela "bookmarks" com o id do owner  e com o id do conte√∫do.

### Abordagem da "estantes"
Esse sistema seria complexo, seria algo mais como o do youtube, onde um bot√£o seria exibido abaixo das tabcoins para salvar ou n√£o um conte√∫do, juntamente com o n√∫mero de marcadores de um conte√∫do. Adicionaria uma tabela "bookshelfs" com o id do owner  e  os dados do bookshelf, e outra tabela "bookmarks", desta vez salvando o id da bookshelf nao do conteudo! nesse poderiamos implementar coisas como "bookshelfs" privadas.

Alguma ideia?

>> Coment√°rio de Rafatcb:
Hoje o Stack Overflow funciona mais como no seu segundo exemplo do que no primeiro:  [_Bookmarks have evolved into Saves_](https://meta.stackexchange.com/questions/382019/bookmarks-have-evolved-into-saves).

Existem outras issues sobre isso:
* https://github.com/filipedeschamps/tabnews.com.br/issues/1229
* https://github.com/filipedeschamps/tabnews.com.br/issues/1117
* https://github.com/filipedeschamps/tabnews.com.br/issues/1058
* https://github.com/filipedeschamps/tabnews.com.br/issues/983
* https://github.com/filipedeschamps/tabnews.com.br/issues/945
* https://github.com/filipedeschamps/tabnews.com.br/issues/937
* https://github.com/filipedeschamps/tabnews.com.br/issues/830
* https://github.com/filipedeschamps/tabnews.com.br/issues/645 (acredito que a discuss√£o poderia ser focada nessa issue, que √© a mais antiga e est√° bem elaborada)

>> Coment√°rio de aprendendofelipe:
Vou aproveitar a rela√ß√£o que o @Rafatcb postou e fechar as issues duplicadas com a # 645 

Obrigado pela issue! üëç
</issue_1305_[Feature] Bookmarks>

<issue_1306_Unifica vari√°veis de ambiente do banco de dados no arquivo `.env`>
## Contexto

As vari√°veis necess√°rias para conex√£o com o banco de dados em modo de desenvolvimento eram repetidas em tr√™s locais, sendo duas vezes no arquivo `.env` e mais uma vez no `seed-database.js`.

Agora fica mais f√°cil desenvolver e realizar testes com diferentes bancos, pois basta modificar em um ponto centralizado no `.env`.


## Execu√ß√£o

- #1235
</issue_1306_Unifica vari√°veis de ambiente do banco de dados no arquivo `.env`>

<issue_1307_Melhorar a fun√ß√£o `can` no model authorization>
## Contexto

√â preciso corrigir problemas apontados nos PRs:

- #1014
- #1290 

## Execu√ß√£o

- #1312 
- #1427
</issue_1307_Melhorar a fun√ß√£o `can` no model authorization>

<issue_1308_Refatora√ß√µes de componentes>
## Contexto

Alguns componentes possuem diversas oportunidades de melhorias, mesmo que sem mudan√ßas no comportamento para os usu√°rios.

## Execu√ß√£o

Foram refatorados os seguintes componentes:

- `TabCoinButtons` #1255 
- `Content` #1254
</issue_1308_Refatora√ß√µes de componentes>

<issue_1309_Corrigir diverg√™ncias de hor√°rio no tooltip dos conte√∫dos>
## Contexto

Corre√ß√£o de mensagens de erro ocorrendo em modo de desenvolvimento causadas por diferen√ßas no hor√°rio entre client e server no tooltip de conte√∫dos, al√©m de corrigir para hor√°rio local o valor que aparece quando a p√°gina de conte√∫dos √© acessada diretamente pelo seu endere√ßo.

Havia uma diferen√ßa de formata√ß√£o causada entre node e browser, que mostrava ou n√£o `√†s` entre a data e a hora.

Al√©m da diferen√ßa causada pelo fuso do servidor e do client, que no caso de quem est√° no fuso de Bras√≠lia ficava mostrando que a publica√ß√£o ocorreu 3 horas mais tarde, pois estava em UTC.

## Execu√ß√£o

- #1294 
- #1296
</issue_1309_Corrigir diverg√™ncias de hor√°rio no tooltip dos conte√∫dos>

<issue_1310_Mudan√ßa na posi√ß√£o do tooltip do hor√°rio>
## Contexto e Execu√ß√£o

- #1298
</issue_1310_Mudan√ßa na posi√ß√£o do tooltip do hor√°rio>

<issue_1311_Op√ß√£o de mostrar senha no formul√°rio de login e de cadastro>
## Contexto

Cria√ß√£o de um componente `TextInput` padronizado para utiliza√ß√£o nas p√°ginas que solicitam a senha do usu√°rio.

Esse componente deve possibilitar a escolha pelo usu√°rio se a senha deve ou n√£o ser exibida.

## Execu√ß√£o

- #1297 
- #1303 
- #1304 
- #1318
</issue_1311_Op√ß√£o de mostrar senha no formul√°rio de login e de cadastro>

<issue_1313_Previs√£o para uso do TabCash>
Existe alguma previs√£o para a implementa√ß√£o do mecanismo de utiliza√ß√£o dos TabCash?

>> Coment√°rio de aprendendofelipe:
Oi @Diegiwg, a previs√£o √© para a Milestone 7, mas ainda sem data definida.

A atual √© a [Milestone 6: Performance e Seguran√ßa](https://github.com/filipedeschamps/tabnews.com.br/milestone/10)
</issue_1313_Previs√£o para uso do TabCash>

<issue_1314_Qual √© o criterio utilizado para o ranking de conte√∫dos relevantes?>
Qual √© o criterio utilizado para o ranking de conte√∫dos relevantes?

Postei um conte√∫do que est√° com 5 tabcoins e 4 coment√°rios, um outro post est√° com 0 tabcoins e 0 coment√°rio e o mesmo est√°  em um rank superior ao meu.

>> Coment√°rio de aprendendofelipe:
Ol√° @hernique33comiitei, no PR #756 √© explicada uma vers√£o que n√£o √© a atual, mas que √© bem parecida, pois s√≥ recebeu pequenos ajustes que voc√™ pode acompanhar pelo hist√≥rico do arquivo [queries.js](https://github.com/filipedeschamps/tabnews.com.br/commits/main/models/queries.js)

>> Coment√°rio de hernique33comiitei:
> Ol√° @hernique33comiitei, no PR #756 √© explicada uma vers√£o que n√£o √© a atual, mas que √© bem parecida, pois s√≥ recebeu pequenos ajustes que voc√™ pode acompanhar pelo hist√≥rico do arquivo [queries.js](https://github.com/filipedeschamps/tabnews.com.br/commits/main/models/queries.js)

Obrigado
</issue_1314_Qual √© o criterio utilizado para o ranking de conte√∫dos relevantes?>

<issue_1320_Apresentar a quantidade de visualiza√ß√£o / views das publica√ß√µes.>
<h2>Objetivo</h2>
Essa op√ß√£o pode ajudar na modera√ß√£o dos votos, conforme conversado na Issue #1167.

Basta verificar uma m√©dia de view / qualifica√ß√£o. Se uma publica√ß√£o tiver 10 views e 8 up-votes fica claro que foi burlado.

Atualmente no site **stackoverflow** J√° conseguimos verificar a quantidade de visualiza√ß√µes de cada publica√ß√£o. 

![Captura de tela em 2023-03-13 09-14-55](https://user-images.githubusercontent.com/5334261/224699272-955c64ba-e180-4f8b-8cb5-13f05cbbfe5d.png)

<h2>Como fazer?</h2>

Acredito que devemos levar em considera√ß√£o alguns pontos para contabilizar o view, hoje no youtube para contabilizar a visualiza√ß√£o o usu√°rio precisa assistir pelo menos 20% do v√≠deo, no tabnews podemos definir um tempo por palavra da not√≠cia, desta forma n√£o seria apenas um "acesso" e sim um tempo m√©dio por tamanho de publica√ß√£o.

Outro ponto que acredito ser necess√°rio √© n√£o repetir visualiza√ß√£o do usu√°rio, cada usu√°rio s√≥ poder√° visualizar a publica√ß√£o uma √∫nica vez, se o usu√°rio n√£o estiver logado, podemos trabalhar com visualiza√ß√£o do IP mascarado / sess√£o.

Isso tudo para impedir manipula√ß√£o das visualiza√ß√µes.

O que acham?

>> Coment√°rio de hkotsubo:
> Se uma publica√ß√£o tiver 10 views e 8 up-votes fica claro que foi burlado.

N√£o necessariamente, pode ser apenas um post que caiu no gosto da galera. Eu diria que n√∫meros muito altos **podem ser um ind√≠cio**, mas da√≠ pra ter certeza absoluta, tem um caminho grande e nebuloso. Tem que juntar com outras informa√ß√µes, e mesmo assim, certeza absoluta geralmente se tem s√≥ em casos mais flagrantes.

Detectar fraudes √© complicado, geralmente trabalha-se com probabilidades, baseadas em v√°rios fatores analisados em conjunto (por exemplo, view de usu√°rios logados vs n√£o-logados, intervalo em que os votos foram dados, IP's usados, padr√µes de vota√ß√£o anteriores, hor√°rio - de madrugada o movimento √© menor, ent√£o muitos votos nesse hor√°rio seria mais "suspeito" - etc - estou chutando, se fosse pra propor detec√ß√£o de fraude eu pensaria melhor nos exemplos). Se algo for suspeito demais (e quanto √© esse "demais" sempre ser√° subjetivo), pode-se assumir que foi burlado, com um grau de confian√ßa aceit√°vel.

A quantidade de views pode ajudar, claro, mas √© complicado achar que **somente** a raz√£o dela com os votos j√° d√° a certeza de fraude (talvez em casos mais gritantes sim, mas em geral, eu diria que no m√°ximo pode ser um ind√≠cio, que deve ser analisado com outras informa√ß√µes).

>> Coment√°rio de rodrigoKulb:
@hkotsubo com certeza, seria somente **mais um indicativo,** digo isso pois o tabnews possui usu√°rios leitores n√£o cadastrados.

O usu√°rio que tem muitas tabcoins poder√° utilizar v√°rias no pr√≥prio post com 2 contas, desta forma vamos DIFICULTAR a vida deles, imagine um post com 1 view e 20 tabcoins.

Ser√° mais um grande par√¢metro para mensura√ß√£o, fora que √© uma grande funcionalidade para todos do portal.

Nem sempre um v√≠deo legal no youtube tem muitos likes, as vezes o indicativo de view acaba sendo mais importante.

>> Coment√°rio de Gabriel-Tapes:
Talvez a melhor forma de fazer isso fosse limitar o n√∫mero de votos por conta ao inv√©s de IP, ou com os dois. Atualmente cada IP pode dar um voto a cada 72h, o que j√° deixa muito mais dif√≠cil um mesmo usu√°rio dar 20 tabcoins para um post, limitando isso por conta tamb√©m faria com que o usu√°rio precisasse de 20 contas, o que dificultaria muito as fraudes.

>> Coment√°rio de rodrigoKulb:
@Gabriel-Tapes sim, j√° verifiquei depois que foi aplicado esse bloqueio bem legal!

A quest√£o de views ficaria mais por conta da informa√ß√£o mesmo! Sem necessidade de "blindar". Podendo tamb√©m ser utilizada no algor√≠timo de ordena√ß√£o das postagens.

>> Coment√°rio de Rafatcb:
Apesar dessa sugest√£o ter sido dada com o objetivo de modera√ß√£o, acredito que podemos fechar o issue porque temos a mesma sugest√£o sendo debatida aqui:

* https://github.com/filipedeschamps/tabnews.com.br/issues/1115

>> Coment√°rio de aprendendofelipe:
Boa @Rafatcb!
</issue_1320_Apresentar a quantidade de visualiza√ß√£o / views das publica√ß√µes.>

<issue_1324_[Feature/Sugest√£o] Verifica√ß√£o de Not√≠cias Duplicadas>
Uma feature pra evitar duplicidade de not√≠cias poderia ser algo que verifique se o link da fonte j√° est√° em algum outro post, e indique qual o post para o usu√°rio ir l√° no original e comentar, interagir, etc com a not√≠cia que ele teve interesse e foi l√° divulgar

>> Coment√°rio de jgb27:
Se depois da verifica√ß√£o, ele n√£o permitir que seja publicado por ter a mesma fonte, n√£o acho legal. Agora, se ele apenas sugerir um post parecido, seria melhor, pois a pessoa pode usar a mesma fonte, mas apenas para dar uma introdu√ß√£o, n√£o necessariamente falar do mesmo assunto.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Alysson! Estou fechando esse issue como duplicado de https://github.com/filipedeschamps/tabnews.com.br/issues/787, para podermos concentrar a discuss√£o l√°.
</issue_1324_[Feature/Sugest√£o] Verifica√ß√£o de Not√≠cias Duplicadas>

<issue_1325_[Feature/Sugest√£o] Busca de temas>
Uma coisa (que precisei e nao tem hj) que pode ser relevante √© uma forma de pesquisar por posts, not√≠cias, temas no site. Atualmente s√≥ tem as recentes e relevantes, sendo necess√°rio percorrer todas pra buscar algo que o usu√°rio teve interesse

>> Coment√°rio de aprendendofelipe:
@k3ybladewielder, obrigado pela Issue! üëç

N√£o ficou claro se a sugest√£o √© um sistema de buscas ou de tags, ambas √≥timas sugest√µes.

Para que as ideias avancem, recomendo contribuir com as discuss√µes abertas sobre o tema:

- #742 
- #927 

Vou fechar esse, ok? ü§ù
</issue_1325_[Feature/Sugest√£o] Busca de temas>

<issue_1326_√çcones para TabCoin e TabCash>
![image](https://user-images.githubusercontent.com/111156073/225172691-445ba50d-a6f5-4ee2-9c8c-f123b615ce29.png)
Atualmente os TabCoins e TabCash s√£o representadas assim, esses "√≠cones" poderiam facilmente representar qualquer outra coisa, ent√£o o que proponho √© a cria√ß√£o de √≠cones originais para os TabCoins e TabCash.

O que acham?

>> Coment√°rio de gustavokennedy:
Boa ideia @ermesonqueiroz

>> Coment√°rio de FilipeRicardo:
Use um emoje para cada um deles.
üíµ 49 üí∏ 65

>> Coment√°rio de daniloabramo:
### Tenho uma sugest√£o do design para os novos √≠cones: 

**Resultado:**
![antes-e-depois](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/41bb80c8-fcec-4878-b6c0-fe58d24b068f)

**Desenvolvimento:**
Para o √≠cone do TabCoin, inicialmente considerei um cifr√£o ($) no centro, mas percebi que em dimens√µes pequenas isso dificultava a clareza. Optei ent√£o por combinar um pixel com uma moeda, garantindo melhor visibilidade em tamanhos reduzidos. Apresento dois estilos finais para o √≠cone, sendo o opaco o mais vis√≠vel.
![tabcoin](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/1c779104-bf72-442f-8e4f-3f7cc1e77317)

Compreendo o TabCash como uma vers√£o refinada e de maior valor do que o TabCoin, pois s√≥ √© poss√≠vel obt√™-lo por meio da troca de prest√≠gio entre o usu√°rio e a comunidade. Devido ao espa√ßo limitado e √† necessidade de transmitir claramente esse valor, elaborei uma vers√£o minimalista dos diamantes frequentemente utilizados em jogos.
![tabcash](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/2db1e24d-c1da-4ba6-b629-8fdf1e9bf8fe)

**O que acham?**

>> Coment√°rio de Rafatcb:
@daniloabramo obrigado pela sugest√£o.

N√£o sei como o √≠cone ser√° escolhido, j√° que isso √© muito de gosto pessoal (e, considerando isso, provavelmente seria melhor ter mais op√ß√µes e talvez uma vota√ß√£o), mas acredito que na fase de implementa√ß√£o, podemos continuar usando as cores atuais. Digo isso porque, nas fotos que voc√™ colocou, as cores novas pareceram menos harm√¥nicas.

Se formos considerar que os √≠cones podem auxiliar pessoas com algum tipo de daltonismo (como tritanopia ou monocromacia) a identificarem TabCoins e TabCash mais facilmente, talvez o c√≠rculo e o hex√°gono ainda fiquem muito parecidos quando pequenos (foi a impress√£o que tive nas fotos que voc√™ colocou, mas a imagem est√° menor do que estaria no site, ent√£o n√£o tenho certeza).

![Tritanopia deixa o verde e o azul parecidos, e monocromacia tamb√©m (as cores acabam sendo tons de cinza).](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/44639cae-9b04-496f-a48e-c05cb1884043)
[Fonte da imagem](https://www.healthdirect.gov.au/colour-blindness).

>> Coment√°rio de daniloabramo:
@Rafatcb Obrigado pela resposta;

Eu n√£o entendi muito bem sua quest√£o sobre as cores, est√° sugerindo alterar as cores dos √≠cones? Ou continuar com as que j√° est√£o presentes no Tab News? Se for continuar com as cores j√° utilizadas, os √≠cones que sugeri mant√©m essas cores, inclusive verifiquei com uma ferramenta de detectar cores e o resultado presente no site e nas imagens dos √≠cones s√£o id√™nticos, (azul: #0969DA e verde: #2DA44E).

Quanto ao desenvolvimento, prefere que eu fa√ßa uma postagem no Tab News mais detalhada sobre o desenvolvimento desses √≠cones para ter um feedback da comunidade? Nesse caso tamb√©m deixarei uma abertura para novas sugest√µes de √≠cones, seja no design ou estilo, pois confesso n√£o ter outras ideias de √≠cones funcionais atualmente.

A partir das id√©ias da comunidade posso formular outras sugest√µes de √≠cones funcionais, mas n√£o tenho certeza dos passos seguintes, ap√≥s a formula√ß√£o de outros √≠cones devo realizar uma nova postagem no Tab News, coment√°rio na issue ou enviar para um terceiro canal onde os colaboradores possam realizar a primeira peneirada dos √≠cones que acreditam somar com o projeto? E ap√≥s essa peneira realizar a vota√ß√£o com a comunidade, me parece o correto.

Se for pelo caminho de eu realizar inicialmente um post no Tab News, existe alguma [ tag ], para referenciar assuntos que envolvem especificamente feat ui do site?

Qualquer outra d√∫vida estou √† disposi√ß√£o para responder.  

Obs. Por favor leiam sem o google tradutor do navegador estar ativado, ele na tradu√ß√£o distorce algumas de minhas falas.

>> Coment√°rio de Rafatcb:
> Se for continuar com as cores j√° utilizadas, os √≠cones que sugeri mant√©m essas cores, inclusive verifiquei com uma ferramenta de detectar cores e o resultado presente no site e nas imagens dos √≠cones s√£o id√™nticos, (azul: #0969DA e verde: #2DA44E).

Confirmei e na imagem dos √≠cones est√£o na cor correta, como voc√™ disse. N√£o sei o que houve quando voc√™ aplicou no TabNews que ficou bem diferente (veja como o azul ficou bem mais forte):

![As duas imagens com zoom](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9ff30b43-b0f0-4d30-9a99-5e690cfb0c38)

Essa imagem est√° em qualidade baixa porque apenas peguei suas prints e dei zoom.  No teste que fiz localmente, pegando os SVGs do seu PR, ficou correto:

![Modo claro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/acf32025-fc2b-40c1-b26f-a617ebbeaf9a)

![Modo escuro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/5a89e84f-13c2-4512-86ee-ddbd5f3196bf)

Edit: tirando o fato de que eu inverti os √≠cones hehehe.

> Quanto ao desenvolvimento, prefere que eu fa√ßa uma postagem no Tab News mais detalhada sobre o desenvolvimento desses √≠cones para ter um feedback da comunidade? Nesse caso tamb√©m deixarei uma abertura para novas sugest√µes de √≠cones, seja no design ou estilo, pois confesso n√£o ter outras ideias de √≠cones funcionais atualmente.

Imagino que isso seja necess√°rio sim em algum momento, porque a intera√ß√£o l√° √© maior do que no reposit√≥rio, e se algu√©m publicar algo relevante l√° e n√£o aqui, podemos trazer o coment√°rio com o link para termos o hist√≥rico do que foi debatido. J√° fiz isso em outras ocasi√µes, principalmente durante a constru√ß√£o do FAQ.

> A partir das id√©ias da comunidade posso formular outras sugest√µes de √≠cones funcionais, mas n√£o tenho certeza dos passos seguintes

Acho que voc√™ tem uma ideia geral do processo na qual eu concordo. N√£o sei se receberemos muitas sugest√µes da comunidade, mas podemos decidir o que fazer depois de recebermos as sugest√µes. Talvez seja poss√≠vel resolver aqui neste issue mesmo, talvez precise de outra publica√ß√£o, mas no caso de uma vota√ß√£o imagino que um mantenedor poderia fazer a publica√ß√£o para dar um car√°ter oficial, como √© feito com os an√∫ncios de Milestones.

> Se for pelo caminho de eu realizar inicialmente um post no Tab News, existe alguma [ tag ], para referenciar assuntos que envolvem especificamente feat ui do site?

Voc√™ pode fazer sua publica√ß√£o como se fosse um pitch (n√£o precisa colocar `[Pitch]` not t√≠tulo, mas pode). Por exemplo: "Desenvolvi √≠cones para os TabCoins e TabCash e quero saber a sua opini√£o". N√£o precisa ser esse t√≠tulo, apenas exemplifiquei para voc√™ entender o "tom". Algo que mostre pelo t√≠tulo que est√° aberto a feedbacks.

Um exemplo de situa√ß√£o parecida √© esse: https://www.tabnews.com.br/eliasnsz/nao-aguento-mais-ser-mediocre-e-favoritos-do-tabnews.  O eliasnsz chegou a desenvolver uma sugest√£o para favoritar publica√ß√µes e criou uma publica√ß√£o compartilhando isso no TabNews, depois compartilhou no reposit√≥rio: https://github.com/filipedeschamps/tabnews.com.br/issues/645#issuecomment-1998619703.

>> Coment√°rio de Rafatcb:
Para quem est√° acompanhando o issue mas n√£o viu no TabNews, o @daniloabramo criou uma publica√ß√£o no TabNews sobre a sugest√£o feita em https://github.com/filipedeschamps/tabnews.com.br/issues/1326#issuecomment-2028559265: [Re Design TabCoin e TabCash, qual a sua opini√£o?](https://www.tabnews.com.br/DaniloAbramowicz/re-design-tabcoin-e-tabcash-qual-a-sua-opiniao)

>> Coment√°rio de daniloabramo:
### Conclus√£o sobre a postagem no TabNws:

Gostaria de ressaltar que n√£o dei upvote em nenhum coment√°rio para n√£o influenciar outras pessoas a concordarem.

1 - Apesar da comunidade colocar o t√≥pico como relevante, n√£o ocorreu muita intera√ß√£o sobre sugest√µes, entendo essa a√ß√£o como entenderem a import√¢ncia em rela√ß√£o ao UX e UI do site, e de confiar nas decis√µes que tomamos. Concordam?

2 - Infelizmente n√£o houve novas sugest√µes de design, mas houve uma divis√£o sobre o melhor √≠cone para o tabcash:

![tabcashvs](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/1fd83b61-9e41-4d15-a8fd-91da7906e1a2)

Como o design do segunda lapida√ß√£o (cubo) foi realizada com a maior √°rea vazada e houve coment√°rio preferindo a vers√£o da menor √°rea vazada, desenvolvi um meio termo entre ambas. 

![tamanho-moeda](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/72938314-4bc9-40fc-9fd2-520e28498209)

![tamanho-gema](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/e260dad3-3061-4d12-bfc3-ccfba21198d6)

**P:**
![cristal p](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/d7b7a9f9-288f-461a-ae89-cfa978eeca72)
**M:**
![cristal m](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/aaba7b25-357b-46a7-9c43-a17a1080ad8d)
**G:**
![cristal g](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/6e131437-2af0-4ec0-9bb2-d20203483832)

![tamanho-cubo](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/474f6ce2-dc3f-44f3-b658-d5cc4a3f6635)

**P:**
![cubo p](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/e1ef44a4-b951-4f4f-b613-6881694ffbf3)
**M:**
![cubo m](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/17c28ccd-4933-4952-9777-a950736f232b)
**G:**
![cubo g](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/1aeb5bc9-4d4b-4057-9487-07cf17e50e2b)

N√£o havia feito essa vers√£o antes, pois ela quebra a grade de √≠cone que estava utilizando, por√©m como desde antes os tabcoins n√£o seguiam o mesmo estilo que os outros √≠cones, tomei a liberdade de adicionar elemento a grade que estava utilizando, (√© aceit√°vel essa ‚Äúquebra‚Äù do padr√£o, quando √© aplicado ao restante dos √≠cones e melhora a percep√ß√£o do usu√°rio).  

![grade](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/51c9ff40-0789-4c3a-baed-048164e48510)

A modifica√ß√£o √© o aro azul.

### Pr√≥ximos passos (Na minha opni√£o):

Acredito que a partir de agora devemos decidir qual ser√° a vers√£o vazada dos √≠cones (P, M ou G), j√° deixo que na minha opini√£o o M √© a op√ß√£o mais balanceada entre eleg√¢ncia e clareza na visibilidade. 

Outro ponto importante a ser decidido √© se com a modifica√ß√£o do design dos √≠cones ir√° alterar a tag aria-label (recurso de acessibilidade para leitores de tela descrever o √≠cone), atualmente est√£o como ‚ÄúTabCoins‚Äù e ‚ÄúTabCashs‚Äù. Minha d√∫vida √© se desejam manter como est√°, ou alterar para: Moeda representando/como TabCoins, Gemas representando/como TabCashs, ou algo diferente?

Por fim ficaria a decis√£o do √≠cone do TabCash, que acredito que pode ser decidida no reposit√≥rio, pelos colaboradores e/ou mantenedores ou a comunidade. 

Acho que abordei todos os t√≥picos importantes, apesar de ainda n√£o ter certeza sobre a √∫ltima parte. 

Obrigado pela aten√ß√£o.

>> Coment√°rio de Rafatcb:
@daniloabramo obrigado por todo esfor√ßo! Na minha opini√£o, o cen√°rio M foi o que ficou melhor na UI do TabNews (considerando que esses √≠cones ser√£o exibidos num tamanho pequeno). Em compara√ß√£o, no cen√°rio P me parece que a parte interna √© circular, e no cen√°rio G a parte colorida fica muito fina. 

No M, em tamanho pequeno, o formato interno de cubo acaba parecendo um c√≠rculo tamb√©m.

> Outro ponto importante a ser decidido √© se com a modifica√ß√£o do design dos √≠cones ir√° alterar a tag aria-label

Me parece fazer sentido manter como est√°, que √© a parte relevante da informa√ß√£o.

> Por fim ficaria a decis√£o do √≠cone do TabCash, que acredito que pode ser decidida no reposit√≥rio, pelos colaboradores e/ou mantenedores ou a comunidade.

Eu gostei das propostas, n√£o tenho prefer√™ncia sobre Gema ou Cubo, mas se precisasse escolher uma ou dar um voto de desempate, seria a Gema.

@aprendendofelipe o que acha das sugest√µes? Tem alguma opini√£o contr√°ria?

>> Coment√°rio de daniloabramo:
@Rafatcb Obrigado pela paci√™ncia e seu engajamento no tema.

Realmente, os prints anteriores n√£o estavam desempenhando o melhor meio para visualizar o resultado final. 

### Visualizar resultado final: 

Devolvi um clone do header do TabNews com a fun√ß√£o de alternar os √≠cones que passaram da etapa inicial realizada na postagem com a comunidade.

https://header-tabnews.vercel.app/

### Novo tamanho

Adicionei um novo tamanho: MG, como o nome sugere, ele √© o aro entre o tamanho m e g, como demonstrado abaixo no aro rosa. 

<a href="https://imgur.com/e36cDbe"><img src="https://i.imgur.com/e36cDbe.jpg" title="source: imgur.com" /></a>

Al√©m dessa nova vers√£o, aumentei o radius um pouco dos Tabcoins e da gema, pois estavam ficando com aspecto de afiado nas pontas. 

### Pr√≥ximos passos:

Acredito que com base no site j√° seja poss√≠vel realizar uma vota√ß√£o de maneira clara para os usu√°rios, como infelizmente n√£o existe uma fun√ß√£o nativa de enquete no TabNews, talvez adicionar um link de formul√°rio do google ou da microsoft, no [site de preview](https://header-tabnews.vercel.app/) seja o melhor caminho.

Tamb√©m compreendo que por serem √≠cones de destaque, seja optado a deixar a vota√ß√£o limitada ao reposit√≥rio, aos desenvolvedores e mantenedores do projeto ou alguma outra op√ß√£o.

>> Coment√°rio de aprendendofelipe:
@daniloabramo, muito obrigado pelas propostas de √≠cones e pelo site de preview! üí™

Um problema que percebo nos √≠cones propostos, √© que fica dif√≠cil visualizar o formato deles em baixa resolu√ß√£o. Acredito que por isso voc√™ tenha deixado os √≠cones um pouco grandes no seu preview. Se diminuir eles em uns 25%, acredito que ficam com um tamanho melhor, mas j√° fica bem dif√≠cil identificar as formas deles corretamente.

Acredito que podemos usar √≠cones quase t√£o simples como os atuais, que funcionam bem mesmo com resolu√ß√µes em torno de 10px, e mesmo assim diferenciar TabCoin de TabCash. Um exemplo:

<img width="100" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/3cadbe7c-32be-4f64-9c70-492bbb5d0916" align="center">
<img width="150" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/2630dec1-42ba-48cc-a2a7-638f633620c2" align="center">
<img width="8" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/3cadbe7c-32be-4f64-9c70-492bbb5d0916" align="center">
<img width="12" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/2630dec1-42ba-48cc-a2a7-638f633620c2" align="center">

>> Coment√°rio de daniloabramo:
@aprendendofelipe Realizei as sugest√µes que comentou.

De fato os √≠cones deveriam estar em uma escala 25% menor, acabei me confundindo com os elementos e puxei o valor da caixa que envolve os √≠cones.

Adicionei a funcionalidade de alterar a escala dos √≠cones, acredito que a escala de 14px seja o ideal, n√£o se destaca tanto em rela√ß√£o aos outros elementos, como tamb√©m n√£o √© necess√°rio que o usu√°rio force a vis√£o para a enxergar com clareza a vers√£o anterior dos √≠cones. 

Mas se formos seguir com a vers√£o full dos √≠cones, n√£o vejo problema em desenvolver novos √≠cones que se adaptem melhor a esse estilo, inclusive fique a vontade para sugerir sugest√µes. 

https://header-tabnews.vercel.app/

>> Coment√°rio de aprendendofelipe:
Eu gostei desta vers√£o. O que acham?

![Sugest√£o de √≠cones de TabCoin e TabCash](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/95147897-a12d-4f9c-9357-ff5402c988d6)

>> Coment√°rio de Rafatcb:
@daniloabramo belo site de preview! Muito √∫til.

Meu preferido foi a Forma 1, s√≥lida. Acho que as bordas arredondadas deram um bom toque.

![Forma s√≥lida, tamanho 12px no preview. TabCoins √© um quadrado azul com bordas arredondadas, TabCash √© um quadrado inclinado (como um losango), tamb√©m com as bordas arredondadas](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/a58f37fe-7a99-41ab-84d2-be4b4143d14d)

Apesar disso, entendo que em algumas ocasi√µes os √≠cones podem continuar parecidos (por exemplo, para algu√©m com algum problema de vis√£o), onde a sugest√£o do @aprendendofelipe leva vantagem, pelos √≠cones serem mais distintos.

Faz sentido usar um c√≠rculo para representar o TabCoin ("moeda" Tab), mas n√£o consegui encontrar ou pensar em algo que tamb√©m "fizesse sentido" para o TabCash ("dinheiro" Tab). Um ret√¢ngulo, lembrando uma c√©dula, muito provavelmente n√£o ficaria legal, principalmente por ter uma altura diferente. Poder√≠amos pensar no formato de diamante, mas a√≠ voltamos ao problema dos √≠cones ficarem mais parecidos para quem tem problemas de vis√£o, resolu√ß√£o ou tamanho menor etc.

>> Coment√°rio de daniloabramo:
Realmente pensando na nitidez as formas s√≥lidas ficam melhor.

> ![1234](https://github.com/user-attachments/assets/c253b569-3a00-4e75-a1da-1b858cfc2d23)

A ideia da estrela se destaca realmente no quesito de distin√ß√£o, por√©m quando realizei a postagem no TabNews ningu√©m se interessou pela forma de estrela, apesar que na √©poca utilizei a estrela padr√£o.

Al√©m disso, essa forma de estrela atualmente vem sendo empregada como s√≠mbolo de ferramentas de IA, o exemplo mais not√°vel que recordo √© o Gemini do Google, mas outras plataformas tamb√©m adotam essa abordagem. 

![gemini](https://github.com/user-attachments/assets/8d609caa-7fc4-4222-a8d6-3902d96ed005)

Como o Tab News √© formado por uma comunidade com interesses em tecnologia, na minha opini√£o aumenta consideravelmente a associa√ß√£o incorreta sobre o tabcash. 

> Faz sentido usar um c√≠rculo para representar o TabCoin ("moeda" Tab), mas n√£o consegui encontrar ou pensar em algo que tamb√©m "fizesse sentido" para o TabCash ("dinheiro" Tab).

Acredito que essa simbologia de colocar o tabcash como ‚Äúdinheiro‚Äù ou ‚Äúdinheiro que se foi‚Äù, se deu por n√£o haver uma aplica√ß√£o direta para ele, verifiquei que a √∫ltima mensagem na issue foi um m√™s antes da aplica√ß√£o de an√∫ncios no Tab News.  

Agora, com o tabcash sendo uma moeda de troca para funcionalidade especial, acredito que uma forma que transmita import√¢ncia e exclusividade seja o ideal. A forma de cristal, bastante comum no universo dos jogos para representar algo valioso e moeda de troca para itens e benef√≠cios especiais, tem um impacto maior na usabilidade e associa√ß√£o de valor.  

Al√©m das lapida√ß√µes j√° existentes, adicionei a forma de diamante, como demonstrado abaixo:
![diamante](https://github.com/user-attachments/assets/c96b033e-8219-45dc-ac1f-c79429c3ddd3)

Tamb√©m pode visualizar ela no preview: 
[https://header-tabnews.vercel.app/](https://header-tabnews.vercel.app/)

Nos testes que realizei, os que trouxeram melhores resultados de nitidez e de associa√ß√£o foram esses quatro conjuntos:

![1](https://github.com/user-attachments/assets/84247c27-a65c-4c67-ab8f-ec52617d4688)
![2](https://github.com/user-attachments/assets/80795094-ffe1-492e-a3d3-b29441831d61)
![3](https://github.com/user-attachments/assets/60bd29a0-75a6-4537-81f2-c3727619f926)
![4](https://github.com/user-attachments/assets/c0cf1095-6c0e-43ec-8414-0d80ff026687)
</issue_1326_√çcones para TabCoin e TabCash>

<issue_1330_[Sugest√£o] √Årea reservada para projetos pessoais>
Ol√° pessoal!

Tenho visto que muitas pessoas t√™m postado projetos pessoais, o que √© algo incr√≠vel e que com certeza motiva aos demais colegas, no entanto tenho a impress√£o de as coisas como est√£o hoje deixam tudo muito embaralhado, sabe? Voc√™ tem um not√≠cia, do lado de um texto t√©cnico, a√≠ do nada surge um projeto.

Diante disso, minha sugest√£o √© a cria√ß√£o de uma √°rea espec√≠fica para projetos e que na mesma pudesse haver a separa√ß√£o dos n√≠veis dos projetos. Algo semelhante pode ser visto neste [f√≥rum](https://labdegaragem.com/) de eletr√¥nica.

>> Coment√°rio de rodrigoKulb:
Grande @luissenko acredito que uma boa sa√≠da seria criar tags para categorias da natureza da informa√ß√£o.

Temos algumas Issues com assuntos semelhantes podemos unificar todos para gerar uma conversa sobre o assunto:

https://github.com/filipedeschamps/tabnews.com.br/issues/859
https://github.com/filipedeschamps/tabnews.com.br/issues/742
https://github.com/filipedeschamps/tabnews.com.br/issues/1126

A categoria deixar√≠amos muito restrito a UMA √∫nica categorias, j√° as tags podemos colocar por exemplo:
`#php #projetopessoal #noticia #artigo`

>> Coment√°rio de luissenko:
> 

Genial, rodrigoKulb! Boa ideia!

>> Coment√°rio de rodrigoKulb:
@luissenko para facilitar vamos conversar sobre esse assunto somente em uma Issue, minha sugest√£o seria a mais antiga a #742 vamos voltar a falar desse assunto l√° para tentar definir uma op√ß√£o com a turma! 

Voc√™ finaliza essa Issue?

>> Coment√°rio de luissenko:
Beleza!
</issue_1330_[Sugest√£o] √Årea reservada para projetos pessoais>

<issue_1331_Permitir equa√ß√µes e diagramas no markdown>
## Contexto

Adicionar os plugins do ByteMD, que √© a biblioteca utilizada para exibir e editar markdown, que permitem renderizar diagramas mermaid e equa√ß√µes matem√°ticas:

```mermaid
graph TD;
  A-->B;
  A-->C;
  B-->D;
  C-->D;
```

Que √© criado com o c√≥digo:

````
```mermaid
graph TD;
  A-->B;
  A-->C;
  B-->D;
  C-->D;
```
````

E

$$
\displaystyle \left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right)
$$

Que √© criada com o c√≥digo:

```
$$
\displaystyle \left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right)
$$
```

## Execu√ß√£o

- #1322 
- #1323
</issue_1331_Permitir equa√ß√µes e diagramas no markdown>

<issue_1332_Atualizar todas as depend√™ncias do projeto>
## Contexto e Execu√ß√£o

- #1319 
- #1391 
- #1622
</issue_1332_Atualizar todas as depend√™ncias do projeto>

<issue_1333_Adiciona compatibilidade com o comando `docker compose`>
## Contexto e Execu√ß√£o

- #1315
</issue_1333_Adiciona compatibilidade com o comando `docker compose`>

<issue_1334_Exclus√£o da p√°gina de login no hist√≥rico de navega√ß√£o>
## Contexto e Execu√ß√£o

- #1321

>> Coment√°rio de aprendendofelipe:
E com o PR #1340 o redirecionamento de volta para a p√°gina anterior ao ato de login ir√° ocorrer tamb√©m quando a navega√ß√£o para a tela de login ocorrer pelo link do header.
</issue_1334_Exclus√£o da p√°gina de login no hist√≥rico de navega√ß√£o>

<issue_1335_Ocultar/Exibir respostas>
## Contexto

Criar a possibilidade de ocultar e mostrar respostas, abrindo possibilidades de melhorias futuras como envio de menos dados do backend.

## Execu√ß√£o

- #1300

>> Coment√°rio de aprendendofelipe:
O algoritmo foi ajustado nos PRs #1329, #1354 e #1355 para mostrar mais sub coment√°rios dos coment√°rios mais relevantes.

Futuramente foi notado um bug que foi corrigido nos PRs #1483 e #1484
</issue_1335_Ocultar/Exibir respostas>

<issue_1338_[OTIMIZACAO] DeepScan report>
Ol√° pessoal,

Segue o report com algumas recomenda√ß√µes.

https://deepscan.io/dashboard/#view=project&tid=20438&pid=23903&bid=730298

 <img src="https://i.imgur.com/WnZTYBE.png">

>> Coment√°rio de Rafatcb:
A maioria √© falso positivo, reclamando de _keyword_ `const`, `import`, `export`, ou _invalid token_ `>`. As √∫teis s√£o desse tipo:

1. https://deepscan.io/dashboard/#view=project&pid=23903&iid=174521272&tid=20438&subview=issues&bid=730298
> Variable 'values' is null checked here, but its property is accessed without null check prior at line 92 
> https://github.com/filipedeschamps/tabnews.com.br/blob/4c5593c8ef3d5f9adea1e476a8370e3681d3ba2b/models/content.js#L93-L110

2. https://deepscan.io/dashboard/#view=project&pid=23903&iid=174521283&tid=20438&subview=issues&bid=730298
> Expression 'user' always passes null check at this point because it is already checked at line 50 .
> https://github.com/filipedeschamps/tabnews.com.br/blob/4c5593c8ef3d5f9adea1e476a8370e3681d3ba2b/pages/interface/components/Content/index.js#L53

3. https://deepscan.io/dashboard/#view=project&pid=23903&iid=174521292&tid=20438
> Duplicate property name 'source_url' in object literal. The previous property with the same name is at line 360 
> https://github.com/filipedeschamps/tabnews.com.br/blob/4c5593c8ef3d5f9adea1e476a8370e3681d3ba2b/tests/integration/api/v1/contents/%5Busername%5D/%5Bslug%5D/children/get.test.js#L361-L362

Podemos ativar a regra [`no-dupe-keys`](https://eslint.org/docs/latest/rules/no-dupe-keys) para o terceiro caso. No primeiro caso e segundo caso, n√£o encontrei uma regra para ajudar em JavaScript.

>> Coment√°rio de repires:
@Rafatcb Novo report:

https://deepscan.io/dashboard/#view=project&tid=23222&pid=26495&bid=844489

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/867660/1f35dfa4-3155-475e-a0bf-357545bd9861)

>> Coment√°rio de Rafatcb:
Obrigado pela atualiza√ß√£o, @repires . Voc√™ mudou algo para o report n√£o ter mais tantos falso-positivos?

Tamb√©m percebi que um erro que ele tinha identificado e eu mencionei no meu outro coment√°rio (`if (user && contentObject?.owner_id === user?.id) { `) continua no c√≥digo e ele n√£o reportou, ent√£o vale verificar ambos os links na hora de corrigir este issue.

>> Coment√°rio de repires:
Eu somente fiz um rebase e gerei um novo relat√≥rio
</issue_1338_[OTIMIZACAO] DeepScan report>

<issue_1339_Ganho inicial de TabCoins ao publicar depender de reputa√ß√£o do autor>
## Contexto

Usu√°rios ainda sem reputa√ß√£o conhecida n√£o deveriam ganhar TabCoins ao publicar conte√∫dos ou coment√°rios. No come√ßo deve ganhar/perder s√≥ os TabCoins dos votos recebidos.

A reputa√ß√£o seria constru√≠da com os votos recebidos de usu√°rios que j√° constru√≠ram reputa√ß√£o. Poderia ser a m√©dia dos votos dos √∫ltimos X conte√∫dos (3 ou 5, n√£o muitos), **[Edit] desconsiderando os √∫ltimos 3 dias e talvez dando pesos diferentes para conte√∫dos root e respostas**. S√≥ contaria para a reputa√ß√£o os conte√∫dos com status publicado. Assim os usu√°rios s√£o fo√ßados a se educar, pois excluir um conte√∫do mal avaliado melhora a reputa√ß√£o e excluir um conte√∫do bem avaliado piora a reputa√ß√£o.

Deveria ter um limite baixo de reputa√ß√£o em que o usu√°rio nem poderia mais publicar nada enquanto n√£o adequar seu comportamento na plataforma (talvez 0). Ao tentar publicar, o usu√°rio receberia um aviso com instru√ß√µes para verificar o c√≥digo de conduta ou os termos. E l√° pode constar que √© recomendado remover conte√∫dos negativados para melhorar sua reputa√ß√£o. 

E no lado oposto, ap√≥s atingir determinado valor de reputa√ß√£o, ao postar conte√∫do ou coment√°rio o usu√°rio j√° a ganha uma quantidade de TabCoins proporcional √† reputa√ß√£o. Podemos come√ßar com um limiar baixo, talvez bastando a m√©dia de votos ser positiva para o usu√°rio j√° ganhar TabCoins. E a raz√£o tamb√©m pode ser 1 pra 1 (arredondado para baixo), ou seja, usu√°rio com reputa√ß√£o de 1,7 recebe 1 TabCoin ao publicar.

A ideia √© dificultar a manipula√ß√£o da economia. Ainda poderiam ocorrer abusos, mas teriam que come√ßar com um usu√°rio real, que j√° atingiu boa reputa√ß√£o, e que teria muito a perder quando o abuso for pego.

~No futuro~ podemos pensar em separar as reputa√ß√µes de coment√°rios das reputa√ß√µes de conte√∫dos root.

## Execu√ß√£o

- #1366

>> Coment√°rio de hkotsubo:
Caso isso seja implementando, como ficaria a pontua√ß√£o dos usu√°rios j√° existentes? Principalmente os que tiverem contas criadas alguns dias antes da implanta√ß√£o, por exemplo.

Suponha que eu criei uma conta hoje, postei v√°rios coment√°rios in√∫teis ("obrigado", "que legal") e ganhei alguns tabcoins, e no dia seguinte o sistema muda para esta nova regra, como ficam meus tabcoins?

Quanto √†s contas antigas, isso vai ser aplicado retroativamente? (acredito que ser√° complicado fazer isso, ent√£o √© inevit√°vel que haja "injusti√ßas").

>> Coment√°rio de aprendendofelipe:
Oi @hkotsubo, nada precisa ser feito retroativamente, pois quem tiver publica√ß√µes recentes que n√£o sejam relevantes j√° vai precisar se adequar. Se elas forem neutras, basta come√ßar a s√≥ postar conte√∫dos relevantes, ou n√£o vai mais ganhar TabCoins. J√° quem tiver publica√ß√µes negativadas, ao ponto de deixar a reputa√ß√£o zerada ou negativa, ter√° que excluir essas publica√ß√µes ou n√£o conseguir√° publicar mais nada.

E a injusti√ßa seria n√£o tomar essa medida, j√° que a proposta desde sempre foi de s√≥ ganhar TabCoins quem gerar **valor concreto**.

>> Coment√°rio de hkotsubo:
Bom, entendi a ideia geral, mas n√£o consegui visualizar os c√°lculos espec√≠ficos. Talvez se tivesse alguns exemplos :-)

---

Vc chegou a simular com os usu√°rios atuais? Acho interessante testar com algumas varia√ß√µes (como o valor de X √∫ltimos conte√∫do, ver qual o valor de X seria razo√°vel na pr√°tica), s√≥ pra ver o impacto.

Porque se por um lado isso dificulta o ganho indevido de TabCoins, por outro lado pode diminuir a quantidade de votos dados (pois gasta-se TabCoins para votar, ent√£o se ficar mais dif√≠cil ganh√°-los, vai ficar mais dif√≠cil votar tamb√©m).

>> Coment√°rio de aprendendofelipe:
> Vc chegou a simular com os usu√°rios atuais?

Ainda n√£o existe nada implementado. O debate √© necess√°rio para quem for implementar ter no que se basear. üëç

> Acho interessante testar com algumas varia√ß√µes (como o valor de X √∫ltimos conte√∫do, ver qual o valor de X seria razo√°vel na pr√°tica), s√≥ pra ver o impacto.

Sim, tem que testar. Uma condi√ß√£o a mais, que at√© vou editar o texto l√° pra incluir, seria considerar apenas de uns 3 dias pra tr√°s, pois assim pegaria uma m√©dia mais consolidada, j√° que os conte√∫dos mais recentes podem ainda estar recebendo votos.

> Porque se por um lado isso dificulta o ganho indevido de TabCoins, por outro lado pode diminuir a quantidade de votos dados (pois gasta-se TabCoins para votar, ent√£o se ficar mais dif√≠cil ganh√°-los, vai ficar mais dif√≠cil votar tamb√©m).

Dificulta s√≥ para quem n√£o publicar conte√∫dos relevantes, mas em contrapartida pode aumentar consideravelmente os ganhos de quem publica conte√∫dos relevantes, ent√£o n√£o deve diminuir os votos, mas sim termos votos mais criteriosos. Mas, √© claro, tem que testar. üëç

>> Coment√°rio de aprendendofelipe:
Implementado em #1366 inclusive com a separa√ß√£o de conte√∫dos "root" e coment√°rios.

Atualiza√ß√µes dos par√¢metros foram realizadas em:
- #1436 
- #1440 
- #1444 
- #1469 
- #1477
</issue_1339_Ganho inicial de TabCoins ao publicar depender de reputa√ß√£o do autor>

<issue_1341_Hist√≥rico de votos recebidos e extrato de TabCoins>
Hoje eu estava no site e entre uma p√°gina e outra vi que ganhei 1 TabCoin, o que indica que algu√©m votou positivo em algum post meu.

Entrei nos Meus Conte√∫dos e n√£o consegui identificar em qual foi. Primeiro porque eu n√£o lembro a pontua√ß√£o anterior de todos os posts, segundo porque pode ter sido em algum mais antigo (pode estar em qualquer uma das trocentas p√°ginas, e a√≠ √© que eu n√£o vou lembrar mesmo da pontua√ß√£o que eles tinham).

Enfim, eu sei que algum post recebeu voto porque o n√∫mero l√° em cima mudou. Mas eu n√£o sei qual.

N√£o seria interessante ter uma p√°gina mostrando este hist√≥rico de votos recebidos? No caso, cada usu√°rio veria apenas o seu (n√£o sei se faz sentido eu ver o hist√≥rico dos outros).

Pensei em separar por dia e hor√°rio, mas claro que se algu√©m pensar em um formato melhor, fique √† vontade para sugerir. Um rascunho b√°sico:

- 22/03/2023
    - 1 positivo - post A - 10:30
    - 1 negativo - post B - 09:47
    - 1 positivo - post A - 09:21
    - 1 positivo - post B - 08:11

- 19/03/2023
    - 1 positivo - post C - 17:23
- etc...

Sendo que "post X" seria um link direto para o post.

---

Outra op√ß√£o √© s√≥ mostrar um consolidado por post, por dia (neste caso n√£o teria o hor√°rio, somente um resumo dos votos do dia):

- 22/03/2023
    - 2 positivos - post A
    - 1 negativo e 1 positivo - post B

- 19/03/2023
    - 1 positivo - post C
- etc...

---

E isso n√£o √© por mera curiosidade, acho importante saber como anda a vota√ß√£o dos posts. Por exemplo, se recebo um negativo, posso voltar ao post e ver se tem algo errado (nem sempre as pessoas comentam o motivo), e se for o caso, edit√°-lo. Como hoje √© dif√≠cil acompanhar posts antigos (leia-se "da segunda p√°gina em diante"), a p√°gina de hist√≥rico ajudaria muito nesse gerenciamento.

E de forma geral, quero saber como est√° sendo o feedback dos meus posts. E acompanhar a vota√ß√£o de um jeito mais f√°cil ajuda nesse sentido (muito mais do que lembrar a pontua√ß√£o atual de cada um e ir vendo se mudou).

Tem tamb√©m os casos em que recebo um positivo e um negativo, e a√≠ n√£o vou saber mesmo porque o n√∫mero sequer vai mudar. Mas √© interessante saber, pois isso pode indicar que o post √© controverso/"pol√™mico", e eu posso querer ajustar o texto por exemplo.

---

Por mais √≥bvio que pare√ßa, n√£o custa lembrar que os votos permanecem an√¥nimos (ou seja, eu continuo n√£o conseguindo saber quem votou).

>> Coment√°rio de hkotsubo:
Complementando, [agora que h√° mais modos de ganhar TabCoins](https://www.tabnews.com.br/FelipeBarso/tabnews-agora-com-recompensas-diarias-em-tabcoins), creio que este hist√≥rico seja ainda mais importante para que todo usu√°rio saiba o que est√° acontecendo com sua pontua√ß√£o.

Mas em vez de apenas indicar os votos recebidos, creio que agora seria interessante que cada um soubesse quantos TabCoins ganhou e o motivo. E no motivo, caso seja algum evento ocorrido em algum post (foi publicado, recebeu votos, etc), poderia tamb√©m ter um link para o respectivo post.

Ex:

| Data       | Altera√ß√£o de TabCoins | Motivo                         |
|------------|-----------------------|--------------------------------|
| dd/mm/aaaa | +5                    | Publica√ß√£o "xpto" (link)       |
| dd/mm/aaaa | -1                    | Voto negativo em "post" (link) |
| dd/mm/aaaa | +2                    | Recompensa di√°ria              |

Lembrando que isso fica restrito ao pr√≥prio usu√°rio (ningu√©m pode consultar o hist√≥rico dos outros).

>> Coment√°rio de FMorschel:
Como mencionado na issue vinculada acima, acredito que se ela for implementada, poder√≠amos pensar em uma forma de adicionar essa informa√ß√£o nesse hist√≥rico tamb√©m. 

Para n√£o gerar informa√ß√£o n√£o necessariamente relacionada a essa issue. Caso queiram saber mais, por favor abram a issue espec√≠fica #1651.
</issue_1341_Hist√≥rico de votos recebidos e extrato de TabCoins>

<issue_1344_Diferenciar retornos 403 do backend do TabNews e do Proxy>
## Contexto

Dependendo do tipo de desafio aplicado pelo proxy do TabNews em um momento de suspeita de ataque, pode ser necess√°ria uma a√ß√£o ativa do usu√°rio. Mas se ele j√° estiver navegando em modo SPA, ele pode n√£o receber o desafio e ficar sem acesso √† API.

Precisamos conseguir identificar esses casos de erro na API por bloqueio do proxy e fornecer um aviso do ocorrido com um bot√£o de refresh da p√°gina.

## Execu√ß√£o

Ao receber o status 403 da API o client deve olhar para os cabe√ßalhos a procura de algum que sempre esteja presente em respostas do backend, talvez algum da pr√≥pria Vercel ou algum cabe√ßalho que podemos inserir.

Revisar se estamos utilizando corretamente o retorno 403 em todos os casos, ou se algum deles deveria ser modificado para 401 ou outro status.

Melhorar o feedback de erros para o usu√°rio.

>> Coment√°rio de filipedeschamps:
> Ao receber o status 403 da API o client deve olhar para os cabe√ßalhos a procura de algum que sempre esteja presente em respostas do backend, talvez algum da pr√≥pria Vercel ou algum cabe√ßalho que podemos inserir.

Perfeito!!!

>> Coment√°rio de aprendendofelipe:
Est√° implementada uma vers√£o preliminar (PRs #1356, #1357, #1358, #1359).

Caso seja detectado que o usu√°rio est√° sem acesso √† API, ele ser√° redirecionado para a p√°gina de login, onde haver√° um refresh e o retorno para a p√°gina em que o usu√°rio estava. Com isso o usu√°rio recupera seu acesso mesmo que n√£o estejamos com o desafio habilitado em todas as p√°ginas. Basta estar habilitado na API e na p√°gina de login.

Provavelmente n√£o ser√° poss√≠vel implementar da primeira maneira que foi pensada, pois apesar do proxy enviar o status 403, ele tamb√©m causa um erro de rede, o que impede de recuperarmos o status via JS. Como o erro de rede pode n√£o ser exatamente devido ao proxy, ent√£o implementei um √∫nico refresh da p√°gina e caso o erro persista nada mais √© feito.

Acredito que os pr√≥ximos passos podem ser a cria√ß√£o de uma p√°gina e um endpoint da API espec√≠ficos para essa funcionalidade. Onde a p√°gina do desafio abre em uma nova janela e utiliza um endpoint respondido diretamente pela edge, sem utilizar nenhum outro recurso do backend.
</issue_1344_Diferenciar retornos 403 do backend do TabNews e do Proxy>

<issue_1345_goog>
like
</issue_1345_goog>

<issue_1346_[BUG] Lista de postagens n√£o cont√©m todas as minhas postagens>
Recentemente respondi uma postagem no tabnews por√©m ela n√£o conta na minha lista de postagens, outra coisa que percebi √© que minha resposta est√° em ultimo mesmo tendo mais upvotes, n√£o sei se existe alguma regra para ordernar mas me chamou a aten√ß√£o

![image](https://user-images.githubusercontent.com/36305985/227735040-7aaed973-7e11-40f1-98bd-d1b56d3f6783.png)

Postagens do meu perfil:
![image](https://user-images.githubusercontent.com/36305985/227735081-a9ade4a3-18b5-4b49-adb8-5a7f8450c221.png)

Link para postagem original: https://www.tabnews.com.br/joseaugusto/como-um-artigo-no-tabnews-mudou-minha-forma-de-pensar

Link para o eu meu perfil: https://www.tabnews.com.br/leoferreiralima

>> Coment√°rio de aprendendofelipe:
Opa @leoferreiralima ü§ù

> Recentemente respondi uma postagem no tabnews por√©m ela n√£o conta na minha lista de postagens

Suas respostas est√£o l√° üëç Provavelmente voc√™ estava visualizando uma vers√£o em cache da p√°gina:

![image](https://user-images.githubusercontent.com/77860630/227735794-6c88ddcf-1683-402d-8d21-6af7cca41fad.png)

> percebi √© que minha resposta est√° em ultimo mesmo tendo mais upvotes, n√£o sei se existe alguma regra para ordernar mas me chamou a aten√ß√£o

As repostas s√£o ordenadas nessa fun√ß√£o: üòâ

https://github.com/filipedeschamps/tabnews.com.br/blob/fd7ed674099538edccf03871f03ce0f85229ec05/models/content.js#L895

>> Coment√°rio de leoferreiralima:
Vi agora que apareceu o que achei estranho √© que estava em outro dispositivo, provavelmente cache da vercel mesmo. Obrigado üòä
</issue_1346_[BUG] Lista de postagens n√£o cont√©m todas as minhas postagens>

<issue_1347_[SUGEST√ÉO] Men√ß√µes em publica√ß√µes e coment√°rios - Endpoint de listagem de usu√°rios>
Se estiver duplicado por favor fechem.

Seria interessante se tivesse uma implementa√ß√£o em que fosse possivel fazer mens√µes a usu√°rios da plataforma tanto na parte de p√∫blica√ß√µes quanto na de coment√°rios atrav√©s do '@'. Tamb√©m seria legal se houvesse um endpoint que listassem todos os usu√°rios do tabnews, ate onde eu vi da documenta√ß√£o da api do website nao tem nada do tipo.
</issue_1347_[SUGEST√ÉO] Men√ß√µes em publica√ß√µes e coment√°rios - Endpoint de listagem de usu√°rios>

<issue_1350_Bytemd bot√µes de mathPlugin e mathPlugin>
Na pull request #1348 foi adicionado alguns plugins, entre eles mathPlugin e mermaidPlugin
Ao clicar/ativar o bot√£o do diagrama ele acaba ficando com uma aparencia de desativado no para op√ß√µes. Isso ocorre tamb√©m para fun√ß√µes matem√°ticas 
Seria correto isso ou talvez j√° tem o "bug" da vers√£o mesmo?
PS: a funcionalidade n√£o foi afetada em nada s√≥ UX mesmo que fico pensando.

![image](https://user-images.githubusercontent.com/55710708/228974378-535a56e4-1aad-4907-a5af-79974291cbdd.png)

>> Coment√°rio de aprendendofelipe:
Ol√° @b2evandro, sobre os plugins, eles j√° estavam presentes e funcionais antes desse PR, e quase nada deveria mudar sobre isso, a n√£o ser que envolva as cores üëç

J√° os bot√µes e as op√ß√µes no editor, esses sim foram nesse PR, e com certeza v√£o surgir ainda muitas necessidades de ajustes at√© todas as cores ficarem perfeitas, ent√£o pode reportar tudo que encontrar, pois ser√° corrigido ü§ù

>> Coment√°rio de aprendendofelipe:
@b2evandro, j√° corrigi as cores das fontes que voc√™ relatou. Qualquer problema √© s√≥ nos informar. Muito obrigado! üí™
</issue_1350_Bytemd bot√µes de mathPlugin e mathPlugin>

<issue_1351_[Melhoria] Abrir os links (internos/externos) em uma nova aba do navegador>
Se for poss√≠vel, dar a op√ß√£o ao dono da publica√ß√£o do conte√∫do de colocar os links para abrir em uma nova aba.

PS: N√£o sei se h√° essa possibilidade via Markdown.

![image](https://user-images.githubusercontent.com/36301054/229118153-c543ffa7-e04d-48f4-96f9-7428aa2ab2d4.png)

>> Coment√°rio de aprendendofelipe:
Ol√° @zehguilherme, chegou a ver o que j√° foi conversado sobre o assunto? Recomendo ver principalmente esse https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074

>> Coment√°rio de cybernerd007:
Boa noite, basta fazer dessa forma `<a href="http://www.exemplo.com.br" target="_blank">Texto do link</a>` assim ele ira abrir em outra aba.

>> Coment√°rio de zehguilherme:
@aprendendofelipe faz realmente sentido os pontos levantados pelo @filipedeschamps! Sempre tive essa ideia em projetos pr√≥prios ou mesmo em outros que sempre era necess√°rio manter o usu√°rio na p√°gina atual caso o link a ser aberto seja de outro site de contexto diferente.
</issue_1351_[Melhoria] Abrir os links (internos/externos) em uma nova aba do navegador>

<issue_1360_Habilita barra de ferramentas e melhora a responsividade do editor de markdown>
## Contexto

O editor ByteMD possui uma barra de ferramentas que estava desativada por n√£o se adequar a estiliza√ß√£o do TabNews.

Al√©m disso, as especifica√ß√µes de dimens√µes do editor n√£o se ajustavam corretamente em telas pequenas e o redimensionamento do compo de texto n√£o era poss√≠vel.

## Execu√ß√£o

A estiliza√ß√£o do ByteMD precisou ser revista durante os PRs que implementaram e ajustaram o dark mode (#1348 e #1353), ent√£o as quest√µes acima j√° foram resolvidas nos mesmos PRs.
</issue_1360_Habilita barra de ferramentas e melhora a responsividade do editor de markdown>

<issue_1361_Corrige URL do TabNews nos metadados>
## Contexto

As vari√°veis de ambiente utilizadas s√≥ eram acess√≠veis no lado do servidor. Com isso os metadados ficavam com dados inv√°lidos ap√≥s a hidrata√ß√£o dos dados no navegador.

## Execu√ß√£o

O PR #1228 refatorou o `infra/webserver` e adicionou `NEXT_PUBLIC` √†s vari√°veis de ambiente para torn√°-las acess√≠veis tamb√©m no lado do client e permitir mostrar os dados corretos no navegador.
</issue_1361_Corrige URL do TabNews nos metadados>

<issue_1362_Adiciona Tooltip aos bot√µes de qualifica√ß√£o de conte√∫dos>
## Contexto e Execu√ß√£o

- #1277
</issue_1362_Adiciona Tooltip aos bot√µes de qualifica√ß√£o de conte√∫dos>

<issue_1363_Texto quebrando>
Acho que isto esta errado, fui lendo os coment√°rios e o texto foi simplesmente sumindo

![Screenshot_20230407_094332_Chrome](https://user-images.githubusercontent.com/42983463/230611047-0ae68c09-f45e-4ae6-bc8d-2c5c560a16a9.jpg)

>> Coment√°rio de aprendendofelipe:
Ol√° @alan-chris, recomendo acompanhar/contribuir sobre o assunto atrav√©s do #379 üí™

Vou fechar essa duplicidade, ok? üëç

>> Coment√°rio de hisirdox:
Ok, vou dar uma olhada l√°
</issue_1363_Texto quebrando>

<issue_1364_Bloqueio da possibilidade de alterar o status de `published` para `draft`>
**[Edit]** A proposta n√£o √© eliminar a funcionalidade *draft*, mas apenas bloquear a revers√£o de *published* para *draft*.

Com exce√ß√£o da regra de firewall em que os conte√∫dos s√£o alterados para `draft` enquanto se analisa se √© ou n√£o um caso de abuso, para o usu√°rio n√£o deveria ser poss√≠vel despublicar um conte√∫do sem excluir ele, pois essa possibilidade √© um grande complicador e abre brechas para as regras de neg√≥cio compat√≠veis com as melhorias abaixo:

- #1155 
- #1198 
- #1339 

Penso que as √∫nicas possibilidades normais para um conte√∫do que j√° foi publicado seriam s√≥ a edi√ß√£o ou exclus√£o do mesmo.

Existe alguma justificativa para manter essa funcionalidade ou podemos bloquear ela?

>> Coment√°rio de filipedeschamps:
O caso de uso era publicar algo sem querer (antes de estar pronto), e ao inv√©s de deletar, s√≥ deixar como draft. Outro caso de uso era ir construindo a publica√ß√£o e ir salvando ela no servidor remoto (tipo Wordpress), para depois fazer a publica√ß√£o final (isso possibilita trabalhar em m√∫ltiplas publica√ß√µes paralelas).

A necessidade do primeiro caso √© real e j√° fiz publica√ß√µes erradas algumas vezes, mas o segundo caso nunca pediram. E dado a complexidade que isso traz para o sistema, eu concordo total em remover ü§ù

E j√° deixo o convite para quanto mais coisas removermos do sistema, melhor üí™deveria ser uma luta constante nossa.

Ps: seria legal anunciar antes esta breaking change na API, pois ela assume `draft` como default.

>> Coment√°rio de aprendendofelipe:
Show!

E a sugest√£o √© mais tranquila do que parece, pois **n√£o** estou sugerindo mudar nada com rela√ß√£o ao default ser `draft`. Ent√£o o caso de come√ßar como rascunho continuar√° sendo poss√≠vel pela API e futuramente ainda dever√≠amos implementar na vers√£o web.

J√° o caso de publicar algo sem querer, se n√£o h√° interesse em manter publicado, por enquanto basta remover. Quando implementarmos a vers√£o web do draft, ent√£o podemos dar a op√ß√£o de criar um draft com base em algo j√° publicado. Mas ser√° uma nova publica√ß√£o, com um novo ID. Da√≠ fica a crit√©rio do usu√°rio apagar ou n√£o a original.

>> Coment√°rio de filipedeschamps:
> E a sugest√£o √© mais tranquila do que parece, pois **n√£o** estou sugerindo mudar nada com rela√ß√£o ao default ser `draft`. Ent√£o o caso de come√ßar como rascunho continuar√° sendo poss√≠vel pela API e futuramente ainda dever√≠amos implementar na vers√£o web.

Show, entendi! ü§ù 

> Quando implementarmos a vers√£o web do draft, ent√£o podemos dar a op√ß√£o de criar um draft com base em algo j√° publicado. Mas ser√° uma nova publica√ß√£o, com um novo ID. Da√≠ fica a crit√©rio do usu√°rio apagar ou n√£o a original.

Ok, mas temos que cuidar da UX disso, pois acho que fica estranho esse modelo mental para o usu√°rio. De qualquer forma, tem um outro status que mais para frente eu gostaria de implementar, e que se encaixa melhor nisso, que √© o de `unlisted`, assim como o YouTube faz. Mas vamos discutir sobre isso mais para frente e em outra thread ü§ù

>> Coment√°rio de iget-master:
Eu acho que a funcionalidade de Draft n√£o deveria ser removida, vejo total utilidade para posts longos.

Poderia inclusive limitar a N drafts por usu√°rio para evitar abuso da funcionalidade.

Eu topo implementar front para a funcionalidade de Draft.

>> Coment√°rio de aprendendofelipe:
Ol√° @iget-master, n√£o est√° sendo proposto excluir a funcionalidade *draft*.

A proposta √© bloquear a possibilidade de transformar em *draft* um conte√∫do que est√° *published*. Se o conte√∫do tiver sido publicado, ent√£o s√≥ ser√° poss√≠vel editar ou excluir.

Um dos motivos √© porque existe uma penalidade ao excluir um conte√∫do relevante, que √© a perda dos tabcoins ganhos com esse conte√∫do. Ent√£o a possibilidade de voltar o status para *draft* √© uma maneira de burlar essa regra.

>> Coment√°rio de danielschmitz:
Eu n√£o entendi, at√© hoje, porque um "cms" como o tabnews, onde pessoas escrevem artigos, nao existe um estdado do artigo que inicialmente √© draft, e depois pode se tornar publico. 

isso √© b√°sico do b√°sico.  Sei que o tabnews √© minimalista, mas essa feature √© fundamental

existe algum sentido para que nao se tenha o draft? se sim, gostaria de compreender.

>> Coment√°rio de aprendendofelipe:
> nao existe um estdado do artigo que inicialmente √© draft, e depois pode se tornar publico.

Oi @danielschmitz, o estado padr√£o das publica√ß√µes via API √© draft.

Uma solu√ß√£o mais completa s√≥ precisa que algu√©m contribua implementando üòâ

>> Coment√°rio de danielschmitz:
> > nao existe um estdado do artigo que inicialmente √© draft, e depois pode se tornar publico.
> 
> Oi @danielschmitz, o estado padr√£o das publica√ß√µes via API √© draft.
> 
> Uma solu√ß√£o mais completa s√≥ precisa que algu√©m contribua implementando üòâ

Entendo, mas quando estou no /publicar, o conte√∫do √© criado como published. Correto?
</issue_1364_Bloqueio da possibilidade de alterar o status de `published` para `draft`>

<issue_1365_Recentemente criei meu primeiro conte√∫do e recebi 2 tabcoins, mas na √°rea da postagem tem 1 tabcoin de diferen√ßa>
Se isso for novo aqui t√° um report do bug:

![Captura de tela 2023-04-08 201823](https://user-images.githubusercontent.com/83515833/230746451-f4ab13f3-72be-4406-b536-b54061a1bb1d.png)

>> Coment√°rio de cybernerd007:
Boa noite amigo, provavelmente algu√©m deu DownVote quando isso ocorre voc√™ perde 1 tabcoin...

>> Coment√°rio de ThaysonScript:
> Boa noite amigo, provavelmente algu√©m deu DownVote quando isso ocorre voc√™ perde 1 tabcoin...

Sinceramente falando, isso aconteceu quando gerei o conte√∫do na mesma hora

>> Coment√°rio de aprendendofelipe:
Ol√° @ThaysonScript, pelas regras atuais (que devem mudar em breve), ao publicar voc√™ recebe 2 TabCoins e seu conte√∫do come√ßa com 1 TabCoin.

Se n√£o foi isso que aconteceu, ent√£o d√™ mais detalhes, por favor, pois pela sua imagem parece que aconteceu exatamente o esperado. üëç

>> Coment√°rio de ThaysonScript:
> Ol√° @ThaysonScript, pelas regras atuais (que devem mudar em breve), ao publicar voc√™ recebe 2 TabCoins e seu conte√∫do come√ßa com 1 TabCoin.
> 
> Se n√£o foi isso que aconteceu, ent√£o d√™ mais detalhes, por favor, pois pela sua imagem parece que aconteceu exatamente o esperado. üëç

H√°, ent√£o foi isso que aconteceu msm, obrigado!
</issue_1365_Recentemente criei meu primeiro conte√∫do e recebi 2 tabcoins, mas na √°rea da postagem tem 1 tabcoin de diferen√ßa>

<issue_1368_n√£o consigo postar>
N√£o consigo fazer meu primeiro post, sempre d√° esse erro "Usu√°rio n√£o pode executar esta opera√ß√£o. Verifique se este usu√°rio possui a feature "create:content". 8eb18473-3d41-4792-89c9-a2d4687995a7"

e a cada vez que eu aperto em publicar, esse c√≥digo do muda

>> Coment√°rio de aprendendofelipe:
Ol√° @RomildoRocha, caso seu usu√°rio no TabNews seja o "RomildoRocha", parece que est√° tudo certo com ele.

Tentou em outro dispositivo ou navegador? Parece que n√£o est√° sendo enviado o cookie de sess√£o.

>> Coment√°rio de RomildoRocha:
Tentei agora em outro navegador e consegui, mas pelo meu navegador padr√£o (Google Chrome) n√£o consigo

>> Coment√°rio de aprendendofelipe:
Show, deve ser alguma configura√ß√£o no seu navegador Chrome, ent√£o revise as permiss√µes de cookies para usar as configura√ß√µes recomendadas. 

N√£o parece ser um problema com o TabNews, ent√£o vou fechar a issue. Mas qualquer novidade √© s√≥ reabrir, combinado? ü§ù
</issue_1368_n√£o consigo postar>

<issue_1369_Problema ao criar uma publica√ß√£o>
Ol√°, Comunidade do TabNews!

Ontem, foi a minha primeira tentativa de publicar um artigo no TabNews. Por√©m, n√£o fui capaz de concluir. Ao tentar publicar, a seguinte mensagem √© mostrada na tela:

![Mensagem de Erro 1](https://user-images.githubusercontent.com/74771892/232029839-e433077c-06f6-4de8-ba38-511fda328e19.png)

Al√©m disso, verifiquei a minha conta e, ao tentar atualizar meus dados, n√£o sou capaz de atualizar. Vejam: 

![Mensagem de Erro 2](https://user-images.githubusercontent.com/74771892/232030023-04726c39-1e3d-4e82-809e-a13fbff7ae14.png)

>> Coment√°rio de aprendendofelipe:
Ol√° @pab-h, muito provavelmente voc√™ tem alguma configura√ß√£o no seu navegador/dispositivo que est√° bloqueando cookies.

Favor testar em outro dispositivo ou navegador para confirmar se √© mesmo isso. üëç

E, por favor, n√£o deixe de nos contar quando descobrir o que tinha de errado com seu dispositivo, pois isso pode ajudar outros usu√°rios com casos iguais ao seu, como esse #1368 ü§ù

>> Coment√°rio de filipedeschamps:
Interessante o que est√° acontecendo, pois ele est√° logado e possui todas as permiss√µes: https://www.tabnews.com.br/api/v1/users/Pab

√â estranho ele receber essa mensagem, pois ela √© do Backend, mas pelo que lembro receberia de fato se estivesse enviando a request como um usu√°rio an√¥nimo.

Ser√° que o `useUser()` est√° identificando corretamente se o usu√°rio est√° logado? Na √∫ltima semana recebi 3 emails similares, tanto que pedi a todos para publicarem aqui e investigarmos em grupo.

@pab-h voc√™ j√° estava a muito tempo logado?

>> Coment√°rio de aprendendofelipe:
> Ser√° que o `useUser()` est√° identificando corretamente se o usu√°rio est√° logado? Na √∫ltima semana recebi 3 emails similares, tanto que pedi a todos para publicarem aqui e investigarmos em grupo.

N√£o √© imposs√≠vel, mas acredito que n√£o seja isso. Se o @pab-h e/ou @RomildoRocha puderem ajudar na investiga√ß√£o dando mais detalhes pra gente do que acontece...

Sobre o `useUser()`, acho que pode ser isso se o header `x-vercel-id` n√£o estiver presente no retorno 403 que eles est√£o recebendo. Conseguem verificar isso no DevTools?

Um outro ind√≠cio de que o problema pode ser relacionado ao `useUser()` √© se bastar clicar em deslogar no menu do usu√°rio e fazer login novamente para tudo voltar ao normal. Fizeram esse teste?

Eu acho mais prov√°vel que alguma atualiza√ß√£o do Chrome tenha mudado algo com rela√ß√£o aos cookies para quem tem alguma configura√ß√£o mais restrita do que a padr√£o.

Se for esse o caso, o que imagino que ocorre √© o seguinte:

1. O cookie n√£o est√° sendo salvo pelo navegador no momento do login.
2. Mas o localStorage guarda o cache do usu√°rio logado at√© a pr√≥xima verifica√ß√£o.
3. Se o usu√°rio n√£o tentar publicar ou qualificar nada, ele pode permanecer por alguns minutos nessa condi√ß√£o como se estivesse logado, mas logo a revalida√ß√£o em segundo plano deve excluir o cache do usu√°rio e mostrar como n√£o logado.
4. Mas se o usu√°rio tentar interagir com algo que precisa estar logado (publicar, qualificar ou editar), ele receber√° a mensagem de que n√£o tem permiss√£o (como est√° sem cookie, dever√≠amos mudar para 401, mas hoje recebe 403).
5. E nesse momento o cache do usu√°rio deve ser exclu√≠do do localStorage e tudo se repete se o usu√°rio fizer login novamente.

Se for isso, √© s√≥ usar a configura√ß√£o padr√£o do navegador ou ter√° que customizar as permiss√µes para o TabNews (e provavelmente tamb√©m para a Cloudflare).

√â isso que acontece? Se puderem ajudar a gente com mais detalhes, vai ser massa üí™

>> Coment√°rio de pab-h:
A pedido do @aprendendofelipe aqui est√£o os headers: 

### POST | https://www.tabnews.com.br/api/v1/contents 

**Response Headers**
```
HTTP/2 403 Forbidden
date: Fri, 14 Apr 2023 22:36:04 GMT
content-type: application/json; charset=utf-8
access-control-allow-credentials: true
access-control-allow-headers: X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version
access-control-allow-methods: GET,OPTIONS,PATCH,DELETE,POST,PUT
access-control-allow-origin: *
cache-control: public, max-age=0, must-revalidate
etag: W/"p9h9vfraqx9m"
permissions-policy: camera=(), microphone=(), geolocation=()
referrer-policy: origin-when-cross-origin
strict-transport-security: max-age=63072000; includeSubDomains; preload
x-content-type-options: nosniff
x-dns-prefetch-control: on
x-frame-options: SAMEORIGIN
x-matched-path: /api/v1/contents
x-vercel-cache: MISS
x-vercel-id: gru1::gru1::kxqrj-1681511764710-befc01f9aa38
x-xss-protection: 1; mode=block
cf-cache-status: DYNAMIC
report-to: {"endpoints":[{"url":"https:\/\/a.nel.cloudflare.com\/report\/v3?s=bPGmAPn9Kf8JIo%2FgzcpSN6DMacfAlVQotTmFlFFpxRY%2FkxGMHpASgVPuJOgN9%2FVDRtdppqZdvQI8vMRJMfZGaBXganlBc34y3Bdh5BHjcGSbBIN3Oe3JFrEQwjdge6FJo16mVbar7ac%2BRZK5BabsyQ%3D%3D"}],"group":"cf-nel","max_age":604800}
nel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}
server: cloudflare
cf-ray: 7b7f6cf13e2d15b9-FOR
content-encoding: br
X-Firefox-Spdy: h2
``` 

**Request Headers**
```
POST /api/v1/contents HTTP/2
Host: www.tabnews.com.br
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/112.0
Accept: application/json
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://www.tabnews.com.br/publicar
Content-Type: application/json
Content-Length: 4616
Origin: https://www.tabnews.com.br
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
TE: trailers
```

>> Coment√°rio de pab-h:
@filipedeschamps, sobre a pergunta se eu estava logado a muito tempo, sim, estava. Faz-se um tempo consider√°vel desde que loguei, quest√£o de meses, no tabnews. Nunca fui deslogado por nenhum motivo. Ent√£o, desde esse dia, n√£o renovei o login nenhuma vez.

>> Coment√°rio de pab-h:
Sobre informa√ß√µes armazenadas no LocalStorage, h√° tr√™s chaves cadastradas: colorMode, content-new e user. 

Aqui est√° o json armazenado na chave user:
```json
{
  "id":"22237c4b-f6c2-4bca-8b25-ba35b71d04b5",
  "username":"Pab",
  "features": [
    "create:session",
    "read:session",
    "create:content",
    "create:content:text_root",
    "create:content:text_child",
    "update:content",
    "update:user"
  ],
  "tabcoins": 0,
  "tabcash": 0,
  "cacheTime": 1677696131217
}
```

>> Coment√°rio de pab-h:
Ao analisar um console, um error √© constantemente logado nele.

Vejam:
![Error console](https://user-images.githubusercontent.com/74771892/232167854-e54d9d97-880d-4b7f-b770-cc8cfe8a87f6.png)

Sobre a requisi√ß√£o,

### GET | https://www.tabnews.com.br/api/v1/user
Response Headers
```
HTTP/2 403 Forbidden
date: Fri, 14 Apr 2023 22:56:42 GMT
content-type: application/json; charset=utf-8
access-control-allow-credentials: true
access-control-allow-headers: X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version
access-control-allow-methods: GET,OPTIONS,PATCH,DELETE,POST,PUT
access-control-allow-origin: *
age: 0
cache-control: public, max-age=0, must-revalidate
etag: W/"ckk7dxau89k"
permissions-policy: camera=(), microphone=(), geolocation=()
referrer-policy: origin-when-cross-origin
strict-transport-security: max-age=63072000; includeSubDomains; preload
x-content-type-options: nosniff
x-dns-prefetch-control: on
x-frame-options: SAMEORIGIN
x-matched-path: /api/v1/user
x-vercel-cache: MISS
x-vercel-id: gru1::gru1::xgtrf-1681513002023-e015c2662db1
x-xss-protection: 1; mode=block
cf-cache-status: DYNAMIC
report-to: {"endpoints":[{"url":"https:\/\/a.nel.cloudflare.com\/report\/v3?s=vo7v4%2FK%2F9lUFqe7Fh7zsEnhFjB5gu3cTRcvjE89lIKHe%2FZRGe2a%2FGVAS9vtK4O0WC7XaY88X2C%2BpH2GprDM%2F2hQrv8bprZpMyIU8tuWkJMPDAKycxeWO9vTlkghy6QJrEGgwLHDAjjou6xxMJHAOLg%3D%3D"}],"group":"cf-nel","max_age":604800}
nel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}
server: cloudflare
cf-ray: 7b7f8b25df6615bd-FOR
content-encoding: br
X-Firefox-Spdy: h2
```

Request Headers
```
GET /api/v1/user HTTP/2
Host: www.tabnews.com.br
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/112.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://www.tabnews.com.br/publicar
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
```

>> Coment√°rio de aprendendofelipe:
> Ao analisar um console, um error √© constantemente logado nele.

Opa @pab-h, muito obrigado pela ajuda! üí™

O problema √© justamente esse erro. E √© problema no `useUser` mesmo. J√° vou subir uma corre√ß√£o üëç

>> Coment√°rio de aprendendofelipe:
Pronto @pab-h e @RomildoRocha, voc√™s s√≥ v√£o precisar fazer login novamente. üòâ

Muito obrigado por reportar o problema e por ajudar na investiga√ß√£o! ü§ó
</issue_1369_Problema ao criar uma publica√ß√£o>

<issue_1370_Mostrar quantidade de votos positivos e negativos, em vez de apenas o total>
Hoje o site mostra apenas a pontua√ß√£o total de um post. O problema √© que assim n√£o temos uma perspectiva exata de como cada publica√ß√£o foi recebida pela comunidade.

Por exemplo, um post que n√£o recebeu nenhum voto tem pontua√ß√£o 1 (pois todos come√ßam com 1). Mas um post que recebeu 10 positivos e 10 negativos tamb√©m ter√° pontua√ß√£o 1. Apesar do total ser o mesmo, a recep√ß√£o que eles tiveram foi bem diferente.

Conforme apontei [aqui](https://www.tabnews.com.br/kht/f5d8e312-317c-42e8-b805-6efac1824cff), quem est√° vendo somente o total n√£o tem a real percep√ß√£o de como a publica√ß√£o foi recebida.

Por exemplo, um post que n√£o recebeu nenhum voto (ou teve poucos) indica que n√£o houve tanto interesse no seu conte√∫do. J√° outro que est√° +30/-28 indica que n√£o s√≥ houve muito interesse, como o conte√∫do ainda foi controverso, e passa de maneira mais assertiva a percep√ß√£o que a comunidade teve sobre o assunto.

O que acham ent√£o de mostrar o total de positivos e negativos, em vez da pontua√ß√£o final?

>> Coment√°rio de Rafatcb:
Estava fazendo alguns testes sobre como mostrar essa informa√ß√£o, aqui est√£o alguns exemplos que fiz:

## Votos abaixo do total, separados em `+1 | -1`

A primeira forma que pensei foi em colocar `+ 1 | -1` embaixo do total de TabCoins na publica√ß√£o. O problema disso √© que acaba causando um desalinhamento em rela√ß√£o aos outros conte√∫dos:

![Exemplo com +197|-12, +19|-0 e +0|-0](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/2ccb1b05-21f4-4ed5-985d-10468c370a45)

E pode acabar tomando muito espa√ßo horizontal, deixando o conte√∫do estreito em dispositivos com telas pequenas. O exemplo abaixo √© numa largura de 345px:

| Atualmente | Com votos positivos e negativos |
| --- | --- |
| ![Conte√∫do atualmente](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/262c9af1-25ab-4e54-a7b8-1aafa9cf417b) | ![Conte√∫do mostrando votos positivos e negativos](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/624b9fd2-2071-4b64-83d6-5b717db0914c) |

### `+1 | -1` ocultando caso n√£o haja votos

Ainda podemos optar por ocultar os votos, caso sejam zero,mas acho que fica mais estranho. Abaixo temos um exemplo de `+20 | -0`:

![Total "20" e exibi√ß√£o dos votos "+20" ficam desalinhados, j√° que est√£o centralizados e isso √© pouco percept√≠vel](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/d4bc9891-067f-497b-9813-aa70f36b2f87)

Um exemplo de `+0 | -0`:

![Sem mostrar votos positivos nem negativos, apenas o total](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/6d0ecfea-0723-481c-85a2-fb0e7d2c0b7f)

## Votos abaixo do total, em formato de fra√ß√£o

Isso resolve o desalinhamento que ocorria na sugest√£o anterior:

![O mesmo exemplo que o primeiro para a sugest√£o anterior, mas sem a coluna de votos ocupar mais espa√ßo horizontal](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/ce54703b-a8ce-40a9-8079-16b630d2ad64)


E para comparar em uma tela de largura 345px:

| Atualmente | Com votos positivos e negativos |
| --- | --- |
| ![Conte√∫do atualmente](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/262c9af1-25ab-4e54-a7b8-1aafa9cf417b) | ![Conte√∫do mostrando votos positivos e negativos](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/08fc81bb-4ac5-4f2e-9418-14b6fc508f99) |

No caso de um conte√∫do curto, ~acaba adicionando um espa√ßamento vertical:~ Edit: me enganei,  n√£o adiciona espa√ßamento vertical, mas fica desproporcional porque tem bem mais informa√ß√£o do lado dos  votos do que no conte√∫do. Entendo que essa situa√ß√£o √© uma exce√ß√£o (um conte√∫do de pouqu√≠ssimas palavras), mas precisamos ver como a interface se comporta nas diferentes situa√ß√µes.

| Atualmente | Exibindo votos |
| --- | --- |
| ![Conte√∫do atualmente](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/726910d2-8dec-4e17-a2df-c12c57599618) | ![Conte√∫do mostrando votos positivos e negativos](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/a35344e5-1355-47cc-b8cd-d6822b137101) |

Me parece que essa op√ß√£o, mostrando em formato de fra√ß√£o, fica √≥tima no conte√∫do principal, que costuma ocupar um pouco mais espa√ßo na tela por ter o t√≠tulo. Em coment√°rios curtos ou sem votos, parece um pouco estranho.

Voc√™s tem alguma outra sugest√£o?

E outro ponto, isso ser√° mostrado na lista de conte√∫dos? Ficaria bastante informa√ß√£o numa tela pequena. Hoje, sem exibir essa informa√ß√£o, est√° assim (na tela de 345px):

![Lista com 4 conte√∫dos, alguns nomes de autores ficam cortados](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/ca82df0e-1da2-47b6-806f-c306e2de2c59)

>> Coment√°rio de ErickCReis:
@Rafatcb tenho uma sugest√£o de layout:

https://github.com/filipedeschamps/tabnews.com.br/assets/30873873/967fb973-c145-49ed-b1ff-7b3e307cfbb0

Assim o usu√°rio pode escolher como ele quer ver a informa√ß√£o, inclusive podemos salvar essa configura√ß√£o no local storage.

---

> E outro ponto, isso ser√° mostrado na lista de conte√∫dos?

Acho que essa informa√ß√£o n√£o precisa estar na listagem de conte√∫dos, al√©m da falta de espa√ßo acho que o soma j√° consegue mostrar a relev√¢ncia do conte√∫do.

>> Coment√°rio de filipedeschamps:
Turma, caindo de paraquedas nessa thread: e se fizer a request sob demanda? Continuando com o exemplo do @ErickCReis fazer uma request para um endpoint espec√≠fico apenas quando o usu√°rio passar o mouse em cima ou clicar no n√∫mero de TabCoins da publica√ß√£o. Poderia aparecer num hover, por exemplo. O Reddit faz assim ao passar o mouse (apesar de que eu acho que ele j√° traz a informa√ß√£o sem uma request adicional):

<img width="177" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/52258e82-8c45-448d-9b49-f75e3b224310">

>> Coment√°rio de aprendendofelipe:
De todas as sugest√µes, a que gostei mais foi a do Tooltip com a porcentagem. At√© porque ela ajuda ao mostrar a porcentagem real de votos positivos com rela√ß√£o ao total de votos, e √© um √≥timo complemento para o saldo.

Na porcentagem n√£o faz sentido considerar o TabCoin inicial da publica√ß√£o, ent√£o entraria somente os votos reais. Uma publica√ß√£o com 1 TabCoin poderia ter 0% de positivos, o que deixa claro que ali √© o TabCoin inicial. J√° se ela estivesse com 100% de positivos, daria pra saber que come√ßou com 0 TabCoins e ganhou um voto positivo.

J√° ao mostrar os valores separados, para maior precis√£o da informa√ß√£o, teria que mostrar o valor inicial (0 ou 1), os positivos e os negativos, ent√£o ficaria muito confuso com essas 4 informa√ß√µes (contando o saldo).

Sobre requisitar sob demanda, eu acho que seria pior do que j√° deixar os dados dispon√≠veis para usar no Tooltip.

>> Coment√°rio de Rafatcb:
Eu tendo a n√£o gostar de precisarmos de uma tooltip ou clique porque isso faz com que o usu√°rio precise descobrir que essa funcionalidade existe. Al√©m disso, nessa situa√ß√£o em espec√≠fico, a pessoa pode acabar votando na publica√ß√£o enquanto tenta ver a informa√ß√£o pelo celular (dedo grande, √°rea de intera√ß√£o relativamente pequena).

Porcentagem √© algo legal, me lembrou da Steam ([exemplo aqui](https://store.steampowered.com/app/271590/Grand_Theft_Auto_V/)), onde mostram uma classifica√ß√£o em texto (an√°lises "muito positivas", por exemplo), e tamb√©m em percentual se voc√™ fizer o hover:

![Texto: "very positive", hove: "91% of the 27.290 user reviews in the last 30 days are positive."](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/273f22c3-33d0-477d-a4b5-cadfafc00daa)

Apenas para refer√™ncia, a rede Stack Exchange realiza uma requisi√ß√£o ao clicar nos votos para exibir os _ups_ e _downs_. O Reddit eu nem sabia que tinha essa funcionalidade, mas n√£o faz uma nova requisi√ß√£o no hover.


Edit: Se for mostrar o percentual, ser√° necess√°rio mostrar tamb√©m o total de votos, sen√£o continuaremos com o mesmo problema descrito no issue.

>> Coment√°rio de Rafatcb:
Fiz uma altera√ß√£o utilizando a Tooltip, mostrando a porcentagem de votos positivos, bem como a quantidade de votos positivos e a quantidade total de votos. Ficou bem sucinto. Escolhi escrever desse jeito `1 voto positivo (33% de 3 votos)` para n√£o acabar ficando algo estranho em determinadas situa√ß√µes, como `10% de 10 votos foram positivos`, sendo que 10% de 10 votos √© 1 voto. Pensei bastante e n√£o consegui algo melhor.

Realmente n√£o √© uma funcionalidade boa no celular, eu votei errado algumas vezes nos testes que fiz. Para usar no celular de uma forma "segura", seria necess√°rio dar zoom na p√°gina.

O exemplo abaixo foi gravado no computador, apenas para voc√™s terem no√ß√£o de como fica a visualiza√ß√£o conforme os votos.

[Exemplo votando em conte√∫dos que j√° come√ßaram com ou sem TabCoins](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/213a9076-a8be-494d-b720-07292df6c7eb)

>> Coment√°rio de aprendendofelipe:
Acho que s√≥ precisa da porcentagem de votos positivos, o resto √© informa√ß√£o redundante.

`0% achou relevante`, `33% achou relevante`, `100% achou relevante`

>> Coment√°rio de Rafatcb:
> Acho que s√≥ precisa da porcentagem de votos positivos, o resto √© informa√ß√£o redundante.

Mas continuar√≠amos com o problema que deu origem √† esse issue:

> Por exemplo, um post que n√£o recebeu nenhum voto tem pontua√ß√£o 1 (pois todos come√ßam com 1). Mas um post que recebeu 10 positivos e 10 negativos tamb√©m ter√° pontua√ß√£o 1. Apesar do total ser o mesmo, a recep√ß√£o que eles tiveram foi bem diferente.

No exemplo, 10 positivos e 10 negativos seria `50% achou relevante`.

>> Coment√°rio de filipedeschamps:
Concordo com o @Rafatcb e s√≥ ter a porcentagem n√£o mostra a liquidez (quantidade) de votos, dado que o saldo esconde isso e a porcentagem tamb√©m n√£o revela quantidade.

Sobre o texto `1 voto positivo (33% de 3 votos)` eu senti um atrito em ler. Na minha opini√£o ficaria um fluxo mais simples ler algo como:

`+10 votos positivo | -10 votos negativos (%50 relevante)`

Pensando aqui, a porcentagem de relev√¢ncia perde o sentido quando s√£o poucos votos. Talvez essa porcentagem na verdade n√£o esteja mostrando a relev√¢ncia, mas sim a "concord√¢ncia"?

>> Coment√°rio de Rafatcb:
> Talvez essa porcentagem na verdade n√£o esteja mostrando a relev√¢ncia, mas sim a "concord√¢ncia"?

Acho que esse √© um debate mais profundo sobre como as pessoas votam. Idealmente representa o quanto as pessoas acharam algo relevante, mas colocar `50% relevante` n√£o faz sentido, porque isso n√£o tem um significado (o que √© algo 50% relevante?). O texto do @aprendendofelipe faz mais sentido porque atende esse ponto, refletindo o motivo das pessoas terem votado.

Juntando as sugest√µes que voc√™s dois deram, ficaria `+10 votos positivos | -10 votos negativos (50% achou relevante)`. Acho que assim fica bem repetitivo. Talvez `+10 | -10 (50% achou relevante)` fique melhor. Est√° impl√≠cito que o `+10 | -10` s√£o votos porque a pessoa est√° interagindo com a contagem de votos, mas tamb√©m pode acontecer dela n√£o saber que s√£o votos (o caso de um usu√°rio novo, por exemplo).

Se formos refletir mais a fundo, o texto sobre o percentual desta forma (`50% achou relevante`) pode dar a entender que metade das pessoas acharam o conte√∫do relevante, mas na verdade foi metade dos votos (podem ter sido mais ou menos pessoas).

Como refer√™ncia, o texto do Stack Overflow √© `Esta pergunta recebeu X votos positivos e Y votos negativos.`

![Votos no Stack Overflow](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/e7e2fbb2-91b1-4736-aed6-79855400ab19)

N√£o sei se estamos evitando os termos de "votos positivos e negativos". Estou sem mais sugest√µes para dar agora.

>> Coment√°rio de aprendendofelipe:
> mas colocar `50% relevante` n√£o faz sentido

Tamb√©m acho que assim n√£o fica legal, pois gera interpreta√ß√µes equivocadas.

> Talvez `+10 | -10 (50% achou relevante)` fique melhor.

√â uma boa op√ß√£o, e se o restante do PR #1607 ficar pronto sem termos outras sugest√µes, acho que podemos seguir assim e qualquer coisa mudamos depois de acordo com os feedbacks.
</issue_1370_Mostrar quantidade de votos positivos e negativos, em vez de apenas o total>

<issue_1371_[Feature] Integra√ß√£o com Redes Sociais>
![2023, 12_28_01 GMT-3](https://user-images.githubusercontent.com/74481921/232093238-94366f7d-6ad6-4345-b05b-736452e28a3a.png)

Para melhorar o Tabnews, acho √∫til permitir que os usu√°rios adicionem links de suas contas do Twitter, Github ou outras redes sociais ao f√≥rum. 

A proposta √© adicionar bot√µes semelhantes aos do GitHub quando se clica em editar perfil, onde seria poss√≠vel adicionar links de redes sociais, como LinkedIn e Twitter. 

No come√ßo, seria poss√≠vel adicionar apenas essas duas redes, verificando a URL para n√£o permitir que sejam adicionados links diferentes. Isso pode ser feito com uma interface simples e intuitiva, conforme mostrado na imagem anexa, seguindo os padr√µes do Primer. 

Os usu√°rios poderiam clicar no link da rede social e serem redirecionados para a p√°gina correspondente. Se houver engajamento na issue, posso melhorar a interface posteriormente.

Os links poderiam ficar na p√°gina de perfil. Exemplo

![2023, 12_53_59 GMT-3](https://user-images.githubusercontent.com/74481921/232096477-b2edbec7-3189-428e-a432-e343abb86dbe.png)

>> Coment√°rio de filipedeschamps:
Esta √© uma melhoria que precisa vir, inclusive possibilitar a pessoa colocar um `README` assim como no GitHub, para ela poder desenvolver o que quiser sobre o seu perfil, principalmente sobre coisas que possam trazer **retorno concreto** para ela ü§ù

>> Coment√°rio de aprendendofelipe:
@fabriciolak, obrigado pela sugest√£o! üí™

Acredito que tudo que foi proposto aqui pode ser feito com a descri√ß√£o no perfil dos usu√°rios que foi implementada no PR #1470, pois est√° aceitando markdown.

Caso queira complementar o que foi implementado, √© melhor centralizar a conversa na issue onde a discuss√£o avan√ßou mais (#1466). Ent√£o vou fechar essa. Combinado? ü§ù
</issue_1371_[Feature] Integra√ß√£o com Redes Sociais>

<issue_1373_[SUGEST√ÉO] Adicionar sistema de pesquisa e classifica√ß√£o de conte√∫dos por t√≥picos>
### Descri√ß√£o
Atualmente, o site n√£o possui um sistema de pesquisas sobre t√≥picos e assuntos de interesse do usuario, o que limita a intera√ß√£o com a plataforma. Para melhorar a experi√™ncia do usu√°rio,  a implementa√ß√£o de um sistema de busca por texto (e / ou) t√≥picos para discuss√µes solucionaria.

O sistema de topicos poderia auxiliar na coleta de prefer√™ncias do usu√°rio e facilitaria a busca por conte√∫dos relevantes.

### Possivel solu√ß√£o
Implementar um mecanismo de busca (e / ou) categorizar os conteudos por topicos. segue um breve rascunho da ideia no [figma](https://www.figma.com/file/URdhqPvgnAeozaarNM5qYo/tabnews?node-id=0%3A1&t=xCEMDsxaASHvRHB4-1).

>> Coment√°rio de hkotsubo:
Em vez de ter v√°rias abas, acho que uma solu√ß√£o mais gen√©rica seria poder colocar tags nos posts. E a√≠ vc pode ter um sistema de busca no qual as tags s√£o um dos muitos crit√©rios poss√≠veis. E em seguida, vc poderia salvar seus pr√≥prios filtros personalizados.

Por exemplo, fa√ßo uma busca por tags A e B, contendo a palavra "abc", e salvo isso em "Meus Filtros". Isso poderia inclusive estar em uma aba pr√≥pria (a√≠ acho que faz sentido ter uma aba exclusiva), ou ent√£o uma aba fixa por filtro (com algum limite razo√°vel para n√£o poluir demais a interface).

Assim cada um pode escolher t√≥picos do seu interesse, em vez de ter v√°rias abas que n√£o necessariamente v√£o ter o que eu quero.

>> Coment√°rio de Henrique-Gomes:
Inclusive, seria interessante ter √°reas separadas. Existem assuntos diferentes demais na programa√ß√£o para tudo ficar junto e misturado no mesmo espa√ßo.

>> Coment√°rio de interaminense:
Um exemplo interessante eh o https://dev.to/ onde vc insere as tags de forma facil no proprio readme que voce ta criando o post.

>> Coment√°rio de aprendendofelipe:
@franklinST-05, obrigado pela sugest√£o! üí™

Vou fechar essa por ser duplicada, e recomendo centralizar a discuss√£o nas issues relacionadas abaixo:

- #742 
- #927 

Cominado? ü§ù
</issue_1373_[SUGEST√ÉO] Adicionar sistema de pesquisa e classifica√ß√£o de conte√∫dos por t√≥picos>

<issue_1375_Renovar a sess√£o do usu√°rio apenas ao acessar o endpoint `/user`>
## Contexto

Atualmente a sess√£o do usu√°rio √© renovada em todas as requisi√ß√µes que verificam a autentica√ß√£o. Isso implica em um n√∫mero excessivo de renova√ß√µes de sess√£o, impactando de forma desnecess√°ria o banco de dados, tanto em processamento, como em volume de dados armazenados.

Isso tamb√©m injeta o cookie de sess√£o na resposta de diferentes endpoints, o que nos deixa sempre com uma preocupa√ß√£o extra ao lidar com cache.

## Execu√ß√£o

Provavelmente basta modificar essa chamada para ocorrer apenas nos acessos ao endpoint `/users`:

https://github.com/filipedeschamps/tabnews.com.br/blob/f5c0078b9204b6b3e49df1ed293679870b287a96/models/authentication.js#L51

Esse j√° o endpoint autenticado mais acessado e onde faz mais sentido revalidar a sess√£o. Mas algo para pensarmos √© se n√£o podemos diminuir ainda mais a quantidade de renova√ß√µes. Como a expira√ß√£o da sess√£o ocorre em 30 dias, ser√° que n√£o √© v√°lido fazer essa revalida√ß√£o apenas se faltarem menos de 29 dias para expirar (ou 20)? Com isso a renova√ß√£o vai ocorrer no m√°ximo uma vez ao dia por cada dispositivo do usu√°rio. Se essa ideia for v√°lida, basta conferir o `sessionObject.expires_at` para decidir se chama o `session.renew`.

>> Coment√°rio de aprendendofelipe:
Implementado em #1395
</issue_1375_Renovar a sess√£o do usu√°rio apenas ao acessar o endpoint `/user`>

<issue_1376_Adequar a p√°gina de conte√∫dos e o componente `Content` para lidar melhor com altera√ß√µes nos dados>
## Contexto

A p√°gina de conte√∫dos precisa lidar melhor com seus estados quando ocorre uma revalida√ß√£o em segundo plano da p√°gina atual momentos ap√≥s uma altera√ß√£o feita pelo pr√≥prio usu√°rio nessa p√°gina (cria√ß√£o, edi√ß√£o ou exclus√£o de conte√∫dos ou coment√°rios).

Todos os problemas se aplicam apenas a conte√∫dos ou coment√°rios do pr√≥prio usu√°rio (ou modificadas por moderadores). A interface j√° se comporta adequadamente com modifica√ß√µes vindas apenas pela revalida√ß√£o, e sem mudan√ßas locais.

Exemplos de inconsist√™ncias que podem ocorrer:

1. Edi√ß√£o do conte√∫do pelo usu√°rio e uma revalida√ß√£o logo em seguida que venha com os dados ainda antigos. Nesse caso vai parecer que a altera√ß√£o n√£o ocorreu, mesmo estando corretamente salva no banco de dados.
2. Cria√ß√£o de um novo coment√°rio e, em sequ√™ncia, a revalida√ß√£o dos dados que j√° venha com esse novo coment√°rio. Nesse caso esse novo coment√°rio ser√° renderizado duas vezes, pois o primeiro foi renderizado dentro do `Content` que inicialmente estava em modo compacto e n√£o est√° presente na √°rvore de coment√°rios, ent√£o n√£o ter√° seu estado atualizado.

Provavelmente outros casos de inconsist√™ncias devem ocorrer enquanto mantivermos estados dentro do component `Content` que n√£o s√£o atualizados quando vierem novos dados no backend.

## Execu√ß√£o

Uma possibilidade √© n√£o manter estados de altera√ß√µes de conte√∫dos dentro do pr√≥prio componente `Content`, e centralizar isso no componente superior, onde pode ser verificado quais dados s√£o mais recentes (entre os locais e os revalidados).

Manter os estados em n√≠vel superior tamb√©m permite n√£o mais renderizar novos coment√°rios dentro do que inicialmente era o componente `Content` em modo compacto (o bot√£o de responder). Mas sim adicionar eles na √°rvore de coment√°rios para ser renderizado como os demais.

Um problema menor, mas que talvez possa ser resolvido junto, √© a perman√™ncia dos bot√µes de qualificar e de responder mesmo ap√≥s excluir um conte√∫do ou coment√°rio. Mas nesses casos os bot√µes s√≥ permanecem enquanto os dados n√£o forem revalidados em segundo plano, momento em que eles somem da tela (ou surge a p√°gina 404 se for o conte√∫dos principal da p√°gina). Mas dependendo da solu√ß√£o adotada para essa issue, ficar√° resolvido tamb√©m esse caso.

[Edit] Poderemos habilitar o `revalidateOnFocus` nas p√°ginas de conte√∫dos ap√≥s a resolu√ß√£o dessa issue.
</issue_1376_Adequar a p√°gina de conte√∫dos e o componente `Content` para lidar melhor com altera√ß√µes nos dados>

<issue_1378_[feat] Inser√ß√£o de toasts>
Notei que ao salvar minhas informa√ßo·∫Ωs na rota /perfil, nenhuma resposta √© retornada ao usuario para confirmar que tudo ocorreu como deveria. 

Minha sugest√£o seria inserir toasts personalizados para dar essa resposta visual ao usuario que a a√ß√£o foi conclu√≠da, ou n√£o.
Exemplo de biblioteca que gosto de usar √© a "react-hot-toasts", simples de usar e de aplicar e totalmente customizavel.

Link da lib.: https://react-hot-toast.com/

>> Coment√°rio de B-Schmitz:
Uso react hot toast no meu portf√≥lio, outra lib legal √© o sweetalert2, mas √© para criar prompts tamb√©m.
Uma outra ideia √© criar nosso pr√≥prio componente toast e criar um contexto para uso global na aplica√ß√£o

>> Coment√°rio de danielschmitz:
Talvez o uso do toast quebre a identidade visual do site (se √© que tem rs). 

Mas no caso do save do profile, realmente √© necess√°rio uma informa√ß√£o que tudo correu OK. No [c√≥digo](https://github.com/filipedeschamps/tabnews.com.br/blob/main/pages/perfil/index.public.js) existe um objeto chamado `globalErrorMessage ` usado em conjunto com `<Flash>`.  Seria interessante criar um `globalSuccessMessage` usando o mesmo `<Flash>` e desta forma adicionar mensagens de "deu tudo certo" em algumas partes do TabNews. 

Eu at√© faria isso, mas preciso de um "Ok" do @filipedeschamps e sua equipe, pois n√£o sei se eles tem um outro pensamento sobre esse tema (talvez eles queiram usar toast kkk).

>> Coment√°rio de avulso17:
A parte boa do react-hot-toast @danielschmitz, igual comentei acima, √© totalmente customizavel, sendo assim da pra encaixa-lo na identidade visual do app.

Criei essa issue justamente para discutirmos qual seria a melhor op√ß√£o para resolvermos esse "problema" e fiz minha sugest√£o sobre react-hot-toast. Se ja temos um component que faz isso (<Flash/>), nao vejo o porque adicionar mais um lib para toasts.

E como tu disse, nao sabemos o que a equipe planeja mas de qualquer forma, estou disposto a ajudar! hehe

>> Coment√°rio de Rafatcb:
Levando em considera√ß√£o que o problema era o feedback ao atualizar o perfil, foi implementado aqui: https://github.com/filipedeschamps/tabnews.com.br/pull/1548. N√£o estamos usando toasts, mas foi solucionado.

Podemos fechar esse issue?

>> Coment√°rio de aprendendofelipe:
Acredito que podemos encerrar üëç

Obrigado aos que contribu√≠ram! ü§ù
</issue_1378_[feat] Inser√ß√£o de toasts>

<issue_1380_Adicionar um FAQ ao site>
Atualmente o site n√£o tem um FAQ, e acho que seria √∫til, pelo menos para explicar o funcionamento b√°sico de algumas coisas. Tem a p√°gina "[Sobre](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa)", √© verdade, mas ela s√≥ d√° uma ideia geral do site. Acho que falta um lugar que explique certas coisas de maneira mais detalhada, como por exemplo:

- **Como buscar conte√∫dos no site?** Enquanto n√£o tem uma barra de busca, um FAQ evitaria (ou diminuiria) a cria√ß√£o de t√≥picos como [esses](https://www.tabnews.com.br/kht/2b2a6e2d-6d3a-4d5f-bf90-28803e98e1c4)
- **Pontua√ß√£o**: at√© existem posts sobre o funcionamento antigo, mas depois que [esta mudan√ßa foi feita](https://github.com/filipedeschamps/tabnews.com.br/pull/1366), n√£o vi em nenhum lugar do site uma descri√ß√£o clara do funcionamento dos TabCoins e TabCash
- **Que tipo de conte√∫do pode postar**: minha impress√£o √© que pode ser "qualquer coisa" minimamente relacionada a tecnologia, mas ainda sim, uma descri√ß√£o mais detalhada seria bem √∫til, sen√£o [cada um posta o que quer e o site acaba n√£o focando em nada](https://www.tabnews.com.br/kht/e868ec52-4780-4c51-be4e-68c3a949bb60)
- etc

>> Coment√°rio de aprendendofelipe:
Ol√° @hkotsubo, com certeza a milestone do revenue share n√£o poder√° ser conclu√≠da sem o FAQ estar pronto. Mas nada impede que j√° seja criada uma vers√£o na milestone atual. üí™

Sobre a mec√¢nica dos TabCoins, ainda vir√£o mais mudan√ßas na milestone atual, mas como vi sua pergunta dentro do TabNews, eu j√° estava escrevendo uma resposta, ent√£o criei [uma issue](https://github.com/filipedeschamps/tabnews.com.br/issues/1381) para manter a descri√ß√£o do que est√° valendo atualmente. üëç

A cria√ß√£o das regras para uso de TabCash ser√° o objetivo principal da pr√≥xima milestone. üöÄ

Sobre limitar o que pode ser postado, eu acho complicado restringir. E o ideal √© que a mec√¢nica de qualifica√ß√µes do sistema cuide disso. Ent√£o os ajustes v√£o ocorrer sempre que necess√°rio para levar o Equil√≠brio de Nash cada vez mais perto do ideal.

>> Coment√°rio de hkotsubo:
@aprendendofelipe  Quanto aos limites, √© s√≥ pra ter uma regra clara. Um exemplo (bem exagerado de prop√≥sito): se algu√©m postar uma receita de arroz com frango (sem qualquer rela√ß√£o com tecnologia), estar√° fora das regras, acredito eu, e a pessoa poder√° ser advertida.

Tendo a regra escrita no FAQ, d√° mais subs√≠dio pra gente poder afirmar que esse tipo de coisa n√£o pode. Se n√£o est√° escrito em nenhum lugar, sempre abrir√° margem para discuss√£o (talvez n√£o no meu exemplo, mas enfim, podem ter casos em uma √°rea cinzenta, e ter as regras ajuda a dar um norte).

>> Coment√°rio de aprendendofelipe:
Show @hkotsubo, voc√™ j√° tem algo em mente para iniciar uma issue sobre que tipo de conte√∫do pode postar no TabNews?

Acho que uma issue espec√≠fica pode atrair mais gente querendo contribuir ou acompanhar esse assunto.

>> Coment√°rio de hkotsubo:
> voc√™ j√° tem algo em mente para iniciar uma issue sobre que tipo de conte√∫do pode postar no TabNews?

@aprendendofelipe Minha ideia era partir de alguma discuss√£o j√° existente (at√© pra ter mais embasamento), mas em uma busca r√°pida pelo site n√£o encontrei.

O m√°ximo que tem s√£o as p√°ginas "Sobre" e "Termos de Uso", mas elas s√≥ mencionam "*conte√∫do de valor concreto para quem trabalha com programa√ß√£o e tecnologia*". √â  meio vago e bem subjetivo, mas enfim, √© o ponto de partida que temos.

Enfim, amanh√£ penso nisso com mais calma. Mas se quiser j√° ir abrindo a issue, fique √† vontade :-)

---

Lembrando que os assuntos listados acima s√£o apenas sugest√µes de itens do FAQ. Mas nada impede que o FAQ seja criado com outros itens, que vcs achem mais pertinentes.

>> Coment√°rio de hkotsubo:
Bom, outra sugest√£o de item pro FAQ: "Posso postar o mesmo conte√∫do v√°rias vezes?" (resposta: "N√£o").

Inspirado [nesta discuss√£o](https://www.tabnews.com.br/kamikaze142857/23c0bf54-738b-472d-9d38-e72af6850b86).

>> Coment√°rio de ygcristopher:
**_Seria bem interessante mesmo, implementar um FAQ._**

>> Coment√°rio de Rafatcb:
Vale mencionar tem um PR de FAQ que estava em andamento antes do surgimento dessa issue: https://github.com/filipedeschamps/tabnews.com.br/pull/1210. J√° tem algumas informa√ß√µes l√° e talvez o PR possa ser aproveitado para a cria√ß√£o do FAQ completo.

>> Coment√°rio de Rafatcb:
Um PR atualizado sobre o FAQ acaba de ser aberto: https://github.com/filipedeschamps/tabnews.com.br/pull/1581

D√™em uma olhada e vejam se as perguntas foram bem respondidas e se existe algo faltando. Nada impede uma atualiza√ß√£o do FAQ em outro PR, se necess√°rio, mas aproveitem agora para avaliar.

>> Coment√°rio de Rafatcb:
Pessoal, o PR #1581 foi mergeado mas resolvi n√£o fechar esse issue por alguns motivos discutidos l√°. Temos algumas melhorias pendentes:

1. Renomear a pergunta `Por que o TabNews foi criado?` para `Qual √© o prop√≥sito do TabNews?` ([refer√™ncia](https://github.com/filipedeschamps/tabnews.com.br/pull/1581#discussion_r1449755132)). N√£o precisa mudar o `id` nem a resposta.
2. Eventualmente, publica√ß√µes ser√£o criadas no TabNews por mim ou pelo @aprendendofelipe para complementar o FAQ. A primeira pergunta ser√° para responder _"O que √© o TabNews?"_. Com o debate, um PR deve ser aberto para criar essa pergunta e a resposta, e j√° atualizar o ponto `1` dessa lista no mesmo PR.
3. Possivelmente, uma publica√ß√£o ser√° criada para melhorar a resposta [Que tipo de assunto √© aceito no TabNews?](https://www.tabnews.com.br/faq#assunto-tabnews). [Refer√™ncia](https://github.com/filipedeschamps/tabnews.com.br/pull/1581#discussion_r1448084330).
4. Possivelmente, outra publica√ß√£o ser√° criada para falar sobre "qualidade" no FAQ e poder orientar o comportamento para votos (o que estimular e o que desestimular).

Foi discutido que a melhor forma de criar as publica√ß√µes de melhoria seriam com uma pergunta por vez, para concentrar a discuss√£o com um foco espec√≠fico. Pensei tamb√©m em mencionar que outras melhorias para o FAQ devem ser sugeridas neste issue, para n√£o gerar discuss√µes paralelas na publica√ß√£o.

Se voc√™ sentiu falta de alguma pergunta/resposta ou achou que alguma resposta poderia ser melhor, j√° pode deixar seu feedback aqui.

PS: As publica√ß√µes n√£o ser√£o criadas todas de uma vez para n√£o dividir a aten√ß√£o da comunidade, vamos resolver uma pergunta por vez.

>> Coment√°rio de Rafatcb:
Criei a [publica√ß√£o](https://www.tabnews.com.br/rafael/o-que-e-o-tabnews) para ouvir da comunidade a resposta para _O que √© o TabNews?_, mas teve feedback sobre o FAQ tamb√©m. Vou trazer o [coment√°rio do kht](https://www.tabnews.com.br/kht/9d77473a-a4f4-48c4-ac35-494a41dcfc09) para c√°:

> Tem dois trechos que podem dar margem a alguma confus√£o, pois pra mim eles parecem contradit√≥rios.
>
> Primeiro √© dito que posso publicar "*qualquer outro tipo de conte√∫do que poder√° fazer alguma diferen√ßa na vida de quem trabalha em √°reas diretamente ou indiretamente relacionadas √† √°rea de tecnologia*".
>
> E logo depois temos"*O conte√∫do publicado no TabNews deve estar diretamente relacionado √† tecnologia*".
>
> No meu entendimento, a primeira regra d√° a impress√£o de que posso falar de qualquer coisa. Usando um exemplo exagerado de prop√≥sito, eu poderia falar de culin√°ria ("olha essa receita super saud√°vel"), afinal devs tamb√©m precisam comer e uma boa alimenta√ß√£o faz "diferen√ßa na vida" de qualquer um, n√£o?
>
> Mas a segunda regra restringe isso, deixando bem claro que n√£o posso falar de culin√°ria, a menos que tenha uma rela√ß√£o clara com tecnologia (por exemplo, como fazer um site de receitas, etc).
>
> Talvez seja o caso de ajustar o texto da primeira, pois acho que "*qualquer outro tipo de conte√∫do que poder√° fazer alguma diferen√ßa na vida*" √© amplo demais. Tem que deixar claro que n√£o √© bem qualquer coisa, tem que estar de acordo com a segunda regra.

O trecho considerado abrangente est√° na pergunta [Que tipo de conte√∫do eu posso publicar no TabNews?](https://www.tabnews.com.br/faq#conteudo-tabnews). Concordo que ele pode dar uma abertura √† interpreta√ß√µes que n√£o desejamos, mas ainda n√£o pensei numa frase para substituir.

>> Coment√°rio de Rafatcb:
Atualizando:

Conforme as melhorias implementadas no PR #1605, o √∫ltimo ponto restante para considerar este issue como encerrado √© criar uma publica√ß√£o para falar sobre "qualidade" no FAQ e poder orientar o comportamento para votos (o que estimular e o que desestimular). N√£o sei se vamos conseguir definir algo mais objetivo para colocar no FAQ, mas vou criar a publica√ß√£o para ver se conseguimos algo.

Outras melhorias podem ser feitas no FAQ com o passar do tempo, mas o fechamento deste issue ser√° apenas para considerar que a necessidade de ter um FAQ foi atendida.

>> Coment√°rio de Rafatcb:
Acabei de criar o PR abordando o assunto da qualidade: https://github.com/filipedeschamps/tabnews.com.br/pull/1625

A publica√ß√£o que recebeu feedback no TabNews foi essa: [Complementando o FAQ - O que √© um conte√∫do de qualidade?](https://www.tabnews.com.br/rafael/complementando-o-faq-o-que-e-um-conteudo-de-qualidade)

Ap√≥s esse ponto ser definido no FAQ, vamo fechar esse issue como resolvido. Apesar disso, melhorias no FAQ continuar√£o sendo bem recebidas.
</issue_1380_Adicionar um FAQ ao site>

<issue_1381_Explica√ß√£o da Mec√¢nica Atual de TabCoins>
A mec√¢nica est√° em constante evolu√ß√£o. Vou tentar manter esse texto atualizado, mas tenha em mente que a fonte da verdade √© o c√≥digo da branch main.

N√£o sei se existe maneira de simplificar essa explica√ß√£o sem perder informa√ß√£o relevante, mas fiquem √† vontade para criar as suas vers√µes nos coment√°rios. Principalmente algo que possa ser melhorado no FAQ, que n√£o necessariamente precisa conter todos os detalhes explicados aqui.

√â melhor que n√£o sejam postadas nessa issue sugest√µes que modifiquem o as regras. Fa√ßam isso em issues espec√≠ficas, ou seja, nas que j√° foram abertas para discuss√£o do ponto espec√≠fico que quer alterar ou, caso a issue ainda n√£o exista, crie uma nova e fundamente a sua sugest√£o. Se vier com altera√ß√µes nas regras aqui nos coment√°rios saberemos que est√° sugerindo mudan√ßas sem ter lido as regras atuais üòÖ

## Defini√ß√µes

- **Coment√°rio**: Conte√∫do postado em resposta a outro conte√∫do. Resposta ou "conte√∫do filho" s√£o sin√¥nimos.
- **Conte√∫do**: Tudo o que √© postado no TabNews, seja conte√∫do "root" ou coment√°rio.
- **Conte√∫do root**: Conte√∫do que n√£o foi postado em resposta a outro conte√∫do.
- **Qualifica√ß√£o**: Ato de informar ao sistema se um conte√∫do √© "relevante" ou "n√£o relevante" na opini√£o do usu√°rio.
- **TabCash**: Moeda que futuramente ser√° utilizada para a revenue share.
- **TabCoins**: Para os usu√°rios √© a moeda necess√°ria para adquirir TabCash com a qualifica√ß√£o de conte√∫dos. Para os conte√∫dos √© um indicador de como est√£o as qualifica√ß√µes desse conte√∫do.

## TabCoins dos conte√∫dos

√â o indicador de como andam as qualifica√ß√µes dos conte√∫dos como "relevantes" ou "n√£o relevantes".

### Ganho de TabCoins

Existem duas maneiras do **conte√∫do** ganhar TabCoins:
* Se o conte√∫do se enquadrar, ele come√ßa com 1 TabCoin ao ser postado.
* Ao receber votos como "relevante" ele recebe mais 1 TabCoin por voto.

### Perda de TabCoins

Existem duas maneiras do **conte√∫do** perder TabCoins:
* Ao receber votos como "n√£o relevante" ele perde 1 TabCoins por voto.
* Situa√ß√µes que exijam atua√ß√£o da modera√ß√£o, por exemplo, no banimento de algu√©m que qualificou o conte√∫do positivamente.

## TabCoins dos usu√°rios

Os TabCoins dos usu√°rios servem para poder qualificar conte√∫dos e obter TabCash com isso.

### Ganho de TabCoins

Existem tr√™s maneiras do **usu√°rio** ganhar TabCoins:
* Ao postar conte√∫dos ele pode ganhar TabCoins. O ganho depende de fatores explicados mais abaixo.
* Ao ter seus conte√∫dos qualificados positivamente ele recebe 1 TabCoin por voto positivo.
* √â poss√≠vel ganhar TabCoins ao acessar o TabNews pelo menos uma vez no dia. Existe um algoritmo que leva em considera√ß√£o as qualifica√ß√µes dos conte√∫dos mais recentes e tamb√©m a quantidade de TabCoins que o usu√°rio possui. Quanto melhor avaliados forem os conte√∫dos e menos TabCoins o usu√°rio possuir, mais ele receber√° na recompensa di√°ria.

### Perda de TabCoins

Existem algumas maneiras do **usu√°rio** ter seus TabCoins consumidos:
* Ao ter seus conte√∫dos qualificados negativamente ele perde 1 Tabcoin por voto negativo.
* Ao adquirir TabCash atrav√©s da qualifica√ß√£o de conte√∫dos de outros usu√°rios s√£o consumidos 2 TabCoins.
* Ao excluir um conte√∫do o usu√°rio pode ter que devolver TabCoins nos casos explicados mais abaixo.
* Em situa√ß√µes que exijam atua√ß√£o da modera√ß√£o.

### TabCoins ganhos pelo usu√°rio ao publicar conte√∫dos

No exato momento de publica√ß√£o do conte√∫do ser√° computado qual √© o ganho inicial do usu√°rio para esse conte√∫do.
Usu√°rios respondendo a si mesmo n√£o ganham nada ao publicar.
Para os outros casos os ganhos dependem das qualifica√ß√µes de seus outros conte√∫dos postados recentemente.

Caso seja um usu√°rio novo, que ainda n√£o recebeu qualifica√ß√µes, ent√£o o usu√°rio n√£o ganha nada no ato de publicar, mas poder√° ganhar ou perder os TabCoins atrav√©s das qualifica√ß√µes desse conte√∫do.

O usu√°rio ficar√° impedido de publicar quando houverem muitos conte√∫dos com votos negativos. Para sair dessa condi√ß√£o bastar√° o usu√°rio excluir seus conte√∫dos avaliados negativamente. Essa regra n√£o bloqueia as respostas em conte√∫dos pr√≥prios, mas isso deve ser evitado, j√° que esses coment√°rios come√ßam zerados ao inv√©s de come√ßarem com 1 TabCoin.

### TabCoins consumidos na exclus√£o de um conte√∫do

Quando o usu√°rio excluir um conte√∫do, ser√° computado e debitado o saldo de TabCoins de acordo com o caso:

* Caso o conte√∫do esteja com saldo zerado ou negativo, ent√£o o usu√°rio devolve apenas o valor ganho ao publicar esse conte√∫do.
* Caso o conte√∫do esteja positivo, ent√£o o usu√°rio devolve todo saldo ganho com qualifica√ß√µes somado ao que ele ganhou no momento da publica√ß√£o desse conte√∫do.

Lembrando que o usu√°rio pode n√£o ter ganho nada ao publicar, ent√£o a devolu√ß√£o ser√° apenas dos ganhos com qualifica√ß√µes.

>> Coment√°rio de JuanFontes:
Ol√° @aprendendofelipe , gostaria de tirar uma d√∫vida. Especialmente sobre "autor". Isso se refere ao autor da postagem ou do comentarista? Ou os dois?
Digo isso pois nessa postagem eu ganhei 4 tabcoins https://www.tabnews.com.br/juanfontes/dce20375-6f02-442a-ba77-ff84bee03d2a por√©m acho que o comentarista (que n√£o era o autor) foi banido, com isso eu perdi todas elas. Isso est√° correto?

>> Coment√°rio de aprendendofelipe:
> Especialmente sobre "autor". Isso se refere ao autor da postagem ou do comentarista? Ou os dois?

Quando um usu√°rio √© banido, tamb√©m √© desfeito tudo que ele fez, incluindo publica√ß√µes (coment√°rios ou root) e os votos que ele deu. Quem ganhou ou perdeu tabcoins por votos de um usu√°rios banido, ter√° os saldos corrigidos.

J√° quem qualificou corretamente os conte√∫dos desse usu√°rio banido, deve ter feito de acordo com sua avalia√ß√£o, e j√° converteu seus tabcoins em tabcash normalmente, ent√£o isso n√£o √© desfeito.

> Digo isso pois nessa postagem eu ganhei 4 tabcoins https://www.tabnews.com.br/juanfontes/dce20375-6f02-442a-ba77-ff84bee03d2a por√©m acho que o comentarista (que n√£o era o autor) foi banido, com isso eu perdi todas elas. Isso est√° correto?

N√£o deve ter nenhuma rela√ß√£o, pois a √∫nica coisa que voc√™ poderia perder eram os votos recebidos desse usu√°rio banido, mas ele s√≥ pode dar 1 voto por conte√∫do a cada 72 horas.

No momento essa sua publica√ß√£o continua com 4 tabcoins, ou seja, voc√™ ganhou 3 tabcoins com ela. Tamb√©m ganhou 1 tabcoin em outra publica√ß√£o. J√° converteu 2 tabcoins em tabcash ao qualificar algum conte√∫do, restando 1 tabcash e 2 tabcoins de saldo. Parece tudo correto.

>> Coment√°rio de aprendendofelipe:
Turma, agora que temos o FAQ, vamos concentrar a atualiza√ß√£o da mec√¢nica de maneira geral por l√°, e a parte mais detalhada da mec√¢nica √© melhor consultar diretamente no c√≥digo.

Por isso vou fechar essa issue. ü§ù
</issue_1381_Explica√ß√£o da Mec√¢nica Atual de TabCoins>

<issue_1382_[feature] Possiblidade de ignorar usu√°rios>
tenho visto certos usu√°rios fazendo do tabnews uma plataforma de divulga√ß√£o de links, ou um copia e cola do chat gpt, coisas √≠nuteis como somar 1+1, aff

Gostaria de sugerir uma op√ß√£o para ignorar usu√°rios, de forma privada. Se eu ignoro um usu√°rio, nenhum artigo dele mais aparece para mim. Esse "ignore" seria privado. Somente eu sei meus ignores. E ningu√©m sabe se algu√©m o ignorou.

>> Coment√°rio de aprendendofelipe:
@danielschmitz, obrigado pela sugest√£o! üí™

Os conte√∫dos (e as listas de conte√∫dos) do TabNews s√£o exibidos em p√°ginas est√°ticas. Ainda n√£o existem p√°ginas personalizadas para cada usu√°rio, e, provavelmente, isso deve demorar para entrar no radar, tanto pela exig√™ncia de muito mais performance do back-end, quanto de reformula√ß√£o total do sistema.

>> Coment√°rio de Valkhan:
Isso auxiliaria ter um combate a spammers que est√£o usando das publica√ß√µes para ganhar tabcoins apenas para promover suas ideias de forma publicitaria criando um falso ideal de contribui√ß√£o na comunidade spammando conte√∫do irrelevante ou de baixa qualidade apenas para angariar tabcoins. 

Como moderar isso √© extremamente complexo, essa op√ß√£o de bloquear um usu√°rio de forma privada ja melhoraria a experi√™ncia de usu√°rio de quem realmente est√° ativo. 

Isso poderia expandir para que usu√°rios muito bloqueados e denunciados entrassem numa fila de modera√ß√£o priorit√°ria.
</issue_1382_[feature] Possiblidade de ignorar usu√°rios>

<issue_1383_Falha em dar um like em postagem root>
Acabei de dar um voto positivo aqui: https://www.tabnews.com.br/sucoDeMaracuja/se-voce-pensa-em-refazer-um-projeto-do-zero-voce-nao-amadureceu-o-suficiente

Foi descontado 2 pontos do meu saldo quando cliquei no voto, soltou os confetes do voto, mas ele continua com 1.

H√° a possibilidade de algu√©m ter dado um negativo no exato momento, ainda que improv√°vel, a√≠ precisaria de um hist√≥rico das a√ß√µes, ou pelo menos mostrar os positivos e negativos (acho que j√° tem proposta disto) para acompanhar o que aconteceu.

Logo depois, enquanto eu escrevia aqui apareceu um segundo voto l√°, mas ao mesmo tempo apareceu na minha resposta, ent√£o pode ser a mesma pessoa que votou nos dois.

Tamb√©m pensei na possibilidade cache, mas se acontece isso, √© de se pensar se isso est√° funcionando bem, cache n√£o pode criar confus√£o nesse n√≠vel. J√° cria em outros pontos menos cr√≠ticos.

At√© pode ser s√≥ cache mesmo porque tamb√©m estou impedido de votar at√© 72 horas.

Pode ser um bug no frontend apenas que n√£o atualizou o objeto do score.

Pode n√£o ser nada de bug (o cache atrapalhar UX √© bug, nem preciso colocar o meme das baratinhas) e s√≥ preciso de esclarecimento sobre a vota√ß√£o que eu n√£o entendi.

Em outras oportunidades funcionou perfeitamente, e o score subiu imediatamente.

>> Coment√°rio de filipedeschamps:
Para complementar na investiga√ß√£o: esta publica√ß√£o possui apenas `1` evento de `update:content:tabcoins` vindo do seu usu√°rio ü§ù

>> Coment√°rio de aprendendofelipe:
Ol√° @maniero, obrigado por reportar! üí™

√â por causa da nova estrat√©gia de cache mesmo. Isso deve ser corrigido em breve. üëç

>> Coment√°rio de maniero:
Pelo que percebo continua acontecendo problemas de cache em quase todas as postagens. Mesmo depois de horas ou at√© dias eu entro, est√° com um score, logo depois ele muda, j√° comecei acostumar que tem que esperar um tempo para ver o que est√° real. Chega at√© assustar, porque tem caso que d√° diferen√ßa de mais de 1 ponto do que eu sei que estava. N√£o sei se esse pull era para resolver isso, mas n√£o est√° funcionando, precisa dar uma verificada. Obrigado.

>> Coment√°rio de aprendendofelipe:
Oi @maniero, ocorrem problemas de cache ou um funcionamento caracter√≠stico de cache? Poderia explicar melhor o que ocorreu e como voc√™ acredita que deveria ter sido, considerando que a primeira vers√£o visualizada sempre √© do cache?

Segue um resumo apenas para quem estiver acompanhando a issue sem estar muito por dentro de como est√° funcionando:

As p√°ginas sempre s√£o carregadas com a vers√£o em cache e logo em seguida √© atualizada para uma vers√£o mais atual. N√£o √© s√≥ o saldo de TabCoins que pode mudar, mas qualquer dado que foi alterado na p√°gina entre a vers√£o que carregou do cache e a mais atualizada.

No primeiro carregamento de cada p√°gina voc√™ pode ver caches de dias atr√°s, isso se ningu√©m tiver acessado a mesma p√°gina usando a mesma Edge da Vercel que voc√™. As p√°ginas est√°ticas do Next.js/Vercel por padr√£o s√£o assim, s√≥ revalidam quando algu√©m acessa. O que ser√° implementado futuramente √© a revalida√ß√£o logo ap√≥s a√ß√µes dos usu√°rios que modifiquem qualquer dado da p√°gina, mas essa revalida√ß√£o tamb√©m n√£o ser√° instant√¢nea üëç

>> Coment√°rio de maniero:
√â isso, em v√°rias postagens, mas n√£o todas, entra com um score, cerca de 1 segundo depois ele muda, para o que eu entendo deveria ser o correto. J√° vi caso que deveria estar em 3, e mostra 1, depois muda para 3. Tentando v√°rias vezes e sempre assim. Mas agora nenhum est√° fazendo isso.

Eu acho que voc√™ tem que entrar com o score real, s√≥ o fato de mudar j√° cria um desconforto, como demora um pouco se prolonga o suficiente para assimilar o erro, e a UX fica mais prejudicada.

A√≠ at√© por curiosidade t√©cnica, que ganhos t√™m em fazer isso? A impress√£o que me d√° que √© at√© menos eficiente assim. Mesmo que tenha mais efici√™ncia que eu n√£o consigo enxergar, o custo de UX parece alto.

Quando fala do cache est√° falando que carrega do meu cache? A√≠ at√© consigo ver alguma efici√™ncia, mas ainda acho um pre√ßo alto a se pagar. De qualquer forma, precisa quanto tempo ou quantas vezes para ele estabilizar?  Falha de cache pode ser pontual, quando √© frequente tem algo bem errado, acho que n√£o preciso citar o Phil Karlton.

Mas se fala em pegar cache de dias atr√°s porque ningu√©m acessou parece que est√° falando do cache do servidor. E a√≠ me parece estrat√©gia de cache errada mesmo, n√£o s√≥ por manter algo que n√£o deveria estar em cache, mas tamb√©m por carregar o cache e depois atualizar. E mesmo que fosse isso n√£o poderia por tanto tempo ficar com cache velho como ocorre. O custo inclusive fica muito pior porque eu fico recarregando v√°rias vezes por causa disso.

Posso ajudar em algo mais?

>> Coment√°rio de filipedeschamps:
@maniero uma d√∫vida: voc√™ est√° acessando o site do Brasil ou outra regi√£o?

>> Coment√°rio de maniero:
Brasil. Vivo Fibra @filipedeschamps

>> Coment√°rio de maniero:
Eu n√£o sei se tem rela√ß√£o, mas fui votar em uma postagem root que eu tenho um coment√°rio (n√£o cliquei no meu) e apareceu:

"Voc√™ n√£o pode realizar esta opera√ß√£o em conte√∫dos de sua pr√≥pria autoria. Realize esta opera√ß√£o em conte√∫dos de outros usu√°rios."

>> Coment√°rio de aprendendofelipe:
> Eu n√£o sei se tem rela√ß√£o, mas fui votar em uma postagem root que eu tenho um coment√°rio (n√£o cliquei no meu) e apareceu:

Opa @maniero, tem sim total rela√ß√£o com a solu√ß√£o adotada para mostrar sempre os dados mais recentes. üòï

Ao navegar diretamente entre diferentes conte√∫dos, o estado do componente TabCoinButtons estava sendo mantido indevidamente enquanto ocorria a revalida√ß√£o. Enquanto isso voc√™ estava vendo o saldo (e bot√µes) do √∫ltimo conte√∫do navegado e n√£o o do cache.

Provavelmente era devido ao mesmo bug a maioria dos outros problemas que voc√™ citou de saldo mudando toda hora ou ficando com valor incorreto. Agora voc√™ s√≥ deve ver o saldo atualizar apenas se realmente houver algum voto recente. üëç

Muito obrigado por reportar os problemas! üí™üí™üí™

>> Coment√°rio de aprendendofelipe:
@maniero voc√™ foi citado no post comemorativo: https://www.tabnews.com.br/FelipeBarso/tabnews-otimizacoes-e-mais-melhorias üéâ
</issue_1383_Falha em dar um like em postagem root>

<issue_1384_Nova forma de ganhar tabcoins a partir de reputa√ß√£o pode desincentivar a publica√ß√£o de coment√°rios>
A solu√ß√£o utilizada para inibir o farm excessivo de tabcoins foi √≥tima em termos de posts, com o tempo come√ßaremos a ver cada vez menos posts feitos apenas para "encher lingui√ßa" e ganhar 2 tabcoins. Contudo, essa solu√ß√£o acaba causando um efeito contr√°rio quando falamos de coment√°rios. Na maioria absoluta dos casos, os coment√°rios n√£o passam de 2 ou 3 tabcoins, mesmo contendo muito valor concreto. Isso acontece provavelmente inconcientemente por entender-se que os coment√°rios s√£o menos importantes do que o post, quando na verdade eles devem ter a mesma import√¢ncia. Tendo isso em vista, dificilmente algum usu√°rio ter√° uma m√©dia maior que 5 tabcoins em seus √∫ltimos coment√°rios, o que faz com que praticamente s√≥ se ganhe tabcoins com upvotes em coment√°rios, que √© algo n√£o muito comum.

Um exemplo √© o usu√°rio [kht](https://www.tabnews.com.br/kht) que sempre est√° presente nos coment√°rios das publica√ß√µes e √© sempre cir√∫rgico em suas intera√ß√µes com muito valor concreto em todos os coment√°rios. Contudo, no modelo atual ele n√£o ganharia tabcoins ao fazer um coment√°rio, mesmo tendo valor concreto, o que √© um certo desincentivo.

O fato de termos uma separa√ß√£o para a avalia√ß√£o de relev√¢ncia entre conte√∫dos "root" e "child" faz com que a solu√ß√£o seja relativamente simples, j√° que bastaria mudar a forma com que a relev√¢ncia dos coment√°rios √© calculada. Talvez diminuir a m√©dia necess√°ria para considerar um usu√°rio relevante em seus coment√°rios ou at√© mesmo dar 1 tabcoin para usu√°rios com relev√¢ncia neutra poderiam ser solu√ß√µes v√°lidas.

>> Coment√°rio de danielschmitz:
> Contudo, no modelo atual ele n√£o ganharia tabcoins ao fazer um coment√°rio, mesmo tendo valor concreto, o que √© um certo desincentivo.

Uma d√∫vida. Ele ganha tabcoins ao receber upvotes no comentario ?

>> Coment√°rio de Gabriel-Tapes:
Sim, ele recebe, nisso nada foi mudado. A √∫nica coisa que mudou s√£o as tabcoins que eram recebidas ao publicar o conte√∫do.

>> Coment√°rio de hkotsubo:
Obrigado pelo elogio! (sim, sou o usu√°rio kht) :-)

Como a mudan√ßa na mec√¢nica de TabCoins ainda √© recente, n√£o temos como saber os reais efeitos no comportamento geral dos usu√°rios. Por exemplo, antes da mudan√ßa eu tamb√©m n√£o recebia tantos votos em coment√°rios. N√£o tenho dados pra saber exatamente o quanto mudou, mas minha percep√ß√£o geral √© que n√£o mudou tanto assim.

Enfim, eu esperaria mais um pouco para tirar conclus√µes mais assertivas. Acho que, passado algum tempo, seria interessante coletar alguns dados e comparar o antes e depois. Por exemplo, a quantidade de votos dados, se os coment√°rios aumentaram ou diminu√≠ram, etc. S√≥ ent√£o poderemos ver o real efeito que a mudan√ßa trouxe, analisar o que melhorou e o que piorou, e da√≠ decidir o que fazer.

O que posso dizer √© que - na minha percep√ß√£o - diminuiu um pouco a quantidade de "Obrigado" e "Que legal" (ta√≠ outro dado pra coletar), ent√£o ponto positivo. E claro que agora ficou mais dif√≠cil ganhar TabCoins, ent√£o **eu acho** que os votos tendem a diminuir (e s√≥ coletando dados pra ter certeza). Mas ainda √© cedo pra avaliar, porque muita gente ainda deve ter TabCoins acumulados que foram obtidos antes da mudan√ßa (que √© mais um dado a ser coletado e levado em conta na an√°lise). Por outro lado, usu√°rios novos agora demoram mais pra ganhar, ent√£o v√£o demorar mais pra come√ßar a votar tamb√©m (o que gera outra m√©trica: quanto tempo um usu√°rio novo leva entre o primeiro post e o primeiro voto).

Falando especificamente por mim: ainda n√£o me sinto desestimulado a comentar. Mas concordo que no m√©dio e longo prazo isso *pode* gerar um efeito cascata que desestimule coment√°rios. Por outro lado, *pode ser* que estimule as pessoas a s√≥ comentarem coisas mais pertinentes, pra aumentar as chances de ganhar votos. Veremos o que acontece...

>> Coment√°rio de Rafatcb:
> Acho que, passado algum tempo, seria interessante coletar alguns dados e comparar o antes e depois. Por exemplo, a quantidade de votos dados, se os coment√°rios aumentaram ou diminu√≠ram, etc.

Dizendo por mim, praticamente n√£o consegui votar desde a mudan√ßa (devo ter dado uns 2 ou 3 votos). Eu comento muito mais do que publico conte√∫do raiz, e qualificava conte√∫dos com bastante frequ√™ncia (tanto positivando quanto negativando). Desde a mudan√ßa, s√≥ fiz alguns coment√°rios, e menos do que faria usualmente justamente por estar tentando entender e otimizar o "ganho de TabCoins" para poder qualificar algo.

As pessoas que vi que tem um estoque maior de TabCoins s√£o pessoas que justamente votam menos. E eu digo que j√° estamos vendo o impacto disso: teve uma grande movimenta√ß√£o de reclama√ß√µes sobre publica√ß√µes duplicadas ou spam de publica√ß√µes esses dias, mas na verdade elas quase n√£o receberam votos negativos, e receberam alguns votos positivos. Acredito que a implementa√ß√£o do issue https://github.com/filipedeschamps/tabnews.com.br/issues/1155 poderia amenizar esse "desincentivo" em votar negativamente.

Para os curiosos, eu verifico os TabCoins pelo site desenvolvido pelo Gabriel Sozinho: [tabstats.ga](https://tabstats.ga/).

Outra coisa que percebi √© que eu **tive vontade de apagar coment√°rios com `1` TabCoin**, e isso n√£o faz o menor sentido. Fiz coment√°rios que geraram um di√°logo ou discuss√£o, mas que n√£o receberam votos, e se eu apagasse, melhoraria minha m√©dia (deixando os coment√°rios com >= `2` TabCoins), mas todas as respostas aos coment√°rios apagados seriam perdidas.

O objetivo n√£o √© acumular TabCoins, mas ver mais de 10 publica√ß√µes seguidas geradas por Intelig√™ncia Artificial e n√£o poder negativar nenhuma, me fez refletir um pouco.

Edit: Para adicionar uma reflex√£o: est√° mais dif√≠cil ganhar TabCoins para dar **um** voto negativo numa publica√ß√£o mal feita do que fazer cinco publica√ß√µes mal-feitas (que, apesar de n√£o necessariamente gerarem TabCoins, "poluem" o TabNews).

>> Coment√°rio de hkotsubo:
Ap√≥s ler [este coment√°rio](https://www.tabnews.com.br/Edson295/c983aa54-25a8-47cf-be3f-e3ce6644320b), fiquei pensando melhor sobre o sistema atual. Segue o trecho relevante:

> "*Para eu receber tabcoins, preciso criar algo que as pessoas votem como 'relevante'. Por√©m para as pessoas votarem, elas precisam de tabcoins. E pior, pois votar custa 2TC, mas o 'votado' recebe apenas 1*"

De fato, √† primeira vista, parece que a conta n√£o vai fechar. Talvez seja o caso de rever - se n√£o o sistema, pelo menos a pontua√ß√£o. Por exemplo, receber votos √© dif√≠cil: preciso escrever algo que seja bom o bastante para convencer duas pessoas a gastarem pontos   pra votar em mim. Assim eu ganho pontos suficientes pra dar um voto. Como receber votos √© mais dif√≠cil que dar, deveria resultar em mais pontos. Mas talvez isso seja assunto pra outra issue...

>> Coment√°rio de filipedeschamps:
Excelente conversa turma!

E @hkotsubo eu n√£o tinha correlacionado o seu usu√°rio aqui no GitHub, com seu usu√°rio no TabNews, nem com toda a ajuda que voc√™ est√° dando ao reportar incidentes sobre a comunidade por email. Muito obrigado por toda ajuda, est√° matando a pau ü§ù 

Em paralelo sobre a economia, sugiro revisitarmos esta publica√ß√£o aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/352#issuecomment-1155757751

Ela fala sobre dois mecanismos importantes de `Tap` e `Sink` em uma `Game Economy` ü§ù

>> Coment√°rio de hkotsubo:
@filipedeschamps  J√° tinha ouvido falar do conceito de tap/sink, mas enfim, antes de propor mudan√ßas, acho que podemos voltar alguns passos e analisar certos detalhes.

Primeiro, eu sugiro comparar a situa√ß√£o do site antes e depois da mudan√ßa. N√£o sei se vale esperar mais alguns dias (ou semanas) pra avaliar melhor, mas enfim, algumas sugest√µes de m√©tricas: se a quantidade de votos por usu√°rio (e/ou por post) diminuiu ou aumentou, separando entre usu√°rios novos e antigos (pois estes j√° poderiam ter um estoque de TabCoins, o que desbalanceia um pouco a quest√£o), quanto tempo um usu√°rio novo demora pra dar o primeiro voto, engajamento (se os coment√°rios aumentaram ou diminuiram), etc.

A partir da√≠ podemos ver o que melhorou ou piorou, e o que queremos consertar, quais comportamentos queremos incentivar ou desestimular. Por exemplo, quer√≠amos evitar os coment√°rios "Obrigado" e "Que legal", e minha impress√£o √© que diminuiu (mas precisa de dados pra ter certeza **se** e principalmente **quanto** mudou).

Por outro lado, por coment√°rios acima vemos que j√° tem gente que se sente desestimulado a comentar, e que n√£o est√° conseguindo votar tanto quanto antes. E essas a√ß√µes eu entendo que √© algo que deveria ser incentivado (a ideia do site √© que as pessoas avaliem conte√∫do, ent√£o temos que estimular a produ√ß√£o de conte√∫do bom, que tenha chance de receber mais votos - s√≥ que pra isso, as pessoas tem que ser capazes de votar).

Portanto, eu entendo que votar deveria ser mais f√°cil. Para dificultar a publica√ß√£o de conte√∫do ruim, deveria ser mais f√°cil negativar, e principalmente, devolver os pontos se o post for apagado. Talvez se estiver com pontua√ß√£o muito ruim (abaixo de um valor X a ser definido), o sistema poderia apagar automaticamente depois de N dias - pois a√≠ ele j√° foi pro "limbo da segunda p√°gina", e como a comunidade entendeu que √© ruim, ent√£o pra que manter isso no site?

Talvez a pontua√ß√£o como um todo devesse ser revista. Se eu recebo um voto positivo, ganho 1 TabCoin. Se eu voto em algo, perco 2. Mas votar √© uma a√ß√£o f√°cil e que s√≥ depende de mim. Receber voto, por outro lado, √© mais dif√≠cil, pois precisa ser algo t√£o bom que conven√ßa outra pessoa a gastar 2 pontos dela pra me dar 1. Pra "empatar" em termos de pontos, preciso convencer duas pessoas a gastar pontos comigo (ou seja, receber dois positivos), √© uma a√ß√£o muito mais dif√≠cil, ent√£o acho que receber um positivo deveria dar mais TabCoins do que eu perco ao votar.

Claro que isso √© s√≥ um esbo√ßo, precisaria pensar melhor nos detalhes, principalmente nos valores espec√≠ficos. Talvez rodar uma simula√ß√£o pra ver se a conta fecha: pra algu√©m ganhar TabCoins, precisa receber votos (pode at√© ganhar ao postar, mas esses casos me parecem que ser√£o mais raros - ta√≠ outro dado pra coletar). Mas pra votar, as pessoas precisam de TabCoins. S√≥ que pra dar um voto em algo, ela precisa receber dois votos no conte√∫do dela. Com a base atual de usu√°rios, chegar√° um ponto em que a maioria n√£o vai conseguir votar? Se entrar muitos usu√°rios novos, eles conseguir√£o votar?

Lembrando que qualquer solu√ß√£o que pensarmos, deve sempre levar em considera√ß√£o o que se quer do site: queremos mais conte√∫do publicado, mais votos, mais coment√°rios, qualquer combina√ß√£o dessas? Os itens que queremos mais devem ser estimulados (seja dando mais pontos, ou sendo menos dif√≠cil do que os itens que n√£o se quer). E se o mecanismo do site n√£o permite ou dificulta muito isso, ent√£o deve ser repensado.

>> Coment√°rio de danielschmitz:
> Lembrando que qualquer solu√ß√£o que pensarmos, deve sempre levar em considera√ß√£o o que se quer do site: queremos mais conte√∫do publicado, mais votos, mais coment√°rios, qualquer combina√ß√£o dessas? Os itens que queremos mais devem ser estimulados (seja dando mais pontos, ou sendo menos dif√≠cil do que os itens que n√£o se quer). E se o mecanismo do site n√£o permite ou dificulta muito isso, ent√£o deve ser repensado.

Eu concordo totalmente contigo. Quando eu vi o tabnews nesse sistema de tabcoins, j√° imaginava que muito conte√∫do viria apenas "pra ganhar tabcoin", o que iria gerar conte√∫do f√∫til. √â o que acontece hoje, tem tanto post sem sentido gerado por ia, e tanto ctrl+c/ctrl+v, que nao me motiva muito nem a postar. Eu prefiro comentar os posts com pedido de ajuda, e raramente voto em coment√°rios, pq acho desnecess√°rio dar upvote em coment√°rio... 

enfim, apenas deixando minha opini√£o. Eu acredito que se n√£o houvesse tabcoins, o ecosistema seria melhor. Uma pessoa iria postar porque quis, algu√©m ia dar downvote porque nao gostou, ou upvote porque gostou, simples assim.

>> Coment√°rio de hkotsubo:
> raramente voto em coment√°rios, pq acho desnecess√°rio dar upvote em coment√°rio

Depende, tem muito coment√°rio que √© melhor que o pr√≥prio post e merece voto sim. Assim como tem coment√°rio sem no√ß√£o que merece downvote.

Quanto a n√£o ter TabCoins, tem pr√≥s e contras. O fato de ter que gast√°-los pra votar faz com que as pessoas pensem melhor antes de sair votando de qualquer jeito (diminui os votos negativos de "vingan√ßa", ou a cria√ß√£o de v√°rias contas pra inflacionar um post, por exemplo). Mas se custar caro demais pra votar e/ou se ficar muito dif√≠cil ganhar TabCoins, as pessoas n√£o votar√£o.

E como eu j√° disse no coment√°rio anterior, acho que primeiro tem que definir quais comportamentos queremos estimular e quais queremos evitar, e a partir da√≠ desenhar um sistema que incentive o primeiro e dificulte o segundo. A impress√£o que d√° √© que a √∫ltima mudan√ßa focou demais em acabar com o ganho f√°cil de pontos (o que parece ter funcionado), mas talvez tenha dificultado demais pra todos (e n√£o s√≥ pra quem tinha ganhos indevidos). Mas isso √© algo que precisaria de mais dados e uma an√°lise aprofundada pra tirar conclus√µes mais assertivas, como sugeri acima.

E claro que n√£o tem sistema perfeito, mas o TabNews tem a vantagem de poder olhar para os v√°rios sites que existem hoje e aprender com eles (muitos deles funcionam h√° anos com milh√µes de usu√°rios, ou seja, s√£o sistemas diferentes de pontua√ß√£o e vota√ß√£o, que foram testados na pr√°tica).

>> Coment√°rio de filipedeschamps:
Turma, discuss√£o sensacional! üí™ 

Mas algo que estou sentindo falta √© a considera√ß√£o do `TabCash`. Nenhum plano deve ser feito apenas considerando `TabCoins`, pois ser√° uma jornada incompleta. No fluxo completo de contribui√ß√£o de uma pessoa, √© necess√°rio considerar dar **retorno concreto** a ela, e isto ser√° feito na Milestone **Revenue Share**.

Ent√£o o modelo atual est√° capenga, incompleto e revolver a quest√£o do uso do `TabCash` resolver√° alguns dos problemas atuais, mas obviamente criar√° outros. De qualquer forma, com o Revenue Share, √© preciso considerar que a dificuldade de ganhar TabCoins poder√° ser justificada. Isso **n√£o quer dizer** que o balan√ßo atual est√° correto. N√£o sei avaliar, e como o @hkotsubo falou, seria legal levantarmos dados para ver se √© poss√≠vel notar alguma coisa na economia ü§ù

>> Coment√°rio de hkotsubo:
> No fluxo completo de contribui√ß√£o de uma pessoa, √© necess√°rio considerar dar **retorno concreto** a ela, e isto ser√° feito na Milestone **Revenue Share**.

@filipedeschamps Confesso que me falta um entendimento melhor do todo, com rela√ß√£o ao funcionamento do _revenue share_. J√° tinha lido as issues #11, #19 e #352, mas pra mim ainda n√£o est√° totalmente claro, e parece que ainda tem pontos em aberto.

De qualquer forma, atualmente ganhamos TabCash ao votar no conte√∫do dos outros, e pra votar precisamos de TabCoins. Ent√£o voltamos ao ponto principal, que √© definir o qu√£o dif√≠cil deve ser para obter TabCoins. Se ficar muito dif√≠cil, poucos conseguir√£o votar, e consequentemente, poucos poder√£o usufruir dos futuros benef√≠cios do _revenue share_ (mas se for essa a inten√ß√£o, ok).

Quem est√° no site desde o in√≠cio e conseguiu acumular TabCash na √©poca em que era mais f√°cil vai ter certa vantagem, mas de certa forma n√£o tem muito o que fazer: em todo site *gamificado*, quem est√° participando h√° mais tempo sempre ter√° certa vantagem sobre os usu√°rios novos.

De qualquer forma, eu entendo que continua v√°lido meu pensamento de primeiro definir o qu√£o dif√≠cil queremos que determinadas coisas sejam, e o quanto cada uma deve recompensar. E s√≥ depois repensar um mecanismo que incentive os usu√°rios nesta dire√ß√£o.

>> Coment√°rio de filipedeschamps:
@hkotsubo h√° total pontos em aberto, e uma expectativa que eu tenho √© que teremos eternamente uma d√∫vida sobre a economia do TabNews, mas √© isto que ir√° nos fazer sempre ficar de olho ü§ù 

Ent√£o para mim a nossa economia n√£o √© uma quest√£o que tem _resolu√ß√£o_, √© somente "qual o pr√≥ximo passo" e entender se isto ajudou ou n√£o, e independente de qualquer opini√£o, s√≥ um experimento na pr√°tica para dizer. O massa √© que eu vejo que todo mundo est√° aberto a continuarmos a experimentar üí™ 

> Se ficar muito dif√≠cil, poucos conseguir√£o votar, e consequentemente, poucos poder√£o usufruir dos futuros benef√≠cios do revenue share (mas se for essa a inten√ß√£o, ok).

Show, concordo 100%, o segredo est√° no balan√ßo. E a inten√ß√£o √© beneficiar os usu√°rios que criam conte√∫dos com valor concreto, conte√∫do aut√™ntico, porque n√≥s como comunidade tamb√©m queremos consumir isso. Cada vez mais seremos inundados de spammers humanos e IAs, mas se protegermos o TabNews disso, ainda ser√° um lugar muito bom para trocar informa√ß√µes de humano para humano, mas a conta tem que fechar para quem participa, por isso do Revenue Share (que n√£o precisa ser _Revenue_, j√° explico abaixo).

> De qualquer forma, eu entendo que continua v√°lido meu pensamento de primeiro definir o qu√£o dif√≠cil queremos que determinadas coisas sejam, e o quanto cada uma deve recompensar.

Eu especulo que tudo isso acaba ficando muito mais f√°cil de definir quando o Revenue Share estiver no ar, pois as pessoas v√£o usar os espa√ßos dos an√∫ncios de formas diferentes. Algumas v√£o usar para um retorno financeiro direto, outras para um retorno indireto, outras para divulgar seus projetos pessoais sem fins lucrativos, outras seu perfil em algum lugar (por exemplo LinkedIn/GitHub), ou at√© suas pr√≥prias publica√ß√µes dentro do TabNews (caso voc√™ tenha escrito algo que sinta muito orgulho).

Mas isto de fato n√£o impede de irmos lapidando a dificuldade de ganho atual de TabCoins, puramente pelo seu potencial de qualificar conte√∫dos, que √© o que podemos usar hoje para nos defendermos de pessoas n√£o t√£o bem intencionadas ü§ù 

Eu s√≥ gostaria que as pr√≥ximas regras de ganho n√£o fossem criadas por mim, pois com a produ√ß√£o do curso eu vou virar gargalo neste assunto. Ent√£o num momento voc√™s em conjunto precisar√£o bater o martelo sobre qual ser√° o pr√≥ximo experimento. E para esse assunto n√£o travar, eu sugiro deixar o "voto de minerva" com o @aprendendofelipe porque hoje ele est√° com o poder de fazer deploy, e com isso vem uma responsabilidade de tamb√©m acompanhar o que aconteceu.

>> Coment√°rio de hkotsubo:
Complementando, segue uma discuss√£o recente sobre o assunto:

https://www.tabnews.com.br/GTEX/tabcoins-o-objetivo-mudou

>> Coment√°rio de filipedeschamps:
@hkotsubo obrigado por trazer esta publica√ß√£o para c√° üí™ 

Como consumidor do TabNews, eu sinto que a liquidez de TabCoins est√° menor e isto me fez perceber um outro efeito: a TabCoin n√£o √© o **combust√≠vel**, mas sim o **√≥leo** entre as engrenagens do sistema. O combust√≠vel ser√° o TabCash.

@aprendendofelipe acredito que chegou a hora de realizarmos um outro experimento, principalmente um que aumente a liquidez de TabCoins ü§ù

>> Coment√°rio de aprendendofelipe:
> a TabCoin n√£o √© o **combust√≠vel**, mas sim o **√≥leo** entre as engrenagens do sistema. O combust√≠vel ser√° o TabCash.

Como podemos fazer para os usu√°rios entenderem isso enquanto ainda n√£o existe a Revenue Share? Acumular TabCoins √© como guardar dinheiro embaixo do colch√£o, enquanto qualificar os conte√∫dos √© um investimento no TabNews, pois gera TabCash e aumenta as chances de ganhar de volta mais TabCoins que novamente v√£o se transformar em TabCash.

No m√≠nimo precisamos conscientizar os usu√°rios que mais propagam que se deve "economizar" TabCoins, pois eles est√£o causando a ilus√£o da maioria. E n√£o √© uma mentira inofensiva como propagar que a Terra √© plana, pois influencia negativamente o comportamento dos usu√°rios que perdem a oportunidade de ganhar TabCash, de melhorar o sistema de ranqueamento e de fazer a economia girar.

Tenho certeza que a maioria n√£o faz por m√° f√©, mas pode ser por n√£o entenderem de economia ou apenas terem feito alguma interpreta√ß√£o equivocada sobre a mec√¢nica do sistema, ou seja qual motivo for, precisamos entender.

Obviamente que podemos estar errando feio em algo, mas, se for o caso, tamb√©m √© preciso que mais gente se aprofunde na economia para chegarmos cada vez mais pr√≥ximo dos objetivos, que para alguns criadores de bons conte√∫dos pode ser a Revenue Share, mas para a grande maioria dos usu√°rios √© apenas que o seu tempo dedicado ao TabNews tenha valido a pena.

> @aprendendofelipe acredito que chegou a hora de realizarmos um outro experimento, principalmente um que aumente a liquidez de TabCoins ü§ù

S√≥ temos pouco mais de um m√™s desde a mudan√ßa, e boa parte dos usu√°rios podem ter demorado semanas para serem afetados de alguma forma e perceberem que n√£o estavam mais ganhando TabCoins t√£o facilmente, enquanto outros podem nem ter percebido que come√ßaram a ganhar mais TabCoins a cada publica√ß√£o.

Mas estou levantando dados para agir em cima de algo concreto. J√° d√° pra adiantar que existe saldo dispon√≠vel com os usu√°rios para que fossem dadas nesse instante mais de 20 mil qualifica√ß√µes, no m√≠nimo, e isso se forem todas negativas, j√° que as positivas aumentam a quantidade de TabCoins no sistema, ent√£o s√≥ cresceria a economia e abriria espa√ßo para cada vez mais novas qualifica√ß√µes.

>> Coment√°rio de hkotsubo:
Fazendo uma "conta de padeiro":

Suponha que o site s√≥ tem 4 usu√°rios: A e B possuem 2 TabCoins cada, e usu√°rios C e D est√£o zerados.

A e B votam em um post do usu√°rio C. Agora A e B t√™m zero, e C tem 2.

C vota em um post do usu√°rio D. Agora A, B e C t√™m zero, e D tem 1. Ningu√©m mais pode votar em nada.

Ah, mas C tem um saldo positivo (aquela regra da m√©dia dos 10 conte√∫dos mais recentes), que permite que ele ganhe 1 TabCoin por post. Ent√£o ele come√ßa a postar e ganhar TabCoins. Suponha que ele publica 10 posts, ent√£o ganhou 10 TabCoins. Mas como ningu√©m mais podia votar, ent√£o nenhum desses posts recebeu votos. Depois de 48 horas, o saldo de C n√£o permitir√° que ele ganhe mais nada ao publicar.

Ent√£o agora temos A, B com zero, D com 1 e C com 10.

C pode dar no m√°ximo 5 votos. Suponha que ele vote em 5 posts de A, ainda sim n√£o vai ser suficiente para A ter saldo (pois hoje o m√≠nimo √© 6), ent√£o o √∫nico jeito de A ganhar TabCoins √© recebendo votos. Mas ningu√©m mais consegue votar, ent√£o a economia estagnou. Nenhum TabCoin ser√° gerado.

Faz sentido? Deixei algum detalhe de fora?
Lembrando que √© uma simula√ß√£o simplificada, que ainda vou revisar, mas me parece plaus√≠vel.

---

Como hoje, conforme dito, ainda podem ser dados 20 mil votos, vai demorar pra isso acontecer. Mas o simples fato de ser poss√≠vel j√° mostra que nesse sistema atual, os votos ficar√£o cada vez mais escassos, e no longo prazo pode matar a economia. N√£o precisa nem chegar ao ponto de todos ficarem zerados, provavelmente os usu√°rios desistir√£o antes disso.

>> Coment√°rio de aprendendofelipe:
> Faz sentido? Deixei algum detalhe de fora?

Apesar de algumas partes isoladas fazerem sentido, ao misturar com outras equivocadas, o resultado final n√£o faz sentido, e sim, deixou muitos detalhes de fora, mas imagino que ao citar que √© uma conta de padeiro, voc√™ esteja ciente de que n√£o est√° considerando tudo que deveria.

Mas isso n√£o foi para provar que vale a pena "economizar" TabCoins, n√©? Se voc√™ for um dos que defendem isso, e eu n√£o sei mesmo se √©, pode mostrar alguma conta, mesmo que de padeiro, que mostre que √© melhor os usu√°rios "economizarem" TabCoins ao inv√©s de votarem? Esse resultado chega a ser bom para pelo menos um usu√°rio?

Quero de verdade entender como se chega nessa conclus√£o para descobrir o que pode ser feito a respeito.

>> Coment√°rio de hkotsubo:
> Mas isso n√£o foi para provar que vale a pena "economizar" TabCoins, n√©?

N√£o. Se as pessoas economizarem, a economia n√£o gira. O ideal √© que os TabCoins sejam gastos, mas pra isso precisamos ganh√°-los primeiro, e isso tem ficado mais dif√≠cil. Meu exemplo tosco foi pra tentar mostrar como isso fica cada vez mais dif√≠cil, mas parece que falhei miseravelmente :-)

Acho que temos que tentar entender porque muitos est√£o economizando. Meu palpite √© que como agora est√° mais dif√≠cil ganhar TabCoins, o racioc√≠nio √© "*n√£o posso gastar muito, pois √© prov√°vel que eu n√£o consiga ganhar mais depois*".

Se isso √© o certo ou n√£o, √© outra hist√≥ria, at√© porque √© s√≥ um palpite, teria que colher mais dados pra ter certeza. Mas de fato est√° mais dif√≠cil ganhar TabCoins, ent√£o est√° mais dif√≠cil gastar tamb√©m. E se a economia n√£o gira, √© problem√°tico para o site. S√≥ isso j√° √© motivo para rever o sistema, na minha opini√£o (mesmo que o meu exemplo n√£o tenha sido o melhor).

>> Coment√°rio de Gabrielteixeira2004:
Ent√£o pessoal...

Concordo com a parte de as TabCoins irem se esvaindo, porque a conta n√£o fecha, mas o que acho mais preocupante √© de que as pessoas n√£o consigam criar um espa√ßo mais massa, porque n√£o tem recurso de modera√ß√£o e nem incentivo pela dificuldade que √© ter TabCoins...

Ent√£o qual seria o sentido das TabCoins se n√£o forem para ser da comunidade?

OBS: Entendo que foi para que parem de farmar, por√©m acho que a comunidade estava moderando essas pessoas.

(GTEX aqui)

>> Coment√°rio de migmoroni:
Vendo as quest√µes apresentadas, me surgiu uma ideia de poss√≠vel solu√ß√£o a amenizar o problema que estamos enfrentando.

A vis√£o geral sobre os coment√°rios, que √© uma das raz√µes de existir o tabnews, s√£o que eles podem ter as vezes mesmo valor ou at√© maior, que o post o qual comenta.
Sobre os tabcoins, pegando pela fala do pr√≥prio @filipedeschamps , visaria ser como um √≥leo, que lubrifica e torna o ecossistema tabnews din√¢mico.

Dito isso, agora a proposta:

**Premiar coment√°rios a post e com tabcoins**

Coment√°rios terem uma esp√©cie de meta de tabcoins ou sub coment√°rios √∫nicos, onde batendo isso, este √© repostado como um post principal e ocorrem premia√ß√µes aos que participaram do coment√°rio.

Sendo uma meta hipot√©tica de 8 tabcoins OU 16 subcoment√°rios de usu√°rios √∫nicos (coment√°rios em seu coment√°rio), ao bater, ocorre ao final:

1 - Usu√°rio que deu tabcoin e/ou comentou, recebe 1 tabcoin;
2 - O autor do coment√°rio, recebe at√© 4 tabcoins na medida que forem dados, com os restantes dos tabcoins lhe dados apenas ao final;
3 - O autor do post que estava o coment√°rio, recebe 2 tabcoins, pois foi o iniciador causador do coment√°rio adjacente.

Importante ressaltar: Seria contabilizado apenas 1 tabcoin e coment√°rio, por usu√°rio √∫nico, buscando uma situa√ß√£o de apoio e n√£o de farm. Mais coment√°rios no mesmo post, ainda conta como 1.
Seriam mini alavancas para serem mexidas at√© estarem bem colocadas.

E disto, se ganha que: Bons coment√°rios que foram feitos, mesmo que a meses atr√°s, podem ser alavancados pelo p√∫blico e serem repostados, assim, dando novo oxig√™nio para aquele coment√°rio, que poder√° receber mais coment√°rios e quem sabe, fazendo que outro seja premiado, fazendo a roda girar...

√â um mecanismo que buscaria jogar √≥leo para fazer o sistema girar com mais fluidez.
Possivelmente isto n√£o seria bala de prata, onde outros mecanismos em conjunto dar√£o a fluidez que tanto esperamos para esta rede bacana que est√° formando.

E quanto aos farms de plant√£o, √© a busca constante de ir sanando, at√© que o custo de farmar seja t√£o alta, que n√£o valha a pena o fazer.

E claro, n√£o venho para ser o cara aben√ßoado da raz√£o no meio da discuss√£o haha. Comentem o que acreditam, oxigenem o assunto. Quem sabe surge mais ideias, at√© melhores que esta !

>> Coment√°rio de migmoroni:
Vi que seria melhor postar uma sugest√£o no campo correto, ent√£o recoloquei esta proposta como sugest√£o no campo correspondente:
https://github.com/filipedeschamps/tabnews.com.br/issues/1432

>> Coment√°rio de hkotsubo:
> pode ser por n√£o entenderem de economia ou apenas terem feito alguma interpreta√ß√£o equivocada sobre a mec√¢nica do sistema

Bem, vira e mexe aparece algu√©m perguntando como funcionam o TabCoin e TabCash. Ent√£o parece que sim, ainda tem bastante gente que n√£o entende a economia do site.

Talvez um simples FAQ melhore isso. N√£o precisa ser t√£o elaborado quanto o proposto [aqui](https://github.com/filipedeschamps/tabnews.com.br/issues/1380), pode ser at√© um HTML est√°tico com um resumo, e talvez um link para a [explica√ß√£o oficial](https://github.com/filipedeschamps/tabnews.com.br/issues/1381).

E acho que mais importante do que saber como funciona, √© entender **porque** isso √© importante (e isso deveria estar no FAQ). E confesso que eu mesmo tenho dificuldade de entender o todo, pois como j√° disse acima, ainda n√£o compreendi totalmente como vai funcionar o revenue share.

>> Coment√°rio de aprendendofelipe:
> Bem, vira e mexe aparece algu√©m perguntando como funcionam o TabCoin e TabCash. Ent√£o parece que sim, ainda tem bastante gente que n√£o entende a economia do site.
> 
> Talvez um simples FAQ melhore isso. N√£o precisa ser t√£o elaborado quanto o proposto [aqui](https://github.com/filipedeschamps/tabnews.com.br/issues/1380), pode ser at√© um HTML est√°tico com um resumo, e talvez um link para a [explica√ß√£o oficial](https://github.com/filipedeschamps/tabnews.com.br/issues/1381).
>
> E acho que mais importante do que saber como funciona, √© entender **porque** isso √© importante (e isso deveria estar no FAQ). 

Sim, existem dois tipos de entendimento sobre a economia. Uma coisa √© entender em um n√≠vel que permita propor mudan√ßas fundamentadas, com simula√ß√µes realistas, e ajudar com a evolu√ß√£o constante dela. Esse entendimento n√£o √© e nem poderia ser exigido da maioria dos usu√°rios, sen√£o nunca rodaria.

Ent√£o no FAQ pode ter os pontos que fazem sentido para o usu√°rio comum, e quem quer se aprofundar pode vir para o reposit√≥rio.

L√≥gico que conte√∫dos sobre isso dentro do TabNews (seja raiz ou coment√°rio) que explicam, criticam, sugerem mudan√ßas ou citam de qualquer forma a mec√¢nica tamb√©m ser√£o muito interessantes e estimulam mais gente a se aprofundar. Mas eu queria saber a opini√£o de voc√™s sobre como dever√≠amos proteger o TabNews caso alguma dessas publica√ß√µes sejam imprecisas de forma a estimular comportamentos que causam preju√≠zos para o sistema.

Por exemplo, se o FAQ deixa claro que n√£o √© uma boa ideia "economizar" TabCoins, ao aparecerem postagens estimulando o contr√°rio, pode ser que a pr√≥pria comunidade modere e aponte a informa√ß√£o do FAQ. Mas tamb√©m podemos precisar agir ativamente em algumas situa√ß√µes.

> E confesso que eu mesmo tenho dificuldade de entender o todo, pois como j√° disse acima, ainda n√£o compreendi totalmente como vai funcionar o revenue share.

Fique tranquilo quanto a isso, pois todos estamos com essa mesma limita√ß√£o. Ainda n√£o est√° nada definido. üëç

>> Coment√°rio de hkotsubo:
> como dever√≠amos proteger o TabNews caso alguma dessas publica√ß√µes sejam imprecisas

Se tivesse um material oficial explicando (seja FAQ ou o que for), bastaria comentar apontando o link :-)

Hoje, a √∫nica forma √© responder um a um, o que pode se tornar invi√°vel conforme o n√∫mero de usu√°rios cresce. Por isso √© importante ter essa informa√ß√£o em algum lugar de f√°cil acesso. Poderia, por exemplo, ter um "tour inicial" para cada novo usu√°rio, explicando em linhas gerais o site. Hoje n√£o tem muita explica√ß√£o, a pessoa sai usando da forma que acha que √© (e nem sempre acerta).

A meu ver, a propaga√ß√£o de desinforma√ß√£o √© consequ√™ncia do n√£o-entendimento. Se tiver mais gente entendendo, essa propaga√ß√£o tende a diminuir.

> se o FAQ deixa claro que n√£o √© uma boa ideia "economizar" TabCoins

Sim, √© importante refor√ßar isso (e tudo mais que se considera essencial para o bom funcionamento do site). Como eu j√° disse na issue do FAQ: se est√° escrito, temos mais subs√≠dio para orientar os usu√°rios (n√£o vai ser uma regra que eu inventei, e sim algo oficializado pelo pr√≥prio site).

De qualquer forma, n√£o d√° pra escapar do problema atual: se est√° mais dif√≠cil ganhar TabCoins, √© compreens√≠vel que muitas pessoas tenham receio de gastar tudo. N√£o importa o que o FAQ diga, se as pessoas n√£o acharem que faz sentido, elas n√£o seguir√£o. Se o sistema n√£o ajuda a atingir os objetivos do site, n√£o d√° pra esperar que os usu√°rios sigam as orienta√ß√µes ("_Como vou gastar se n√£o consigo nem ganhar?_").

>> Coment√°rio de Gabrielteixeira2004:
Concordo com o hkotsubo,

Se est√° mais dif√≠cil ganhar, o FAQ n√£o vai resolver o problema...

√Ä princ√≠pio, como j√° foram feitos alguns c√°lculos acima, o sistema atual de pontua√ß√£o leva o sistema √† recess√£o e receio (conforme explicitado por v√°rios usu√°rios).

Na minha opini√£o, evitar o farm poderia ocorrer de outras maneiras, exemplo:

O usu√°rio pode perder at√© 2 Tabcoins e ganhar at√© 2 Tabcoins dependendo da quantidade de caracteres, al√©m dos votos.
Potencial: Desencorajar coment√°rios rasos e farm.
Aten√ß√£o: Encher lingui√ßa, utiliza√ß√£o dos LLMs para criar coment√°rios superficiais (mas que com certeza seria moderado pelos usu√°rios da comunidade).

Enfim, s√≥ trazendo uma ideia aqui pra plataforma...

>> Coment√°rio de hkotsubo:
E s√≥ pra complementar, [tentei fazer uma outra simula√ß√£o](https://www.tabnews.com.br/kht/380b2f8e-5e0c-4613-957e-21157763a5ec). Sei que com certeza muitos detalhes n√£o foram contemplados porque me falta o entendimento do todo, ent√£o queria muito que algu√©m que tenha esse entendimento completo me rebatesse com exemplos concretos, indicando principalmente o que eu deixei de fora e no que exatamente eu errei :-)

>> Coment√°rio de natanael-b:
Uma economia vi√°vel talvez fosse:

2 TabCoin/Post
-1 TabCoin/Voto
0 TabCoin/Coment√°rio

>> Coment√°rio de aprendendofelipe:
> E s√≥ pra complementar, [tentei fazer uma outra simula√ß√£o](https://www.tabnews.com.br/kht/380b2f8e-5e0c-4613-957e-21157763a5ec). Sei que com certeza muitos detalhes n√£o foram contemplados porque me falta o entendimento do todo, ent√£o queria muito que algu√©m que tenha esse entendimento completo me rebatesse com exemplos concretos, indicando principalmente o que eu deixei de fora e no que exatamente eu errei :-)

T√° faltando base de estat√≠stica para simular, pois est√° fazendo simplifica√ß√µes que n√£o podem ser feitas e chegando em conclus√µes equivocadas.

Equivalente a fazer um √∫nica itera√ß√£o jogando que 40.000 pessoas fariam apenas 20.000 filhos e concluir que a popula√ß√£o mundial acabaria um dia.

>> Coment√°rio de hkotsubo:
> 40.000 pessoas fariam apenas 20.000 filhos e concluir que a popula√ß√£o mundial acabaria um dia.

A diferen√ßa √© que as pessoas podem ter v√°rios filhos, n√£o se limitaria a 20000. J√° 40000 TabCoins s√≥ podem gerar 20000 votos - seria, dadas as devidas propor√ß√µes, como a "lei do filho √∫nico" que tinha na China :-)
De qualquer forma, foi por isso que pedi um exemplo mais detalhado.

Sei que me falta muita coisa pra fazer uma simula√ß√£o decente, ent√£o por favor, me mostre essa simula√ß√£o. Eu j√° sei que tem coisas erradas e faltando, mas n√£o adianta s√≥ falar que estou errado, **quero mais detalhes**.

Estou tentando entender, na melhor das inten√ß√µes, visando o melhor para o site.

>> Coment√°rio de aprendendofelipe:
Quando se faz simplifica√ß√µes, voc√™ calcula os extremos de forma que possa garantir que, sem as simplifica√ß√µes, o resultado real estaria em algum lugar entre esses extremos.

> J√° 40000 TabCoins s√≥ podem gerar 20000 votos

Supondo a simplifica√ß√£o de 2 para 1 que voc√™ est√° fazendo, que √© v√°lida, mas n√£o te limita a uma s√≥ itera√ß√£o. No limite de um grande n√∫mero de itera√ß√µes, partindo de 40000 TabCoins, e todos os votos sendo positivos, seriam 40000, n√£o 20000 votos positivos.

```math
\sum\limits_{n = 1}^\infty {(40000*{{1/2}^n)} = 40000}
```

No limite contr√°rio, sendo todos os votos negativos, a√≠ s√≥ seria poss√≠vel uma itera√ß√£o, e ter√≠amos -20.000 votos (vou usar `-` para representar os votos negativos).

L√≥gico que na pr√°tica esses limites extremos tem probabilidade zero, e o resultado real iria ficar entre -20.000 e 40.000, dependendo de diversos fatores que foram ignorados na simplifica√ß√£o, inclusive o fato de que nunca ocorrer√£o infinitas itera√ß√µes.

## Como era

Na pr√°tica o que existia antes era esse 2/1 e aqueles 2 TabCoins iniciais por publica√ß√£o. O que limitava o saldo m√©dio de votos por publica√ß√£o em 2 no limite superior:

```math
\sum\limits_{n = 1}^\infty {(2*{{1/2}^n)} = 2}
```

E analogamente, o limite inferior √© -1.

Na pr√°tica a **m√©dia** das publica√ß√µes iria ficar sempre dentro dos limites de -1 e 2 votos (0 a 3 TabCoins). E os usu√°rios ganhando entre 1 e 4 TabCoins por publica√ß√£o. Perceba que isso n√£o √© o limite de qualquer usu√°rio, √© o limite da m√©dia. Se voc√™ simular casos isolados, os limites s√£o muito diferentes, assim como n√£o faz sentido simular uma √∫nica itera√ß√£o nesses casos que convergem.

## Um dos problemas

Note a dificuldade de anular os 2 TabCoins ganhos por conte√∫dos sem valor concreto, s√≥ seria poss√≠vel se os conte√∫dos pouco relevantes fossem em pequena quantidade, mas o est√≠mulo era justamente o contr√°rio. Valia muito mais publicar em quantidade do que em qualidade. Lembra, publica√ß√µes com 0 TabCoins ainda tinham dado lucro de 1 TabCoin para o autor, tentar baixar de 0 TabCoins em todas as publica√ß√µes n√£o relevantes iria zerar r√°pido a economia e sem nenhum mecanismo automatizado que pudesse reverter.

O equil√≠brio de Nash estava em ficar pr√≥ximo ao ganho de 1 TabCoin por publica√ß√£o, sendo isso representado pelo caso em que a grande quantidade de conte√∫dos seria pouco relevante, por√©m classificados como neutros, e poucos conte√∫dos classificados como relevantes, por√©m com mais votos que custaram pouco, ou seja, votos com uma credibilidade menor. O n√∫mero absoluto podia ser maior, mas o valor era menor.

## Como ficou?

Agora subiu a cota√ß√£o do TabCoin, ent√£o conte√∫dos bem avaliados tem uma probabilidade maior de serem realmente mais relevantes do que os outros.

Por todas as vari√°veis envolvidas que n√£o controlamos (por exemplo mensagens estimulando comportamentos estranhos), aquela raz√£o de cria√ß√£o de TabCoins n√£o pode ser fixa. Precisa ser din√¢mica e se adequar ao comportamento dos usu√°rios. Se eles votarem mais, tem que ser injetado mais TabCoins. Se eles votarem menos, ser√° injetado menos. Nunca faltar√° TabCoins, mas eles podem parar de circular, bastando os usu√°rios pararem de votar. Nesse extremo, n√£o importa o n√∫mero absoluto, 0 votos multiplicado por qualquer coisa, vai dar sempre 0. Mas qual √© a chance disso acontecer? N√£o sei, mas aumenta com a propaganda que for feita pedindo isso. Isso travaria o TabNews? De forma alguma.

Os usu√°rios pararam de votar ap√≥s as mudan√ßas? N√£o pararam, apenas diminuiu, o que era esperado, pois diminuiu muito os votos baratos, e o saldo relativo das publica√ß√µes ficou um pouco mais condizente com seu conte√∫do, mas foi s√≥ um passo, estamos muito longe, muito longe mesmo do ideal. Precisamos avan√ßar muito mais. Todo avan√ßo pode melhorar para alguns e piorar para outros, mas a inten√ß√£o sempre vai ser, na m√©dia, melhorar para quem est√° alinhado com os objetivos de termos conte√∫dos de valor.

Se os usu√°rios diminu√≠rem os votos mesmo com TabCoins sobrando, teremos que agir para corrigir isso, e n√£o ser√° injetando mais TabCoins. Por enquanto n√£o d√° para afirmar, mas n√£o acho que precisamos esperar muito para agir. Precisamos esclarecer que parar de votar s√≥ prejudica quem parou. Por mais que haja uma campanha para todos pararem de votar, quem continuar publicando conte√∫do de qualidade ainda vai continuar recebendo votos que v√£o valer cada vez mais, e se trocarem por TabCash, esses ser√£o tamb√©m mais valiosos. S√≥ vai perder quem parar de qualificar.

Quem for tentar burlar o sistema ser√° barrado pelo pr√≥prio sistema, sem risco de zerar a economia.

T√°, mas e quem n√£o consegue publicar conte√∫do de destaque? Nenhum problema, vai participar normalmente e de vez em quando pode ganhar alguns TabCoins e trocar por TabCash. Ter√£o menos TabCash no final. Est√° errado isso? Acho que n√£o. D√° para criar outros benef√≠cios para esses usu√°rios, claro que sim. Sugest√µes?


## E agora?

Ainda estamos em transi√ß√£o do sistema antigo para um novo muito diferente, ent√£o √© perigoso tirar conclus√µes precipitadas, mas parece que podemos mexer um pouco na rela√ß√£o 12/16, mas agora s√£o movimentos suaves. Talvez usar uma rela√ß√£o diferente para coment√°rios, o que pode ser necess√°rio se eles continuarem recebendo menos votos do que os root.

Mas √© certeza que n√£o vai falta de TabCoins, pois n√£o √© uma moeda real, daria para injetar infinitos TabCoins se isso fosse bom, mas n√£o √©. Ser√° ajustado conforme a necessidade para manter a economia saud√°vel. Novas regras podem ser criadas tamb√©m, por exemplo, TabCoin expirar se n√£o for utilizado para votos. Ser√° que isso estimularia o uso? Provavelmente n√£o para todo mundo, mas diminuiria o saldo que fica parado, seja porque foi usado, seja porque expirou.

## Mas de onde vem o 12/16?

A rela√ß√£o 12/16 √© simples, aqui √© o valor m√°ximo s√≥ da primeira itera√ß√£o, pois a s√©rie diverge para infinito, o que significa que a quantidade de TabCoins s√≥ cresceria se o caso real ficasse nesse extremo, ok?

0,6 votos custam 1,2 TabCoins, e √© a m√©dia de votos necess√°rios para o usu√°rio ganhar imediatamente 0,6 e depois mais 1 TabCoin ao publicar (al√©m de +0,6 para a publica√ß√£o votada). Isso se n√£o burlar o sistema, porque d√° pra ir muito al√©m disso.

Ent√£o 1,2 TabCoins s√£o convertidos em 0,6 TabCashs, mas d√° at√© 1,6 para quem recebeu votos e 0,6 para o conte√∫do votado.

Ou seja, 1,2/2,2 ou, considerando apenas os TabCoins do usu√°rio, 1,2/1,6, que significa que 12 podem virar 16, muito maior do que antes, que era 2 vira 1 (em uma s√≥ itera√ß√£o). Em muitas itera√ß√µes, temos **infinito** contra 2.

## Conclus√£o

N√£o tem base dizer que a conta atual n√£o fecha, que os TabCoins v√£o acabar. 

Existem casos extremos que podem resultar em resultados finais ruins? Claro que sim, mas n√£o vou citar, para n√£o come√ßarem uma campanha dizendo que isso √© o melhor a ser feito, mas qualquer um que trabalha com dados consegue simular.

Todo mundo parar de votar n√£o est√° nos extremos, pois n√£o aumenta nem diminui o saldo de TabCoins. S√≥ √© algo muito ruim mesmo de se fazer para si, e se ocorresse com todos os usu√°rios, o TabNews seria um lugar de publica√ß√µes, mas sem qualifica√ß√µes. Algu√©m quer isso?

>> Coment√°rio de aprendendofelipe:
O que voc√™s acham das duas sugest√µes que coloquei acima?

1. Diferenciar a regra dos coment√°rios para deixar um pouco mais f√°cil de ganhar TabCoins do que nas publica√ß√µes root. Com foco em compensar que normalmente os coment√°rios s√£o menos votados.

2. Criar alguma forma de expirar TabCoins abandonados por muito tempo. Com foco em fazer circular as TabCoins j√° existentes. Talvez expirar x% a cada y dias, por exemplo 20% a cada 100 dias.

Pode ser um dos dois ou at√© mesmo os dois juntos. O 1 √© tranquilo de implementar, mas o 2 precisa planejar bem como fazer.

Em qualquer caso s√≥ d√° pra come√ßar com pequenos ajustes para ir sentindo, pois se houver um aumento abrupto de movimenta√ß√£o, como est√° muito mais f√°cil de gerar TabCoins do que antes, pode dar uma explodida na quantidade muito al√©m do que queremos e isso diminuiria a qualidade dos votos, prejudicando o ranqueamento.

O que acham?

>> Coment√°rio de hkotsubo:
> o resultado real iria ficar entre -20.000 e 40.000

S√≥ por curiosidade, qual o valor atual do site? E qual vcs consideram o ideal? A diferen√ßa entre eles est√° aceit√°vel? Caso n√£o esteja, o que precisa ser feito? Apenas um ajuste nos par√¢metros, ou uma mudan√ßa comportamental?

N√£o tenho as respostas, mas s√£o perguntas que eu faria pra tentar entender a situa√ß√£o.

> Por mais que haja uma campanha para todos pararem de votar

N√£o acho que chegou a ser uma campanha. Teve um ou outro falando abertamente, mas vi mais como opini√£o, e n√£o como "convoca√ß√£o para se rebelar contra o sistema".

E nem acho que influenciou tanto assim. Talvez alguns podem ter concordado, mas acho que no grande esquema das coisas, o peso disso foi pequeno.

N√£o posso falar por todos (acho que s√≥ uma pesquisa ampla poderia dar insights sobre isso), mas falando por mim, fiquei mais criterioso nos votos. Agora s√≥ voto no que eu acho realmente **muito** bom (ou ruim) mesmo. Mas agora fico com receio de gastar tudo e demorar pra recuperar - e nesse meio tempo, deixarei de votar em v√°rias coisas que gostaria.

Meu palpite √© que muitos devem ter chegado a conclus√µes parecidas. Se est√° mais dif√≠cil ganhar, aumenta o receio de gastar. Tem um lado meio irracional nisso, de n√£o querer ficar zerado, sei l√°.

De qualquer forma, n√£o tem solu√ß√£o f√°cil. Se facilitar demais o ganho, banaliza os votos (como era antes), mas se dificultar demais, poucos votar√£o, o que tamb√©m n√£o √© bom. √â dif√≠cil achar o ponto ideal.

---

Sobre as sugest√µes, acho que a 1 faz sentido. S√≥ precisa definir o qu√£o mais f√°cil deveria ser (eu n√£o sei).

Sobre a 2, acho que precisa pensar melhor. Se hoje j√° tem gente que n√£o entende como funciona, imagina se come√ßar a sumir TabCoins "do nada". A interface do site teria que deixar bem claro que aquilo expira. Talvez ter uma tela de gerenciamento, que mostre quando cada um expira, ter notifica√ß√µes/emails avisando que vai expirar em X dias, etc. Tudo pra evitar surpresas, e principalmente reclama√ß√µes.

Sem contar que pode ter efeitos colaterais. Por exemplo, vi que vai expirar hoje, e come√ßo a votar em qualquer coisa s√≥ pra n√£o perder.

Qualquer mudan√ßa sempre traz novos problemas inesperados, e √© melhor pensar bastante antes, pra antecipar o m√°ximo poss√≠vel (isso vale pra 1 tamb√©m, claro, mas acho que tem menos potencial de efeitos colaterais graves).

>> Coment√°rio de aprendendofelipe:
> > o resultado real iria ficar entre -20.000 e 40.000
> 
> S√≥ por curiosidade, qual o valor atual do site? E qual vcs consideram o ideal? A diferen√ßa entre eles est√° aceit√°vel? Caso n√£o esteja, o que precisa ser feito? Apenas um ajuste nos par√¢metros, ou uma mudan√ßa comportamental?

Valor real do saldo de TabCoins? O que a gente estava falando era de probabilidade de evolu√ß√£o futura dos votos/saldos, ent√£o imagino que esteja perguntando o saldo de TabCoins. Se n√£o for isso, √© s√≥ falar.

Ontem estava em pouco mais de 60.000 dispon√≠veis para os usu√°rios usarem. Como alguns usu√°rios tem saldo √≠mpar, sobram alguns que n√£o poderiam ser usados, mas contando s√≥ o ques podem ser usados, d√° quase 30.000 votos dispon√≠veis para mais de 5.000 usu√°rios.

Ainda n√£o tem como saber um valor ideal de saldo. Provavelmente vai ser proporcional ao n√∫mero de usu√°rios ativos. Tem que existir saldo suficiente para os que est√£o qualificados a votar votem, mas n√£o demais ao ponto de terem que votar sem crit√©rios apenas para resgatar TabCash. N√£o sei se um dia saberemos quais seriam os valores ideais, mas dificilmente saberemos antes da Revenue Share.

> N√£o acho que chegou a ser uma campanha. Teve um ou outro falando abertamente, mas vi mais como opini√£o, e n√£o como "convoca√ß√£o para se rebelar contra o sistema".
> 
> E nem acho que influenciou tanto assim. Talvez alguns podem ter concordado, mas acho que no grande esquema das coisas, o peso disso foi pequeno.

Tamb√©m acho que foi pequeno, mas por menor que seja o efeito, ele √© prejudicial para quem foi afetado, ent√£o os afetados precisam ser protegidos de alguma forma. A sua sugest√£o do FAQ √© √≥tima!

E tamb√©m tem o risco da ilus√£o da maioria, onde mesmo os afetados sendo poucos, acabam criando uma falsa impress√£o de maioria.

> N√£o posso falar por todos (acho que s√≥ uma pesquisa ampla poderia dar insights sobre isso), mas falando por mim, fiquei mais criterioso nos votos. Agora s√≥ voto no que eu acho realmente **muito** bom (ou ruim) mesmo. Mas agora fico com receio de gastar tudo e demorar pra recuperar - e nesse meio tempo, deixarei de votar em v√°rias coisas que gostaria.
> 
> Meu palpite √© que muitos devem ter chegado a conclus√µes parecidas. Se est√° mais dif√≠cil ganhar, aumenta o receio de gastar. Tem um lado meio irracional nisso, de n√£o querer ficar zerado, sei l√°.

E isso n√£o √© um problema, √© algo esperado. Votos mais criteriosos s√£o votos melhores. Certo?

S√≥ n√£o entendo a parte do "n√£o votei em v√°rias coisas que gostaria". Voc√™ diz tendo saldo ou n√£o tendo saldo? Se tinha saldo e n√£o votou, √© porque voc√™ definiu um saldo m√≠nimo como uma reserva. Resta entender qual seria a vantagem de fazer isso ou, se n√£o houver, como esclarecer que isso tamb√©m n√£o √© algo interessante nem para o usu√°rio e nem para o sistema.

> De qualquer forma, n√£o tem solu√ß√£o f√°cil. Se facilitar demais o ganho, banaliza os votos (como era antes), mas se dificultar demais, poucos votar√£o, o que tamb√©m n√£o √© bom. √â dif√≠cil achar o ponto ideal.
> 
> Sobre as sugest√µes, acho que a 1 faz sentido. S√≥ precisa definir o qu√£o mais f√°cil deveria ser (eu n√£o sei).

Show!

> Sobre a 2, acho que precisa pensar melhor. Se hoje j√° tem gente que n√£o entende como funciona, imagina se come√ßar a sumir TabCoins "do nada". A interface do site teria que deixar bem claro que aquilo expira. Talvez ter uma tela de gerenciamento, que mostre quando cada um expira, ter notifica√ß√µes/emails avisando que vai expirar em X dias, etc. Tudo pra evitar surpresas, e principalmente reclama√ß√µes.
> 
> Sem contar que pode ter efeitos colaterais. Por exemplo, vi que vai expirar hoje, e come√ßo a votar em qualquer coisa s√≥ pra n√£o perder.

Com certeza tem que ser algo bem pensado, bem explicado e com notifica√ß√µes. E que afete na pr√°tica muito poucos usu√°rios, mas que tenha efeito psicol√≥gico nos demais. üëç

>> Coment√°rio de aprendendofelipe:
> Agora s√≥ voto no que eu acho realmente **muito** bom (ou ruim) mesmo.

@hkotsubo, essa sua frase ajudou bastante.

Eu acho que √© consenso que os votos precisam ser de qualidade, ou seja, serem criteriosos, para que o ranqueamento corresponda ao real valor dos conte√∫dos. Mas n√£o √© uma rela√ß√£o linear, onde votos mais criteriosos resultam sempre em um melhor ranqueamento, j√° que a quantidade de votos tamb√©m √© importante e √© inversamente proporcional ao trabalho que d√° para votar (seja por ser mais criterioso ou por qualquer outra dificuldade).

Era esperada que a mudan√ßa nas regras de ganho de TabCoins causasse a valoriza√ß√£o dos votos pela ado√ß√£o de melhores crit√©rios, mas era para ser apenas em um n√≠vel saud√°vel. N√£o era esperada uma supervaloriza√ß√£o. Mesmo que isso pudesse ocorrer com alguns usu√°rios, n√£o deveria ocorrer com a maioria.

Mas os sintomas do sistema realmente apontam para uma supervaloriza√ß√£o dos votos. Ent√£o foi investigar e de fato n√£o aconteceu essa supervaloriza√ß√£o com as mudan√ßas recentes, mas sim quando foi limitada a quantidade de votos por publica√ß√£o.

Vejam se faz sentido o meu coment√°rio na issue relacionada https://github.com/filipedeschamps/tabnews.com.br/issues/1166#issuecomment-1576987135

>> Coment√°rio de hkotsubo:
> Valor real do saldo de TabCoins?

N√£o. Vc disse que a partir de 40000 TabCoins, podem ser gerados at√© 40000 votos. Mas como √© um limite te√≥rico, fiquei curioso pra saber qual o valor que ocorre no site atualmente. E tamb√©m qual seria o que vcs consideram ideal para uma economia saud√°vel. Mas isso √© mera curiosidade...

---

Enfim, j√° que mencionou o saldo, seria interessante ver quantos desses 60000 TabCoins est√£o com usu√°rios ativos (que acessaram o site pelo menos X vezes nos √∫ltimos Y dias, por exemplo). Pois se esses TabCoins est√£o com algu√©m que n√£o acessa h√° meses, a chance de serem gastos √© bem menor, acho. Enfim, seria s√≥ mais um dado pra compor a an√°lise da situa√ß√£o atual.

---

> Votos mais criteriosos s√£o votos melhores. Certo?
>
> S√≥ n√£o entendo a parte do "n√£o votei em v√°rias coisas que gostaria"

Sim, votos criteriosos s√£o o ideal. Mas deixa eu aprofundar mais meu ponto:

J√° fiquei zerado e √© uma situa√ß√£o que acho muito ruim, pois sabendo que n√£o podia votar em nada, eu acabava nem lendo muitos posts. Minha ideia do site √© que s√≥ vale a pena ler se eu puder tamb√©m avaliar, e pra isso preciso poder votar.

Quando estava zerado, eu s√≥ lia quando sabia que ia ter tempo pra eventualmente comentar, pois a√≠ teria a chance de receber votos (al√©m de complementar o post, algo que fa√ßo bastante at√©). Mas se eu estivesse sem tempo ou vontade de comentar, acabava nem lendo nada.

J√° quando eu tenho alguma reserva, acabo lendo mais posts, pra ver se tem algum que merece voto. Mesmo quando n√£o tenho tempo de comentar, posso acabar dando um ou outro voto.

S√≥ que quanto menos TabCoins eu tenho, mais eu fico com receio de gastar tudo, justamente porque na minha cabe√ßa ficar zerado √© pior (pelos motivos j√° ditos acima). Ent√£o acabo ficando **muito** mais criterioso, ao ponto de s√≥ querer votar se estiver tudo o mais pr√≥ximo da perfei√ß√£o (que convenhamos, quase nenhum post √©). Deixo de votar em coisas que eu votaria se meu saldo estivesse maior.

Pode n√£o fazer sentido se analisarmos racionalmente, mas as pessoas s√£o assim. Cada um tem suas irracionalidades, e √© imposs√≠vel controlar as a√ß√µes de cada usu√°rio e os seus crit√©rios para votar em algo.

Ou seja, voto criterioso √© bom at√© certo ponto. Tudo em excesso pode acabar se tornando prejudicial. E esse efeito psicol√≥gico causado pelo saldo pr√≥ximo de zero acaba fazendo o meu crit√©rio passar do ponto ideal.

---

Sobre a issue 1166, n√£o sei opinar ainda, preciso pensar mais a respeito...

>> Coment√°rio de aprendendofelipe:
> pois sabendo que n√£o podia votar em nada, eu acabava nem lendo muitos posts. Minha ideia do site √© que s√≥ vale a pena ler se eu puder tamb√©m avaliar, e pra isso preciso poder votar.

Interessante! Obrigado por relatar essa vis√£o! Pode ser que uma parcela significativa dos usu√°rios enxergue assim. üëç

No PR #1436 est√° sendo facilitado bastante os ganhos para coment√°rios e razoavelmente para os conte√∫dos root. Vamos monitorar a rela√ß√£o avalia√ß√µes/publica√ß√µes, que acho que √© melhor m√©trica para medir os efeitos dessas mudan√ßas üëÄ

>> Coment√°rio de filipedeschamps:
Esse ponto levantado pelo @hkotsubo me fez lembrar de uma discuss√£o antiga sobre se pessoas que visualizam o site deveriam ganhar TabCoins, pelo menos em algum momento. No passado eu neguei esta ideia, mas com as novas possibilidades de prote√ß√£o talvez podemos voltar a discutir isso.

Pegando por exemplo a minha pr√≥pria conta que passou por um hiato grande por conta do `filho+curso`, mas foi um de cria√ß√£o de conte√∫do l√° no TabNews, porque eu continuava a acessar sem parar. Ent√£o o "ato de ler com a inten√ß√£o de qualificar" √© um esfor√ßo tamb√©m que poderia ser remunerado.

Se isso fizer sentido, como fazer para dificultar de abusar esta mec√¢nica ou ser f√°cil de identificar algum abuso?

>> Coment√°rio de hkotsubo:
> como fazer para dificultar de abusar esta mec√¢nica ou ser f√°cil de identificar algum abuso?

Eu at√© ia responder, mas acho que esta issue j√° est√° com uma discuss√£o bem longa e n√£o queria bagun√ß√°-la misturando assuntos.

N√£o √© melhor abrir outra issue? (em uma busca r√°pida, n√£o encontrei nenhuma sobre o assunto).

>> Coment√°rio de filipedeschamps:
Em paralelo @aprendendofelipe fiz [este coment√°rio](https://www.tabnews.com.br/filipedeschamps/a65d3184-1ede-41db-8fd5-200175f0f72e) na sua publica√ß√£o e ganhei `1` TabCoin. Analisando as TabCoins no meu hist√≥rico de coment√°rios (de forma decrescente), tenho o seguinte:

1. 2 tabcoins
2. 1 tabcoin
3. 1 tabcoin
4. 1 tabcoin
5. 2 tabcoins
6. 2 tabcoins
7. 1 tabcoin
8. 1 tabcoin
9. 4 tabcoins
10. 3 tabcoins

N√£o lembro quanto do hist√≥rico √© analisado, mas vejo que √© uma conta saud√°vel para se ganhar mais de `1` TabCoin por publica√ß√£o. Ao menos analisando **emocionalmente** pelo fato de eu saber que qualificar uma publica√ß√£o custa `2` TabCoins. Assim como apontado pelo @hkotsubo, tem um lado **irracional** nessa avalia√ß√£o... mas que n√£o deveria ser descartado, talvez muito pelo contr√°rio ü§ù 

Junto disso, na vis√£o das pessoas que est√£o acompanhando esta thread, o que voc√™s consideram uma conta saud√°vel? Por exemplo, se um n√∫mero X das √∫ltimas publica√ß√µes p√∫blicas possuem `1` TabCoin, ela √© uma conta saud√°vel? E independente de estar publicando `root` ou `child`, deve ser analisado os dois? Digo isso, pois se pegar minhas √∫ltimas publica√ß√µes `root`, est√° assim:

1. 19 tabcoins
2. 3 tabcoins
3. 2 tabcoins
4. 8 tabcoins
5. 9 tabcoins
6. 4 tabcoins
7. 27 tabcoins
8. 8 tabcoins
9. 4 tabcoins 
10. 16 tabcoins

√â um sinal interessante tamb√©m.

>> Coment√°rio de aprendendofelipe:
> Em paralelo @aprendendofelipe fiz [este coment√°rio](https://www.tabnews.com.br/filipedeschamps/a65d3184-1ede-41db-8fd5-200175f0f72e) na sua publica√ß√£o

Respondido l√°, mas replicando aqui:

[Edit] Corrigi os n√∫meros de usu√°rios/sess√µes ativas, pois havia relacionado mesmo as sess√µes duplicadas em diferentes dispositivos. Isso s√≥ muda os n√∫meros de usu√°rios ativos, mas n√£o muda os n√∫meros de usu√°rios que possuem TabCoins.

[Edit 2] Agora no final do dia, analisando o impacto da modifica√ß√£o, notei algumas inconsist√™ncias, ent√£o verifiquei que o resultado da consulta que cruzava os dados da tabela de sess√µes e de balan√ßo n√£o estava batendo. Ent√£o fiz o que j√° deveria ter feito, pedi para o ChatGPT criar a consulta üòÖ, e ele fez algo bem mais complexo do que a minha, mas que est√° trazendo os dados corretos (pelo menos os que eu conferi manualmente). Ent√£o j√° aproveito para falar que a Turma √© demais, pois hoje mais que dobramos a quantidade de qualifica√ß√µes que est√°vamos tendo nos √∫ltimos dias. E isso vai aumentar os ganhos das publica√ß√µes dos pr√≥ximos dias. üéâ

Temos um total de 4.736 sess√µes ativas de 3.734 usu√°rios. Se incluir qualquer sess√£o que estava ativa nos √∫ltimos 14 dias, o n√∫mero √© 7.038 sess√µes de 5.326 usu√°rios.

Cruzando os usu√°rios com sess√£o ativa e que possuem TabCoins 2 ou mais TabCoins, temos 990 usu√°rios em posse de 20.623 TabCoins.

Se incluirmos as sess√µes expiradas nos √∫ltimos 14 dias, ent√£o o n√∫mero sobe para 1.291 usu√°rios com 25.457 TabCoins.

-------------------

> e ganhei `1` TabCoin

### O que est√° valendo

Considerando apenas os 10 coment√°rios anteriores a 48h, voc√™ tem 7 votos, o que d√° a m√©dia de 0,7 votos positivos. Como √© maior que 0,19, ent√£o habilita a ganhar 1 TabCoin por nova publica√ß√£o, isso com reflexo nas pr√≥ximas 10, ent√£o voc√™ ganha os 7 TabCoins dos votos e mais 10 das pr√≥ximas publica√ß√µes (somando 17), com um custo de 14 para quem votou, ent√£o s√£o 3 novos TabCoins no sistema.

Se a m√©dia estivesse em 1,2 ent√£o j√° habilitava a ganhar 2 TabCoins.

> Digo isso, pois se pegar minhas √∫ltimas publica√ß√µes `root`, est√° assim:

Se voc√™ publicar conte√∫do "root" agora, ganhar√° 9 TabCoins. Usando a m√©dia que voc√™ tinha 50 dias atr√°s, ganharia 12 TabCoins, mas na pr√°tica ganhava s√≥ 2 na regra antiga.

### At√© ontem

Voc√™ j√° estaria qualificado a ganhar 1 TabCoin mesmo sem a mudan√ßa de ontem, pois 0,7 > 0,6. Mas realmente era um limiar alto para coment√°rios, por isso eu diferenciei a conta desde o in√≠cio, pois sabia que se fosse misturar, iria prejudicar os ganhos de conte√∫dos "root". Mas apesar de diferenciar na hora do c√°lculo, o limiar ficou igual para os dois tipos de conte√∫dos, pois tinha que partir de algum valor para come√ßar a nova regra. Agora √© ir ajustando.

### Pr√≥ximos passos

Tem outro par√¢metro que podemos ajustar, que √© um multiplicador, ou seja, dado que o usu√°rio est√° qualificado a ganhar, d√° para multiplicar o ganho por qualquer valor que quisermos, ent√£o √© outra forma de injetar mais ou menos TabCoins. Mas isso ir√° beneficiar muito mais os que j√° ganham bastante, do que a grande massa de usu√°rios, ent√£o apesar de injetar muito mais TabCoins, esses usu√°rios n√£o dariam conta de ler tantos conte√∫dos para qualificar, ent√£o s√≥ seria uma boa ideia se for retirado o limite de votos por publica√ß√£o (regra que n√£o est√° sendo ison√¥mica, pois que quer consegue burlar).

Fica bem melhor se complicarmos um pouco mais a regra. D√° para dar um ganho extra inicial, mas com um crescimento amortecido, ent√£o n√£o explode os ganhos dos mais "ricos".

Poderia ser algo como 0,2 votos (ou menos) de m√©dia j√° d√£o direito a 1 TabCoin, mas n√£o precisar chegar a 1,2 para ganhar 2, talvez com 0,8 (ou menos) j√° seja suficiente. Mas conforme a m√©dia vai crescendo, a gente pode ir tirando esse b√¥nus na m√©dia.

Tanto criar, quanto processar essa regra √© tranquilo, mas ela ser√° mais complexa de ser entendida, ent√£o para quem gosta de conhecer os detalhes da mec√¢nica para "jogar o jogo" da forma mais otimizada poss√≠vel, ter√° bastante trabalho, ent√£o podem n√£o gostar da mudan√ßa.

E falando em pr√≥ximos passos, eu concordo com o @hkotsubo que dever√≠amos estar discutindo isso em uma issue mais apropriada, pois o t√≠tulo dessa pode n√£o atrair todos que estejam dispostos a ajudar na evolu√ß√£o da mec√¢nica.

Al√©m de que essa frase abaixo √© um ponto que d√° para discutir muitas coisas legais que envolvem m√©tricas e experi√™ncia dos usu√°rios, como pensar se deveriam existir outras forma de intera√ß√£o com as publica√ß√µes, al√©m da visualiza√ß√£o, qualifica√ß√£o e coment√°rio.

> pessoas que visualizam o site deveriam ganhar TabCoins

>> Coment√°rio de filipedeschamps:
> Cruzando os usu√°rios com sess√£o ativa e que possuem TabCoins, temos 1.734 usu√°rios em posse de 31.000 TabCoins.

√â TabCoin pra caramba üò±

> Se voc√™ publicar conte√∫do "root" agora, ganhar√° 9 TabCoins. Usando a m√©dia que voc√™ tinha 50 dias atr√°s, ganharia 12 TabCoins, mas na pr√°tica ganhava s√≥ 2 na regra antiga.



> Se voc√™ publicar conte√∫do "root" agora, ganhar√° 9 TabCoins. Usando a m√©dia que voc√™ tinha 50 dias atr√°s, ganharia 12 TabCoins, mas na pr√°tica ganhava s√≥ 2 na regra antiga.

Sensacional, confirmei que esse foi o caso üòç ü§ù  Bora distribuir essas TabCoins üí™ 

> Fica bem melhor se complicarmos um pouco mais a regra. D√° para dar um ganho extra inicial, mas com um crescimento amortecido, ent√£o n√£o explode os ganhos dos mais "ricos".

Justo! Isto me lembrou o problema gerado pelo [The Zipf Mystery](https://www.youtube.com/watch?v=fCn8zs912OE).

E concordo por fatiar em outras issues ü§ù

>> Coment√°rio de natanael-b:
> Junto disso, na vis√£o das pessoas que est√£o acompanhando esta thread, o que voc√™s consideram uma conta saud√°vel? Por exemplo, se um n√∫mero X das √∫ltimas publica√ß√µes p√∫blicas possuem 1 TabCoin, ela √© uma conta saud√°vel?

Depende:

Esse [post por exemplo](https://www.tabnews.com.br/Bassani/gerando-qr-codes-com-python-um-guia-ratico-simples-com-exemplos) ele tem 1 Tab Coin, √© um texto que cumpre perfeitamente os termos, [fora algumas escorregadas  a conta √© cumpre bem seu dever](https://www.tabnews.com.br/Bassani) para com a comunidade foram 10 posts com m√©dia de 1 Tab Coin/post, √© justo?

>> Coment√°rio de aprendendofelipe:
> Esse [post por exemplo](https://www.tabnews.com.br/Bassani/gerando-qr-codes-com-python-um-guia-ratico-simples-com-exemplos) ele tem 1 Tab Coin, √© um texto que cumpre perfeitamente os termos, [fora algumas escorregadas a conta √© cumpre bem seu dever](https://www.tabnews.com.br/Bassani) para com a comunidade foram 10 posts com m√©dia de 1 Tab Coin/post, √© justo?

Mas esse post √© bem espec√≠fico, √© um tipo diferente de relev√¢ncia, com certeza ser√° acessado muitas vezes por quem pesquisar pelo assunto no futuro e ganhar√° TabCoins de parte das pessoas.

N√£o tem base na realidade a ideia de que somente as publica√ß√µes recentes, ou as que s√£o destacadas como relevantes, s√£o acessadas. Boa parte do tr√°fego do TabNews vem do Google.

Veja os acessos dos √∫ltimos 30 dias em uma publica√ß√£o que j√° tem 5 meses:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/5d8a36da-7a81-44d9-967b-dd9ddb8bdf4b)

>> Coment√°rio de aprendendofelipe:
Vejam desde a publica√ß√£o em 11 de janeiro

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/b9aa429b-fe20-4de9-a22f-454f1a3cb2fc)

>> Coment√°rio de aprendendofelipe:
Analisando os impactos da mudan√ßa nas √∫ltima 24 horas, encontrei algumas inconsist√™ncias nos dados. O cruzamento das informa√ß√µes da tabela de sess√µes e de balan√ßo estava dobrando alguns dados, mas n√£o todos. Ent√£o apelei para o ChatGPT que me falou que os dados estavam dobrados por causa de uma JOIN ü§î... N√£o entendi, mas pedi para ele gerar a consulta correta, que ficou mais complexa, mas todos os usu√°rios que conferi passaram a bater com o saldo mostrado na API.

Ent√£o os dados corretos s√£o 990 usu√°rios com mais de 2 TabCoins (possuem no total 20.623 TabCoins). E incluindo as sess√µes expiradas nos √∫ltimos 14 dias, o n√∫mero sobe para 1.291 usu√°rios com 25.457 TabCoins.

Apesar de ser um n√∫mero alto, tanto de usu√°rios, como de TabCoins, esse poder est√° na m√£o de 1/4 dos usu√°rios ativos. E o que os demais precisam fazer est√° na planilha a seguir:

Usu√°rios | Ativos at√© 14 dias | Total Cadastrados
-- | -- | --
Com mais de 2 TabCoins | 1.291 | 5.541
Com 0 ou 1 e habilitados a ganhar ao publicar | 444 | 980
Precisam de 1 voto para se habilitar | 50 | 89
Precisam de 2 votos para se habilitar | 824 | 1.921
Precisam excluir conte√∫dos recentes negativados | 99 | 372
Ainda n√£o publicaram conte√∫dos | 2.638 | 19.965

Obs.: A propor√ß√£o pequena de usu√°rios que precisam apagar conte√∫dos negativados, para mim, √© mais um indicador de que a auto-regula√ß√£o est√° funcionando.

Obs. 2: N√£o separei conte√∫dos "root" e coment√°rios na an√°lise de quantos votos faltam para se qualificar, ent√£o estou assumindo o caso mais "f√°cil" que √© para ganhar TabCoins com coment√°rios. F√°cil entre aspas, j√° que publica√ß√µes "root", se forem bem feitas, tem mais chances de receberem votos positivos.

Ser√° que a gente facilita ainda mais e faz esses 824/1.921 precisarem de apenas 1 voto para se qualificarem? E com isso os 50/89 j√° passam a estar habilitados?
</issue_1384_Nova forma de ganhar tabcoins a partir de reputa√ß√£o pode desincentivar a publica√ß√£o de coment√°rios>

<issue_1386_[bug] Mensagem de confirma√ß√£o de email duplicada>
Quando eu me cadastrei, o site exibiu uma mensagem pedindo para eu confirmar o email, o que eu fiz.

Em seguida, loguei no site e ele exibiu _novamente_ uma mensagem pedindo para eu confirmar o email, muito embora eu j√° estivesse logado.

N√£o recebi nenhum email para confirmar pela segunda vez e o site j√° estava 100% funcional, ou seja, o √∫nico bug foi a exibi√ß√£o da mensagem pela segunda vez, sem nenhum impacto adicional na usabilidade.

>> Coment√°rio de aprendendofelipe:
Ol√° @Henrique-Gomes, obrigado por reportar isso! üí™

A tela de login normalmente envia o usu√°rio de volta para a p√°gina em que estava, mas realmente isso n√£o faz sentido para algumas p√°ginas. Vou corrigir isso. üëç

Apenas para confirmar essa suspeita do que tenha ocorrido, voc√™ lembra se fez login usando a mesma aba que estava pedindo para conferir o email?

>> Coment√°rio de aprendendofelipe:
@Henrique-Gomes voc√™ foi citado no post comemorativo: https://www.tabnews.com.br/FelipeBarso/tabnews-otimizacoes-e-mais-melhorias üéâ
</issue_1386_[bug] Mensagem de confirma√ß√£o de email duplicada>

<issue_1388_Listar conte√∫dos por quantidade de TabCoins, coment√°rios, data de atualiza√ß√£o etc.>
Caso de uso: quero ver meus melhores e piores conte√∫dos, ent√£o posso ordenar eles por tabcoins (crescente ou decrescentemente)

Acredito que seja simples de implementar.

O que acham?

>> Coment√°rio de kenionatan:
Hey @iget-master, sou novo aqui, n√£o sei se isso √© algo que j√° foi comentado aqui, dei uma pesquisada e n√£o achei nada, caso n√£o exista nada em andamento neste sentido posso ajudar na implementa√ß√£o.

>> Coment√°rio de hkotsubo:
Eu iria al√©m e incluiria logo v√°rios crit√©rios: data da √∫ltima atualiza√ß√£o (seja coment√°rio ou edi√ß√£o), votos, quantidade de coment√°rios, etc (todos com op√ß√£o de ordem crescente e decrescente).

>> Coment√°rio de aprendendofelipe:
@iget-master, obrigado pela sugest√£o! üí™

Por enquanto n√£o existe cache dos saldos de TabCoins dos conte√∫dos. Ent√£o eles s√£o computados dentro de cada consulta em que s√£o necess√°rios. Por exemplo, para criar a lista de relevantes, buscamos todos os conte√∫dos root da √∫ltima semana e computamos o saldo de cada um deles antes de fazer as pr√≥ximas etapas de classifica√ß√£o.

Note que, enquanto n√£o houver cache do saldo, fica invi√°vel computar o saldo de todos os conte√∫dos existentes para poder classific√°-los pelo saldo.

Mesmo que filtrando por usu√°rio, teria que limitar tamb√©m por uma certa quantidade de conte√∫dos, ent√£o n√£o seria um resultado real de todos os conte√∫dos do usu√°rio, mas apenas dos mais recentes.

J√° as demais possibilidades sugeridas pelo @hkotsubo, acho que agora s√£o vi√°veis, e √© s√≥ quest√£o de algu√©m contribuir com a implementa√ß√£o. ü§ù

>> Coment√°rio de Rafatcb:
@aprendendofelipe O cache que voc√™ menciona seria o que exatamente? Vi que [foi considerado adicionar um `tabcoins_accumulated` no `users`](https://github.com/filipedeschamps/tabnews.com.br/pull/462#issuecomment-1166819598), acredito que o mesmo racioc√≠nio serviria para `contents`: 

> As propriedades `tabcoins_accumulated` e `tabcash_accumulated` ser√£o removidas e vamos implementar isso em outro momento.

Pelo [coment√°rio que vi no TabNews](https://www.tabnews.com.br/filipedeschamps/5f779d2f-0cbb-48fe-80af-9b7ca875076c), parece que o Pagar.me criou uma outra tabela para o saldo, ent√£o n√£o entendi se poder√≠amos ou n√£o criar a coluna `tabcoins_accumulated` na tabela `contents` mesmo. Nessa publica√ß√£o do TabNews tiveram outros coment√°rios sugerindo adicionar uma ou duas colunas √† tabela `balance_operations`.

De toda forma, me parece que seria melhor salvar `tabcoins_credit` e `tabcoins_debit` ao inv√©s de `tabcoins_accumulated`, porque eu cheguei nesse assunto devido ao issue https://github.com/filipedeschamps/tabnews.com.br/issues/1370, que hoje √© bem simples de resolver (seguiria a mesma l√≥gica de c√°lculo do total), mas com esse "cache" deveria continuar poss√≠vel obter os "cr√©ditos" e "d√©bitos" com o mesmo custo de desempenho do "total", para n√£o precisar fazer um c√°lculo caro e um barato na query, por exemplo.

[Nesse v√≠deo](https://youtu.be/NkdwsljLEOc?si=soIRyK_t5-eWb9xL&t=1511) o Filipe comenta sobre a coluna `sequence` em `balance_operations` que foi criada para preparar para o est√°gio do cache, mas n√£o entendi bem o motivo. Minha suspeita √© que seria usado para verificar at√© qual evento foi considerado no cache.

>> Coment√°rio de filipedeschamps:
@Rafatcb a mec√¢nica de cache √© mais ou menos a seguinte:

Duas tabelas s√£o envolvidas, uma que anota de forma livre todas as opera√ß√µes (a que j√° temos hoje `balance_operations`) e uma outra que anota a **soma** do saldo (por exemplo `balance_sum`). L√° tem o valor calculado do saldo do usu√°rio, mas a quest√£o que fica √©: como fazer para atualizar esse valor somado? √â a√≠ que entra a fun√ß√£o do `sequence`. Essa segunda tabela possui uma coluna que registra qual foi o √∫ltimo `sequence` que foi usado no c√°lculo e isso significa que o saldo somado foi de suposto `sequence 0` at√© `sequence x`. Ent√£o quando a fun√ß√£o que pede pelo saldo √© chamada, ela faz mais coisas:

1. Da `balance_sum`, pega o valor atual de saldo j√° somado e o `sequence`.
2. Verifica se existem mais lan√ßamentos em `balance_operations` acima do `sequence` anotado no `balance_sum`.
3. Se tiver, levanta o saldo somente do `sequence` para frente e soma isso com o saldo que j√° estava somado no `balance_sum`.
4. Feito isso, atualiza o `sequence` no `balance_sum` com o √∫ltimo utilizado do `balance_operations` para aquele usu√°rio.

Ent√£o voc√™ tem uma tabela com o saldo `fragmentado` e na outra tabela o saldo `consolidado`, sendo que para consolidar o saldo, voc√™ n√£o precisa mais passar por **todos** saldos fragmentados, basta somar o `diff` dos novos registros fragmentados. Isso faz muita diferen√ßa quando um certo usu√°rio (ou empresa no caso do Pagar.me) possui milh√µes de `balance_operations`. A diferen√ßa de performance era absurda, porque as vezes por erro nosso a gente precisava recalcular o saldo e demorava **muito**.

N√£o lembro se era exatamente assim a implementa√ß√£o, mas em princ√≠pio era isso. Posso marcar um call com a turma de l√° para revisar a mec√¢nica.

E no nosso caso, d√° para criar mais tipos de cache (cache de positivos ou negativos). De qualquer forma, eu s√≥ faria essa implementa√ß√£o quando a performance da soma crua for um problema real.
</issue_1388_Listar conte√∫dos por quantidade de TabCoins, coment√°rios, data de atualiza√ß√£o etc.>

<issue_1393_Exclus√£o da conta>
@filipedeschamps ou algum respons√°vel. Solicito a exclus√£o da minha conta imediatamente. 

```https://tabnews.com.br/jetrom```

>> Coment√°rio de filipedeschamps:
@Jetrom17 sem problemas. Voc√™ precisa apenas enviar um email para contato@tabnews.com.br utilizando o mesmo email da sua conta no TabNews ü§ù

>> Coment√°rio de Jeiel0rbit:
> @Jetrom17 sem problemas. Voc√™ precisa apenas enviar um email para [contato@tabnews.com.br](mailto:contato@tabnews.com.br) utilizando o mesmo email da sua conta no TabNews handshake

Obrigado. Espero que o TabNews tenha um bot√£o de excluir conta conforme nossa lei LGPD.
</issue_1393_Exclus√£o da conta>

<issue_1397_Bug no modo leitura do navegador e ao salvar no Instapaper.>
Em uma publica√ß√£o, ao ativar o modo leitura, dispon√≠vel em v√°rios navegadores e plugins. Ou salvar para leitura no Instapaper (que faz uso de mecanismo semelhante). Est√° salvando apenas os coment√°rios da publica√ß√£o.

Talvez seja algum problema sem√¢ntico do HTML da publica√ß√£o que confunde esses geradores de modo leitura.

_Teste: testei no Opera e Firefox, vers√µes atualizadas do dia 01/05/2023 e em minha conta no Instapaper._
_Sugest√£o: verificar a exist√™ncia e posi√ß√£o sem√¢ntica da tag `<article>` (Tentei testar rapidamente, mas o modo leitura n√£o processa o conte√∫do alterado no inspetor, eu teria que instalar todo projeto localmente para verificar isso)._

N√£o acontece em todas as publica√ß√µes, exemplo identificado em:
https://www.tabnews.com.br/DevLuan/estou-comecando-tarde

>> Coment√°rio de aprendendofelipe:
Ol√° @eduardofaria, obrigado pelos detalhes! üí™

Realmente ainda existem melhorias necess√°rias com rela√ß√£o ao HTML sem√¢ntico. Contribui√ß√µes quanto a isso s√£o muito bem vindas. üëç

>> Coment√°rio de Rafatcb:
Investiguei um pouco o issue e n√£o tenho certeza se o TabNews conseguir√° resolver isso. De acordo com [essa resposta do Stack Overflow](https://stackoverflow.com/questions/30661650/how-does-firefox-reader-view-operate) (de 2016), o Firefox toma a decis√£o do que exibir com base em uma nota atribu√≠da ao conte√∫do.

Em ambiente de desenvolvimento, criei uma publica√ß√£o simples e n√£o apareceu a op√ß√£o do modo de leitura. Um coment√°rio simples, e tamb√©m n√£o apareceu. Ent√£o adicionei um coment√°rio maior, com _lorem ipsum_, e apareceu. Num segundo teste, criei uma publica√ß√£o raiz com alguns par√°grafos do _lorem ipsum_, e a op√ß√£o do modo de leitura apareceu.

Experimentei colocar todo o conte√∫do (o principal e as respostas) numa √∫nica tag `article` para ver se compartilhariam a pontua√ß√£o, mas n√£o adiantou. Experimentei continuar esse teste, colocando `article` nos coment√°rios, para dar a entender que o coment√°rio √© relacionado √† publica√ß√£o (refer√™ncia: [mdn](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/article#usage_notes)), mas n√£o adiantou tamb√©m.

O issue pode ser melhor investigado, mas esses foram meus achados at√© ent√£o.

>> Coment√°rio de Rafatcb:
Agora que as altera√ß√µes do PR #1580 est√£o em produ√ß√£o, com `article` e `address` nos conte√∫dos, realizei um teste no Speedreader do Brave e o problema persistiu.

Fizemos alguns experimentos no PR e um deles est√° aqui https://github.com/filipedeschamps/tabnews.com.br/pull/1580#issuecomment-1874728894. Diferentes leitores exibiram o conte√∫do de jeitos diferentes, e mesmo alterando a forma de usar `article` (cada coment√°rio com um `article`, considerando aninhamentos vs sem aninhamentos) n√£o melhorou o resultado do "modo de leitura" dos navegadores.

O modo de leitura do Edge pareceu funcionar bem, mas n√£o vi como estava antes. O √∫nico detalhe √© que n√£o mostrou a pontua√ß√£o e o autor da publica√ß√£o principal. Veja o resultado atual para o link mencionado no issue:

![Modo leitura no Edge](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/ba19484b-b260-4966-970b-1d5ef288f4d7)

>> Coment√°rio de Rafatcb:
Estamos utilizando as tags sem√¢nticas de maneira correta para representar a publica√ß√£o e os coment√°rios, mas o Firefox, por exemplo, n√£o lida bem com uma p√°gina que cont√©m m√∫ltiplos `article`s (https://github.com/mozilla/readability/issues/473). Encontrei uma publica√ß√£o de um blog que cont√©m mais algumas informa√ß√µes sobre o assunto: [Reader View in Firefox and Safari for Multiple Articles on the Same Page](https://www.exratione.com/2016/12/reader-view-in-firefox-and-safari-for-multiple-articles-on-the-same-page/).

N√£o temos controle para indicar ao navegador como ele deveria se comportar. Al√©m disso, cada navegador funciona do seu jeito (veja no meu √∫ltimo coment√°rio que o Edge lida razoavelmente bem com o TabNews). Por esse motivo, vou fechar este issue para manter o reposit√≥rio organizado.

Caso surja algo que possamos fazer e que fa√ßa sentido (que n√£o piore a sem√¢ntica HTML do site, por exemplo), podemos reabrir o issue e trabalhar nisso.
</issue_1397_Bug no modo leitura do navegador e ao salvar no Instapaper.>

<issue_1398_App android, n√£o compartilha links dentro da publica√ß√£o>
Se configurar o Aplicativo do Android (n√£o sei no iOS) para abrir os links da publica√ß√£o pelo pr√≥prio aplicativo, e n√£o no navegador preferencial do sistema, n√£o h√° forma de compartilhar este conte√∫do que foi aberto dentro deste conte√∫do pai (ex: redes sociais e outros aplicativos do sistema).

>> Coment√°rio de aprendendofelipe:
Ol√° @eduardofaria, obrigado pela issue! üí™

Existe como copiar o link de qualquer publica√ß√£o se voc√™ tocar e segurar na data de publica√ß√£o at√© que apare√ßam as op√ß√µes, mas realmente poderia existir uma UX melhor.

Eu imagino que um bot√£o de copiar o link, que pode ser colocado bem ao lado da data, j√° deve ajudar. O que acha disso?

![image](https://user-images.githubusercontent.com/77860630/235698212-61ba617b-854b-40e4-935e-f35d274123fc.png)

>> Coment√°rio de eduardofaria:
Existe uma API que permite abrir o menu nativo do sistema para compartilhar. Acredito que poderia estar embutido nesse "bot√£o" que mencionou. Se fosse apenas para copiar o link, deveria haver uma mensagem de "link copiado", e o usu√°rio se encarregaria de ir no aplicativo desejado e usar esse dado. Ou, implementar essa API, ex:

Fonte 1: https://w3c.github.io/web-share/
Fonte 2: https://css-tricks.com/how-to-use-the-web-share-api/

```
shareButton.addEventListener('click', event => {
  if (navigator.share) {
    navigator.share({
      title: 'WebShare API Demo',
      url: 'https://codepen.io/ayoisaiah/pen/YbNazJ'
    }).then(() => {
      console.log('Thanks for sharing!');
    })
    .catch(console.error);
  } else {
    shareDialog.classList.add('is-open');
  }
})
```

>> Coment√°rio de Rafatcb:
N√£o sei se esse issue foi aberto inicialmente falando sobre um aplicativo n√£o-oficial do TabNews, mas como houve o coment√°rio sobre usar o "Share" do dispositivo pelo site, √© uma sugest√£o v√°lida para o site.

Dito isso, creio que podemos concentrar a discuss√£o no issue https://github.com/filipedeschamps/tabnews.com.br/issues/813 e levar a sugest√£o do menu nativo para l√°, fechando este issue. Faz sentido?

>> Coment√°rio de Rafatcb:
Bom, estou fechando este issue para concentramos a discuss√£o de compartilhamento no issue #813. Obrigado pela sugest√£o, @eduardofaria! Mencionei o seu coment√°rio l√°.
</issue_1398_App android, n√£o compartilha links dentro da publica√ß√£o>

<issue_1399_Pr√©-visualiza√ß√£o na hora de compartilhar link (n√£o sei se est√° com bug)>
Eu j√° tenho notado isso faz alguns dias (ou semanas?), mas n√£o consigo isolar se √© problema no LinkedIn ou no TabNews. De qualquer forma, n√£o consigo mais compartilhar links com pr√©-visualiza√ß√£o l√° de forma f√°cil. Eu preciso ficar gerando outros links (com outras query strings) para ele ir tentando gerar o preview... e uma hora vai. Antes n√£o tinha esse comportamento.

<img width="561" alt="image" src="https://user-images.githubusercontent.com/4248081/236061524-2d8f72cc-83cc-4ba7-8842-05b63264f702.png">

>> Coment√°rio de filipedeschamps:
Talvez eu encontrei um pattern:

1) Tenta usar o link no LinkedIn, n√£o funciona
2) Usa o share para Whatsapp, que funciona
3) Volta no LinkedIn, o mesmo link agora funciona

>> Coment√°rio de aprendendofelipe:
Apenas para ver se os logs batem, dessa vez (na publica√ß√£o sobre o pr√™mio) deu certo na segunda tentativa?

O LinkedIn precisa acessar a p√°gina para ler as metatags e s√≥ depois acessar o endere√ßo da miniatura. Se n√£o houver cache desses dois na regi√£o do datacenter deles, o LinkedIn vai ter que esperar a gera√ß√£o desses dados (ou a replica√ß√£o dos dados na CDN da Vercel). Ser√° que o LinkedIn n√£o est√° querendo esperar muito?

Cruzando as informa√ß√µes na Cloudflare e no Axiom, aparentemente ainda n√£o existia cache da p√°gina na primeira tentativa do LinkedInBot, pois ele nem chegou a tentar acessar a miniatura. S√≥ que a requisi√ß√£o da p√°gina foi respondida com sucesso em 486ms. Acho que report.durationMs √© s√≥ o tempo dentro da Vercel, ent√£o some a isso a ida e volta de gru para iad. Ent√£o o cache com certeza foi gerado e propagado para iad nesse momento.

J√° na segunda tentativa de obter a p√°gina eles devem ter recebido a resposta j√° do cache, pois logo em seguida requisitaram a miniatura com sucesso.

Diretamente para o endere√ßo da miniatura, fora a requisi√ß√£o do LinkedIn, no mesmo hor√°rio tiveram outras tr√™s, sendo uma que deve ter sido voc√™ compartilhando (ou testando) no WhatsApp e outra testando diretamente no Safari. E s√≥ mais uma que n√£o sei identificar exatamente a origem, mas deve ter sido de algum servi√ßo da Microsoft ou algo hospedado na Azure, mas que tamb√©m teve sucesso na resposta.

> * Tenta usar o link no LinkedIn, n√£o funciona
> * Usa o share para Whatsapp, que funciona
> * Volta no LinkedIn, o mesmo link agora funciona

Acho que o compartilhamento do Whatsapp s√≥ est√° servindo para voc√™ aguardar a propaga√ß√£o do cache na CDN da Vercel, pois, diferente do LinkedIn, ele √© gerado no seu dispositivo.

>> Coment√°rio de aprendendofelipe:
Fiz alguns testes aqui e, aparentemente, √© algo com o pr√≥prio LinkedIn, pois de vez em quando ele simplesmente n√£o faz a requisi√ß√£o para tentar gerar a miniatura.

Cheguei nessa conclus√£o, pois quando n√£o gera de jeito nenhum, tamb√©m n√£o gera nenhum registro na Cloudflare.

Da√≠ quando ele resolve tentar, √†s vezes s√≥ consegue na segunda tentativa.

>> Coment√°rio de filipedeschamps:
Hoje eu compartilhei link e funcionou 100%! Vou continuar monitorando e tentando detectar se tem algum pattern ü§ù

>> Coment√°rio de aprendendofelipe:
> Hoje eu compartilhei link e funcionou 100%! Vou continuar monitorando e tentando detectar se tem algum pattern ü§ù

Talvez pelas p√°ginas estarem sendo geradas de forma mais r√°pida... Talvez!!!
</issue_1399_Pr√©-visualiza√ß√£o na hora de compartilhar link (n√£o sei se est√° com bug)>

<issue_1401_Todos os coment√°rios est√£o em nome do autor da publica√ß√£o>
Os autores dos coment√°rios est√£o sendo trocados para o usu√°rio criador da publica√ß√£o.

![image](https://user-images.githubusercontent.com/50326228/236470396-016adae9-511f-44d9-9393-069de9b5b13d.png)

>> Coment√°rio de aprendendofelipe:
Ol√° @GHCMelo, muito obrigado por reportar! üí™

J√° reverti o √∫ltimo deploy, ent√£o j√° deve ter voltado ao normal üòâ

>> Coment√°rio de filipedeschamps:
Show! üòç  E interessante que os testes n√£o pegaram este comportamento. Ser√° que o endpoint `/children` n√£o foi afetado? Porque nele lembro de ter feito cobertura com dois usu√°rios.

>> Coment√°rio de aprendendofelipe:
> Show! üòç E interessante que os testes n√£o pegaram este comportamento. Ser√° que o endpoint `/children` n√£o foi afetado? Porque nele lembro de ter feito cobertura com dois usu√°rios.

N√£o pegou porque foi um condicional que s√≥ caia quando era buscada a √°rvore toda pelo username e slug. J√° vou subir a corre√ß√£o.

O que acha de criarmos um endpoint na API que busca a √°rvore toda? Acho que vai ser muito √∫til para quem usa a API, al√©m de ajudar a pegar bugs parecidos no futuro?

>> Coment√°rio de filipedeschamps:
Interessante! Acho estranho a API fornecer duas formas similares de construir o conte√∫do (fonte: vozes da minha cabe√ßa).

De qualquer forma, temos que testar o m√©todo com essas condi√ß√µes, mesmo que seja invocando ele direto no teste ü§ù

>> Coment√°rio de aprendendofelipe:
Com certeza precisa de no m√≠nimo um teste de integra√ß√£o, mesmo que fora da API ü§ù

Sobre o endpoint, depois vou rever o hist√≥rico de decis√µes para entender porque est√° tudo separado, pois para mim fazia mais sentido as varia√ß√µes de dados fornecidos para um mesmo conte√∫do serem definidas por par√¢metros da requisi√ß√£o.

At√© porque na maioria dos endpoints abaixo de `/username/slug` s√£o realizadas praticamente as mesmas consultas no banco, mas s√≥ devolvem parte dos resultados. Ent√£o seria muito melhor para quem usa a API poder pedir tudo que precisa de uma s√≥ vez.

>> Coment√°rio de filipedeschamps:
> Sobre o endpoint, depois vou rever o hist√≥rico de decis√µes para entender porque est√° tudo separado, pois para mim fazia mais sentido as varia√ß√µes de dados fornecidos para um mesmo conte√∫do serem definidas por par√¢metros da requisi√ß√£o.

Acho que n√£o tem esse racional anotado (posso estar enganado) ü§ù 


> At√© porque na maioria dos endpoints abaixo de `/username/slug` s√£o realizadas praticamente as mesmas consultas no banco, mas s√≥ devolvem parte dos resultados. Ent√£o seria muito melhor para quem usa a API poder pedir tudo que precisa de uma s√≥ vez.

Bom ponto! Mas as vezes sim e as vezes n√£o, dependendo do client. Pega como exemplo um `content` que possui muitos `children` e a renderiza√ß√£o √© feita em tempo-real (ex. um SPA cl√°ssico ou native). Vai ser uma experi√™ncia melhor rapidamente consultar e trafegar pela rede o conte√∫do principal, e s√≥ depois os `children`.

Isso acontece no caso do reposit√≥rio do curso, onde √© importante eu devolver o conte√∫do com o v√≠deo o mais r√°pido poss√≠vel, e s√≥ depois decidir ou n√£o fazer a consulta pelo resto. Imagina trazer os dois numa mesma request para o `bem-vindo`... apesar do tempo total ser de fato menor para trazer tudo, a UX vai ser pior. Faz sentido?

>> Coment√°rio de aprendendofelipe:
> Acho que n√£o tem esse racional anotado (posso estar enganado) ü§ù

N√£o encontrei mesmo üòï

Isso mesmo, depende de cada caso, por isso faltou eu enfatizar o "poder" pedir tudo de uma vez, mas n√£o ser obrigado a consumir tudo de uma vez. E isso pode ser feito por endpoints diferentes, que √© como est√° feito, mas limita as possibilidades para quem consume a API.

Se tivermos um endpoint com a possibilidade do consumidor informar quais dados precisa, ser√° muito mais flex√≠vel e tamb√©m vai melhorar a performance tanto do backend como dos clients, pois estaria sempre otimizado para cada caso.

Provavelmente compense fazer essa modifica√ß√£o para a v2 da API. üëç

>> Coment√°rio de filipedeschamps:
Ahh entendi seu ponto! Perfeito!!! Poder passar por query string algo como `with_children=true` no `/contents/[username]/[slug]` correto? ü§ù

>> Coment√°rio de aprendendofelipe:
> Ahh entendi seu ponto! Perfeito!!! Poder passar por query string algo como `with_children=true` no `/contents/[username]/[slug]` correto? ü§ù

Ou mais alto ainda, no `/contents`, pois assim n√£o fica limitado ao que est√° dentro de `username` e `slug`.

Eu estava pensando em como fazer os testes lidarem com as novas consultas e me pareceu mais f√°cil migrar tudo que fosse poss√≠vel para elas. E j√° que s√£o mais r√°pidas e flex√≠veis, j√° deixei aberta toda a flexibilidade que eu estava falando sem mudar o contrato atual da API, ou seja, apenas acrescentando possibilidades sem retirar as atuais.

Vejam o PR #1413. E vou fechar essa issue, pois o problema foi resolvido no #1402 ü§ù

>> Coment√°rio de aprendendofelipe:
@GHCMelo voc√™ foi citado no post comemorativo:

https://www.tabnews.com.br/FelipeBarso/tabnews-novo-ranqueamento-otimizacoes-e-mais üéâ
</issue_1401_Todos os coment√°rios est√£o em nome do autor da publica√ß√£o>

<issue_1404_Abrir nova tab ao clicar no link externo do Github no footer>
![image](https://user-images.githubusercontent.com/98969322/236528041-07830100-5cbb-4928-97d2-99a30b4828ae.png)


Ao clicar em Github, o usu√°rio sai da p√°gina Tabnews. Recomendo abrir o github em uma nova tab para que o usu√°rio continua com a p√°gina anterior da Tabnews.

J√° tenho a solu√ß√£o para fazer o PR.

![image](https://user-images.githubusercontent.com/98969322/236527780-d68ddc8b-23f6-42e2-a5d0-ac4ef4637817.png)

>> Coment√°rio de aprendendofelipe:
Ol√° @JMTiburcio, obrigado pela issue. üí™

Chegou a ver o que j√° foi conversado sobre o assunto?

Recomendo ver principalmente esse https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074

Vou fechar essa issue e a conversa pode continuar por l√°. Combinado? ü§ù

>> Coment√°rio de JMTiburcio:
E ae @aprendendofelipe 

N√£o tinha visto ainda.
Interessante que vcs tem uma abordagem diferente.

Valeu pela respota r√°pida!
</issue_1404_Abrir nova tab ao clicar no link externo do Github no footer>

<issue_1405_Todo endpoint com cache na CDN precisa ter um teste provando que o `set-cookie` n√£o est√° sendo enviado>
## Contexto

N√£o podemos enviar um `set-cookie` em respostas cacheadas, pois isso iria compartilhar cookies entre diferentes usu√°rios. Por isso √© importante termos testes que garantam que isso jamais aconte√ßa.

## Execu√ß√£o

Para o endpoint `/user` j√° existem testes que verificam a presen√ßa ou n√£o do `set-cookie` em cada caso. Ent√£o esses testes podem servir como inspira√ß√£o para os testes dos demais endpoints, mas nada impede a cria√ß√£o de testes mais elaborados.
</issue_1405_Todo endpoint com cache na CDN precisa ter um teste provando que o `set-cookie` n√£o est√° sendo enviado>

<issue_1414_[Sugest√£o] Mudan√ßa de contador de coment√°rios para vers√£o mais compacta>
Falaaa pessoal, estava fazendo alguns testes aqui no TabNews e me deparei com um problema com uma quebra do layout em pequenas telas. Na tentativa de corrigir esse problema escrevi uma forma mais compacta de visualiza√ß√£o dos coment√°rios. Eu gostei bastante do resultado e queria saber a opini√£o de voc√™s antes de subir um poss√≠vel PR

### **Atual**
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/85972147/8e798111-a394-4521-9228-b92690e1545a)
### **Sugerido**
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/85972147/bb346816-3d70-4719-a39f-a1f025d9f09e)


### **Atual com quebra do layout**
Agora no mobile: percebam como no post 5 (acontece em outros posts tbm) ele ultrapassar os limites da tela e faz com que haja uma rolagem lateral no site

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/85972147/1aed7cd5-73f4-4d09-a440-364ce6b38ddc)
### **Sugerido**
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/85972147/84e4b60c-2489-4faf-8c7f-5b49e22c2cb8)

>> Coment√°rio de aprendendofelipe:
Ol√° @victorhcb, obrigado pela sugest√£o! üí™

Esse problema tamb√©m est√° me incomodando. Parece que s√≥ ocorre quando tem algum username mais comprido em tela. Ent√£o tinha pensado em usar o [Truncate](https://primer.style/react/Truncate) no username, assim como j√° √© usado no menu do header, mas n√£o cheguei a testar na lista de conte√∫dos.

Tamb√©m precisar investigar melhor o que est√° ocorrendo, pois era para simplesmente quebrar a linha ao inv√©s de quebrar o layout.

Sobre a sugest√£o, talvez ainda ocorra o problema, dependendo do tamanho do username. Mas se com ela resolver, uma op√ß√£o √© usar apenas em telas pequenas. S√≥ que eu achei um pouco estranho esse √≠cone no meio do texto. Talvez ficasse melhor se colocar no final, ap√≥s o tempo de publica√ß√£o, mas para isso precisa resolver outro problema que √© como o tooltip da data lida com overflow.

Ou seja, √© um problema que parece mais simples do que realmente √©, ent√£o a ajuda √© muito bem vinda. üëç

>> Coment√°rio de victorhcb:
Show! Vou estudar melhor e sugerir alguma corre√ß√£o pensando nisso

>> Coment√°rio de Rafatcb:
Ser√° que esse issue pode ser fechado para concentrar a discuss√£o no https://github.com/filipedeschamps/tabnews.com.br/issues/1532 @aprendendofelipe? Eu acabei iniciando uma discuss√£o l√° sem ter lembrado deste, e voc√™ sugeriu uma implementa√ß√£o que n√£o muda a exibi√ß√£o dos coment√°rios mas visa resolver o problema de overflow.

>> Coment√°rio de aprendendofelipe:
Um pouco mais tarde irei fazer o merge do PR #1562, e acredito que ele elimina a necessidade do que foi proposto aqui.

Ent√£o j√° vinculei essa issue e a #1532 para serem encerradas junto com o merge ü§ù
</issue_1414_[Sugest√£o] Mudan√ßa de contador de coment√°rios para vers√£o mais compacta>

<issue_1415_[Sugest√£o de Implementa√ß√£o] Filtro de Conte√∫do>
Permitir que um usu√°rio do tabnews na p√°gina que exibe seus pr√≥prios conte√∫dos https://www.tabnews.com.br/seujorge  consiga filtrar em ver:

* Todos os Conte√∫dos
* Apenas Coment√°rios e Respostas
* Apenas Artigos que publicou

>> Coment√°rio de robsonamendonca:
Sim, concordo um campo de busca no primeiro momento ajuda muito!

>> Coment√°rio de aprendendofelipe:
@jorgerabello3, obrigado pela sugest√£o! üí™

Recomendo centralizar a discuss√£o na #807. üëç

Vou fechar essa duplicada. Combinado? ü§ù
</issue_1415_[Sugest√£o de Implementa√ß√£o] Filtro de Conte√∫do>

<issue_1416_[Sugest√£o de Implementa√ß√£o] Op√ß√£o de seguir (ser notificado quando determinada pessoa publique algo novo)>
√Äs vezes encontro autores fant√°sticos e realmente curto o conte√∫do gostaria de ser notificado sempre que determinado autor publicasse algo novo. 

N√£o seria necess√°rio exibir n√∫meros (exemplo quantos seguidores determinado autor possui) 

Seria legal seguir autores para que cada vez que determinado autor publicasse algo novo eu recebesse uma notifica√ß√£o.

>> Coment√°rio de joaoGabriel55:
Nice!

>> Coment√°rio de Rafatcb:
Jorge, obrigado pela sugest√£o! Estou fechando este issue por termos dois outros issues que abordam esse problema:

1. https://github.com/filipedeschamps/tabnews.com.br/issues/645
2. https://github.com/filipedeschamps/tabnews.com.br/issues/738
</issue_1416_[Sugest√£o de Implementa√ß√£o] Op√ß√£o de seguir (ser notificado quando determinada pessoa publique algo novo)>

<issue_1417_[Sugest√£o de Implementa√ß√£o] Suporte a Diagramas>
Algumas vezes diagramas nos ajudam a entender cen√°rios. 

Seria interessante poder escrever diagramas (principalmente UML e C4 Model).
</issue_1417_[Sugest√£o de Implementa√ß√£o] Suporte a Diagramas>

<issue_1418_[Sugest√£o] Bot√£o reportar para sinalizar algo impr√≥prio ou fora dos padr√µes para os moderadores/administradores.>
Tenho reprado diversos assuntos fora do escopo do site e sinceramente n√£o sei at√© que ponto instruir o usu√°rio pode ser visto como SPAM. Diante disso, brincando com o React (N√£o sou desenvolvedor), cheguei a tela abaixo, um bot√£o de reportar do lado oposto do Responder.

<img width="1042" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/8904414/1ad03a27-4d9a-41fc-9be1-5f1df96b9175">

Na minha humilde concep√ß√£o, o site poderia ter uma coluna com os posts reportados ao qual somente moderadores e admins poderiam ter acesso, atrav√©s de um √≠cone de notifica√ß√£o, que teria um href para cada post reportado. E o processo de exclus√£o seria o mesmo, tendo em vista que ele j√° existe.

Seria interessante definir radio buttons do motivo do report e/ou um textarea, e quem foi o respons√°vel por reportar. Nesse caso precisariamos de uma tabela pra armazenar todas essas infos, certo? Num primeiro momento acredito que uma coluna com os IDs dos posts denunciados seria um primeiro passo.

>> Coment√°rio de aprendendofelipe:
Ol√° @JuanFontes, obrigado pela sugest√£o! üí™

Recomendo centralizar a conversa na issue j√° aberta sobre o assunto #877

Vou fechar essa por ser duplicada. Combinado? ü§ù

>> Coment√°rio de JuanFontes:
Ol√° @aprendendofelipe , agrade√ßo pois n√£o tinha visto essa issue. Vou colocar meus inputs l√°.
</issue_1418_[Sugest√£o] Bot√£o reportar para sinalizar algo impr√≥prio ou fora dos padr√µes para os moderadores/administradores.>

<issue_1422_[Sugest√£o] Implementar bot√£o para copiar snippets de c√≥digo>
Algumas publica√ß√µes (como [essa aqui, por exemplo](https://www.tabnews.com.br/richaardev/oh-my-posh-o-terminal-perfeito-no-windows-e-possivel)) possuem alguns passo-a-passo em formado de *snippets* de c√≥digo.

Esses *snippets* poderiam ter o bot√£o de copiar para a √°rea de transfer√™ncia para facilitar a execu√ß√£o, da mesma forma como temos aqui no Github ou no Stack Overflow.

Exemplo: O snippet abaixo pode ser copiado diretamente para a √°rea de transfer√™ncia, para ser colado no terminal, usando essa implementa√ß√£o j√° feita no Github (clicar no bot√£o no canto direito do *snippet*).
```
echo "ol√° pessoal"
```
</issue_1422_[Sugest√£o] Implementar bot√£o para copiar snippets de c√≥digo>

<issue_1423_[Sugest√£o] separar  'meus conte√∫dos' e  intera√ß√µes>
assim, n√£o sei se j√° fizeram esta sugest√£o, mas me incomoda a p√°gina de meus conte√∫do misturar entre minhas publica√ß√µes e  intera√ß√µes que fiz em posts de terceiros, portanto fica a√≠ a sugest√£o, valeu!

>> Coment√°rio de aprendendofelipe:
@YrllanBrandao, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser duplicada com a #807.

Recomendo centralizar a discuss√£o por l√°. Combinado? ü§ù
</issue_1423_[Sugest√£o] separar  'meus conte√∫dos' e  intera√ß√µes>

<issue_1424_Remover trigger e fun√ß√£o do banco de homologa√ß√£o assim que for poss√≠vel>
Quando n√£o houver mais nenhuma implanta√ß√£o de antes do PR #1421 rodando em homologa√ß√£o, ent√£o poderemos remover o trigger e a fun√ß√£o criados para compatibilizar as cria√ß√µes de conte√∫dos via vers√µes antigas que ainda n√£o preenchem a coluna `path`.

```sql
DROP TRIGGER IF EXISTS update_path_trigger ON contents;
DROP FUNCTION IF EXISTS update_path();
```

>> Coment√°rio de aprendendofelipe:
Tarefa conclu√≠da!
</issue_1424_Remover trigger e fun√ß√£o do banco de homologa√ß√£o assim que for poss√≠vel>

<issue_1430_BUG: Publica√ß√£o n√£o exibida corretamente quando algum coment√°rio √© removido>
J√° percebi isso num outro link que acessei aqui pelo GitHub e n√£o tinha entendido, mas agora "vi com meus pr√≥prios olhos".

Removi um coment√°rio que estava contra os termos de uso, mas antes o respondi com orienta√ß√µes. O que acontece √© que agora ao acessar a [publica√ß√£o raiz](https://www.tabnews.com.br/RomarioFSoares/disponibilizacao-de-livros-didaticos-eng-software), a visualiza√ß√£o √© a mesma de caso estivesse acessando meu [coment√°rio](https://www.tabnews.com.br/rafael/aebcacb7-7de1-4ea5-96b3-7f028cad7d76).

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/cae5408d-5190-4ea3-b4b6-6d3721b11253)


Edit: Encontrei o outro caso que tinha percebido isso: [publica√ß√£o](https://www.tabnews.com.br/DavidBarbieri/qual-melhor-site-para-baixar-livros) e [coment√°rio](https://www.tabnews.com.br/juanfontes/dce20375-6f02-442a-ba77-ff84bee03d2a).

Edit 2: 20 minutos depois, revisitei o primeiro exemplo (que eu removi o coment√°rio) e a publica√ß√£o est√° normal, mas o exemplo da edi√ß√£o anterior ainda est√° com o problema.

>> Coment√°rio de aprendendofelipe:
Solu√ß√£o j√° aplicada em produ√ß√£o!

Muito obrigado @Rafatcb! üí™üí™üí™

>> Coment√°rio de aprendendofelipe:
@Rafatcb, voc√™ foi citado no post comemorativo:

https://www.tabnews.com.br/FelipeBarso/tabnews-6-milhoes-de-visualizacoes-e-muita-novidade üéâ
</issue_1430_BUG: Publica√ß√£o n√£o exibida corretamente quando algum coment√°rio √© removido>

<issue_1432_[SUGEST√ÉO] - Coment√°rios mais votados serem premiados a se tornarem Posts e a ganhar Tabcoins>
A vis√£o geral sobre os coment√°rios, que √© uma das raz√µes de existir o tabnews, s√£o que eles podem ter as vezes mesmo valor ou at√© maior, que o post o qual faz parte.

Coment√°rios as vezes gigantescos, cheios de informa√ß√£o, todavia que pegam menos visibilidade no decorrer do tempo...

Sobre as tabcoins, pegando pela fala do pr√≥prio Filipe Deschamps , visaria ser como um √≥leo, que lubrifica e torna o ecossistema tabnews din√¢mico.

Dito isso, agora a proposta:

**Premiar coment√°rios, se tornando estes a posts e com tabcoins**

Coment√°rios terem uma esp√©cie de meta de tabcoins ou sub coment√°rios √∫nicos, onde batendo isso, este √© repostado como um post principal e ocorrem premia√ß√µes aos que participaram do coment√°rio.

Sendo uma meta hipot√©tica de 8 tabcoins OU 16 subcoment√°rios de usu√°rios √∫nicos (coment√°rios em seu coment√°rio), ao bater, ocorre ao final:

1 - Usu√°rio que deu tabcoin e/ou comentou, recebe 1 tabcoin;
2 - O autor do coment√°rio, recebe at√© 4 tabcoins na medida que forem dados, com os restantes dos tabcoins lhe dados apenas ao final;
3 - O autor do post que estava o coment√°rio, recebe 2 tabcoins, pois foi o iniciador causador do coment√°rio adjacente.

Importante ressaltar: Seria contabilizado apenas 1 tabcoin e coment√°rio, por usu√°rio √∫nico, buscando uma situa√ß√£o de apoio e n√£o de farm. Mais coment√°rios no mesmo post, ainda conta como 1.
Seriam mini alavancas para serem mexidas at√© estarem bem colocadas.

E disto, se ganha que: Bons coment√°rios que foram feitos, mesmo que a meses atr√°s, podem ser alavancados pelo p√∫blico e serem repostados, assim, dando novo oxig√™nio para aquele coment√°rio, que poder√° receber mais coment√°rios e quem sabe, fazendo que outro seja premiado, fazendo a roda girar...

√â um mecanismo que buscaria jogar √≥leo para fazer o sistema girar com mais fluidez.
Possivelmente isto n√£o seria bala de prata, onde outros mecanismos em conjunto dar√£o a fluidez que tanto esperamos para esta rede bacana que est√° formando.

E quanto aos farms de plant√£o, √© a busca constante de ir sanando, at√© que o custo de farmar seja t√£o alta, que n√£o valha a pena o fazer.

E claro, n√£o venho para ser o cara aben√ßoado da raz√£o no meio da discuss√£o haha. Comentem o que acreditam, oxigenem o assunto. Quem sabe surge mais ideias, at√© melhores que esta !

>> Coment√°rio de hkotsubo:
N√£o gosto dessa ideia de repostar o mesmo conte√∫do.

Se a ideia √© dar destaque a conte√∫do que j√° existe, poderia ter uma nova aba (ou ent√£o um combobox com op√ß√µes de ordena√ß√£o), para mostrar os posts ordenados por outro crit√©rio:

- posts com atividade mais recente (seja coment√°rio novo ou editado)
- posts mais votados
- posts com mais coment√°rios 
- etc

Dessa forma, evita-se a redund√¢ncia desnecess√°ria de ter o mesmo conte√∫do duplicado. E cada um escolhe como ordenar, de acordo com o que est√° procurando.

---

Sem contar que postar novamente o mesmo conte√∫do fica confuso. Muitos coment√°rios s√≥ fazem sentido se tivermos o post principal. Sem isso, ficaria ali "jogado" sem contexto.

Outro ponto √© que quantidade de sub-coment√°rios n√£o necessariamente implica em qualidade. Teve uma thread recente com dezenas de respostas, mas a discuss√£o virou um flamewar, com v√°rias ofensas e nada de efetivamente concreto (tanto que foi at√© apagado).

>> Coment√°rio de aprendendofelipe:
@miguelmoroni obrigado por trazer uma sugest√£o! üí™

N√£o acho que esse "pr√™mio" faz sentido. Se o coment√°rio independe do contexto da publica√ß√£o original, o autor decide se cria uma nova publica√ß√£o ou se apenas comenta, assim como voc√™ fez a sugest√£o em outra issue, e depois resolveu abrir essa issue aqui para tratar especificamente da sua sugest√£o. Isso s√≥ poderia ser um pr√™mio se n√£o fosse poss√≠vel fazer de outra maneira, certo?

Devolver TabCoins para quem votou muda completamente a economia, e acho que o resultado seria para ~~melhor~~ pior.

E eu ia citar outros pontos, mas o @hkotsubo j√° foi cir√∫rgico, ent√£o s√≥ refor√ßo o coment√°rio dele. üëç

>> Coment√°rio de migmoroni:
Antes de tudo, obrigado pela participa√ß√£o de voc√™s aqui nesta issue !

Li as duas criticas at√© ent√£o e digo que gostei dos argumentos, concordando que este talvez ainda n√£o seja o caminho ideal.

O seu argumento @hkotsubo, onde diz: "Sem contar que postar novamente o mesmo conte√∫do fica confuso. Muitos coment√°rios s√≥ fazem sentido se tivermos o post principal. Sem isso, ficaria ali "jogado" sem contexto." , diz exatamente um problema novo que isso acabaria por gerar.

E sobre a organiza√ß√£o dos posts, para encontrar mais r√°pido, selecionar os mais votados, etc, acompanho que j√° √© um pedido antigo e grande pela comunidade, o que me coloco junto a apoiar. Isso ajudaria em muito a oxigenar a comunidade !

Mas da√≠ √© papo para outra issue...

>> Coment√°rio de aprendendofelipe:
@migmoroni, de acordo com sua resposta, ent√£o j√° vou fechar a issue, mas qualquer coisa √© s√≥ reabrir. Combinado! ü§ù
</issue_1432_[SUGEST√ÉO] - Coment√°rios mais votados serem premiados a se tornarem Posts e a ganhar Tabcoins>

<issue_1435_[Sugest√£o / Feature] Tempo estimado de leitura>
Acho que seria interessante implementar feature de tempo estimado de leitura para uma publica√ß√£o, algo bem clean mais ou menos nessa linha:
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77870325/6705c9b2-900e-4dd9-bd7a-71cab26e57c9)

>> Coment√°rio de migmoroni:
√â uma boa ideia. Acredito que melhor ainda, se houver dois mostradores:

1- Houver um para o post;
2- E outro ao lado, incluindo os coment√°rios, crescendo a cada vez que cresce a quantidade.

Ajuda a filtrar quais ver primeiro, quais se possui j√° um tempinho para ler grande parte.

>> Coment√°rio de silvaezequias:
@JoandersonPaiva Cara, ideia muito bem colocada. Inclusive, eu estava pensando em implementar um sistema desses junto ao TextToSpeech que eu implementei nesse PR #1434. De alguma forma usar essa ferramenta para calcular o tempo lido, n√£o sei se seria preciso mas √© uma forma.

>> Coment√°rio de vladimiremi:
@silvaezequias Acabei de olhar a PR #1434. Achei sensacional a sua implementa√ß√£o e at√© fiz alguns testes aqui. S√≥ que acho que para determinar o tempo de leitura, pode ser mais simples apenas calcular a quantidade de palavras e fazer uma m√©dia disso. 

Uma pessoa com ritmo normal consegue ler de 200 a 400 palavras por minuto. Com base nisso, d√° pra chegar em um n√∫mero aproximado do tempo necess√°rio.

>> Coment√°rio de RobertDS07:
Ta rolando a cria√ß√£o dessa feat [aqui](https://github.com/filipedeschamps/tabnews.com.br/pull/1445)

>> Coment√°rio de JoandersonPaiva:
Caramba turma, vlw pelos coment√°rios! andei um pouquinho ocupado por aqui haha

> Ta rolando a cria√ß√£o dessa feat [aqui](https://github.com/filipedeschamps/tabnews.com.br/pull/1445)

@RobertDS07 que dahora! j√° foi at√© para produ√ß√£o!! com isso ser√° que j√° podemos fechar essa issue ent√£o?

>> Coment√°rio de aprendendofelipe:
Por enquanto s√≥ foi implementado na p√°gina do conte√∫do. Seria legal mostrar tamb√©m na lista de conte√∫dos, mas tem duas complexidades extras:

1. Na lista de conte√∫dos n√≥s n√£o temos o `body`, ent√£o teria que mudar as consultas para poder computar o tempo de leitura. N√£o precisa retornar o `body` para o `client`, mas precisa pelo menos obter dentro de `getStaticProps` e computar o tempo de leitura ali mesmo, retornando via `props`.
2. Precisa modificar o design da lista de conte√∫dos, pois vai faltar espa√ßo na vers√£o mobile.

>> Coment√°rio de kenionatan:
@aprendendofelipe neste primeiro ponto, voc√™ sugere que o tempo seja computado antes da p√°gina do conte√∫do, na lista mesmo, e passar pra o conte√∫do em seguida?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe neste primeiro ponto, voc√™ sugere que o tempo seja computado antes da p√°gina do conte√∫do, na lista mesmo, e passar pra o conte√∫do em seguida?

@kenionatan, n√£o √© isso n√£o!

No ponto 1 eu s√≥ estou dizendo que na lista de conte√∫dos precisa ser diferente do que foi feito na p√°gina de conte√∫do.

Nas p√°ginas que listam conte√∫dos, como n√£o temos o texto do corpo dos conte√∫dos, a gente precisa calcular o tempo de leitura no servidor, e n√£o no navegador.
</issue_1435_[Sugest√£o / Feature] Tempo estimado de leitura>

<issue_1437_[Sugest√£o] Realizar um "zoom" nas imagens ao clicar sobre elas para terem maior destaque>
Seria interessante adicionar a mesma feature que o [Medium](https://medium.com) e outras plataformas possuem.


https://github.com/filipedeschamps/tabnews.com.br/assets/36301054/fd5a51f4-de89-41b8-8f2e-55f1d0bee6b9

>> Coment√°rio de aprendendofelipe:
@zehguilherme, obrigado pela sugest√£o! üí™

Me parece mais limitado do que a possibilidade atual, em que j√° √© poss√≠vel ajustar o zoom da forma que achar melhor, n√£o sendo limitado a dois tamanhos. No celular √© s√≥ usar o movimento de pin√ßa.

>> Coment√°rio de LucasBPalacios:
Ol√°, sou novo por aqui. Estou querendo fazer essa issue como minha primeira. Mas j√° estou tendo problemas na hora de criar uma publica√ß√£o em ambiente de desenvolvimento e colocar uma imagem. Ela fica desse jeito:
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/80708595/2fcdd2fd-39e8-43c0-9799-cfa2c346ef0b)
Dei uma procurada bem r√°pida e n√£o consegui ajeitar. Se puderem me ajudar agrade√ßo.

>> Coment√°rio de aprendendofelipe:
> Estou querendo fazer essa issue como minha primeira.

@LucasBPalacios, obrigado pela disposi√ß√£o üí™

Vou fechar essa issue porque j√° √© poss√≠vel dar zoom de forma livre em qualquer p√°gina de conte√∫do, consequentemente √© poss√≠vel dar zoom em qualquer imagem. ü§ù

---

Sobre a d√∫vida, o problema n√£o parece ter rela√ß√£o com o ambiente de desenvolvimento, mas sim em como exibir imagens usando markdown. A imagem precisa estar acess√≠vel no endere√ßo que voc√™ forneceu, por exemplo:

```
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/80708595/2fcdd2fd-39e8-43c0-9799-cfa2c346ef0b)
```
</issue_1437_[Sugest√£o] Realizar um "zoom" nas imagens ao clicar sobre elas para terem maior destaque>

<issue_1438_Brainstorming de TabCoins>
Issue para debatermos ideias de melhorias na mec√¢nica das TabCoins.

Podem ser sugeridas quaisquer ideias, mas, quando poss√≠vel, deem uma boa refletida sobre a viabilidade da sugest√£o, aprofundem o m√°ximo poss√≠vel a explica√ß√£o de como funcionaria e digam quais seriam os impactos esperados, assim como poss√≠veis efeitos colaterais. Caso a regra seja incompat√≠vel com outras regras, tamb√©m √© interessante cit√°-las.

Levem em considera√ß√£o que:

* Precisamos manter a qualidade das qualifica√ß√µes, garantindo um m√≠nimo de crit√©rio ao classificar algo como relevante ou n√£o relevante;
* Autores de conte√∫dos mais bem qualificados devem receber mais TabCoins do que os demais;
* N√£o podemos facilitar o abuso do servi√ßo e deve ser poss√≠vel identificar qualquer tentativa de ganho indevido de TabCoins.

>> Coment√°rio de aprendendofelipe:
Ideia:
Qualifica√ß√£o consumir apenas 1 TabCoin de quem s√≥ possui 1 TabCoin.

Impactos esperados:
* Desestimular o ac√∫mulo de TabCoins.
* Aumento da capacidade de qualifica√ß√£o por quem publica em menor quantidade.
* Aumento no volume geral de qualifica√ß√µes.

Efeitos colaterais:
* Poss√≠vel desest√≠mulo √† cria√ß√£o de conte√∫dos de melhor qualidade.
* Aumento na facilidade de abuso.

Deve ser f√°cil de implementar.

>> Coment√°rio de aprendendofelipe:
Ideia: Dar TabCoins para usu√°rios que cumprirem certos objetivos.

Impactos esperados:
* Refor√ßo de comportamentos ben√©ficos ao sistema.
* Dar a capacidade de qualificar conte√∫dos para quem n√£o est√° criando conte√∫dos, mas est√° ajudando o TabNews de outras formas.

A ideia abre margem para diversas outras ideias de objetivos poss√≠veis, por exemplo:
* Manter frequ√™ncia de acesso ao site.
* Utilizar pelo menos X% dos TabCoins que possuir a cada Y per√≠odo de tempo.
* Para novos usu√°rios, pode ser exigida a leitura dos termos.

Essa ideia n√£o deve ser f√°cil de implementar.

>> Coment√°rio de aprendendofelipe:
Ideia: N√£o limitar quantidade de votos (ou limitar em um n√≠vel maior do que 1).

Impactos esperados:
* Dar aos usu√°rios a possibilidade de retribuir de maneira diferente os diferentes tipos de conte√∫dos que encontrarem no TabNews.
* Desestimular a supervaloriza√ß√£o dos votos, que √© quando usu√°rios que n√£o querem dar a mesma quantidade de TabCoins para conte√∫dos menos e mais relevantes, acabam votando apenas nos mais relevantes, o que diminui a quantidade de votos.

Efeitos colaterais:
* √â uma mudan√ßa forte na din√¢mica das qualifica√ß√µes, que imagino ser para melhor, mas que existe o risco de ser para pior.

Regras incompat√≠veis:
* Qualquer regra que facilite demais o ganho de TabCoins e que permita descarregar votos sem crit√©rios em quaisquer conte√∫dos.

F√°cil de implementar, sendo s√≥ reverter a implementa√ß√£o do limite de publica√ß√µes a cada 72h, ou aumentar esse limite.

>> Coment√°rio de natanael-b:
### Presun√ß√£o de boa f√©:

Ideia: 
 - Em conte√∫do root sempre somar ao menos 1 Tab Coin, para coment√°rios mantenha a regra atual
 - Se um usu√°rio que contribui para a comunidade e tem uma boa reputa√ß√£o dar down vote tendo o post n√£o recebido qualifica√ß√£o:
   - Desconte a Tab Coin ganha por quem fez o post
   - N√£o diminua o contador do post
   - Subtraia  apenas 1 Tab Coin de quem fez a qualifica√ß√£o

Efeitos esperados:
  - Mais publica√ß√µes, combinado com a regra atual pode estimular a buscar maior qualidade ao postar
  
Efeitos colaterais:
  - Um aumento leve de posts de bots tentando explorar nos primeiros dias
  
Regras incompat√≠veis:
  - Talvez seja complicado nos primeiros dias identificar tentativas de abuso
  
Provavelmente F√°cil de implementar, n√£o avaliado baseado na conclus√£o de https://github.com/filipedeschamps/tabnews.com.br/issues/1438#issuecomment-1579355441

>> Coment√°rio de avidadearthur:
### E se os votos positivos fossem um investimento que retornasse TabCoins aos usu√°rios?

O problema de como estimular votos positivos est√° presente at√© em plataformas maiores, como o Stack Exchange, que discute algo parecido no post ["Why aren't people voting for questions?"](https://meta.stackexchange.com/questions/9508/why-arent-people-voting-for-questions).

Uma ideia para combater a no√ß√£o de "perder" TabCoins ao votar positivamente √© organizar o **sistema de vota√ß√£o como um investimento ou empr√©stimo ao autor do post**.

Inicialmente, posts com pouco engajamento teriam pouco valor, e o usu√°rio s√≥ receberia o investimento de volta proporcionalmente a uma f√≥rmula como a seguinte:

$$ \text{Retorno} = \frac{\text{Taxa de Engajamento Atual} \times \text{Quantidade Total de Votos no Momento do Voto}}{\text{f(Tempo Desde o In√≠cio do Post) + Quantidade Total de Votos Atualmente}} $$

Em outras palavras, os usu√°rios que encontrarem bons posts cedo e votarem neles ter√£o um bom retorno, √† medida que o post atrai coment√°rios e visualiza√ß√µes. No entanto, para limitar os ganhos de uma forma justa, conforme o post se torna mais popular, o "lucro/juros" gerado para quem votou diminuiria. Al√©m disso, para evitar que posts antigos e muito populares monopolizem os votos e o feed dos usu√°rios, os "lucros/juros" poderiam diminuir proporcionalmente a uma fun√ß√£o do tempo $\text{f(Tempo Desde o In√≠cio do Post)}$.  

Essa f√≥rmula √© apenas um esbo√ßo para ilustrar a ideia. Seria importante pesquisar mais a fundo na literatura sobre algoritmos semelhantes e, o mais importante, implementar essa ideia na plataforma para avaliar os resultados obtidos.

Dei uma googlada r√°pida e encontrei algumas plataformas que utilizam ideias semelhantes de retorno/investimento em intera√ß√µes:

1. Steemit: Uma plataforma de m√≠dia social baseada em blockchain, na qual os usu√°rios podem receber recompensas em criptomoedas (Steem) por meio de votos e intera√ß√µes em conte√∫dos de qualidade.
2. Reddit Community Points: O Reddit est√° experimentando um sistema de pontos baseado em blockchain em algumas de suas comunidades, no qual os usu√°rios podem ganhar e gastar esses pontos com base em seu envolvimento e qualidade de conte√∫do.

#### Impactos esperados:
- Aumento da intera√ß√£o e participa√ß√£o ativa dos usu√°rios nos posts, resultando em maior qualidade e variedade de conte√∫do.
- Est√≠mulo ao crescimento da comunidade, uma vez que os usu√°rios s√£o recompensados pelo seu envolvimento.

#### Efeitos colaterais:
- Potencial aumento na competi√ß√£o por votos, levando a estrat√©gias question√°veis para obter vantagens no sistema.
- Possibilidade de manipula√ß√£o dos resultados por meio de pr√°ticas fraudulentas, como a cria√ß√£o de contas falsas ou uso de bots para influenciar os votos.

O que voc√™s acham?

>> Coment√°rio de Gabriel-Tapes:
Ideia: Tabcoins expirarem se muito tempo sem movimenta√ß√£o

A fim de evitar muito acumulo de tabcoins e insentivar a cria√ß√£o de novos conte√∫dos com relev√¢ncia. Para isso funcionar ter√≠amos que partir de duas premissas:

1. Facilidade de conseguir tabcoins
2. Facilidade de votar

Pr√≥s:

- Deixaria o site mais din√¢mico
- Aumentaria a quantidade de votos
- Incentivaria a cria√ß√£o de conte√∫dos por conta do aumento nos votos

Contras:
- Poderia deixar as tabcoins mais escassas
- Dificuldade de monitorar a expira√ß√£o das Tabcoins
- Poderia desanimar alguns usu√°rios

Atualmente o grande problema no acumulo das Tabcoins √© que o Tabcash n√£o serve para nada ainda, isso faz com que inconscientemente os usu√°rios guardem as suas tabcoins e optem por n√£o votar em ningu√©m. Tornando as Tabcoins um recurso que tem validade faria com que esses usu√°rios que t√™m muitas reservas votarem. O grande problema √© que n√£o haveria uma recompensa concreta, tendo em vista que a funcionalidade pensada para o tabcash ainda n√£o foi implementada.

>> Coment√°rio de hkotsubo:
> Tabcoins expirarem se muito tempo sem movimenta√ß√£o

Outra situa√ß√£o ruim que pode acontecer: eu percebo que tenho muitos TabCoins expirando hoje, e come√ßo a votar em qualquer coisa, s√≥ para n√£o perd√™-los. Ou seja, pode estimular votos sem muito crit√©rio.

Quanto a monitorar a expira√ß√£o, de fato precisaria de uma tela para cada um gerenciar seus TabCoins, mostrando quando/quanto cada um vai expirar, etc.

>> Coment√°rio de FilipeRicardo:
**Ideia:**
Remunerar a audi√™ncia com Tabcoins. Se o usu√°rio acessar x dias consecutivos, e consumir  um n√∫mero x de artigos por dia, ganha x tabcoins.

**Impactos esperados:**
Aumento dos acessos no Tabnews e consequentemente do engajamento,  fidelizando o usu√°rio leitor, e garantindo √† ele um pouquinho de voz ao poder qualificar as postagens, mesmo que s√≥ algumas. Nem todos os usu√°rios contribuem com postagens, e s√≥ lendo e comentando eles est√£o exclu√≠dos da economia do Tabnews.

**Efeitos colaterais:**
Poss√≠vel aumento de acessos robotizados para tentar burlar essa premia√ß√£o, que exigir√° um mecanismo para validar se esses acessos s√£o realmente reais, embora seja muito mais trabalhoso fazer e manter esses bots do que ganhar Tabcoins com uma postagem.

>> Coment√°rio de gpoleszuk:
### Contextualizando

Trocando algumas palavras com o [Rafatcb](https://github.com/Rafatcb) (no Tabnews [rafael](https://www.tabnews.com.br/rafael)) em algo que acabou se tornando uma [_thread_ invis√≠vel](https://www.tabnews.com.br/gpoleszuk/95231b06-51a1-4f68-a179-d6e04e6a33ab) (o autor removeu a publica√ß√£o :\ e eu continuei a escrever :) ) discut√≠amos minhas d√∫vidas referente a contabiliza√ß√£o de votos, quanta riqueza tem sido criada no Tabnews. Ou seja, se as _coins_ s√£o criadas com base nos conte√∫dos criados/avaliados, aparentemente n√£o h√° limite para cria√ß√£o das tab[cash|coins], sendo algo que talvez fosse necess√°rio pensar no futuro, um aspecto que o Rafael tamb√©m constatou ap√≥s essa troca de perguntas/respostas. Como sugest√£o do Rafael, ficaria melhor compartilhar aqui os _insights_ que, por coincid√™ncia, j√° tem uma _thread_ parecida aberta aqui na forma de um _brainstorm_ pelo [aprendendofelipe](https://github.com/aprendendofelipe). Tentarei ser breve.

### D√∫vida
Existe alguma maneira de obter uma lista de todos os logins de usu√°rio de maneira que seja poss√≠vel fazer um "wget" de todas as p√°ginas de perfil de cada um? Nelas figuram as moedas que possuem e, com tais informa√ß√µes, pode-se saber quanto √© o montante circulante assim como √© feito pelo [Banco Central](https://www.bcb.gov.br/cedulasemoedas/dinheirocirculacao), por exemplo. Talvez algum desenvolvedor que entenda desses assuntos possa opinar a respeito do valor da moeda que est√° sendo criada (lastro, valor), mas meu interesse √© apenas entender como √© a din√¢mica de cria√ß√£o de um ativo. E ainda, caso cada _coin_ esteja identificada por algum _id_, n√∫mero de s√©rie (assim como temos nas c√©dulas em papel), √© poss√≠vel tra√ßar o seu caminho, ou seja, as transa√ß√µes entre o gerador de coins do Tabnews e seus usu√°rios e entre usu√°rios (talvez aqui valha uma aten√ß√£o para a privacidade).

### Opini√£o contr√°ria e sugest√£o

N√£o concordo, em parte, estabelecer validade para os "cr√©ditos", por diferentes motivos j√° citados, mas se h√° interesse em evitar o ac√∫mulo de _coins_, pode-se criar uma mec√¢nica de d√©bito como se fosse um custo de manuten√ß√£o (que realmente existe e √© por m√™s no bolso dos mantenedores do projeto: hospedagem, firewall, etc. e principalmente tempo) na ordem de mil√©simos de tab[cash|coins] em fun√ß√£o do tamanho da publica√ß√£o (bytes) debitado no instante da postagem (n√£o pensei como lidar com as edi√ß√µes posteriores que alteram o comprimento do texto em bytes, mas talvez fosse debitado alguns microcoins (_utabcashs_, _utabcoins_) por edi√ß√£o extra), estimulando o poder de s√≠ntese e gera√ß√£o de texto com qualidade com o m√≠nimo de edi√ß√µes. Por cobrar mil√©simos por bytes, novos usu√°rios ficariam com um d√©bito irris√≥rio na plataforma at√© come√ßarem a produzir seus dois ou tr√™s primeiros _posts_.

### Devaneios

Como seriam chamados os mil√©simos de _coins_ assim como fizeram no caso do bitcoin (existem 100 milh√µes de satoshis (sats) em um bitcoin)? No caso do Tabnews, seriam dois nomes para as fra√ß√µes, um para os microtabcashs e outro para os microtabcoins.
Outro detalhe: nem imagino o que vai acontecer no banco de dados caso estejam armazenando inteiros. Se a ideia pegar, bastaria multiplicar por 1000 todo ativo registrado como inteiros.
</issue_1438_Brainstorming de TabCoins>

<issue_1442_Adicionar funcionalidade de text-to-speech ao site>
Ol√°, eu implementei uma funcionalidade de text-to-speech usando a Web Speech API que permite aos usu√°rios ouvir os conte√∫dos do site em vez de l√™-los. Eu acho que isso pode ser √∫til para pessoas com dificuldades de leitura ou que preferem consumir conte√∫do em √°udio. Eu gostaria de saber se h√° interesse em adicionar essa funcionalidade ao projeto e se h√° alguma sugest√£o de melhoria.

Eu criei um pull request com o c√≥digo que eu fiz: https://github.com/filipedeschamps/tabnews.com.br/pull/1434

Aqui est√° um v√≠deo mostrando como funciona: https://www.youtube.com/watch?v=8f2scawfOGo

Aqui est√° o link para quem quiser testar: https://tabnews-git-fork-silvaezequias-text-to-speech-tabnews.vercel.app/

>> Coment√°rio de mthmcalixto:
@silvaezequias como est√° indo essa implementa√ß√£o?

>> Coment√°rio de aprendendofelipe:
Aproveitando que o assunto voltou a ser abordado na #1640, voc√™s acham que realmente vale a pena implementar? Eu acho que n√£o vale a pena.

Quem depende totalmente dessa acessibilidade j√° possui softwares apropriados para isso.

E quem s√≥ quer poder ouvir os conte√∫dos enquanto faz alguma outra coisa, tamb√©m tem dispon√≠vel ferramentas como o "Ler em voz alta" do Edge, que j√° funciona muito bem com o TabNews. E mesmo que seja uma ferramenta muito mais simples do que os softwares de acessibilidade, j√° √© algo que exigiria bastante esfor√ßo para uma implementa√ß√£o pr√≥pria com boa UX.

Esse esfor√ßo com implementa√ß√£o, revis√£o e manuten√ß√£o pode ser melhor utilizado para outras funcionalidades que ainda est√£o pendentes, como as da Milestone 7 (#1490).

Podemos encerrar essa issue?

>> Coment√°rio de PedroHenriqueM01:
Desculpe a demora, decidi tirar umas "F√©rias", mas enfim, eu sei que existem softwares leitores de tela para cegos, mas as pessoas hoje em dia tem a aten√ß√£o igual ou inferior a um peixe de aqu√°rio, essa issue n√£o seria para os cegos (j√° que os mesmos possuem softwares que o auxiliam) essa issue seria mais uma adapta√ß√£o aos dias modernos
</issue_1442_Adicionar funcionalidade de text-to-speech ao site>

<issue_1446_Tabcoins Negativas>
Hoje eu resolvi fazer um teste e ir apagando alguns posts para ver se era poss√≠vel ter tabcoins negativas e atestei que realmente acontece. Fui excluindo alguns posts mais antigos at√© chegar ao saldo de -6 tabcoins. 

√â poss√≠vel ver isso diretamente pela API: https://www.tabnews.com.br/api/v1/users/gabrielTapes

N√£o sei se esse era um comportamento esperado, nem se acontece nos casos de downvotes. Caso seja um comportamento normal e esperado apenas me avisem que irei fechar a issue.

>> Coment√°rio de aprendendofelipe:
Ol√° @Gabriel-Tapes, √© o comportamento esperado sim, pois o saldo pode ficar negativo se os d√©bitos forem maiores do que os cr√©ditos de TabCoins.

E os d√©bitos ocorrem ao receber votos negativos, mas tamb√©m ao apagar algum conte√∫do que tinha lhe rendido TabCoins.

Se voc√™ apagar conte√∫do que lhe rendeu TabCoins, voc√™ est√° retirando do sistema um conte√∫do com valor concreto, ent√£o voc√™ devolve todos os TabCoins que ganhou com esse conte√∫do. Caso j√° tenha utilizado eles, vai ficar negativo mesmo. Deve ter sido isso que ocorreu no seu caso. üëç

O usu√°rio ficar com saldo negativo n√£o impede de fazer novas publica√ß√µes e recuperar esse saldo caso que ficou "devendo".

O que √© diferente de manter conte√∫dos negativados, que nesse caso podem impedir as novas publica√ß√µes.

Em resumo, √© assim para incentivar que sejam exclu√≠dos apenas os conte√∫dos negativados, e sejam mantidos os bem qualificados, pois mesmo os conte√∫dos antigos continuam recebendo acessos se possu√≠rem valor concreto.
</issue_1446_Tabcoins Negativas>

<issue_1447_Ativar aba `discussions` no reposit√≥rio>
Recentemente estive com algumas d√∫vidas quanto a implementa√ß√£o de algumas coisas no projeto, porem n√£o queria fazer uma postagem sobre no site, pra n√£o encher de "[ajuda] ‚Ä¶", acho que o lugar de tirar essas d√∫vidas √© aqui no reposit√≥rio.

Porem n√£o queria abrir uma issue s√≥ pra tirar essas minhas d√∫vidas, n√£o estou propondo nem relatando nada, quero s√≥ entender melhor algumas coisas de implementa√ß√£o.

Dito isso, acho que a aba `discussions` aqui do Github seria o local ideal para esse tipo de coisa, porque n√£o ativ√°-lo?

>> Coment√°rio de mateusfg7:
Vi que √© uma pergunta repetida, e que o @filipedeschamps j√° at√© [respondeu](https://github.com/filipedeschamps/tabnews.com.br/issues/480#issuecomment-1182525179) anteriormente, irei fechar kkkk

Outras issues sobre:
- https://github.com/filipedeschamps/tabnews.com.br/issues/1248
- https://github.com/filipedeschamps/tabnews.com.br/issues/598
- https://github.com/filipedeschamps/tabnews.com.br/issues/1111
- https://github.com/filipedeschamps/tabnews.com.br/issues/1072
</issue_1447_Ativar aba `discussions` no reposit√≥rio>

<issue_1448_[SUGEST√ÉO] - Links dos conte√∫dos abrirem em outra aba.>
Os links que dos conte√∫dos dos posts s√£o abertos na mesma **p√°gina**, sugest√£o para que abra em outra **TAB**.
@filipedeschamps

>> Coment√°rio de aprendendofelipe:
Ol√° @tarciofranco, obrigado pela sugest√£o!

Mas como o TabNews usa o Next.js, ou seja, no fundo funciona como uma SPA, n√£o faz nenhum sentido abrir novas abas para mostrar conte√∫dos que, na maioria das vezes, j√° est√£o em mem√≥ria. Se abrir em nova aba, parte dos dados que j√° est√£o dispon√≠veis ter√£o que ser baixados novamente, enquanto a navega√ß√£o na mesma aba √© quase instant√¢nea.

E se voc√™ ler esse https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074 do Filipe, ver√° que n√£o √© interessante nem mesmo para links externos.

Vou encerrar a issue, mas qualquer coisa √© s√≥ reabrir. Combinado? ü§ù

>> Coment√°rio de tarciofranco:
@aprendendofelipe , TMJ! üëç
</issue_1448_[SUGEST√ÉO] - Links dos conte√∫dos abrirem em outra aba.>

<issue_1449_[Feature] - Tags e sistema de categorias>
Ol√° a todos os usu√°rio e contribuidores do TabNews!
√â a primeira vez que contribuo para a plataforma e gostaria de deixar uma sugest√£o que ao meu ver traria um grande n√∫mero de usu√°rios.
Vejo o TabNews como uma grande iniciativa e aplica√ß√£o, por√©m, acho o uso muito dif√≠cil gra√ßas a baixa categoriza√ß√£o da mesma.
Minha sugest√£o seria implementar um sistema de "tags" ou categorias que auxiliassem o usu√°rio na hora de buscar o conte√∫do que deseja ou at√© mesmo um sistema de comunidade onde seria poss√≠vel filtrar melhor aquilo que o usu√°rio prioriza na hora que buscar um post. 
Exemplo seria o que me ocorreu esses dias atr√°s, gostaria de buscar algo relacionado a Web 3 e tenho certeza que temos muitos Devs, especialista ou iniciantes na √°rea que agregariam muito a minha pesquisa no TabNews, por√©m, n√£o consigo filtrar o conte√∫do dispon√≠vel o que acaba por dificultar o uso da plataforma.

Me ponho a disposi√ß√£o para auxilia no que conseguir e agrade√ßo imensamente ao Filipe Deschamps pela iniciativa e a todos que contribuiram, isso √© muito importante para a comunidade Dev. :)

>> Coment√°rio de silvaezequias:
#742

>> Coment√°rio de aprendendofelipe:
Ol√° @VinTesta, obrigado pela sugest√£o! üí™

Como o @silvaezequias j√° mencionou, ela √© duplicada, ent√£o vou fechar essa aqui e recomendo continuar a discuss√£o pela #742.

Combinado? ü§ù

>> Coment√°rio de VinTesta:
> Ol√° @VinTesta, obrigado pela sugest√£o! üí™
> 
> Como o @silvaezequias j√° mencionou, ela √© duplicada, ent√£o vou fechar essa aqui e recomendo continuar a discuss√£o pela #742.
> 
> Combinado? ü§ù

Perfeito! Muito obrigado!
</issue_1449_[Feature] - Tags e sistema de categorias>

<issue_1450_Api Pix>
Ol√°! üëçAPI banc√°ria que faz Pix, consulta saldo e etc para desenvolvedores. Sem taxa alguma e suporte por WhatsApp.

https://apidoc.b2ubank.com/

PJ e PF, ambos sem limites de transfer√™ncia. 

√ìtima para integrar no seu software. üòè
</issue_1450_Api Pix>

<issue_1451_Alterar provedor de email transacional de Mailgun para Resend>
@aprendendofelipe olha que interessante: o @zenorocha fez um convite para patrocinar o uso do https://resend.com/ no TabNews

https://www.tabnews.com.br/zenorocha/2762522d-6dbe-4f2c-a72d-591fa7061cc1

Vamos fazer um teste? Vai ser uma ajuda de ambos os lados, pois hoje pagamos `USD 35` mensais o que d√° mais ou menos `BRL 2.000` anuais... e podemos devolver testando o servi√ßo para valer, encontrando bugs, etc.

@zenorocha o convite ainda est√° de p√©? ü§ù

>> Coment√°rio de aprendendofelipe:
Bora @filipedeschamps e @zenorocha! üöÄ

>> Coment√°rio de RobertDS07:
Voaaa :rocket:

>> Coment√°rio de mthmcalixto:
@filipedeschamps Acho que ser√° incr√≠vel, as tecnologias mudam toda hora!

>> Coment√°rio de aprendendofelipe:
Fala @zenorocha, tudo bem?

Na semana passada eu estava analisando como configurar o TabNews para usar o [Resend](https://resend.com/), mas deixei para depois porque vi que a compatibilidade com SMTP estava em beta e que, para usar a biblioteca [`resend`](https://resend.com/docs/send-with-nodejs), a gente precisaria adequar nossos testes de integra√ß√£o e tamb√©m precisaria usar algum `Request Catcher` para conseguir realizar alguns fluxos em modo de desenvolvimento (hoje usamos o `mailcatcher` em um cont√™iner).

Mas hoje percebi que o aviso de que o SMTP estava em beta n√£o consta mais na [documenta√ß√£o do Resend](https://resend.com/docs/send-with-smtp). N√£o encontrei nenhum an√∫ncio sobre isso, apenas o [v√≠deo](https://www.youtube.com/watch?v=xBh_F7O6rEQ) em que voc√™s comentam que a compatibilidade iria chegar em breve.

Usando SMPT n√≥s podemos migrar de servi√ßo de email simplesmente trocando as vari√°veis de ambiente. Inclusive j√° est√° rodando com o Resend nesta branch de homologa√ß√£o:

https://tabnews-3rhx8kmom-tabnews.vercel.app/FelipeBarso/2adaa2d5-014f-4f22-8f58-53dd452a3e49

Ent√£o tenho duas d√∫vidas:

1. O Resend j√° est√° oficialmente compat√≠vel com SMTP e podemos usar em produ√ß√£o?
2. Existe alguma vantagem em migrar para a biblioteca `resend`, mesmo com todas as adequa√ß√µes necess√°rias, ou teremos o mesmo resultado se continuarmos com o `nodemailer`?

[Edit] Deixando mais claro, minha d√∫vida 2 √© sobre a diferen√ßa no servi√ßo (REST vs SMTP), n√£o √© sobre as abstra√ß√µes da biblioteca. üòâ

Muito obrigado!

>> Coment√°rio de aprendendofelipe:
Com a publica√ß√£o do [v√≠deo de hoje sobre a integra√ß√£o com SMTP](https://www.youtube.com/watch?v=MM1JE6-inmc), podemos ficar tranquilos em usar o Resend com o `nodemailer`.

@zenorocha, s√≥ resta uma d√∫vida, o [convite](https://www.tabnews.com.br/filipedeschamps/resend-nova-plataforma-de-email-criada-por-um-brasileiro-zeno-rocha#:~:text=Super%20toparia%20patrocinar%20o%20uso%20de%20Resend%20pela%20TabNews%20se%20voc%C3%AAs%20quiserem) ainda est√° de p√©? 

O @filipedeschamps pode confirmar, mas acredito que estamos enviando cerca de 6.000 e-mails/m√™s

>> Coment√°rio de filipedeschamps:
Isso, pr√≥ximo de 6k ü§ù 

## Gr√°fico de `30` dias

<img width="1489" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/87cc8337-cc35-44f0-8994-950edec44f39">

<img width="393" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/94d638fb-6674-4a4f-bc88-fc12af9ac73c">

## Gr√°fico de `90` dias

<img width="1490" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/474d4c11-cf62-420a-b5a6-0dbf66fa267a">

>> Coment√°rio de zenorocha:
Oi pessoal,

Desculpa a falta de aten√ß√£o, fazia tempo que eu n√£o olhava as minhas GitHub Notifications.

Enfim, o convite t√° de p√© sim! Qual √© o melhor email pra eu enviar as instru√ß√µes pra voc√™s?

>> Coment√°rio de aprendendofelipe:
> Enfim, o convite t√° de p√© sim! Qual √© o melhor email pra eu enviar as instru√ß√µes pra voc√™s?

Show @zenorocha! Enviei nossos e-mails por mensagem no LinkedIn ü§ù

>> Coment√°rio de zenorocha:
C√≥digo de desconto enviado ;)

>> Coment√°rio de aprendendofelipe:
O PR #1632 j√° estava pronto e aguardando aprova√ß√£o, mas como o Mailgun resolveu dar problema hoje, j√° estamos funcionando via Resend e com o Mailgun configurado como conting√™ncia. üöÄüöÄüöÄ
</issue_1451_Alterar provedor de email transacional de Mailgun para Resend>

<issue_1452_Salvar/Favoritar discuss√µes>
Seria legal a possibilidade de favoritar discuss√µes. Aconteceu de eu querer salvar um post para ver depois e, por n√£o possuir essa funcionalidade, precisei salvar a URL. Creio que uma p√°gina de favoritos seria uma adi√ß√£o interessante :)

>> Coment√°rio de felipsbreno:
@Tchez seria mesmo, acredito que essa funcionalidade vai ajudar caso algu√©m queira ver um post em outro momento. Percebi que alguns posts s√£o tutorias, de como fazer um chatbot etc...acho que pra esse casos tamb√©m vai ajudar esse implementa√ß√£o

>> Coment√°rio de aprendendofelipe:
@Tchez, obrigado pela sugest√£o! üí™

Vou fechar essa issue por ser duplicada com a #645. Combinado! ü§ù
</issue_1452_Salvar/Favoritar discuss√µes>

<issue_1453_Divulga√ß√£o de post de blog>
## Ol√° galera, tudo bem?

Tenho um blog pessoal onde divulgo conte√∫dos sobre front-end e carreira.

Cada post tamb√©m publico no Medium e Dev.to para ter um alcance maior. Para que o Google n√£o considere conte√∫do duplicado, eu uso o recurso de URL can√¥nica que essas plataformas permitem.

**Quero come√ßar a divulgar no Tabnews tamb√©m**. Por√©m, pelo que vi, o Tabnews n√£o permite o recurso de inserir URL can√¥nica.

Ent√£o pensei em duas sa√≠das:

1. Sugerir a implementa√ß√£o de URL can√¥nica para divulgar conte√∫dos j√° publicados em outros sites. Se isso for invi√°vel...
2. A segunda sa√≠da √© mais uma d√∫vida: posso publicar um conte√∫do no Tabnews linkando para meu blog e uma breve descri√ß√£o do conte√∫do?

Obrigado.

>> Coment√°rio de aprendendofelipe:
Ol√° @aaamenezes, obrigado pela sugest√£o! üí™

J√° existe discuss√£o aberta sobre o tema, ent√£o vou fechar essa duplicada, e podemos continuar a conversa na #860.

Combinado? ü§ù

>> Coment√°rio de aaamenezes:
Perfeito! Muito obrigado @aprendendofelipe
</issue_1453_Divulga√ß√£o de post de blog>

<issue_1454_Usar typesense como busca no site>
Depois de sentir falta de um campo de busca no site, fui procurar alguma alternativa e encontrei [typesense](https://typesense.org/) e percebi como √© f√°cil criar algo r√°pido, primeiro poderia criar um arquivo .json de todos os posts do TabNews, posts.json e enviar para o typesense rodando localmente no docker.

Com isso √© poss√≠vel retornar em tempo real os posts, letra por letra em segundos retorna o resultado, o que acham disso? o que voc√™ acha @filipedeschamps ?

Eles tem um exemplo com 32 milh√µes de m√∫sicas e em segundos retorna qualquer resultado relevante na pesquisa:
[MusicBrainz Songs Search](https://songs-search.typesense.org/) 
Um site que mostra o Typesense em a√ß√£o em um banco de dados de 32 milh√µes de m√∫sicas de [MusicBrainz](https://musicbrainz.org/).

Outro exemplo usando a vercel: 
[E-commerce Storefront with Next.js + Typesense + Vercel](https://showcase-nextjs-typesense-ecommerce-store.vercel.app/)

Analisei a quantidade total de posts no TabNews atualmente existe cerca de 10224 posts, ent√£o ser√° muito f√°cil criar esse sistema.

>> Coment√°rio de aprendendofelipe:
@mthmcalixto, obrigado pela sugest√£o! üí™

Para aumentar as chances de avan√ßo na ideia, estou pedindo para centralizar na issue #927 qualquer conversa sobre um sistema de busca. √â para l√° que estou direcionando todas as novas issues, ent√£o facilita para quem estiver interessado em contribuir ou acompanhar sobre esse assunto.

Vou fechar essa aqui como duplicada. Combinado? ü§ù
</issue_1454_Usar typesense como busca no site>

<issue_1456_[Sugest√µes] Tabnews esta parecendo conversa de WhatsApp.>
Boa tarde! Inicialmente, acreditava que o Tabnews seria uma plataforma de conhecimento, semelhante ao Reddit e ao Medium, que focaria principalmente em artigos elaborados por profissionais da √°rea e desenvolvedores experientes em tecnologias inovadoras. No entanto, ao longo do tempo, tenho notado uma quantidade consider√°vel de posts muito breves e repetitivos, com um conte√∫do bastante superficial. 

Surpreendentemente, essas publica√ß√µes de baixa qualidade acabam alcan√ßando posi√ß√µes de destaque na plataforma. Sinceramente, estou um tanto decepcionado com a forma como o conte√∫do est√° sendo organizado na plataforma atualmente. Pe√ßo desculpas por compartilhar minha insatisfa√ß√£o.

Sugest√µes:

>- Uma sugest√£o para evitar postagens repetidas seria a implementa√ß√£o de uma funcionalidade de busca de assuntos relacionados durante a cria√ß√£o do t√≠tulo do post pelo autor. Essa funcionalidade permitiria que, ao digitar o t√≠tulo, o sistema realizasse uma busca e exibisse os temas similares ao que o autor est√° propondo escrever. Embora eu tenha visto essa funcionalidade em outros lugares, n√£o consigo me lembrar exatamente onde.

>- Outra sugest√£o seria implementar a classifica√ß√£o dos posts, tornando obrigat√≥rio para o autor informar o tipo de postagem que est√° escrevendo no momento da cria√ß√£o. Por exemplo, como ilustrado abaixo:
![badges](https://i.ibb.co/4YBDMJF/badge-01.png)


>- Cria√ß√£o de abas por tipo de assunto ou tecnologia. Dessa forma, os usu√°rios poderiam navegar diretamente para as √°reas que mais lhes interessam, facilitando a busca por conte√∫do relevante. As abas poderiam ser organizadas de forma intuitiva e vis√≠vel na p√°gina inicial, permitindo aos usu√°rios filtrar o conte√∫do de acordo com suas prefer√™ncias.

Com essas melhorias, tenho certeza de que a plataforma se tornaria mais atrativa para os desenvolvedores e pessoas interessadas em tecnologia, incentivando a cria√ß√£o de artigos mais completos e aprofundados. Isso ajudaria a manter a qualidade do conte√∫do e proporcionaria uma experi√™ncia mais enriquecedora para todos os usu√°rios.

Espero que essas sugest√µes sejam consideradas para aprimorar o Tabnews e torn√°-lo realmente uma plataforma de conhecimento de refer√™ncia. Estou ansioso para ver as melhorias implementadas.

>> Coment√°rio de aprendendofelipe:
Ol√° @ValadaresX, obrigado pelas sugest√µes! üí™

Sobre a busca autom√°tica ao escrever o t√≠tulo, infelizmente ela √© invi√°vel no momento, pois al√©m de outras complexidades, ainda n√£o existe um sistema de busca dentro do TabNews que possa ser utilizado pela funcionalidade:

- #927 

E a busca √© muito importante, mas n√£o acho que evitaria assuntos repetidos, pois, se fosse o caso, n√£o ter√≠amos problema parecido aqui no reposit√≥rio, onde, mesmo existindo a busca do GitHub, sempre surgem novas issues com sugest√µes parecidas ao inv√©s de evolu√≠rem as discuss√µes j√° existentes.

At√© por isso, n√£o sei se vale a pena manter essa issue aberta at√© quando a implementa√ß√£o for mais vi√°vel, pois provavelmente esse t√≠tulo n√£o vai atrair quem queira contribuir com a ideia ou queira implementar. Talvez seja mais interessante criar uma issue espec√≠fica e dar mais detalhes de como funcionaria. Se conseguir se lembrar quais lugares viu a funcionalidade em pr√°tica, tamb√©m √© interessante colocar na issue. ü§ù

Sobre TAGs/t√≥picos dos conte√∫dos, j√° temos esta:

- #742 

Ainda sobre a qualidade dos conte√∫dos, n√≥s temos outras discuss√µes com ideias de mecanismos para subir o n√≠vel, caso queira dar uma olhada e contribuir, alguns exemplos s√£os:

- #1438 
- #1380
- #1267 
- #1198 
- #1153
</issue_1456_[Sugest√µes] Tabnews esta parecendo conversa de WhatsApp.>

<issue_1458_Formatar label de quantidade de coment√°rios para o singular [FRONTEND]>
Formatar label para quando tiver apenas 1 ou nenhum coment√°rio, apare√ßa "coment√°rio" e n√£o "coment√°rios".

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82189342/8f7df063-24e0-4d41-8597-0dc28118d303)

>> Coment√°rio de aprendendofelipe:
@cesarcanoff, voc√™ foi citado no post comemorativo:

https://www.tabnews.com.br/FelipeBarso/tabnews-6-milhoes-de-visualizacoes-e-muita-novidade üéâ
</issue_1458_Formatar label de quantidade de coment√°rios para o singular [FRONTEND]>

<issue_1459_[Seguran√ßa] CORS - Access-Control-Allow-Origin setado para "*" n√£o traz problemas de seguran√ßa?>
Fala pessoal, blz?

Sou meio novato por aqui, ent√£o pe√ßo desculpa se estiver falando alguma besteira.
Mas percebi nas configura√ß√µes do next que os headers da API est√£o configurados para ativa√ß√£o do CORS trazendo o valor "*" para o header Access-Control-Allow-Origin.

A quest√£o que ficou na minha cabe√ßa √©: n√£o seria perigoso liberar o CORS de maneira t√£o irrestrita? O melhor n√£o seria restringir essa configura√ß√£o para evitar poss√≠veis explora√ß√µes maliciosas?

Como a milestone sobre performance e seguran√ßa est√° em aberto, achei pertinente tamb√©m trazer esse questionamento aqui.

>> Coment√°rio de aprendendofelipe:
Oi @victorhcb, precisa ser assim, pois a API do TabNews √© p√∫blica üëç
</issue_1459_[Seguran√ßa] CORS - Access-Control-Allow-Origin setado para "*" n√£o traz problemas de seguran√ßa?>

<issue_1462_Contagem de coment√°rios caso algum coment√°rio com filhos seja apagado>
Considere a seguinte situa√ß√£o:

1. Uma publica√ß√£o √© feita.
1. Um coment√°rio A √© feito.
1. Um coment√°rio B √© feito respondendo ao coment√°rio A.
1. O coment√°rio A √© apagado.

A publica√ß√£o ficar√° como tendo `1 coment√°rio`. N√£o seria melhor mostrar `0 coment√°rios`?  Digo isso porque, √†s vezes, visito uma publica√ß√£o apenas para ver os coment√°rios novos, mas hoje essa situa√ß√£o n√£o teria coment√°rios, apesar de dizer `1 coment√°rio`

Fiz isso no ambiente de _deployment_, pegando um link [aqui](https://github.com/filipedeschamps/tabnews.com.br/deployments). Por enquanto, [esse link](https://tabnews-730hgyfob-tabnews.vercel.app/rafael/teste-com-um-comentario-com-filhos-apagado) funciona.

![Contagem de coment√°rios](https://i.imgur.com/2YFKbkt.png)

![Publica√ß√£o sem coment√°rios](https://i.imgur.com/iT7qqie.png)

**Edit:** N√£o sei se isso impacta tamb√©m o ranqueamento com base em coment√°rios:

https://github.com/filipedeschamps/tabnews.com.br/blob/9ab2c8771b6167a20943e48032988c081c0163cb/models/queries.js#L23-L39

>> Coment√°rio de aprendendofelipe:
Oi @Rafatcb, antes a gente fazia uma consulta recursiva para contar os coment√°rios, e ela era o que mais pesava no sistema. Agora √© feita uma consulta absurdamente mais r√°pida, mas ela retorna a contagem dos coment√°rios que est√£o publicados, mesmo que o pai tenha sido apagado.

A ideia √© mostrar a √°rvore toda, deixando o espa√ßo vago dos coment√°rios apagados, para poder mostrar todos os filhos que ainda est√£o publicados. S√≥ que isso ainda precisa ser feito.

>> Coment√°rio de Rafatcb:
@aprendendofelipe agora que voc√™ comentou, lembrei do problema de performance. Acho excelente mostrar os filhos que ainda est√£o publicados.

Tudo bem deixar esta issue aberta e fechar quando isso for implementado?

>> Coment√°rio de aprendendofelipe:
> Tudo bem deixar esta issue aberta e fechar quando isso for implementado?

Isso, melhor deixar aberta! Muito obrigado @Rafatcb! üí™

>> Coment√°rio de aprendendofelipe:
@Rafatcb, vou fechar aqui, pois o problema est√° relatado tamb√©m na #1089, ent√£o n√£o vai ficar sem solu√ß√£o ü§ù
</issue_1462_Contagem de coment√°rios caso algum coment√°rio com filhos seja apagado>

<issue_1463_Ajustes necess√°rios no firewall interno (limite de usu√°rios e publica√ß√µes por IP)>
O TabNews possui um [firewall](https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/firewall.js) que limita a cria√ß√£o de usu√°rios e publica√ß√µes vindas do mesmo IP em um curto intervalo de tempo, mas agora precisamos fazer algumas melhorias nele:

1. A mensagem de erro deve ser mais clara sobre o impacto de ter sido pego pelo firewall. Por exemplo, precisamos avisar que n√£o apenas a mensagem atual n√£o foi publicada, mas tamb√©m algumas mensagens anteriores podem ter perdido o status de publicadas.
2. Ao inv√©s de mudar os conte√∫dos para "draft", talvez precisamos exclu√≠-los ou criar um status pr√≥prio para esses casos.
3. Independentemente da exclus√£o ou de um status espec√≠fico, devemos aplicar todos os efeitos que ocorreriam se a publica√ß√£o fosse exclu√≠da, como a perda dos TabCoins.
4. Cuidar para n√£o criar efeitos em publica√ß√µes que j√° est√£o exclu√≠das.

Talvez existam outras melhorias necess√°rias, ent√£o precisamos rever:

- [Firewall](https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/firewall.js)
- [stored-procedures](https://github.com/filipedeschamps/tabnews.com.br/tree/main/infra/stored-procedures)

>> Coment√°rio de Rafatcb:
> 2. Ao inv√©s de mudar os conte√∫dos para "draft", talvez precisamos exclu√≠-los ou criar um status pr√≥prio para esses casos.

Acho que podemos usar um status como `review` para futuramente termos uma lista onde um "moderador" pode tomar uma a√ß√£o conforme o conte√∫do (apagar, permitir a publica√ß√£o, contatar o autor etc.). Esse status pode ser reaproveitado em situa√ß√µes onde, por exemplo:

* Conte√∫dos barrados pelo firewall (este issue).
* O autor do conte√∫do n√£o √© confi√°vel.
* O conte√∫do recebeu X sinaliza√ß√µes.

>> Coment√°rio de aprendendofelipe:
# Execu√ß√£o

- #1765 
- #1638
</issue_1463_Ajustes necess√°rios no firewall interno (limite de usu√°rios e publica√ß√µes por IP)>

<issue_1466_adicionar descri√ß√£o ao perfil dos usu√°rios>
Salve turma, vi essa issue h√° um tempo atr√°s #993 e n√£o sei se passou despercebida ou n√£o acharam t√£o relevante, mas achei a ideia sensacional, por√©m antes de abrir um poss√≠vel PR queria saber um pouco mais a opini√£o de voc√™s sobre essa featureü§ù, acham algo relevante? 


Pensei a princ√≠pio numa implementa√ß√£o seguindo essa linha.[](url)

https://github.com/filipedeschamps/tabnews.com.br/assets/112519905/c3cfaf59-3b79-437a-a7bd-ea3b4a5b53c2

>> Coment√°rio de Poveii:
**√â uma boa ideia!** Algo simples e sucinto mas que faz a diferen√ßa.

Mas quem sabe na pr√≥xima Milestone, porque eu creio que seria algo que se poderia linkar com a Revenue Share, como uma parte **sobre** aquela pessoa, inv√©s do nome descri√ß√£o.

>> Coment√°rio de filipedeschamps:
Que massa! Uma sugest√£o: o que acha fazer esta caixa aceitar Markdown e com isso deixar a pessoa colocar o que ela quiser l√° na p√°gina de perfil? Assim como o GitHub faz com [README](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/customizing-your-profile/managing-your-profile-readme) para o perfil deles.

Entrando um pouco na vibe da Milestone de Revenue Share, **quanto mais retorno dermos para o usu√°rio que cria conte√∫do** melhor para todo o ecossistema inteiro ü§ù

>> Coment√°rio de rubensflinco:
Ol√° eu peguei para fazer essa sugest√£o no c√≥digo, logo mais vou abrir uma PR e linkar aqui :)

>> Coment√°rio de rubensflinco:
Pessoal Pull Request Aberto, aguardando Revis√£o e Merge:
https://github.com/filipedeschamps/tabnews.com.br/pull/1471

>> Coment√°rio de aprendendofelipe:
> o que acabou gerando um PR duplicado

@ValbertMartins, n√£o tem nenhum problema! Na verdade √© muito legal quando existem diferentes PRs resolvendo os mesmos problemas. Isso s√≥ aumenta as chances de chegar em uma solu√ß√£o legal üòâüëç

>> Coment√°rio de Rafatcb:
Pessoal, cheguei atrasado nessa issue, mas ter descri√ß√£o √© algo bem legal. Tenho algumas ideias que, ao meu ver, melhorariam esse sistema.

1. **Limitar o espa√ßo vertical ocupado:** O Stack Overflow lida com isso de um jeito que eu acho bem legal, diminuindo a opacidade e deixando um bot√£o "Ler mais" ([perfil de exemplo aqui](https://meta.stackoverflow.com/users/63550/peter-mortensen)):

![Exemplo do Stack Overflow](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/cbcae6d3-b13e-4993-b9f3-3a7d3254a7ef)

2. **Overflow com _zalgo text_:** Esse problema j√° aconteceu no passado, veja o #560 e #562. Acho que podemos limitar √† caixa de descri√ß√£o (limitar o texto dentro das bordas):

![Overflow do zalgo text na descri√ß√£o](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/f4c128ff-9075-4f3f-a16e-942644378121)

3. **Descri√ß√£o com spam - perfil n√£o encontr√°vel:** Caso algu√©m crie um perfil para fazer spam na descri√ß√£o, mas nunca publique algo, o perfil n√£o pode ser encontrado porque n√£o existe um link para ele. Devemos ter alguma ferramenta para lidar com isso? No Stack Overflow isso acontece, mas o perfil √© encontr√°vel ([exemplo aqui](https://meta.stackoverflow.com/questions/421453/i-have-found-16-809-similar-inappropriate-user-profiles-there-are-more-now)). Apesar disso, geralmente o Stack Overflow ignora (caso seja um link para um neg√≥cio ou uma posi√ß√£o pol√≠tica, por exemplo) porque o espa√ßo do _about me_ √© "livre para o usu√°rio". _**Edit 2:** Complemento no ponto 7._

4. **Conte√∫do impr√≥prio:** Dependendo da situa√ß√£o, o usu√°rio levar√° um _nuke_ direto, principalmente porque n√£o temos uma ferramenta de "suspens√£o tempor√°ria" ainda. Voc√™s acham que faz sentido criar uma permiss√£o para os moderadores editarem a descri√ß√£o de outros usu√°rios em caso de infra√ß√µes leves? Seria algo como a permiss√£o (que j√° existe) de editar conte√∫do criado por outros usu√°rios.

5. **Regras:** O que podemos ou n√£o ter na descri√ß√£o do usu√°rio? Tudo bem eu colocar um link para o site de uma empresa?
 E falar mal de algum pol√≠tico? E colocar uma imagem (banner) de uma propaganda para algo que vendo, sou afiliado, ou algum outro tipo de campanha? Talvez essa discuss√£o deva ir para a issue #1153, o que voc√™s acham?


Edit:

6. **_Label_:** Algo bem bobo que passou pela minha cabe√ßa agora: a descri√ß√£o do usu√°rio n√£o √© "claramente" uma descri√ß√£o, e dependendo de como o usu√°rio formata, isso pode ficar ainda menos claro. Acho que criar uma _label_ como "Sobre" ou mesmo "Descri√ß√£o" deixa mais claro que aquele √© um espa√ßo de conte√∫do gerado pelo pr√≥prio usu√°rio. Acho que deixar o t√≠tulo como acontece na estiliza√ß√£o padr√£o de um `fieldset` j√° seria bom:

![No fieldset, o t√≠tulo aparece em cima da linha que fica em torno do conte√∫do](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/4ff13b79-d6b8-448d-8451-653859bc1463)


Edit 2:

7. **Links `nofollow` e `me`**: A rede Stack Exchange tem uma regra para uso de `nofollow` e `dofollow` nos links do perfil ([veja aqui](https://meta.stackexchange.com/a/171509/818993)), talvez o TabNews deva pensar nisso tamb√©m. N√£o entendo essa parte de SEO para dar uma opini√£o al√©m [do motivo pelo qual a Stack Exchange faz isso](https://meta.stackoverflow.com/a/327590/8839059), que parece v√°lido.

>> Coment√°rio de letsaguiar:
Achei muito legal a ideia e acho que pode realmente ser um bom passo para aumentar a visualiza√ß√£o dos perfis. Acho que poder√≠amos tamb√©m adicionar, al√©m da descri√ß√£o, fields como links para github e linkedin, portfolio pessoal, etc

>> Coment√°rio de aprendendofelipe:
> 1. **Limitar o espa√ßo vertical ocupado:**

Ainda acha necess√°rio mesmo n√£o existindo mais a lista de conte√∫dos abaixo da descri√ß√£o?

> 2. **Overflow com _zalgo text_:**

Resolvido no #1577, certo?
 
> 3. **Descri√ß√£o com spam - perfil n√£o encontr√°vel:** 

Nada que resolva, mas temos alguns pontos relacionados:

1. Precisamos registrar os eventos de edi√ß√£o do perfil. No m√≠nimo como fazemos para a edi√ß√£o de conte√∫do (que tamb√©m precisa ser melhorada para guardar algum hist√≥rico de vers√µes).
2. Precisamos de algum processo de verifica√ß√£o e elimina√ß√£o de contas "abandonadas". Ap√≥s certo tempo de abandono, enviar alguns avisos por email, e excluir a conta que continuar sem atividades ap√≥s os avisos.
3. Talvez dar a op√ß√£o dos moderadores listarem os √∫ltimos usu√°rios criados. Existe a feature `read:user:list` que pode ser dada aos moderadores, mas √© preciso adicionar a pagina√ß√£o no `GET` de `api/v1/users`.

> 4.  Voc√™s acham que faz sentido criar uma permiss√£o para os moderadores editarem a descri√ß√£o de outros usu√°rios em caso de infra√ß√µes leves? Seria algo como a permiss√£o (que j√° existe) de editar conte√∫do criado por outros usu√°rios.

Podemos usar a mesma permiss√£o, j√° que o perfil √© um conte√∫do criado pelos usu√°rios. Faz sentido?

> 5. **Regras:** O que podemos ou n√£o ter na descri√ß√£o do usu√°rio?
> ...
> Talvez essa discuss√£o deva ir para a issue [Atualizar Termos de Uso (e colocar link no cadastro)¬†#1153](https://github.com/filipedeschamps/tabnews.com.br/issues/1153), o que voc√™s acham?

Sim, faz mais sentido discutir isso l√°.

> 6. **_Label_:** 

A aba "Perfil" ajudou, mas talvez compense deixar mais claro que √© algo criado pelo usu√°rio. Entre "Descri√ß√£o" e "Sobre", acho que "Descri√ß√£o" √© melhor. Se pensarem em alguma palavra melhor, talvez seja bom mudar tamb√©m na p√°gina de "Editar Perfil", j√° que l√° o campo se chama "Descri√ß√£o".

> 7. **Links `nofollow` e `me`**

Por enquanto colocaria apenas o `nofollow`, como j√° est√° sendo feito no #1603. Depois podemos ter alternativas para usu√°rios confi√°veis removerem o `nofollow`, talvez consumindo TabCash.

>> Coment√°rio de Rafatcb:
> Ainda acha necess√°rio mesmo n√£o existindo mais a lista de conte√∫dos abaixo da descri√ß√£o?

Do jeito que est√° agora, com a descri√ß√£o tendo sua p√°gina pr√≥pria, n√£o me parece mais necess√°rio limitar.

> Resolvido no https://github.com/filipedeschamps/tabnews.com.br/pull/1577, certo?

:+1: 

> 2. Precisamos de algum processo de verifica√ß√£o e elimina√ß√£o de contas "abandonadas". Ap√≥s certo tempo de abandono, enviar alguns avisos por email, e excluir a conta que continuar sem atividades ap√≥s os avisos.

Voc√™ acha isso necess√°rio mesmo? N√£o vejo problemas em manter as contas "inativas". Penso em algu√©m que parou de acessar o TabNews e relembre daqui 10 anos, por exemplo, e ainda ter√° a conta ali com a data de cadastro "antiga". Os outros pontos (`1` e `3`) eu acho v√°lidos.

> Podemos usar a mesma permiss√£o, j√° que o perfil √© um conte√∫do criado pelos usu√°rios. Faz sentido?

Podemos usar a mesma permiss√£o sim. Se, futuramente, quisermos deixar outros usu√°rios ganharem essa permiss√£o mas sem permitir que eles modifiquem a descri√ß√£o do perfil de outras pessoas, √© s√≥ criarmos uma nova. Acho essa solu√ß√£o bem mais simples e n√£o cria grilh√µes para o futuro :+1: 

> Sim, faz mais sentido discutir isso l√°.

Pronto, j√° levei o coment√°rio para l√° :+1:

>> Coment√°rio de aprendendofelipe:
> > 2. Precisamos de algum processo de verifica√ß√£o e elimina√ß√£o de contas "abandonadas". Ap√≥s certo tempo de abandono, enviar alguns avisos por email, e excluir a conta que continuar sem atividades ap√≥s os avisos.
> 
> Voc√™ acha isso necess√°rio mesmo? N√£o vejo problemas em manter as contas "inativas". Penso em algu√©m que parou de acessar o TabNews e relembre daqui 10 anos, por exemplo, e ainda ter√° a conta ali com a data de cadastro "antiga". Os outros pontos (`1` e `3`) eu acho v√°lidos.

Eu acho que depende:

Eu excluiria usu√°rios que criaram a conta s√≥ para "reservar" o `username`, mas nunca interagiram com o site.

Tamb√©m tem os usu√°rios que criam contas falsas s√≥ para publicar algo de forma an√¥nima, muitas vezes utilizando emails tempor√°rios, e nunca mais acessam. Esses eu tamb√©m excluiria.

J√° usu√°rios que efetivamente usaram o TabNews por algum tempo, e possuem publica√ß√µes bem qualificadas, esses n√£o deveriam ser exclu√≠dos, muito menos seus conte√∫dos. Para esses casos eu acho que o usu√°rio poderia perder algumas features e precisar fazer uma nova verifica√ß√£o da conta para recuperar o acesso normal, se um dia desejar.
</issue_1466_adicionar descri√ß√£o ao perfil dos usu√°rios>

<issue_1467_[Sugest√£o] Implementa√ß√£o de Sistema de Comunidades para Melhoria da Curadoria e Personaliza√ß√£o de Conte√∫do no TabNews>
Oi pessoal do TabNews!

Considerando a minha experi√™ncia pessoal na era pr√©-Stack Overflow, onde eu programava em AS3 e a principal forma de compartilhar ideias e resolver d√∫vidas era por meio de comunidades no Orkut, como a antiga Flash Brasil, vejo um potencial semelhante a ser explorado na plataforma TabNews.

Prop√µe-se a implementa√ß√£o de um sistema de comunidades no TabNews, inspirado em f√≥runs tradicionais, onde os usu√°rios poderiam criar, administrar e participar de grupos tem√°ticos espec√≠ficos. Essas comunidades poderiam se concentrar em t√≥picos variados, permitindo o compartilhamento de conhecimentos, discuss√µes e resolu√ß√£o de d√∫vidas.

O principal benef√≠cio deste sistema seria a possibilidade de cada usu√°rio personalizar sua experi√™ncia na plataforma. Ao se juntar a comunidades espec√≠ficas de seu interesse, cada usu√°rio teria um fluxo de conte√∫do mais relevante, facilitando o engajamento e a reten√ß√£o.

Al√©m disso, a descentraliza√ß√£o da administra√ß√£o de conte√∫do para os usu√°rios permitiria uma maior capacidade de modera√ß√£o, minimizando o ru√≠do e mantendo a qualidade do conte√∫do. Isso poderia ser facilitado por uma equipe de admins em cada comunidade, respons√°vel por curar e monitorar o conte√∫do postado.

Tal abordagem comunit√°ria poderia transformar a atual "jagun√ßa de conte√∫do" na p√°gina inicial em um ecossistema mais organizado, personalizado e atraente. A implementa√ß√£o dessa proposta tem o potencial de aumentar a satisfa√ß√£o do usu√°rio e a utiliza√ß√£o geral da plataforma TabNews.

[Texto melhorado pelo GPT]

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, Tavernari!

N√£o √© exatamente o que voc√™ sugeriu, mas ser√° que a exist√™ncia de tags (https://github.com/filipedeschamps/tabnews.com.br/issues/742) e possibilidade de filtrar conte√∫do por elas resolveria esse problema?

Ter uma modera√ß√£o por tag pode ser √∫til um dia, mas pela quantidade de conte√∫do que temos hoje, n√£o me parece necess√°rio ter mais moderadores e com permiss√µes t√£o granulares assim.

>> Coment√°rio de Rafatcb:
Bom, como praticamente n√£o houve intera√ß√µes no issue desde a abertura, estou fechando para organizar o reposit√≥rio. Caso algu√©m queira argumentar algo a favor da implementa√ß√£o desse issue, pode criar um coment√°rio que reabrimos para a discuss√£o e poss√≠vel implementa√ß√£o.

Muito obrigado pela sugest√£o, Tavernari!
</issue_1467_[Sugest√£o] Implementa√ß√£o de Sistema de Comunidades para Melhoria da Curadoria e Personaliza√ß√£o de Conte√∫do no TabNews>

<issue_1468_[Sugest√£o] Aba de conte√∫dos recomendados>
Fala galera, baseando-me nos conte√∫dos do Tabnews: 
[O Famoso Algoritmo](https://www.tabnews.com.br/Ytu/o-famoso-algoritmo-como-funciona-e-como-fazer-um-sistema-de-recomendacao-de-conteudo-um-ponto-de-partida)
[O Famoso Algoritmo 2](https://www.tabnews.com.br/Ytu/o-famoso-algoritmo-2-um-aranhaverso-de-conexoesse-aprofundando-um-pouco)

Pensei na introdu√ß√£o de uma nova aba, al√©m das recentes e relevantes: a "recomendados".
Essa p√°gina √∫saria a bordagem citadas nos posts, usando o sistema de relevantes atual e os dados j√° em db do √∫suario e recomendaria os mehores//os mais provaveis posts (recentes) que o √∫suario iria gostar ou interagir.

O que acham? Alguma ideia? Vale a pena?

>> Coment√°rio de aprendendofelipe:
Ol√° @eletroswing, obrigado pela sugest√£o! üí™

N√£o vejo raz√£o para ter ao mesmo tempo uma se√ß√£o de "relevantes" e outra de "recomendados". Pra mim √© a mesma coisa. 

Ser√° que voc√™ est√° enxergando os "relevantes" atuais como sendo conte√∫dos que tiveram um bom desempenho, por exemplo, que foram mais vistos ou que se sa√≠ram melhor em algumas m√©tricas? Possivelmente teremos esse tipo de apresenta√ß√£o dos conte√∫dos, permitindo classificar por diferentes m√©tricas, mas algumas n√≥s ainda n√£o temos como disponibilizar em tempo real, como as contagem de visualiza√ß√µes, ent√£o isso ainda √© algo para ser desenvolvido.

A ideia das p√°ginas de "relevantes" √© que ali fiquem os conte√∫dos recomendados do momento. E para isso usamos os dados que temos dispon√≠veis sobre as publica√ß√µes, mas n√£o sobre os usu√°rios. Personalizar as recomenda√ß√µes √© uma possibilidade para o futuro do TabNews, mas exige uma revolu√ß√£o no sistema que n√£o faz sentido no momento atual, em que ainda n√£o foram vencidas etapas coma a implementa√ß√£o da Revenue Share e o aperfei√ßoamento das qualifica√ß√µes dos conte√∫dos e outras m√©tricas.

Um outro exemplo de etapa anterior √† personaliza√ß√£o, ser√° a implementa√ß√£o de t√≥picos, onde existir√£o diferentes recomenda√ß√µes de acordo com os assuntos escolhidos pelos usu√°rios, mas ainda assim, provavelmente n√£o ser√° algo totalmente individualizado em um primeiro momento.

Mas vai ser interessante se voc√™ desenvolver melhor a ideia que voc√™ citou de usar o sistema de relevantes atual e dados que j√° possu√≠mos dos usu√°rios. Quais dados dos usu√°rios? Como seria a consulta que retornaria os "recomendados" individualizados?

>> Coment√°rio de eletroswing:
Ol√° @aprendendofelipe , respondendo a **primeira parte:**
Seria mais para criar postagens que realmente tem valor ao √∫suario, pq as vezes os mesmos gostam de conte√∫dos especificos, como css, mas a aba relevantes raramente entram conteudos de css(s√≥ um exemplo). Dessa forma, teriam uma maior rota√ß√£o de tabcoins, e cria√ß√£o de comentarios!

**Segunda parte**:

A aba eventos e a aba de posts, especificamente, assim poderia relacionar quais conteudos os usuarios deram like ou criaram coment√°rios, a partir deste, encontrar o autor do post(ex: do que o usuario mais deu like) e recomendar alguns outros posts dele ou que o proprio autor deu like(passando por um filtro igual o do relevantes pra esses conteudos semelhantes) ou at√© seguir um exemplo um pouco mais aprofundado """igual""" o page ranking do google, onde pegariamos palavras dos conteudos interagidos, e procuramos em posts que se encaixam nessas palavras, excluindo necessidade de criar novas tabelas, seria mais um trabalho de analise dos dados e n√£o em si de coleta e gera√ß√£o de dados. O unico defeito dessa abordagem que eu consigo ver √© o tempo para gerar o feed(comum na maioria das aplica√ß√µes que possui tal sistema), mas, nao deve ter impactos altos na aplica√ß√£o(pense naquela demora carregando os comentarios do post mais comentado do tabnews).

**concluindo meu ponto**:

Bem, √© so uma ideia e opni√£o, algo que nao precisa(nem deve) ser explorado por agora se for o caso!
</issue_1468_[Sugest√£o] Aba de conte√∫dos recomendados>

<issue_1473_[Erro] Barra de pesquisa n√£o funciona no mobile.>
@aprendendofelipe  @filipedeschamps A barra de pesquisa que foi para produ√ß√£o no √∫ltimo merge n√£o funciona corretamente(ao menos n√£o em meu dispositivo mobile: um moto one vision), ao pesquisar e clicar na sugest√£o, o modal simplesmente some.

>> Coment√°rio de aprendendofelipe:
Oi @eletroswing, obrigado por reportar! üí™

Removi as sugest√µes por enquanto. üëç

>> Coment√°rio de aprendendofelipe:
Resolvido em #1475

>> Coment√°rio de aprendendofelipe:
@eletroswing, voc√™ foi citado no post comemorativo:

https://www.tabnews.com.br/FelipeBarso/tabnews-6-milhoes-de-visualizacoes-e-muita-novidade üéâ
</issue_1473_[Erro] Barra de pesquisa n√£o funciona no mobile.>

<issue_1478_[sugest√£o] feature de assuntos relacionados>
quando um usuario abrir um topico com um assunto que j√° foi publicado, aparece o link ou um resumo do assunto, se mesmo assim o usuario postar sugerir em baixo assuntos sobre o mesmo tema. 

exemplo L√≥gica:

https://www.tabnews.com.br/PedroVSD/melhorando-a-logica-de-programacao
https://www.tabnews.com.br/Joel34L/logica-de-programacao-esta-me-matando

>> Coment√°rio de Rafatcb:
Acho que fazer isso de forma automatizada tem uma grande chance de ficar ruim, tendendo para algum dos lados:

1. Publica√ß√£o com pouca ou sem intera√ß√£o.
2. Publica√ß√£o ruim.
3. Publica√ß√£o boa, sobre o mesmo assunto ou parecido, mas que na pr√°tica n√£o tem nada a ver com a publica√ß√£o atual.

No Hacker News, a pr√≥pria comunidade costuma mencionar _threads_ relacionadas, sobre o mesmo assunto. L√° a intera√ß√£o √© bem maior do que no TabNews e acho que funciona bem. No TabNews, para a maioria das publica√ß√µes, acho que n√£o ter√≠amos tantas coisas relacionadas para mostrar.

O seu coment√°rio _"com um assunto que j√° foi publicado"_ me fez pensar se voc√™ est√° querendo algo mais para o lado de tags, como mencionado em https://github.com/filipedeschamps/tabnews.com.br/issues/742

>> Coment√°rio de emerson-oliveira:
Sugeri em outra issue a implanta√ß√£o de um sistema de vota√ß√£o de tags, onde ser√° poss√≠vel ser visualizado as tags mais vistas.
Baseado nisso podemos adicionar no final das postagens o relacionamento baseado nesses tags.

- [ ] **Se√ß√£o de postagens relacionadas:** Com base nas tags mais votadas, criar uma se√ß√£o de ‚Äúpostagens relacionadas‚Äù no final de cada postagem.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1478_[sugest√£o] feature de assuntos relacionados>

<issue_1479_[Sugest√£o] Agendar uma publica√ß√£o>
Estive pensando, e se o tabnews permitisse que o √∫suario final agendasse uma publica√ß√£o? por exemplo, ao terminar de escrever, tivesse a op√ß√£o n√£o somente de publicar, como adicionar uma data e hora especifica para esse post ser liberado? 

_Pensamento t√©cnico:_ 
Ao agendar a publica√ß√£o, o published_at estivesse no futuro e o status dela algo como "pending", ou diretamente "published"

>> Coment√°rio de tihhgoncalves:
Opa, @eletroswing, tudo bem?
A grande pergunta √©: por que algu√©m precisaria agendar uma publica√ß√£o para o futuro?

>> Coment√°rio de eletroswing:
Ol√°, @tihhgoncalves , um dos exemplos √© a quantidade de postagens  diminuem aos finais de semana, justamente por qu√™ as pessoas descansam/tiram um tempo pra si, ent√£o a possibilidade de agendar uma publica√ß√£o √© manter uma quantidade regular de posts no site//para quem √© um 'seguidor'. Dessa forma uma pessoa pode 'publicar' enquanto est√° ofline
</issue_1479_[Sugest√£o] Agendar uma publica√ß√£o>

<issue_1482_[D√∫vida/Sugest√£o] Tabnews - Salvar conte√∫do como favorito>
Neste momento cheguei a marca de 12 abas de publica√ß√µes do Tabnews abertas no meu navegador. Devido a isso, decidi publicar pela primeira vez aqui no reposit√≥rio do Tabnews uma d√∫vida que surgiu e que pode se tornar uma sugest√£o. 

Essas abas abertas s√£o publica√ß√µes extensas ou t√£o interessantes que eu deixo para ler ou reler em um outro momento. Dado esse cen√°rio, minha sugest√£o √© que tenha uma forma de favoritar ou "salvar publica√ß√£o" da comunidade, como existe no Instagram, por exemplo. Essa fun√ß√£o salvaria o link da publica√ß√£o em uma "pasta arquivada" pessoal dentro do TabNews, sem ter que adicionar a p√°gina nos favoritos do navegador ou algo do tipo, podendo assim ler a publica√ß√£o mais a tarde ou at√© mesmo acompanhar os coment√°rios antes de interagir no t√≥pico. 

N√£o sei talvez se essa seria a fun√ß√£o do "Achei relevante" ao lado das publica√ß√µes, por√©m, eu ainda estou com 0 coins e n√£o consigo marcar um t√≥pico como relevante ou talvez eu nem ache o conte√∫do relevante naquele momento. 

Acompanho o site a um tempinho, j√° fiz um coment√°rio mas ainda n√£o fiz nenhuma publica√ß√£o. Por esse motivo, caso eu n√£o tenha entendido da forma clara a din√¢mica do Tabnews, essa sugest√£o possa ser interpretada como d√∫vida, ou vice-versa.

Valeu galera!

>> Coment√°rio de mthmcalixto:
@ghermanypaganini √â uma boa feature, o problema √© que o TabNews n√£o tem laterais, ent√£o tudo fica no header, se tivesse era f√°cil adicionais alguns bot√µes.

Talvez colocando em outro lugar, e pelo que o que eu entendi at√© agora, TabNews se parece com o Hacker News, n√£o tem muitas fun√ß√µes.

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o. J√° sugeriram isso algumas vezes, a discuss√£o est√° concentrada aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/645. Inclusive, abordaram a ideia de listas, que me parece mais interessante do que apenas favoritar.

Edit: o "Achei relevante" funciona como um voto para curadoria de conte√∫do, e hoje n√£o √© poss√≠vel visualizar uma lista das publica√ß√µes que voc√™ votou. O "salvar" e "votar" s√£o fun√ß√µes diferentes.

>> Coment√°rio de aprendendofelipe:
@ghermanypaganini, obrigado pela sugest√£o! üí™

Vou fechar apenas por organiza√ß√£o, j√° que ela √© duplicada com a #645 ü§ù
</issue_1482_[D√∫vida/Sugest√£o] Tabnews - Salvar conte√∫do como favorito>

<issue_1485_Comunidade Toxica>
H√° algum tempo venho notando que os usu√°rios do Tabnews na sua grande maioria est√£o agindo de uma forma toxica como por exemplo quest√µes f√°ceis de resolverem sendo de forma "BRUTAL" respondida isso quando respondida kkkkkk

Proponho aqui remover o DownVote assim os usu√°rios t√≥xicos seriam reduzidos ou ao menos forcado pela sua raiva a responder coerentemente dando assim a resposta por mais simples que fosse assim resolvendo o problema dos usu√°rios t√≥xicos e dos usu√°rios que publicam com uma duvida

Deixo aqui minha ideia, para discutirmos...

>> Coment√°rio de filipedeschamps:
> na sua grande maioria

N√£o consigo ver que √© a grande maioria, nem de perto isso, mas de qualquer forma acho v√°lido fazermos algo sim sobre os down votes. Fiz uma sugest√£o [nessa resposta aqui](https://www.tabnews.com.br/filipedeschamps/076b3791-0928-4afb-bf84-ec357ea20723) sobre ser uma feature mais dif√≠cil de ganhar.

@aprendendofelipe o que acha de fazermos algum tipo de experimento? ü§ù

>> Coment√°rio de cybernerd007:
**Levei em considera√ß√£o o `Recente` de 14 posts metade est√° ou negativo ou zerado... mas sem duvida eu exagerei (Obs.: n√£o foi sarcasmo realmente eu exagerei)**

![](https://img001.prntscr.com/file/img001/5yaPQPewRB-dfJMKyJ-NOQ.png)

>> Coment√°rio de aprendendofelipe:
Considerando que os votos negativos citados foram dados por quem j√° publicou algo considerado relevante e ganhou TabCoins com isso. E que os votos parecem estar de acordo com os crit√©rio pessoais dos usu√°rios que votaram. N√£o vejo isso como um comportamento t√≥xico, mas sim algo normal. Outros usu√°rios podem concordar ou discordar das avalia√ß√µes e darem seus votos.

> Proponho aqui remover o DownVote assim os usu√°rios t√≥xicos seriam reduzidos ou ao menos forcado pela sua raiva a responder coerentemente dando assim a resposta por mais simples que fosse assim resolvendo o problema dos usu√°rios t√≥xicos e dos usu√°rios que publicam com uma duvida

N√£o foi explicado como remover o voto negativo reduziria os usu√°rios t√≥xicos e nem como isso for√ßaria algu√©m com raiva a responder algo coerentemente. Mas foi confessado o exagero na cria√ß√£o da issue, ent√£o vou fechar essa aqui. Qualquer coisa √© s√≥ abrir novamente, ou abrir outra ü§ù

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe o que acha de fazermos algum tipo de experimento? ü§ù

Estamos nesse experimento aqui #1477, onde foi aumentando os ganhos de quem j√° passou da exig√™ncia m√≠nima, mas sem diminuir essa exig√™ncia m√≠nima.

Deixa s√≥ fechar uma semana e eu coloco os dados preliminares l√°, mesmo que uma semana seja muito pouco para tirar conclus√µes precisas ü§ù

>> Coment√°rio de cybernerd007:
O "Confesso o exagero" foi na forma de expressar mas n√≥s sabemos e j√° discutimos esse problema do DownVote e sinceramente eu vejo que isso e tentar evitar o inevit√°vel...
</issue_1485_Comunidade Toxica>

<issue_1487_Contagem da quantidade m√≠nima de palavras n√£o leva em conta palavras acentuadas>
A implementa√ß√£o do [PR 1460](https://github.com/filipedeschamps/tabnews.com.br/pull/1460) n√£o leva em conta palavras acentuadas.

Atualmente √© usado `.split(/[a-z]{5,}/i)` e verifica-se se o resultado tem menos que 6 elementos. Mas caso exista uma palavra com acentos ou cedilha, a contagem a desconsidera, mesmo que tenha mais que 5 caracteres.

Uma sugest√£o seria usar Unicode Property Escapes, e trocar `split` por `match` (assim o valor a ser comparado √© exatamente a quantidade que queremos - `< 5` em vez de `< 6`, um detalhe m√≠nimo, mas que na minha opini√£o deixa mais sem√¢ntico e diminui as chances de um *off-by-one error*):

```javascript
if (newContent.body.match(/(\p{L}\p{M}?){5,}/igu).length < 5) {
    // tem menos que 5 palavras com 5 caracteres ou mais
}
```

O `\p{M}?` trata os casos em que [a string est√° em NFD, assim n√£o precisa normaliz√°-la](https://pt.stackoverflow.com/q/406545/112052).

Mas talvez esta solu√ß√£o seja abrangente demais, pois considera letras de outros alfabetos tamb√©m. Como o site est√° restrito ao portugu√™s, podemos considerar apenas caracteres latinos, trocando a regex para `/(\p{Script=Latin}\p{M}?){5,}/igu`.

Atualmente h√° um [bom suporte dos browsers e _runtimes_](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape#browser_compatibility) para regex com Unicode Property Escapes, ent√£o n√£o deve ter maiores problemas de compatibilidade.

Em todo caso, tamb√©m poderia ser algo como `/[a-z√°√©√≠√≥√∫√¢√¥√£√µ√ß]{5,}/ig`. Mas isso n√£o trata os casos em que a string est√° em NFD, ent√£o precisaria normalizar para NFC antes:

```javascript
if (newContent.body.normalize('NFC').match(/[a-z√°√©√≠√≥√∫√¢√¥√£√µ√ß]{5,}/ig).length < 5) {
    // tem menos que 5 palavras com 5 caracteres ou mais
}
```

E claro que tamb√©m poderia remover os acentos para depois fazer a contagem com `[a-z]`, mas acho uma volta desnecess√°ria, pois d√° para fazer direto na pr√≥pria string com acentos.

>> Coment√°rio de aprendendofelipe:
> Contagem da quantidade m√≠nima de palavras n√£o leva em conta palavras acentuadas

√â verdade, mas isso foi deliberadamente feito assim porque acreditei ser algo simples e que teria um efeito melhor do que a proposta inicial de um "n√∫mero m√≠nimo de caracteres para ganhar tabcoins" https://github.com/filipedeschamps/tabnews.com.br/issues/1267#issuecomment-1615372170

> Apesar de eu n√£o estar considerando os caracteres acentuados, as palavras acentuadas ser√£o contabilizadas se tiverem 5 ou mais caracteres antes (ou depois) do acento. N√£o h√° necessidade de exatid√£o nessa verifica√ß√£o, j√° que s√≥ estamos contando as maiores palavras.
> 
> Sobre a quantidade escolhida, eu tentei fazer passar na verifica√ß√£o alguns coment√°rios curtos que vi no TabNews e que continham alguma mensagem √∫til. Vamos analisar o resultado e, qualquer coisa, mudamos esses limites.

A ideia n√£o foi definir exatamente o que √© um texto muito simples, mas criar alguma forma de apresentar a mensagem para os usu√°rios que n√£o est√£o familiarizados com o que esperamos das publica√ß√µes no TabNews.

Teve um impacto positivo, por exemplo, nas mensagens de agradecimento que agora tentam tamb√©m adicionar algo novo nas publica√ß√µes.

Uma pena √© que tem impacto limitado em quem usa o TabNews via API, como quem usa os Apps mobile da comunidade, pois n√£o recebem o aviso para ler a [publica√ß√£o do Filipe](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa), nem ao cair nesse regra, nem mesmo antes de fazerem a primeira publica√ß√£o:

https://github.com/filipedeschamps/tabnews.com.br/blob/4e4d030cd4c0c2e240c96e5cfea16e43604aa223/pages/publicar/index.public.js#L24-L31

>> Coment√°rio de Rafatcb:
Eu acredito que a solu√ß√£o sugerida `newContent.body.normalize('NFC').match(/[a-z√°√©√≠√≥√∫√¢√¥√£√µ√ß]{5,}/ig).length` continua sendo razoavelmente simples, ent√£o sou a favor de implementarmos, aproveitando para criar uma fun√ß√£o que verifica isso e importar ela tanto no frontend quanto no backend.

>> Coment√°rio de tiagodavi:
Lembrando que `match` pode retornar `null` quando n√£o da match em nada ao inv√©s do array e isso vai gerar undefined pro `length` ... undefined.length. J√° implementei considerando isso.

>> Coment√°rio de aprendendofelipe:
Turma, deixando um pouco de lado a implementa√ß√£o, qual seria a motiva√ß√£o para a mudan√ßa na regra de neg√≥cio?

Objetivo principal: **Diminuir a quantidade de publica√ß√µes e coment√°rios que n√£o possu√≠am valor concreto.**

Solu√ß√£o proposta inicialmente #1267:
-  Considerar uma quantidade m√≠nima de caracteres para creditar TabCoins. 

Problemas da solu√ß√£o proposta inicialmente: 

1. Apenas n√£o creditar TabCoins n√£o ajuda a educar usu√°rios desavisados sobre o que √© esperado dos conte√∫dos no TabNews, consequentemente teria impacto muito limitado.
2. Considerando apenas a quantidade de caracteres, n√£o foi poss√≠vel chegar a uma conclus√£o sobre qual seria a quantidade m√≠nima que nos ajudaria atingir o objetivo de termos mais conte√∫dos de valor, e que n√£o gerasse tantos falsos positivos ou negativos.

Solu√ß√£o adotada #1460:

1. N√£o apenas deixar de creditar TabCoins, mas dar um aviso explicando o motivo e com link para mais informa√ß√µes.
2. Ao inv√©s de se contar apenas os caracteres, foi considerado usar a quantidade de "palavras √∫teis". Mas como defini√ß√£o de "palavra √∫til", foi considerada a sequ√™ncia m√≠nima de 5 caracteres que contivesse apenas letras e desconsiderando quaisquer caracteres especiais, n√∫meros, pontua√ß√£o etc.

Caracter√≠sticas da solu√ß√£o adotada:

1. A parte educativa s√≥ alcan√ßa quem usa a vers√£o web do TabNews. Seria interessante algo que alcan√ßasse os usu√°rios da API.
2. Obviamente n√£o avalia de forma automatizada o valor concreto da publica√ß√£o, √© apenas uma forma de tentar filtrar o que muito provavelmente est√° sendo publicado por usu√°rios ainda n√£o familiarizados com o TabNews. Seria interessante usar algum algoritmo fundamentado em estudos para fazer essa avalia√ß√£o ou, quem sabe mais pra frente, usar alguma IA isso.

#### A proposta dessa issue

O proposto na issue se parece com uma melhoria na implementa√ß√£o para atender a regra de neg√≥cio, mas n√£o, ela √© uma solu√ß√£o diferente, n√£o apenas uma implementa√ß√£o diferente para a mesma solu√ß√£o.

A proposta se baseia na afirma√ß√£o de que palavras acentuadas n√£o s√£o consideradas, o que n√£o √© sempre verdade, j√° que se houver uma sequ√™ncia de 5 caracteres n√£o acentuados, ser√° uma palavra contabilizada. N√£o me baseie em nenhum estudo, foi s√≥ uma ideia para eliminar sequ√™ncias de caracteres aleat√≥rios e coisas que n√£o fazem parte do texto principal do conte√∫do.

Caso a proposta seja de altera√ß√£o na solu√ß√£o, ent√£o quais seriam as justificativas? O objetivo √© diminuir os avisos de "mensagem curta"? Para chegar mais perto do objetivo original, precisamos aumentar ou diminuir o efeito da solu√ß√£o adotada?

#### Para o futuro

Acredito que as melhorias na solu√ß√£o atual n√£o s√£o urgentes e nem requisitos para a Revenue Share, ent√£o se n√£o houverem justificativas para a mudan√ßa nas regras, n√£o vejo raz√£o para manter a issue aberta.

Vamos fechar para focar na Revenue Share? ü§ù

- #1490

>> Coment√°rio de Rafatcb:
> A proposta se baseia na afirma√ß√£o de que palavras acentuadas n√£o s√£o consideradas, o que n√£o √© sempre verdade, j√° que se houver uma sequ√™ncia de 5 caracteres n√£o acentuados, ser√° uma palavra contabilizada

Tudo bem, mas palavras acentuadas que n√£o possuem uma sequ√™ncia de cinco car√°cteres n√£o acentuados n√£o s√£o consideradas, esse √© o ponto. Conforme foi mencionado no coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1267#issuecomment-1615372170:

> usei a verifica√ß√£o abaixo para conferir se existem pelo menos 5 palavras com no m√≠nimo 5 caracteres:

Ou seja, continua sendo uma verifica√ß√£o por pelo menos 5 palavras com no m√≠nimo 5 caracteres. (Sei que foi constatado no mesmo coment√°rio o problema que tentamos resolver aqui, de n√£o considerar todas palavras acentuadas que possuem cinco ou mais caracateres)

> Caso a proposta seja de altera√ß√£o na solu√ß√£o, ent√£o quais seriam as justificativas? O objetivo √© diminuir os avisos de "mensagem curta"?

Mehorar a heur√≠stica atual, e recompensar alguns casos espec√≠ficos onde o autor est√° escrevendo as palavras corretamente com acentua√ß√£o  üòÖ

> Para chegar mais perto do objetivo original, precisamos aumentar ou diminuir o efeito da solu√ß√£o adotada?

Para chegar mais perto do objetivo original, acho que n√£o adianta contar nada. Uma recomenda√ß√£o de um livro pode ser muito mais relevante do que tr√™s par√°grafos de resposta, e automatizar isso √© bem mais complicado do que o que foi sugerido nesse issue. 

> Vamos fechar para focar na Revenue Share? ü§ù

N√£o acho que precisamos fechar um issue de baixa prioridade para focar no revenue share. Um dos pontos positivos de um projeto de c√≥digo aberto √© permitir que outros desenvolvedores trabalhem em algo que, ao mesmo tempo:

1. Melhora o projeto; e
2. Atende uma necessidade pr√≥pria.

A situa√ß√£o √© diferente da parte dos mantenedores, onde se espera foco total nos issues do Milestone, al√©m de cuidar do reposit√≥rio (o que, na maior parte do tempo, √© revis√£o de PR e triagem de issues).

E se voc√™ est√° sugerindo fechar porque n√£o gostou da solu√ß√£o para contar corretamente palavras com cinco caracteres ou mais, ent√£o claro que meus par√°grafos anteriores n√£o se aplicam (n√£o √© um issue de baixa prioridade, e sim algo que, se implementado, ser√° recusado). Se for isso, ent√£o realmente o issue deve ser fechado para ningu√©m gastar tempo implementando ou discutindo sobre.

Edit: Vi a an√°lise do PR ap√≥s escrever este coment√°rio. Se o problema for apenas o custo de processamento (que n√£o sei se na pr√°tica √© relevante, precisaria testar), podemos deixar o issue aberto e remover a label `good first issue`.

>> Coment√°rio de Rafatcb:
Bom, como esta mudan√ßa n√£o ser√° implementada, estou fechando o issue. Futuras modifica√ß√µes sobre este comportamento dever√£o caminhar na dire√ß√£o de melhorar a heur√≠stica, ao inv√©s de simplesmente contar caracteres ou palavras.

Agrade√ßo a colabora√ß√£o de todos que participaram da discuss√£o.
</issue_1487_Contagem da quantidade m√≠nima de palavras n√£o leva em conta palavras acentuadas>

<issue_1488_[ Sugest√£o ] conte√∫do mais relevante na p√°gina de perfil>
H√° pouco tempo atr√°s eu me deparei com um usu√°rio muito inteligente nos coment√°rios de um post, ent√£o visitei o seu perfil no tabnews para buscar mais conhecimento, por√©m tinha muito conte√∫do na sua p√°gina. Bom, eu abri somente os que tinha mais de uma resposta e muitos votos de relevante. Poderia, na p√°gina de perfil dos usu√°rios, ter um top ranking 3 de conte√∫dos relavantes do usu√°rio, e abaixo a lista de suas contribui√ß√µes. Ficaria mais f√°cil achar conte√∫do relavente do usu√°rio, no qual ele domina, ou n√£o. 

Eu acredito que esse sistema de rank, que pode ter peso atrav√©s dos coment√°rios e votos, pode entregar uma no√ß√£o do tipo de especialista que o usu√°rio √©.

>> Coment√°rio de Rafatcb:
Lucieudo, obrigado pela sugest√£o! Temos o issue https://github.com/filipedeschamps/tabnews.com.br/issues/1388 que fala sobre a possibilidade de ordenar os conte√∫dos por diversos filtros diferentes: data, votos, quantidade de coment√°rios etc. Vou fechar este para concentrar a discuss√£o l√°, ok?
</issue_1488_[ Sugest√£o ] conte√∫do mais relevante na p√°gina de perfil>

<issue_1490_Milestone 7: Revenue Share [DRAFT]>
Turma, est√° chegando o momento de implementarmos a primeira vers√£o da Revenue Share.

Ser√£o criados os espa√ßos de an√∫ncios que v√£o ser divididos entre os mantenedores do TabNews e os usu√°rios que participam do ciclo que cria valor no sistema (cria√ß√£o de conte√∫dos/coment√°rios e qualifica√ß√µes).

Obs. 1: O TabCash que os mantenedores recebem individualmente com seus usu√°rios ao participarem do ciclo do TabNews n√£o conta como a parte do sistema na divis√£o, pois eles est√£o sujeitos √†s mesmas regras de contribui√ß√£o de todos usu√°rios.

Obs. 2: N√£o vai existir uma maneira de comprar espa√ßos de an√∫ncios atrav√©s de pagamento em dinheiro, mas quem tem direito √† espa√ßos de an√∫ncios poder√° us√°-los da forma achar melhor, desde que respeite os termos de uso, ent√£o pode inclusive vender seus espa√ßos, mas ter√° que publicar o an√∫ncio com seu usu√°rio e ser√° respons√°vel por ele.

Podemos ter diferentes formatos de an√∫ncios, como os ‚Äúbanners‚Äù, ‚Äúdestaque nos resultados de pesquisas‚Äù, ‚Äúpublica√ß√µes promovidas‚Äù etc.

Acho que o mais simples para o in√≠cio deve ser implementar as ‚Äúpublica√ß√µes promovidas‚Äù. Penso assim tanto em termos de mec√¢nica de funcionamento, como de adapta√ß√£o da interface web, compatibilidade com Apps n√£o oficiais e outros sites que usam a API.

Como os ‚Äúbanners‚Äù e ‚Äúdestaques nos resultados de busca‚Äù exigem a elabora√ß√£o de mec√¢nicas mais complexas, podemos reserv√°-los, pelo menos no in√≠cio, aos an√∫ncios publicados pelos mantenedores do TabNews. E em uma vers√£o futura (em outra milestone) podemos criar formas do pr√≥prio TabNews ganhar parte do TabCash gerado e poder participar das publica√ß√µes promovidas, assim como dos usu√°rios usarem TabCash para anunciar em formato de banner.

Sobre os destaques em resultados, enquanto n√£o temos um sistema de busca pr√≥prio, n√£o podemos implementar nada que possibilite medir o alcance de forma simples. A busca hoje usa o pr√≥prio Google, e eu configurei alguns an√∫ncios dos projetos do Filipe para aparecerem quando for pesquisado por algo relacionado, mas, pelo menos por enquanto, n√£o temos nenhuma estat√≠stica de visualiza√ß√µes e cliques nesses resultados. Os √∫nicos dados que temos s√£o sobre a frequ√™ncia de consultas dos termos mais pesquisados, mas nada espec√≠fico dos an√∫ncios.

Ent√£o acredito que os pontos de **destaque** da milestone ainda s√£o:

- #1491 
- #1153 
- #1492 
- #877
- _LISTA EM CONSTRU√á√ÉO_

E permanecem no radar para quem quiser adiantar:
- #186 
- #1115 
- #1171 
- #1172 
- #1181 
- #1376 
- #1627 
- #1659 
- #1675 
- _LISTA EM CONSTRU√á√ÉO_

Em paralelo, j√° foram desenvolvidas durante a Milestone:
- #1156 
- #1263 
- #1463 
- #1529 
- #1540 
- #1631 
- #1635 
- #1644 
- #1645 
- #1656 
- #1662 
- #1663 
- #1668 
- #1678 
- #1681 
- #1685 
- #1696 
- #1704 
- #1705 
- #1706 
- #1707 
- #1708 
- #1715 
- #1720 
- #1721 
- #1723 
- #1725 
- #1726 
- #1727 
- #1728 
- #1729 
- #1733 
- #1734 
- #1735 
- #1737 
- #1738 
- #1755 
- #1768 
- #1772 
- _LISTA EM CONSTRU√á√ÉO_

>> Coment√°rio de Rafatcb:
Precisei escrever isso para organizar as ideias na minha mente e deixar claro para qu√™ cada coisa ir√° servir e para quem, al√©m de juntar as refer√™ncias num √∫nico local. Ent√£o, aproveitei para adicionar outros aspectos da mec√¢nica e compartilhar, porque dessa forma fica mais f√°cil de orientar quem n√£o acompanhou nada e tamb√©m de entender se eu estou alinhado com o consenso atual.

Tentei tirar partes mais espec√≠ficas sobre a implementa√ß√£o para comentar no issue mais adequado, permanecendo aqui apenas a "an√°lise macro" sobre o Revenue Share.

## O intuito dos an√∫ncios (para os usu√°rios)

Resumo:

- O usu√°rio que contribuiu com a plataforma tem como recompensa a possibilidade de divulgar algo (produto, servi√ßo, projeto, vagas).
- O usu√°rio n√£o pode vender o espa√ßo de an√∫ncio pelo TabNews, mas pode vender particularmente para algu√©m ou para uma empresa e assumir a responsabilidade pelo an√∫ncio.

Em alguns lugares j√° foi dito que a ideia √© n√£o ter uma forma de venda de um "espa√ßo de an√∫ncio", mas permitir que os usu√°rios vendam de forma privada para quem quiserem, e se responsabilizarem pelos an√∫ncios na plataforma. Algumas refer√™ncias para quem quiser se aprofundar s√£o: https://github.com/filipedeschamps/tabnews.com.br/issues/1490#issue-1833984027 (publica√ß√£o inicial desse issue), https://github.com/filipedeschamps/tabnews.com.br/issues/352#issue-1242422498, [v√≠deo de lan√ßamento do TabNews](https://youtu.be/bYBVCxVwrdY?si=TIPOjpE1LPvPWfOT&t=475).

> Isso √© extremamente empolgante, porque "algo" pode variar desde produtos ou servi√ßos convencionais, at√© seus projetos pessoais, como reposit√≥rios no GitHub na qual voc√™ n√£o gastaria dinheiro para divulg√°-los, mas com essa mec√¢nica voc√™ avaliaria divulgar. Ou at√© divulgar seu portf√≥lio, site pessoal, vaga de emprego, o que fizer fechar a conta para voc√™ e tornar vi√°vel e sustent√°vel a sua participa√ß√£o na plataforma.

## O intuito dos an√∫ncios (para o TabNews)

Resumo:

- O TabNews n√£o gera receita, e os espa√ßos de an√∫ncios tem tamb√©m como objetivo tornar o TabNews autossustent√°vel.
- Como "compartilhamento", parte dos an√∫ncios ser√£o disponibilizados para os usu√°rios, e parte para o TabNews, numa propor√ß√£o ainda n√£o estabelecida.

O TabNews sempre foi um projeto financiado pelo @filipedeschamps ([refer√™ncia](https://www.tabnews.com.br/filipedeschamps/a9ac485b-2c87-4b70-bd72-942a797e01f8)), e hoje √© mantido com a receita gerada pelo [curso.dev](https://curso.dev/). O Revenue Share surge como uma tentativa de n√£o apenas retribuir o valor que a comunidade gerou, mas tamb√©m de tornar o TabNews um projeto autossustent√°vel, isto √©, um projeto que gera uma receita maior do que os custos.

Como dito em https://github.com/filipedeschamps/tabnews.com.br/issues/352#issue-1242422498, o "compartilhamento" √© no sentido de que parte dos an√∫ncios ser√£o disponibilizados para os usu√°rios e parte para o TabNews:

> (...) vamos implementar um sistema de Revenue Share (Compartilhamento de Receita), muito pr√≥ximo do que voc√™ encontra nas outras plataformas como YouTube, onde uma parte fica para a plataforma e outra para o criador, mas que nesse momento vamos zerar qualquer repasse da plataforma para entender o que funciona para o criador, e depois o que sobra para a plataforma.

e https://github.com/filipedeschamps/tabnews.com.br/issues/352#issuecomment-1155757751:

> Como j√° comentado, o TabNews n√£o tem receita, ent√£o ser√° compartilhado o Espa√ßo Publicit√°rio e as pessoas poder√£o usar esse espa√ßo para o que quiser (...)

## Impactos iniciais nos Termos de Uso

Resumo:

- Proibir divulga√ß√£o de vagas de empresas espec√≠ficas no TabNews, permitindo esse tipo de divulga√ß√£o apenas por meio de an√∫ncios.
- An√∫ncios podem ser "puramente comerciais", diferentemente de publica√ß√µes.

Para alguns an√∫ncios fazerem sentido, eles devem ser permitidos como an√∫ncio e n√£o como uma publica√ß√£o comum. A partir da cita√ß√£o feita em _O intuito dos an√∫ncios (para os usu√°rios)_, imagino que um dos exemplos seria proibirmos a divulga√ß√£o de vagas de empresas espec√≠ficas em publica√ß√µes, assim continuamos permitindo sites agregadores, e permitiremos a divulga√ß√£o de empresas espec√≠ficas em an√∫ncios.

Outro ponto seria o n√≠vel "comercial" que os an√∫ncios poderiam ter. An√∫ncios extremamente comerciais podem n√£o ter um efeito t√£o bom quanto um an√∫ncio com cara de publica√ß√£o, e tudo bem, porque os an√∫ncios em outras plataformas tamb√©m funcionam assim (uns convertem mais do que outros). Ent√£o, acredito que inicialmente podemos ser mais permissivos, e moderar conforme vermos que a situa√ß√£o desandou para al√©m do que a comunidade consegue gerenciar bem.

## Requisitos para criar um an√∫ncio

Resumo:

- O usu√°rio usar√° TabCash para criar an√∫ncios.
- An√∫ncios devem ser aprovados e/ou podem ser removidos.
- Nem todos usu√°rios poder√£o criar an√∫ncios, existir√° uma "r√©gua m√≠nima" para diminuir abusos.

Para conseguir criar an√∫ncios, o usu√°rio utilizar√° uma certa quantia de TabCash, conforme dito em https://github.com/filipedeschamps/tabnews.com.br/issues/352#issue-1242422498:

> Voc√™ somente consegue comprar an√∫ncios usando o TabCash, esse √© o "objetivo final" (caso voc√™ queira isso como objetivo). Ent√£o a quest√£o √©, como ganhar TabCash? E a resposta √© simples: qualificando conte√∫dos de valor concreto com suas TabCoins.

Como dito [nesse coment√°rio no TabNews](https://www.tabnews.com.br/filipedeschamps/a9ac485b-2c87-4b70-bd72-942a797e01f8), nem todo mundo poder√° anunciar, e os an√∫ncios precisar√£o ser aprovados ou poder√£o ser removidos. Isso deve ser debatido mais especificamente nos issues de implementa√ß√£o, de acordo com o tipo de an√∫ncio e como o sistema est√° se comportando.

Al√©m disso, o acesso ao sistema de an√∫ncios n√£o ser√° disponibilizado para "todos que possuem TabCash", e inicialmente poder√° ser restrito a um grupo menor de usu√°rios para termos um melhor controle sobre como est√° sendo a resposta da comunidade diante da nova funcionalidade.

> 5. E sobre a feature em s√≠, que no fundo √© implementar o Revenue Share (que √© uma das formas de usar o TabCash), vai precisar de outras implementa√ß√µes importantes, como uma administra√ß√£o melhor das features do usu√°rio, porque eles ir√£o precisar ter uma regua m√≠nima para entrar no programa (igual ao YouTube faz para tentar diminuir os abusos). Uma das formas de implementar isso √© um usu√°rio conseguir "comprar" a feature de poder participar do Revenue Share ao atingir certos crit√©rios.
> 6. E junto disso, precisaremos construir um administrador de an√∫ncios, pois todos eles ir√£o precisar passar por aprova√ß√£o manual antes de poderem aparecer no site. A n√£o ser que a gente consiga fazer alguma auto-administra√ß√£o disso, pelo menos para reportar algum abuso, ou acertar a m√£o na r√©gua inicial para conseguir participar do programa.

## Dura√ß√£o do an√∫ncio, custo, alcance etc.

Resumo:

- Discutir no issue espec√≠fico sobre o tipo de an√∫ncio.

J√° pensamos em alguns tipos de an√∫ncio, como banner (https://github.com/filipedeschamps/tabnews.com.br/issues/1492), publica√ß√µes promovidas (https://github.com/filipedeschamps/tabnews.com.br/issues/1491) e destaques nos resultados de busca, conforme listado na publica√ß√£o inicial deste issue (https://github.com/filipedeschamps/tabnews.com.br/issues/1490#issue-1833984027). Como s√£o tipos de an√∫ncios diferentes, o custo (em TabCash) para cri√°-los dever√° ser diferente, assim como funcionar√£o de forma diferente: sua dura√ß√£o talvez seja medida em visualiza√ß√µes, em intera√ß√µes, ou usando uma f√≥rmula onde cada fator consome uma determinada quantia de TabCash. Por isso, √© mais adequado discutir esse tipo de detalhe no issue espec√≠fico sobre o tipo de an√∫ncio.

## Quantidade de an√∫ncios limite por usu√°rio

Resumo:

- Discutir no issue espec√≠fico sobre o tipo de an√∫ncio.

Provavelmente teremos limita√ß√µes para que um usu√°rio n√£o ocupe todos os espa√ßos de an√∫ncio o tempo inteiro, ou podemos fazer com que o custo de ter dois an√∫ncios ou de ampliar o alcance do √∫nico an√∫ncio seja mais caro do que o "b√°sico" (aumento exponencial ao inv√©s de linear, por exemplo). Apesar disso poder ser uma limita√ß√£o de forma global (para todo tipo de an√∫ncio), √© mais adequado discutirmos passo a passo, visto que primeiro iremos implantar uma forma de an√∫ncio, acompanhar os resultados e partir para a pr√≥xima. Ent√£o, inicialmente isso ser√° tratado no issue do tipo espec√≠fico de an√∫ncio.

>> Coment√°rio de Rafatcb:
Estou criando este coment√°rio separado do anterior para esclarecer d√∫vidas ou dar sugest√µes.

## Entendendo melhor como o TabNews se tornar√° autossustent√°vel

Essa parte n√£o est√° totalmente clara para mim, e pretendo editar o coment√°rio anterior depois que entender melhor. Entendo que n√£o ser√° implementado de imediato, e vamos avan√ßando em etapas, mas √© importante entender isso para planejar algo que fa√ßa sentido desde o in√≠cio.

O que est√° planejado atualmente para ajudar o TabNews a se tornar mais autossustent√°vel √© ter espa√ßos de propaganda que o pr√≥prio TabNews possa usar para promover _algo_, onde, no momento, esse _algo_ ser√° apenas o [curso.dev](https://curso.dev/), mas, futuramente, poder√° ser outros projetos do Filipe. √â isso?

## TabCoins e TabCash. E talvez algo mais?

Existem alguns estudos que mostram que o ser humano sente mais a dor da perda do que a felicidade do ganho, e tamb√©m h√° o chamado [vi√©s da avers√£o √† perda](https://thedecisionlab.com/biases/loss-aversion). Acredito que algumas pessoas ter√£o receio maior em usar o TabCash porque n√£o ter√£o mais nenhum outro "n√∫mero" que represente a sua "participa√ß√£o" no TabNews.

Ent√£o, me parece que seria uma boa ideia termos um terceiro elemento, mantendo a gamifica√ß√£o e a "experi√™ncia/reputa√ß√£o/karma" que o usu√°rio possui. Quero saber se outras pessoas concordam comigo, mas isso pode ser implementado mesmo depois do primeiro tipo de an√∫ncio ser lan√ßado, porque conseguimos "corrigir em retrospecto" com base nos eventos gerados com os gastos de TabCash.
</issue_1490_Milestone 7: Revenue Share [DRAFT]>

<issue_1491_Publica√ß√µes Promovidas>
Vou apenas rascunhar como imagino que poderiam ser as publica√ß√µes promovidas, mas o resultado final provavelmente ser√° diferente da ideia inicial (pode at√© ser completamente diferente).

As publica√ß√µes promovidas ter√£o semelhan√ßas e diferen√ßas com as demais publica√ß√µes.

As semelhan√ßas s√£o:

- Qualifica√ß√µes: Publica√ß√µes promovidas podem receber qualifica√ß√µes para que tenhamos mais destaque para an√∫ncios mais relevantes aos usu√°rios. Ent√£o elas podem acabar saindo dos destaques, seja pelo tempo de publica√ß√£o ou pelo saldo de TabCoins, assim como podem voltar aos relevantes se receberem novas intera√ß√µes.
- Formato: O formato da publica√ß√£o promovida nas interfaces, seja web ou API, ser√° o mesmo das demais publica√ß√µes.

As particularidades s√£o:

- Ser√£o tempor√°rias e sair√£o do ar ao t√©rmino de sua validade.
- Ao inv√©s de darem TabCoins para o Autor, elas consomem TabCash ao serem publicadas.
- N√£o movimentam TabCoins do autor ou do qualificador quando recebem votos.
- Consomem TabCash do autor a cada diferente usu√°rio que qualificar (seja voto positivo ou negativo) ou comentar, de forma a resultar em um custo maior para as publica√ß√µes com mais intera√ß√µes (maior alcance).

Ao ter o custo em TabCash para uma publica√ß√£o promovida relacionado √†s qualifica√ß√µes, uma publica√ß√£o mal avaliada, que acabar saindo dos relevantes, praticamente n√£o ter√° custos adicionais, enquanto outra que for bem avaliada e, consequentemente, mais visualizada, acabar√° resultando em um custo maior (at√© o limite estabelecido pelo autor).

**Detalhando** melhor a ideia:

1. Ao criar uma publica√ß√£o promovida, deve ser escolhida a quantidade de TabCoins promovidos e mais dois par√¢metros opcionais: limite de consumo de TabCash e limite de tempo publicada.
2. A quantidade inicial de TabCoins promovidos ir√° definir apenas o destaque inicial da publica√ß√£o entre as demais publica√ß√µes, o que ir√° variar normalmente conforme as qualifica√ß√µes recebidas e a idade da publica√ß√£o.
3. A quantidade de TabCoins promovidos ter√° um custo de X TabCash por cada TabCoin, onde X pode variar conforme a cota√ß√£o do momento.
4. O limite de TabCash extra define o m√°ximo que ser√° consumido conforme forem ocorrendo as intera√ß√µes, onde a cada intera√ß√£o ser√° consumido mais Y TabCash. Se for deixado sem limite, a publica√ß√£o ficar√° no ar at√© ser consumido todo o TabCash do autor.
5. Para as cota√ß√µes (valores de X e Y), podemos come√ßar de forma parecida com o que fizemos com os ganhos de TabCoins ao publicar, ou seja, podemos come√ßar com uma cota√ß√£o fixa e ir ajustando manualmente conforme a necessidade. Mais para frente, quando entendermos melhor a mec√¢nica, podemos automatizar a cota√ß√£o de forma a manter uma quantidade saud√°vel de an√∫ncios. No in√≠cio, com o grande ac√∫mulo de TabCash atual, acho que precisamos come√ßar com cota√ß√µes bem acima de 1, pois sen√£o pode ocasionar um excesso de an√∫ncios nos destaques.
6. Publica√ß√µes promovidas n√£o d√£o e nem retiram nenhum TabCoin do autor. Elas apenas consomem TabCash. Assim evitamos que se promova publica√ß√µes pensando apenas em gerar mais TabCoins do que o investido para promover. At√© por serem tempor√°rias, nem faria sentido gerar TabCoins com elas. Mas elas podem ser uma propaganda do perfil do usu√°rio ou de algumas de suas publica√ß√µes, o que tamb√©m pode trazer mais TabCoins do que o investido, mas dessa forma acredito ser aceit√°vel.
7. Qualquer qualifica√ß√£o que a publica√ß√£o receber muda o saldo da publica√ß√£o, consome mais Y TabCash do autor, mas n√£o d√° e nem retira TabCoins dos usu√°rios (seja o autor ou o qualificador), fazendo assim o custo (TabCash) para o autor ter alguma rela√ß√£o com o alcance da publica√ß√£o. O custo n√£o ser√° diretamente proporcional ao alcance (pois as qualifica√ß√µes n√£o s√£o), mas dessa forma existe o benef√≠cio de ficar isento de visualiza√ß√µes de rob√¥s e de manipula√ß√µes.
8. Como n√£o haver√° custo para os qualificadores, as publicidades n√£o diminuir√£o o saldo dispon√≠vel para qualifica√ß√µes das demais publica√ß√µes.
9. Mesmo sem consumo de TabCoins, apenas usu√°rios com 2 ou mais TabCoins poder√£o qualificar as publica√ß√µes promovidas, limitado a uma qualifica√ß√£o por usu√°rio/publica√ß√£o. Isso deve dificultar a manipula√ß√£o indevida dos custos e do ranqueamento de conte√∫dos promovidos.
10. Precisamos dificultar o bloqueio das publica√ß√µes promovidas, seja por extens√µes para navegador, seja por sistemas que usam conte√∫dos da API do TabNews. Por isso que acredito que n√£o deve haver nenhuma forma de identificar que √© um conte√∫do promovido, a n√£o ser ap√≥s efetuar a qualifica√ß√£o sem consumo de TabCoins.
11. O fato de n√£o identificar que √© uma publica√ß√£o promovida tamb√©m pode ajudar com uma qualifica√ß√£o mais isenta.
12. A publica√ß√£o promovida ser√° despublicada quando ocorrer o primeiro entre os seguintes eventos: o autor despublicar manualmente, o limite de tempo for alcan√ßado, o limite de TabCash for atingido ou o saldo de qualifica√ß√µes ficar negativo.
13. Acho que seria saud√°vel limitar a uma publica√ß√£o promovida por autor, mas permitindo editar a publica√ß√£o existente ou despublicar e criar uma nova.

>> Coment√°rio de rodrigoKulb:
√ìtimo quando voc√™ fala no formato


> * Formato: O formato da publica√ß√£o promovida nas interfaces, seja web ou API, ser√° o mesmo das demais publica√ß√µes.

Acho que seria importante informar que s√£o "Patrocinadas" n√£o? Talvez reservar os 3 primeiros lugares para elas. O time de cache diferente, pois assim que finalizar o consumo de TabCash n√£o devem ser mais exibidas.
**Sugest√£o**
![Captura de tela em 2023-08-02 21-06-00](https://github.com/filipedeschamps/tabnews.com.br/assets/5334261/0826eafd-ad40-4ce6-8bfa-95b6612b9a71)

>> Coment√°rio de aprendendofelipe:
> Acho que seria importante informar que s√£o "Patrocinadas" n√£o?

√â um outro caminho, mas precisa desenvolver o restante da ideia e pensar na mec√¢nica de funcionamento, pois quase nada da minha sugest√£o inicial funcionaria se for mostrar que a publica√ß√£o √© promovida sem o usu√°rio precisar qualificar para descobrir isso.

Alguns pontos para pensar:

1. **Vers√£o Web:** Deixar um espa√ßo fixo no layout para propaganda deve funcionar para o #1492 , mas n√£o para publica√ß√µes promovidas, j√° que os usu√°rios se acostumariam a ignorar aquele peda√ßo, e talvez a maioria nunca clicaria nessas publica√ß√µes. N√£o funciona da mesma maneira que um feed de imagens, onde o usu√°rio normalmente j√° v√™ o conte√∫do sem precisar clicar em nada.
2. **API:** Se a API do TabNews √© gratuita, n√£o podemos facilitar que sejam filtradas as publica√ß√µes promovidas, pois elas n√£o chegariam, por exemplo, nos Apps, Feeds RSS e sites que usam a API.
3. Como as promovidas est√£o sujeitas √†s qualifica√ß√µes, acho que podemos deix√°-las aparecerem como as demais publica√ß√µes.
4. Tem que ser mais vantajoso criar uma publica√ß√£o promovida do que uma publica√ß√£o normal, sen√£o elas n√£o fazem sentido.
5. Usei as qualifica√ß√µes para fazer os custos das promovidas se basear em algo dif√≠cil de manipular. Se for destac√°-las como publicidade, precisa criar outro mecanismo.
6. Eu concordo que seria melhor se fosse poss√≠vel deixar claro que s√£o promovidas sem o usu√°rio precisar votar para descobrir isso, mas n√£o encontrei maneira de funcionar, ent√£o √© melhor focar nos banner se n√£o gostarem da ideia das promovidas. Mas √© claro que √≥timas ideias podem surgir resolvendo todos os problemas. üí™

>> Coment√°rio de rodrigoKulb:
√ìtimos pontos, gosto do caminho que voc√™ est√° querendo seguir. Mas ainda acho importante ter a informa√ß√£o que aquela publica√ß√£o foi "patrocinada". Mas vejo um problema quando informamos isso nas APIs correndo risco de corte dessas informa√ß√µes.

> * Tem que ser mais vantajoso criar uma publica√ß√£o promovida do que uma publica√ß√£o normal, sen√£o elas n√£o fazem sentido.

Se deixar sempre as 3 primeiras patrocinadas resolveria essa quest√£o.

Poderia manter a regra de qualifica√ß√£o para ordenar entre as top 3 e utiliza√ß√£o do saldo como custo.

Mas realmente √© algo que precisamos pensar, porque envolve um caminho completamente diferente para o desenvolvimento. 

OBS: Estou afastado do projeto um bom tempo, ent√£o ainda estou me atualizando com as informa√ß√µes! üòÖÔ∏è

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe, saindo totalmente fora do planejado, somente jogando uma ideia: e se a natureza da publica√ß√£o n√£o alterasse nada, e pud√©ssemos utilizar os TabCash para "turbinar" a publica√ß√£o por um tempo ou por visualiza√ß√µes? Desta forma, a publica√ß√£o em si n√£o mudaria nada. Apenas seria uma forma de "patrocinar" uma publica√ß√£o normal. Assim que finalizasse o per√≠odo, ela voltaria a ser uma simples publica√ß√£o.

>> Coment√°rio de aprendendofelipe:
Vou tentar simplificar e expor o que eu considerei, pois assim fica mais f√°cil de encaixar cada ideia em alguns dos resultados que podemos obter.

Dependendo das regras que criarmos, vamos chegar em uma destas 3 situa√ß√µes, onde apenas a segunda √© desej√°vel:

1. N√£o vale a pena usar TabCash, pois n√£o aumenta as visualiza√ß√µes e nem os ganhos de TabCash;
2. Vale a pena usar TabCash apenas para aumentar o alcance (uma troca de TabCash por visualiza√ß√µes);
3. Sempre vale a pena usar TabCash, pois d√° mais visualiza√ß√µes e devolve o TabCash investido, ou porque devolve ainda mais TabCash (Farm);

Na pr√°tica, dependendo da ideia, ela vai transitar entre as op√ß√µes acima dependendo de diversos fatores, como dia e hor√°rio, quantidade de TabCash investido, tipo de conte√∫do etc. Mas mesmo sem chegar nesse n√≠vel de detalhamento, j√° √© poss√≠vel descartar algumas ideias que tem mais tend√™ncia de resultar nos indesejados casos extremos.

Para analisar em qual dos casos acima n√≥s chegamos com cada configura√ß√£o, podemos olhar para estes resultados:

1. Promovendo com TabCash, a publica√ß√£o tem mais visualiza√ß√µes do que sem usar TabCash?
2. O autor ganha mais TabCash do que o TabCash investido para promover?

Vaja na tabela a seguir que s√≥ existe um caso desejado. Ent√£o cada sugest√£o precisa resultar nesse caso, em que s√≥ vale a pena usar TabCash se for para dar mais visualiza√ß√£o a algo. 

#### Onde cada ideia se encaixa?

Visualiza√ß√µes | TabCash | Vale a pena promover algo usando TabCash?
--- | --- | ---
Diminui  | Diminui | Nunca
Diminui  | N√£o muda | Nunca
Diminui  | Aumenta | S√≥ serviria para farmar
N√£o muda | Diminui | Nunca
N√£o muda | N√£o muda | Nunca
N√£o muda | Aumenta | Sempre
Aumenta | Diminui | S√≥ para melhorar o Alcance (**√∫nica saud√°vel**)
Aumenta | N√£o muda| Sempre
Aumenta | Aumenta | Sempre


### Por que descartar as outras linhas da tabela?

Os casos em que **nunca** vai valer a pena usar TabCash n√£o fazem sentido, pois eliminam a raz√£o de TabCash existir.

J√° para os caso em que **sempre** vai valer a pena usar TabCash para promover qualquer publica√ß√£o, o problema ser√° justamente esse. Pra quem tem TabCash, n√£o vai fazer sentido publicar algo e n√£o promover, mas a publica√ß√£o promovida n√£o vai ter muita vantagem com rela√ß√£o √†s demais promovidas, que tamb√©m ser√£o em grande quantidade.

O √∫nico diferencial real seria negativo, ou seja, a segrega√ß√£o de quem n√£o tem TabCash, como os novos usu√°rios, que dificilmente conseguiriam ganhar seus primeiros TabCash, j√° que estar√≠amos em um caso em que as promovidas tem muito mais vantagens sobre as n√£o promovidas.

Esse caso de valer muito a pena usar TabCash nos levaria para o [paradoxo de Braess](https://pt.wikipedia.org/wiki/Paradoxo_de_Braess), onde cada indiv√≠duo vai levar mais vantagem se agir de uma certa forma que n√£o √© a melhor quando se pensa no coletivo. Para quem n√£o conhece o paradoxo, ontem √† noite o Daniel Nunes postou um v√≠deo muito legal:

[PARADOXO DE BRAESS: Construir Estradas PIORA o Tr√¢nsito?](https://www.youtube.com/watch?v=a0PM0D4Z9wA)

>> Coment√°rio de rodrigoKulb:
@aprendendofelipe concordo plenamente, desta forma para resolver √© simples.

Uma postagem quando **patrocinada** com TabCash para ganhar mais visualiza√ß√£o, o usu√°rio n√£o poderia receber novas TabCoins com upvote, assim que o per√≠odo de patroc√≠nio encerrar. Voltaria normalmente.

Desta forma uma postagem sempre ser√° uma postagem, apenas entrar em uma fase de patrocinada ou n√£o.

Temos algum problema nessa l√≥gica?

>> Coment√°rio de Gabriel-Tapes:
O ponto que acredito que necessite de mais aten√ß√£o √© esse:

> Consomem TabCash do autor a cada diferente usu√°rio que qualificar (seja voto positivo ou negativo) ou comentar

Perder TabCash para cada coment√°rio pode desincentivar conte√∫dos que gerem engajamento, pois s√≥ iria gastar mais tabcash, j√° que comentar √© de gra√ßa e ainda pode gerar tabcoins para quem comenta.

Talvez algo importante de ser lembrado √© que, mesmo que seja revenue share e a publica√ß√£o seja impulsionada, ainda deve seguir as regras de conduta do site, portanto o conte√∫do de valor deve ser mais valorizado nesse caso. Um caminho que poderia ser seguido √© que as qualifica√ß√µes positivas recebidas pelo post no per√≠odo de impulso valham o dobro, mas de forma que o autor n√£o as receba. Perceba que por si s√≥, nos moldes atuais, receber mais votos positivos tamb√©m √© impulsionar a publica√ß√£o. Aliando isso ao fato de que para votar n√£o seria necess√°rio gastar tabcoins, talvez fosse importante limitar esses votos para que apenas quem tem tabcoins suficientes possam votar e um limite de 1 voto por IP (como era feito antes) para evitar manipula√ß√µes indevidas.

Existem tr√™s casos para a qual uma publica√ß√£o provavelmente ser√° impulsionada:

1. Para poss√≠velmente tirar do "limbo" uma publica√ß√£o que o autor se esfor√ßou muito ou que quer mais engajamento e destaque
2. Para testar a funcionalidade
3. Para divulga√ß√£o

Obviamente mais casos surgir√£o com o tempo, mas inicialmente acredito que sempre se encaixar√£o nesses tr√™s casos. Em qualquer dessas situa√ß√µes teremos posts possivelmente irrelevantes, que n√£o ser√£o t√£o impulsionados naturalmente (seria importante que as qualifica√ß√µes negativas tamb√©m tivessem o efeito das positivas?), mas aqueles que tiverem valor concreto seriam muito mais beneficiados, o que cumpre o objetivo do site.

Outro ponto a se atentar tamb√©m √© se ser√° poss√≠vel impulsionar mais vezes uma determinada publica√ß√£o ou se ter√£o formas de aumentar esse tempo de impulso.

>> Coment√°rio de Rafatcb:
* Sobre impulsionar publica√ß√µes.

Acho interessante a possibilidade de "impulsionar" uma publica√ß√£o (seja uma publica√ß√£o do tipo [conte√∫do + divulga√ß√£o](https://www.tabnews.com.br/faq#publicar-projeto-envolvido), seja apenas conte√∫do), mas essa din√¢mica difere um pouco do an√∫ncio b√°sico (n√£o √© tempor√°rio, j√° tem TabCoins e coment√°rios, j√° tem "tempo de vida" etc.), ent√£o acredito que podemos deixar para depois, focando no que √© realmente o mais simples e funcional poss√≠vel agora.

De toda forma, √© importante ter em mente que essa √© uma possibilidade futura, ent√£o projetamos o sistema de forma que seja poss√≠vel acomodar essa funcionalidade.

* Sobre votar sem custos.

Eu n√£o deixaria o "custo de votar" nulo em publica√ß√µes promovidas. Isso pode facilitar desnecessariamente os usu√°rios votarem negativamente em todo an√∫ncio, e hoje temos algumas facilidades que permitem o usu√°rio poder votar mais (como o login di√°rio).

Apesar disso, concordo com o autor n√£o ganhar TabCoins de votos recebidos em uma publica√ß√£o promovida.

* Sobre o espa√ßo fixo para as publica√ß√µes promovidas.

Eu concordo que um espa√ßo fixo n√£o √© legal para isso, as publica√ß√µes podem estar "misturadas" com as outras relevantes, numa ordem que fa√ßa sentido.

* Sobre identificar as publica√ß√µes promovidas.

Como dito [nesse v√≠deo](https://youtu.be/bYBVCxVwrdY?si=mb8Jxcu8c7E0sC11&t=487), acho importante ficar claro que aquilo √© um an√∫ncio, e que o an√∫ncio est√° contribuindo com o usu√°rio X. Esse uso de palavras pode mudar a percep√ß√£o do leitor, principalmente para n√£o chegarmos num ponto onde os usu√°rios negativem qualquer an√∫ncio simplesmente por ser um an√∫ncio.

Outro ponto que citei em https://github.com/filipedeschamps/tabnews.com.br/issues/1490#issuecomment-1967740034, as "publica√ß√µes promovidas" podem ser mais comerciais, e se n√£o estiverem marcadas devidamente, os usu√°rios podem achar que a publica√ß√£o deveria ser removida. Imagino que uma publica√ß√£o promovida extremamente comercial n√£o ser√° bem recebida, mas pode ser um pouco melhor recebida se devidamente identificada, j√° que a forma de avaliar pode mudar: "√© uma propaganda, mas gostei da ferramenta/projeto/...".

Claro, podemos ter o problema de quem usa a API passar a ignorar isso, ou bloquearem usando uma extens√£o do navegador, mas acho que vale correr o risco inicialmente. Em alguns cen√°rios de c√°lculo do "custo do an√∫ncio" (para o anunciante), essa situa√ß√£o n√£o implicar√° em um maior custo por um retorno menor. Por exemplo, se o custo for por intera√ß√µes (coment√°rios/votos), ou for por visualiza√ß√£o na p√°gina da publica√ß√£o (e n√£o no `/relevantes`, por exemplo). Isso muda se o c√°lculo for por tempo que o an√∫ncio est√° no ar (o que n√£o me parece legal) ou por visualiza√ß√µes no `/relevantes`.

Minha sugest√£o aqui seria "pagarmos para ver" no in√≠cio.

* Sobre como ser√° o custo de criar e manter uma publica√ß√£o promovida.

Bom, vi alguns coment√°rios sobre "pagar" para criar, para definir uma quantidade de TabCoins iniciais, para receber votos, coment√°rios, e para definir o tempo que ficar√° como promovida.

Para simplificar, eu gostaria de sugerir tirar o tempo da equa√ß√£o. Podemos come√ßar de forma que toda publica√ß√£o promovida fique promovida por 24 horas. Escolher o tempo traz um pouco de complexidade, e o usu√°rio poderia ser esperto e deixar promovida apenas nos hor√°rios que h√° mais p√∫blico, e de madrugada n√£o teria nenhuma publica√ß√£o promovida, por exemplo.

E talvez, a princ√≠pio, experimentaria n√£o "cobrar" por receber coment√°rios.

**Edit 16/03/2024:** Sugiro tamb√©m que o custo de TabCoins iniciais n√£o aumente linearmente, mas sim que, quanto mais TabCoins, mais caro. Ou seja, supondo que o primeiro TabCoin custe 1 TabCash, se eu quiser criar uma publica√ß√£o com 10 TabCoins, n√£o vou gastar 10 TabCash, mas sim 30, por exemplo (n√∫meros aleat√≥rios).

### Algumas sugest√µes adicionais

- Apesar dos an√∫ncios serem tempor√°rios, √© interessante deixarmos salvos e acess√≠veis para podermos exibir estat√≠sticas futuramente.
- Cria√ß√£o de uma `feature` para poder anunciar. Como mencionei em https://github.com/filipedeschamps/tabnews.com.br/issues/1490#issuecomment-1967740034, inicialmente a ideia era isso ser "compr√°vel", mas acho que podemos come√ßar liberando para alguns usu√°rios como "beta fechado", mesmo que seja algo tempor√°rio.
- Criar uma (ou mais) pergunta e resposta no FAQ na vers√£o inicial e ir adaptando nas vers√µes seguintes.
- Limitar a quantidade de publica√ß√µes promovidas na plataforma ao mesmo tempo. Como ser√£o ordenadas por relev√¢ncia (boost inicial + votos dos usu√°rios), e n√£o ficar√£o rotacionando, creio que podemos limitar a 3 publica√ß√µes promovidas por vez (10% do total de publica√ß√µes exibidas na p√°gina).
- Talvez destacar a publica√ß√£o promovida tamb√©m na lista de Recentes, para caso ela saia dos Relevantes devido aos votos? Ou quando isso ocorrer a publica√ß√£o deixar√° de ser promovida e n√£o ser√° mais acess√≠vel? Acho que a segunda op√ß√£o adiciona mais complexidade.
- Permitir um √∫nico voto por usu√°rio/IP na publica√ß√£o promovida, para ter um impacto mais "fidedigno". Talvez isso acabe desequilibrando, deixando mais dif√≠cil torn√°-la relevante, mas acho que o "boost" de TabCoins, fora a identifica√ß√£o visual, compensar√£o isso.

Agora, uma quest√£o para elaborar mais: foi proposto que a publica√ß√£o seja despublicada ao alcan√ßar o tempo limite ou quantidade m√°xima de TabCash gasto pr√©-estabelecido. Acho o segundo caso um pouco estranho, porque digamos que foi uma propaganda que o pessoal realmente gostou, e recebeu v√°rios votos de forma relativamente r√°pida: ela desapareceria em pouco tempo.

Se definirmos que a publica√ß√£o ficar√° promovida por um tempo determinado, podemos informar isso na UI.

Fora essa √∫ltima quest√£o, e apesar de alguns poucos pontos que sugeri serem diferentes da ideia inicial, acho que d√° para o sistema funcionar bem. A maior dificuldade provavelmente ser√° encontrar o ponto de equil√≠brio de TabCash.

>> Coment√°rio de Rafatcb:
Este coment√°rio cont√©m apenas sugest√µes de como uma publica√ß√£o promovida pode ser destacada na UI. Trouxe v√°rias alternativas e tentei mostrar como meu racioc√≠nio foi evoluindo para chegar na op√ß√£o que eu mais gostei.

## A publica√ß√£o promovida

Seguindo com a ideia que mencionei em _"Sobre identificar as publica√ß√µes promovidas."_, no meu coment√°rio anterior, fiz alguns testes para elaborar melhor como isso pode ficar na pr√°tica. As imagens Mobile abaixo foram simuladas numa largura de 320px.

Vale o disclaimer que as imagens que eu coloquei para exemplificar abaixo tem como nome do autor `filipedeschamps`, mas √© uma publica√ß√£o que criei em localhost copiando partes de textos de outros lugares, apenas para dar no√ß√£o de algo real.

**1.  `Label` "An√∫ncio", ao lado do nome do usu√°rio.**

| Desktop | Mobile |
| --- | --- |
| ![Label ao nome do autor, amarelo, escrito "An√∫ncio", com o tooltip "Este an√∫ncio est√° contribuindo para o usu√°rio nome do usu√°rio"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/c780de23-1340-4dd3-a1bc-9f617a5d7d1a) | ![O memso cen√°rio que o anterior, por√©m numa tela menor. O texto da tooltip fica cortado.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/16245bdc-e1a8-4706-aca2-0de38a664a63) |

Inicialmente pensei em destacar usando um `Label` com `variant="attention"` dentro da publica√ß√£o:

No caso do exemplo Mobile, o texto da `Tooltip` fica cortado, mas isso poderia ser resolvido mudando para _"Este an√∫ncio est√° contribuindo para o autor"_, por exemplo. Mais para frente mostro outros exemplos com essa alternativa.

Acho que ser√° necess√°rio diferenciar textos para um  "An√∫ncio" e uma "Publica√ß√£o promovida", que podem funcionar exatamente da mesma forma, mas o primeiro sendo algo comercial e o segundo sendo um conte√∫do. Digo isso pensando no que j√° mencionei anteriormente, sobre publica√ß√µes (an√∫ncios) exclusivamente comerciais. Ou, ent√£o, podemos usar o adjeitvo "patrocinado", que √© mais neutro nesse cen√°rio.

Pensando sobre o prop√≥sito do `LabelGroup` que existe hoje, ao lado do nome do usu√°rio, os usos seriam coisas como: `Novo usu√°rio`, `Autor`, `Rob√¥`, `Moderador` etc. Tudo isso √© sobre o autor. Ent√£o, podemos pensar em mostrar que a publica√ß√£o √© um an√∫ncio de outra forma, para termos uma UI mais consistente.

**2. Texto negrito "Publica√ß√£o patrocinada", acima da linha do nome do usu√°rio.**

| Desktop | Mobile |
| --- | --- |
| ![Texto "Publica√ß√£o patrocinada" numa linha acima do nome do usu√°rio. O texto √© amarelo, em negrito. No hover, mostra uma tooltip com o texto "Esta publica√ß√£o est√° contribuindo para o autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/016342ff-bdce-4bae-ba0c-faacfcea40b5) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/e3c53fc5-b344-47c0-82b6-6b3e03ea5337) |

Nesse caso, usei a mesma cor do `<Label variant="attention">`, que √© `color: 'attention.fg'`. Continuei deixando o Tooltip, mas com o texto menor. E, como o texto principal est√° englobando tanto "an√∫ncios" quanto "publica√ß√µes promovidas", neutralizei o texto para "Esta publica√ß√£o est√° contribuindo para o autor". Talvez tenha ficado muito gen√©rico, e "Este patroc√≠nio est√° contribuindo para o autor" fique melhor.

**3. Texto negrito "Publica√ß√£o patrocinada com TabCash", acima da linha do nome do usu√°rio.**

| Desktop | Mobile |
| --- | --- |
| ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do nome do usu√°rio. O texto √© amarelo, em negrito. No hover, mostra uma tooltip com o texto "Este patroc√≠nio est√° contribuindo para o autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/4803f04b-ab25-495f-8373-ab7a33d9d810) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0d3ba0fc-046e-4130-9629-b2d5dc6ba23a) |

O texto "Publica√ß√£o patrocinada" √© bem curto, ent√£o temos espa√ßo para escrever "Publica√ß√£o patrocinada com TabCash". Isso deixa claro o que queremos passar com os "an√∫ncios": o TabCash tem um uso, e um desses usos √© criar uma publica√ß√£o patrocinada/promovida; o autor s√≥ conseguiu patrocinar a publica√ß√£o porque j√° criou conte√∫do, ganhou TabCoins e qualificou conte√∫dos; a plataforma n√£o "vendeu" o espa√ßo por dinheiro.

Tamb√©m mudei o Tooltip para voc√™s verem como fica na pr√°tica a alternativa que sugeri anteriormente.

**4. Texto negrito "Publica√ß√£o patrocinada com TabCash", acima da linha do nome do usu√°rio, com √≠cone.**

| √çcone | Desktop | Mobile |
| --- | --- | --- |
| [Megafone](https://primer.style/foundations/icons/megaphone-16) | ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do nome do usu√°rio. O texto √© amarelo, em negrito, e com um √≠cone de megafone antes dele. No hover, mostra uma tooltip com o texto "Este patroc√≠nio est√° contribuindo para o autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/61721ac4-bd2c-4bc8-8212-9c72ab456977) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/4c67d9fc-b3b8-48ae-a4f7-dff18b2ef723) |
| [Ad](https://react-icons.github.io/react-icons/icons/fa/) | ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do nome do usu√°rio. O texto √© amarelo, em negrito, e com um √≠cone escrito "Ad" antes dele. No hover, mostra uma tooltip com o texto "Este patroc√≠nio est√° contribuindo para o autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/3bccbaa8-8e5a-4453-97b5-e7abaa8cd75a) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/5489dc8a-65d5-47ed-9094-5cd52cf8a5c9) |

O √≠cone _pode_ dar um destaque extra. Eu estava em d√∫vida se seria uma adi√ß√£o positiva, porque a op√ß√£o 3 j√° me parecia um destaque interessante no topo da publica√ß√£o, mas decidi testar. Usei `size={14}`.

Vendo assim, refor√ßo minha opini√£o de que **n√£o** precisamos adicionar um √≠cone.

**5. Texto negrito "Publica√ß√£o patrocinada com TabCash", acima da linha do nome do usu√°rio, mantendo o alinhamento dos TabCoins com o t√≠tulo.**

| Desktop | Mobile |
| --- | --- |
| ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do nome do usu√°rio e dos TabCoins da publica√ß√£o. O texto √© amarelo, em negrito. No hover, mostra uma tooltip com o texto "Este patroc√≠nio est√° contribuindo para o autor"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/25aab0e4-7d91-4c9e-a1fd-fd7db2baf5df) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/f2b74f66-9041-4c1e-af78-0e0caefc38b9) |

Quando montei os outros exemplos, n√£o tinha percebido que eu deixei de "alinhar os TabCoins com o t√≠tulo", ent√£o criei esse para terem no√ß√£o de como ficaria "do jeito certo".

<details>
    <summary>Se quiser ver uma captura de tela completa para ter no√ß√£o de como esse texto fica junto do conte√∫do, clique aqui. Coloquei o modo escuro tamb√©m.</summary>

Desktop:

![Publica√ß√£o inteira no Desktop, conforme o exemplo 5](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9ad6091b-5e10-4451-8245-f10780d127f3)

![Publica√ß√£o inteira no Desktop, conforme o exemplo 5, no modo escuro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/5f540bf0-2f4b-407d-ae29-a7e9160b8c5d)

Mobile:

![Publica√ß√£o inteira no Mobile, conforme o exemplo 5](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/ff5cb228-8e0a-4d0d-a607-56a250a5bdcc)

![Publica√ß√£o inteira no Mobile, conforme o exemplo 5, no modo escuro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/06ba447a-db72-4adb-b3f9-6f363bdf79e4)

</details>

## A lista de conte√∫dos

O exemplo do @rodrigoKulb me inspirou para as experimenta√ß√µes que fiz no t√≥pico anterior, ent√£o decidi adaptar a ideia do t√≥pico anterior para a lista de conte√∫dos, n√£o deixando as publica√ß√µes promovidas fixas num local.

**1. Texto negrito "Publica√ß√£o patrocinada com TabCash", acima do t√≠tulo do conte√∫do.**

| Desktop | Mobile |
| --- | --- |
| ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do t√≠tulo do conte√∫do. O texto √© amarelo, em negrito.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9ebbcb1e-d0b9-417b-8172-64cfd0bdc2c7) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/ea05c442-18c9-4933-8142-2518d3292fc1) |

Mesmo padr√£o que mostrei no conte√∫do. Tamb√©m podemos ter a Tooltip aqui.

**2. Texto negrito "Publica√ß√£o patrocinada com TabCash", numa linha acima do t√≠tulo do conte√∫do e do n√∫mero da posi√ß√£o.**

| Desktop | Mobile |
| --- | --- |
| ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do t√≠tulo do conte√∫do e do n√∫mero da lista. O texto √© amarelo, em negrito.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/656caf89-4f5a-4508-aea8-22a0aa721d5f) | ![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/afc35ddb-8bad-458d-98cb-9728da548b7e) |

Aqui s√≥ mudei o alinhamento do n√∫mero da lista. Aproveitei para tirar o print numa janela an√¥nima, sem ter visitado o link, para voc√™s verem a diferen√ßa.

Acho melhor manter o n√∫mero alinhado com o t√≠tulo para a leitura continuar f√°cil, "batendo o olho" o leitor consegue entender. Fiquei em d√∫vida se esse espa√ßamento entre os itens √© pequeno demais a ponto de confundir a pessoa sobre qual √© a publica√ß√£o patrocinada.

<details>
    <summary>Se quiser ver uma captura de tela completa para ter no√ß√£o de como isso fica na lista de conte√∫dos, clique aqui. Coloquei imagens do modo escuro tamb√©m</summary>

Desktop:

![Captura da tela inteira no Desktop, conforme o exemplo 2](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/be689ad9-7fba-4ed7-892d-914056bffaf2)

![Captura da tela inteira no Desktop, conforme o exemplo 2, no modo escuro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/b5b9198a-425b-46ef-9d5c-f200aca1c7e1)

Mobile:

![Captura da tela inteira no Mobile, conforme o exemplo 2](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/3d0886d0-9707-49d0-9f6f-a82d5809294e)

![Captura da tela inteira no Mobile, conforme o exemplo 2, no modo escuro](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/5a1ec6bf-9dac-4eb2-8277-474574c7341e)

</details>

**3. Com o texto e destacando o "fundo" do item da lista.**

| Desktop | ![Texto "Publica√ß√£o patrocinada com TabCash" numa linha acima do t√≠tulo do conte√∫do. O texto √© amarelo, em negrito. Fundo do item em amarelo claro.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/cc426755-f94d-4a07-9698-2e94d637fe1d) |
| --- | --- |
| Mobile |![O mesmo cen√°rio que o anterior, por√©m numa tela menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9ef73983-123a-4b03-bb58-a9d28beef395) |

Trouxe esse exemplo para ver como ficava. √â algo similar ao que o Google fazia anos atr√°s. Para a cor de fundo, usei `attention.subtle`.

**N√£o gostei** dessa alternativa. N√£o √© terr√≠vel, ela √© vi√°vel, mas acho que est√° dando destaque demais aos an√∫ncios (mesmo a cor de fundo sendo clara), e precisar√≠amos ter uma aten√ß√£o extra aos contrastes. Al√©m disso, com os Banners causar√° uma polui√ß√£o maior ainda. Outro ponto √© que nossos olhos se acostumar√£o a ignorar isso ([_banner blindness_](https://en.wikipedia.org/wiki/Banner_blindness)).

>> Coment√°rio de aprendendofelipe:
√ìtimos estudos Rafa!

Vendo os resultados, eu acho que n√£o √© necess√°rio algo t√£o chamativo para deixar claro que √© um conte√∫do promovido.

O que acham de algo assim?

Conte√∫do | Lista
--- | ---
<img width="392" alt="Conte√∫do Patrocinado" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/c1e1f943-81a7-4b28-b7f4-725f579c5c28"> | <img width="457" alt="Conte√∫do Patrocinado na lista" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/6905a073-c7c7-4414-9bdb-ba85b447f5cd">

>> Coment√°rio de Rafatcb:
@aprendendofelipe eu gostei do uso do verde, j√° que √© a cor do TabCash. Na lista de conte√∫dos, n√£o sei se ter√≠amos casos "muito ruins", onde o nome do usu√°rio ficaria "r...", principalmente considerando a dura√ß√£o sendo algo como "22 minutos atr√°s", que √© um texto mais longo.

Na publica√ß√£o em si, voc√™ n√£o acha que pode ter aquele problema que mencionei, dos `Label`s serem mais relacionados ao autor do que ao conte√∫do? Uma alternativa pode ser como ficou na lista de conte√∫do, escrito em texto normal, colorido e sem a borda.

Eu esbocei mais algumas ideias, agora no fluxo de criar uma publica√ß√£o promovida. Eu comecei a criar estes exemplos antes do seu coment√°rio, por isso est√£o similares ao meu coment√°rio anterior, mas obviamente aqui seguir√≠amos o padr√£o adotado (cores e termos escolhidos).

Uma nova pergunta, acha melhor usarmos "Patrocinar/Patrocinado" ao inv√©s de "Promover/Promovida" em todo lugar? Eu acho que faz sentido, mas nos exemplos que criei abaixo est√° uma mistura, a depender do local onde o texto √© exibido.

## Como criar uma publica√ß√£o promovida

### Informa√ß√µes necess√°rias

Com base nos coment√°rios anteriores, esse processo pode exibir algumas informa√ß√µes e demandar outras do usu√°rio. Al√©m do necess√°rio para criar uma publica√ß√£o normal, a cria√ß√£o de uma publica√ß√£o promovida provavelmente envolver√°:

* Informar para o usu√°rio:
    * Custo em TabCash para criar.
    * Dura√ß√£o (informar, caso seja um valor fixo).
* Obter os dados:
    * TabCoins promovidos (valor inicial em TabCoins).
    * Limite de TabCash a ser gasto.
    * Dura√ß√£o (obter, caso o usu√°rio possa escolher a dura√ß√£o).

### UI

Seguindo com algumas elabora√ß√µes de UI, estou colocando aqui mais algumas ideias justamente para outras pessoas poderem opinar e j√° termos algo mais trabalhado na hora de chegar na implementa√ß√£o (ou seja, ningu√©m ser pego de surpresa ao avaliar um PR).

Independente de onde for adicionado esse fluxo, imagino que a op√ß√£o de criar uma publica√ß√£o promovida deve estar vis√≠vel apenas caso o usu√°rio tenha a feature, e habilitada apenas caso o usu√°rio possa realmente criar, por exemplo, se o limite de publica√ß√µes promovidas for X, e j√° terem X publica√ß√µes promovidas, ent√£o a a√ß√£o ficaria desabilitada com uma explica√ß√£o pr√≥xima. Algo como:

> N√£o √© poss√≠vel criar uma publica√ß√£o promovida agora, saiba mais (link para uma pergunta do FAQ que explica isso).

Ou mesmo algo espec√≠fico j√° dizendo o motivo de n√£o poder criar a publica√ß√£o promovida.

**1. Adicionar um `Checkbox` na p√°gina `/publicar` e exibir os campos espec√≠ficos quando ele estiver marcado**

![Um checkbox no fim do formul√°rio de campos para criar uma publica√ß√£o, escrito "Promover publica√ß√£o. Saiba mais.", onde o "Saiba mais" √© um link](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/b27186bf-deaf-4ddf-b65f-53bb6c5a8aec)

Essa foi a primeira ideia que passou pela minha cabe√ßa. Podemos exibir um `Checkbox` para os usu√°rios que j√° possuem a `feature` de "promover publica√ß√£o". Para dar contexto, poderia ter um link `Saiba mais` (ou outro texto) direcionando para a pergunta do FAQ sobre publica√ß√µes promovidas.

√â uma solu√ß√£o simples e discreta. O aviso para o estado `disabled` pode ser assim:

![Texto "N√£o √© poss√≠vel criar uma publica√ß√£o promovida agora. Saiba mais." abaixo do Checkbox. O "Saiba mais" √© um link](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/cdbff5bd-22d7-4d29-aa98-a4bcd8e70af1)

Aqui, o `Saiba mais` tamb√©m √© um link para o FAQ (outra pergunta). Usei o `FormControl.Caption` para exibir a mensagem.

Os campos relacionados √† uma publica√ß√£o promovida podem ser exibidos ao marcar o `Checkbox`:

| Desktop | Mobile |
| --- | --- |
| ![Abaixo do checkbox "Promover publica√ß√£o. Saiba mais" marcado, tr√™s campos na mesma linha: "TabCoins promovidos" com a legenda "Sua publica√ß√£o iniciar√° com 1 TabCoin.", "Limite de TabCash" com a legenda "Ao atingir o limite, a publica√ß√£o ser√° removida." e "Limite de tempo (em horas)" com a legenda "Tempo m√°ximo que a publica√ß√£o ficar√° vis√≠vel.", seguido por "Custo inicial: 32 TabCash" numa nova linha, em negrito, amarelo.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/028af8d7-10e9-4217-8c8f-ba1e535485a3) | ![O mesmo cen√°rio da imagem anterior, mas numa tela pequena. Cada campo fica numa linha diferente.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/56a942cb-950c-4b52-a75b-9d8263c0ea77) |

N√£o consegui pensar numa boa exibi√ß√£o para os campos, j√° que eles tem valores curtos. Tentei buscar um equil√≠brio entre o tamanho do `Label` e do `Caption` para os campos serem auto-explicativos. Nos exemplos acima, a largura dos `TextInput`s est√° em `100px` e os dois primeiros `FormControl`s est√£o com `sx={{ flex: '1 1 160px' }}`, e o terceiro `sx={{ flex: '1 1 204px' }}`.

Depois de ter visto o exemplo do @aprendendofelipe , tive uma outra ideia de como exibir o custo, que acho mais consistente com nossa UI:

| `fontSize` n√£o especificado | ![Texto "Custo inicial: 32 TabCash" sem negrito e na cor preta normal, mas com o √≠cone do TabCash](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/2b5ae00f-9054-4443-a70e-3794f67c3bb2) |
| --- | ---
| `fontSize: 1` | ![Mesma imagem que a anterior, por√©m com o texto menor](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/b9d298ee-9f98-4282-b607-04b507a4e136) |

Sem especificar o `fontSize`, o texto fica maior do que o resto da p√°gina (`Label`s, `Caption`s e o texto dos campos obrigat√≥rios), ent√£o coloquei tamb√©m uma imagem com o `fontSize: 1`.

**2. Nova p√°gina para criar publica√ß√£o promovida, com link dentro do pr√≥prio perfil**

| Desktop | Mobile |
| --- | --- |
| ![Perfil do usu√°rio, numa tab escrita "Publica√ß√µes promovidas", mostrando uma lista de publica√ß√µes. A primeira est√° com um texto negrito amarelo "Publica√ß√£o patrocinada com TabCash", a segunda n√£o.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/18a5acb8-4152-4aa3-8df5-de85e174fa4a) | ![O mesmo cen√°rio da imagem anterior, mas numa tela pequena.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/a1b5c72e-2458-4654-a86a-766f78ba5955) |

Outra op√ß√£o √© criar uma publica√ß√£o promovida numa p√°gina pr√≥pria. Isso n√£o √© totalmente necess√°rio, mas foi a √∫nica alternativa ao exemplo anterior que consegui pensar. Eu havia pensado nisso inicialmente para evitar que o usu√°rio criasse uma promovida sem querer, por exemplo, mas como ele precisar√° preencher novos campos, n√£o acho que isso √© um problema.

Essa nova p√°gina pode ser acessada atrav√©s de uma tab no pr√≥prio perfil onde o usu√°rio pode ver as publica√ß√µes promovidas (ativas ou inativas) e mais detalhes sobre elas, j√° que o seu hist√≥rico de publica√ß√µes promovidas n√£o ficar√° dispon√≠vel na aba "Publica√ß√µes" do perfil (l√° pode ser exibida a publica√ß√£o promovida que _est√° ativa_).

Al√©m das publica√ß√µes que j√° foram promovidas, a lista pode conter todos os tipos de an√∫ncios, e o bot√£o "Criar publica√ß√£o" pode ser um bot√£o com o √≠cone de tr√™s pontos (`KebabHorizontalIcon`), onde exibir√° o `ActionMenu` com op√ß√µes para criar uma publica√ß√£o promovida, um banner etc. A princ√≠pio, apenas o pr√≥prio usu√°rio teria acesso √† essa p√°gina, mas podemos criar uma permiss√£o para que moderadores vejam o hist√≥rico de an√∫ncios de outros usu√°rios.

Ao clicar no bot√£o _"Criar publica√ß√£o"_, redirecionar√≠amos para uma p√°gina `/publicar-promovida`, por exemplo, que seria parecida com a `/publicar`, por√©m com um texto mais claro de que est√° criando uma publica√ß√£o promovida. Talvez a √∫nica diferen√ßa acabasse sendo o `h1` e n√£o ter um checkbox. Depois de ter feito a op√ß√£o 1, acho que n√£o precisamos de uma p√°gina espec√≠fica para criar uma publica√ß√£o promovida.

**3. Aba de publica√ß√µes promovidas dentro do pr√≥prio perfil, com link para `/publicar`**

Tamb√©m podemos optar por uma mistura da op√ß√£o `1` e `2`, onde existir√£o dois caminhos para criar uma publica√ß√£o promovida:

1. Indo direto para `/publicar`; ou
2. Indo no perfil, vendo as publica√ß√µes promovidas/an√∫ncios e clicando no bot√£o `Criar publica√ß√£o`, que redirecionar√° para `/publicar`, mas com o `Checkbox` _"Promover publica√ß√£o. Saiba mais."_ marcado.

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe eu gostei do uso do verde, j√° que √© a cor do TabCash.

Pensei no verde por esse motivo mesmo, mas para exemplificar usei o padr√£o do label ao inv√©s de usar a mesma cor do TabCash. Escolhendo o verde mesmo, que por mim est√° legal, podemos ver qual tom fica melhor.

---

> Na lista de conte√∫dos, n√£o sei se ter√≠amos casos "muito ruins", onde o nome do usu√°rio ficaria "r...", principalmente considerando a dura√ß√£o sendo algo como "22 minutos atr√°s", que √© um texto mais longo.

Sim, isso iria ocorrer em telas muito pequenas, onde acho que poder√≠amos omitir o saldo de TabCoins para ficar melhor.

E pensando em omitir o saldo de TabCoins, me ocorreu agora que talvez fa√ßa sentido omitir sempre o saldo dos promovidos na lista de conte√∫dos, j√° que o n√∫mero em si ser√° algo artificial. Podemos talvez mostrar o detalhamento dos votos junto dos TabCoins promovidos no mesmo Tooltip. Algo a se pensar...

Ficaria como abaixo, onde tamb√©m j√° coloquei o tom verde de TabCash, pois me pareceu melhor, principalmente no modo dark:

<img width="346" alt="Conte√∫do patrocinado" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/407c728c-92c8-4ce2-a993-e38163548c97">

---

> Na publica√ß√£o em si, voc√™ n√£o acha que pode ter aquele problema que mencionei, dos `Label`s serem mais relacionados ao autor do que ao conte√∫do? Uma alternativa pode ser como ficou na lista de conte√∫do, escrito em texto normal, colorido e sem a borda.

Acho que os labels n√£o precisam ser somente sobre o autor. Acho que podem ser tamb√©m sobre o conte√∫do, mas vamos ver como fica sem a borda. üëç

---

> Uma nova pergunta, acha melhor usarmos "Patrocinar/Patrocinado" ao inv√©s de "Promover/Promovida" em todo lugar? Eu acho que faz sentido, mas nos exemplos que criei abaixo est√° uma mistura, a depender do local onde o texto √© exibido.

Como palavra √∫nica que j√° expressa o que queremos, eu acabei gostando mais de "patrocinado" do que "promovido", mas para o verbo gosto mais de "promover" do que de "patrocinar".

Talvez para deixar ainda mais claro, e menos repetitivo, pode mudar o Tooltip para "Promovido com TabCash", mesmo mantendo a palavra "Patrocinado" no destaque me verde. Eu acho melhor se der para unificar, mas √© mais importante deixar claro, ent√£o √© melhor saber outras opini√µes sobre isso...

---

Gostei das sugest√µes para criar a publica√ß√£o, e acho que √© bom deixar mais de um caminho para chegar at√© l√°.

O endere√ßo da p√°gina pode ser o mesmo de publicar qualquer conte√∫do, pois acho que isso facilita para os usu√°rios. Caso contr√°rio teremos que criar um modo f√°cil do usu√°rio migrar os dados de uma p√°gina para a outra, caso ele tenha come√ßado a criar no lugar errado.

Uma alternativa legal para se testar √© usar um Dialog com os campos extras.

>> Coment√°rio de Rafatcb:
@aprendendofelipe n√£o sei se voc√™ j√° come√ßou a implementar algo. Eu estou apenas pensando em como poderia ser feito. Como parece que os campos mencionados nos coment√°rios anteriores seriam o suficiente para criar um an√∫ncio, comecei a pensar na parte da API e do banco de dados.

Neste coment√°rio j√° vou colocar alguns nomes de campos, propriedades e tabela do banco de dados, ent√£o se terem sugest√µes melhores, podem falar.

Tem bastante informa√ß√£o aqui, e eu acabei escrevendo num "vai e volta", complementando conforme percebia detalhes, ent√£o se algo ficou incompleto ou inconsistente, me avise tamb√©m.

## Cria√ß√£o de uma publica√ß√£o patrocinada

### API: `POST /api/v1/contents`

Como (muito provavelmente) usaremos a mesma tela para criar uma publica√ß√£o normal e uma publica√ß√£o patrocinada, podemos usar o mesmo endpoint, adicionando uma funcionalidade sem quebrar o comportamento atual.

```diff
{
  title: string,
  body: string,
  status: 'published' | 'draft',
  source_url: string | undefined,
+   sponsor: {
+     initial_tabcoins: number,
+     max_tabcash: number,
+     max_hours: number,
+   }
}
```

Pensando sobre, eu gostei da ideia de adicionar um novo atributo (no caso, `sponsor`) que conter√° todas as informa√ß√µes necess√°rias para criar um conte√∫do patrocinado (ou, futuramente, promover um conte√∫do existente). Assim, deixamos essa funcionalidade "encapsulada", facilitando a valida√ß√£o e deixando claro que os atributos aninhados (`initial_tabcoins`, `max_tabcash` e `max_hours`) est√£o relacionados √† essa funcionalidade.

### Banco de dados

Hoje, em `contents`, temos `id`, `parent_id`, `owner_id`, `slug`, `title`, `body`, `status`, `source_url`, `published_at`, `created_at`, `updated_at`, `deleted_at` e `path`.

Pensando numa flexibilidade em tratar diferentes tipos de an√∫ncio de uma forma parecida, me parece compensar criar uma tabela para eles. Talvez `advertisements`. Acho o nome um pouco complicado mas n√£o consegui pensar em algo melhor (`ads`?).

Essa nova tabela poderia armazenar informa√ß√µes √∫teis sobre todo tipo de an√∫ncio. 

Levando em considera√ß√£o o que √© importante para a cria√ß√£o de uma publica√ß√£o promovida (`initial_tabcoins`, `max_tabcash` e `max_hours`), a primeira informa√ß√£o ficar√° armazenada em `balance_operations`, ent√£o sobram `max_tabcash` e `max_hours`.

Ambas s√£o relevantes para o caso de um an√∫ncio de **custo vari√°vel**. Temos que pensar tamb√©m que um outro tipo de an√∫ncio pode ter um custo inicial X e nenhum custo vari√°vel.

Dito isso, o que seria interessante de ter numa tabela de an√∫ncios?

* `id`: Identificador do an√∫ncio.
* `deactivate_at`: Hor√°rio que o an√∫ncio sair√° do ar, calculado a partir do `max_hours`. Talvez esse n√£o seja o melhor nome porque, no caso de publica√ß√µes promovidas, poder√° sair do ar antes (o custo √© vari√°vel e o TabCash do autor pode acabar, ou o autor pode desativar o an√∫ncio manualmente), mas isso pode ser relevante para estat√≠sticas futuras, por exemplo, o usu√°rio planejou desativar um an√∫ncio ap√≥s 3 dias, mas ele foi desativado em 1 dia.
* `max_tabcash`: Para a publica√ß√£o promovida, isso √© definido. Para um an√∫ncio de custo fixo, poderia ser o pr√≥prio custo ou `null`. Esse detalhe pode ser discutido no issue espec√≠fico do an√∫ncio de gasto fixo, o importante aqui √© s√≥ definir se faz sentido ter essa coluna considerando os cen√°rios poss√≠veis.
* `type`: Como poder√£o existir diferentes tipos de an√∫ncio, como banner e publica√ß√£o promovida, especificar o tipo aqui pode ser √∫til. Imagino que tamb√©m podemos usar isso para diferenciar uma publica√ß√£o tempor√°ria patrocinada de uma publica√ß√£o permanente, o que mudar√° o que acontece ap√≥s o t√©rmino do patroc√≠nio. Podemos ter, por exemplo, `sponsored_content` e `sponsored_temporary_content` como tipos.
* `created_at`, `updated_at`, `deactivated_at`: Faz sentido armazenarmos esses campos tamb√©m? Note que aqui optei por `deactivated_at` ao inv√©s de `deleted_at`. Essa nomenclatura me parece fazer mais sentido para o cen√°rio de an√∫ncios, mas √© algo debat√≠vel.
* `status`: `active`, `deactivated`. Faz sentido?
* `content_id`: Pensando em relacionar o an√∫ncio com a publica√ß√£o, essa foi a √∫nica forma que me veio na cabe√ßa (al√©m de criar um evento e procurar por l√°, o que seria custoso). Os outros tipos de an√∫ncio teriam que salvar este valor como `null`, ent√£o gostaria de mais opini√µes em como tratar isso de forma adequada.

A quantidade de TabCash gasto no an√∫ncio, seja ele fixo ou vari√°vel, pode ser obtida pelo `balance_operations`, como √© feito com os TabCoins de conte√∫dos e usu√°rios, e com o TabCash de usu√°rios.

PS: `deactivate_at` e `deactivated_at` s√£o nomes bem parecidos e podem causar confus√£o na hora de programar e na revis√£o do c√≥digo.

### Eventos

Hoje, ao criar uma publica√ß√£o, criamos um evento e depois atualizamos ele com `metadata`:

```ts
{
  type: 'create:content:text_root',
  originatorUserId: string,
  originatorIp: string,
  metadata: {
    id: string
  }
}
```

Agora que j√° refleti sobre quais dados poder√≠amos armazenar especificamente sobre a publica√ß√£o patrocinada na tabela pr√≥pria de an√∫ncios, consigo pensar melhor sobre o que armazenar no evento.

Procurando manter o padr√£o, podemos armazenar apenas o `id` do an√∫ncio. Saindo do padr√£o, podemos armazenar tamb√©m a quantidade de TabCash que o usu√°rio tinha no momento de cria√ß√£o da publica√ß√£o patrocinada. N√£o sei se isso faz sentido.

A partir daqui, vejo duas op√ß√µes ao criar uma publica√ß√£o patrocinada:

**1. Armazenar novos dados no evento criado.**

Podemos armazenar os dados discutidos acima no `metadata` do evento `create:content:text_root`:

```ts
{
  type: 'create:content:text_root',
  originatorUserId: string,
  originatorIp: string,
  metadata: {
    id: string,
    advertisement_id: string,
    user_tabcash: number
  }
}
```

**2. Criar o evento `create:content:text_root`, mas tamb√©m criar um novo evento espec√≠fico (`sponsor:text_root`).**

Outra op√ß√£o √© criar, al√©m do `create:content:text_root`, um novo evento para um conte√∫do patrocinado, j√° tendo em mente que futuramente poderemos promover um conte√∫do j√° publicado, onde criar√≠amos este evento tamb√©m.

Acredito que assim facilitar√° a busca desse tipo de evento (conte√∫do patrocinado) sem precisar buscar por algo armazenado no `metadata`. 

Os dados armazenados em `metadata` seriam os mesmos da op√ß√£o `1`, com uma leve mudan√ßa, j√° que o `metadata.id` seria o identificador do an√∫ncio, e n√£o do conte√∫do:

```ts
{
  type: 'sponsor:text_root',
  originatorUserId: string,
  originatorIp: string,
  metadata: {
    id: string,
    content_id: string,
    user_tabcash: number
  }
}
```

Podemos seguir esse mesmo racioc√≠nio com outros tipos de an√∫ncio, como o an√∫ncio em banner (que √© outro issue) que poderia ser `sponsor:banner`, por exemplo.

N√£o sei se vale a pena diferenciar o tipo aqui tamb√©m, como mencionei na tabela `advertisement`, criando um tipo `sponsor:text_root:temporary` e outro `sponsor:text_root`.

### Atualiza√ß√£o do saldo

Precisar√≠amos criar um registro em `balance_operations` sobre o gasto de TabCash do usu√°rio, assim como j√° ocorre ao ganhar TabCoins/TabCash e ao perder Tabcoins.

Em `balanceType` existem os tipos `user:tabcoin`, `user:tabcash`, `content:tabcoin:initial`, `content:tabcoin:credit` e `content:tabcoin:debit`. O `amount` pode ser um valor positivo ou negativo. Dito isso, n√£o ter√≠amos nenhuma novidade:

```ts
{
  balanceType: 'user:tabcash',
  recipientId: string, // id do usu√°rio
  amount: number, // negativo, valor gasto para promover a publica√ß√£o
  originatorType: 'event',
  originatorId: string // id do evento `create:content:text_root` (op√ß√£o 1) ou `sponsor:text_root` (op√ß√£o 2) 
}
```

O custo de TabCash n√£o foi definido ainda.

## Voto em publica√ß√£o patrocinada

### API: `POST /api/v1/contents/[username]/[slug]/tabcoins`

Nada muda na interface.

O comportamento ser√° diferente. Ao inv√©s de dar TabCash ao autor do conte√∫do, ir√° consumir. Se o autor ficar sem TabCash, a publica√ß√£o deve deixar de ser patrocinada.

Sobre o consumo de TabCoins para votar e o limite de votos, n√£o foi definido (eu dei uma opini√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/1491#issuecomment-1970168518 diferente do que havia sido sugerido em outros coment√°rios).

### Eventos

Hoje o evento criado √©:

```ts
{
  type: 'update:content:tabcoins',
  originatorUserId: string,
  originatorIp: string,
  metadata: {
    transaction_type: 'credit' | 'debit',
    from_user_id: string,
    content_owner_id: string,
    content_id: string,
    amount: 2
  }
}
```

A mudan√ßa no evento acima depender√° de uma mudan√ßa do comportamento, isto √©, se haver√° cobran√ßa de TabCoins ou n√£o (`amount` = `2` ou `0`). Fora o `amount`, acredito que o resto permane√ßa igual.

### Atualiza√ß√£o do saldo

Hoje acontecem quatro atualiza√ß√µes no saldo:

1. `user:tabcoin`: quem votou, perde `2` TabCoins.
2. `user:tabcash`: quem votou, ganha `1` TabCash.
3. `user:tabcoin`: o autor da publica√ß√£o ganha ou perde `1` TabCoin.
4. `content:tabcoin:credit` ou `content:tabcoin:debit`: o conte√∫do ganha ou perde `1` TabCoin.

Dever√° ser atualizado para:

1. `user:tabcoin`: com a mudan√ßa de comportamento, pode continuar igual ou n√£o existir mais.
2. `user:tabcash`: com a mudan√ßa de comportamento, pode continuar igual ou n√£o existir mais.
3. `user:tabcash`: depende da mudan√ßa de comportamento. Talvez o autor perca TabCash apenas se for um voto positivo, talvez perca sendo positivo ou negativo. Imagino que o valor ser√° `1` TabCash (n√£o me lembro de ter visto um coment√°rio sugerindo outro valor).
4. `content:tabcoin:credit` ou `content:tabcoin:debit`: o conte√∫do ganha ou perde `1` TabCoin. (sem mudan√ßas)

## Obter publica√ß√£o patrocinada

### API: `GET /api/v1/contents/[username]/[slug]` e `GET /api/v1/contents/[username]/[slug]`

Aqui ser√° necess√°rio verificar se a publica√ß√£o √© patrocinada.

Na API, imagino que poder√≠amos passar um `is_sponsored: true`. O que acham? Para isso, vou colocar duas op√ß√µes que consegui imaginar:

**1. Realizar um `JOIN` para verificar se a publica√ß√£o existe na tabela `advertisements`, e se o registro mais recente ainda est√° ativo.** Talvez isso "pese" nas consultas.

**2. Criar uma coluna a mais na tabela `contents` que indica se est√° patrocinada ou n√£o**. Ainda precisar√≠amos verificar em algum momento se a publica√ß√£o est√° patrocinada para atualizar o valor dessa coluna.

## Atualizar publica√ß√£o patrocinada

### API: `PATCH /api/v1/contents/[username]/[slug]`

Al√©m do que j√° existe hoje, podemos permitir o usu√°rio alterar o gasto m√°ximo de TabCash e o tempo de dura√ß√£o caso seja uma publica√ß√£o patrocinada e ativa. Podemos continuar passando o objeto `sponsor`, como na cria√ß√£o, mas apenas com `max_tabcash` e `max_hours`.

Acredito que n√£o devemos ter nenhuma restri√ß√£o ao atualizar um conte√∫do patrocinado: tudo bem atualizar o t√≠tulo, corpo e fonte, e tamb√©m atualizar o `status` para `deleted`, sem reembolsar o TabCash gasto.

No caso de `deleted`, j√° podemos atualizar a tabela `advertisements`, caso a criemos.

Caso seja uma publica√ß√£o **n√£o patrocinada**, eu sugiro permitir promov√™-la, mas n√£o agora, para n√£o deixar a primeira fase de implementa√ß√£o ainda mais complexa. Nesse caso, s√≥ precisaria passar o objeto `sponsor` que sugeri no t√≥pico sobre a cria√ß√£o da publica√ß√£o, com `max_tabcash`, `max_hours` e `initial_tabcoins`.

---

## D√∫vidas

**O que fazer quando acabar o per√≠odo de uma publica√ß√£o tempor√°ria patrocinada?**

Considerando que vamos criar a publica√ß√£o na tabela `contents`, ap√≥s o per√≠odo ela ficar√° como `deleted`?

**E quando isso ser√° verificado?**

Ter√° um tipo de `cronjob`, al√©m de uma verifica√ß√£o quando a publica√ß√£o receber votos (para verificar se o autor ainda possui TabCash dispon√≠vel), ou ser√° verificado sempre que ter um `GET` na lista de conte√∫dos para ver se o tempo acabou?

---

**Uma forma de burlar ao promover uma publica√ß√£o "permanente"**

Futuramente, ao permitirmos promover uma publica√ß√£o existente, surgir√° uma preocupa√ß√£o: a pessoa usar os Tabcoins iniciais para impulsionar e depois remover o patroc√≠nio. Assim, a publica√ß√£o ter√° destaque em Relevantes por causa dos TabCoins, mas n√£o aparecer√° como patrocinada e nem custar√° TabCash quando o autor receber votos positivos.

Estou colocando isso aqui apenas para n√£o esquecer desse detalhe. De in√≠cio, n√£o ser√° uma preocupa√ß√£o porque a publica√ß√£o desaparecer√°, j√° que √© tempor√°ria.

>> Coment√°rio de aprendendofelipe:
√ìtimos pontos @Rafatcb! üí™

Voc√™ focou, mas acho melhor focarmos ainda mais nas publica√ß√µes promovidas, sem querer j√° deixar "preparado" para outros tipos de an√∫ncios, pois depois podem (ou n√£o) ser criadas tabelas/formul√°rios/fluxos totalmente diferentes para cada tipo. Um √∫nico tipo de an√∫ncio j√° √© complexidade suficiente, e j√° vai exigir quebrar o problemas em diversos menores. 

### Publica√ß√µes promovidas

Eu pensei nesse nome "publica√ß√£o promovida" para aproveitarmos o que der do que j√° foi pensado para as publica√ß√µes, al√©m de mostrar eles na lista de conte√∫dos, mas n√£o pensando em poder realmente promover um conte√∫do. An√∫ncios ser√£o an√∫ncios, apenas poder√£o ter um formato parecido com o dos conte√∫dos, ou seja, um t√≠tulo, o corpo em markdown e um link destacado no final (que provavelmente n√£o ser√° uma fonte, mas uma chamada para a√ß√£o).

Dito isso, acho que n√£o precisamos (nem devemos) deixar preparado para lidar com transforma√ß√£o de publica√ß√£o em an√∫ncio e vice-versa, e nem salvar nada dos an√∫ncios na tabela de conte√∫dos. Os eventos e endpoints provavelmente ser√£o apenas parecidos com os dos conte√∫dos.

### Tabela Balance Operations

Acho que compensa colocar como pr√©-requisito a separa√ß√£o em diferentes tabelas antes de come√ßarmos as transa√ß√µes com TabCash.

Ou s√≥ eu que enxergo TabCoins de conte√∫dos, TabCoins de usu√°rios e TabCash como tr√™s ativos completamente diferentes? Eles nunca precisar√£o ser computados juntos.

>> Coment√°rio de Rafatcb:
> e nem salvar nada dos an√∫ncios na tabela de conte√∫dos

Entendi. Ent√£o, publica√ß√µes patrocinadas (an√∫ncios) e promovidas ("normais impulsionadas") ser√£o duas coisas diferentes mesmo, apesar de terem algumas caracter√≠sticas em comum.

> Ou s√≥ eu que enxergo TabCoins de conte√∫dos, TabCoins de usu√°rios e TabCash como tr√™s ativos completamente diferentes? Eles nunca precisar√£o ser computados juntos.

Eu enxergo como tr√™s coisas diferentes tamb√©m, mas os TabCoins e TabCash do usu√°rio s√£o computados juntos para retornar com os dados do usu√°rio, al√©m do caso do voto, que muda o saldo de TabCoin e TabCash do mesmo usu√°rio. Acha que vale a pena separar em tr√™s tabelas mesmo?

>> Coment√°rio de aprendendofelipe:
> Entendi. Ent√£o, publica√ß√µes patrocinadas (an√∫ncios) e promovidas ("normais impulsionadas") ser√£o duas coisas diferentes mesmo, apesar de terem algumas caracter√≠sticas em comum.

Sim, e pode ser at√© que as impulsionadas nunca sejam implementadas.

> > Ou s√≥ eu que enxergo TabCoins de conte√∫dos, TabCoins de usu√°rios e TabCash como tr√™s ativos completamente diferentes? Eles nunca precisar√£o ser computados juntos.
> 
> Eu enxergo como tr√™s coisas diferentes tamb√©m, mas os TabCoins e TabCash do usu√°rio s√£o computados juntos para retornar com os dados do usu√°rio, al√©m do caso do voto, que muda o saldo de TabCoin e TabCash do mesmo usu√°rio.

Mas n√£o √© junto no sentido de se beneficiar dos dados estarem na mesma tabela.

> Acha que vale a pena separar em tr√™s tabelas mesmo?

Acredito que sim üëç

>> Coment√°rio de Rafatcb:
@aprendendofelipe imagino que a pr√≥xima etapa seja elaborar o esquema da nova tabela para esse tipo de an√∫ncio, conforme as necessidades que foram discutidas acima, certo?

>> Coment√°rio de Rafatcb:
## Banco de dados

### Tabela para publica√ß√µes patrocinadas

Pensando no banco de dados e reaproveitando algumas coisas que comentei em https://github.com/filipedeschamps/tabnews.com.br/issues/1491#issuecomment-2002219992, podemos ter uma tabela `sponsored_posts` para representar as publica√ß√µes patrocinadas. As colunas seriam:

- `id`
- `owner_id`: Usu√°rio que criou a publica√ß√£o patrocinada.
- `title`
- `body`: Acho interessante ser obrigat√≥rio; n√£o me parece que uma publica√ß√£o patrocinada sem texto seria bem recebida.
- `link`: O link que est√° sendo patrocinado (parecido com a fonte de uma publica√ß√£o). Obrigat√≥rio.
- `deactivate_at`: Hor√°rio que o an√∫ncio sair√° do ar, calculado a partir do "tempo m√°ximo" informado pela UI/API.
- `max_tabcash_cost`: Quantidade limite de TabCash que o an√∫ncio consumir√° at√© sair do ar.
- `created_at`
- `updated_at`
- `deactivated_at`: O an√∫ncio pode ser desativado antes do `deactivate_at` de forma manual, pelo limite de consumo de TabCash ou por falta de TabCash do autor.
- `status`: `active` ou `deactivated`.

O `initial_tabcoins`, que ser√° um dado informado ao criar uma publica√ß√£o patrocinada, pode ser obtido atrav√©s da tabela de saldos.

### Saldo

Eu sugeri que os votos em publica√ß√µes patrocinadas continuem consumindo TabCoins de quem votou. Pelo o que me lembro, ningu√©m concordou nem discordou. Se essa sugest√£o for aceita, ent√£o ser√° criado um `debit` em `content_tabcoin_operations` como j√° √© feito em "votos normais" hoje.

Entretanto, do lado do autor da publica√ß√£o, ao inv√©s de ganhar TabCash, perder√°. Se formos seguir o padr√£o de `content_tabcoin_operations`, ent√£o podemos criar uma coluna `balance_type` na tabela `user_tabcash_operations` com os tipos `credit` e `debit`. Ap√≥s a migra√ß√£o, todos os valores existentes hoje seriam do tipo `credit`.

Ao criar uma publica√ß√£o patrocinada, o autor tamb√©m perde TabCash, e acredito que podemos seguir o mesmo racioc√≠nio do par√°grafo anterior.

Por fim, temos o saldo de TabCoins da publica√ß√£o patrocinada. O comportamento √© muito parecido com o de `contents`, com os valores `initial`, `credit` e `debit`, mas a publica√ß√£o patrocinada est√° na tabela `sponsored_posts`, e n√£o `contents`, e recentemente fizemos uma separa√ß√£o de `balance_operations` para tr√™s tabelas diferentes, cada uma sobre um tipo de saldo espec√≠fico. Dito isso, me parece ser necess√°rio criar uma tabela `sponsored_post_tabcoin_operations`.

Ent√£o aqui ter√≠amos:

* `user_tabcash_operations`: Nova coluna `balance_type`
* `sponsored_post_tabcoin_operations`: Nova tabela, igual a `content_tabcoin_operations`.
* `get_sponsored_post_balance_credit_debit`: Nova fun√ß√£o, para obter cr√©ditos e d√©bitos na publica√ß√£o patrocinada.
* `get_sponsored_post_current_tabcoins`: Nova fun√ß√£o, para obter o total de TabCoins da publica√ß√£o patrocinada.

### Eventos

Ao criar uma publica√ß√£o patrocinada:

```js
{
  type: 'create:sponsored_post',
  originator_user_id: string,
  originator_ip: string,
  metadata: {
    id: string,
    user_tabcash: number
  }
}
```

Ao votar numa publica√ß√£o patrocinada:

```js
{
  type: 'update:sponsored_post:tabcoins',
  originator_user_id: string,
  originator_ip: string,
  metadata: {
    amount: number,
    sponsored_post_id: string,
    from_user_id: string,
    sponsored_post_owner_id: string,
    transaction_type: 'credit' | 'debit'
  }
}
```

Ao editar uma publica√ß√£o patrocinada:

```js
{
  type: 'update:sponsored_post',
  originator_user_id: string,
  originator_ip: string,
  metadata: {
    id: string,
    updated_fields: string[] // similar √† edi√ß√£o do perfil
  }
}
```

Ao desativar uma publica√ß√£o patrocinada:

```js
{
  type: 'deactivate:sponsored_post',
  originator_user_id: null | string,
  originator_ip: null | string,
  metadata: {
    id: string,
    trigger: 'owner' | 'moderator' | 'max_tabcash_cost' | 'time_expired' | 'not_enough_tabcash'
  }
}
```

Esse √∫ltimo evento sai do padr√£o que temos em outras a√ß√µes (cria√ß√£o de conte√∫do, edi√ß√£o etc.), mas acredito ser relevante. N√£o sei se o motivo (`metadata.trigger`) da publica√ß√£o patrocinada ter sido "desativada" deve estar em `events` ou outro lugar, mas parece √∫til guardar essa informa√ß√£o.

* `owner`: o autor desativou de forma manual.
* `moderator`: um moderador desativou por ferir os termos de uso.
* `max_tabcash_cost`: atingiu o custo m√°ximo de TabCash estipulado pelo autor.
* `time_expired`: chegou no tempo limite que foi estipulado pelo autor.
* `not_enough_tabcash`: o autor gastou/perdeu TabCash por algum motivo (outro an√∫ncio, voto desfeito por causa do firewall ou outra que pode surgir no futuro) e n√£o tem TabCash o suficiente para receber mais um voto na publica√ß√£o.

---

Me corrijam se algo estiver errado e digam se esqueci de algo ou se possuem sugest√µes de melhoria.

>> Coment√°rio de aprendendofelipe:
> Pensando no banco de dados e reaproveitando algumas coisas que comentei em [#1491 (comment)](https://github.com/filipedeschamps/tabnews.com.br/issues/1491#issuecomment-2002219992), podemos ter uma tabela `sponsored_posts` para representar as publica√ß√µes patrocinadas.

Por que mudar o padr√£o de `contents` para `posts`? N√£o acha melhor `sponsored_contents`?

> As colunas seriam:

> * `body`: Acho interessante ser obrigat√≥rio; n√£o me parece que uma publica√ß√£o patrocinada sem texto seria bem recebida.

Concordo. O caso sem o `body` poderia ser um outro tipo de an√∫ncio para pensarmos no futuro, onde, ao clicar no t√≠tulo, j√° direciona diretamente para fora do TabNews, mas precisa ficar claro que isso ir√° acontecer, e √© algo bem diferente do discutido aqui, j√° que n√£o teria qualifica√ß√µes (nem a p√°gina espec√≠fica do an√∫ncio para receber votos), ou seja, aqui o `body` precisa ser obrigat√≥rio mesmo.

> * `link`: O link que est√° sendo patrocinado (parecido com a fonte de uma publica√ß√£o). Obrigat√≥rio.

O que voc√™ pensa como justificativa para o link ser obrigat√≥rio? Talvez fizesse sentido se fosse proibido colocar links no corpo do an√∫ncio, mas n√£o sei se nesse momento precisamos nos preocupar com isso.

> * `max_tabcash_cost`: Quantidade limite de TabCash que o an√∫ncio consumir√° at√© sair do ar.

Melhor deixar isso para a tabela com o balan√ßo de TabCash dos an√∫ncios. Da√≠, para definir os an√∫ncios que ser√£o mostrados, n√£o ser√° preciso consultar o saldo do usu√°rio, mas apenas do an√∫ncio, assim como as qualifica√ß√µes tamb√©m s√≥ precisar√£o movimentar o saldo dos an√∫ncios.

Na publica√ß√£o/edi√ß√£o, o autor vai reservar certa quantidade de Tabcash que poder√° ser consumida, e isso entra no balan√ßo do an√∫ncio. O autor poder√° editar o an√∫ncio para disponibilizar mais TabCash, e at√© poderia retirar o an√∫ncio do ar e resgatar o saldo remanescente, uma possibilidade que n√£o precisa existir na primeira vers√£o, se isso complicar algo.

Com isso evitamos que a soma dos limites de TabCash dos an√∫ncios de um mesmo usu√°rio fique acima do saldo dispon√≠vel desse usu√°rio. Esse detalhe √© algo importante se formos liberar mais de um an√∫ncio ao mesmo tempo para o usu√°rio. E mesmo se formos limitar a um an√∫ncio, acredito que o limite seria por tipo de an√∫ncio, ent√£o isso ainda ser√° importante.

Falando sobre limitar a quantidade de an√∫ncios ativos de um mesmo usu√°rio, pode ser suficiente limitarmos os an√∫ncios exibidos ao mesmo tempo, sem precisar limitar a quantidade ativa, pois assim permitimos a cria√ß√£o de campanhas com diferentes an√∫ncios que se revezam.

> * `deactivate_at`: Hor√°rio que o an√∫ncio sair√° do ar, calculado a partir do "tempo m√°ximo" informado pela UI/API.
> * `deactivated_at`: O an√∫ncio pode ser desativado antes do `deactivate_at` de forma manual, pelo limite de consumo de TabCash ou por falta de TabCash do autor.

Entendi, mas acho que n√£o h√° necessidade das duas colunas. A `deactivate_at` seria equivalente √† `deleted_at` da tabela `contents`, e a `publish_at` seria equivalente √† `published_at`, com a diferen√ßa que no momento da cria√ß√£o (`created_at`) ou edi√ß√£o (`updated_at`) do an√∫ncio, o autor pode escolher os hor√°rios de in√≠cio e t√©rmino do an√∫ncio. E acho que faz mais sentido o autor definir diretamente as datas e hor√°rios do que escolher um limite de tempo em horas.

Se o autor decidir retirar o an√∫ncio antes da hora definida anteriormente, basta ele editar a publica√ß√£o, alterando o `deactivate_at`, e isso ficar√° registrado nos eventos. Ele pode at√© n√£o definir `deactivate_at` e, nesse caso, o que vai definir se o an√∫ncio continua dispon√≠vel √© o saldo de TabCoins/TabCash do an√∫ncio. O saldo insuficiente tamb√©m vai impedir a exibi√ß√£o do an√∫ncio mesmo que ainda esteja dentro da faixa de tempo entre `publish_at` e `deactivate_at`.

> O `initial_tabcoins`, que ser√° um dado informado ao criar uma publica√ß√£o patrocinada, pode ser obtido atrav√©s da tabela de saldos.

Esse `initial_tabcoins` √© sobre o que eu falei dos `TabCoins promovidos`, certo? N√£o tenho certeza sobre a forma exata que pensei quando rascunhei a descri√ß√£o da issue, mas agora penso que isso n√£o deve alterar o saldo que aparece para os usu√°rios. Acho que os usu√°rios deveriam ver apenas o saldo das qualifica√ß√µes. Talvez seja ainda melhor mostrar apenas a quantidade de qualifica√ß√µes positivas, mesmo que come√ßando sempre em 1, como √© o padr√£o dos conte√∫dos.

O TabCash consumido inicialmente, e que vai definir o destaque inicial da publicidade entre as demais publicidades, n√£o poder ser confundido com o saldo de qualifica√ß√µes.

Ent√£o `TabCoins promovidos` e `initial_tabcoins` n√£o s√£o bons nomes para isso. Seria melhor usar um nome relacionado √† TabCash, que √© o que realmente ser√° utilizado. Ent√£o esse destaque inicial seria dependente da quantidade de TabCash que foi "gasta" pelo autor de forma permanente ao criar a publica√ß√£o, sem contar a parte que pode ser consumida com as qualifica√ß√µes (e futuramente com as visualiza√ß√µes). E isso vai na tabela de balan√ßo de TabCash dos an√∫ncios.

Uma simplifica√ß√£o que pode fazer sentido na vers√£o inicial, √© n√£o separar o que √© consumido de forma definitiva e o que poderia ser resgatado. Deixa o consumo de TabCash ao criar a publicidade como sendo permanente, e esse valor contribui ao mesmo tempo em qual √© o posicionamento inicial (pois ainda n√£o h√° qualifica√ß√µes), e quantas qualifica√ß√µes o an√∫ncio poder√° receber.

Ser√° que quem vota em an√∫ncios deveria ganhar TabCash? Para incentivar os votos em an√∫ncios, acho que ser√° preciso dar TabCash. Nesse caso, o custo m√≠nimo em TabCash para o autor do an√∫ncio tem que ser maior do que 1 TabCash por voto recebido.

> Eu sugeri que os votos em publica√ß√µes patrocinadas continuem consumindo TabCoins de quem votou. Pelo o que me lembro, ningu√©m concordou nem discordou. Se essa sugest√£o for aceita, ent√£o ser√° criado um `debit` em `content_tabcoin_operations` como j√° √© feito em "votos normais" hoje.

Continuo achando que votos em an√∫ncios n√£o devem consumir TabCoins, pois isso restringe menos os usu√°rios que podem votar, e n√£o compete com as qualifica√ß√µes dos conte√∫dos. √â importante incentivar mais os votos em an√∫ncios, pois enquanto n√£o estivermos computando as visualiza√ß√µes, o alcance ser√° medido/cobrado (TabCash) pelas qualifica√ß√µes.

Acho que ser√° normal alguns tipos de an√∫ncios receberem mais votos negativos, e podemos usar isso na classifica√ß√£o deles, diminuindo o alcance dos mais negativados, mas sem retirar totalmente do ar, e sim fazer com que o investimento para sua exibi√ß√£o seja maior.

E isso dos votos negativos √© o que mais me faz pensar que talvez seja interessante mostrar apenas os votos positivos dos an√∫ncios.

Acho que √© consenso que devemos limitar a um voto por usu√°rio, e tudo isso facilita armazenar os votos j√° que podemos usar uma `CONSTRAINT` `UNIQUE` composta pelo id do an√∫ncio e do usu√°rio que votou. Isso faz a modelagem dos votos dos an√∫ncios ficar ainda mais diferente dos conte√∫dos, mas deve ser bem diferente mesmo.

> Entretanto, do lado do autor da publica√ß√£o, ao inv√©s de ganhar TabCash, perder√°.

D√° a impress√£o que voc√™ est√° dizendo que hoje, nos conte√∫dos "normais", o autor ganha TabCash ao receber votos positivos, mas, por enquanto, o autor nunca ganha TabCash. Quem ganha Tabcash √© quem vota nos conte√∫dos.

A nova funcionalidade permite usar TabCash, que ser√° consumido em certa quantidade no momento de criar/editar um an√∫ncio. O autor de uma publicidade poder√° "ganhar" TabCash se implementarmos um resgate do que n√£o foi consumido pelo an√∫ncio, mas isso pode at√© ficar para outro momento.

> Se formos seguir o padr√£o de `content_tabcoin_operations`, ent√£o podemos criar uma coluna `balance_type` na tabela `user_tabcash_operations` com os tipos `credit` e `debit`. Ap√≥s a migra√ß√£o, todos os valores existentes hoje seriam do tipo `credit`.

Ser√° que voc√™ quis dizer `sponsored_tabcash_operations`? N√£o consegui enxergar a necessidade da coluna `balance_type` na tabela `user_tabcash_operations`.

> Ao criar uma publica√ß√£o patrocinada, o autor tamb√©m perde TabCash,

Consumir e perder n√£o s√£o sin√¥nimos. Melhor usar a palavra "perder" apenas em casos de "erros" ou "puni√ß√µes". A princ√≠pio, o autor do an√∫ncio apenas "consome" seu TabCash. √â claro que ele estar√° "perdendo" TabCash se n√£o estiver consumindo de forma inteligente, mas isso deveria ser a excess√£o, n√£o a regra.

> e acredito que podemos seguir o mesmo racioc√≠nio do par√°grafo anterior.

Pelo jeito voc√™ falava mesmo da tabela `user_tabcash_operations`, ent√£o n√£o ficou clara qual seria a necessidade de `balance_type`. N√£o vejo necessidade de alterar a tabela atual.

> Por fim, temos o saldo de TabCoins da publica√ß√£o patrocinada. O comportamento √© muito parecido com o de `contents`, com os valores `initial`, `credit` e `debit`, mas a publica√ß√£o patrocinada est√° na tabela `sponsored_posts`, e n√£o `contents`, e recentemente fizemos uma separa√ß√£o de `balance_operations` para tr√™s tabelas diferentes, cada uma sobre um tipo de saldo espec√≠fico. Dito isso, me parece ser necess√°rio criar uma tabela `sponsored_post_tabcoin_operations`.
> 
> Ent√£o aqui ter√≠amos:
> 
> * `user_tabcash_operations`: Nova coluna `balance_type`

Ainda n√£o entendi qual √© a necessidade da nova coluna.

> * `sponsored_post_tabcoin_operations`: Nova tabela, igual a `content_tabcoin_operations`.

N√£o acho que seria igual, mas apenas parecida.

---

Massa @Rafatcb, pensar sobre o assunto para fazer os coment√°rios acima me deu uma clareza bem maior sobre como podemos chegar na primeira vers√£o.

>> Coment√°rio de Rafatcb:
> Por que mudar o padr√£o de `contents` para `posts`? N√£o acha melhor `sponsored_contents`?

Mencionei o `posts` por ser algo espec√≠fico de "conte√∫dos raiz", e n√£o qualquer conte√∫do (e pensando em _conte√∫dos raiz_  ao inv√©s de _publica√ß√£o_, faria mais sentido `sponsored_root_contents`, que √© bem verboso). Podemos seguir com `sponsored_contents` sem problemas.

> O que voc√™ pensa como justificativa para o link ser obrigat√≥rio? Talvez fizesse sentido se fosse proibido colocar links no corpo do an√∫ncio, mas n√£o sei se nesse momento precisamos nos preocupar com isso.

Me parece estranho a pessoa criar um an√∫ncio sem o CTA (_call to action_). Pensando em algumas situa√ß√µes que podem ocorrer (e que envolvem ao menos um link): divulgar um projeto, site, produto ou servi√ßo, portf√≥lio, vaga de emprego, perfil de rede social, blog... Voc√™ pensou em algum cen√°rio de an√∫ncio sem link?

O que pensei agora √© realizar uma "pesquisa de mercado" ou algo do tipo pelos coment√°rios, e o motivo de fazer isso num an√∫ncio ao inv√©s de numa publica√ß√£o normal seria a possibilidade de ter um impulsionamento inicial. Pode fazer sentido permitir isso.

> Melhor deixar isso para a tabela com o balan√ßo de TabCash dos an√∫ncios. Da√≠, para definir os an√∫ncios que ser√£o mostrados, n√£o ser√° preciso consultar o saldo do usu√°rio, mas apenas do an√∫ncio, assim como as qualifica√ß√µes tamb√©m s√≥ precisar√£o movimentar o saldo dos an√∫ncios.
>
> Na publica√ß√£o/edi√ß√£o, o autor vai reservar certa quantidade de Tabcash que poder√° ser consumida, e isso entra no balan√ßo do an√∫ncio. O autor poder√° editar o an√∫ncio para disponibilizar mais TabCash, e at√© poderia retirar o an√∫ncio do ar e resgatar o saldo remanescente, uma possibilidade que n√£o precisa existir na primeira vers√£o, se isso complicar algo.

Hm, n√£o havia pensado numa tabela de saldo de TabCash dos an√∫ncios. Voc√™ pensou nela como tendo esse saldo inicial investido pelo autor, e depois cada tipo de intera√ß√£o seria como um d√©bito nessa tabela? Parece uma boa forma de lidar com isso, melhor do que retirar aos poucos do autor. No fim do tempo limite do an√∫ncio, podemos reembolsar o autor se houver TabCash n√£o utilizado.

>  `deactivate_at` seria equivalente √† `deleted_at` da tabela contents, e a `publish_at` seria equivalente √† `published_at`

Eu n√£o havia sugerido uma `publish_at` :sweat_smile: , n√£o pensei na possibilidade de "agendar" um an√∫ncio numa primeira vers√£o, mas entendi seu coment√°rio.

> O saldo insuficiente tamb√©m vai impedir a exibi√ß√£o do an√∫ncio mesmo que ainda esteja dentro da faixa de tempo entre `publish_at` e `deactivate_at`.

Sim, mas n√£o teremos em `sponsored_contents` o hor√°rio exato que o an√∫ncio foi desativado. Faz sentido manter o `deactivated_at` como um dado a mais para o autor? Possibilitaria um racioc√≠nio como _"Criei um an√∫ncio com X TabCash esperando que fosse durar N dias, mas durou M"_, ou mesmo uma verifica√ß√£o sobre qual foi a dura√ß√£o de cada an√∫ncio que ele criou.

Mesmo que optemos por n√£o ter o `deactivated_at` agora e optemos por criar ele em outro momento, esse dado poderia ser "calculado" com base na data do √∫ltimo saldo de TabCash que a publica√ß√£o patrocinada "gastou", mas pensei ser uma informa√ß√£o √∫til de j√° armazenar no `sponsored_contents`.

> Esse `initial_tabcoins` √© sobre o que eu falei dos `TabCoins promovidos`, certo?

Sim, eu havia interpretado dessa forma.

> N√£o tenho certeza sobre a forma exata que pensei quando rascunhei a descri√ß√£o da issue, mas agora penso que isso n√£o deve alterar o saldo que aparece para os usu√°rios. Acho que os usu√°rios deveriam ver apenas o saldo das qualifica√ß√µes. Talvez seja ainda melhor mostrar apenas a quantidade de qualifica√ß√µes positivas, mesmo que come√ßando sempre em 1, como √© o padr√£o dos conte√∫dos.
>
> O TabCash consumido inicialmente, e que vai definir o destaque inicial da publicidade entre as demais publicidades, n√£o poder ser confundido com o saldo de qualifica√ß√µes.

Ent√£o, vamos supor que o autor impulsione com 10 TabCash. Para facilitar o entendimento aqui, vamos dizer que 1 TabCash equivale a 1 TabCoin (na hora da implementa√ß√£o, muito provavelmente ser√° diferente).

* Autor investiu 10 TabCash.
* A publica√ß√£o exibe 1 TabCoin, mas est√° numa posi√ß√£o do rank como se tivesse 10 TabCoins.
* Algu√©m votou positivamente, a publica√ß√£o exibe 2 TabCoins, mas est√° numa posi√ß√£o do rank como se tivesse 11 TabCoins.
* Algu√©m votou negativamente, a publica√ß√£o exibe 2 TabCoins, e volta para a posi√ß√£o do rank como se tivesse 10 TabCoins.

√â assim que voc√™ pensou? E no `hover`, exibiria que tipo de detalhes sobre os votos? `+1 | -1` ou tamb√©m exibiria a quantidade de TabCash de impulsionamento (no exemplo acima, `10`)?

Acredito que podemos experimentar n√£o contar os negativos no somat√≥rio. Outra op√ß√£o que tamb√©m podemos experimentar √© n√£o exibir o somat√≥rio de TabCoins que a publica√ß√£o tem, e nesse cen√°rio n√£o sei se exibir√≠amos os dados no `hover` ou apenas usar√≠amos para calcular a posi√ß√£o no rank. Um exemplo mais ou menos assim √© o Hacker News:

![Seis publica√ß√µes no Hacker News, uma n√£o √© poss√≠vel votar, e n√£o exibe a quantidade de votos](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9d0dc190-e14d-4160-ac30-3e4b6fb4ed94)

A publica√ß√£o `10` n√£o possui votos e nem a seta para votar porque √© um an√∫ncio. No nosso caso, permitir√≠amos votar.

Um ponto que considero positivo em esconder os votos √© evitar a manada que ocorre de vez em quando, quando um conte√∫do tem muitos votos positivos ou negativos, e acaba acumulando mais simplesmente por j√° ter muitos. Vejo isso com mais frequ√™ncia em conte√∫dos negativados.

> Ser√° que quem vota em an√∫ncios deveria ganhar TabCash?
> ...
> Continuo achando que votos em an√∫ncios n√£o devem consumir TabCoins, pois isso restringe menos os usu√°rios que podem votar, e n√£o compete com as qualifica√ß√µes dos conte√∫dos. √â importante incentivar mais os votos em an√∫ncios, pois enquanto n√£o estivermos computando as visualiza√ß√µes, o alcance ser√° medido/cobrado (TabCash) pelas qualifica√ß√µes.

Enxergo dois problemas em dar TabCash e n√£o cobrar TabCoins:

1. Isso incentivar√° o usu√°rio a votar em todos os an√∫ncios, mesmo sem prestar aten√ß√£o, apenas para ganhar 1 TabCash. 
2. Isso pode desequilibrar o sistema, de forma que algu√©m que nunca fez uma publica√ß√£o consiga acumular TabCash at√© conseguir fazer uma publica√ß√£o patrocinada.

Acho positivo limitar a um voto por usu√°rio, mas continuamos com os problemas acima. Lembrando o issue https://github.com/filipedeschamps/tabnews.com.br/issues/352, o fluxo completo imaginado na √©poca era:

> 1. Voc√™ gera TabCoins atrav√©s de conte√∫dos com valor concreto.
> 2. Depois gasta essas TabCoins qualificando outros conte√∫dos, e com isso gerando TabCash.
> 3. Depois gasta esses TabCash em an√∫ncios (e no futuro outras coisas, como `features`, ou qualquer outra coisa massa que conseguirmos inventar).

Se formos deixar sem custo de TabCoins para votar, acredito que a pessoa deva ter algum tipo de reputa√ß√£o (digamos, uma quantidade m√≠nima de TabCoins ou TabCash), mas talvez isso limite ainda mais a quantidade de pessoas que podem interagir do que se mantiv√©ssemos a cobran√ßa de 2 TabCoins. Podemos considerar cobrar 1 TabCoin. O que acha de tudo o que mencionei aqui? Te fez pensar em algo diferente?

> >  Entretanto, do lado do autor da publica√ß√£o, ao inv√©s de ganhar TabCash, perder√°.
>
> D√° a impress√£o que voc√™ est√° dizendo que hoje, nos conte√∫dos "normais", o autor ganha TabCash ao receber votos positivos, mas, por enquanto, o autor nunca ganha TabCash. Quem ganha Tabcash √© quem vota nos conte√∫dos.

Me confundi no texto. Quis dizer que ao inv√©s de ganhar TabCoin, perderia TabCash, mas conforme concordei com voc√™ neste coment√°rio, o TabCash j√° estaria reservado para isso e essa reserva seria consumida conforme a publica√ß√£o patrocinada recebesse votos, com uma poss√≠vel implementa√ß√£o de devolver a reserva n√£o utilizada (mesmo que n√£o tenhamos o reembolso num primeiro momento, acho importante termos em _algum_ momento).

> >  Se formos seguir o padr√£o de `content_tabcoin_operations`, ent√£o podemos criar uma coluna `balance_type` na tabela `user_tabcash_operations` com os tipos `credit` e `debit`. Ap√≥s a migra√ß√£o, todos os valores existentes hoje seriam do tipo `credit`.
>
> Ser√° que voc√™ quis dizer `sponsored_tabcash_operations`? N√£o consegui enxergar a necessidade da coluna `balance_type` na tabela `user_tabcash_operations`.

N√£o, quis dizer `user_tabcash_operations` mesmo. Enxergo duas op√ß√µes:

* Com a coluna `balance_type`, criar `credit` (quando o usu√°rio vota e ganha TabCash) e `debit` (quando ele cria uma publica√ß√£o patrocinada), com `amount` respectivamente positivo e negativo.
* Sem a coluna `balance_type`, apenas definir o `amount` com o valor positivo e negativo.

A tabela `content_tabcoin_operations` funciona da primeira forma (mas tamb√©m tem o `balance_type` `initial`). N√£o sei se temos algum benef√≠cio em criar o `balance_type` em `user_tabcash_operations`, mencionei apenas como possibilidade de seguir o padr√£o de `content_tabcoin_operations`.

> >  `sponsored_post_tabcoin_operations`: Nova tabela, igual a `content_tabcoin_operations`.
>
> N√£o acho que seria igual, mas apenas parecida.

Com base no seu coment√°rio, fiquei em d√∫vida em como isso seria armazenado, visto que teremos tanto o TabCash que impulsionou a publica√ß√£o patrocinada quanto os TabCoins de votos recebidos. Seriam duas tabelas, `sponsored_content_tabcoin_operations` e `sponsored_content_tabcash_operations`?

>> Coment√°rio de aprendendofelipe:
### Coment√°rios

> Mencionei o `posts` por ser algo espec√≠fico de "conte√∫dos raiz", e n√£o qualquer conte√∫do 

Falando nisso, a princ√≠pio penso que as publica√ß√µes patrocinadas tamb√©m receber√£o coment√°rios. Ou ser√° que √© melhor n√£o?

Chegou a pensar em armazenar os coment√°rios das patrocinadas na tabela de conte√∫dos normais? Isso pode exigir alguma mudan√ßa na tabela.

### Link obrigat√≥rio/opcional

> > O que voc√™ pensa como justificativa para o link ser obrigat√≥rio? Talvez fizesse sentido se fosse proibido colocar links no corpo do an√∫ncio, mas n√£o sei se nesse momento precisamos nos preocupar com isso.
> 
> Me parece estranho a pessoa criar um an√∫ncio sem o CTA (_call to action_). Pensando em algumas situa√ß√µes que podem ocorrer (e que envolvem ao menos um link): divulgar um projeto, site, produto ou servi√ßo, portf√≥lio, vaga de emprego, perfil de rede social, blog... Voc√™ pensou em algum cen√°rio de an√∫ncio sem link?

N√£o acho estranho, mas, assumindo que seja, por que n√£o poder√≠amos deixar o usu√°rio criar o an√∫ncio sem o link se ele preferir assim?

> O que pensei agora √© realizar uma "pesquisa de mercado" ou algo do tipo pelos coment√°rios, e o motivo de fazer isso num an√∫ncio ao inv√©s de numa publica√ß√£o normal seria a possibilidade de ter um impulsionamento inicial. Pode fazer sentido permitir isso.

A pesquisa seria para responder qual d√∫vida?

### Tabelas de saldos

> Hm, n√£o havia pensado numa tabela de saldo de TabCash dos an√∫ncios. Voc√™ pensou nela como tendo esse saldo inicial investido pelo autor, e depois cada tipo de intera√ß√£o seria como um d√©bito nessa tabela? Parece uma boa forma de lidar com isso, melhor do que retirar aos poucos do autor.

Eu acho que o caminho √© por a√≠.

> A tabela `content_tabcoin_operations` funciona da primeira forma (mas tamb√©m tem o `balance_type` `initial`). N√£o sei se temos algum benef√≠cio em criar o `balance_type` em `user_tabcash_operations`, mencionei apenas como possibilidade de seguir o padr√£o de `content_tabcoin_operations`.

O `initial` √© uma raz√£o para armazenarmos `balance_type` em `content_tabcoin_operations`. A outra raz√£o √© para poder anular um voto sem precisar criar um novo voto contr√°rio, ou seja, +1 credit e -1 credit = 0 de saldo e considerado nenhum voto, pois 1 foi desfeito, o que √© diferente de +1 credit e -1 debit = 0 de saldo, mas s√£o 2 votos contr√°rios.

> Com base no seu coment√°rio, fiquei em d√∫vida em como isso seria armazenado, visto que teremos tanto o TabCash que impulsionou a publica√ß√£o patrocinada quanto os TabCoins de votos recebidos. Seriam duas tabelas, `sponsored_content_tabcoin_operations` e `sponsored_content_tabcash_operations`?

D√° para criar duas tabelas, ou uma s√≥, tem vantagens e desvantagens em cada caso.

> > O saldo insuficiente tamb√©m vai impedir a exibi√ß√£o do an√∫ncio mesmo que ainda esteja dentro da faixa de tempo entre `publish_at` e `deactivate_at`.
> 
> Sim, mas n√£o teremos em `sponsored_contents` o hor√°rio exato que o an√∫ncio foi desativado. Faz sentido manter o `deactivated_at` como um dado a mais para o autor? Possibilitaria um racioc√≠nio como _"Criei um an√∫ncio com X TabCash esperando que fosse durar N dias, mas durou M"_, ou mesmo uma verifica√ß√£o sobre qual foi a dura√ß√£o de cada an√∫ncio que ele criou.
> 
> Mesmo que optemos por n√£o ter o `deactivated_at` agora e optemos por criar ele em outro momento, esse dado poderia ser "calculado" com base na data do √∫ltimo saldo de TabCash que a publica√ß√£o patrocinada "gastou", mas pensei ser uma informa√ß√£o √∫til de j√° armazenar no `sponsored_contents`.

Acho mais √∫til o usu√°rio poder consultar um hist√≥rico do an√∫ncio, como um extrato das qualifica√ß√µes e do TabCash. Mas n√£o precisa disso no primeiro momento.

### Mec√¢nica

> Ent√£o, vamos supor que o autor impulsione com 10 TabCash. Para facilitar o entendimento aqui, vamos dizer que 1 TabCash equivale a 1 TabCoin (na hora da implementa√ß√£o, muito provavelmente ser√° diferente).
> 
> * Autor investiu 10 TabCash.
> * A publica√ß√£o exibe 1 TabCoin, mas est√° numa posi√ß√£o do rank como se tivesse 10 TabCoins.
> * Algu√©m votou positivamente, a publica√ß√£o exibe 2 TabCoins, mas est√° numa posi√ß√£o do rank como se tivesse 11 TabCoins.
> * Algu√©m votou negativamente, a publica√ß√£o exibe 2 TabCoins, e volta para a posi√ß√£o do rank como se tivesse 10 TabCoins.
> 
> √â assim que voc√™ pensou?

√â por a√≠.

> E no `hover`, exibiria que tipo de detalhes sobre os votos? `+1 | -1` ou tamb√©m exibiria a quantidade de TabCash de impulsionamento (no exemplo acima, `10`)?

Para as publicidades, acho melhor n√£o mostrar a quantidade de votos negativos. Uma op√ß√£o seria mostrar apenas a quantidade de votos positivos e o saldo de TabCash. O pior caso para uma publicidade seria chegar em 0 TabCash (quando sair√° do ar) sem ter sa√≠do de 1 Tabcoin, ou seja, ela s√≥ teve votos negativos.

Na situa√ß√£o ideal de competi√ß√£o das publicidades, em que haja algumas mais bem recebidas do que outras, esse pior caso nunca deveria ser atingido, j√° que o alcance seria bem reduzido antes de chegar nesse po√ßo, dando a oportunidade do autor rever sua estrat√©gia.

> > Ser√° que quem vota em an√∫ncios deveria ganhar TabCash?
> > ...
> > Continuo achando que votos em an√∫ncios n√£o devem consumir TabCoins, pois isso restringe menos os usu√°rios que podem votar, e n√£o compete com as qualifica√ß√µes dos conte√∫dos. √â importante incentivar mais os votos em an√∫ncios, pois enquanto n√£o estivermos computando as visualiza√ß√µes, o alcance ser√° medido/cobrado (TabCash) pelas qualifica√ß√µes.
> 
> Enxergo dois problemas em dar TabCash e n√£o cobrar TabCoins:
> 
> 1. Isso incentivar√° o usu√°rio a votar em todos os an√∫ncios, mesmo sem prestar aten√ß√£o, apenas para ganhar 1 TabCash.
> 2. Isso pode desequilibrar o sistema, de forma que algu√©m que nunca fez uma publica√ß√£o consiga acumular TabCash at√© conseguir fazer uma publica√ß√£o patrocinada.

Acho que precisamos exigir algum saldo de TabCoins (talvez 2) para poder qualificar as publicidades, mesmo que n√£o consuma o saldo. Mas tamb√©m ser√£o necess√°rias outras medidas contra abuso, que s√≥ saberemos ao certo quando eles come√ßarem a ocorrer.

> Acho positivo limitar a um voto por usu√°rio, mas continuamos com os problemas acima. Lembrando o issue #352, o fluxo completo imaginado na √©poca era:
> 
> > 1. Voc√™ gera TabCoins atrav√©s de conte√∫dos com valor concreto.
> > 2. Depois gasta essas TabCoins qualificando outros conte√∫dos, e com isso gerando TabCash.
> > 3. Depois gasta esses TabCash em an√∫ncios (e no futuro outras coisas, como `features`, ou qualquer outra coisa massa que conseguirmos inventar).

O fluxo pensado incialmente √© uma idealiza√ß√£o, √© a base que estamos evoluindo para chegar em algo real e vi√°vel. Quanto mais evoluirmos, mais coisas diferentes teremos que lidar. N√£o aparecia na ideia original a necessidade de incentivar a qualifica√ß√£o de publicidades, assim como n√£o era vis√≠vel que precisamos de uma quantidade muito maior de qualifica√ß√µes do que de cria√ß√£o de conte√∫dos.

> Se formos deixar sem custo de TabCoins para votar, acredito que a pessoa deva ter algum tipo de reputa√ß√£o (digamos, uma quantidade m√≠nima de TabCoins ou TabCash), mas talvez isso limite ainda mais a quantidade de pessoas que podem interagir do que se mantiv√©ssemos a cobran√ßa de 2 TabCoins. Podemos considerar cobrar 1 TabCoin. O que acha de tudo o que mencionei aqui? Te fez pensar em algo diferente?

Quanto mais ideias para estudarmos, melhor.

Uma outra ideia √© o usu√°rio votante ganhar 1 TabCoin (e n√£o TabCash), assim ele ainda precisar√° participar pelo menos da qualifica√ß√£o dos demais conte√∫dos antes de ganhar TabCash.

>> Coment√°rio de Rafatcb:
> Chegou a pensar em armazenar os coment√°rios das patrocinadas na tabela de conte√∫dos normais? Isso pode exigir alguma mudan√ßa na tabela.

N√£o havia pensado nesse ponto. Creio que as publica√ß√µes patrocinadas devam receber coment√°rios sim. Uma poss√≠vel diferen√ßa desses coment√°rios para os realizados em "publica√ß√µes normais" √© que talvez eles n√£o devessem entrar no c√°lculo de "prest√≠gio" do usu√°rio, j√° que ficar√£o vis√≠veis por menos tempo. Faz sentido? Se formos considerar no c√°lculo de prest√≠gio, suspeito que n√£o ter√≠amos problemas em armazenar na tabela `contents`.

> A pesquisa seria para responder qual d√∫vida?

Foi s√≥ um exemplo de situa√ß√£o que o pr√≥prio autor gostaria de investir o TabCash sem colocar um link numa publica√ß√£o patrocinada. Podemos deixar o link opcional.

> Acho que precisamos exigir algum saldo de TabCoins (talvez 2) para poder qualificar as publicidades, mesmo que n√£o consuma o saldo. Mas tamb√©m ser√£o necess√°rias outras medidas contra abuso, que s√≥ saberemos ao certo quando eles come√ßarem a ocorrer.

Sim, podemos come√ßar de um jeito simples e acompanhar as intera√ß√µes.

>> Coment√°rio de aprendendofelipe:
> > Chegou a pensar em armazenar os coment√°rios das patrocinadas na tabela de conte√∫dos normais? Isso pode exigir alguma mudan√ßa na tabela.
> 
> N√£o havia pensado nesse ponto. Creio que as publica√ß√µes patrocinadas devam receber coment√°rios sim. Uma poss√≠vel diferen√ßa desses coment√°rios para os realizados em "publica√ß√µes normais" √© que talvez eles n√£o devessem entrar no c√°lculo de "prest√≠gio" do usu√°rio, j√° que ficar√£o vis√≠veis por menos tempo. Faz sentido? Se formos considerar no c√°lculo de prest√≠gio, suspeito que n√£o ter√≠amos problemas em armazenar na tabela `contents`.

Independente desses coment√°rios contarem ou n√£o para o "prest√≠gio", n√£o √© s√≥ isso que exigiria adaptar a tabela `contents`, mas tamb√©m o fato de que `parent_id` e `path` podem passar a conter `id`s que nem sempre ser√£o de outros itens de `contens`. Isso pode tornar mais complexas as consultas das diferentes listas de conte√∫dos.

Acho que vai compensar criar uma tabela s√≥ para os coment√°rios das publicidades. Uma vantagem de deixar para criar a tabela separada √© que d√° para isolar bem a implementa√ß√£o dos coment√°rios nas publicidades, assim como as publicidades em si j√° estar√£o bem isoladas dos conte√∫dos normais.

>> Coment√°rio de Rafatcb:
@aprendendofelipe as publica√ß√µes patrocinadas aparecer√£o entre as normais, ent√£o acredito que o `GET /api/v1/contents` deva retornar elas em todas as estrat√©gias (ou seja, mesmo ao listar por "Recentes" e em `GET /api/v1/contents/rss`). Concorda?

Continuando o racioc√≠nio, os seguintes endpoints devem tamb√©m funcionar para uma publica√ß√£o patrocinada, visando facilitar a compatibilidade dos aplicativos e interfaces existentes hoje?

* `GET /api/v1/contents/[username]/[slug]`
* `PATCH /api/v1/contents/[username]/[slug]`
* `POST /api/v1/contents/[username]/[slug]`: apenas para cria√ß√£o de coment√°rios (falo sobre cria√ß√£o da publica√ß√£o em outro par√°grafo). Tamb√©m tem a ver com a compatibilidade com UIs existentes, e o dado de um coment√°rio numa publica√ß√£o patrocinada √© o mesmo de uma publica√ß√£o normal (o corpo).
* `GET /api/v1/contents/[username]/[slug]/children`
* `GET /api/v1/contents/[username]/[slug]/parent`
* `GET /api/v1/contents/[username]/[slug]/root`
* `GET /api/v1/contents/[username]/[slug]/thumbnail`
* `POST /api/v1/contents/[username]/[slug]/tabcoins`

Ou acredita que essas funcionalidades devem funcionar para publica√ß√µes patrocinadas apenas em `/api/v1/sponsored_contents/...`? Minha opini√£o √© de que essa compatibilidade √© um ponto positivo, mesmo precisando de um tratamento no lado do servidor para verificar se o conte√∫do `[username]/[slug]` √© uma publica√ß√£o patrocinada ou uma publica√ß√£o comum.

Como a publica√ß√£o patrocinada tem alguns dados espec√≠ficos que podem ser alterados, como por exemplo at√© quando ela ser√° exibida, podemos ter a rota `PATCH /api/v1/sponsored_contents/[username]/[slug]` mesmo se aceitarmos atualiza√ß√µes de t√≠tulo, corpo e fonte pelo `PATCH /api/v1/contents/[username]/[slug]`. **Edit:** se formos criar apenas os status `active` e `deactivated` como mencionei em outro coment√°rio, podemos tratar a atualiza√ß√£o para `deleted`, ou acha melhor criar um terceiro tipo para `deleted`? E o `published` √© motivo de preocupa√ß√£o aqui?

No caso de cria√ß√£o da publica√ß√£o patrocinada, imagino que a rota mais adequada seja `POST /api/v1/sponsored_contents` por causa dos campos necess√°rios que n√£o existem numa publica√ß√£o normal, por isso n√£o mencionei na lista acima.

---

**Edit:** Existe algum motivo para ter `originator_type` nas tabelas de saldo? Estava avaliando para ver o que a tabela `sponsored_content_tabcoin_operations` precisar√°, mas me parece que o `originator_type` sempre √© `event` (a n√£o ser em algumas fun√ß√µes de teste, que fica `orchestrator`).

**Edit 2:** Me parece que, mesmo criando uma tabela para os coment√°rios de publica√ß√µes patrocinadas, podemos usar a tabela `content_tabcoin_operations` para armazenar os saldos deles. Faz sentido?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe as publica√ß√µes patrocinadas aparecer√£o entre as normais, ent√£o acredito que o `GET /api/v1/contents` deva retornar elas em todas as estrat√©gias (ou seja, mesmo ao listar por "Recentes" e em `GET /api/v1/contents/rss`). Concorda?

Quando rascunhei a ideia, pensava em devolver as patrocinadas no meio dos conte√∫dos "normais" tamb√©m pela API. Pensei isso justamente para dificultar o bloqueio das promovidas.

Agora que a ideia tomou o caminho de as promovidas serem um pouco diferentes das normais (CTA ao inv√©s de fonte), e por querer deixar claro que s√£o promovidas, isso vai exigir adaptar as interfaces dos Apps, ent√£o n√£o deve ser interessante retornar elas no mesmo endpoint (pelo menos n√£o como default).

Por isso, para as primeiras vers√µes, eu n√£o acho necess√°rio se preocupar em como devolver as patrocinadas em forma de lista pela API (e nem no feed RSS). Elas podem come√ßar aparecendo apenas na home (relevantes), e depois vemos como posicionar nas outras interfaces.

Aproveitando que meu usu√°rio foi marcado... Para n√£o afastar ningu√©m do debate, vamos tentar evitar marcar usu√°rios espec√≠ficos nos pedidos de ideias e opini√µes. ü§ù

> Continuando o racioc√≠nio, os seguintes endpoints devem tamb√©m funcionar para uma publica√ß√£o patrocinada, visando facilitar a compatibilidade dos aplicativos e interfaces existentes hoje?
> 
> * `GET /api/v1/contents/[username]/[slug]`
> * `PATCH /api/v1/contents/[username]/[slug]`
> * `POST /api/v1/contents/[username]/[slug]`: apenas para cria√ß√£o de coment√°rios (falo sobre cria√ß√£o da publica√ß√£o em outro par√°grafo). Tamb√©m tem a ver com a compatibilidade com UIs existentes, e o dado de um coment√°rio numa publica√ß√£o patrocinada √© o mesmo de uma publica√ß√£o normal (o corpo).

Quis dizer `POST /api/v1/contents`, certo? Ou est√° pensando em adicionar essa forma de criar coment√°rios?

> * `GET /api/v1/contents/[username]/[slug]/children`
> * `GET /api/v1/contents/[username]/[slug]/parent`
> * `GET /api/v1/contents/[username]/[slug]/root`
> * `GET /api/v1/contents/[username]/[slug]/thumbnail`
> * `POST /api/v1/contents/[username]/[slug]/tabcoins`
> 
> Ou acredita que essas funcionalidades devem funcionar para publica√ß√µes patrocinadas apenas em `/api/v1/sponsored_contents/...`? Minha opini√£o √© de que essa compatibilidade √© um ponto positivo, mesmo precisando de um tratamento no lado do servidor para verificar se o conte√∫do `[username]/[slug]` √© uma publica√ß√£o patrocinada ou uma publica√ß√£o comum.

Vai facilitar bastante se pudermos usar os mesmos endpoints, mas um problema √© ter de fazer verifica√ß√µes extras em todos os GETs, mas tamb√©m nos POSTs/PATCHs, j√° que n√£o poder√≠amos permitir a cria√ß√£o de uma publica√ß√£o normal e outra patrocinada do mesmo usu√°rio/slug. Hoje usamos o erro `UNIQUE_CONSTRAINT_VIOLATION` do banco (`UNIQUE ("owner_id", "slug")`), mas isso n√£o seria mais suficiente, j√° que estariam em tabelas diferentes.

Ser√° que ent√£o compensa deixar os conte√∫dos patrocinados na mesma tabela? Talvez criar um status `sponsored` e criar outra tabela com os demais campos espec√≠ficos dos patrocinados?

> Existe algum motivo para ter `originator_type` nas tabelas de saldo? Estava avaliando para ver o que a tabela `sponsored_content_tabcoin_operations` precisar√°, mas me parece que o `originator_type` sempre √© `event` (a n√£o ser em algumas fun√ß√µes de teste, que fica `orchestrator`).

N√£o sei se essa coluna foi criada pensando em algo que acabou n√£o sendo implementado. N√£o parece necess√°ria nem para os testes.

> Me parece que, mesmo criando uma tabela para os coment√°rios de publica√ß√µes patrocinadas, podemos usar a tabela `content_tabcoin_operations` para armazenar os saldos deles. Faz sentido?

Dependendo at√© podemos, mas n√£o sei se faz sentido.

>> Coment√°rio de Rafatcb:
> Para n√£o afastar ningu√©m do debate, vamos tentar evitar marcar usu√°rios espec√≠ficos nos pedidos de ideias e opini√µes. ü§ù

Certo.

> Agora que a ideia tomou o caminho de as promovidas serem um pouco diferentes das normais (CTA ao inv√©s de fonte), e por querer deixar claro que s√£o promovidas, isso vai exigir adaptar as interfaces dos Apps, ent√£o n√£o deve ser interessante retornar elas no mesmo endpoint (pelo menos n√£o como default).

Entendo que o ideal √© ressaltar quando a publica√ß√£o √© patrocinada e quando n√£o √©, mas tenho a impress√£o que n√£o retornar as publica√ß√µes patrocinadas por padr√£o, juntos dos conte√∫dos, faz com que os consumidores das APIs precisem "aprender" que "devem exibir as publica√ß√µes patrocinadas". 

> Quis dizer `POST /api/v1/contents`, certo? Ou est√° pensando em adicionar essa forma de criar coment√°rios?

Sim, acabei me confundindo enquanto editava a lista.

> (...) j√° que n√£o poder√≠amos permitir a cria√ß√£o de uma publica√ß√£o normal e outra patrocinada do mesmo usu√°rio/slug (...)
>
> Ser√° que ent√£o compensa deixar os conte√∫dos patrocinados na mesma tabela? Talvez criar um status `sponsored` e criar outra tabela com os demais campos espec√≠ficos dos patrocinados?

Pensei sobre isso tamb√©m. Uma solu√ß√£o que encontrei para continuar mantendo em duas tabelas separadas √© ter uma `VIEW` que consolida ambas, algo similar ao proposto [nessa resposta do Stack Overflow](https://stackoverflow.com/a/10338831/8839059). N√£o fui mais a fundo para ver o qu√£o vi√°vel isso √© ou se faz sentido no nosso caso.

Acredito que ter um status `sponsored` pode ser uma boa alternativa, e permitiria manter os coment√°rios de publica√ß√µes patrocinadas na mesma tabela (`contents`), certo? 

> >  Me parece que, mesmo criando uma tabela para os coment√°rios de publica√ß√µes patrocinadas, podemos usar a tabela `content_tabcoin_operations` para armazenar os saldos deles. Faz sentido?
>
> Dependendo at√© podemos, mas n√£o sei se faz sentido.

Mas como voc√™ pensa que faz sentido? Manter tr√™s tabelas de "tabcoins" separadas (conte√∫dos normais, publica√ß√µes patrocinadas e coment√°rios em publica√ß√µes patrocinadas) ou duas, uma para os conte√∫dos normais e outra para as publica√ß√µes patrocinadas e seus coment√°rios? Ou ainda uma outra op√ß√£o que n√£o pensei?

E, se os coment√°rios de publica√ß√µes patrocinadas ficarem em `contents` com status que j√° temos hoje, complicar√° identificar qual fun√ß√£o deve ser chamada para calcular o saldo de TabCoins e os cr√©ditos e d√©bitos.

Na minha cabe√ßa, os coment√°rios de publica√ß√µes patrocinadas me parecem "a mesma coisa" de coment√°rios de publica√ß√µes comuns. N√£o sei se voc√™ pensou em comportamentos diferentes.

>> Coment√°rio de Rafatcb:
Criei o PR #1719 com a implementa√ß√£o da API. Algumas partes da implementa√ß√£o ficaram diferentes do que foi discutido, como o fato de eu n√£o ter criado uma tabela para os coment√°rios de publica√ß√µes patrocinadas, j√° que do meu ponto de vista, n√£o teria nada para armazenar l√° ou dificultaria a implementa√ß√£o sem um benef√≠cio que eu tenha visualizado. De toda forma, com a implementa√ß√£o fica mais f√°cil de identificar os pontos a serem melhorados.

Quem quiser, pode revisar o PR, mesmo que parcialmente, visto que ele ficou grande.

>> Coment√°rio de filipedeschamps:
Turma, eu reservei a tarde de hoje para ler tanto essa issue, quanto o PR original em #1719 e depois o PR fatiado em #1739.

Considerando que esta issue foi aberta em `Agosto de 2023`, mesmo com os avan√ßos dos √∫ltimos PRs do @Rafatcb, estamos com um `ratio` entre `ideias` e `c√≥digo em produ√ß√£o` bastante longe do que considero um desenvolvimento org√¢nico (me inspirando na aula [Programa√ß√£o "Org√¢nica" versus "Impressora 3D"](https://curso.dev/web/organico-vs-impressora-3d)).

Dado a isso, gostaria de pedir a permiss√£o de voc√™s para dar uma sugest√£o **completamente contrastada** do que foi discutido e implementado at√© ent√£o. Na verdade _"completamente contrastada"_ n√£o, pois √© apenas uma ideia para iniciar uma jornada que ficar√° bem mais complexa ao longo do desenvolvimento e naturalmente acabar tendo overlap com tudo que foi discutido. De qualquer forma, √© daquelas ideias onde o **trajeto √© maior, mas o tempo √© menor**, sabe? √â super contraintuitivo, mas pe√ßo a **permiss√£o** e **confian√ßa** assim como escrevi [nesta publica√ß√£o na wiki (2022)](https://github.com/filipedeschamps/tabnews.com.br/wiki/022.-Milestone-0-(ENCERRAMENTO)), neste trecho em espec√≠fico (mais para o final, deixei em negrito):

> [Gostaria de ser o Guia, e n√£o o Mentor (52:15)](https://youtu.be/ziFonOfCJOg?t=3135) - Pe√ßo a permiss√£o para, ao inv√©s de no projeto eu ser um Mentor, eu ser um Guia. A diferen√ßa √© que um Mentor fica afastado e voc√™ vai at√© a ele para se consultar. J√° um Guia est√° junto com voc√™, junto na trilha, enfrentando e vivenciando o que der e vier ao longo da trajet√≥ria. Se aparecer um Le√£o na trilha, eu quero estar l√° junto, e sinceramente, eu quero que apare√ßa um Le√£o (por exemplo o site cair), pois isso vai ser uma √≥tima oportunidade para nos juntarmos numa Live, investigar o que aconteceu e trocar muita experi√™ncia e conhecimento. **E a permiss√£o que eu pe√ßo √© de ser o Guia mais chato que vai existir, para manter a gente na trilha da simplicidade** para conseguirmos causar um contraste na √°rea que estamos entrando (portal de not√≠cias e conte√∫dos).

Sugiro ver o trecho da Live ali, ela est√° `unlisted`.

Isso se conecta com este outro trecho (tamb√©m destaque em negrito):

> [Rela√ß√£o entre Desenvolver Pouco e Aprender Muito (59:32)](https://youtu.be/ziFonOfCJOg?t=3572) - Conectado com o item anterior, de fazer coisas simples, eu proponho a gente sair um pouco da velocidade de desenvolvimento que √© esperada quando voc√™ est√° trabalhando em um ambiente corporativo. Para esse projeto, para quem est√° vivenciado isso em tempo-real, eu **sugiro a gente desenvolver pouco, e como consequ√™ncia aprender muito.**

Dado a isso, pe√ßo **permiss√£o** para dar minha ideia sendo de novo o _"Guia mais chato que vai existir"_, e mesmo que ela pare√ßa errada e que nos causar√° problemas atuais e futuros (o que ir√°), pe√ßo **confian√ßa** para seguir com ela ü§ù

>> Coment√°rio de Rafatcb:
Bom, ningu√©m precisa pedir permiss√£o para dar uma ideia/sugest√£o aqui :sweat_smile: 

Pode continuar, @filipedeschamps .

>> Coment√°rio de filipedeschamps:
Show üòç Ent√£o a ideia √© uma estrat√©gia para atingir duas coisas:

1. Primeiro **tirar o peso das costas** dessa issue. Isso acontecia muito no Pagar.me, tem muita coisa em cima dela e isso dificulta muito o avan√ßo.
2. Segundo, e talvez o mais importante, fazer a feature **financiar o seu pr√≥prio desenvolvimento**. Ent√£o eu vou elaborar uma pequena sequ√™ncia de passos para atingir isso de uma forma mais r√°pida.

Mas j√° adianto que ser√° **angustiante** passar por esse caminho, por isso pe√ßo a **confian√ßa** para executar ele. E eu irei escrever agora apenas o **primeiro passo** que, depois de executado, vamos conectar ele com o pr√≥ximo passo.

**Ent√£o o primeiro passo √©:** adicionar um novo campo `type` na modelagem de `Content` onde por padr√£o este valor √© `content`. Este campo √© uma `string` que poder√° receber os seguintes valores: `content`, `ad` e `pitch`.

E pronto, mais nada. Com isso em produ√ß√£o, vou descrever o pr√≥ximo passo ü§ù

>> Coment√°rio de filipedeschamps:
Com o deploy do PR #1740 vamos para o **segundo passo** que √©:

Habilitar que seja poss√≠vel passar para o `POST /api/v1/contents` o par√¢metro `type` e no momento em que um usu√°rio criar um conte√∫do enviando `type: ad`, debitar `100` TabCash da conta dele.

Depois disso, o **terceiro passo** j√° ir√° financiar o desenvolvimento do restante da feature ü§ù

>> Coment√°rio de filipedeschamps:
Que massa!!! To **MUITO** feliz com o avan√ßo da feature üòç  Ent√£o com o deploy do PR #1742 vamos para o **terceiro passo** que √© um pouco mais longo, mas que j√° vai servir para financiar o restante da feature (que ainda ficar√° incompleta, ent√£o teremos novos passos para fazer mais sentido, natural):

1. Atualizar a interface da cria√ß√£o de conte√∫do para escolher o `type` do `content` (`Conte√∫do`, `Pitch` e `An√∫ncio`), onde por padr√£o, o valor √© `Conte√∫do`.
2. Nas se√ß√µes `Relevantes` ou `Recentes`, apenas retonar `contents` do `type` `content` ou `pitch`. Da mesma forma, ser poss√≠vel retornar `contents` que tenham apenas o `type` `ad`. Colocar isso como filtro no endpoint `GET` `/api/v1/contents`?
3. Criar uma se√ß√£o nova no menu principal chamada de `Classificados` e apenas listar os `contents` que for do `type` `ad`. Eles podem ser ordenados inicialmente por data de cria√ß√£o, mas no quarto passo vou sugerir ordenar por outra coisa.
4. Abrir um espa√ßo na `Home` e `Recentes`, onde **randomicamente** pega um `content` de `type` `ad` que esteja `published` e mostra o `title` e o `username` na qual este `ad` est√° beneficiando. O click no `title` levar o usu√°rio diretamente para o `source_url` do `content` e por conta disso, precisamos mostrar o peda√ßo inicial da URL, como no exemplo da imagem abaixo o `(curso.dev)`. O clique no `username` deveria ir para a p√°gina de perfil dele. **[edit]** √â importante este espa√ßo respeitar as regras principais de texto da lista de conte√∫do abaixo.

<img width="2168" alt="image" src="https://github.com/user-attachments/assets/a24341ec-cf00-45f1-a4e6-6d6cda8f67f5">

### Opcional

Esta √© uma implementa√ß√£o opcional, mas ir√° facilitar o **quarto passo** e evitar da gente ter que marretar dados no banco de dados depois:
1. Ao criar um `content` com `type` `ad`, fazer o `credit` de `100` `tabcash` no `content` que foi criado. Isso √© poss√≠vel depois da refatora√ß√£o das tabelas de `balance`?

>> Coment√°rio de aprendendofelipe:
> 1. Atualizar a interface da cria√ß√£o de conte√∫do para escolher o `type` do `content` (`Conte√∫do`, `Pitch` e `An√∫ncio`), onde por padr√£o, o valor √© `Conte√∫do`.

Legal, ent√£o no backend ainda precisamos liberar a cria√ß√£o com o tipo `pitch`.

--- 

> 2. Nas se√ß√µes `Relevantes` ou `Recentes`, apenas retonar `contents` do `type` `content` ou `pitch`. Da mesma forma, ser poss√≠vel retornar `contents` que tenham apenas o `type` `ad`. Colocar isso como filtro no endpoint `GET` `/api/v1/contents`?

Para evitarmos uma quase certa breaking change em `/contents`, sugiro devolver em um endpoint espec√≠fico de an√∫ncios. Al√©m de ser mais f√°cil de implementar o controller separado.

---

> 3. Criar uma se√ß√£o nova no menu principal chamada de `Classificados` e apenas listar os `contents` que for do `type` `ad`. Eles podem ser ordenados inicialmente por data de cria√ß√£o, mas no quarto passo vou sugerir ordenar por outra coisa.

Acabei de reservar a palavra `classificados` para o novo caminho. üëç

Para adicionar "Classificados" no menu principal precisamos remodelar a vers√£o de tela pequena do header, pois n√£o cabe mais nada sem fazer ele quebrar. Vamos adotar como na imagem abaixo, que foi estudado no PR #1279?

<img width="740" alt="Header Mobile" src="https://github.com/user-attachments/assets/fe229751-83b6-428f-9e1a-04d456f367fd">

---

> 4. Abrir um espa√ßo na `Home` e `Recentes`, onde **randomicamente** pega um `content` de `type` `ad` que esteja `published` e mostra o `title` e o `username` na qual este `ad` est√° beneficiando. O click no `title` levar o usu√°rio diretamente para o `source_url` do `content` e por conta disso, precisamos mostrar o peda√ßo inicial da URL...

Isso ficou um pouco estranho. O conte√∫do markdown desse `ad` s√≥ ser√° acess√≠vel indo em classificados e procurando pelo an√∫ncio? Ou l√° tamb√©m ao clicar no t√≠tulo o usu√°rio ser√° levado diretamente para o `source_url`?

Est√° me parecendo uma mistura de dois tipos de an√∫ncios diferentes que podemos ter, com e sem markdown, mas se o anunciante optou por adicionar markdown, clicar no link deveria levar para ele. Ou n√£o?

Chegou a ver essa imagem abaixo e as outras relacionadas? No exemplo, apenas a segunda √© uma patrocinada.

<img width="346" alt="Conte√∫do patrocinado" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/407c728c-92c8-4ce2-a993-e38163548c97">

---

> ### Opcional
> Esta √© uma implementa√ß√£o opcional, mas ir√° facilitar o **quarto passo** e evitar da gente ter que marretar dados no banco de dados depois:
> 
> 1. Ao criar um `content` com `type` `ad`, fazer o `credit` de `100` `tabcash` no `content` que foi criado. Isso √© poss√≠vel depois da refatora√ß√£o das tabelas de `balance`?

Esse seria provavelmente o pr√≥ximo passo ap√≥s o PR #1739. Criar a tabela de TabCash dos an√∫ncios. üëç

>> Coment√°rio de filipedeschamps:
> Legal, ent√£o no backend ainda precisamos liberar a cria√ß√£o com o tipo `pitch`.

Vamos ent√£o por hora s√≥ mostrar `Conte√∫do` e `An√∫ncios`, at√© porque, a ideia √© mostrar o `Pitch` separado no menu tamb√©m, mas eu n√£o traria para o **passo 3** essa complexidade. Ent√£o apesar do estudo feito em #1279 foi √≥timo, novamente, n√£o faria para o **passo 3** (o que n√£o tem problema, n√£o vamos parar a feature aqui).

> Para evitarmos uma quase certa breaking change em `/contents`, sugiro devolver em um endpoint espec√≠fico de an√∫ncios. Al√©m de ser mais f√°cil de implementar o controller separado.

Tem certeza que seria uma breaking change? Seria um filtro na `query string`. De qualquer forma, n√£o √© nem preciso ter um menu `Classificados` agora, seria s√≥ interessante duas coisas: n√£o deixar os an√∫ncios vazarem nas listas de conte√∫do e ter alguma forma do usu√°rio conseguir editar o conte√∫do do an√∫ncio (ent√£o ele teria que ter a lista deles em algum lugar). Se eu n√£o me engano, o @Rafatcb tinha desenhado uma aba em que listava os an√∫ncios do usu√°rio, n√£o me recordo tecnicamente qual seria a abordagem. Queria reaproveitar o m√°ximo que desse tudo que temos de `content` para ser mais f√°cil. Ent√£o apenas no **passo 3**, na tela de perfil do usu√°rio, pode at√© listar os an√∫ncios l√°... vai ser tempor√°rio.

> Isso ficou um pouco estranho. O conte√∫do markdown desse `ad` s√≥ ser√° acess√≠vel indo em classificados e procurando pelo an√∫ncio?

Correto ü§ù  Nas posi√ß√µes mais prestigiadas (por exemplo a do print que enviei), vamos mirar para uma alta convers√£o, ent√£o o clique precisa ir direto para o anunciante.

> Ou l√° tamb√©m ao clicar no t√≠tulo o usu√°rio ser√° levado diretamente para o `source_url`?

O clique em algum item da lista dever√° ter o mesmo comportamento da lista de conte√∫dos, ent√£o ir√° levar o usu√°rio para o conte√∫do em markdown e a aba `Classificados` ir√° servir mais para consulta/curiosidade/SEO. No **quarto passo** ela poder√° talvez ter uma participa√ß√£o melhor no retorno ao anunciante, mas duvido que qualquer coisa que seja feita nessa aba chegue perto da convers√£o das posi√ß√µes mais prestigiadas que levem o clique direto para o anunciante, ent√£o prioridade baixa para essa aba no momento se tecnicamente √© complicado filtrar os dados para ela.

> Est√° me parecendo uma mistura de dois tipos de an√∫ncios diferentes que podemos ter, com e sem markdown, mas se o anunciante optou por adicionar markdown, clicar no link deveria levar para ele. Ou n√£o?

Por hora, como tudo √© um `content`, precisa sempre ter um `body` e sugiro o usu√°rio preencher com um bom conte√∫do, porque isso ir√° ajudar no SEO (considerando que a aba `Classificados` fique exposta ou o crawler do Google encontre o conte√∫do de alguma forma, como na p√°gina de perfil do usu√°rio). De qualquer forma, o an√∫ncio em posi√ß√µes mais prestigiadas, levar o clique para esse conte√∫do atrapalha o retorno em compara√ß√£o ao clique direto, pois justamente se adiciona mais um clique/a√ß√£o.

> Chegou a ver essa imagem abaixo e as outras relacionadas? No exemplo, apenas a segunda √© uma patrocinada.

Eu vi! Gostei bastante ü§ù Ao mesmo tempo, morro de medo da credibilidade da lista ficar deturpada por influ√™ncia ou ru√≠do causado por an√∫ncios (que √© o que est√° acontecendo com a busca do Google). Ent√£o sugiro que o primeiro passo seja separar o que √© conte√∫do de an√∫ncio. Mas mais para frente podemos e devemos testar outros modelos para entender o que funciona melhor no ecossistema, incluindo esse da sugest√£o. Acredito que o combo `title+link` consegue ser encaixado em v√°rios lugares ü§ù

>> Coment√°rio de aprendendofelipe:
Massa, o que realmente importa j√° √© ponto pac√≠fico! üéâ

E dado que j√° √© poss√≠vel criar as patrocinadas pela API, e editar elas tanto pela API como pela vers√£o web, acho que agora s√≥ falta um pequeno passo para a Revenue Share se tornar realidade para quem souber usar a API.

Temos estas sub-fases, que podem ser PRs separados, mas que o primeiro j√° revoluciona ao exibir as primeiras patrocinadas (uma especie de vers√£o beta criando s√≥ pela API):

- **3a:** Ajustar a interface para mostrar randomicamente as publicidades de forma destacada em relevantes e recentes; üöÄ
- **3b:** Ajustar `/[username]/[slug]` para informar que se trata de uma patrocinada.
- **3c:** Remover as publicidades das listas normais de relevantes e recentes, mas manter no perfil dos usu√°rios;
- **3d:** Atualizar a p√°gina `/publicar` para permitir criar uma `patrocinada` tamb√©m pela UI;
- **3e:** Criar a p√°gina que lista todas as publicidades (`/classificados`), e adiciona o link no Header em telas grandes;

Os demais passos podem ser ainda na fase 3, mas acredito que saber o que vem na fase 4 vai ajudar.

- **f:** Criar a tabela de balan√ßo de TabCash das publicidades (e recalcular o que for preciso).
- **g:** Reformular o Header para permitir adicionar novos links em telas pequenas;
- **h:** Ajustar tudo para permitir tamb√©m o `pitch`.

---

No item 3a, caso a patrocinada n√£o possua `source_url`, ent√£o direcionar para `/[username]/[slug]`. N√£o s√≥ por isso, mas tamb√©m abre uma possibilidade para quem realmente quiser mostrar primeiro o markdown, por qualquer motivo que seja.

No item 3b, acho que pode aproveitar este outro estudo:

<img width="392" alt="Conte√∫do Patrocinado" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/c1e1f943-81a7-4b28-b7f4-725f579c5c28">


---

> > Para evitarmos uma quase certa breaking change em `/contents`, sugiro devolver em um endpoint espec√≠fico de an√∫ncios. Al√©m de ser mais f√°cil de implementar o controller separado.
> 
> Tem certeza que seria uma breaking change? Seria um filtro na `query string`.

Certeza absoluta, n√£o. Mas √© mais f√°cil adicionar futuramente o filtro, se alguma necessidade surgir, do que o caminho contr√°rio.

Alterar o `/api/v1/contents` n√£o √© requisito para nenhum dos passos acima, mas criar um `/api/v1/sponsored_contents` √© muito similar ao que ser√° feito na UI no passo 3c, ent√£o opcionalmente pode ser feito junto.

Se adicionar o filtro em `/contents` fosse o mais simples de implementar, ou se tivesse algum outro benef√≠cio, talvez valesse o risco, mas n√£o acredito que seja o caso.

J√° a edi√ß√£o das publicidades est√° funcionando pelo `/api/v1/contents/[username]/[slug]`.

Ainda sobre a edi√ß√£o dos an√∫ncios... Por enquanto a √∫nica diferen√ßa com rela√ß√£o aos demais conte√∫dos √© que n√£o existe o cr√©dito e d√©bito de TabCoins do usu√°rio no PATCH para `published` ou `deleted`. Mas √© poss√≠vel editar normalmente o t√≠tulo, o corpo e a URL. S√≥ n√£o √© poss√≠vel alterar o tipo de conte√∫do, e acho que faz sentido manter assim, pelo menos por enquanto, certo?

Acho que a √∫nica ponta solta √© que, se for criado o conte√∫do com o tipo `ad`, mas com status `draft`, o TabCash ser√° debitado j√° na cria√ß√£o. Precisa debitar j√° na cria√ß√£o porque n√£o seria debitado TabCash ao editar de `draft` para `published`. Ningu√©m usa o `draft`, ent√£o n√£o tinha porque lidar com isso agora.


> ...a aba `Classificados` ir√° servir mais para consulta/curiosidade/SEO.

Sobre SEO, acho que √© uma ideia ruim deixar os an√∫ncios serem indexados. √â um ponto que vai precisar ser melhor analisado, mas j√° me preocupa que pode n√£o ser f√°cil reverter uma prov√°vel queda na nossa relev√¢ncia e nas indica√ß√µes do Discover.


---

> No **quarto passo** ela poder√° talvez ter uma participa√ß√£o melhor no retorno ao anunciante, mas duvido que qualquer coisa que seja feita nessa aba chegue perto da convers√£o das posi√ß√µes mais prestigiadas que levem o clique direto para o anunciante, ent√£o prioridade baixa para essa aba no momento se tecnicamente √© complicado filtrar os dados para ela.

Zero complica√ß√£o filtrar os dados. A preocupa√ß√£o n√£o √© t√©cnica üòÖ


----


> > Est√° me parecendo uma mistura de dois tipos de an√∫ncios diferentes que podemos ter, com e sem markdown, mas se o anunciante optou por adicionar markdown, clicar no link deveria levar para ele. Ou n√£o?
> 
> Por hora, como tudo √© um `content`, precisa sempre ter um `body` e sugiro o usu√°rio preencher com um bom conte√∫do, porque isso ir√° ajudar no SEO (considerando que a aba `Classificados` fique exposta ou o crawler do Google encontre o conte√∫do de alguma forma, como na p√°gina de perfil do usu√°rio). 

Precisamos manter um bom SEO para trazer visitantes para o TabNews, e mais visitantes no TabNews implica em mais visitantes para os an√∫ncios.

Por isso a indexa√ß√£o deveria ser apenas dos "melhores" conte√∫dos.

Se trabalhar com foco em trazer visitantes diretamente para os an√∫ncios, logo nossa relev√¢ncia acaba. N√£o podemos esquecer que a maioria dos visitantes di√°rios vem pelo Google.

---

> De qualquer forma, o an√∫ncio em posi√ß√µes mais prestigiadas, levar o clique para esse conte√∫do atrapalha o retorno em compara√ß√£o ao clique direto, pois justamente se adiciona mais um clique/a√ß√£o.

Concordo totalmente. Por isso penso no conte√∫do patrocinado apenas como o primeiro experimento dos an√∫ncios. Mas ele seria apenas a alternativa para quem realmente quer impulsionar a divulga√ß√£o de algo no pr√≥prio TabNews.

Pra quem possui uma landing page, as outras formas de an√∫ncio que teremos ser√£o melhores.


---

> > Chegou a ver essa imagem abaixo e as outras relacionadas? No exemplo, apenas a segunda √© uma patrocinada.
> 
> Eu vi! Gostei bastante ü§ù Ao mesmo tempo, morro de medo da credibilidade da lista ficar deturpada por influ√™ncia ou ru√≠do causado por an√∫ncios (que √© o que est√° acontecendo com a busca do Google). Ent√£o sugiro que o primeiro passo seja separar o que √© conte√∫do de an√∫ncio. Mas mais para frente podemos e devemos testar outros modelos para entender o que funciona melhor no ecossistema, incluindo esse da sugest√£o. Acredito que o combo `title+link` consegue ser encaixado em v√°rios lugares ü§ù

Tamb√©m acredito que o combo `title+link`, ou um banner, tenham retornos melhores para os anunciantes. Posso ter cometido um erro ao sugerir come√ßarmos pelas publica√ß√µes patrocinadas, pois alguma facilidade que ganhamos pelo que existe em comum entre conte√∫dos e patrocinadas pode n√£o ter compensado a confus√£o criada entre essas coisas t√£o diferentes üòñ

>> Coment√°rio de filipedeschamps:
> E dado que j√° √© poss√≠vel criar as patrocinadas pela API, e editar elas tanto pela API como pela vers√£o web, acho que agora s√≥ falta um pequeno passo para a Revenue Share se tornar realidade para quem souber usar a API.

Total üéâ üéâ üéâ

> Temos estas sub-fases, que podem ser PRs separados

Topo total fazer PR separados e √≥tima separa√ß√£o em todos os `3x` ü§ù 

> Os demais passos podem ser ainda na fase 3, mas acredito que saber o que vem na fase 4 vai ajudar.

Justo! Sobre o `f` relacionada a tabela do balan√ßo de `tabcash`, a ideia √© na p√°gina `Classificados` ordenar de forma decrescente a publica√ß√£o que possui uma maior quantidade de `tabcash`. Em paralelo a isso, devemos criar um `cron` na Vercel que todo dia passa por todas as publica√ß√µes do tipo `ad` e debita uma quantidade `x` do saldo de `tabcash` da publica√ß√£o, por exemplo: `10 tabcash` debitados por dia, das publica√ß√µes que possuem um saldo maior do que `1` `tabcash`, n√£o podendo deixar ficar com saldo negativo naturalmente. Junto disso, ao criar uma publica√ß√£o do tipo `ad`, o usu√°rio pode escolher quantos `tabcash` quer usar do seu saldo, caso queira alterar o padr√£o de `100`.

Isto ir√° fazer a p√°gina `Classificados` mostrar os an√∫ncios que os usu√°rios est√£o investindo mais `tabcash`.

Depois disso tudo, n√£o sei se no passo `4` ainda, poder√≠amos usar essa mesma mec√¢nica para calcular a probabilidade de aparecer um an√∫ncio, sendo que os an√∫ncios com maior saldo de `tabcash` teriam uma chance maior de aparecer.



> No item 3a, caso a patrocinada n√£o possua `source_url`, ent√£o direcionar para `/[username]/[slug]`. N√£o s√≥ por isso, mas tamb√©m abre uma possibilidade para quem realmente quiser mostrar primeiro o markdown, por qualquer motivo que seja.

Excelente ponto! Concordo 100%. Da√≠ nesse caso teria que tirar o √≠cone de link externo e o preview do `source_url`.

> Alterar o `/api/v1/contents` n√£o √© requisito para nenhum dos passos acima, mas criar um `/api/v1/sponsored_contents` √© muito similar ao que ser√° feito na UI no passo 3c, ent√£o opcionalmente pode ser feito junto.
> 
> Se adicionar o filtro em `/contents` fosse o mais simples de implementar, ou se tivesse algum outro benef√≠cio, talvez valesse o risco, mas n√£o acredito que seja o caso.

Entendo. Bom, em quest√£o de interface e modelagem (`content`), faz muito mais sentido ao inv√©s de trabalhar com algo como `/api/v1/sponsored_contents` trabalhar com algo `/api/v1/contents?type=content,pitch` e `/api/v1/contents?type=ad`. Para mim faz t√£o mais sentido, que eu pagaria esse custo agora. Pode ser outro formato tamb√©m como `/api/v1/contents?type=content&type=pitch` (mas n√£o sei como isso entra no Next.js)

> S√≥ n√£o √© poss√≠vel alterar o tipo de conte√∫do, e acho que faz sentido manter assim, pelo menos por enquanto, certo?

Certo ü§ù 

> Sobre SEO, acho que √© uma ideia ruim deixar os an√∫ncios serem indexados. √â um ponto que vai precisar ser melhor analisado, mas j√° me preocupa que pode n√£o ser f√°cil reverter uma prov√°vel queda na nossa relev√¢ncia e nas indica√ß√µes do Discover.

Hmm bom ponto, n√£o tinha pensado por esse lado.

>> Coment√°rio de aprendendofelipe:
Avisando aqui apenas para evitar trabalho redundante...

Estou fazendo uma parte da 3a, respons√°vel por devolver uma quantidade escolhida de publicidades aleat√≥rias.

Da√≠ nas p√°ginas est√°ticas relevantes e recentes s√≥ precisa fazer um `ad.getRandom(1)` para obter os an√∫ncios. Pode at√© buscar uma quantidade maior, dependendo de como for ficar a UI. N√£o estou trabalhando na UI.

Vou criar o `/sponsored-beta` apenas para poder criar testes para o novo model. N√£o vale a pena colocar isso no `/contents`, pois a ideia √© o model servir para an√∫ncios, n√£o necessariamente os que se parecem com conte√∫dos, al√©m do `/contents` j√° ser est√°vel e precisamos de uma liberdade maior para estudar o que um GET an√∫ncios precisa devolver.

>> Coment√°rio de Rafatcb:
A p√°gina [Classificados](https://www.tabnews.com.br/recentes/classificados/1) tamb√©m deve ter um banner no topo? Notei agora que √© a √∫nica em "Recentes" que n√£o tem o an√∫ncio destacado.

>> Coment√°rio de aprendendofelipe:
Pelo menos por enquanto que n√£o temos quase an√∫ncios publicados, acho melhor n√£o... Pois ser√° garantido o an√∫ncio aparecer duas vezes

>> Coment√°rio de filipedeschamps:
O **passo 3** foi conclu√≠do ontem de noite com o merge dos seguintes PRs:
- #1740
- #1742
- #1743
- #1744
- #1745
- #1746
- #1747
- #1748
- #1749
- #1751
- #1752
- #1753
- #1754

---

E apesar de que passou pouco tempo, eu considero que o **passo 3** foi conclu√≠do com **sucesso** por conta da primeira publica√ß√£o como an√∫ncio: https://www.tabnews.com.br/filipericardo/agora-e-possivel-usar-seus-tabchash

<img width="1472" alt="image" src="https://github.com/user-attachments/assets/c3d2c4f9-ed16-408b-b054-92fe85c4ddad">

---

Esta publica√ß√£o foi **extremamente bem aceita** e d√° at√© **pena** de criar um outro an√∫ncio, porque ela est√° servindo **perfeitamente** para divulgar a **exist√™ncia** dessa nova feature üòÖ

Bom, agora vamos deixar maturar e aprender o que ir√° acontecer daqui para frente para dar o **passo 4**. Parab√©ns @aprendendofelipe e @Rafatcb pelo envolvimento, ficou excelente e s√≥ vai melhorar ü§ù

>> Coment√°rio de Rafatcb:
Me parece que usar [`noindex`](https://developers.google.com/search/docs/crawling-indexing/block-indexing?hl=pt-br) nas publica√ß√µes de an√∫ncio e buscar o an√∫ncio pela API ao inv√©s de buscar no `getStaticProps` seriam boas melhorias. O motivo √© que a indexa√ß√£o acabou piorando a busca no TabNews, caso eu queira procurar por algo que esteja presente em um t√≠tulo de an√∫ncio.

No exemplo abaixo, estou buscando exatamente pelo t√≠tulo de um an√∫ncio, apenas para deixar claro o problema.

![Busca por um t√≠tulo de an√∫ncio retorna diversos resultados.](https://github.com/user-attachments/assets/fd2dbc3e-2708-4067-ae11-30930136d709)

A [busca no Google](https://www.google.com/search?q=%22Receba+por+email+as+mais+importantes+Not%C3%ADcias+de+Tecnologia+do+mundo!%22&sourceid=chrome&ie=UTF-8) n√£o ficou t√£o ruim nesse exemplo, s√≥ trouxe dois resultados, mas na parte de imagens, trouxe v√°rios. Outros exemplos ficam bem pior:

Busca: [`site:tabnews.com.br "testes-next-analytics.vercel.app"`](https://www.google.com/search?q=site:tabnews.com.br+%22testes-next-analytics.vercel.app%22&sourceid=chrome&ie=UTF-8)

![10 p√°ginas de resultados](https://github.com/user-attachments/assets/315c9217-94c7-4ff8-b2ea-bbed311ced61)

>> Coment√°rio de aprendendofelipe:
> Me parece que usar [`noindex`](https://developers.google.com/search/docs/crawling-indexing/block-indexing?hl=pt-br) nas publica√ß√µes de an√∫ncio e buscar o an√∫ncio pela API ao inv√©s de buscar no `getStaticProps` seriam boas melhorias.

Considero que s√£o melhorias sim. At√© j√° tinha comentado sobre as duas.

Sobre n√£o indexar os an√∫ncios, comentei nessa [issue mesmo](https://github.com/filipedeschamps/tabnews.com.br/issues/1491#issuecomment-2226440549):

> Sobre SEO, acho que √© uma ideia ruim deixar os an√∫ncios serem indexados

J√° a parte da API, acho que ser√° obrigat√≥ria essa mudan√ßa, pois logo n√£o estaremos revalidando as p√°ginas que n√£o tiverem recebido nenhuma atualiza√ß√£o, ent√£o elas ficariam com um an√∫ncio fixo se ele estiver presente na p√°gina est√°tica.

N√£o lembro em qual PR falei sobre isso, mas lembro que citei que precisamos evitar o *layout shift* que pode ocorrer nessa abordagem.

>> Coment√°rio de Rafatcb:
> Considero que s√£o melhorias sim. At√© j√° tinha comentado sobre as duas.

Sim, eu quis refor√ßar/relembrar, j√° que isso me atrapalhou hoje hehe.

> N√£o lembro em qual PR falei sobre isso, mas lembro que citei que precisamos evitar o _layout shift_ que pode ocorrer nessa abordagem.

Estou trabalhando no loading do #1778 com a biblioteca que voc√™ citou, [`react-content-loader`](https://www.npmjs.com/package/react-content-loader). Usar esse tipo de _skeleton loading_ pode ajudar a n√£o ter o deslocamento ap√≥s o carregamento, ou ter um deslocamento menor.

>> Coment√°rio de aprendendofelipe:
> Estou trabalhando no loading do #1778 com a biblioteca que voc√™ citou, [`react-content-loader`](https://www.npmjs.com/package/react-content-loader). Usar esse tipo de _skeleton loading_ pode ajudar a n√£o ter o deslocamento ap√≥s o carregamento, ou ter um deslocamento menor.

Boa! Pode se inspirar em como √© usado em https://github.com/filipedeschamps/curso.dev
</issue_1491_Publica√ß√µes Promovidas>

<issue_1492_Banner de Propaganda>
Sobre o banner eu n√£o tenho nada muito definido, ent√£o vou passar apenas um pouco do que j√° pensei.

Para simplificar a primeira vers√£o, a publicidade em banner poder√° ser reservada para os mantenedores do TabNews (e as publica√ß√µes promovidas ficam reservadas para os autores).

Para a interface, acho que precisaremos de duas vers√µes diferentes, de acordo com o tipo de dispositivo. Em telas largas o(s) banner(s) pode(m) aparecer lateralmente. J√° em telas menores ser√° preciso definir se aparecem no in√≠cio, no meio e/ou no final das listas de conte√∫dos.

Para a origem dos dados da publicidade (acho que basicamente imagem e link), ser√° preciso definir se tamb√©m vamos usar algum servi√ßo externo de publicidade ou se ser√° tudo gerenciado por dentro do TabNews.

A maior novidade imagino que seja somente um local para armazenar as imagens. Os demais dados podem ficar no banco de dados principal ou em outro storage, como algum KV da Vercel.

E para registrar o alcance das publicidades, ser√° que monitorar eventos usando analytics √© suficiente?

>> Coment√°rio de eletroswing:
Uma ideia, caso essa implementa√ß√£o de banner de propaganda se torna-se algo aberto aos autores do tabnews tamb√©m, poderia ter um sistema de "leil√£o"(como acontece em promo√ß√£o de bots no top.gg), onde por um per√≠odo da semana, as pessoas fazem seus lances de uma publica√ß√£o a ser 'turbinada', e passa a ser turbinada a partir de um certo dia, consumindo o valor do lance da pessoa. Por exemplo: "lance para turbinar em um banner por 7 dias de 10 tabcash", e chega outra pessoa e oferece 50, logo, a que oferece mais ganha. o que acha?

>> Coment√°rio de Kallenhard1:
Sobre a quest√£o de monitorar o alcance das publicidades, estou fazendo um projeto desses na minha empresa e o Google Analytics est√° sendo o suficiente para monitorar os eventos com bastantes detalhes dos dados de usu√°rio, publicidade e e-commerce. Tudo √© bem simples de setar usando as tags e voc√™ pode at√© personalizar os eventos caso precise analisar algo mais espec√≠fico.
Se precisar dos dados completos, existe a op√ß√£o de mandar armazenar os eventos offline no banco de dados do Firebase.

>> Coment√°rio de Rafatcb:
@Kallenhard1 obrigado pela sugest√£o! Estamos evitando usar esse tipo de servi√ßo de terceiros por quest√µes de privacidade do usu√°rio (conforme mencionado aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/237#issuecomment-1084948854).

A solu√ß√£o para o registro de alcance de publica√ß√µes ainda est√° em aberto: https://github.com/filipedeschamps/tabnews.com.br/issues/1115. Imagino que para o banner precisaremos de algo diferente, estou mencionando o issue porque o assunto √© similar.
</issue_1492_Banner de Propaganda>

<issue_1493_'bug' tabcoins, implementar devolu√ß√£o, ou n√£o gastar mais ao votar diferente.>
Ao negativar esta publica√ß√£o, https://www.tabnews.com.br/moacirmoda/fui-cancelado-pela-bolha-dev
ponderei que n√£o valia a pena gastar tabcoins para negativa-la, pois acabaria dando mais palco para o animal.
Tentei recuperar as minha tabcoins clicando no achei relevante, para minha surpresa acabei gastando mais tabcoins.
Da mesma forma que n√£o √© poss√≠vel positivar duas vezes a mesma publica√ß√£o ou negativar duas vezes, n√£o deveria ser poss√≠vel votar duas vezes, ainda que em op√ß√µes diferentes, caso isso ocorra n√£o deveria haver gasto de mais tabcoins ao votar em uma op√ß√£o diferente.

>> Coment√°rio de aprendendofelipe:
Ol√° @renatodru, obrigado por relatar, mas a din√¢mica dos votos parece ter ocorrido como esperado.

√â poss√≠vel votar at√© 3 vezes em uma mesma publica√ß√£o dentro de um per√≠odo de 72 horas, utilizando o memo IP, sejam votos positivos ou negativos.

E n√£o existe funcionalidade de desfazer os votos, pois eles podem j√° ter impactado no ranqueamento de relevantes.

Vou fechar a issue, ok?

>> Coment√°rio de renatodru:
@aprendendofelipe, n√£o sei se voc√™ entendeu corretamente o que eu descrevi, mas n√£o faz sentido...
</issue_1493_'bug' tabcoins, implementar devolu√ß√£o, ou n√£o gastar mais ao votar diferente.>

<issue_1495_Youdvn>
Gostei
</issue_1495_Youdvn>

<issue_1497_Mudar o title do head>
Hoje o title do header est√° como **TabNews: Conte√∫dos para quem trabalha com Programa√ß√£o e Tecnologia**, por√©m o site tem muitos acessos de pessoas que ainda n√£o trabalham com Programa√ß√£o e Tecnologia, por isso vejo que seria uma boa uma forma diferente de descrever o TabNews, talvez como **TabNews: Conte√∫dos de Programa√ß√£o e Tecnologia**.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/33301692/68f1de13-3552-4169-8898-ffeeb2378cbf)

Obs.: Procurei aqui nas issues se j√° existia uma issue falando sobre isso, mas n√£o encontrei nada a respeito disso.

>> Coment√°rio de aprendendofelipe:
@VictorManhani, obrigado pela sugest√£o! üí™

Que tal explorarmos outras op√ß√µes para o t√≠tulo e descri√ß√£o do TabNews?

Acredito que a inten√ß√£o do @filipedeschamps foi orientar sobre o conte√∫do esperado para os visitantes, sem impor restri√ß√µes a quem pode acessar o site.

Espera-se que os conte√∫dos sejam √∫teis para profissionais e, sempre que poss√≠vel, acess√≠veis para iniciantes, com o "valor concreto" medido pelo benef√≠cio do tempo dedicado ao TabNews.

Minha preocupa√ß√£o com a altera√ß√£o proposta √© que ela pode tornar o TabNews mais aberto para conte√∫dos superficiais, com foco em curiosos em vez de profissionais e aspirantes.

O debate relacionado est√° bem espalhado, mas dois exemplos em que o Filipe fala a respeito disso, s√£o:

https://github.com/filipedeschamps/tabnews.com.br/issues/1153

> **Deixar mais claro que o TabNews n√£o √© um lugar para brincar:** Eu n√£o sei como colocar uma linha divis√≥ria que deixe isso claro, mas devemos ao m√°ximo proteger para que aqui tenha conte√∫dos para quem trabalha ou quer trabalhar com programa√ß√£o ou tecnologia. Eu sei que nem tudo vai diretamente ajudar no trabalho das pessoas, e uma publica√ß√£o com alguma curiosidade ou uma demonstra√ß√£o t√©cnica n√£o ajuda diretamente, mas √© bem vinda, pois pode ajudar na criatividade. Agora um meme eu acho que j√° passa um pouco dessa linha. Por√©m n√£o sei se dever√≠amos colocar isso nos termos, ou deixar apenas a comunidade avaliar como quiser.

https://github.com/filipedeschamps/tabnews.com.br/issues/352#issuecomment-1155757751

> Ent√£o pelo que eu entendi dos estudos, o primeiro passo para dar vida a um game economy √© definir o que ser√° atingido por quem est√° dentro desta economia, e para isso eu defini algo que j√° conversamos v√°rias vezes:
> 
> **Um local na internet com conte√∫dos de valor concreto para quem trabalha com programa√ß√£o ou tecnologia.**
> 
> Esse √© o "jogo" que estamos jogando.

## Textos Atuais

### Home
**T√≠tulo:** TabNews: Conte√∫dos para quem trabalha com Programa√ß√£o e Tecnologia
**Descri√ß√£o:** Conte√∫dos com valor concreto para quem trabalha com tecnologia.

### RSS
**T√≠tulo:** TabNews
**Descri√ß√£o:** Conte√∫dos para quem trabalha com Programa√ß√£o e Tecnologia

### package.json
**Descri√ß√£o:** Conte√∫dos para quem vive de programa√ß√£o e tecnologia.

## Hist√≥rico
<details>
  <summary>Ver commits relacionados</summary>

T√≠tulo e a descri√ß√£o atuais foram escritos pelo @filipedeschamps, sendo que a descri√ß√£o atual era o t√≠tulo anteriormente.

Abaixo deixo o hist√≥rico de commits que alteraram os textos do t√≠tulo ou da descri√ß√£o.

Foram omitidos os commits com refatora√ß√£o sem modifica√ß√£o nos textos.

### package.json

- 21/06/21 - #37 @rodrigoKulb
8a796d7d4e92e4aee0a014c885bd17ae4549858f **Descri√ß√£o:** Conte√∫dos para quem vive de programa√ß√£o e tecnologia.

### Home

- 25/06/21 - #56 @filipedeschamps
0ac7e6d53291a59c6b49e4be0766b758aeca83b5 **T√≠tulo:** TabNews: Onde tudo come√ßou ("git init")
e **Descri√ß√£o:** Estamos neste exato momento construindo um novo local na internet para quem **trabalha com tecnologia** e precisa consumir conte√∫dos com **valor concreto**.
Esse commit deixou a descri√ß√£o vis√≠vel na Home e com destaque em "**trabalha com tecnologia**" e "**valor concreto**".

- 02/05/22 - #280 @filipedeschamps
61f2ae9080045fce078c197199641215991a9bb9 **T√≠tulo:** TabNews: Conte√∫dos Para Quem Trabalha Com Tecnologia

- 05/05/22 - #286 @filipedeschamps 
47a71e8913899420431de20c9de2834f2f01247f **T√≠tulo:** Conte√∫dos Com Valor Concreto Para Quem Trabalha Com Tecnologia

- 26/05/22 - #391 @gabrnunes 
539b0fdf3e095b7e4ff1775f94fb392ebbae5d2d **T√≠tulo:** TabNews
3909b452fbdb5324dbfef934b28e33148417c0ba **Descri√ß√£o:** Conte√∫dos com valor concreto para quem trabalha com tecnologia.

- 06/06/22 - #438 
@rodrigoKulb 5f017a041bb6e394f655b6319797899b1a94cd37 **T√≠tulo:** TabNews - Construindo uma internet mais massa
@filipedeschamps 07410dc66f30a2368a5de67602aa3801a2a11f54 **T√≠tulo:** TabNews: Conte√∫dos para quem trabalha com Programa√ß√£o e Tecnologia

### RSS 

- 08/08/22 - #621
@coffee-is-power 05e5bf7768fb705e2d063b90586839fc48512008 **RSS T√≠tulo:** TabNews
**RSS Descri√ß√£o:** Conteudos para quem trabalha com tecnologia
@filipedeschamps 86c1fb84963b6a95d3b7087eb25ff74e30aeb52c **RSS Descri√ß√£o:** Conte√∫dos para quem trabalha com Programa√ß√£o e Tecnologia

</details>
</issue_1497_Mudar o title do head>

<issue_1500_Erro>
Erro

>> Coment√°rio de filipedeschamps:
@cybernerd007 eu recebi por email o conte√∫do original da issue (e ele continua dispon√≠vel no hist√≥rico da issue em si):

<img width="835" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/2fd7a0e1-92b2-4e74-83ff-8de3f1f90278">

E d√° para deletar esse hist√≥rico tamb√©m (porque o texto ainda est√° l√°).

De qualquer forma, toda vez que √© feito um `POST` no `/sessions`, √© retornado o token da sess√£o no corpo, para que um client que n√£o use cookie consiga acessar o valor com mais facilidade (pra n√£o precisar cavucar no header). Mas este deveria ser o √∫nico momento que o token √© retornado no corpo ü§ù

>> Coment√°rio de cybernerd007:
@filipedeschamps eu ate mesmo pesquisei uma forma de apagar porem n√£o aparece para apagar.

Eu me confundi o token e atualizado toda vez que e feito uma "request" na sessions, como antes desse teste eu havia feito um outro de roubo de sess√£o eu me "em bananei todo"....
</issue_1500_Erro>

<issue_1502_[D√∫vida] AWS RDS e acesso ao banco>
Gente... estava estudando o reposit√≥rio do tabnews aqui e fiquei com uma d√∫vida... n√£o sei se aqui era melhor lugar pra postar... pe√ßo desculpa de antem√£o se n√£o for...

Algu√©m sabe dizer como est√° configurado o acesso ao DB da AWS?
Vi que tem VPC que restringe o acesso a uma rede privada... mas vi tamb√©m que tem a op√ß√£o de acesso publico ao banco de dados, mas em todo lugar que eu vejo fala que n√£o √© recomendado escolher essa op√ß√£o para banco em produ√ß√£o...

Como esse problema foi contornado sem comprometer a seguran√ßa do banco?

>> Coment√°rio de aprendendofelipe:
Antes o acesso ao banco n√£o podia ser restrito, pois o banco precisava ser acessado pelas lambdas da Vercel, que n√£o era compat√≠vel com VPC.

Com o avan√ßo desta [conversa](https://github.com/orgs/vercel/discussions/42), a coisa mudou recentemente. Veja na [documenta√ß√£o da Vercel](https://vercel.com/docs/security/secure-compute)

>> Coment√°rio de victorhcb:
Entendi!

Obrigado pelas informa√ß√µes üòä
</issue_1502_[D√∫vida] AWS RDS e acesso ao banco>

<issue_1503_[SUGEST√ÉO] Confirma√ß√£o de cadastro e notifica√ß√µes por WhatsApp>
Que tal se ao inv√©s de confirmar o cadastro e enviar notifica√ß√µes por e-mail, fazer isso atrav√©s de um n√∫mero WhatsApp? Ao se cadastrar, o usu√°rio al√©m do e-mail, tamb√©m informaria o seu n√∫mero WhatsApp, e escolheria a forma que gostaria de ser notificado - E-mail, WhatsApp ou ambos.

>> Coment√°rio de victorhcb:
Acredito que o principal limitador dessa implementa√ß√£o seria o custo... buscando aqui rapidamente pela API da META o custo por conversa fica aproximadamente $0,03.

Considerando que o n√∫mero de disparo de conversas/mensagens seja aproximado ao que temos por email (6000 emails por m√™s #1451) ficariamos com um custo aproximado de $180,00 por m√™s.

Refer√™ncia: https://developers.facebook.com/docs/whatsapp/pricing

>> Coment√°rio de Rafatcb:
Acho que armazenar o n√∫mero de celular do usu√°rio traria preocupa√ß√µes a mais por ser mais um dado pessoal do usu√°rio, e precisar√≠amos confirmar duas coisas: o e-mail e o telefone (sim, continuar√≠amos precisando confirmar o e-mail para garantir que √© v√°lido e √© do usu√°rio).

Isso parece trazer mais preocupa√ß√£o do que benef√≠cios, fora a depend√™ncia de um servi√ßo que pode ser substitu√≠do daqui alguns anos. Por exemplo: se o Telegram come√ßar a ser mais usado, precisar√≠amos manter a integra√ß√£o com o WhatsApp e criar uma com o Telegram?

>> Coment√°rio de aprendendofelipe:
@heldercamargo, obrigado pela sugest√£o! üí™

Como a Turma n√£o comprou a ideia, vou fechar a issue, mas qualquer coisa podemos reabrir o debate. ü§ù
</issue_1503_[SUGEST√ÉO] Confirma√ß√£o de cadastro e notifica√ß√µes por WhatsApp>

<issue_1505_[SUGEST√ÉO] Permitir o salvamento de posts ao usu√°rio>
Permitir o salvamento de posts para o usu√°rio, melhore demais sua experi√™ncia. Hoje se eu quero salvar um post do tabnews, salvo como favorito no navegador ou salvo o link da publica√ß√£o. Mas permitindo o salvamento de post como Medium, Instagram etc, isso se tornaria mais simples e elegante ao usu√°rio.

>> Coment√°rio de aprendendofelipe:
@sempsei, obrigado pela sugest√£o! üí™

Vou fechar apenas por organiza√ß√£o, j√° que ela √© duplicada com a #645 ü§ù
</issue_1505_[SUGEST√ÉO] Permitir o salvamento de posts ao usu√°rio>

<issue_1506_[Sugest√£o] Links nos comentarios e post>
Sempre que clico em um link do post ou comentario, sou redirecionado, do tabnews para onde o link aponta, o problema √© que toda vez que fa√ßo isso, nao quero que o tabnews feche, muita das vezes quero entrar sim no link, mas tambem ficar no tabnews

>> Coment√°rio de aprendendofelipe:
@CodifyBrazil, obrigado pela sugest√£o! üí™

Vamos centralizar a discuss√£o na issue relacionada #477 üëç

Recomendo ler o [coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074) do Filipe
</issue_1506_[Sugest√£o] Links nos comentarios e post>

<issue_1507_[SUGEST√ÉO] Favoritar/Salvar Artigos>
Em v√°rios momento me vejo na situa√ß√£o de deixar a aba do artigo aberta por tempo indeterminado, isso porque posteriormente gostaria de reconsultar o conte√∫do ou contribuir com um coment√°rio, ent√£o penso que seria bem-vinda uma funcionalidade de favoritar/salvar um artigo, para evitar a situa√ß√£o de salvar links por exemplo .

>> Coment√°rio de anderood:
Cara, tambem estou no aguardo desta feature...
Ela esta sendo tratada aqui:

https://github.com/filipedeschamps/tabnews.com.br/issues/645#issue-1337367010

>> Coment√°rio de aprendendofelipe:
@Edu0liver, obrigado pela sugest√£o! üí™

Vou fechar apenas por organiza√ß√£o, j√° que, como o @anderood citou, ela √© duplicada com a #645 ü§ù
</issue_1507_[SUGEST√ÉO] Favoritar/Salvar Artigos>

<issue_1510_[ Sugest√£o ] Avisar que o user j√° marcou a publica√ß√£o como "Achei relevante">
## Descri√ß√£o do Problema:

Atualmente, ao usar o recurso "Achei relevante" em um post, n√£o h√° indica√ß√£o de que o usu√°rio j√° marcou aquele post como "Relevante" antes. Isso pode levar a situa√ß√µes em que os usu√°rios n√£o t√™m certeza se j√° marcaram um post como relevante ou n√£o.

## Sugest√£o de Solu√ß√£o:

Minha sugest√£o √© adicionar uma indica√ß√£o visual para informar aos usu√°rios que eles j√° marcaram um post como "gostei". Isso n√£o impediria o usu√°rio de marcar o post novamente, mas serviria como um lembrete visual.

## Detalhes da Implementa√ß√£o:

A implementa√ß√£o dessa sugest√£o pode ser feita de v√°rias maneiras. Uma abordagem poss√≠vel √© deixar a seta azul, ou um modal de aviso.

## Benef√≠cios:

Melhor experi√™ncia do usu√°rio, pois eles podem ver imediatamente se j√° marcaram um post como relevante.
Redu√ß√£o de confus√µes e cliques acidentais.

## Outras Observa√ß√µes:

Ficarei feliz em discutir mais detalhes ou esclarecer qualquer d√∫vida sobre esta sugest√£o. Obrigado pela considera√ß√£o!

>> Coment√°rio de Rafatcb:
Eu acho isso √∫til mas, a princ√≠pio, n√£o imagino como poderia ser indicado. Se algu√©m ter uma sugest√£o, seria legal colocar aqui (pode at√© ser feita no Paint mesmo). √â preciso levar em considera√ß√£o que atualmente o usu√°rio pode dar mais de um voto, e pode tanto dar votos positivos quanto negativos na mesma publica√ß√£o.

Enquanto escrevia, passou uma ideia na minha cabe√ßa que, apesar de n√£o ser uma boa solu√ß√£o final, pode ajudar na discuss√£o:
![A seta na qual foi votada (positivo/negativo) est√° destacada, e ao lado possui um n√∫mero indicando a quantidade de vezes que o usu√°rio votou](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/2d8b40c1-2b5f-48f2-964f-64856b174ac8)

>> Coment√°rio de Poveii:
Tive uma ideia. Que tal adicionarmos badges de achei relevante e n√£o achei relevante em cima do t√≠tulo do post?

<picture>
  <source media="(prefers-color-scheme: dark)" srcset="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/2e2ca1bd-df73-4ff5-8758-848505748c7e">
  <source media="(prefers-color-scheme: light)" srcset="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/c8acde18-6c63-4ae7-9490-08460804b313">
  <img alt="Mostra a aplica√ß√£o da minha ideia, no caso, o "achei relevante" em um post sobre essa issue no tabnews.com.br, e dependendo do seu tema do seu sistema ou navegador isso muda" src="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/c8acde18-6c63-4ae7-9490-08460804b313">
</picture>

<picture>
  <source media="(prefers-color-scheme: dark)" srcset="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/0c42270a-c4eb-4cea-a7d8-080c3a1c196b">
  <source media="(prefers-color-scheme: light)" srcset="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/8afe257c-1b84-41e1-a7e0-81fcc772ed01">
  <img alt="Mostra a aplica√ß√£o da minha ideia, no caso, o "n√£o achei relevante" em um post sobre essa issue no tabnews.com.br, e dependendo do seu tema do seu sistema ou navegador isso muda" src="https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/8afe257c-1b84-41e1-a7e0-81fcc772ed01">
</picture>

Isso seria controlado por uma conta simples entre os votos positivos e negativos do usu√°rio no post em espec√≠fico. O que acham?

> Isso at√© me lembra que temos uma issue aqui que pode ajudar, quem sabe um hist√≥rico de votos seja necess√°rio? (#1341)
> E sim para ver a ideia aplicada ao outro tema, √© s√≥ trocar o tema do github ou do seu sistema. Valeuuuu!!

>> Coment√°rio de faelpinho:
Gostei da sugest√£o do @Rafatcb. Outra coisa que podia ser feita √© mostrar uma borda em torno do bot√£o clicado e alterar a mensagem no Tooltip se j√° teve um voto. A contagem poderia ficar no Tooltop tamb√©m ("Voc√™ votou 2 vezes: Achei interessante"). Segue exemplo abaixo:

![Sem t√≠tulo](https://github.com/filipedeschamps/tabnews.com.br/assets/1687631/c5141014-794d-4d07-8328-e49b8fdfda83)

>> Coment√°rio de Rafatcb:
O problema de deixar essa informa√ß√£o apenas na tooltip √© que ela _esconde_ a informa√ß√£o, e num dispositivo touch seria uma experi√™ncia ainda pior do que usando mouse.

Refer√™ncia: https://primer.style/components/tooltip

> Tooltips as a UI pattern should be the last resort for conveying information as they are hidden by default and often with zero or little visual indicator of its existence. See [tooltip alternatives](https://primer.style/components/tooltip#alternatives-to-tooltips) before using this component.

>> Coment√°rio de aprendendofelipe:
Acho que √© uma funcionalidade muito √∫til, mas √© importante pesar o custo/benef√≠cio de como mostrar essa informa√ß√£o.

√â bastante vi√°vel se for algo que o usu√°rio possa consultar sempre que tiver d√∫vida se j√° votou em um conte√∫do espec√≠fico (deliberadamente executar alguma a√ß√£o para disparar a consulta), mas poder√° ser uma revolu√ß√£o no sistema do TabNews se for uma informa√ß√£o que j√° dever√° estar presente em cada p√°gina de conte√∫do visitada, j√° que isso exige passarmos de um sistema baseado principalmente em p√°ginas est√°ticas (onde poucas a√ß√µes dos usu√°rios necessitam da API) para uma nova forma onde, para cada p√°gina de conte√∫do que o usu√°rio visitar, ser√° preciso buscar dados exclusivos desse usu√°rio (as qualifica√ß√µes dele para os conte√∫dos e coment√°rios visitados). S√≥ isso j√° vai aumentar consideravelmente o uso das lambdas e do banco de dados do TabNews.

E essa se tornaria a consulta mais frequente do sistema, ent√£o ser√° preciso rever a modelagem dos dados de qualifica√ß√µes. Talvez criar uma tabela que armazene no m√≠nimo `user_id`, `content_id` e `amount` para cada qualifica√ß√£o, pois hoje a consulta precisa usar a tabela de eventos, o que at√© pode ser otimizada com um √≠ndice espec√≠fico, mas acredito que seria muito mais eficiente se criarmos uma tabela exclusiva das qualifica√ß√µes.

>> Coment√°rio de AlisonSarto:
Pensando melhor, acho que podemos pensar melhor nessa funcionalidade ap√≥s o hist√≥rico de TabCoins discutido no issue #1341. Dependendo de como for feito esse sistema de hist√≥rico, podemos usar os dados do hist√≥rico para indicar se a publica√ß√£o j√° foi marcada pelo user ou n√£o, n√£o sei se essa seria a melhor l√≥gica, mas pode ser uma possibilidade

>> Coment√°rio de iget-master:
Boa tarde! O que precisa para esse issue ir pra frente? gosto da forma que o @faelpinho sugeriu. Eu posso tentar trabalhar nessa issue

>> Coment√°rio de Rafatcb:
@iget-master da parte do frontend, falta uma boa solu√ß√£o. Sobre a sugest√£o do @faelpinho, mostrar o quadrado verde em volta (e talvez um vermelho no bot√£o negativo) s√£o indicadores interessantes, mas acho que poder√≠amos fazer uma imagem para ver como ficaria com o n√∫mero. E tamb√©m precisaria verificar como seria o comportamento dessa estiliza√ß√£o com o bot√£o focado.

Podemos ir experimentando solu√ß√µes como fizemos at√© agora, colocando imagens aqui e juntando opini√µes de pessoas com diferentes bagagens/experi√™ncia.

Da parte do backend, parece que ser√° mais complicado. Precisar√° resolver os problemas indicados no coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1510#issuecomment-1817604841.

>> Coment√°rio de hiroshimorowaka:
Boa tarde! Eu gostaria de dar uma ideia pra essa Issue, j√° que sinto muita falta de saber se j√° qualifiquei um conte√∫do, seja como relevante ou n√£o. 

A minha ideia √© a seguinte: 

Adicionar no endpoint `/api/v1/contents/{username}/{slug}/tabcoins`

Uma op√ß√£o de GET que retorna quantos votos voc√™ deu em cada op√ß√£o.

### Armazenamento no banco de dados. 

Eu n√£o fui muito a fundo verificar, mas pelo que eu entendi que o @aprendendofelipe falou foi que voc√™s n√£o tem uma tabela separada pra contagem de "likes" e "dislikes", certo?

Ent√£o como ele mesmo disse, teria que criar uma tabela pra contabilizar isso, porque utilizar a mesma tabela de eventos fica meio estranho, eu acho. 

**Nova tabela**
Se fosse criar uma nova tabela, acho que seria praticamente como o `aprendendofilipe` falou
- user_id
- content_id
- relevent - Int
- irrelevant - Int

Ou talvez algo melhor, eu n√£o sou muito experiente ent√£o esse foi o melhor jeito que eu pensei. 

### Custo disso

O custo realmente vai ser mais alto, porque as p√°ginas (pelo que eu entendi) s√£o geradas de forma est√°ticas e somente s√£o revalidadas de tempos em tempos, se precisar gerar uma p√°gina pra cada usu√°rio seria complicado. 

Acho que talvez gerar a p√°gina inteira no back-end, entregar de forma est√°tica, e gerar os votos no Client-Side com requisi√ß√µes pra API, mas n√£o sei se isso resolveria o problema, porque vai criar uma rota que √© muito acessada, j√° que precisa ser acessada em toda publica√ß√£o visitada.  

Algu√©m mais experiente no projeto poderia informar melhor sobre o quanto isso custaria pra infra. 
Como usu√°rio e na quest√£o de experi√™ncia do usu√°rio, eu creio que seja algo importante. 

Desculpe se falei algo de errado, eu n√£o tenho tanto conhecimento assim sobre o projeto mas gostaria de tentar ajudar de alguma forma.
</issue_1510_[ Sugest√£o ] Avisar que o user j√° marcou a publica√ß√£o como "Achei relevante">

<issue_1511_[ Sugest√£o ] Two factor authentication>
Quest√µes:
- Implementar isso pode prejudicar a experi√™ncia do usu√°rio ?
- Precisar√≠amos implementar mais algum servi√ßo ? Se sim, quanto custoso  seria ?
- Qual vantagem de implementar o servi√ßo ?

>> Coment√°rio de aprendendofelipe:
@mayconbalves, obrigado pela sugest√£o! üí™

Por organiza√ß√£o, vou lhe pedir para participar na #1171 que j√° trata do assunto. üëç

Vou fechar essa aqui como duplicada. Combinado? ü§ù
</issue_1511_[ Sugest√£o ] Two factor authentication>

<issue_1512_[D√∫vida] Banco de dados do preview da vercel>
Gente... estava estudando o reposit√≥rio do tabnews aqui e fiquei com uma outra d√∫vida... n√£o sei se aqui era melhor lugar pra postar... pe√ßo desculpa de antem√£o se n√£o for...

Como o tabnews cria um banco de dados para cada preview? Isso √© criado programaticamente? Onde est√° hospedado esse BD de homologa√ß√£o?

>> Coment√°rio de aprendendofelipe:
Fala @victorhcb!

N√£o s√£o criadas diferentes inst√¢ncias do banco de dados para cada preview. Al√©m disso, as inst√¢ncias de banco de dados n√£o s√£o gerenciadas pela Vercel.

Oficialmente temos a inst√¢ncia de produ√ß√£o e a de homologa√ß√£o na AWS. Tamb√©m j√° criamos inst√¢ncias na Supabase e no Neon para fazer testes pontuais, mas a oficial √© da AWS.

Na Vercel j√° est√£o configuradas as vari√°veis de ambiente para os dois bancos (produ√ß√£o e homologa√ß√£o), ent√£o cada tipo de deploy se conecta ao banco correspondente (j√° existente).

Fora a configura√ß√£o padr√£o produ√ß√£o/homologa√ß√£o, quando queremos testar algum terceiro banco de dados, basta subir o banco no servi√ßo que for, e informar as novas vari√°veis de ambiente na Vercel. Nesses casos, configuramos as vari√°veis de ambientes para valerem apenas para os deploys originados de uma √∫nica branch no GitHub.

>> Coment√°rio de victorhcb:
Aaah entendi @aprendendofelipe 

Muito obrigado!

A √∫nica d√∫vida que fiquei √© como lidamos com migrations de diferentes pull requests ent√£o? 

Acredito que isso deva gerar um certo ru√≠do de tabelas e altera√ß√µes no banco de dados de homologa√ß√£o, n√©?

>> Coment√°rio de aprendendofelipe:
As migrations s√≥ s√£o executadas no banco de homologa√ß√£o de forma planejada. √â preciso que algu√©m que possua essa feature dispare intencionalmente o comando via API. Ent√£o um PR que depende da execu√ß√£o de uma nova migration n√£o vai funcionar em homologa√ß√£o enquanto n√£o decidirmos dar esse passo.

Talvez voc√™ esteja pensando no ambiente de testes no GitHub. Esse n√£o tem rela√ß√£o nenhuma com a Vercel. Um novo ambiente √© criado ap√≥s cada commit sincronizado com o reposit√≥rio. Nesse sim s√£o executadas todas as migrations do PR, mas o ambiente √© isolado e vol√°til, ou seja, tudo √© exclu√≠do assim que os testes automatizados terminam.

√â poss√≠vel que a confus√£o surja porque ao mesmo tempo que esse ambiente de testes √© criado no GitHub, √© feito um novo deploy no ambiente de homologa√ß√£o na Vercel, mas s√£o dois processos independentes apenas disparados pelo mesmo evento.

>> Coment√°rio de victorhcb:
Agora entendi!! Genial

Achei que as migrations rodavam internamente em algum processo de build, mas interessante saber que na verdade elas devem ser rodadas manualmente a cada nova feature, podendo, assim, serem controladas manualmente no ambiente de homologacao.

Muito obrigado @aprendendofelipe pela paciencia e explica√ß√£o, e me desculpe mais uma vez pelo incomodo!
</issue_1512_[D√∫vida] Banco de dados do preview da vercel>

<issue_1513_Bug: Imposs√≠vel listar meus rascunhos>
Estava validando a api de conte√∫do e encontrei um poss√≠vel gap

quando se cria plublica√ß√£o via a api de content √© possivel passar o status('draft', 'published', 'deleted'), por mais que na tela n√£o haja ainda a op√ß√£o de criar como rascunho, pela api isso √© poss√≠vel, por√©m quando listo meus conte√∫dos os rascunhos n√£o aparacecem.

Olhando no c√≥digo vi que o status para a rota `/api/v1/contents/[username]` est√° setado para buscar apenas published

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/36305985/14732841-1cf9-4f6f-87c5-071e519debfa)

Entendo que o correto nesse caso seria verficar se o usuario que est√° acessando a rota √© o mesmo do parametro username e se sim utilizar o filtro de status com draft ou  published, caso for um usuarios acessando os conteudos de outro utilizar somente o published.

Outro ponto que me chamou aten√ß√£o foi o uso do `user.createAnonymous()` ao inv√©s de utilizar o `authentication.injectAnonymousOrUser`, confesso que n√£o entendi o pq disso, mas talvez seja um c√≥digo que n√£o foi atualizado.

>> Coment√°rio de aprendendofelipe:
@leoferreiralima, obrigado por reportar! üí™

O status `draft` n√£o foi totalmente implementado. N√£o h√° maneira de listar esses conte√∫dos, ent√£o eles s√≥ s√£o utilizados em alguns dos testes automatizados.

> Entendo que o correto nesse caso seria verficar se o usuario que est√° acessando a rota √© o mesmo do parametro username e se sim utilizar o filtro de status com draft ou published, caso for um usuarios acessando os conteudos de outro utilizar somente o published.
> 
> Outro ponto que me chamou aten√ß√£o foi o uso do `user.createAnonymous()` ao inv√©s de utilizar o `authentication.injectAnonymousOrUser`, confesso que n√£o entendi o pq disso, mas talvez seja um c√≥digo que n√£o foi atualizado.

A rota `/api/v1/contents/[username]` possui cache na CDN, ent√£o seu retorno n√£o pode depender de dados do usu√°rio.

A possibilidade de publicar com status `draft` provavelmente foi *overengineering*. O salvamento autom√°tico dos rascunhos no `localStorage` atendeu parte da justificativa para esse status.

Est√° pendente um debate sobre a manuten√ß√£o desse status, para ent√£o ser terminada a implementa√ß√£o (talvez a cria√ß√£o de outra rota) ou a remo√ß√£o da possibilidade de publicar como `draft`.

Eu acredito que a possibilidade de listar as publica√ß√µes com status `draft` iria facilitar o uso do TabNews como CMS sem o autor precisar participar do ciclo completo de contribui√ß√£o e nem com a qualidade do conte√∫do, ent√£o talvez n√£o seja interessante.

>> Coment√°rio de leoferreiralima:
@aprendendofelipe entendi, vou dar uma olhada na discuss√£o e ver como posso contribuir. onde posso encontra-la?

No projeto onde eu trabalho usamos o cache usando alguns dados na chave, o usuario √© um deles, para que possamos ter sempre essa valida√ß√£o, contudo o cache n√£o √© em uma CDN, vou dar uma pesquisada como poderia funcionar.

A CDN desse projeto √© da pr√≥pria vercel ou √© algo externo na cloud?

Sobre a quest√£o da rota nova acredito que seja uma boa ideia algo como `/api/v1/contents/[username]/draft` ou `/api/v1/contents/[username]/[status]`

>> Coment√°rio de aprendendofelipe:
> onde posso encontra-la?

N√£o existe uma issue que esteja centralizando essa discuss√£o.

> A CDN desse projeto √© da pr√≥pria vercel ou √© algo externo na cloud?

Tem diferentes n√≠veis de cache na Vercel e na Cloudflare

>> Coment√°rio de leoferreiralima:
Vou criar uma issue para centralizarmos essa discuss√£o ent√£o, acredito que seja interessante definirmos se seguiremos ou n√£o com a op√ß√£o do draft e como
</issue_1513_Bug: Imposs√≠vel listar meus rascunhos>

<issue_1514_(Bug) Falha ao postar coment√°rios.>
Ao tentar responder a um coment√°rio, √© exibido uma notifica√ß√£o err√¥nea de que n√£o tenho conex√£o com a internet  que impossibilita a publica√ß√£o.
![Screenshot_20230919-113439](https://github.com/filipedeschamps/tabnews.com.br/assets/19830027/a553090e-c5c7-4487-b4e1-15cdb1e9b9e7)

>> Coment√°rio de aprendendofelipe:
N√£o encontrei nenhum erro na √∫ltima hora.

Pode dar mais detalhes que ajudem a entender o que aconteceu?

O problema ainda permanece? Tentou de outro dispositivo?

>> Coment√°rio de Gabriel-Tapes:
@aprendendofelipe Isso j√° aconteceu comigo tamb√©m algumas vezes, mas acredito que √© por conta de lentid√£o na rede mesmo.

>> Coment√°rio de RadioactivePlays:
> N√£o encontrei nenhum erro na √∫ltima hora.
> 
> Pode dar mais detalhes que ajudem a entender o que aconteceu?
> 
> O problema ainda permanece? Tentou de outro dispositivo?

Ainda persiste, troquei de rede e de dispositivo.

>> Coment√°rio de aprendendofelipe:
> Ainda persiste, troquei de rede e de dispositivo.

A Cloudflare est√° bloqueando suas requisi√ß√µes POST. Aparentemente algo inseguro est√° sendo enviado nas suas requisi√ß√µes.

Voc√™ est√° usando uma rede confi√°vel ou est√° em uma rede p√∫blica, talvez no aeroporto?

>> Coment√°rio de RadioactivePlays:
Rede dom√©stica mesmo.

>> Coment√°rio de aprendendofelipe:
@RadioactivePlays, faz um teste, por favor!

Cria uma resposta com texto simples nessa minha publica√ß√£o abaixo e pode excluir logo em seguida:

https://www.tabnews.com.br/FelipeBarso/tabnews-agora-com-recompensas-diarias-em-tabcoins

Pode ser algo como:

```
Resposta de teste conforme solicitado na issue 1514
```

Se der certo, envia aqui no GitHub o texto da publica√ß√£o que est√° dando erro pra gente analisar.

>> Coment√°rio de RadioactivePlays:
A publica√ß√£o √© [essa](https://www.tabnews.com.br/thegr8wesley/como-compilar-um-kernel-linux-ajuda) .

>> Coment√°rio de aprendendofelipe:
@RadioactivePlays, legal que voc√™ est√° conseguindo publicar üéâ

Ent√£o o problema √© algo contido no texto que voc√™ est√° tentando publicar.

1. Por favor, n√£o esque√ßa de excluir o coment√°rio de teste antes que ele seja negativado.

2. Envie aqui no GitHub o texto da publica√ß√£o que est√° dando erro. N√£o o texto que j√° est√° publicado, mas o texto que voc√™ n√£o est√° conseguindo publicar. Se preferir n√£o postar aqui, ent√£o analise o que pode estar contido no texto que possa estar sendo barrado pela Cloudflare. Provavelmente algum comando no meio do texto.

>> Coment√°rio de RadioactivePlays:
Ah ok, o texto √© o seguinte:

> Muito obrigado pela resposta. Em rela√ß√£o ao item 4 da cria√ß√£o de kernels para dispositivos Android, acho que existem m√©todos como o AnyKernel para facilitar. Minha maior dificuldade mesmo √© em saber qual compiler/toolchain usar ou mesmo entender o conceito destes. Percebi que pode existir um gcc/clang do fabricante do meu aparelho (Motorola), do fabricante do chipset (Qualcomm), da pr√≥pria ARM, e do AOSP. 
No guia de refer√™ncia que voc√™ indicou, o link para a toolchain AOSP fornecido cai em uma p√°gina que indica que o android abandonou o gcc em favor do LLVM, que eu creio que seja o clang.
Ao executar um cat /proc/version no meu dispositivo, mostra que foi utilizado o clang v11.02, seria necessariamente essa a vers√£o que eu teria que utilizar no processo e como obt√™-la?

>> Coment√°rio de RadioactivePlays:
Pode ser algum caractere especial que est√° interferindo?

>> Coment√°rio de aprendendofelipe:
A Cloudflare est√° bloqueando por causa do `/proc/version`

Uma maneira de contornar √© usar `&#47;` no lugar de `/`, ou seja, `&#47;proc&#47;version;`. Isso vai renderizar corretamente como `/proc/version`.

>> Coment√°rio de RadioactivePlays:
Finalmente, enviado. Era isso mesmo, obrigado pelo retorno. Isso √©  um bug ou √© intencionalü§î? Devo fechar esse issue?

>> Coment√°rio de aprendendofelipe:
O pior √© que est√° bloqueando mesmo usando ``` ` ``` ou `<code>`.

> Isso √© um bug ou √© intencionalü§î?

Talvez seja um excesso de zelo pela Cloudflare, mas n√£o acho que vale a pena desativar a regra que est√° bloqueando isso, pois n√£o sabemos o que mais ela bloqueia.

> Devo fechar esse issue?

Vou fechar essa porque j√° abri uma espec√≠fica para melhorar a mensagem de erro quando o bloqueio √© pela Cloudflare. ü§ù

@RadioactivePlays, muito obrigado por reportar e por ajudar a descobrir o que estava acontecendo! üí™
</issue_1514_(Bug) Falha ao postar coment√°rios.>

<issue_1515_Bug para Postar conte√∫do>
N√£o estou conseguindo postar conte√∫do no Tabnews, aparece a seguinte mensagem(foto abaixo), por√©m minha conex√£o com a internet est√° ok !
![error](https://github.com/filipedeschamps/tabnews.com.br/assets/30055762/c29bfc38-7d1b-41af-b97f-3849fea3d5c7)

>> Coment√°rio de aprendendofelipe:
Fala @Lucas-Ed!

Algo indevido est√° sendo enviado nas suas requisi√ß√µes POST, pois a Cloudflare est√° bloqueando elas

>> Coment√°rio de aprendendofelipe:
@Lucas-Ed, faz um teste, por favor!

Cria uma resposta com texto simples nessa minha publica√ß√£o abaixo e pode excluir logo em seguida:

https://www.tabnews.com.br/FelipeBarso/tabnews-agora-com-recompensas-diarias-em-tabcoins

Pode ser algo como:

```
Resposta de teste conforme solicitado na issue 1515
```

Se der certo, envia aqui no GitHub o texto da publica√ß√£o que est√° dando erro pra gente analisar.

>> Coment√°rio de aprendendofelipe:
Deve funcionar se voc√™ trocar o 

```
`curl -fsSL https://bun.sh/install | bash`
```

por

```
<code>curl -fsSL https://bun.sh/install | bash</code>
```

>> Coment√°rio de aprendendofelipe:
@Lucas-Ed, se der tudo certo, pode encerrar a issue, por favor! ü§ù

J√° exclu√≠ seu texto original aqui do GitHub üëç

>> Coment√°rio de Lucas-Ed:
Muito obrigado, √© por isso ent√£o que estava bloqueando minha postagem, modifiquei e deu certo aqui !
</issue_1515_Bug para Postar conte√∫do>

<issue_1516_Mostrar mensagem de erro mais espec√≠fica quando uma publica√ß√£o for barrada pela Cloudflare>
## Contexto

Algumas requisi√ß√µes POST podem retornar status `403` diretamente pela Cloudflare se eles detectarem alguma sequ√™ncia de caracteres que possa ser utilizada de forma maliciosa.

Com isso, alguns conte√∫dos podem ser indevidamente impedidos de serem publicados por conterem algum script junto ao texto.

Ap√≥s identificar que √© um bloqueio pela Cloudflare, n√£o √© dif√≠cil encontrar uma forma alternativa de fazer a mesma publica√ß√£o, pois geralmente √© suficiente usar entidades no lugar de alguns caracteres, por exemplo `&#47;` no lugar de `/`.

O problema √© que a mensagem de erro que estamos apresentando hoje no front-end n√£o d√° nenhuma dica do que realmente est√° acontecendo, j√° que para qualquer status `>= 401`, estamos retornando a mensagem `N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o.`

## Execu√ß√£o

Podemos identificar que o retorno 403 est√° vindo da Cloudflare com algo parecido com o que foi feito no [`useUser`](https://github.com/filipedeschamps/tabnews.com.br/blob/ef4dbcf088dc566766573116c11a27f3b0a54365/pages/interface/hooks/useUser/index.js#L53C11-L53C100), ou seja, verificando se:

```js
response.status === 403 && webserver.isProduction && !response.headers.get('x-vercel-id')
```

Ent√£o podemos criar um desvio na l√≥gica por aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/ef4dbcf088dc566766573116c11a27f3b0a54365/pages/interface/components/Content/index.js#L379

e chamar

```js
setGlobalErrorMessage('Com uma mensagem que d√™ dicas de como contornar o problema');
```

Precisamos pensar bem sobre a mensagem, pois podemos cair na mesma condi√ß√£o de erro caso o TabNews esteja sofrendo algum ataque e a Cloudflare esteja exigindo algum desafio para comprovar que √© um humano fazendo a publica√ß√£o.

>> Coment√°rio de guscsales:
Fala @aprendendofelipe, vi essa issue aqui e achei bem pertinente, queria colocar meus pensamentos.

> Precisamos pensar bem sobre a mensagem, pois podemos cair na mesma condi√ß√£o de erro caso o TabNews esteja sofrendo algum ataque

Para esse caso seria interessante uma mensagem interna mais ou menos mostrando: "ok, 100 requisi√ß√µes em 1 segundo? Algum script malicioso? Temos um ataque rolando." (e ai da pra rodar mais valida√ß√µes al√©m dessas) por√©m deixando a mensagem para a tela algo mais gen√©rico para previnir dicas para uma poss√≠vel amea√ßa? 

N√£o necessariamente precisa ser o que tem hoje, mas alguma mensagem tipo "Comportamento proibido" ou "Conte√∫do de texto n√£o permitido", ou "Conte√∫dos de c√≥digos devem estar dentro da sintaxe de c√≥digo do [markdown](https://www.markdownguide.org/basic-syntax/#code)"

> a Cloudflare esteja exigindo algum desafio para comprovar que √© um humano fazendo a publica√ß√£o

Um segundo ponto, fiquei com uma d√∫vida nisso. Caso a CF exija isso eu entendo que talvez n√£o seja um comportamento de resposta a algum tipo de ataque ou script malicioso. Nesse caso teria que ter uma outra valida√ß√£o separado desse 403, talvez. Ao inv√©s de retornar o erro na tela, deveria aparecer algum embed direto para conseguir resolver o desafio e ent√£o completar o post request?

>> Coment√°rio de aprendendofelipe:
Fala @guscsales, tudo certo?

> Para esse caso seria interessante uma mensagem interna mais ou menos mostrando: "ok, 100 requisi√ß√µes em 1 segundo? Algum script malicioso? Temos um ataque rolando." (e ai da pra rodar mais valida√ß√µes al√©m dessas) por√©m deixando a mensagem para a tela algo mais gen√©rico para previnir dicas para uma poss√≠vel amea√ßa?

Quando a Cloudflare bloqueia a requisi√ß√£o, independentemente do motivo, ela apenas devolve o erro 403. N√£o temos como alterar o erro que √© retornado nessa resposta, pois n√£o passa pelo nosso back-end. Ent√£o a proposta da issue √© sobre melhorar o que mostramos no front-end quando a requisi√ß√£o retornar um 403 que n√£o foi gerado por n√≥s.

> Caso a CF exija isso eu entendo que talvez n√£o seja um comportamento de resposta a algum tipo de ataque ou script malicioso. Nesse caso teria que ter uma outra valida√ß√£o separado desse 403, talvez. 

Isso, o problema √© justamente como separar. Quando a Cloudflare decide que s√≥ vai liberar acessos que passarem primeiramente pelo desafio, ent√£o toda requisi√ß√£o de JSON ser√° bloqueada at√© que uma requisi√ß√£o HTML passe pelo desafio. Esses casos tamb√©m retornam 403, mas talvez tenha algum cabe√ßalho que d√™ para identificar o motivo do bloqueio. **√â isso que precisamos descobrir.** Se n√£o tivermos como diferenciar, ent√£o talvez a mensagem precise ser mais abrangente para englobar o dois casos.

> Ao inv√©s de retornar o erro na tela, deveria aparecer algum embed direto para conseguir resolver o desafio e ent√£o completar o post request?

Quanto a isso n√£o precisamos nos preocupar, pois a Cloudflare que gerencia. Normalmente n√£o precisa de nenhuma intera√ß√£o do usu√°rio, mas as vezes precisa e, nesses casos, ela j√° carrega a p√°gina onde o usu√°rio dever√° interagir. O que temos que ter em mente aqui √© que ela s√≥ consegue enviar o desafio quando o usu√°rio est√° requisitando algum HTML, ent√£o n√£o vai ser enviado nenhum desafio quando ela bloqueia requisi√ß√µes para a API (assim como quando se navega em SPA).

>> Coment√°rio de guscsales:
> mas talvez tenha algum cabe√ßalho que d√™ para identificar o motivo do bloqueio.

boa, fiz uma pesquisa r√°pida aqui e parece que existem alguns headers sim, por exemplo o [`CF-RAY`](https://developers.cloudflare.com/fundamentals/reference/http-request-headers/#cf-ray) que cria um hash para o visitante, mas pela documenta√ß√£o parece que podem ter outros. Tem que explorar um pouco mais.

Voc√™ tem algum caso de teste que retorne esse 403 j√° que de pra fazer em ambiente de desenvolvimento? Posso pegar para analisar isso, depois de descobrir o header de fato podemos pensar numa mensagem personalizada, que acha?

>> Coment√°rio de aprendendofelipe:
Ainda n√£o temos nenhum teste que simule respostas da Cloudflare

>> Coment√°rio de guscsales:
Certo, mas na teoria se eu rodar o projeto em ambiente de dev seguindo o read.me ele ir√° passar pelo cloudflare? Assim posso tentar simular alguns casos.

>> Coment√°rio de aprendendofelipe:
> Certo, mas na teoria se eu rodar o projeto em ambiente de dev seguindo o read.me ele ir√° passar pelo cloudflare?

Assim n√£o vai passar pela Cloudflare. Na verdade as requisi√ß√µes nem v√£o sair da sua m√°quina se voc√™ estiver rodando localmente.

O ambiente de homologa√ß√£o do TabNews tamb√©m n√£o vai ajudar, pois n√£o usa a Cloudflare. E n√£o recomendo testar em produ√ß√£o.

Se eu entendi, voc√™ quer testar na pr√°tica o comportamento da Cloudflare, certo? Nesse caso, uma boa op√ß√£o √© criar um projeto simples, espec√≠fico para o teste, e colocar a Cloudflare como proxy. Se for hospedar o teste na Vercel, a documenta√ß√£o deles pode ajudar com a integra√ß√£o:

https://vercel.com/docs/integrations/cloudflare

O projeto de teste at√© poderia ser um clone do TabNews, mas para esse caso n√£o vale a pena, j√° que voc√™ teria que subir tamb√©m um PostgreSQL, configurar um servidor de email, al√©m de envolver muitas outras vari√°veis no seu teste.

---

Como exemplo para os testes, uma requisi√ß√£o que foi bloqueada pela Cloudflare continha no *body* o texto `/proc/version` e outra continha

```
`curl -fsSL https://bun.sh/install | bash`
```

J√° para for√ßar a Cloudflare a exigir desafio para todos os acessos, uma forma simples √© habilitar em *Quick Actions*:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/7f2ef907-5f8f-4b06-9b2a-dfab79d1e627)
</issue_1516_Mostrar mensagem de erro mais espec√≠fica quando uma publica√ß√£o for barrada pela Cloudflare>

<issue_1518_Feature enquete>
Tava pensando numa forma de fazer com que desse para colocar enquetes no tabnews, por√©m o que impede √© a proposta do tabnews que √© entregar conte√∫do de valor e n√£o apenas uma marca√ß√£o de "sim e n√£o", ent√£o pensei uma solu√ß√£o.

Quando a pessoa que for responder a enquete ela √© obrigada a comentar na publica√ß√£o, e esse coment√°rio teria tipo uma etiqueta/r√≥tulo que mostrasse o que ele marcou na op√ß√£o. Resolvendo o problema de n√£o ter enquete e ainda seguindo a proposta do tabnews

>> Coment√°rio de aprendendofelipe:
Fala @Nelson-Afonso404, obrigado pela sugest√£o! üí™

N√£o acho que o fato de ser obrigat√≥rio comentar algo para poder responder a pesquisa seja interessante para quem est√° disponibilizando uma enquete. Quem responde pesquisas pode at√© fazer isso de gra√ßa em alguns casos, mas dificilmente ir√° querer "pagar" (ou ter qualquer trabalho extra) para poder responder, ent√£o isso limitaria muito a quantidade de respostas.

Mas talvez a cria√ß√£o de enquetes seja mais uma possibilidade interessante para o uso de TabCash üëç

>> Coment√°rio de iget-master:
Acredito que √© algo que pode ser resolvido com alguma ferramenta externa como a que criei [`md-poll`](https://md-poll.vercel.app/), veja o lan√ßamento feito no tabnews 2 meses atr√°s: https://www.tabnews.com.br/eliaseas/lancamento-enquetes-dentro-do-tabnews-e-qualquer-markdown
</issue_1518_Feature enquete>

<issue_1519_[Sugest√£o] Ver limite de votos em 72 horas por userID ao inv√©s de clientIP>
Estava navegando pelo c√≥digo e vi algo que poderia ser melhorado, a fun√ß√£o que verifica se usu√°rio pode ou n√£o fazer uma opera√ß√£o dentro de 72 horas.

A fun√ß√£o atual recebe clientIp para verificar, sendo assim, se forem feitos 3 votos e o usu√°rio trocar de IP (trocando de rede, wi-fi ou ate de wi-fi para 4g) ele poder√° continuar votando, mesmo j√° tendo 3 votos. 

Minha sugest√£o √© trocar a fun√ß√£o, n√£o procurando o IP no per√≠odo de tempo, mas sim o userId para o id do conte√∫do.

>> Coment√°rio de aprendendofelipe:
Fala @eletroswing, obrigado pela sugest√£o! üí™

Recomendo analisar a issue existente, principalmente esse [meu coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/1166#issuecomment-1576987135) em que trago alguns dados que pesam contra limitar a quantidade de votos por usu√°rio, isso pelo lado da experi√™ncia do usu√°rio e pela sa√∫de da economia de TabCoins. Ent√£o se voc√™ ganhou TabCoins por ter criado valor concreto, pode dar quantos quiser para quem tamb√©m criou valor, na sua opini√£o. Mas se fizer isso de forma abusiva, por exemplo concentrando a troca de votos em um c√≠rculo fechado de usu√°rios, √© f√°cil identificar, ent√£o n√£o vale a pena, pois todos os usu√°rios envolvidos ser√£o banidos.

J√° o limite de votos por IP √© para n√£o valer a pena criar um rob√¥ que use diferentes contas para inflar alguma publica√ß√£o espec√≠fica. √â claro que isso n√£o evita totalmente, mas a quest√£o principal, mais uma vez, √© n√£o valer a pena o esfor√ßo.

Caso queira, continue a conversa na #1166. Ent√£o vou fechar essa aqui como duplicada. Combinado? ü§ù
</issue_1519_[Sugest√£o] Ver limite de votos em 72 horas por userID ao inv√©s de clientIP>

<issue_1520_Informa√ß√µes do Tooltip do BarChart na p√°gina `/status` inleg√≠vel no tema escuro>
## Problema

Estava navegando pelo Tabnews e fui na p√°gina de status para ver como estava os n√∫meros de novos cadastros e publica√ß√µes, enfim, eu acabei vendo que no tema escuro as informa√ß√µes do Tooltip n√£o est√£o leg√≠veis. Aqui embaixo eu fiz at√© um comparativo:

Tema claro:
![Screenshot from 2023-09-27 09-58-40](https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/f24ab9ec-c522-4992-ad15-09fbf4a5268c)

Tema escuro:
![Screenshot from 2023-09-27 09-58-45](https://github.com/filipedeschamps/tabnews.com.br/assets/79858234/78036b64-3e63-4169-9833-91f4c73274f1)

Sendo que at√© continua a mesma cor de fundo, a √∫nica coisa que muda √© a cor da fonte da data que √© o maior problema, ao meu ver.

## Solu√ß√£o (???)

Bem, eu dei uma pesquisada no Google sobre o pacote `recharts` e o componente [Tooltip](https://recharts.org/en-US/api/Tooltip), e encontrei que ele pode ser personalizado pelo React inline style, eu posso at√© implementar mas n√£o entendi muito bem como funciona a troca de tema do tabnews. Mas de qualquer forma, j√° uma luz para quem for implementar.

>> Coment√°rio de aprendendofelipe:
@Poveii, obrigado por reportar! üí™

O problema foi resolvido com o PR #1521 üëç
</issue_1520_Informa√ß√µes do Tooltip do BarChart na p√°gina `/status` inleg√≠vel no tema escuro>

<issue_1522_[ Sugest√£o ] Pop-up de explica√ß√£o do que s√£o as TabCoin e TabCash.>
Poderia abrir um Pop-up para o usu√°rio quando ele clicasse no determinado √≠cone explicando o que ele √© e como conseguir mais.

>> Coment√°rio de Poveii:
Eu vejo que isso poderia ser implementado ao **FAQ**, ao inv√©s de abrir pop-up explicando as coisas. Nem o Tabnews e o Github (que a gente usa o design system dele) tem modais assim, eu s√≥ vi alguns de **confirma√ß√£o** de algo, tipo quando voc√™ quer arquivar ou privar um reposit√≥rio.

Podemos implementar a issue com essa ideia: #1380

>> Coment√°rio de Rafatcb:
Douglas, muito obrigado pela sugest√£o! 

Tooltips n√£o s√£o um bom caminho para "educar" o usu√°rio sobre algo t√£o essencial, e uma Pop Up (clica e aparece um Dialog) √© algo escondido tamb√©m, porque os TabCoins e TabCash n√£o parecem clic√°veis. A ideia do @Poveii, apesar de ser um bom primeiro passo, ainda n√£o atenderia a demanda total, pois o usu√°rio precisaria passar pelo processo de descoberta do FAQ.

Ent√£o, como teremos o FAQ em breve e surgiu uma √≥tima sugest√£o recentemente (https://github.com/filipedeschamps/tabnews.com.br/issues/1575) que parece que solucionar√° o problema daqui, vou deixar esta como dupllicada da outra, ok? A sugest√£o √© sobre um "tour" para novos usu√°rios, assim o processo de descoberta ocorre naturalmente, e o usu√°rio poder√° aprender sobre TabCoins, TabCash, os votos e outros aspectos importantes do TabNews.
</issue_1522_[ Sugest√£o ] Pop-up de explica√ß√£o do que s√£o as TabCoin e TabCash.>

<issue_1523_[Melhoria>

</issue_1523_[Melhoria>

<issue_1524_[Melhoria  / Bug ] Bot√£o Salvar do edit-profile sem redirecionamento>
**Problema:** Ap√≥s editar o perfil, ao clicar em salvar ele chama corretamente a rota e salva, por√©m o usu√°rio mant√©m-se na mesma p√°gina;

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/55398495/e693ee91-a254-4eeb-a17a-c557fbd0b9f0)


Isso para o usu√°rio pode dar ambiguidade de fluxo, visto que n√£o h√° um toast ou at√© mesmo um redirecionamento apontando que foi salvo

Sugest√£o 1:

Redirecionamento de salvamenmto, ap√≥s clicar em salvar e a rota ter recebido 200, abrir um modal confirmando que o perfil foi editado

Isso pode ser feito no arquivo: filipedeschamps/tabnews.com.br/pages/perfil/index.public.js

` <FormControl>
          <FormControl.Label visuallyHidden>Salvar</FormControl.Label>
          <ButtonWithLoader
            variant="primary"
            size="large"
            type="submit"
            sx={{ width: '100%' }}
            aria-label="Salvar"
            isLoading={isLoading}>
            onClick={() => router.push('/')}
            Salvar
          </ButtonWithLoader>
        </FormControl>`

Dentro desse componente chamar  o rouiter.push se de fato foi salvo


Sugest√£o 2: 

Criar um modal para ap√≥s clicar em salvar, se retorna 200 abre um modal de confirma√ß√£o, se retorna erro um modal de erro.

>> Coment√°rio de aprendendofelipe:
Fala @espezzialy, obrigado pela sugest√£o! üí™

Uma op√ß√£o simples √© usar o [Flash](https://primer.style/react/Flash) do Primer com uma mensagem que informe que foi salvo com sucesso:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/50847b1a-c0de-4fdb-b131-8093c6ad8589)

Ou, se for para redirecionar, acho que o ideal seria ir para a p√°gina do perfil do usu√°rio, mas primeiro a gente precisa usar alguma estrat√©gia de interface otimista, pois sen√£o na primeira navega√ß√£o o usu√°rio poder√° ver o conte√∫do antigo por causa do cache.

>> Coment√°rio de iurynogueira:
Ola! Sou novo por aqui e queria contribuir, posso implementar essa task?

>> Coment√°rio de aprendendofelipe:
> Ola! Sou novo por aqui e queria contribuir, posso implementar essa task?

Seja bem vindo @iurynogueira! Nem precisa pedir ou avisar üòâüëç

>> Coment√°rio de kaique-soares:
Fala @espezzialy :handshake: 

Ocorreu o merge as seguintes PRs:
- #1545
- #1548

Acho que esta issue pode ser fechada, n√£o?

>> Coment√°rio de Rafatcb:
@aprendendofelipe pode fechar aqui?

>> Coment√°rio de aprendendofelipe:
Apesar da sugest√£o original n√£o ter sido implementada, acredito que o objetivo principal tenha sido atingido com feedback ao salvar o perfil.

Vou fechar a issue, mas podem comentar aqui mesmo sobre qualquer coisa que queiram adicionar ao assunto e, se for necess√°rio, a gente reabre a issue ü§ù
</issue_1524_[Melhoria  / Bug ] Bot√£o Salvar do edit-profile sem redirecionamento>

<issue_1526_Vamos preparar o reposit√≥rio para abertura da Milestone de Revenue Share?>
Eu proponho o que foi feito para a abertura da primeira Milestone do projeto, pelo que me lembro:

1. Fechar todas as **Issues**, seja por inatividade ou porque n√£o ser√° atuado no curto prazo.
2. Avaliar todos os **Pull Requests** para entender de vamos fazer o merge ou fechar.
3. Para ambos **Issues** e **Pull Requests**, caso sejam fechados, considerar se √© o caso de adicionar a tag de repescagem.

Daria para trabalhar sem fazer este tipo de manuten√ß√£o, mas acredito que conseguiremos lidar melhor e com **total foco** no trabalho que precisa ser feito para essa Milestone que √© **super sens√≠vel**. Fora que, para quem √© novo no reposit√≥rio, ver **`230`** Issues e **`36`** Pull Requests abertos √© desanimador e passa um sinal que h√° uma alta chance de sua contribui√ß√£o ficar pendurada. Vamos mudar isso a partir de hoje? ü§ù

>> Coment√°rio de ZCErik:
O melhor dia para mudar isso foi ontem, o segundo melhor dia √© hoje!

Eu topo! E confesso que quando olhei pela primeira vez senti um pouco desanimado mesmo, mas vou olhar de novo e ver como posso contribuir!

>> Coment√°rio de aprendendofelipe:
> 3\. Para ambos **Issues** e **Pull Requests**, caso sejam fechados, considerar se √© o caso de adicionar a tag de repescagem.

### Sobre PRs

Penso que a tag de repescagem √© uma boa para alguns PRs que n√£o est√£o associados com nenhuma issue, mas que ainda devem ter alguma implementa√ß√£o baseada no trabalho atual. Mas isso deveria se exce√ß√£o, pois √© muito melhor uma issue documentando o caso e direcionando para o PR, e nesse caso a tag n√£o √© mais necess√°ria.

Eu optei por deixar esses PRs como draft, mas √© um *trade-off*, pois fica mais f√°cil desses casos serem encontrados por novos contribuidores, mas tamb√©m pode dar essa impress√£o de que uma nova contribui√ß√£o pode ficar pendurada.

Acho que falta uma documenta√ß√£o de como contribuir, onde podemos estipular um prazo para que os PRs permane√ßam com *status draft*, para ent√£o fechar e colocar a tag de repescagem (se for o caso).

S√≥ n√£o acho necess√°ria a tag de repescagem para os PRs que tem issues relacionadas, pois quem for dar encaminhamento na issue j√° tem essa informa√ß√£o documentada.

### Sobre issues

N√£o acho legal fechar issues que ainda precisem de algum encaminhamento, mesmo que ningu√©m esteja lidando com elas no momento, a n√£o ser que seja algo que n√£o precisamos de nenhuma contribui√ß√£o relacionada nem no m√©dio prazo. Pelo contr√°rio, acho que precisamos estimular o encaminhamento delas, principalmente das priorit√°rias.

J√° sobre as issues que tratam de ideias que n√£o vingaram ou que realmente n√£o vamos lidar nem no m√©dio prazo, ent√£o podemos fechar. E nesses casos n√£o h√° necessidade de tag de repescagem. Se for o caso de poss√≠vel repescagem, penso que seja melhor deixar a issue aberta, do que fechar e serem criadas novas duplicadas de tempos em tempos.

>> Coment√°rio de Rafatcb:
<sup>√öltima atualiza√ß√£o: 31/12/2023 08:55, √∫ltimo issue antigo fechado: #1467 e √∫ltimo PR antigo fechado: #1498</sup>

**Agora temos *99 issues* (vs 230) e *6 pull requests* (vs 36) abertos :tada:**

## Issues

Conseguimos fazer uma boa limpa, **foram 135 issues antigos fechados** (contando apenas os criados antes deste). Vale mencionar que alguns issues novos tamb√©m foram fechados, mas as listas abaixo contemplam apenas os antigos.

Para termos uma boa imagem sobre o progresso da organiza√ß√£o, realizei um filtro na busca do GitHub verificando apenas issues criados antes e fechados depois da cria√ß√£o deste, ordenando pela data de atualiza√ß√£o mais recente: [`is:issue closed:>=2023-10-03 created:<=2023-10-03 sort:updated-desc`](https://github.com/filipedeschamps/tabnews.com.br/issues?q=is%3Aissue+closed%3A%3E%3D2023-10-03+created%3A%3C%3D2023-10-03+sort%3Aupdated-desc).

Talvez algum issue abaixo esteja classificado na categoria errada, mas a maioria est√° na categoria correta.


### Resolvidos/Implementados

1. https://github.com/filipedeschamps/tabnews.com.br/issues/788
2. https://github.com/filipedeschamps/tabnews.com.br/issues/1414
3. https://github.com/filipedeschamps/tabnews.com.br/issues/1378
4. https://github.com/filipedeschamps/tabnews.com.br/issues/1422
5. https://github.com/filipedeschamps/tabnews.com.br/issues/1524
6. https://github.com/filipedeschamps/tabnews.com.br/issues/902
7. https://github.com/filipedeschamps/tabnews.com.br/issues/943
8. https://github.com/filipedeschamps/tabnews.com.br/issues/807

### J√° resolvidos anteriormente

Esses j√° haviam sido resolvidos, mas provavelmente ficaram abertos por esquecimento.

1. https://github.com/filipedeschamps/tabnews.com.br/issues/686
2. https://github.com/filipedeschamps/tabnews.com.br/issues/958
3. https://github.com/filipedeschamps/tabnews.com.br/issues/927
4. https://github.com/filipedeschamps/tabnews.com.br/issues/1124
5. https://github.com/filipedeschamps/tabnews.com.br/issues/879 (talvez possa ser considerado duplicado de #1156)
9. https://github.com/filipedeschamps/tabnews.com.br/issues/915
10. https://github.com/filipedeschamps/tabnews.com.br/issues/833
11. https://github.com/filipedeschamps/tabnews.com.br/issues/1127
12. https://github.com/filipedeschamps/tabnews.com.br/issues/1035
13. https://github.com/filipedeschamps/tabnews.com.br/issues/909
14. https://github.com/filipedeschamps/tabnews.com.br/issues/978
15. https://github.com/filipedeschamps/tabnews.com.br/issues/1194 (2 sugest√µes, 1 resolvida e 1 duplicada)
16. https://github.com/filipedeschamps/tabnews.com.br/issues/1208
17. https://github.com/filipedeschamps/tabnews.com.br/issues/979 (3 sugest√µes, 2 resolvidas e 1 duplicada)
18. https://github.com/filipedeschamps/tabnews.com.br/issues/987 (2 sugest√µes, 1 resolvida e 1 duplicada)
19. https://github.com/filipedeschamps/tabnews.com.br/issues/959
20. https://github.com/filipedeschamps/tabnews.com.br/issues/1166
21. https://github.com/filipedeschamps/tabnews.com.br/issues/772
22. https://github.com/filipedeschamps/tabnews.com.br/issues/735
23. https://github.com/filipedeschamps/tabnews.com.br/issues/924
24. https://github.com/filipedeschamps/tabnews.com.br/issues/903
25. https://github.com/filipedeschamps/tabnews.com.br/issues/866
26. https://github.com/filipedeschamps/tabnews.com.br/issues/1424
27. https://github.com/filipedeschamps/tabnews.com.br/issues/975
28. https://github.com/filipedeschamps/tabnews.com.br/issues/1198 (de outro jeito)

### Duplicados

Os issues duplicados foram fechados para concentrar a discuss√£o num √∫nico issue.

1. https://github.com/filipedeschamps/tabnews.com.br/issues/856 (resolvido)
2. https://github.com/filipedeschamps/tabnews.com.br/issues/790
3. https://github.com/filipedeschamps/tabnews.com.br/issues/967
4. https://github.com/filipedeschamps/tabnews.com.br/issues/798
5. https://github.com/filipedeschamps/tabnews.com.br/issues/793
6. https://github.com/filipedeschamps/tabnews.com.br/issues/1066
7. https://github.com/filipedeschamps/tabnews.com.br/issues/1456
8. https://github.com/filipedeschamps/tabnews.com.br/issues/762
9. https://github.com/filipedeschamps/tabnews.com.br/issues/935
10. https://github.com/filipedeschamps/tabnews.com.br/issues/993 (resolvido)
11. https://github.com/filipedeschamps/tabnews.com.br/issues/1371 (resolvido)
12. https://github.com/filipedeschamps/tabnews.com.br/issues/1245
13. https://github.com/filipedeschamps/tabnews.com.br/issues/1004
14. https://github.com/filipedeschamps/tabnews.com.br/issues/1057
15. https://github.com/filipedeschamps/tabnews.com.br/issues/1056
16. https://github.com/filipedeschamps/tabnews.com.br/issues/970
17. https://github.com/filipedeschamps/tabnews.com.br/issues/1209
18. https://github.com/filipedeschamps/tabnews.com.br/issues/1016
19. https://github.com/filipedeschamps/tabnews.com.br/issues/752
20. https://github.com/filipedeschamps/tabnews.com.br/issues/990
21. https://github.com/filipedeschamps/tabnews.com.br/issues/612
22. https://github.com/filipedeschamps/tabnews.com.br/issues/899
23. https://github.com/filipedeschamps/tabnews.com.br/issues/995
29. https://github.com/filipedeschamps/tabnews.com.br/issues/1017
30. https://github.com/filipedeschamps/tabnews.com.br/issues/1007
31. https://github.com/filipedeschamps/tabnews.com.br/issues/998
32. https://github.com/filipedeschamps/tabnews.com.br/issues/753
33. https://github.com/filipedeschamps/tabnews.com.br/issues/878
34. https://github.com/filipedeschamps/tabnews.com.br/issues/920
35. https://github.com/filipedeschamps/tabnews.com.br/issues/1000
36. https://github.com/filipedeschamps/tabnews.com.br/issues/1116
37. https://github.com/filipedeschamps/tabnews.com.br/issues/614
38. https://github.com/filipedeschamps/tabnews.com.br/issues/940
39. https://github.com/filipedeschamps/tabnews.com.br/issues/991
40. https://github.com/filipedeschamps/tabnews.com.br/issues/1086
41. https://github.com/filipedeschamps/tabnews.com.br/issues/1478
42. https://github.com/filipedeschamps/tabnews.com.br/issues/1026
43. https://github.com/filipedeschamps/tabnews.com.br/issues/980
44. https://github.com/filipedeschamps/tabnews.com.br/issues/1462
45. https://github.com/filipedeschamps/tabnews.com.br/issues/1040
46. https://github.com/filipedeschamps/tabnews.com.br/issues/1054
47. https://github.com/filipedeschamps/tabnews.com.br/issues/1091
48. https://github.com/filipedeschamps/tabnews.com.br/issues/1079
49. https://github.com/filipedeschamps/tabnews.com.br/issues/1320
50. https://github.com/filipedeschamps/tabnews.com.br/issues/1109
51. https://github.com/filipedeschamps/tabnews.com.br/issues/885
52. https://github.com/filipedeschamps/tabnews.com.br/issues/1011
53. https://github.com/filipedeschamps/tabnews.com.br/issues/1046
54. https://github.com/filipedeschamps/tabnews.com.br/issues/1398
55. https://github.com/filipedeschamps/tabnews.com.br/issues/1416
56. https://github.com/filipedeschamps/tabnews.com.br/issues/1488
57. https://github.com/filipedeschamps/tabnews.com.br/issues/971 (resolvido)
58. https://github.com/filipedeschamps/tabnews.com.br/issues/997
59. https://github.com/filipedeschamps/tabnews.com.br/issues/1137
60. https://github.com/filipedeschamps/tabnews.com.br/issues/1241
61. https://github.com/filipedeschamps/tabnews.com.br/issues/1324
62. https://github.com/filipedeschamps/tabnews.com.br/issues/1043
63. https://github.com/filipedeschamps/tabnews.com.br/issues/1137
64. https://github.com/filipedeschamps/tabnews.com.br/issues/1241
65. https://github.com/filipedeschamps/tabnews.com.br/issues/565
66. https://github.com/filipedeschamps/tabnews.com.br/issues/1522

### N√£o planejado

1. https://github.com/filipedeschamps/tabnews.com.br/issues/598
2. https://github.com/filipedeschamps/tabnews.com.br/issues/949
3. https://github.com/filipedeschamps/tabnews.com.br/issues/986
4. https://github.com/filipedeschamps/tabnews.com.br/issues/913 (n√£o tenho certeza)
5. https://github.com/filipedeschamps/tabnews.com.br/issues/942
6. https://github.com/filipedeschamps/tabnews.com.br/issues/1437
7. https://github.com/filipedeschamps/tabnews.com.br/issues/606
8. https://github.com/filipedeschamps/tabnews.com.br/issues/1261
9. https://github.com/filipedeschamps/tabnews.com.br/issues/1222
10. https://github.com/filipedeschamps/tabnews.com.br/issues/904 (futuramente)
11. https://github.com/filipedeschamps/tabnews.com.br/issues/876
12. https://github.com/filipedeschamps/tabnews.com.br/issues/908
13. https://github.com/filipedeschamps/tabnews.com.br/issues/791
14. https://github.com/filipedeschamps/tabnews.com.br/issues/1032
15. https://github.com/filipedeschamps/tabnews.com.br/issues/999
16. https://github.com/filipedeschamps/tabnews.com.br/issues/1503
17. https://github.com/filipedeschamps/tabnews.com.br/issues/1135
18. https://github.com/filipedeschamps/tabnews.com.br/issues/1167
19. https://github.com/filipedeschamps/tabnews.com.br/issues/1107
20. https://github.com/filipedeschamps/tabnews.com.br/issues/1118
21. https://github.com/filipedeschamps/tabnews.com.br/issues/1038
22. https://github.com/filipedeschamps/tabnews.com.br/issues/1269
23. https://github.com/filipedeschamps/tabnews.com.br/issues/961
24. https://github.com/filipedeschamps/tabnews.com.br/issues/1013
25. https://github.com/filipedeschamps/tabnews.com.br/issues/1071
26. https://github.com/filipedeschamps/tabnews.com.br/issues/1076
27. https://github.com/filipedeschamps/tabnews.com.br/issues/1213
28. https://github.com/filipedeschamps/tabnews.com.br/issues/1467

### Off-topic/d√∫vidas

1. https://github.com/filipedeschamps/tabnews.com.br/issues/887
2. https://github.com/filipedeschamps/tabnews.com.br/issues/695
3. https://github.com/filipedeschamps/tabnews.com.br/issues/1129
4. https://github.com/filipedeschamps/tabnews.com.br/issues/1097
5. https://github.com/filipedeschamps/tabnews.com.br/issues/1015
6. https://github.com/filipedeschamps/tabnews.com.br/issues/886
7. https://github.com/filipedeschamps/tabnews.com.br/issues/932
8. https://github.com/filipedeschamps/tabnews.com.br/issues/554
9. https://github.com/filipedeschamps/tabnews.com.br/issues/822
10. https://github.com/filipedeschamps/tabnews.com.br/issues/918
11. https://github.com/filipedeschamps/tabnews.com.br/issues/1197
12. https://github.com/filipedeschamps/tabnews.com.br/issues/994

## Pull Requests

Do lado dos PRs, **foram 37 PRs antigos fechados**. Acredito que o peso dos PRs abertos causa uma impress√£o pior em quem vai colaborar do que a quantidade de issues abertos, pois a pessoa pode pensar que a contribui√ß√£o dela ficar√° pendurada, sem motivo para n√£o ter sido mergeada.

Usei o mesmo tipo de filtro para os PRs: [`is:pr closed:>=2023-10-03 created:<=2023-10-03 sort:updated-desc`](https://github.com/filipedeschamps/tabnews.com.br/pulls?q=is%3Apr+closed%3A%3E%3D2023-10-03+created%3A%3C%3D2023-10-03+sort%3Aupdated-desc).

### Implementado

1. https://github.com/filipedeschamps/tabnews.com.br/pull/1525
2. https://github.com/filipedeschamps/tabnews.com.br/pull/1188

### Fechados

Os PRs foram fechados por motivos diferentes, recomendo abrir e ler o coment√°rio realizado no momento de fechamento para entender cada um. Alguns foram implementados em outro PR, outros foram "abandonados", outros "postergados" etc. Assim como fiz na lista de issues, os PRs abaixo cont√©m apenas os antigos.

1. https://github.com/filipedeschamps/tabnews.com.br/pull/1190
2. https://github.com/filipedeschamps/tabnews.com.br/pull/1481
3. https://github.com/filipedeschamps/tabnews.com.br/pull/1476
4. https://github.com/filipedeschamps/tabnews.com.br/pull/1455
5. https://github.com/filipedeschamps/tabnews.com.br/pull/1408
6. https://github.com/filipedeschamps/tabnews.com.br/pull/1428
7. https://github.com/filipedeschamps/tabnews.com.br/pull/1413
8. https://github.com/filipedeschamps/tabnews.com.br/pull/557
9. https://github.com/filipedeschamps/tabnews.com.br/pull/599
10. https://github.com/filipedeschamps/tabnews.com.br/pull/799
11. https://github.com/filipedeschamps/tabnews.com.br/pull/947
12. https://github.com/filipedeschamps/tabnews.com.br/pull/982
13. https://github.com/filipedeschamps/tabnews.com.br/pull/984
14. https://github.com/filipedeschamps/tabnews.com.br/pull/996
15. https://github.com/filipedeschamps/tabnews.com.br/pull/1202
16. https://github.com/filipedeschamps/tabnews.com.br/pull/1165
17. https://github.com/filipedeschamps/tabnews.com.br/pull/1295
18. https://github.com/filipedeschamps/tabnews.com.br/pull/1433
19. https://github.com/filipedeschamps/tabnews.com.br/pull/1195
20. https://github.com/filipedeschamps/tabnews.com.br/pull/1279
21. https://github.com/filipedeschamps/tabnews.com.br/pull/1123
22. https://github.com/filipedeschamps/tabnews.com.br/pull/1480
23. https://github.com/filipedeschamps/tabnews.com.br/pull/797
24. https://github.com/filipedeschamps/tabnews.com.br/pull/1336
25. https://github.com/filipedeschamps/tabnews.com.br/pull/1112
26. https://github.com/filipedeschamps/tabnews.com.br/pull/1005
27. https://github.com/filipedeschamps/tabnews.com.br/pull/892
28. https://github.com/filipedeschamps/tabnews.com.br/pull/1005
29. https://github.com/filipedeschamps/tabnews.com.br/pull/892
30. https://github.com/filipedeschamps/tabnews.com.br/pull/992
31. https://github.com/filipedeschamps/tabnews.com.br/pull/1210
32. https://github.com/filipedeschamps/tabnews.com.br/pull/946
33. https://github.com/filipedeschamps/tabnews.com.br/pull/929
34. https://github.com/filipedeschamps/tabnews.com.br/pull/1082
35. https://github.com/filipedeschamps/tabnews.com.br/pull/1409
36. https://github.com/filipedeschamps/tabnews.com.br/pull/1498

>> Coment√°rio de Rafatcb:
Acredito que os seguintes issues estejam no caminho para serem fechados tamb√©m, mas podem receber mais opini√µes/rea√ß√µes/respostas nos coment√°rios para chegar num consenso maior:

1. https://github.com/filipedeschamps/tabnews.com.br/issues/951
2. https://github.com/filipedeschamps/tabnews.com.br/issues/994
3. https://github.com/filipedeschamps/tabnews.com.br/issues/1013
4. https://github.com/filipedeschamps/tabnews.com.br/issues/1071
5. https://github.com/filipedeschamps/tabnews.com.br/issues/1076
6. https://github.com/filipedeschamps/tabnews.com.br/issues/1269
7. https://github.com/filipedeschamps/tabnews.com.br/issues/1522
8. https://github.com/filipedeschamps/tabnews.com.br/issues/1529
9. https://github.com/filipedeschamps/tabnews.com.br/issues/1467
10. https://github.com/filipedeschamps/tabnews.com.br/issues/1530
11. https://github.com/filipedeschamps/tabnews.com.br/issues/961

Edit: adicionado novos issues na lista, itens 9 e 10.
Edit2: adicionado item 11.

>> Coment√°rio de filipedeschamps:
> Agora temos 121 issues (vs 230) e 11 pull requests (vs 36) abertos üéâ

Que trabalho absuuuuuurdo de t√£o sensacionaaaaaaaaaal üòç üéâ üéâ üéâ

>> Coment√°rio de Rafatcb:
Pessoal, fiz a √∫ltima limpa do ano hoje e estamos numa situa√ß√£o bem melhor. Exatamente agora, s√£o **99 issues** abertos e **6 PRs**, sendo que todos os PRs est√£o em andamento com as revis√µes e implementa√ß√µes conforme revis√µes.

Quero agradecer a todos que ajudaram nesse processo, desde o @aprendendofelipe que fechou v√°rios issues e ajudou a decidir sempre que eu tive d√∫vida, at√© outros participantes do reposit√≥rio que deixaram suas opini√µes nos issues sobre a utilidade ou n√£o de um novo recurso a ser implementado, por exemplo.

E tamb√©m agradecer a todos que abriram PR, pois mesmo com os PRs sendo fechados, a revis√£o do c√≥digo e a sugest√£o de implementa√ß√£o trouxeram informa√ß√µes que dever√£o ser consideradas numa implementa√ß√£o num novo PR.

Al√©m disso, os issues e PRs que est√£o abertos foram organizados com [labels](https://github.com/filipedeschamps/tabnews.com.br/labels) para facilitar a busca e identifica√ß√£o do assunto na lista de issues/PRs.

Por √∫ltimo, estou fechando esse issue como resolvido üéâ üéâ. Vamos come√ßar o ano novo com o p√© direito no reposit√≥rio üòÅ

Meu coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1526#issuecomment-1858535433 est√° atualizado para quem quiser acompanhar o que foi feito em detalhes.

>> Coment√°rio de filipedeschamps:
> Vamos come√ßar o ano novo com o p√© direito no reposit√≥rio üòÅ

Vamos com certeza meu caro!! E isso tamb√©m ajuda muito naquela ideia do reposit√≥rio do TabNews se tornar o melhor local para pessoas treinarem contribui√ß√µes no mundo open source, e com isso acabar fortalecendo de pouco em pouco o pr√≥prio projeto üí™  Sinto que `2024` vai ser um ano bem diferente ü§ù 

Parab√©ns novamente por todo trabalho!! üòç
</issue_1526_Vamos preparar o reposit√≥rio para abertura da Milestone de Revenue Share?>

<issue_1527_[Bug] Link externo sem protocolo na url navega para uma rota inexistente da aplica√ß√£o>
Estava usando o TabNews e notei um comportamento estranho, ao clicar em algum link externo, por exemplo "www.google.com", a aplica√ß√£o entende o link como uma rota propria e navega para https://www.tabnews.com.br/www.google.com, o link externo s√≥ √© aberto caso o protocolo da url esteja presente, como em "https://www.google.com".

>> Coment√°rio de aprendendofelipe:
Fala @ikaikyy, n√£o vejo como um bug do TabNews, mas um engano de quem inseriu a URL de forma incompleta.

Se um protocolo n√£o √© informado, ent√£o o navegador pode entender que √© uma URL relativa e n√£o absoluta.

Se fosse o caso, o GitHub teria o mesmo bug. Na verdade o renderizador de markdown do TabNews at√© tentar ajudar mais que o do GitHub ao tentar "adivinhar" o protocolo e inserir `http://` no atributo `href` da tag `a`:

Como o link foi inserido | TabNews | GitHub
-- | :--: | -- 
`[www.google.com](www.google.com)` |‚ùå|‚ùå [www.google.com](www.google.com)
`<a href="www.google.com">www.google.com</a>` |insere `http`|‚ùå <a href="www.google.com">www.google.com</a> 
`[www.google.com](https://www.google.com)` |‚úî|‚úî [www.google.com](https://www.google.com) 
`<a href="https://www.google.com">www.google.com</a>`  |‚úî|‚úî <a href="https://www.google.com">www.google.com</a>
`https://www.google.com` |‚úî|‚úî https://www.google.com 
`www.google.com`  |‚úî|‚úî www.google.com 


Vou fechar a issue, mas fique √† vontade para reabrir se achar necess√°rio. Combinado? ü§ù
</issue_1527_[Bug] Link externo sem protocolo na url navega para uma rota inexistente da aplica√ß√£o>

<issue_1529_[UX] Facilitar o entendimento dos campos dos formul√°rios>
#1528

**Introdu√ß√£o**
-
Trago para discuss√£o a proposta de adicionar um recurso de dica de ajuda aos campos de formul√°rio para fornecer aos usu√°rios informa√ß√µes √∫teis e melhorar a experi√™ncia do usu√°rio.

Diferentemente de alguns bot√µes da aplica√ß√£o, atualmente os formul√°rios n√£o possuem nenhum contexto sobre o que colocar em seus campos, apenas valida√ß√µes caso eles forne√ßam alguma informa√ß√£o err√¥nea. Comportamento tal que pode deixar confuso quem n√£o tiver conhecimento pr√©vio sobre fun√ß√£o de cada informa√ß√£o.

Um exemplo seria o campo "Nome de usu√°rio", que n√£o deixa nenhum aviso pr√©vio ao usu√°rio de que ser√° sua URL personalizada para acesso ao seu conte√∫do, que √© algo nem t√£o comum, j√° que muitos sistemas utilizam UUIDs para acesso a entidades.

**Mudan√ßa proposta:**
- 
- Adicionar juntamente √†s labels dos formul√°rios, um √≠cone de ajuda que, ao passar o mouse por cima, exibe informa√ß√µes √∫teis e/ou avisos sobre o campo em quest√£o.
- O texto ser√° personaliz√°vel para cada label, assim o campo "email" por exemplo teria um texto diferente na tela de login e de recuperar senha por exemplo.
- Formul√°rios mais amig√°veis para quem ainda n√£o conhece a comunidade do TabNews, podendo assim evitar que algum usu√°rio novo utilize a plataforma de maneira indesejada.

**Plano de teste:**
-
- Testar em diferentes navegadores e dispositivos para garantir que a feature seja funcional para todos.
- Encontrar poss√≠veis problemas de escalabilidade que a implementa√ß√£o pode causar.

Ideias sobre onde e oque colocar nas dicas seriam de grande ajuda no desenvolvimento.

**Screenshots:**
-
![Captura de tela de 2023-10-07 11-56-27](https://github.com/filipedeschamps/tabnews.com.br/assets/73050619/db606de5-c2a9-432a-898a-280ad810b783)
![Captura de tela de 2023-10-07 11-56-04](https://github.com/filipedeschamps/tabnews.com.br/assets/73050619/d5fe79b4-eaae-41fa-97a3-13bab2cae7a5)
![Captura de tela de 2023-10-07 11-55-53](https://github.com/filipedeschamps/tabnews.com.br/assets/73050619/bde835af-108a-4345-8b45-db25d547d3f6)
![Captura de tela de 2023-10-07 11-55-31](https://github.com/filipedeschamps/tabnews.com.br/assets/73050619/c58dc06e-cc13-448c-a531-c4c84800f1d0)

>> Coment√°rio de Poveii:
√â uma adi√ß√£o legal, @ikaikyy, tanto para acessibilidade quanto para melhor entendimento dos campos apresentados. Por√©m eu vejo que esse √≠cone ficou bem exposto, e eu creio que seja melhor ele s√≥ aparecer quando o mouse estiver em cima, pois fica um elemento visual **muito chamativo**, sendo que √© s√≥ uma ajuda, j√° que o usu√°rio consegue entender s√≥ pelo nomes do campos.

>> Coment√°rio de aprendendofelipe:
@ikaikyy, obrigado pela proposta! üí™

√â fato que alguns campos podem gerar d√∫vidas em alguns usu√°rios, mas acho um pouco de exagero colocar ajuda em todos os campos.

Para o campo "Nome de usu√°rio", deve ser suficiente adicionar um `placeholder`, por exemplo, `IndentificadorP√∫blico`. Acho que algo vis√≠vel e sucinto tenha uma UX melhor do que o bot√£o de interroga√ß√£o para abrir a ajuda.

O outro que precisa de ajuda √© o campo "Fonte". At√© j√° existe issue aberta sobre isso (#941), ent√£o para a melhoria desse campo eu acho melhor continuar a discuss√£o por l√°, j√° que tem mais gente acompanhando.

E eu acho melhor n√£o citar regras de valida√ß√£o na ajuda, como quantidade de caracteres, etc. Pelo menos por enquanto eu deixaria isso apenas para a mensagem retornada pelo back-end.

Tamb√©m n√£o acho boa ideia colocar nessa ajuda os detalhes de como cada informa√ß√£o ser√° utilizada. Isso deve ser explicado de forma bem clara na nossa "pol√≠tica de privacidade", que ainda n√£o foi criada. Colocar isso na ajuda traria o risco de ficar algo incompleto e/ou desatualizado, o que nos causaria problemas com a LGPD.

Ent√£o n√£o vejo necessidade de ajuda para os outros campos. O que acham?

>> Coment√°rio de Rafatcb:
O Primer tem algumas orienta√ß√µes na documenta√ß√£o do [Text Input](https://primer.style/components/text-input), inclusive n√≥s quebramos uma delas na p√°gina de [Publicar Novo Conte√∫do](https://www.tabnews.com.br/publicar):

> Only use placeholder text to show an example of the expected input. Never use placeholder text for critical information.

E tem um elemento espec√≠fico para ajudar na informa√ß√£o sobre o campo:

> ![Anatomia do Text Input](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/c2dc4155-a297-42d7-949d-b15231352b80)
> 
> **Caption:** Provides additional context about the field to help users fill in the correct data or explain how the data will be used. Caption text should be as short as possible. Caption text may be displayed at the same time as a validation message, or it may be hidden if it only provides redundant information.

Como n√≥s decidimos usar os componentes do Primer, acredito que devemos seguir as suas recomenda√ß√µes de usabilidade tamb√©m. E isso evita os [problemas que uma Tooltip traz](https://primer.style/components/tooltip).

>> Coment√°rio de Rafatcb:
Com as melhorias implementadas em #1580, seguindo as orienta√ß√µes do Primer sobre [Formul√°rios](https://primer.style/ui-patterns/forms/overview), colocamos `label` em todos os campos de formul√°rio, indicador se o campo √© requerido, e um placeholder de exemplo.

Acho que isso resolve a necessidade de adicionar mais informa√ß√µes e podemos fechar esse issue, certo? Se precisar explicar ainda mais em algum campo, sugiro usar o `Caption` mencionado no meu coment√°rio anterior https://github.com/filipedeschamps/tabnews.com.br/issues/1529#issuecomment-1847647347.

>> Coment√°rio de aprendendofelipe:
> Acho que isso resolve a necessidade de adicionar mais informa√ß√µes e podemos fechar esse issue, certo? Se precisar explicar ainda mais em algum campo, sugiro usar o `Caption`

Talvez seja interessante usar o `Caption` nos campos de `username` nas telas `/cadastro` e `/perfil`.

No cadastro eu acho que √© v√°lido informar que o usu√°rio ser√° uma informa√ß√£o p√∫blica.

No perfil podemos informar que a altera√ß√£o ir√° modificar os links dos conte√∫dos. Mesmo existindo a mensagem de confirma√ß√£o, pode ser legal informar isso logo de cara.

O que acham?

E falando na mensagem de confirma√ß√£o, acho melhor mudar "publica√ß√µes" para "conte√∫dos", n√£o √©?

https://github.com/filipedeschamps/tabnews.com.br/blob/3110967e166430750dbbfc655afde41586ba05aa/pages/perfil/index.public.js#L83-L84

E talvez j√° reformular a mensagem para sanar a #895

>> Coment√°rio de Rafatcb:
> O que acham?

Concordo. Aproveitei para trocar o t√≠tulo do issue para ficar mais claro que agora n√£o se trata exatamente sobre Tooltips.

>> Coment√°rio de Rafatcb:
Mais uma melhoria que falta e est√° relacionada √† esse issue:

https://github.com/filipedeschamps/tabnews.com.br/blob/d03462c38620198652eb3a1f808cffc468d39323/pages/cadastro/index.public.js#L192-L196

Devemos usar `FormControl` e `Label` para o checkbox funcionar de forma adequada (permitir clicar no label, por exemplo). Veja o exemplo da [documenta√ß√£o](https://primer.style/components/checkbox/react):

```jsx
() => (
  <Box as="form">
    <FormControl>
      <Checkbox value="default" />
      <FormControl.Label>Default label</FormControl.Label>
    </FormControl>
  </Box>
)
```
</issue_1529_[UX] Facilitar o entendimento dos campos dos formul√°rios>

<issue_1530_[ Sugest√£o / Feature ] Bot√£o para navegar entre publica√ß√µes>
## Descri√ß√£o
Algo que vem me incomodando muito quando estou usando o TabNews √© o fato de, ao terminar de ler uma publica√ß√£o e seus coment√°rios, tenho que voltar √† p√°gina inicial para poder acessar outro conte√∫do, comportamento na maioria das vezes frustrante, pois quebra a imers√£o do usu√°rio.

Sinto que toda vez que eu quero procurar algum conte√∫do relevante, tenho que ler v√°rios t√≠tulos tentando julgar se √© ou n√£o relevante, e caso n√£o seja, novamente tenho que voltar √† p√°gina inicial e repetir o processo.

## Motiva√ß√£o
Basicamente toda rede social atualmente tem algum sistema que permita consumo cont√≠nuo aos seus conte√∫dos, sem quebrar a imers√£o do usu√°rio, fazendo at√© com que muitos se viciem e/ou nem vejam o tempo passar. 

D√° para tirar como exemplo o TikTok com seu sistema de scroll, ou at√© mesmo o Twitter que mostra tweets relacionados ao post e/ou relevantes ao usu√°rio. Como o TabNews ainda n√£o tem um algoritmo que possa recomendar posts ao usu√°rio, a melhor solu√ß√£o creio eu seria a simples implementa√ß√£o de um bot√£o que pulasse para a pr√≥xima publica√ß√£o ou voltasse para a anterior.

## Pontos para discuss√£o
- Em qual lugar da p√°gina colocar os bot√µes?
- Bot√µes s√£o realmente a melhor solu√ß√£o?
- Navegar apenas para publica√ß√µes que o usu√°rio ainda n√£o viu e/ou ainda n√£o gastou TabCoins? Ou navegar livremente entre as publica√ß√µes?

## Sugest√£o
Minha sugest√£o seria adicionar os bot√µes no Header da aplica√ß√£o, e no meio deles implementar um link com o nome do dono do post, e ao lado a posi√ß√£o ordinal do post em rela√ß√£o aos posts desse usu√°rio, algo como:

### <-- Usu√°rio #xyz -->

>> Coment√°rio de Poveii:
Essa ideia remete ao usu√°rio ficar **preso** a uma lista de v√°rios e v√°rios tabs, inv√©s de **escolher** o que ele quer ver, e n√£o ir "procurando" **inconscientemente** at√© encontrar algo bom. N√£o acho uma boa ideia, @ikaikyy.

>> Coment√°rio de Rafatcb:
Seguindo com o coment√°rio do @Poveii, que a comunidade concordou mais, estou fechando este issue para organizar o reposit√≥rio. Obrigado pela sugest√£o, @ikaikyy!
</issue_1530_[ Sugest√£o / Feature ] Bot√£o para navegar entre publica√ß√µes>

<issue_1532_bug(ui): Rolagem horizontal indesejada>
Acessando o Tab News num android (Samsung S23+, Google Chrome), acorre uma rolagem indesejada na horizontal, conforme video abaixo:

https://github.com/filipedeschamps/tabnews.com.br/assets/9434959/c27de94d-8cc1-4647-946e-bd51fd5865b5

Edit:

Observei que s√≥ acontece as vezes, e aparentemente tem a ver com a linha debaixo do t√≠tulo de um post ser muito grande, vide screenshot abaixo

![Screenshot_20231012_120454_Chrome.jpg](https://github.com/filipedeschamps/tabnews.com.br/assets/9434959/98d38d6d-a894-4403-8ec5-de2c5d679477)

>> Coment√°rio de Rafatcb:
Eu estava dando uma olhada no c√≥digo e parece que isso ocorre caso o nome de usu√°rio seja muito grande. Eu at√© cheguei a mexer, mas n√£o consegui resolver 100% porque o `position: absolute` da Tooltip est√° atrapalhando:

https://github.com/filipedeschamps/tabnews.com.br/blob/4c5593c8ef3d5f9adea1e476a8370e3681d3ba2b/pages/interface/components/ContentList/index.js#L123

Isso impede que a data v√° para uma terceira linha quando necess√°rio (telas pequenas e nome de usu√°rio grande).

Esse `absolute` surgiu no PR https://github.com/filipedeschamps/tabnews.com.br/pull/726 porque a Tooltip n√£o √© renderizada direito sem ele. Eu vi que houve uma atualiza√ß√£o da Tooltip do Primer na vers√£o [`36.2.0`](https://github.com/primer/react/blob/main/CHANGELOG.md#3620)  (estamos usando a `35.32.2`), experimentei atualizar mas n√£o ajudou, n√£o sei se precisa fazer algo a mais al√©m do `npm install` e `npm run dev` para o projeto levar em considera√ß√£o ou se a atualiza√ß√£o da Tooltip n√£o mudou algo para nossa necessidade mesmo.

Infelizmente, o componente ainda est√° em Alpha: https://primer.style/components/tooltip/react. O Primer do GitHub parece ter um progresso bem lento, pelo menos para passar os est√°gios ü´†

>> Coment√°rio de aprendendofelipe:
@iget-master, obrigado por reportar! üí™

> Eu estava dando uma olhada no c√≥digo e parece que isso ocorre caso o nome de usu√°rio seja muito grande.

Isso, e tamb√©m ocorre no header quando o usu√°rio tem muitos TabCoins e/ou TabCashs.

> Eu vi que houve uma atualiza√ß√£o da Tooltip do Primer na vers√£o [`36.2.0`](https://github.com/primer/react/blob/main/CHANGELOG.md#3620) (estamos usando a `35.32.2`), experimentei atualizar mas n√£o ajudou, n√£o sei se precisa fazer algo a mais al√©m do `npm install` e `npm run dev` para o projeto levar em considera√ß√£o ou se a atualiza√ß√£o da Tooltip n√£o mudou algo para nossa necessidade mesmo.

Provavelmente ainda n√£o corrigiram os bugs do Tooltip üòï

>> Coment√°rio de Rafatcb:
No caso do header, talvez scroll seja uma alternativa vi√°vel para n√£o diminuir a quantidade de informa√ß√µes (precisa ver na pr√°tica se fica legal). O Stack Overflow faz isso:

![Overflow com scroll no Stack Overflow](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/dbd7e596-7f61-4d40-975b-a582c17339ce)

>> Coment√°rio de aprendendofelipe:
Por favor, vejam no link abaixo se o PR #1562 resolveu todos os problemas ü§û

https://tabnews-git-fix-horizontal-scroll-tabnews.vercel.app

No caso de telas muito pequenas, ao inv√©s de rolar o scroll s√≥ no header, vai ter um scroll horizontal na pagina toda, mas o background do header agora acompanha o crescimento da largura da p√°gina.

>> Coment√°rio de aprendendofelipe:
S√≥ lembrando que o scroll visto abaixo s√≥ deve ocorrer em casos extremos de telas muito pequenas. No exemplo est√° com 208 pixels de largura:

![ezgif com-video-to-gif](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/690173ed-3ff1-45fa-92e8-926307ffba34)

Colocando um target de 360px de largura, agora temos folga no header para grandes saldos nas moedas.
</issue_1532_bug(ui): Rolagem horizontal indesejada>

<issue_1534_AJUDA! Ao tentar entrar na minha conta do TabNews, deu erro!>
# Ao tentar entrar na minha conta do TabNews, deu erro!

O que eu fa√ßo? N√£o fiz nada na minha conta para acontecer isso.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/60621494/a374be93-5623-45fb-82a5-8dd40ae01ad4)

>> Coment√°rio de aprendendofelipe:
Ol√° @gelzinn, se o usu√°rio est√° sem a permiss√£o para criar sess√£o, significa que a conta foi banida por viola√ß√£o dos termos de uso do TabNews.

Se ainda restar d√∫vidas mesmo ap√≥s a leitura dos [termos](https://www.tabnews.com.br/termos-de-uso), por respeito ao sigilo de dados de todos envolvidos, sugiro que sua d√∫vida seja sanada via email para `contato@tabnews.com.br`, onde o remetente deve ser o mesmo email do usu√°rio que foi banido. Combinado? ü§ù

Vou fechar a issue por n√£o se tratar de um bug

>> Coment√°rio de gelzinn:
Ok @aprendendofelipe, mandei o email. Se for poss√≠vel quero a resposta o quanto antes. Realmente n√£o faz sentido nenhum pra mim.

Inclusive, sugiro que mudem a mensagem para facilitar o entendimento do usu√°rio. N√£o faz sentido nenhum mostrar:
> Verifique se este usu√°rio possui a feature "create:session"
</issue_1534_AJUDA! Ao tentar entrar na minha conta do TabNews, deu erro!>

<issue_1536_Erro ao realizar login>
![Screenshot_2023-10-17-15-33-30-237_com.android.chrome-edit.jpg](https://github.com/filipedeschamps/tabnews.com.br/assets/20962670/fcbe5534-e235-4c3b-82c5-3359eab49137)

Observa√ß√£o: e-mail e senha est√£o corretos, testei isso em 3 navegadores e em 2 dispositivos diferentes, com rede m√≥vel e com rede cabeada.

>> Coment√°rio de aprendendofelipe:
Ol√° @rafatrinity, se o usu√°rio est√° sem a permiss√£o para criar sess√£o, significa que a conta foi banida por viola√ß√£o dos termos de uso do TabNews.

Se ainda restar d√∫vidas mesmo ap√≥s a leitura dos [termos](https://www.tabnews.com.br/termos-de-uso), por respeito ao sigilo de dados de todos envolvidos, sugiro que sua d√∫vida seja sanada via email para contato@tabnews.com.br, onde o remetente deve ser o mesmo email do usu√°rio que foi banido. Combinado? ü§ù

Vou fechar a issue por n√£o se tratar de um bug

>> Coment√°rio de rafatrinity:
Agrade√ßo pelo feedback

Em qua., 18 de out. de 2023 08:13, Felipe Barso ***@***.***>
escreveu:

> Ol√° @rafatrinity <https://github.com/rafatrinity>, se o usu√°rio est√° sem
> a permiss√£o para criar sess√£o, significa que a conta foi banida por
> viola√ß√£o dos termos de uso do TabNews.
>
> Se ainda restar d√∫vidas mesmo ap√≥s a leitura dos termos
> <https://www.tabnews.com.br/termos-de-uso>, por respeito ao sigilo de
> dados de todos envolvidos, sugiro que sua d√∫vida seja sanada via email para
> ***@***.***, onde o remetente deve ser o mesmo email do
> usu√°rio que foi banido. Combinado? ü§ù
>
> Vou fechar a issue por n√£o se tratar de um bug
>
> ‚Äî
> Reply to this email directly, view it on GitHub
> <https://github.com/filipedeschamps/tabnews.com.br/issues/1536#issuecomment-1768228953>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AE7523ROA52XCJV3KHKQIB3X762WPAVCNFSM6AAAAAA6EUKBESVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTONRYGIZDQOJVGM>
> .
> You are receiving this because you were mentioned.Message ID:
> ***@***.***>
>
</issue_1536_Erro ao realizar login>

<issue_1537_[ Sugest√£o / Feature ] Contagem de visualiza√ß√µes nos posts>
Acho que seria interessante um contador de visualiza√ß√µes em cada post influenciando tamb√©m nos posts relevantes ;)

>> Coment√°rio de Rafatcb:
√â algo legal. J√° foi sugerido aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1115. Acho melhor concentrar a discuss√£o l√°.

>> Coment√°rio de aprendendofelipe:
Ol√° @salimcabus, obrigado pela sugest√£o! üí™

Reafirmo o que o @Rafatcb falou, e vou fechar essa como duplicada. Combinado? ü§ù
</issue_1537_[ Sugest√£o / Feature ] Contagem de visualiza√ß√µes nos posts>

<issue_1538_Porque fui banido?>
Tentei fazer login e recebi o seguinte erro:

> Voc√™ n√£o possui permiss√£o para fazer login. Verifique se este usu√°rio possui a feature "create:session".

Ent√£o descobri que recebi um "nuke":

Minha conta:

 - https://www.tabnews.com.br/natanael755

N√£o recebi nenhum email e nenhuma forma de contato informando que regra eu violei, perdi todas as minhas publica√ß√µes sem nunca ter recebido nenhuma flag ou aviso

>> Coment√°rio de aprendendofelipe:
Ol√° @natanael-b, por respeito ao sigilo de dados, sugiro que sua d√∫vida seja sanada via email para [contato@tabnews.com.br](mailto:contato@tabnews.com.br), onde o remetente deve ser o mesmo email do usu√°rio que busca a informa√ß√£o. Combinado? ü§ù

>> Coment√°rio de natanael-b:
Entrei em contato mas agora n√£o adianta mais j√° perdi todos os meus post, horas produzindo conte√∫do, as TabCash e afins
</issue_1538_Porque fui banido?>

<issue_1539_feat: Perfil do usu√°rio>
Sinto falta no tabnews de uma forma de ver quem aquela pessoa que est√° escrevendo √©, qual sua contribui√ß√£o pra comunidade tabnews, uma forma de ver sua credibilidade.

Para resolver isso, acho que seria interessante adicionar mais informa√ß√µes a pagina de perfil por exemplo:

* Links para redes sociais (linkdn, github, stackoverfkow, ...)
* Biografia
* Idade
* localiza√ß√£o

Al√©m desses dados preenchidos pelo usu√°rio, poderia exibir as publica√ß√µes de maior relev√¢ncia do usuario, em uma tab do lado do conte√∫do recente.

Acham essa funcionalidade √∫til?

<a href="https://md-poll.vercel.app/polls/9d4ca19c-7dce-452d-a895-64c93ba8607f/vote?option=0&close" target="_blank">
  <img src="https://md-poll.vercel.app/api/polls/9d4ca19c-7dce-452d-a895-64c93ba8607f/options/0/img" alt="Sim"/>
</a>
<br/>
<a href="https://md-poll.vercel.app/polls/9d4ca19c-7dce-452d-a895-64c93ba8607f/vote?option=1&close" target="_blank">
  <img src="https://md-poll.vercel.app/api/polls/9d4ca19c-7dce-452d-a895-64c93ba8607f/options/1/img" alt="N√£o"/>
</a>
<br/>
<small>Click on the option you want to vote.</small>
<br/>
<small>Enquete criada com o <a href="https://md-poll.vercel.app">md-poll</a>!

>> Coment√°rio de kaique-soares:
Ol√° @iget-master, interessante sua sugest√£o e tamb√©m o projeto de enquetes :handshake: 

Bom, logo ap√≥s o meu voto o resultado ficou assim:
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/a7efd1bc-b007-4bdc-9e3d-4eeb06229441)

Eu votei _N√£o_ porque acredito que temos formas mais simples de resolver o problema (no tocante a parte t√©cnica) e abaixo vou explicar melhor, veja se faz sentido:

- Dado o contexto atual do projeto, em que estamos mirando a #1490. Tamb√©m veja a issue #1526

Penso que poder√≠amos resolve o problema utilizando o recurso de **Descri√ß√£o** presente na p√°gina de edi√ß√£o do perfil. √â um recurso com grande pontencial de entrega para o usu√°rio j√° que √© um campo que aceita markdown:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/0ca0df0f-921f-4f04-ba1d-e96a1b88ddf6)

E acredito que tem um limite suficiente para incluir links √∫teis e uma **descri√ß√£o mais elaborada**:

https://github.com/filipedeschamps/tabnews.com.br/blob/85d6e91e61bd5b217ff555fc4a6de741a8ced504/infra/migrations/1688768453152_alter-table-users-add-description.js#L5

Concluindo, penso que podemos resolver o problema com o que j√° temos sem encostar em c√≥digo e que talvez o que esteja faltando seja uma divulga√ß√£o melhor do recurso, com exemplos simples e pr√°ticos por meio de publica√ß√µes dentro do pr√≥prio TabNews.

Um exemplo de utiliza√ß√£o para links √∫teis √© o perfil do @filipedeschamps, que neste exato momento est√° assim:
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/e5a56829-f613-45f4-b7da-8afdd64a0afd)

O que na minha vis√£o, confirma o que eu escrevi acima sobre ser um recurso com grande pontencial de entrega para o usu√°rio.

@iget-master faz sentido?

>> Coment√°rio de iget-master:
> Ol√° @iget-master, interessante sua sugest√£o e tamb√©m o projeto de enquetes :handshake: 
> 
> Bom, logo ap√≥s o meu voto o resultado ficou assim:
> ![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/a7efd1bc-b007-4bdc-9e3d-4eeb06229441)
> 
> Eu votei _N√£o_ porque acredito que temos formas mais simples de resolver o problema (no tocante a parte t√©cnica) e abaixo vou explicar melhor, veja se faz sentido:
> 
> - Dado o contexto atual do projeto, em que estamos mirando a #1490. Tamb√©m veja a issue #1526
> 
> Penso que poder√≠amos resolve o problema utilizando o recurso de **Descri√ß√£o** presente na p√°gina de edi√ß√£o do perfil. √â um recurso com grande pontencial de entrega para o usu√°rio j√° que √© um campo que aceita markdown:
> 
> ![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/0ca0df0f-921f-4f04-ba1d-e96a1b88ddf6)
> 
> E acredito que tem um limite suficiente para incluir links √∫teis e uma **descri√ß√£o mais elaborada**:
> 
> https://github.com/filipedeschamps/tabnews.com.br/blob/85d6e91e61bd5b217ff555fc4a6de741a8ced504/infra/migrations/1688768453152_alter-table-users-add-description.js#L5
> 
> Concluindo, penso que podemos resolver o problema com o que j√° temos sem encostar em c√≥digo e que talvez o que esteja faltando seja uma divulga√ß√£o melhor do recurso, com exemplos simples e pr√°ticos por meio de publica√ß√µes dentro do pr√≥prio TabNews.
> 
> Um exemplo de utiliza√ß√£o para links √∫teis √© o perfil do @filipedeschamps, que neste exato momento est√° assim:
> ![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/e5a56829-f613-45f4-b7da-8afdd64a0afd)
> 
> O que na minha vis√£o, confirma o que eu escrevi acima sobre ser um recurso com grande pontencial de entrega para o usu√°rio.
> 
> @iget-master faz sentido?

Para ser sincero, eu n√£o havia percebido que ja existe esse campo em markdown.

Sendo assim, acho que podemos fechar esse issue por ser um feature duplicado.

>> Coment√°rio de aprendendofelipe:
@iget-master, obrigado pela sugest√£o! üí™

A descri√ß√£o no perfil dos usu√°rios j√° foi implementada de maneira preliminar no PR #1470, e isso foi anunciado em uma [publica√ß√£o no TabNews](https://www.tabnews.com.br/FelipeBarso/tabnews-6-milhoes-de-visualizacoes-e-muita-novidade).

Ainda faltam ajustes, mas √© melhor centralizar a conversa na issue que j√° est√° com mais intera√ß√µes (#1466).

Vou fechar essa duplicada. ü§ù
</issue_1539_feat: Perfil do usu√°rio>

<issue_1540_MODEL:CONTENT:CREDIT_OR_DEBIT_TABCOINS:NEGATIVE_USER_EARNINGS>
![inspecior](https://github.com/filipedeschamps/tabnews.com.br/assets/49918079/a2eb36e9-69a9-4dbd-ba1c-e752bf183020)

Ol√° a todos, boa tarde. Criei uma nova conta no TabNews, visto que a minha anterior foi exclu√≠da, e comecei a repostar artigos antigos que eram da outra conta. Em uma das publica√ß√µes, recebi uma avalia√ß√£o negativa, o que acabou me impedindo de comentar ou publicar novos conte√∫dos. Pelo que verifiquei esse c√≥digo que aparece √© referente ao error_id.

Interessantemente, consegui publicar tanto o coment√°rio quanto o post alguns longos minutos depois

>> Coment√°rio de samsepiol1:
A regra de neg√≥cio que faz essa verifica√ß√£o se encontra na pasta dos models em content.js

```if (userEarnings < 0) {
      throw new ForbiddenError({
        message: 'N√£o √© poss√≠vel publicar porque h√° outras publica√ß√µes mal avaliadas que ainda n√£o foram exclu√≠das.',
        action: 'Exclua seus conte√∫dos mais recentes que estiverem classificados como n√£o relevantes.',
        errorLocationCode: 'MODEL:CONTENT:CREDIT_OR_DEBIT_TABCOINS:NEGATIVE_USER_EARNINGS',
      });
    }
```

Mesmo que seja uma regra de neg√≥cio v√°lida, essa parte apenas faz a verifica√ß√£o do saldo do usu√°rio e retorna o erro_id, acredito que o ideal seria retornar qual publica√ß√£o foi negativa para que possa ser feito a sua retirada

>> Coment√°rio de aprendendofelipe:
No seu caso havia apenas um conte√∫do negativado e, se entendi direito, logo foi positivado, ent√£o n√£o foi necess√°rio apagar. √â isso?

Se a mensagem estivesse dizendo para apagar "certa publica√ß√£o", poderia ter feito voc√™ exclu√≠-la sem necessidade.

Imagina se algu√©m tem mais de um conte√∫do negativado, e outros positivados, de forma que com a exclus√£o de qualquer um deles o saldo j√° seria suficiente para poder criar novas publica√ß√µes. Se a gente listar os negativados, pode induzir a exclus√£o de todos, mas quem deveria decidir isso √© o pr√≥prio autor. 

A mensagem √© apenas para informar um autor de que ele deve revisar os seus conte√∫dos recentes. E dar mais uma oportunidade da pessoa procurar saber o que √© esperado das publica√ß√µes no TabNews, j√° que muitos ignoram o aviso que aparece antes da primeira publica√ß√£o.

N√£o acho que devemos listar as publica√ß√µes negativadas.

J√° a mensagem do erro sempre pode ser melhorada. Inclusive direcionar para o FAQ quando ele for implementado üëç

- #1380
</issue_1540_MODEL:CONTENT:CREDIT_OR_DEBIT_TABCOINS:NEGATIVE_USER_EARNINGS>

<issue_1544_Problema de login [Iphone]>
Eu uso iPhone 8 Plus IOS 16.7.2
E l√° n√£o existe op√ß√£o de login de conta algu√©m ajuda ?

>> Coment√°rio de aprendendofelipe:
Ol√° @BlocodeGold, deveria estar aparecendo o bot√£o "Entrar" no "Header".

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/de2c633a-e93c-47c3-8729-d41ac5be4dbd)

Voc√™ est√° usando a vers√£o oficial do TabNews? Consegue enviar um print da tela?

>> Coment√°rio de BlocodeGold:
Eu t√¥ no celular ;-; 
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/125971617/1d4ffa6b-3aca-4c56-8c78-3e3d80595cad)

>> Coment√°rio de aprendendofelipe:
Parece que voc√™ est√° usando algum aplicativo de terceiros, da√≠ teria que entrar em contato com o desenvolvedor dessa vers√£o.

Enquanto isso, recomendo usar a vers√£o oficial:

https://www.tabnews.com.br/

Vou fechar a issue por n√£o se tratar de algo que possamos resolver ü§ù

>> Coment√°rio de BlocodeGold:
U√© voc√™s n√£o tem aplicativo pra Mobile?

>> Coment√°rio de aprendendofelipe:
Mobile existem os Apps desenvolvidos pela comunidade e que usam a API oficial üëç
</issue_1544_Problema de login [Iphone]>

<issue_1547_[Sugest√£o/Feature] Seria interessante um Analytics>
Talvez seria interessante uma forma de monitorar publica√ß√µes no tabnews, com visualiza√ß√µes pelo  tempo, tabcoins ganhos e perdidos de uma publica√ß√£o. Assim, os autores do tabnews poderiam fazer um tracking de seus posts, e onde poderiam melhorar com eles.
Acredito que todas as informa√ß√µes necess√°rias para isso j√° s√£o salvas de alguma forma no db, s√≥ precisando fazer a implementa√ß√£o.

>> Coment√°rio de aprendendofelipe:
[**Edit**] Troquei a issue mencionada abaixo por uma com mais intera√ß√µes

@eletroswing, obrigado pela sugest√£o! üí™

Recomendo concentrarmos o debate na issue ~~#717~~ #1115 que trata do mesmo assunto. üëç

Vou fechar essa como duplicidade. ü§ù
</issue_1547_[Sugest√£o/Feature] Seria interessante um Analytics>

<issue_1550_[Sugest√£o / Feature] Favoritar publica√ß√µes>
Seria interessante se pud√©ssemos **favoritar publica√ß√µes** para voltar e consultar novamente, assim como dar uma star em um reposit√≥rio no GitHub.

Encontro conte√∫do muito relevantes para mim no TabNews que gostaria de guardar para ler novamente, e nesse caso, eu tenho que salvar o link no WhatsApp ou algo assim. Ent√£o, uma feature assim seria muito legal para o p√∫blico que consome os conte√∫dos.

>> Coment√°rio de kaique-soares:
Ol√° @patricks-js, obrigado pela sugest√£o :handshake: 

Acho que esta issue est√° duplicada com a #645, caso esteja, sugiro fechar esta issue aqui e concentrar as discuss√µes na #645 por organiza√ß√£o :+1:

>> Coment√°rio de aprendendofelipe:
Boa @patricks-js e @kaique-soares, vou fechar essa aqui como duplicada ü§ù
</issue_1550_[Sugest√£o / Feature] Favoritar publica√ß√µes>

<issue_1553_Invalidar ou dificultar tentativas de login m√∫ltiplas em um dispositivo com dados que n√£o conferem>
# Por qu√™
Do jeito que est√°, alguns scripts podem ser feitos a fim de quebrar a senha de um usuario por 'brute force', e, apesar da cloudflare oferecer uma √≥tima prote√ß√£o, isso acaba se tornando um problema em casos em que o atacante possui diversos ips e um conhecimento de que a infraestrutura passa pelo cloudflare

# A ideia
Implementar uma forma de captcha, ou de dificultar(ou at√© dar um timeout) em um ip que tente por multiplas vezes fazer login em uma mesma conta.

Poderia ser algo do tipo:
depois de 3 erros: ter que resolver um captcha pra tentar de novo
depois de 10 erros: o ip desse usuario tentando fazer login toma um timeout progressivo
ap√≥s ser reconhecido o ataque: o bloqueio desse ip que tentou fazer a invas√£o

>> Coment√°rio de Rafatcb:
J√° temos uma prote√ß√£o hoje: https://github.com/filipedeschamps/tabnews.com.br/pull/635

> * Caso um atacante esbarre no limite de requisi√ß√µes do `POST /api/v1/sessions`, ele n√£o ser√° avisado e de forma "invis√≠vel" ser√° retornado um erro comum e **falso** de `401 Unauthorized` e que nunca estar√° de fato batendo contra a real implementa√ß√£o de criar sess√µes. Inclusive, esse erro falso simula uma lat√™ncia falsa para o atacante n√£o perceber que foi pego caso ele analise e note uma mudan√ßa no padr√£o de velocidade das respostas. Eu fiquei estressando a implementa√ß√£o em produ√ß√£o e depois a implementa√ß√£o falsa at√© que as varia√ß√µes de lat√™ncia entre as duas ficasse igual e n√£o desse para perceber quando voc√™ parou de bater contra o endpoint de verdade e come√ßou a bater no endpoint de mentira.

N√£o sei se a configura√ß√£o de ambiente est√° diferente ou se a quantidade de requisi√ß√µes √© realmente 50, conforme o c√≥digo.

https://github.com/filipedeschamps/tabnews.com.br/blob/5e22ef16fc2a6e3518f3930aaca8787d22668abf/infra/rate-limit.js#L91-L94

Apesar disso, essa prote√ß√£o n√£o bloqueia o IP permanentemente (at√© onde averiguei).

E n√£o acho o CAPTCHA uma ideia √∫til para esse cen√°rio porque quem deseja "quebrar" o sistema pode usar a API ao inv√©s de utilizar o pr√≥prio site.

>> Coment√°rio de aprendendofelipe:
@eletroswing, obrigado pela sugest√£o! üí™

> Do jeito que est√°, alguns scripts podem ser feitos a fim de quebrar a senha de um usuario por 'brute force'

Essa afirma√ß√£o ser√° sempre verdadeira, independentemente do que fizermos. O que vai mudar √© a complexidade do ataque.

> apesar da cloudflare oferecer uma √≥tima prote√ß√£o, isso acaba se tornando um problema em casos em que o atacante possui diversos ips e um conhecimento de que a infraestrutura passa pelo cloudflare

Mas esse √© justamente um ponto em que a Cloudflare pode se sair melhor do que alguma prote√ß√£o desenvolvida por n√≥s e que tamb√©m ser√° de conhecimento p√∫blico, j√° que o c√≥digo do TabNews √© aberto.

Sobre a sua ideia, talvez esteja faltando detalhes. Eu acredito que ela s√≥ adicionaria prote√ß√£o se for baseada no usu√°rio, mas n√£o no IP (acho melhor deixar a parte do IP para a Cloudflare).

Ent√£o se houverem muitas tentativas de login para um mesmo usu√°rio, podemos aplicar algum bloqueio tempor√°rio para a conta espec√≠fica, independentemente do IP. √â isso?

----

> J√° temos uma prote√ß√£o hoje: #635

Isso @Rafatcb, j√° h√° prote√ß√£o no c√≥digo, mas na pr√°tica ela n√£o est√° sendo necess√°ria, pois a Cloudflare nos defende absurdamente melhor.

> N√£o sei se a configura√ß√£o de ambiente est√° diferente

√â diferente do que est√° no c√≥digo. O que manda √© o definido nas vari√°veis de ambiente.

> Apesar disso, essa prote√ß√£o n√£o bloqueia o IP permanentemente (at√© onde averiguei).

Isso mesmo. S√≥ fazemos bloqueio permanente pela Cloudflare.

> E n√£o acho o CAPTCHA uma ideia √∫til para esse cen√°rio porque quem deseja "quebrar" o sistema pode usar a API ao inv√©s de utilizar o pr√≥prio site.

Da forma como foi proposto realmente n√£o ajudaria. Mas o desafio da Cloudflare sim protege inclusive a API.

>> Coment√°rio de Rafatcb:
Acabei de ver um issue espec√≠fico sobre CAPTCHA no Login e Cadastro. Como l√° teve discuss√£o tamb√©m, vou linkar aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1170.

>> Coment√°rio de aprendendofelipe:
√â verdade @Rafatcb! üëç

@eletroswing, como ambas lidam com o mesmo problema, vamos manter o debate na #1170 ü§ù
</issue_1553_Invalidar ou dificultar tentativas de login m√∫ltiplas em um dispositivo com dados que n√£o conferem>

<issue_1556_[Sugest√£o] Mudan√ßa de comportamento de links para outros sites>
Faz algum tempo que clico em algum link de um post, esperan√ßoso que vai abrir em uma nova guia, e acaba substituindo a guia atual, **"quebrando a leitura"** do post que eu estava gostando.

J√° escutei em algum lugar que ao utilizar √¢ncoras que direcionam para **outro site/dom√≠nio**, devemos fazer com que abra uma **nova guia**, ao inv√©s de substituir a guia atual. Creio que seja uma boa pr√°tica na Web ou algo do tipo.

Portanto, creio que seria uma boa _feature_ para tornar esse nosso ambiente **mais agrad√°vel** de se utilizar.

**P.S.:** Adoraria contribuir diretamente com esse desenvolvimento, mas confesso que n√£o sei por onde come√ßar. J√° clonei o repo e estou desbravando alguma forma de editar o comportamento dos **Links (components)**, adicionando um _target:"_blank"_ para come√ßar, mas ainda n√£o t√¥ conseguindo bons resultados. Se algu√©m j√° tiver alguma ideia e, quem sabe, at√© me propor alguma a√ß√£o, estou atenciosamente disposto a trabalhar nisso. üòÉ

>> Coment√°rio de kaique-soares:
@santosesantos muito obrigado pela sugest√£o!

Algumas outras issues foram abertas no passado tratando desse assunto mas eu diria que a issue #477 tem um detalhe  especial, esse [coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/477#issuecomment-1182110074) do @filipedeschamps que traz uma reflex√£o bem interessante.

:bulb: Uma dica: Podemos utilizar o combo `Ctrl + Click` para abrir um link em nova aba do navegador.

Recomendo fechar esta issue aqui por ser duplicada e centralizar as discuss√µes na #447  :handshake:

>> Coment√°rio de santosesantos:
Putsz, ainda tentei procurar se j√° tinha alguma carakkkkk.

Blz, muito obrigado. Vou comentar algo l√° em breve.
</issue_1556_[Sugest√£o] Mudan√ßa de comportamento de links para outros sites>

<issue_1557_Exibir TabCoins e TabCash no perfil do usu√°rio>
Hoje j√° √© poss√≠vel verificar as TabCoins e TabCash de um usu√°rio por meio da [API](https://www.tabnews.com.br/api/v1/users/rafael), mesmo sem estar logado, ent√£o n√£o √© uma informa√ß√£o confidencial. Tendo isso em vista, sugiro exibir tamb√©m no perfil do usu√°rio.

Um ponto negativo √© que √© um dado a mais para buscar nessa p√°gina, mas eu j√° dei uma olhada no c√≥digo e, apesar disso n√£o ser buscado ao montar a p√°gina, quando ela √© focada e ocorre o `fetch` para atualizar as informa√ß√µes, h√° uma chamada para o endpoint `/users` onde os `tabcoins` e `tabcash` est√£o presentes. Ent√£o, n√£o acho que seja um ponto negativo relevante.

Como ponto positivo, eu acho interessante ver o quanto algu√©m j√° colaborou no TabNews por meio desses dois indicadores extras, assim como acontece em outros sites (Karma no Reddit e no Hacker News, e Reputa√ß√£o no Stack Overflow).

Me proponho a realizar a implementa√ß√£o, caso achem a sugest√£o v√°lida.

>> Coment√°rio de aprendendofelipe:
Eu acho uma boa! Al√©m de serem indicadores interessantes para qualquer usu√°rio, isso tamb√©m facilita para a modera√ß√£o.

Para ter os saldos dispon√≠veis no primeiro carregamento da p√°gina, sem precisar da API, basta passar o objeto `{ withBalance: true }` como segundo par√¢metro na fun√ß√£o `findOneByUsername` em 

https://github.com/filipedeschamps/tabnews.com.br/blob/84a0936bc242ee5a72b05065005376c653d0e14c/pages/%5Busername%5D/index.public.js#L221

Outras melhorias que acho interessante fazer nessa p√°gina, mas n√£o necessariamente no mesmo PR, s√£o:

- Mostrar a data ou tempo decorrido desde a cria√ß√£o do usu√°rio (acho que o componente `PublishedSince` serve perfeitamente se importar ele usando um nome mais apropriado);
- Adicionar a op√ß√£o "Editar Perfil" no mesmo menu que tem o bot√£o de nuke, mas nesse caso aparecendo apenas para quando a p√°gina visitada √© o pr√≥prio perfil;
- Por fim, complementando o ponto anterior, adicionar a op√ß√£o de moderar a descri√ß√£o do perfil. Esse √∫ltimo ponto com certeza n√£o caberia no mesmo PR.

>> Coment√°rio de filipedeschamps:
Show!!! 100% a favor de mostrar estes dados no perfil @Rafatcb  ü§ù 

> Mostrar a data ou tempo decorrido desde a cria√ß√£o do usu√°rio

@aprendendofelipe tamb√©m sou 100% a favor disso, inclusive o Hacker News destaca em verde o nome do usu√°rio quando ele acabou de criar a conta (n√£o sei qual a data de corte para deixar de ficar verde). Isso √© um outro √≥timo sinal para modera√ß√£o onde vai ficar bem evidente quando houver um ataque de contas novas inflando uma discuss√£o dentro de uma publica√ß√£o.

>> Coment√°rio de Rafatcb:
Como o PR #1558 j√° est√° em produ√ß√£o, estou fechando esse issue. Apesar de contas novas n√£o estarem destacadas como no Hacker News, √© poss√≠vel identific√°-las visitando o perfil e vendo a data de cria√ß√£o. Um novo issue pode ser criado para implementar a funcionalidade de destacar as contas novas.

Como dito no PR, a parte de modera√ß√£o do perfil n√£o foi implementada e est√° sugerida no issue #1466.
</issue_1557_Exibir TabCoins e TabCash no perfil do usu√°rio>

<issue_1561_[ Sugest√£o / Feature ] Poder salvar conte√∫dos que achou relevante no perfil>
### Como

MInha ideia √© basicamente ter uma forma de podermos salvar posts que achamos interessante, seja ela com uma op√ß√£o de salvar em um vetor (bookmark), ou apenas um vetor com todos os post que marquei como relevante desde que minha conta foi criada (embora isso exclua usu√°rios que ainda n√£o tenham TabCoins, mas tamb√©m estou ciente da cultura do TabNews).

### Por qu√™?

O TabNews √© um lugar que se encontra muitos posts valiosos, e gostaria de poder voltar a eles sempre que poss√≠vel, e a √∫nica forma de fazer isso atualmente, at√© onde eu saiba, √© salvando o link em algum lugar externo, o que n√£o √© o fim do mundo, mas imagino que seria uma boa funcionalidade para se ter no site.

>> Coment√°rio de aprendendofelipe:
@ethamorim, obrigado pela sugest√£o! üí™

Sugiro centralizar essa discuss√£o na issue #645 üëç

Vou fechar essa aqui como duplicada. ü§ù
</issue_1561_[ Sugest√£o / Feature ] Poder salvar conte√∫dos que achou relevante no perfil>

<issue_1564_[Sugest√£o / Feature] Adicionar nuvem de tags>
## Contexto

Acredito que a inclus√£o de tags nas postagens seria uma adi√ß√£o valiosa para o nosso site. As tags podem ajudar a categorizar e relacionar postagens por temas, como css, wordpress, elementor, javascript, react, react-router, entre outros.

## Funcionamento

Ao criar uma nova postagem, o autor poder√° escolher at√© 3 tags que sejam relevantes para o conte√∫do da postagem. Posteriormente, os visitantes poder√£o sugerir at√© +3 tags. As tags que receberem mais votos ficar√£o vis√≠veis para os usu√°rios.

Com base nas tags mais sugeridas, poder√≠amos implementar uma se√ß√£o de ‚Äúpostagens relacionadas‚Äù no final de cada postagem. Isso permitiria aos usu√°rios navegar de um conte√∫do relacionado para outro sem precisar voltar para a p√°gina inicial.

## Execu√ß√£o:

- [ ] **Desenvolvimento da funcionalidade de tags:** Permitir que os autores adicionem at√© 3 tags ao criar uma postagem.
- [ ] **Sugest√µes de tags pelos visitantes:** Implementar uma funcionalidade que permita aos visitantes sugerir at√© +3 tags para cada postagem.
- [ ] **Implementa√ß√£o de vota√ß√£o de tags:** Desenvolver um sistema de vota√ß√£o para as tags sugeridas.
- [ ] **Se√ß√£o de postagens relacionadas:** Com base nas tags mais votadas, criar uma se√ß√£o de ‚Äúpostagens relacionadas‚Äù no final de cada postagem.

>> Coment√°rio de Rafatcb:
Emerson, tags s√£o uma excelente sugest√£o, e achei muito bom voc√™ ter trazido uma sugest√£o de implementa√ß√£o detalhada assim. N√£o me lembro de ter visto uma sugest√£o de escolha de tags por meio de votos.

Acredito que podemos separar sua sugest√£o em duas partes: tags e publica√ß√µes relacionadas. J√° existem issues sobre esses pontos, inclusive com alguma discuss√£o em andamento:

* https://github.com/filipedeschamps/tabnews.com.br/issues/742
* https://github.com/filipedeschamps/tabnews.com.br/issues/1478

O que voc√™ acha de comentar a parte relevante da sugest√£o nos issues relacionados e fechar este aqui?

>> Coment√°rio de emerson-oliveira:
Feito! Obrigado pela sugest√£o.
</issue_1564_[Sugest√£o / Feature] Adicionar nuvem de tags>

<issue_1567_[Melhoria] Implementar Clarity para Otimiza√ß√£o da Experi√™ncia do Usu√°rio>
## Descri√ß√£o
Com a nova milestone, acredito que seria interessante coletar v√°rios dados sobre a experi√™ncia dos usu√°rios. O monitoramento dessas informa√ß√µes poderia ser extremamente √∫til para futuras melhorias no layout e na corre√ß√£o de bugs que n√£o foram reportados pelos usu√°rios.

## Proposta
Minha sugest√£o √© adicionar o Clarity, uma ferramenta poderosa para entender como os usu√°rios interagem com o site. Com ela podemos coletar dados importantes, como cliques do mouse, rolagem de p√°gina, intera√ß√µes com formul√°rios e muito mais.

## Benef√≠cios
Ao implementar o Clarity, poderemos:
1. Identificar problemas de usabilidade que n√£o foram reportados pelos usu√°rios.
2. Entender melhor como os usu√°rios interagem com nosso site.
3. Usar os dados coletados para informar nossas decis√µes de design e desenvolvimento.

>> Coment√°rio de aprendendofelipe:
Fala @emerson-oliveira, obrigado pela sugest√£o! üí™

Esse tipo de rastreamento vai ser evitado o m√°ximo poss√≠vel no TabNews.

Um dos pontos √© an√°logo ao que o @filipedeschamps falou na issue sobre Estat√≠sticas do Site (https://github.com/filipedeschamps/tabnews.com.br/issues/237#issuecomment-1084948854):

> E sobre o Google Analytics e sistemas parecidos, sugiro que a nossa postura seja banir esse tipo de solu√ß√£o por privacidade ao usu√°rio üëç ent√£o ou a gente auto-hospeda algo open source, ou a gente faz o nosso de uma forma bem simples e direcionada ü§ù

E mesmo algo auto hospedado, acredito que nunca seriam coletados certos tipos de dados, pois eles precisam ficar p√∫blicos para que sejam analisados pela comunidade, que √© quem prioritariamente dita a evolu√ß√£o do TabNews.

Vou encerrar a issue, mas qualquer coisa podemos reabrir ü§ù
</issue_1567_[Melhoria] Implementar Clarity para Otimiza√ß√£o da Experi√™ncia do Usu√°rio>

<issue_1568_Favoritar post>
Implementar favoritar posts como no mobile, e interligar ambas as plataformas em um lista de favoritos, gosto Bastante da op√ß√£o de favoritar no mobile, seria interessante de re-ler ao rever algumas publica√ß√£o do tab news posteriormente.
Obrigado

>> Coment√°rio de Rafatcb:
√â uma boa sugest√£o. Existe uma discuss√£o com sugest√µes de implementa√ß√£o aqui:

* https://github.com/filipedeschamps/tabnews.com.br/issues/645

Acho melhor fechar este issue e concentrar a discuss√£o l√°.

>> Coment√°rio de aprendendofelipe:
Turma, obrigado pelas contribui√ß√µes! üí™

Vou fechar diversas issues com assuntos relacionados. Por isso estou listando abaixo as que ser√£o mantidas abertas e onde recomendo concentrarmos o que foi debatido/sugerido aqui:

- #645 
- #738
- #742 

Fechando essa aqui ü§ù
</issue_1568_Favoritar post>

<issue_1569_[Duvida] Quem pode adicionar labels √†s issues?>
### Descri√ß√£o

Notei que muitas issues em nosso reposit√≥rio n√£o est√£o utilizando labels. Acredito que a utiliza√ß√£o de labels poderia melhorar a organiza√ß√£o e a efici√™ncia de nosso trabalho. Estou interessado em contribuir mais ativamente para o projeto, revisando as issues e adicionando labels apropriadas.

No entanto, n√£o estou certo sobre o processo para adicionar labels √†s issues. √â uma permiss√£o exclusiva dos mantenedores do reposit√≥rio? Se n√£o, poderiam me orientar sobre como posso adicionar labels √†s issues?

>> Coment√°rio de aprendendofelipe:
Como hoje o reposit√≥rio do TabNews √© pessoal, n√£o √© poss√≠vel adicionar membros com acesso exclusivo para triagem, ent√£o apenas quem tem acesso de escrita no reposit√≥rio consegue gerenciar as etiquetas.

Para quem tem acesso, o processo √© explicado na documenta√ß√£o:

[Gerenciar etiquetas](https://docs.github.com/pt/issues/using-labels-and-milestones-to-track-work/managing-labels)

>> Coment√°rio de Rafatcb:
Emerson, obrigado pela sugest√£o!

Para n√£o deixar esse issue sem explica√ß√£o, aqui vai um resumo do que foi feito:

Dei uma organizada nos issues colocando labels. Alguns eu n√£o soube qual colocar (por exemplo, se era algo espec√≠fico de `back`, `front` ou ambos), ent√£o deixei sem. Al√©m disso, adicionei descri√ß√£o √† maior parte dos labels.

Aproveitei para criar os labels:

* [desempenho](https://github.com/filipedeschamps/tabnews.com.br/labels/desempenho)
* [seguran√ßa](https://github.com/filipedeschamps/tabnews.com.br/labels/seguran%C3%A7a)
* [SEO](https://github.com/filipedeschamps/tabnews.com.br/labels/SEO)
* [testes](https://github.com/filipedeschamps/tabnews.com.br/labels/testes)

Tamb√©m aproveitei para traduzi-los para portugu√™s, j√° que tudo no reposit√≥rio √© em portugu√™s, com exce√ß√£o do c√≥digo. Deixei alguns termos que s√£o mais usados em ingl√™s do que em portugu√™s (`back`, `front` e `bug`) e anglicismos como `mergear`  ("mergear" me parece mais usado do que "mesclar"). Tamb√©m deixei o `good first issue` porque parece algo padr√£o usado pelo algoritmo do GitHub, conforme dito na [documenta√ß√£o](https://docs.github.com/pt/communities/setting-up-your-project-for-healthy-contributions/encouraging-helpful-contributions-to-your-project-with-labels).

Coloquei label de `pendente` em alguns PRs. Ainda n√£o terminei de avaliar todos.

>> Coment√°rio de emerson-oliveira:
Sensacional! Muito Obrigado..
</issue_1569_[Duvida] Quem pode adicionar labels √†s issues?>

<issue_1575_[Sugest√£o/Melhoria] Implementa√ß√£o de um Guia de Introdu√ß√£o para Novos Membros>
Descri√ß√£o:

Contexto: Ao fazer login na plataforma pela primeira vez, os novos membros podem se sentir perdidos devido √† falta de orienta√ß√£o. Isso pode levar a uma experi√™ncia de usu√°rio menos satisfat√≥ria e potencialmente a uma taxa de reten√ß√£o mais baixa.

Proposta: Implementar um guia de introdu√ß√£o interativo que orienta os novos membros atrav√©s dos primeiros passos na plataforma. Este guia deve aparecer automaticamente ap√≥s o primeiro login do usu√°rio.

Detalhes:

- O guia deve ser apresentado na forma de caixas informativas que aparecem em pontos estrat√©gicos da interface do usu√°rio, semelhante aos tutoriais encontrados em muitos jogos.

- Cada caixa informativa deve descrever brevemente a funcionalidade ou recurso correspondente da plataforma.

- Os usu√°rios devem ter a op√ß√£o de pular o guia de introdu√ß√£o a qualquer momento.

- O guia deve ser intuitivo e f√°cil de seguir, mesmo para usu√°rios com pouca experi√™ncia tecnol√≥gica.

Objetivo: Melhorar a experi√™ncia do usu√°rio para novos membros, fornecendo orienta√ß√£o clara e √∫til desde o in√≠cio. Isso pode levar a uma maior reten√ß√£o de usu√°rios e a uma maior satisfa√ß√£o geral do usu√°rio.

>> Coment√°rio de Rafatcb:
Essa √© uma funcionalidade muito √∫til, obrigado pela sugest√£o!

Sei que existem bibliotecas para isso, mas nunca usei nenhuma. Algu√©m tem experi√™ncia com isso e quer recomendar algo? Acho que o Primer n√£o tem nada relacionado, dei uma olhada de leve. O ideal √© podermos usar os componentes do [Primer](https://primer.style/) para manter nossa identidade visual, mas ter a facilidade de n√£o precisar implementar tudo. Apesar disso, nada impede tamb√©m de algu√©m implementar sem biblioteca, se enxergar uma maneira f√°cil/simples.

Edit: Se for usar uma biblioteca, temos que verificar a acessibilidade dela.

>> Coment√°rio de Rafatcb:
Me deparei com o guia [Feature onboarding](https://primer.style/ui-patterns/feature-onboarding) na documenta√ß√£o do Primer. Ele √© sobre o an√∫ncio de novas funcionalidades, mas podemos levar em considera√ß√£o algumas orienta√ß√µes, por exemplo a parte sobre [Teaching Bubble](https://primer.style/ui-patterns/feature-onboarding#teaching-bubble).

>> Coment√°rio de eng-gabrielscardoso:
@Rafatcb @pedromclaro h√° a lib https://driverjs.com/ para cria√ß√£o de tutoriais interativos de maneira contextual, mais ou menos como o @Elias-Junior sugeriu

>> Coment√°rio de FMorschel:
Como falei na issue #1650:

> Sugiro fazer um post talvez com um passo a passo explicando o que precisa acontecer para receber TabCoins/TabCash e vincular esse post com um clique nos √≠cones de TabCoin/TabCash.

Aqui uma issue que detalha as informa√ß√µes sobre os TabCoins e TabCash #1381

Edit:

Isso tamb√©m deveria ser explicado: 
https://www.tabnews.com.br/FelipeBarso/tabnews-agora-com-recompensas-diarias-em-tabcoins

>> Coment√°rio de Rafatcb:
Acho que uma explica√ß√£o curta e geral, apontando para o FAQ para mais detalhes ([_Como ganhar TabCoins?_](https://www.tabnews.com.br/faq#ganhar-tabcoins) e [_√â poss√≠vel perder TabCoins?_](https://www.tabnews.com.br/faq#perder-tabcoins)) j√° seria o suficiente. N√£o queremos explicar com detalhes porque, al√©m de ser algo complicado e mut√°vel, o objetivo n√£o √© que a pessoa busque "a melhor forma de ganhar pontos", e sim que entenda a ideia geral de "qu√£o melhor forem seus conte√∫dos, mais TabCoins voc√™ receber√°".

Na verdade, imagino que o_onboarding_ ensinar√° o b√°sico para a pessoa entender o TabNews, e no fim pode dizer algo como _"Para entender melhor como algo espec√≠fico funciona, visite o FAQ, porque provavelmente sua d√∫vida foi respondida l√°"_.
</issue_1575_[Sugest√£o/Melhoria] Implementa√ß√£o de um Guia de Introdu√ß√£o para Novos Membros>

<issue_1576_Disponibilizar os views que cada usu√°rio teve>
### Descri√ß√£o

Vou dar o meu cen√°rio e porque eu preciso muito disto e n√£o √© s√≥ uma sugest√£o geral. Obviamente n√£o posso exigir nada, s√≥ vou colocar minha necessidade.

Como [sou Microsoft MVP](https://mvp.microsoft.com/pt-BR/MVP/profile/4533f67e-acc5-e611-80f9-3863bb34cb20), preciso reportar anualmente tudo o que fiz. Um dos dados que preciso inserir e cada plataforma, √© a quantidade de visualiza√ß√£o que eu tive. N√£o √© necess√°rio um dado preciso, mas pelo menos deve ser aproximado.

Ent√£o pode ser at√© as *views* da p√°gina e n√£o do que eu postei que pode ser um pouco menor por ter sido postado depois.

Eu preciso saber todas as minhas *views* dos √∫ltimos 12 meses. Isso pode ser dado de diversas formas e eu at√© precisar fazer contas, mas preciso de algum dado. Se der o total j√° funciona para este ano j√° que eu n√£o tenho acesso anterior, mas complica depois. N√£o preciso das *views* individuais de cada postagem, mas √© algo interessante tamb√©m.

Outras informa√ß√µes necess√°rias eu consigo de uma forma ou de outra, ainda que algumas v√£o dar trabalho na forma atual. Seria i9nteressantepelo menos para daqui um ano ter uma forma de ver todos os Tabcoins ganhos em cada ano/m√™s/semana ou algo assim. Uma separa√ß√£o do que √© postagem e o que √© coment√°rio. ter uma contagem das postagens. Tudo isso facilitaria, mas sem n√£o √© invi√°vel pra mim.

Mesmo que n√£o possam fazer isso para a plataforma j√°, se for poss√≠vel queriam que me fornecessem esse n√∫mero excepcionalmente ou me falassem como pegar isso.

Preciso entregar em mar√ßo. Se n√£o der para cumprir isso, paci√™ncia, mas seria bom para a Microsoft tomar ci√™ncia oficial do Tabnews, j√° que sou o √∫nico a usar.

Acho uma boa para todos, n√£o estou fazendo um pedido que s√≥ serve para mim, mas estou informando do tamanho da import√¢ncia disso para o meu caso. Se n√£o der para fazer perfeito at√© mar√ßo, podem melhorar depois. Se n√£o der nada, agrade√ßo de qualquer forma todo o esfor√ßo para por a plataforma no ar como est√°, ajuda muita gente.

Voc√™s definem a melhor forma, mas posso ajudar.

Obrigado e estou √† disposi√ß√£o se precisarem de informa√ß√£o adicional.

Bom final de ano a todos.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Fala @maniero, o principal que voc√™ precisa j√° est√° aguardando contribui√ß√µes para ser implementado.

> Ent√£o pode ser at√© as views da p√°gina e n√£o do que eu postei que pode ser um pouco menor por ter sido postado depois.

N√≥s ainda n√£o temos essa informa√ß√£o de maneira simples. O assunto √© tratado em:

- #1115

Resumindo... Por enquanto n√≥s s√≥ temos esses dados pelo Analytics da Vercel, onde conseguimos consultar as top visualiza√ß√µes das p√°ginas (com dados limitados aos √∫ltimos 12 meses), mas √© algo manual, pela interface visual do site, j√° que eles n√£o disponibilizam isso de forma oficial via API, e o site n√£o d√° muitas op√ß√µes al√©m de escolher o per√≠odo (√∫ltimas 24 horas, 7 dias, 30 dias, 3 meses ou 12 meses) e realizar alguns filtros nos resultados. O triste √© que os filtros s√£o aplicados no resultado j√° dispon√≠vel, n√£o busca novos dados. E os resultados s√£o limitados pelos top 250. N√£o tem pagina√ß√£o para buscar os pr√≥ximos 250 e ir pegando tudo.

A parte mais simples √© criar consulta(s) no nosso banco de dados para montar a URL de todos os seus conte√∫dos, e das publica√ß√µes de outras pessoas que voc√™ comentou, e computar tudo mais que voc√™ precisar (saldos de TabCoins, por exemplo). Ser√° √≥timo se voc√™, ou quem puder, contribuir com isso. üí™

Mas n√£o adiantaria ir na ferramenta da Vercel tentar filtrar pela URL de cada uma dessas p√°ginas obtidas na consulta citada acima, pois s√≥ algumas retornariam. Por exemplo, filtrando por "maniero", s√≥ aparece a sua p√°gina por ela estar dentro das 250 mais visitadas, mas n√£o aparece qualquer publica√ß√£o sua, mesmo sabendo que existem ([lista de publica√ß√µes root do maniero](https://www.tabnews.com.br/api/v1/contents/maniero?with_children=false)):

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/67cd25f7-3ac7-4250-9937-eeffad125e0b)

O que daria pra fazer √© criar um script para fazer algo como sugerido em https://github.com/orgs/vercel/discussions/1068#discussioncomment-7403107, onde poderia tentar passar uma lista de paths como filtro (limitado a 250), ou, se n√£o aceitar lista, ir passando um path de cada vez, tomando cuidado para n√£o cair em algum *rate limit*. A ajuda na investiga√ß√£o sobre isso tamb√©m seria uma excelente contribui√ß√£o. üí™

> N√£o preciso das views individuais de cada postagem, mas √© algo interessante tamb√©m.

N√£o entendi bem se aqui voc√™ quer dizer que os dados que temos no nosso banco de dados j√° bastam (nesse caso √© s√≥ criar a query do que precisa). Ou se diz que n√£o precisa das visualiza√ß√µes da URL √∫nica de cada coment√°rio. Imagino que somar essas visualiza√ß√µes n√£o mude significativamente seus n√∫meros, mas para obt√™-las n√£o muda muito o trabalho, pois basta adequar a query, adicionar os paths delas no script de raspagem da Vercel e depois somar as visualiza√ß√µes, se for o caso.


> Seria interessante pelo menos para daqui um ano ter uma forma de ver todos os Tabcoins ganhos em cada ano/m√™s/semana ou algo assim.

- #1341

> Uma separa√ß√£o do que √© postagem e o que √© coment√°rio.

Pela API voc√™ j√° pode filtrar:

https://www.tabnews.com.br/api/v1/contents/maniero?with_children=false
https://www.tabnews.com.br/api/v1/contents/maniero?with_root=false

E pelo site deve ser poss√≠vel em breve com o 

- #1577

> ter uma contagem das postagens.

Acho que n√£o existe issue aberta sobre isso, mas j√° vou sugerir ao @ErickCReis acrescentar isso no PR #1577, pois inclusive esse dado j√° √© dispon√≠vel no *client*, mas n√£o √© mostrado em nenhum lugar.

Se inspecionar a sua p√°gina (https://www.tabnews.com.br/maniero) ver√° que possui 1.347 conte√∫dos publicados üöÄ

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/d95bd2d4-ba3d-4ee4-a786-bf551c72b69c)

> Mesmo que n√£o possam fazer isso para a plataforma j√°, se for poss√≠vel queriam que me fornecessem esse n√∫mero excepcionalmente ou me falassem como pegar isso.
> 
> Preciso entregar em mar√ßo. Se n√£o der para cumprir isso, paci√™ncia, mas seria bom para a Microsoft tomar ci√™ncia oficial do Tabnews, j√° que sou o √∫nico a usar.

Como voc√™ se cadastrou em 30 de janeiro de 2023, pela nossa restri√ß√£o na Vercel, tem at√© 29/01/24 para rodar esse script sem perder parte dos dados que voc√™ precisa.

√â quase certo que a implementa√ß√£o de tudo n√£o vai sair antes desse prazo, mas √© totalmente poss√≠vel a gente rodar as consultas no banco e rodar o script na Vercel, se a turma ajudar com a cria√ß√£o deles. üí™

> Acho uma boa para todos, n√£o estou fazendo um pedido que s√≥ serve para mim, mas estou informando do tamanho da import√¢ncia disso para o meu caso. Se n√£o der para fazer perfeito at√© mar√ßo, podem melhorar depois.

Concordo totalmente! ü§ù

> Voc√™s definem a melhor forma, mas posso ajudar.

O primeiro √© listar exatamente o que voc√™ precisa, dentro do que temos dispon√≠vel no banco de dados, para ent√£o montar a(s) consulta(s).

O segundo passo √© fazer uns testes dessa sugest√£o https://github.com/orgs/vercel/discussions/1068#discussioncomment-7403107 para ver a melhor forma de raspar os dados das visualiza√ß√µes. Essa parte eu posso fazer alguns testes, mas acho que s√≥ vou conseguir no in√≠cio de janeiro, ent√£o qualquer um que testar antes e puder trazer informa√ß√µes, j√° ajuda. üëç

Obrigado pela issue! üí™

>> Coment√°rio de maniero:
Obrigado pela descri√ß√£o detalhada, com *links* (j√° tinha visto alguns).

De fato, n√£o posso fazer nada que envolva essas tecnologias que eu n√£o conhe√ßo.

N√£o sei se consigo definir o problema al√©m do que eu disse, fora que pode n√£o ter ficado claro e falarei abaixo.

Meu problema principal √©: preciso de todas as *views* aproximadas que minhas postagens tiveram (diretamente por ela ou pendurada em outra, coment√°rio ou raiz. Pode ser s√≥ a soma de todas elas nos √∫ltimos 12 meses de abril/23 √† mar√ßo/24. Pode ser de qualquer forma, mesmo que n√£o apare√ßa no site (aparecendo melhor para odo e facilita auditoria. Se tiver que fazer malabarismo (fazer v√°rias coisas manuais), que seja, nunca √© ideal, mas √© suficiente. Todo o resto √© adicional ou j√° tem alguma forma.

Alguns *links* foram √∫teis, embora n√£o ajudem nesta necessidade espec√≠fica.

Esta imagem que colocou com meus *views* totais √© algo real? Posso considerar que foi isso que tive? Pode servir de base se ficar s√≥ na estimativa. Na pior das hip√≥teses, se eu der um n√∫mero estimado, n√£o tem o mesmo valor, mas j√° consigo indicar algo.

Eu consigo acessar a API da Vercel para pegar os dados do Tabnews, conforme discuss√£o do Github deles que mandou acima? Ficou a d√∫vida de como eu poderia fazer isto: https://github.com/orgs/vercel/discussions/1068#discussioncomment-7403107, at√© por eu ter zero conhecimento da plataforma.

Como eu s√≥ preciso mesmo para entregar para a Microsoft as *views* totais do per√≠odo, n√£o preciso saber quantas deram em cada uma delas. S√≥ disse que isso √© bom para todos saberem se conseguiu atingir as pessoas, nada relacionado com minha necessidade espec√≠fica.

Pelo que entendi as informa√ß√µes adicionais que falei, menos importantes, s√£o mais f√°ceis que as visualiza√ß√µes.

Resumindo, se eu puder obter as *views* diretas ou indiretas (contidas em um coment√°rio acima, at√© a raiz) das minhas postagens nos √∫ltimos 12 meses (s√≥ precisa do total), j√° resolve o problema principal.

Obrigado por tudo.

>> Coment√°rio de aprendendofelipe:
> preciso de todas as _views_ aproximadas que minhas postagens tiveram (diretamente por ela ou pendurada em outra, coment√°rio ou raiz. Pode ser s√≥ a soma de todas elas nos √∫ltimos 12 meses de abril/23 √† mar√ßo/24.

Se s√≥ precisa dos dados a partir de abril, ent√£o tem um prazo maior para criar o script com menor risco de perder informa√ß√µes.

> Pode ser de qualquer forma, mesmo que n√£o apare√ßa no site (aparecendo melhor para odo e facilita auditoria. Se tiver que fazer malabarismo (fazer v√°rias coisas manuais), que seja, nunca √© ideal, mas √© suficiente. Todo o resto √© adicional ou j√° tem alguma forma.

Adiantaria para a auditoria se eu criar uma publica√ß√£o no TabNews apresentando os dados que voc√™ precisa, ou at√© passar por aqui mesmo, de forma p√∫blica?

Como a Vercel n√£o disponibiliza API para isso, infelizmente n√£o tem como fornecer esses n√∫meros atualizados em tempo real.

Provavelmente teremos que implementar algo pr√≥prio para atender a issue #1115, mas isso √© melhor ser debatido por l√°. 

> Esta imagem que colocou com meus _views_ totais √© algo real? Posso considerar que foi isso que tive? 

S√£o n√∫mero reais dos √∫ltimos 12 meses, mas **n√£o inclui suas publica√ß√µes e coment√°rios**. S√£o apenas da p√°gina do **seu perfil**:

https://www.tabnews.com.br/maniero

> Eu consigo acessar a API da Vercel para pegar os dados do Tabnews, conforme discuss√£o do Github deles que mandou acima?

N√£o consegue. üòï

Esse endpoint √© usado pela Vercel para apresentar os dados na p√°gina do Analytics. S√≥ funciona estando autenticado, e usando uma conta que tenha acesso aos dados.

Os testes que eu sugeri envolvem ter acesso a algo hospedado na Vercel e com Analytics habilitado, mesmo que seja s√≥ um laborat√≥rio com uma conta hobby.

> Ficou a d√∫vida de como eu poderia fazer isto: https://github.com/orgs/vercel/discussions/1068#discussioncomment-7403107, at√© por eu ter zero conhecimento da plataforma.

Eu recomendo experimentar hospedar um projeto na Vercel (pode ser um dos [exemplos do Next.js](https://github.com/vercel/next.js/tree/canary/examples)), se tiver interesse, pois √© algo com zero atrito, principalmente para algu√©m com sua experi√™ncia.

> Como eu s√≥ preciso mesmo para entregar para a Microsoft as _views_ totais do per√≠odo, n√£o preciso saber quantas deram em cada uma delas. S√≥ disse que isso √© bom para todos saberem se conseguiu atingir as pessoas, nada relacionado com minha necessidade espec√≠fica.

Se quer s√≥ um n√∫mero consolidado, ou se quer uma planilha detalhada, voc√™ decide. Ou deixa a decis√£o para quem for contribuir com a o c√≥digo que precisa ser criado para raspar os dados.

Para a funcionalidade definitiva, se a Vercel n√£o disponibilizar a API formalmente, √© como falei acima, a Turma vai precisar criar primeiro uma forma de armazenar esses dados onde possamos acessar do nosso backend.

> Pelo que entendi as informa√ß√µes adicionais que falei, menos importantes, s√£o mais f√°ceis que as visualiza√ß√µes.

Isso mesmo, os dados que est√£o no nosso banco (Postgres) s√£o mais f√°ceis de apresentarmos em tempo real.

> Resumindo, se eu puder obter as _views_ diretas ou indiretas (contidas em um coment√°rio acima, at√© a raiz) das minhas postagens nos √∫ltimos 12 meses (s√≥ precisa do total), j√° resolve o problema principal.

O que acha de somar apenas as visualiza√ß√µes das publica√ß√µes root? Caso contr√°rio estar√° inflando artificialmente os n√∫meros, j√° que deve ser muito raro algu√©m visualizar apenas um coment√°rio sem visualizar a p√°gina da publica√ß√£o raiz. E quando isso acontece, talvez seja um caso que nem deveria ser contabilizado mesmo.

Mas isso muda bem pouco a query do Postgres e, no mais, ser√° s√≥ uma lista maior ou menor para o script que vai buscar os dados via REST, ent√£o veja o que acha melhor.  Ou, de novo, deixe a decis√£o para quem for contribuir com isso. üëç

>> Coment√°rio de maniero:
>Adiantaria para a auditoria se eu criar uma publica√ß√£o no TabNews apresentando os dados que voc√™ precisa, ou at√© passar por aqui mesmo, de forma p√∫blica?

Muito, embora ningu√©m vai morrer se n√£o tiver. Eu n√£o vou ser impedido de renovar o programa porque os dados do TabNews n√£o foram considerados, mas seria legal ter isso, mostrar for√ßa na plataforma.

>Como a Vercel n√£o disponibiliza API para isso, infelizmente n√£o tem como fornecer esses n√∫meros atualizados em tempo real.

De fato, isso n√£o √© necess√°rio pra mim, e acho que para a maioria. A informa√ß√£o, mesmo atrasada, ainda √© bem √∫til.

>Provavelmente teremos que implementar algo pr√≥prio para atender a issue https://github.com/filipedeschamps/tabnews.com.br/issues/1115, mas isso √© melhor ser debatido por l√°.

Novamente, acho muito √∫til para todos, mas eu n√£o preciso para minha necessidade espec√≠fica.

>S√£o n√∫mero reais dos √∫ltimos 12 meses, mas n√£o inclui suas publica√ß√µes e coment√°rios. S√£o apenas da p√°gina do seu perfil

Ok. Ent√£o de fato isso n√£o me serve. Estava achando um n√∫mero baixo, agora acho alto :)

>Eu recomendo experimentar hospedar um projeto na Vercel (pode ser um dos [exemplos do Next.js](https://github.com/vercel/next.js/tree/canary/examples)), se tiver interesse, pois √© algo com zero atrito, principalmente para algu√©m com sua experi√™ncia.

N√£o, obrigado :D :D :D 

>Se quer s√≥ um n√∫mero consolidado, ou se quer uma planilha detalhada, voc√™ decide. Ou deixa a decis√£o para quem for contribuir com a o c√≥digo que precisa ser criado para raspar os dados.

A planilha √© mais interessante, mas pra efeito de entrega para Seattle o total geral de tudo, mesmo aproximado, dos √∫ltimos 12 meses √© suficiente.

>O que acha de somar apenas as visualiza√ß√µes das publica√ß√µes root? Caso contr√°rio estar√° inflando artificialmente os n√∫meros, j√° que deve ser muito raro algu√©m visualizar apenas um coment√°rio sem visualizar a p√°gina da publica√ß√£o raiz. E quando isso acontece, talvez seja um caso que nem deveria ser contabilizado mesmo.

Todas as *roots* que eu participei? J√° fica bem melhor que nada. Dar√° diferen√ßa do real, para baixo, mas n√£o acho que deve ser relevante, porque acho que poucas pessoas acessam diretamente pelo URL do coment√°rio (meu ou de outro acima).

Hoje eu n√£o sei se tenho 10kv, 100kv ou 1mv.

Obrigado.

>> Coment√°rio de nexliaai:
Desculpa minha ignorancia, sou novo no ramo de programa√ß√£o e estou chegando agora no peda√ßo gra√ßas ao Curso.dev.

N√£o seria mais facil fazer essa contagem de acessos pelo Analytics do Google?

>> Coment√°rio de kaique-soares:
@euandreferrari n√£o precisa se desculpar por tirar uma d√∫vida :handshake:

Em resumo, n√£o utilizamos o Google Analytics e evitamos ao m√°ximo ferramentas com prop√≥sito parecido.

Veja esse [coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/1567#issuecomment-1856283663) do @aprendendofelipe e nele tem um link para outro coment√°rio do @filipedeschamps :+1:

>> Coment√°rio de mthmcalixto:
@aprendendofelipe fiz o teste com a informa√ß√£o da API da vercel que retorna os dados de uma p√°gina:

vercel.sh:
```sh
#!/bin/bash
bearerToken="Bearer Ny_____________________"
environment="production"
path="/recents"
filter='{"path":{"values":["'"$path"'"],"operator":"eq"}}'
from="2023-12-13T00:00:00.000Z"
projectId="redesign-tabnews-com-br"
to="2024-01-11T23:59:59.999Z"

url="https://vercel.com/api/web/insights/overview?environment=$environment&projectId=$projectId"

curl -s --get "$url" \
     --data-urlencode "filter=$filter" \
     --data-urlencode "from=$from" \
     --data-urlencode "to=$to" \
     -H "Cookie:authorization=$bearerToken" | jq .
```

Retorno:
```json
{
  "devices": 72,
  "total": 218
}
```

O devices √© a quantidade que aquela p√°gina recebeu.

Apenas o que me preocupa √© se "bearerToken" √© atualizado, renovado.

>> Coment√°rio de aprendendofelipe:
> Apenas o que me preocupa √© se "bearerToken" √© atualizado, renovado.

Desde que n√£o mude durante a execu√ß√£o do script de raspagem, n√£o ser√° problema. Mas tamb√©m √© bom gerar logs e poder fazer isso em etapas, continuando de onde parou, pois tamb√©m pode cair em `rate limit` da API ou qualquer outro erro.

>> Coment√°rio de mthmcalixto:
> > Apenas o que me preocupa √© se "bearerToken" √© atualizado, renovado.
> 
> Desde que n√£o mude durante a execu√ß√£o do script de raspagem, n√£o ser√° problema. Mas tamb√©m √© bom gerar logs e poder fazer isso em etapas, continuando de onde parou, pois tamb√©m pode cair em `rate limit` da API ou qualquer outro erro.

Outra coisa √© a data dessas visualiza√ß√µes, no plano hobby s√£o os √∫ltimos 31 dias, n√£o sei como funciona no plano pro.

Se o "**bearerToken**" n√£o atualizar, daria para salvar no banco de dados dia ap√≥s dia a quantidade de visualiza√ß√µes da postagem que teve no dia e ir somando e n√£o buscar toda hora a quantidade de visualiza√ß√£o, isso iria evitar um poss√≠vel "rate limit".

Esse "**bearerToken**" vem da autoriza√ß√£o do painel do "**analytics**" do projeto, ent√£o n√£o sei se eles colocaram um limite dentro dele.

>> Coment√°rio de aprendendofelipe:
> Outra coisa √© a data dessas visualiza√ß√µes, no plano hobby s√£o os √∫ltimos 31 dias, n√£o sei como funciona no plano pro.

No pr√≥ s√£o 12 meses

---

Complementando a resposta anterior...

> O devices √© a quantidade que aquela p√°gina recebeu.

Os `devices` s√£o quantos diferentes dispositivos acessaram a p√°gina. A Vercel conta como 1 √∫nico dispositivo os diferentes acessos pelo mesmo navegador dentro de 24 horas.

O `total` √© a quantidade de visualiza√ß√µes da p√°gina.

>> Coment√°rio de mthmcalixto:
> > Outra coisa √© a data dessas visualiza√ß√µes, no plano hobby s√£o os √∫ltimos 31 dias, n√£o sei como funciona no plano pro.
> 
> No pr√≥ s√£o 12 meses
> 
> Complementando a resposta anterior...
> 
> > O devices √© a quantidade que aquela p√°gina recebeu.
> 
> Os `devices` s√£o quantos diferentes dispositivos acessaram a p√°gina. A Vercel conta como 1 √∫nico dispositivo os diferentes acessos pelo mesmo navegador dentro de 24 horas.
> 
> O `total` √© a quantidade de visualiza√ß√µes da p√°gina.

Ent√£o, mas para uma visualiza√ß√£o precisa acredito que "devices" iria fazer mais sentido que o total, por que seria mais valido uma pessoa ter visto do que a mesma pessoa ter visto 1000 vezes.

Talvez seja poss√≠vel adicionar as visualiza√ß√µes buscando na API a cada 24h e gravando/atualizando no banco de dados.

>> Coment√°rio de mthmcalixto:
@aprendendofelipe ser√° que √© poss√≠vel tentar algo assim? para ter visualiza√ß√µes dos posts?

>> Coment√°rio de aprendendofelipe:
> @aprendendofelipe ser√° que √© poss√≠vel tentar algo assim? para ter visualiza√ß√µes dos posts?

Se est√° falando sobre o que est√° sendo tratado na #1115, a Vercel n√£o oferece API para isso, ent√£o n√£o faz sentido criar gambiarras para obter os dados deles. √â melhor usarmos algum dos diversos outros servi√ßos que disponibilizam API. Al√©m de termos a op√ß√£o de criar algo do zero, que n√£o deve valer a pena, mas √© uma op√ß√£o.

Nessa issue a ideia √© criar um script para raspar os dados que o @maniero precisa. Isso vai ser rodado uma vez para obter os dados dele, e pode ser √∫til mais para frente, para injetar dados iniciais quando o sistema discutido em #1115 estiver pronto, mas n√£o serve para algo que deveria ser executado em um servidor, j√° que precisaria de credenciais apropriadas para isso.

>> Coment√°rio de aprendendofelipe:
@maniero, seu n√∫mero preliminar √© mais de **454k** diferentes dispositivos acessaram suas publica√ß√µes ou as que voc√™ comentou. üöÄüëè

Some a isso mais de **4k** dispositivos no seu perfil.

No caso das publica√ß√µes que voc√™ comentou, considerei apenas os acessos que ocorreram ap√≥s seu coment√°rio mais antigo em cada uma.

Para suas publica√ß√µes/coment√°rios mais antigos, considerei apenas os acessos ap√≥s o dia 1/4/2023.

Os n√∫meros s√£o de dispositivos, n√£o visualiza√ß√µes de p√°ginas, ou seja, desconsidera visitas duplicadas em um mesmo dispositivo dentro de 24 horas.

Mais perto do dia 31 eu tento puxar os dados mais atualizados com os √∫ltimos dias de mar√ßo/24 e posto aqui uma planilha com os dados completos, inclusive as visualiza√ß√µes de p√°ginas. ü§ù

>> Coment√°rio de aprendendofelipe:
@maniero, seu total (de abril/23 at√© mar√ßo/24) ficou em **468.388 dispositivos** (546.552 visitas). üéâüéâüéâ

Esses n√∫meros s√£o apenas da vers√£o Web do TabNews. Infelizmente ainda n√£o temos as estat√≠sticas da API de maneira t√£o detalhada, sen√£o os n√∫meros seriam ainda maiores pelos acessos via aplicativos. A princ√≠pio esses n√∫meros tamb√©m n√£o consideram os acessos por rob√¥s, que est√£o em cerca de 17% do nosso tr√°fego (deve ter I.A. sendo treinada com as publica√ß√µes ü§ñ).

Segue o link da planilha com detalhamento dos dados por conte√∫do, por dia e por tipo (dispositivo ou total de visitas):

https://docs.google.com/spreadsheets/d/1qgjCKopBYOG29QqOfNb8HtRs9p_OCljG_0ZQsyETltc/edit?usp=sharingÔ¨Å

E de brinde vai um gr√°fico com os dados por dia (de abril/23 at√© mar√ßo/24):

![Gr√°fico de estat√≠sticas do Maniero em 2023/24](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/9a717456-7a42-476a-90ad-ffafa642e894)

>> Coment√°rio de maniero:
Muito obrigado Felipe, ficou sensacional. Promete n√£o encher o saco at√© o ano que vem :P :D

>> Coment√°rio de wellwelwel:
Fala pessoal, estou com um problema praticamente igual.

Esse ano fui indicado para o **Microsoft MVP** e gostaria de adicionar meus dois artigos educacionais no **TabNews** como contribui√ß√µes:

- [**Seguran√ßa:** Polui√ß√£o de Prot√≥tipos em Objetos Congelados (JS)](https://www.tabnews.com.br/wellwelwel/seguranca-cuidados-ao-usar-object-freeze-e-poluicao-de-prototipos-js)
- [**Tutorial:** Introduzindo Testes Unit√°rios para Devs Iniciantes (JS)](https://www.tabnews.com.br/wellwelwel/tutorial-introduzindo-testes-unitarios-para-devs-iniciantes-js)

Mas para isso, preciso do n√∫mero de alcance/visualiza√ß√µes deles (mesmo que aproximado).

Ficaria extremamente agradecido se for poss√≠vel obter essa informa√ß√£o üíô

> [!NOTE]
> Como j√° tem tanto esse Issue (ainda que fechado) e o #1115 em andamento, optei por n√£o abrir um novo Issue üôãüèª‚Äç‚ôÇÔ∏è

>> Coment√°rio de maniero:
Weslley, voc√™ j√° est√° no programa ou foi indicado por algu√©m para entrar? Se est√°, eu vou pedir pro Felipe perto do dia 31/03 quando fecha nosso ano, ent√£o a√≠ acho que ele pode fazer o meu e o seu. A n√£o ser que seja certeza que voc√™ n√£o vai publicar mais nada at√© l√°. Eu recomendo publicar. Se n√£o est√° n√£o sei bem a melhor estrat√©gia at√© porque eu entrei de forma diferente de todo mundo, eu n√£o fui indicado por ningu√©m, foi a Microsoft que me procurou.

Coloca tudo. De uns tempos pra c√° eles t√™m preferido agrupar contribui√ß√µes, para n√£o ficar como o Groffe que tinha 1000 :D Eu coloco o que eu fiz por site ou por evento, etc. Se quiser depois pode listar na descri√ß√£o internet os itens mais importantes, mas eu fa√ßo super simples, t√≠tulo, tipo, descri√ß√£o b√°sica e alcance.

>> Coment√°rio de wellwelwel:
> Weslley, voc√™ j√° est√° no programa ou foi indicado por algu√©m para entrar?

@maniero, obrigado pela aten√ß√£o! √â minha primeira indica√ß√£o, estou na etapa de incluir as 24 contribui√ß√µes.

> vou pedir pro Felipe perto do dia 31/03

Tenho at√© dia 21/02/25 para enviar minha candidatura.

> Coloca tudo. De uns tempos pra c√° eles t√™m preferido agrupar contribui√ß√µes

Valeu pelas dicas! Algumas coisas eu agrupo, como minha atua√ß√£o √© mais voltada para o open-source, foco bastante no impacto das minhas contribui√ß√µes (especialmente no n√∫mero de downloads), mas tamb√©m publico alguns artigos e realizo palestras. A ideia √© realmente usar tudo que tenho, por isso a ideia de pedir pelas visualiza√ß√µes dos artigos postados no **TabNews**.

>> Coment√°rio de aprendendofelipe:
Fala @wellwelwel! Levantei os dados de __1 de abril de 2024 at√© hoje__. Veja se tem tudo que voc√™ precisa. üëç

Assim como fiz para o Maniero no ano passado, inclu√≠ as estat√≠sticas das publica√ß√µes que voc√™ comentou, contando apenas os eventos ap√≥s a cria√ß√£o do seu primeiro coment√°rio em cada publica√ß√£o. Caso queira apenas os dados das suas pr√≥prias publica√ß√µes, basta ignorar as que voc√™ comentou.

Uma informa√ß√£o importante √© que __n√≥s mudamos da Vercel Analytics para a Umami no in√≠cio de janeiro de 2025__. Como a metodologia de cada uma √© diferente, e n√£o sei se voc√™ prefere os maiores n√∫meros ou os mais conservadores, estou deixando tudo separado para voc√™ poder escolher quais usar e da√≠ somar os dados de 2024 com os de 2025.

#### Estat√≠sticas do @wellwelwel na Vercel (2024) e Umami (2025)

root_content | target_content | first_interaction_with_root | vercel_pageviews | vercel_devices | umami_pageviews | umami_visits | umami_visitors
-- | -- | -- | -- | -- | -- | -- | --
[/wellwelwel/pitch-tornando-testes-simples-para-node-js-bun-deno-e-typescript](https://www.tabnews.com.br/wellwelwel/pitch-tornando-testes-simples-para-node-js-bun-deno-e-typescript) | [/wellwelwel/pitch-tornando-testes-simples-para-node-js-bun-deno-e-typescript](https://www.tabnews.com.br/wellwelwel/pitch-tornando-testes-simples-para-node-js-bun-deno-e-typescript) | 2024-03-20 17:50:52.553+00 | 213 | 172 | 5 | 5 | 5
[/enux5/mudar-de-carreira-aos-36](https://www.tabnews.com.br/enux5/mudar-de-carreira-aos-36) | [/wellwelwel/57879d08-bd26-420f-ab77-75516b2630da](https://www.tabnews.com.br/wellwelwel/57879d08-bd26-420f-ab77-75516b2630da) | 2024-03-20 20:34:51.328+00 | 5 | 3 | 0 | 0 | 0
[/wellwelwel/tutorial-introduzindo-testes-unitarios-para-devs-iniciantes-js](https://www.tabnews.com.br/wellwelwel/tutorial-introduzindo-testes-unitarios-para-devs-iniciantes-js) | [/wellwelwel/tutorial-introduzindo-testes-unitarios-para-devs-iniciantes-js](https://www.tabnews.com.br/wellwelwel/tutorial-introduzindo-testes-unitarios-para-devs-iniciantes-js) | 2024-03-23 02:12:39.011+00 | 722 | 511 | 6 | 6 | 6
[/hebertzin/projetos-open-source](https://www.tabnews.com.br/hebertzin/projetos-open-source) | [/wellwelwel/bf82ab5c-c642-4560-b8f1-aa9b85eba573](https://www.tabnews.com.br/wellwelwel/bf82ab5c-c642-4560-b8f1-aa9b85eba573) | 2024-03-29 07:26:22.44+00 | 47 | 43 | 1 | 1 | 1
Conte√∫do exclu√≠do | [/wellwelwel/25900e97-20c4-4fff-b010-672b38b1b1a2](https://www.tabnews.com.br/wellwelwel/25900e97-20c4-4fff-b010-672b38b1b1a2) | 2024-04-03 22:02:39.454+00 | 83 | 32 | 0 | 0 | 0
[/wellwelwel/seguranca-cuidados-ao-usar-object-freeze-e-poluicao-de-prototipos-js](https://www.tabnews.com.br/wellwelwel/seguranca-cuidados-ao-usar-object-freeze-e-poluicao-de-prototipos-js) | [/wellwelwel/seguranca-cuidados-ao-usar-object-freeze-e-poluicao-de-prototipos-js](https://www.tabnews.com.br/wellwelwel/seguranca-cuidados-ao-usar-object-freeze-e-poluicao-de-prototipos-js) | 2024-04-19 15:06:39.314+00 | 391 | 265 | 2 | 2 | 2
[/GheistLycis/testes-unitarios-em-front-com-typescript](https://www.tabnews.com.br/GheistLycis/testes-unitarios-em-front-com-typescript) | [/wellwelwel/676f9c2c-76d9-4ab3-a0fd-da877fd257b0](https://www.tabnews.com.br/wellwelwel/676f9c2c-76d9-4ab3-a0fd-da877fd257b0) | 2024-05-02 20:03:08.699+00 | 854 | 752 | 6 | 6 | 5
[/mayconbalves/por-que-eu-odeio-a-area-de-programacao](https://www.tabnews.com.br/mayconbalves/por-que-eu-odeio-a-area-de-programacao) | [/wellwelwel/3c40fe07-bf65-4983-a23a-b06cf5e41951](https://www.tabnews.com.br/wellwelwel/3c40fe07-bf65-4983-a23a-b06cf5e41951) | 2024-05-02 21:58:22.311+00 | 319 | 251 | 5 | 5 | 5
[/wellwelwel/opinioes-e-ideias-vale-a-pena-investir-recursos-pagos-em-um-projeto-open-source](https://www.tabnews.com.br/wellwelwel/opinioes-e-ideias-vale-a-pena-investir-recursos-pagos-em-um-projeto-open-source) | [/wellwelwel/opinioes-e-ideias-vale-a-pena-investir-recursos-pagos-em-um-projeto-open-source](https://www.tabnews.com.br/wellwelwel/opinioes-e-ideias-vale-a-pena-investir-recursos-pagos-em-um-projeto-open-source) | 2024-07-09 14:28:31.06+00 | 334 | 232 | 1 | 1 | 1
[/wellwelwel/nao-e-pitch-e-comemoracao](https://www.tabnews.com.br/wellwelwel/nao-e-pitch-e-comemoracao) | [/wellwelwel/nao-e-pitch-e-comemoracao](https://www.tabnews.com.br/wellwelwel/nao-e-pitch-e-comemoracao) | 2024-07-23 11:09:11.253+00 | 1421 | 1196 | 5 | 5 | 5
Conte√∫do exclu√≠do | [/wellwelwel/01403ba1-e990-46a4-a725-86b6a8ceb4a4](https://www.tabnews.com.br/wellwelwel/01403ba1-e990-46a4-a725-86b6a8ceb4a4) | 2024-07-23 13:02:05.991+00 | 52 | 40 | 0 | 0 | 0
[/leydsonandrey/mudar-tema-e-icones-do-xfce4-pelo-terminal](https://www.tabnews.com.br/leydsonandrey/mudar-tema-e-icones-do-xfce4-pelo-terminal) | [/wellwelwel/95c5a459-5ed6-44dc-b39c-63296c1175a8](https://www.tabnews.com.br/wellwelwel/95c5a459-5ed6-44dc-b39c-63296c1175a8) | 2024-08-24 08:21:59.428+00 | 85 | 75 | 8 | 8 | 7
[/andersonalvescoelho/performance-do-orm-vs-sql-o-que-e-melhor-para-seu-projeto-node-js](https://www.tabnews.com.br/andersonalvescoelho/performance-do-orm-vs-sql-o-que-e-melhor-para-seu-projeto-node-js) | [/wellwelwel/71325782-33bd-4eea-b81d-e8bd4c480cb8](https://www.tabnews.com.br/wellwelwel/71325782-33bd-4eea-b81d-e8bd4c480cb8) | 2024-11-19 18:21:29.627+00 | 592 | 523 | 26 | 26 | 21
[/filipedeschamps/voce-adiciona-suco-nos-seus-softwares](https://www.tabnews.com.br/filipedeschamps/voce-adiciona-suco-nos-seus-softwares) | [/wellwelwel/7d594d13-a0b7-45b1-b14e-6c9f53ddba62](https://www.tabnews.com.br/wellwelwel/7d594d13-a0b7-45b1-b14e-6c9f53ddba62) | 2025-02-08 00:12:01.95+00 | 0 | 0 | 952 | 816 | 763


<details>
<summary>Expanda aqui para ver alguns detalhes de como os dados foram obtidos</summary><br>

A consulta abaixo foi utilizada para listar os conte√∫dos criados pelo @wellwelwel e os que ele comentou:

```sql
WITH target_user AS (
    SELECT id, username 
    FROM users 
    WHERE username = 'wellwelwel'
)
SELECT
    CONCAT('/', root_username, '/', root_slug) AS root_path,
    root_status,
    CONCAT('/', target_username, '/', target_slug) AS target_path,
    interacted_at
FROM (
    SELECT DISTINCT ON (root.id)
        target.published_at AS interacted_at,
        root_user.username AS root_username,
        root.slug AS root_slug,
        root.status AS root_status,
        target.slug AS target_slug,
        target_user.username AS target_username
    FROM contents target
    INNER JOIN target_user ON target_user.id = target.owner_id
    INNER JOIN contents root ON root.id = COALESCE(target.path[1], target.id)
    INNER JOIN users root_user ON root_user.id = root.owner_id
    WHERE target.status = 'published'
    ORDER BY root.id, target.published_at ASC
) AS distinct_interacted_root
ORDER BY interacted_at;
```

O `root_path` e o `interacted_at` foram utilizados para obter as estat√≠sticas da Vercel e da Umami, ou seja, os dados estat√≠sticos s√£o sempre da publica√ß√£o raiz, mas n√£o necessariamente os dados totais dela.

O `root_status` e o `target_path` s√≥ foram utilizados para criar os links da tabela que apresenta os resultados.

</details>


Qualquer d√∫vida, ou se precisar de qualquer dado diferente, √© s√≥ falar. ü§ù

>> Coment√°rio de wellwelwel:
Muito obrigado, @aprendendofelipe ü§ù

>> Coment√°rio de maniero:
@aprendendofelipe, conforme prometido, s√≥ vim encher o saco 1 ano depois :)

Ser√° que voc√™ poderia fazer a gentileza de criar o relat√≥rio para este ano igual ano passado para o dia 31?

Quer que abra outro ou fica aqui mesmo? Quer que eu te avise 2a. feira? 

Obrigado antecipadamente.

>> Coment√°rio de aprendendofelipe:
@maniero, n√£o ser√° poss√≠vel obter os dados exatamente da mesma maneira que no ano passado, pois, pr√≥ximo da virada do ano, mudamos o Analytics da Vercel para a Umami e os dois servi√ßos tem metodologias e m√©tricas diferentes.

Veja como apresentei os dados para o Weslley (https://github.com/filipedeschamps/tabnews.com.br/issues/1576#issuecomment-2661037984). N√£o sabia como/se ele ia preferir somar os n√∫meros, ent√£o apresentei os dados de cada servi√ßo separadamente.

Quer que eu fa√ßa nesse mesmo padr√£o para os dados dos seus conte√∫dos? Devido ao volume, envio os seus em uma planilha e voc√™ consegue analisar como fica melhor somar os n√∫meros dos dois servi√ßos. Se preferir os dados j√° somados de alguma maneira espec√≠fica, √© s√≥ dizer como prefere unir os dados, usando como exemplo os dados do Wesley. ü§ù

>> Coment√°rio de maniero:
@aprendendofelipe a forma exata n√£o importa, s√≥ importa ter a informa√ß√£o, pode ser s√≥ um apanhado geral de cada um deles, eu preciso s√≥ do total de *views*, mesmo que quebrado em 2 partes. De qualquer forma, fa√ßa o que for mais f√°cil tentando me dar essa informa√ß√£o.

Brigad√£o.

>> Coment√°rio de maniero:
@aprendendofelipe quando puder disponibilizar eu agrade√ßo, n√£o tenho pressa de pegar, mas preciso que seja o mais pr√≥ximo poss√≠vel de 01/04/2024 em 31/03/2025.

Obrigado novamente.

>> Coment√°rio de aprendendofelipe:
Tranquilo @maniero, eu j√° salvei os dados da Vercel, pegando desde 00h00 de 01/04/2024 at√© o come√ßo de janeiro.

Se n√£o acontecer nenhum imprevisto, amanh√£ mesmo eu j√° pego os dados da Umami, que completa o per√≠odo at√© 24h00 de 31/03/2025. ü§ù

>> Coment√°rio de aprendendofelipe:
@maniero, somando os n√∫meros da Vercel e da Umami, e considerando as publica√ß√µes que voc√™ comentou, nos √∫ltimos 12 meses voc√™ teve __178.455 pageviews__.

O interessante √© que mais da metade desse total foi registrada na Umami, ou seja, ocorreu nos √∫ltimos tr√™s meses. Isso faz sentido, j√° que foi o per√≠odo em que voc√™ mais interagiu.

Tamb√©m vale notar que muitos conte√∫dos mais antigos continuam recebendo visualiza√ß√µes, contribuindo com cerca de 30% do total. Al√©m disso, o n√∫mero geral de visualiza√ß√µes foi bem menor do que nos 12 meses anteriores (2023/24), refletindo a redu√ß√£o no volume de publica√ß√µes e coment√°rios seus nesse √∫ltimo ano.

O detalhamento por servi√ßo de Analytics e por conte√∫do est√° dispon√≠vel no arquivo abaixo:

[Planilha de detalhamento](https://docs.google.com/spreadsheets/d/1kALM1iKOsm-jzq-yA-17z7j77rO9nHrvrUu8RU_af8o)

Qualquer d√∫vida, √© s√≥ avisar! ü§ù
</issue_1576_Disponibilizar os views que cada usu√°rio teve>

<issue_1579_Favoritos>
### Descri√ß√£o

Eu costumo favoritar os post que quero ler dps ou ate msm que nao quero perder de vista para rever no futuro, no APP tem um bot√£o de FAVORITOS, entao uso ele para fazer isso, mas na vers√£o web nao tem, seria interessante. Obrigado a todos pelo projeto.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Jamison, obrigado pela sugest√£o. Estou fechando esse issue para concentrar a discuss√£o sobre essa funcionalidade em https://github.com/filipedeschamps/tabnews.com.br/issues/645, ok? L√° a sugest√£o j√° foi para um pouco al√©m: n√£o apenas ter favoritos, mas sim listas, com a possibilidade de serem listas p√∫blicas ou particulares.

>> Coment√°rio de JamisonCarvalho:
obrigado @Rafatcb
</issue_1579_Favoritos>

<issue_1585_A Wiki foi descontinuada ?>
### Assunto

Outro

### D√∫vida

Li a wiki do projeto e achei um lugar repleto de insights e explica√ß√µes sobre as decis√µes tomadas. √â um excelente guia para quem deseja contribuir com o projeto. No entanto, notei que ela n√£o √© atualizada desde 10/03/2022.

A Wiki foi descontinuado ou h√° previs√£o de retomar as wikis em algum momento?

>> Coment√°rio de filipedeschamps:
@emerson-oliveira √≥tima pergunta meu caro! Acredito que, com tudo o que est√° acontecendo, por hora n√£o h√° planos de voltar com o Wiki, mas uma √≥tima forma de navegar pelo desenvolvimento do projeto √© pelas Milestones (ou pelas [issues](https://github.com/filipedeschamps/tabnews.com.br/issues/1490) das Milestones). Fora que est√£o num √≥timo est√°gio para participar das discuss√µes ü§ù
</issue_1585_A Wiki foi descontinuada ?>

<issue_1587_[D√∫vida] Custos do TabNews>
### Assunto

Outro

### D√∫vida

Estou abrindo essa issue apenas a t√≠tulo de curiosidade.

1. Qual o custo mensal para rodar o TabNews?
2. Qual servi√ßos externos s√£o utilizados?
3. Al√©m da Vercel, existem outras empresas que cobrem alguns desses custos?

Acredito que seria interessante ter alguma forma de acompanhar essas informa√ß√µes de forma mais f√°cil, talvez incluir em www.tabnews.com.br/status

>> Coment√°rio de mthmcalixto:
@ErickCReis Eu acredito que o maior gasto est√° em banco de dados. 

Como site est√° hospedado na [Vercel ](https://vercel.com/) e √© serverless o gasto √© menor em rela√ß√£o a hospedagem

Acredito tamb√©m que com envio de email n√£o √© cobrado, por que usa [Nodemailer](https://nodemailer.com/)

N√£o vejo outros servi√ßos que foram utilizados al√©m desses

Acho eu que essas informa√ß√µes n√£o ser√£o compartilhadas, mas seria interessante para ter uma transpar√™ncia

>> Coment√°rio de kaique-soares:
- @ErickCReis e @mthmcalixto sugiro darem uma olhada [neste coment√°rio](https://github.com/filipedeschamps/tabnews.com.br/issues/826#issuecomment-1338339498) do @aprendendofelipe que foi feito quando o #826

>> Coment√°rio de aprendendofelipe:
Na minha opini√£o, hoje o custo tecnol√≥gico √© desprez√≠vel quando comparado com todo o tempo que pessoas dedicam para ajudar a manter o TabNews funcionando, seja na cria√ß√£o e curadoria de conte√∫dos ou na evolu√ß√£o do c√≥digo. üòç

De qualquer forma, nada deve ter mudado desde que o @filipedeschamps fez a [publica√ß√£o no TabNews que citou os custos tecnol√≥gicos](https://www.tabnews.com.br/filipedeschamps/tabnews-atinge-1-5-milhoes-de-views-e-futuro-do-projeto-alerta-de-textao#:~:text=mais%20para%20frente.-,Custos,-Na%20issue%20oficial).

Obs.: Eu acabo de editar a publica√ß√£o do Filipe apenas para arrumar a formata√ß√£o de um trecho que estava sendo interpretado pelo ByteMD como f√≥rmula matem√°tica. S√≥ troquei um `$` por `&#36;`

Antes | Depois
--- | ---
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/fd54cba2-8269-4750-a527-25d82a50e2bf) | ![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/c27ade3e-d07c-4303-a4d4-45a5cad06fba)

>> Coment√°rio de Rafatcb:
Acho que pode ser legal termos isso no README ou em algum outro lugar.

A prop√≥sito, n√£o precisamos ter o logo da Vercel em algum lugar por causa da parceria?

>> Coment√°rio de ErickCReis:
@kaique-soares e @aprendendofelipe muito obrigado pelos links, acho que j√° tinha visto eles em algum outro momento, mas acabei n√£o encontrando mais, esse foi uns dos motivos para a issue tamb√©m.

> Na minha opini√£o, hoje o custo tecnol√≥gico √© desprez√≠vel quando comparado com todo o tempo que pessoas dedicam para ajudar a manter o TabNews funcionando, seja na cria√ß√£o e curadoria de conte√∫dos ou na evolu√ß√£o do c√≥digo. üòç

Concordo totalmente.

> De qualquer forma, nada deve ter mudado desde que o @filipedeschamps fez a [publica√ß√£o no TabNews que citou os custos tecnol√≥gicos](https://www.tabnews.com.br/filipedeschamps/tabnews-atinge-1-5-milhoes-de-views-e-futuro-do-projeto-alerta-de-textao#:~:text=mais%20para%20frente.-,Custos,-Na%20issue%20oficial).

Entendi, n√£o imaginava que o custo se manteria est√°vel durante todo esse per√≠odo.

>> Coment√°rio de Rafatcb:
Vou fechar este issue, visto que alguns valores j√° foram respondidos na publica√ß√£o do TabNews mencionada acima, e agora temos o fim da parceria com a Vercel, que est√° sendo acompanhado no issue https://github.com/filipedeschamps/tabnews.com.br/issues/1724, com alguns valores mencionados l√°.
</issue_1587_[D√∫vida] Custos do TabNews>

<issue_1591_Erro 403 ao realizar cadastro>
### Descri√ß√£o

Encontrei um problema ao tentar efetuar o cadastro no TabNews.

A mensagem de erro diz "N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o." mas minha conex√£o a internet parece estar ok. Depois de atualizar a p√°gina algumas vezes, consegui fazer o cadastro.

O http response retornou 403 Forbidden:

<img width="1916" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/8337704/5c0e42c8-eea4-4a0c-9bbc-39287b16fd3e">


### Passos para reproduzir o problema

1. Ir at√© a p√°gina de cadastro https://www.tabnews.com.br/cadastro
2. Informar dados;
3. Clicar em cadastrar.

### Navegadores testados

Outro

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@ThisIsDjonathan, obrigado por reportar! üí™

Vi que voc√™ j√° conseguiu criar a conta. üéâ

Uma d√∫vida: Na primeira tentativa voc√™ deixou a janela aberta na p√°gina de cadastro por alguns minutos, ou foi s√≥ o tempo de preencher o formul√°rio?

Nos √∫ltimos dias o site est√° propositalmente em um modo mais restrito, ent√£o ao navegar para a p√°gina de cadastro a Cloudflare faz uma verifica√ß√£o do seu navegador e libera o uso da API de cadastro por um certo tempo. Se o cadastro n√£o for submetido nesse intervalo, √© necess√°rio acessar a p√°gina novamente para reiniciar o tempo. Imagino que foi isso que ocorreu.

Se foi isso, acho que podemos fechar a issue, pois j√° temos duas relacionadas em como precisamos lidar melhor com requisi√ß√µes bloqueadas pela Cloudflare. Uma √© mais parecida com essa, pois se aplica quando habilitamos alguma prote√ß√£o extra, como no login ou cadastro, e a outra √© pra quando a Cloudflare desconfia da requisi√ß√£o por conta pr√≥pria:

- #1344
- #1516

>> Coment√°rio de ThisIsDjonathan:
@aprendendofelipe deixei aberto um tempinho sim. Deve estar relacionado ao Cloudflare ent√£o!

>> Coment√°rio de aprendendofelipe:
Legal @ThisIsDjonathan, ent√£o vou fechar essa aqui como duplicidade. ü§ù

Muito obrigado! üí™
</issue_1591_Erro 403 ao realizar cadastro>

<issue_1592_[Sugest√£o] Seria legal os links abrir em uma nova guia do navegador>
### Descri√ß√£o

Minha opini√£o, acho mais interessante isso estar autom√°tico mas e um gosto pessoal ...

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
@Thiago-duart obrigado pela sugest√£o. J√° temos um issue sobre isso e sugiro concentrarmos a discuss√£o l√°: https://github.com/filipedeschamps/tabnews.com.br/issues/477.

Inclusive, j√° foi abordado na discuss√£o a possibilidade de permitir isso ser configur√°vel por usu√°rio.
</issue_1592_[Sugest√£o] Seria legal os links abrir em uma nova guia do navegador>

<issue_1596_Exibir diferentes sugest√µes de t√≠tulo no placeholder ao criar uma publica√ß√£o>
### Descri√ß√£o

Uma das formas de mostrar ao usu√°rio o que √© esperado ao preencher um campo √© no `placeholder` do `TextInput`. Conforme discutido em https://github.com/filipedeschamps/tabnews.com.br/pull/1580#discussion_r1437874228, seria interessante ter diferentes sugest√µes de t√≠tulos com base no tipo de publica√ß√£o que queremos incentivar.

√â importante que o texto seja relativamente curto, para que seja inteiramente vis√≠vel (ou quase) em dispositivos com telas menores. Tenho um celular antigo e com tela pequena que √© poss√≠vel visualizar 47 caracteres, ent√£o creio que esse valor possa ser usado como refer√™ncia, mas isso n√£o √© uma exig√™ncia. Se o t√≠tulo for maior e der para entender sem ler o final, tamb√©m √© algo positivo.

### Sugest√£o de implementa√ß√£o

O `placeholder` atual est√° aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/769a61b6fd7c65af423b2c54c352a096c560e984/pages/interface/components/Content/index.js#L457

Ele tem 68 caracteres, ent√£o se puder ser diminu√≠do um pouco seria algo legal tamb√©m.

As sugest√µes podem ficar num array e ser escolhido um elemento de forma aleat√≥ria. Se essa abordagem for escolhida, talvez seja necess√°rio fazer uso de um `useMemo` ou `useRef` para evitar trocar o `placeholder` ao rerenderizar o componente `Content`.

Antes da implementa√ß√£o seria bom termos as sugest√µes de `placeholder`s definidas neste issue.

>> Coment√°rio de diegosano:
@Rafatcb gostaria de participar e trabalhar nessa issue

>> Coment√°rio de Rafatcb:
@diegosano sem problemas üòÑ 

Tem alguma sugest√£o de t√≠tulos que podemos exibir para o usu√°rio? Considerando a pergunta [Que tipo de conte√∫do eu posso publicar no TabNews?](https://www.tabnews.com.br/faq#conteudo-tabnews) do FAQ, acho que podemos criar uma sugest√£o para cada "tipo de conte√∫do". S√£o 7 tipos listados na resposta do FAQ, e talvez alguns n√£o tenham um bom exemplo de t√≠tulo, mas √© um bom guia.

* not√≠cias
* artigos
* tutoriais
* indica√ß√µes
* curiosidades
* sugest√µes de software e ferramentas
* perguntas bem formuladas

Tamb√©m podemos melhorar o placeholder atual ( `e.g. Desafios que tive no meu primeiro ano empreendendo com software`) para ficar menor, como mencionei na cria√ß√£o do issue.

>> Coment√°rio de diegosano:
Opa, muito obrigado, acho muito boa a ideia de ter pelo menos 1 t√≠tulo para cada sugest√£o do FAQ.

- Not√≠cias: "e.g A nova era da computa√ß√£o qu√¢ntica"
- Artigos: "e.g Desafios para se empreender como desenvolvedor"
- Tutoriais: "e.g Como come√ßar com a linguagem Rust"
- Indica√ß√µes: "e.g Top 5 livros fundamentais para desenvolvedores"
- Curiosidades: "e.g Fatos curiosos sobre IA que voc√™ n√£o sabia"
- Software e ferramentas: "e.g Softwares para melhorar sua produtividade"
- Perguntas bem formuladas: "e.g Como renomear uma branch local no Git?"

 O que acha dessas sugest√µes?

>> Coment√°rio de Rafatcb:
@diegosano gostei das suas sugest√µes e o comprimento delas est√° √≥timo. Vou tentar complementar com base no que me parece um t√≠tulo de uma publica√ß√£o que "tem cara de ser boa". N√£o esque√ßa que a abrevia√ß√£o no in√≠cio √© `e.g.` (com um ponto no final).

> Not√≠cias: "e.g A nova era da computa√ß√£o qu√¢ntica"

Me pareceu muito click bait. Acho que not√≠cia ser√° o tipo mais dif√≠cil de criar uma sugest√£o de t√≠tulo sem ficar algo muito datado e ao mesmo tempo fazer sentido.

> Artigos: "e.g Desafios para se empreender como desenvolvedor"

Tive a impress√£o de que aqui misturou dois poss√≠veis t√≠tulos, que s√£o assuntos diferentes: _"Desafios ao empreender como desenvolvedor"_ e _"Problemas para solucionar como desenvolvedor"_ (ou algo parecido). A primeira op√ß√£o cita diretamente dois grupos que o TabNews gosta de incentivar (por meio dos Pitchs), ent√£o eu escolheria ela. Acho que o t√≠tulo est√° muito abrangente, mas agora n√£o consegui pensar em algo melhor e que continue curto.

> Tutoriais: "e.g Como come√ßar com a linguagem Rust"

Eu gostei, mas creio que se formos mais espec√≠ficos, podemos incentivar publica√ß√µes mais aprofundadas. Pensei em algo como `e.g. Como funciona o conceito de ownership em Rust`. Faz sentido?

> Indica√ß√µes: "e.g Top 5 livros fundamentais para desenvolvedores"

:+1: Acho que est√° bom. J√° tivemos publica√ß√µes sobre livros, e geralmente outras pessoas agregam nos coment√°rios com outras sugest√µes ou experi√™ncias que tiveram com os livros citados.

> Curiosidades: "e.g Fatos curiosos sobre IA que voc√™ n√£o sabia"

Acho que isso ficou com cara de "Fatos Desconhecidos" :laughing:. Podemos tentar um t√≠tulo mais espec√≠fico.

> Software e ferramentas: "e.g Softwares para melhorar sua produtividade"

[Software n√£o tem plural](https://www.dictionary.com/e/is-software-a-mass-noun/). Fora isso, achei o t√≠tulo bom. Pode ser "e.g. Aplicativos para melhorar sua produtividade".

> Perguntas bem formuladas: "e.g Como renomear uma branch local no Git?"

Essa √© uma pergunta que poderia ser facilmente feita para o Google, mas n√£o est√° mal feita. Talvez algu√©m consiga sugerir algo melhor.

---

Um pensamento um pouco off-topic que passou pela minha cabe√ßa, quando termos tags (https://github.com/filipedeschamps/tabnews.com.br/issues/742) poderemos usar um placeholder na tag que fa√ßa sentido com o t√≠tulo que est√° aparecendo, ent√£o isso ficar√° "ainda mais claro", pois ter√° mais contexto.

>> Coment√°rio de diegosano:
@Rafatcb concordo com o que voc√™ complementou, acredito que por enquanto temos:

- Not√≠cias: "e.g. A nova era da computa√ß√£o qu√¢ntica" _*procurando uma sugest√£o melhor_
- Artigos: "e.g. Desafios ao empreender como desenvolvedor"
- Tutoriais: "e.g. Como funciona o conceito de ownership em Rust"
- Indica√ß√µes: "e.g. Top 5 livros fundamentais para desenvolvedores"
- Curiosidades: "e.g. Fatos curiosos sobre IA que voc√™ n√£o sabia" _*procurando algo menos "Fatos desconhecidos"_ üòÑ  _e mais espec√≠fico_
- Software e ferramentas: "e.g. Aplicativos para melhorar sua produtividade"
- Perguntas bem formuladas: "e.g. Como renomear uma branch local no Git?" _*procurando um t√≠tulo de pergunta mais espec√≠fica, que n√£o se encontre no Gooogle, por exemplo_

Acho que estamos em um bom caminho, vou continuar pensando e quem sabe mais algu√©m da comunidade possa ajudar com essa parte criativa! 

Vou come√ßar a implementar o c√≥digo, acredito que ao longo do desenvolvimento essas sugest√µes apare√ßam e podemos ir modificando esse array de exemplos, o que acha?

>> Coment√°rio de Rafatcb:
@diegosano acredito que temos uma base boa. Pode fazer, talvez o PR chame mais aten√ß√£o para outras pessoas avaliarem :+1:
</issue_1596_Exibir diferentes sugest√µes de t√≠tulo no placeholder ao criar uma publica√ß√£o>

<issue_1597_Erro ao me Cadastrar>
### Descri√ß√£o

Estou tentando fazer cadastro no TabNews, mas fica aparecendo a seguinte mensagem: 
N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o.

Minha internet √© boa, e eu tamb√©m passei pelo mesmo erro em outras 2 internets.

### Passos para reproduzir o problema

1. V√° em cadastrar
2.  Coloque seus dados
3.  Clique em Li e estou de acordo com os Termos de Uso
4.  Clique em Criar cadastro
5. E agora aparecer√° a mensagem "N√£o foi poss√≠vel se conectar ao TabNews. Por favor, verifique sua conex√£o."

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@Thiago0808, obrigado por reportar.

Quanto tempo levou entre abrir a tela de cadastro e clicar em "Criar cadastro"?

Dever ser o mesmo caso do #1591.
</issue_1597_Erro ao me Cadastrar>

<issue_1599_Tabela de atividades e contribui√ß√µes do usu√°rio>
### Descri√ß√£o

Fala turma! Ap√≥s ver algumas issues como a #1576 e a rede de qualifica√ß√£o, surgiu a ideia de criar algo semelhante √† tabela de contribui√ß√£o do GitHub.

![tabela de contribui√ß√£o](https://github.com/filipedeschamps/tabnews.com.br/assets/73134662/88a05116-e473-4322-8ab5-a6347f0a824c)

Adicionar a cada dia um somat√≥rio de publica√ß√µes, coment√°rios e TabCoins/TabCash ganhos. Seria legal para analisar a progress√£o dos usu√°rios na plataforma.

### Sugest√£o de implementa√ß√£o

Quantificar os posts e coment√°rios n√£o seria um problema, quanto aos TabCoins e TabCash a discuss√£o em #1341 j√° mostra uma an√°lise utilizando datas e que poderia ser √∫til.

>> Coment√°rio de mthmcalixto:
@marlonangeli Talvez seja poss√≠vel, s√≥ precisava saber como retornar ou gravar esses dados.

Tem um reposit√≥rio aqui no Github que voc√™ pode colocar os dados e ele iria retornar tudo bonitinho, se chama [React Activity Calendar](https://github.com/grubersjoe/react-activity-calendar).

Pelo que entendi basta tem dados:
```json
[
  {
    "date": "2023-06-14",
    "count": 2,
    "level": 1
  },
  {
    "date": "2023-06-22",
    "count": 16,
    "level": 3
  }
]
```

Se tivesse de alguma forma conseguir retornar √† quantidade de cada a√ß√£o realizada no dia, era s√≥ juntar esses dados e contar.

>> Coment√°rio de Rafatcb:
√â uma sugest√£o interessante. Tem um issue com uma sugest√£o para termos um extrato dos TabCoins: https://github.com/filipedeschamps/tabnews.com.br/issues/1341. Acredito que se optarmos pela forma consolidada, facilitar√° as buscas no banco para realizarmos esse tipo de gr√°fico.

Vale lembrar que no GitHub, ao clicar em um quadrado, √© poss√≠vel ver os detalhes do dia. A√≠ j√° entra a preocupa√ß√£o em definir o que deve ser privado e o que pode ser p√∫blico. Talvez nada deva ser p√∫blico, mas podemos debater melhor isso.

>> Coment√°rio de mthmcalixto:
@marlonangeli coloquei embaixo do perfil e ficou bem interessante, @Rafatcb acredito que detalhar o que foi feito no dia n√£o seja t√£o importante assim, e sobre os ganhos de TabsCoins, acho que n√£o precisa ser colocado como "atividade";

![Screenshot_30](https://github.com/filipedeschamps/tabnews.com.br/assets/121470728/b60a99eb-edf9-4b6b-afe9-4ce3855ea498)
![Screenshot_31](https://github.com/filipedeschamps/tabnews.com.br/assets/121470728/ad882e33-199c-48c3-9750-ce5d0e56529b)

>> Coment√°rio de aprendendofelipe:
Essa ideia √© √≥tima candidata para ser desenvolvida e disponibilizada de forma totalmente independente, apenas utilizando dados da API p√∫blica.

Algo como o https://github.com/anuraghazra/github-readme-stats

>> Coment√°rio de mthmcalixto:
> Essa ideia √© √≥tima candidata para ser desenvolvida e disponibilizada de forma totalmente independente, apenas utilizando dados da API p√∫blica.
> 
> Algo como o https://github.com/anuraghazra/github-readme-stats

@aprendendofelipe sim, realmente iria fazer mais sentindo, apenas passando o **username** do usu√°rio do TabNews.

O mesmo autor do [React Activity Calendar](https://github.com/grubersjoe/react-activity-calendar) fez um API que retorna todos as atividades de um **username** do GitHub, [github-contributions-api](https://github.com/grubersjoe/github-contributions-api), talvez poderia criar algo semelhante na API do TabNews e ent√£o deixar que usem de forma independente o [React Activity Calendar](https://github.com/grubersjoe/react-activity-calendar).
</issue_1599_Tabela de atividades e contribui√ß√µes do usu√°rio>

<issue_1609_Problema com cadastro de usu√°rio novo.>
### Descri√ß√£o

Tentei me cadastrar essa manh√£ no tabnews pensando em talvez blogar por ali. 
Por√©m ao tentar concluir o cadastro houve algum erro que n√£o corresponde com a situa√ßao que tenho. 
![Screenshot_2024-01-23-06-54-55-53_3aea4af51f236e4932235fdada7d1643](https://github.com/filipedeschamps/tabnews.com.br/assets/77486864/cc510791-4386-4ddb-809b-4416560e77ef)
Ele pediu para verificar minha conex√£o no entanto j√° tentei de dois dispositivos diferentes em duas redes diferentes.

### Passos para reproduzir o problema

Tentar fazer o cadastro de um novo usu√°rio.

### Navegadores testados

Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@rafinha-dev, obrigado por reportar! üí™

A p√°gina de cadastro est√° com uma prote√ß√£o extra ativada, ent√£o √© necess√°rio que a Cloudflare execute uma verifica√ß√£o para liberar o envio dos dados de cadastro.

A verifica√ß√£o deveria acontecer automaticamente ao navegar para a p√°gina de cadastro, mas se j√° houver cache do JS dessa p√°gina no navegador, e a navega√ß√£o for SPA, a verifica√ß√£o n√£o ocorre, ent√£o o envio de dados do cadastro acaba sendo bloqueado.

Por enquanto, se o cadastro estiver sendo bloqueado, basta **atualizar a p√°gina de cadastro** (<kbd>F5</kbd>) que a verifica√ß√£o ir√° ocorrer, ent√£o ser√° poss√≠vel efetuar o cadastro. S√≥ que se passar de 5 minutos entre a atualiza√ß√£o da p√°gina e o envio dos dados, ter√° que atualizar novamente.

J√° estou fazendo testes com o [Turnstile da Cloudflare](https://developers.cloudflare.com/turnstile/) para a verifica√ß√£o ocorrer sempre que necess√°rio, mesmo pela navega√ß√£o SPA ou ap√≥s os 5 minutos de validade. Logo devo abrir o PR. üëç

>> Coment√°rio de rafinha-dev:
Opa, agora o cloudflare est√° pedindo para confirma√ß√£o antes de entrar na p√°gina, cadastro feito com sucesso üí™. 
Obrigado pela agilidade @aprendendofelipe
</issue_1609_Problema com cadastro de usu√°rio novo.>

<issue_1610_[FEAT] - Implementar ferramenta de Code Review | Codacy>
## Contexto

Para melhorar a qualidade do nosso c√≥digo e facilitar o processo de revis√£o de c√≥digo, precisamos de uma ferramenta de code review automatizada. A Codacy √© uma op√ß√£o que oferece essa funcionalidade e traz v√°rias vantagens para projetos de c√≥digo aberto:

1. **Padr√£o de qualidade de c√≥digo:** A Codacy pode ajudar a impor seu padr√£o de qualidade de c√≥digo.
2. **Economia de tempo em revis√µes de c√≥digo:** A Codacy pode economizar tempo nas revis√µes de c√≥digo, permitindo que os revisores se concentrem em aspectos mais complexos do c√≥digo.
3. **Melhores pr√°ticas de seguran√ßa:** A Codacy pode ajudar a aplicar as melhores pr√°ticas de seguran√ßa no seu c√≥digo.
4. **Integra√ß√£o com Git:** Ao se integrar com seu provedor Git, a Codacy mant√©m o controle do trabalho da sua equipe, analisa commits relevantes, destaca problemas, sugere melhorias e protege seu c√≥digo-base de altera√ß√µes indesejadas.
5. **Onboarding de desenvolvedores mais r√°pido:** A Codacy pode ajudar a integrar novos desenvolvedores mais rapidamente ao projeto.
6. **Gest√£o de d√≠vida t√©cnica e cobertura de c√≥digo:** Usar uma ferramenta de an√°lise de c√≥digo est√°tico como a Codacy mudar√° a forma como sua equipe lida com revis√µes de c√≥digo e PR, rastreia d√≠vida t√©cnica e cobertura de c√≥digo e gerencia a qualidade geral do seu c√≥digo.

## Proposta

Implementar a ferramenta de code review Codacy em nosso projeto. Isso envolver√° as seguintes etapas:

1. Criar uma conta na Codacy.
2. Configurar nosso reposit√≥rio no Codacy.
3. Configurar as regras de code review no Codacy de acordo com nossas diretrizes de codifica√ß√£o.
4. Integrar a Codacy com nosso sistema de integra√ß√£o cont√≠nua.

**Importante:** A configura√ß√£o dessa ferramenta deve ser feita por um dos mantenedores do projeto para garantir que as configura√ß√µes estejam alinhadas com as diretrizes do projeto.

## Crit√©rios de Aceita√ß√£o

- [ ] Conta na Codacy criada.
- [ ] Reposit√≥rio configurado no Codacy.
- [ ] Regras de code review configuradas.
- [ ] Codacy integrada com nosso sistema de integra√ß√£o cont√≠nua.

## Tarefas

- [ ] Criar conta na Codacy.
- [ ] Configurar reposit√≥rio no Codacy.
- [ ] Configurar regras de code review.
- [ ] Integrar Codacy com sistema de integra√ß√£o cont√≠nua.


## Exemplo
Algumas imagens do dashboard do codacy:

![codacy](https://imgur.com/3hhlJAE.png)
![codacy](https://imgur.com/wnTSmlJ.png)

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o bem detalhada, Emerson!

O que me chamou aten√ß√£o para esse issue agora √© que eu abri um PR resolvendo uns problemas apontados pelo DeepScan, e alguns problemas n√£o s√£o detect√°veis com ESLint em JavaScript (em TypeScript j√° seriam).

Resolvi testar o Codacy num fork do TabNews e vi que ele realmente apontou algo chato de perceber, como um link para um fragmento inv√°lido no Markdown ([regra MD051](https://github.com/codacy/codacy-markdownlint/blob/master/docs/description/MD051.md)).

Existem pontos debat√≠veis, como a proposta de usar no m√°ximo 80 caracteres na linha no Markdown ([regra MD013](https://github.com/codacy/codacy-markdownlint/blob/master/docs/description/MD013.md)). O racional por tr√°s dessa proposta √© que √© dif√≠cil trabalhar com linhas longas em alguns editores (o que √© verdade).

O ponto chato dessas ferramentas s√£o os falso-positivos, ent√£o √© interessante que ela tenha poucos para n√£o atrapalhar mais do que ajuda. Por exemplo, a regra _Unnecessary Block_ (JavaScript) tem 52 alertas em `try {`, `return {`, template string, atribui√ß√£o via desestrutura√ß√£o e at√© mesmo na abertura do corpo de uma fun√ß√£o com par√¢metros longos. N√£o analisei caso a caso, mas todos que vi eram falso-positivos. As regras de _NoSQL/SQL Injection_ tamb√©m parecem cair nesse caso de v√°rios falso-positivos.

O problema em desativar essas regras que tem muito falso-positivos √© que, se a regra de fato pegasse apenas o que deveria, seria bem √∫til.

Ser√° interessante testar novamente ap√≥s o merge do #1629, que inclui mais regras ESLint que j√° apontam problemas que o Codacy detectou.

N√£o testei a cobertura de c√≥digo para ver se √© a mesma coisa que o Jest consegue disponibilizar.

Voc√™ (ou outra pessoa) j√° usou o Codacy para opinar sobre o impacto no uso dele no dia-a-dia? Conhece outras ferramentas concorrentes?

>> Coment√°rio de Rafatcb:
Fiz mais um teste agora, j√° que a branch com atualiza√ß√µes do ESLint foi mesclada, analisando apenas a parte de **Quality** do Codacy. Desativei as seguintes regras porque continham muitos falso-positivos ou eram regras que n√£o pareciam relevantes para o nosso projeto:

*  `MD013` - Line length.
*  `MD033` - Inline HTML 
*  Security: Detect object injection 
*  Unnecessary Block 
*  rules_lgpl_javascript_database_rule-node-nosqli-injection 
*  javascript_pathtraversal_rule-non-literal-fs-filename (aqui poder√≠amos desabilitar em arquivos espec√≠ficos)
*  rules_lgpl_javascript_database_rule-node-sqli-injection 
*  node-postgres-sqli 
*  rules_lgpl_javascript_generic_rule-node-username 
*  Innaccurate Numeric Literal 
*  rules_lgpl_javascript_crypto_rule-node-insecure-random-generator 
*  insecure-document-method 

Veja, tem regras que seriam bem √∫teis, mas os avisos "errados" fazem com que n√≥s desativemos, e ent√£o a an√°lise de c√≥digo deixa de fazer sentido.

| Antes de desativar as regras | Depois de desativas as regras |
| --- | --- |
| ![204 issues](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/f7c9f341-904d-414d-ae52-d6d4d367eb0f)| ![70 issues](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/aa3e7764-4ac2-4947-9494-22781a6e411c) |

Diminuiu de 204 para 70 issues, mas s√≥ de entrar na p√°gina j√° percebi que tinha uma regra desativada que ainda estava presente na lista de issues. Veja tamb√©m que 60 issues s√£o de estilo de c√≥digo, ou seja, n√£o necessariamente √© algo errado.

Enfim, o que mais incomoda √© ter tanto trabalho para no fim ter apenas falso-positivos, ent√£o minha pergunta do coment√°rio anterior sobre relatos continua de p√©.

>> Coment√°rio de emerson-oliveira:
Na empresa usamos como uma ferramenta de valida√ß√£o de erros de seguran√ßa e boas pr√°ticas. Talvez fa√ßa sentido explorar o SonarCube com segunda op√ß√£o. E avaliar a ferramenta que faz mais sentido dentro das valida√ß√µes que consideram mais relevantes para o momento.
</issue_1610_[FEAT] - Implementar ferramenta de Code Review | Codacy>

<issue_1614_Migrar conta de Mailgun do `TabNews` para conta do `curso.dev`>
### Descri√ß√£o

## In√≠cio da conversa

Em conversa recente com a `Mailgun` (sistema que usamos para disparar emails transacionais tanto no `TabNews` quanto `curso.dev`), estava reclamando sobre a _entregabilidade_ de alguns emails, mais especificamente os `C√≥digos de Ativa√ß√£o` do curso que s√£o enviados no momento que uma pessoa faz a matr√≠cula. Ent√£o eles sugeriram eu passar pelo `Business Verification process`:

<img width="1397" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/53148494-61ce-4490-ba52-bcb59ad1c3cf">

## Problema de duas contas

Processo na qual passei e o `curso.dev` j√° est√° num pool melhor de IPs, por√©m detectaram que tenho **duas** contas no Mailgun e de fato, como expliquei ali em cima, usamos uma para cada servi√ßo. Expliquei que s√£o duas iniciativas separadas, mas fiquei inseguro com o que pode acontecer daqui para frente:

<img width="1387" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/9e20d974-5deb-4a85-ae14-37c5f444ea04">


### Sugest√£o de implementa√ß√£o

Sugiro migrarmos a conta de Mailgun do `TabNews` para dentro da conta do `curso.dev` para:

1) N√£o ter a conta cancelada do nada
2) Aproveitar do pool de IPs com maior reputa√ß√£o
3) Economizar uma mensalidade de `USD 35.00`, dado que eu pago mensalidade separada para as duas contas.

O que acham?

>> Coment√°rio de Rafatcb:
‚ÄúUsar uma √∫nica conta‚Äù significa que os e-mails enviados pelo curso.dev e pelo TabNews vir√£o do mesmo remetente?

Outra pergunta, o issue #1451 ser√° ‚Äúabortado‚Äù ou a medida proposta √© mais urgente e tempor√°ria, permanecendo at√© a implementa√ß√£o do Resend?

>> Coment√°rio de aprendendofelipe:
> ‚ÄúUsar uma √∫nica conta‚Äù significa que os e-mails enviados pelo curso.dev e pelo TabNews vir√£o do mesmo remetente?

N√£o @Rafatcb, s√≥ significa ter a mesma cota de uso.

>> Coment√°rio de aprendendofelipe:
Pelo volume atual envios mensais, n√£o vejo raz√£o para pagar pelas duas contas separadamente, ent√£o podemos migrar sim.

Sobre o processo de migra√ß√£o, para garantir que n√£o haja interrup√ß√µes no envio de e-mails, sugiro ativar temporariamente um servi√ßo alternativo pelo menos durante o processo de altera√ß√£o das configura√ß√µes de DNS e valida√ß√£o do dom√≠nio do TabNews na conta do Curso.dev

>> Coment√°rio de filipedeschamps:
Boa! Eu atropelei total aquela issue da Resend e n√£o considerei, erro meu! ü§ù 

Ent√£o estava pensando: talvez seja uma boa testar a Resend mesmo, at√© para ver na pr√°tica a qualidade do servi√ßo e as funcionalidades do painel. E como o @aprendendofelipe j√° criou os records de DNS, estamos na cara do gol, correto?

>> Coment√°rio de aprendendofelipe:
Correto @filipedeschamps, eu j√° tinha testado o Resend em homologa√ß√£o na √©poca, mas hoje testei de novo e est√° funcionando bem.

Ent√£o agora ativei o plano com o c√≥digo que o Zeno nos forneceu e j√° mudei as vari√°veis na Vercel.

S√≥ falta um redeploy para colocar o Resend em produ√ß√£o. Bora?

>> Coment√°rio de filipedeschamps:
Bora!

>> Coment√°rio de aprendendofelipe:
Ap√≥s testes delicinhas em produ√ß√£o üòâ, acho que est√° funcionando... s√≥ precisou pegar no tranco... üòÖ

Apenas o primeiro envio com o Resend resultou em erro. Foi um coment√°rio que fiz para o Rafa. At√© cheguei a fazer rollback ap√≥s o erro, mas quando vi pelo log do Resend que outro usu√°rio tinha criado outro coment√°rio instantes depois do meu,  e que o dele tinha funcionado, ent√£o voltei para o Resend e segue funcionando normalmente.

>> Coment√°rio de Rafatcb:
Hoje apaguei coment√°rios duplicados de +- 4 usu√°rios diferentes. A primeira ocorr√™ncia foi um coment√°rio "quadruplicado". N√£o investiguei a fundo, mas estou com a impress√£o de que, ao ocorrer um erro no envio do envio de e-amil (`sendReplyEmailToParentUser`), √© lan√ßada uma exce√ß√£o e ent√£o o usu√°rio recebe um erro (possivelmente 500) e acha que o coment√°rio n√£o foi publicado.

>> Coment√°rio de aprendendofelipe:
> Hoje apaguei coment√°rios duplicados de +- 4 usu√°rios diferentes. A primeira ocorr√™ncia foi um coment√°rio "quadruplicado". N√£o investiguei a fundo, mas estou com a impress√£o de que, ao ocorrer um erro no envio do envio de e-amil (`sendReplyEmailToParentUser`), √© lan√ßada uma exce√ß√£o e ent√£o o usu√°rio recebe um erro (possivelmente 500) e acha que o coment√°rio n√£o foi publicado.

Sim, √© exatamente isso que est√° ocorrendo. Um comportamento bem ruim por retornar o erro e mesmo assim criar a publica√ß√£o.

>> Coment√°rio de aprendendofelipe:
Mesmo os erros sendo bem espor√°dicos, eu estou achando melhor dar rollback e usar o Resend apenas enquanto estiver efetivamente migrando o dom√≠nio no Mailgun.

Em paralelo a gente tenta ver com o suporte do Resend se h√° algo mais para testarmos, e isso pode ser feito em homologa√ß√£o.

O que acham?

>> Coment√°rio de Rafatcb:
> O que acham?

Faz sentido para mim. Eu at√© pesquisei algo mas n√£o encontrei nada desses erros especificamente com o Resend.

>> Coment√°rio de aprendendofelipe:
O dom√≠nio do TabNews j√° foi migrado para a conta do Curso.dev no Mailgun. üöÄ

Ainda aguardo um retorno do suporte do Resend para ver se dou continuidade no #1451 pelo menos como conting√™ncia ou se abandonamos a ideia.

Fechando aqui ü§ù
</issue_1614_Migrar conta de Mailgun do `TabNews` para conta do `curso.dev`>

<issue_1619_Impedimento de postar conte√∫do>
### Descri√ß√£o

Ol√°, estou tentando enviar um post e recebo essa mensagem de erro quando tento publicar:

Requisi√ß√£o bloqueada pelo Firewall. Verifique seu equipamento e os dados enviados. cf-ray: 84ed89e71f051cd9-GRU

Tentei enviar pelo notebook usando navegador Opera e pelo celular usando o Google, ambos apresentaram o mesmo problema, mas o c√≥digo muda conforme o dispositivo e a tentativa.
![imagem_2024-02-01_191733007](https://github.com/filipedeschamps/tabnews.com.br/assets/99140216/3011531d-0ccd-49d0-b9fd-9602f214a67d)


### Passos para reproduzir o problema

Tentar enviar um post

### Navegadores testados

Outro

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de banridev:
Verifiquei todo texto escrito e n√£o h√° nenhum dado que esteja mal formatado ou que n√£o seja autorizado. No conte√∫do tem links (CS50) e blocos de c√≥digos em C sobre um exerc√≠cio de l√°

>> Coment√°rio de aprendendofelipe:
@banridev obrigado por reportar! üí™

Algum c√≥digo presente na sua publica√ß√£o est√° sendo bloqueado pela Cloudflare.

Para comprovar se √© isso, tente criar a mesma publica√ß√£o sem o t√≠tulo, e deve dar o mesmo erro. Em seguida, altere sua publica√ß√£o para um texto simples qualquer, mantendo sem o t√≠tulo, e a requisi√ß√£o deve passar normalmente e apenas devolver o erro pela falta do t√≠tulo.

Se for isso mesmo, voc√™ pode ir testando sem preencher o t√≠tulo at√© encontrar o que no texto da sua publica√ß√£o est√° bloqueando a requisi√ß√£o.

>> Coment√°rio de banridev:
Boa noite, desculpa a demora para responder.

Tentarei reenviar amanh√£, hoje, infelizmente n√£o tive tempo.
Se funcionar, j√° deixo meu obrigado!
Qualquer coisa eu volto aqui.

>> Coment√°rio de banridev:
Boa tarde, substitui todo o c√≥digo por prints do CodeSnap e fiz upload do c√≥digo Pastebin para que, quem quiser, puder copiar o c√≥digo e testar no pr√≥prio pc, mas ainda n√£o funcionou.

A mesma mensagem de erro continua: Requisi√ß√£o bloqueada pelo Firewall. Verifique seu equipamento e os dados enviados. cf-ray: 8504b601bb391ac8-GRU

J√° alterei o t√≠tulo e modifiquei o texto, o que pode ser?

>> Coment√°rio de banridev:
Observe o c√≥digo:

![Exerc√≠cio](https://i.ibb.co/CWNkfhR/code.png "Exerc√≠cio")

![Exerc√≠cio](https://i.ibb.co/dcy51mw/code.png "Exerc√≠cio")

![Exerc√≠cio](https://i.ibb.co/ykpBFWy/code.png "Exerc√≠cio")

![Exerc√≠cio](https://i.ibb.co/5MhNgJz/imagem-2024-02-04-142017918.png "Exerc√≠cio")

![Exerc√≠cio](https://i.ibb.co/DQbZN9q/code.png "Exerc√≠cio")

Antes estava usando o Bloco de C√≥digo

>> Coment√°rio de aprendendofelipe:
Tentou publicar um texto simples s√≥ para testar?

>> Coment√°rio de banridev:
> Tentou publicar um texto simples s√≥ para testar?

Sem "conte√∫do" algum? Apenas uma frase, por exemplo?

>> Coment√°rio de aprendendofelipe:
> > Tentou publicar um texto simples s√≥ para testar?
> 
> Sem "conte√∫do" algum? Apenas uma frase, por exemplo?

Isso

>> Coment√°rio de banridev:
Vou tentar aqui, 1 minuto

>> Coment√°rio de banridev:
Funcionou agora

>> Coment√°rio de aprendendofelipe:
Ent√£o tem algo que a Cloudflare est√° considerando inseguro na sua publica√ß√£o... Pode ser no t√≠tulo ou fonte tamb√©m

>> Coment√°rio de banridev:
Entendi

T√≠tulo: Como um simples exerc√≠cio de fun√ß√£o fez eu quebrar a cabe√ßa o dia inteiro
links: 
https://cs50.harvard.edu/x/2023/weeks/
https://cs50.harvard.edu/x/2023/problems/1/half/
cs50.dev
https://pastebin.com
https://imgbb.com

Al√©m disso, tem um "wget https://cdn.cs50.net/2022/fall/labs/1/half.c"

>> Coment√°rio de aprendendofelipe:
> Entendi
> 
> T√≠tulo: Como um simples exerc√≠cio de fun√ß√£o fez eu quebrar a cabe√ßa o dia inteiro links: https://cs50.harvard.edu/x/2023/weeks/ https://cs50.harvard.edu/x/2023/problems/1/half/ cs50.dev https://pastebin.com https://imgbb.com
> 
> Al√©m disso, tem um "wget https://cdn.cs50.net/2022/fall/labs/1/half.c"

Nada nessa mensagem acima seria bloqueado... Se n√£o conseguir isolar o problema, posta o texto completo aqui

>> Coment√°rio de banridev:
Este √© o texto sem os "Bloco de C√≥digo", mas se tivesse, seria igual as imagens.

Ol√°, estou estudando o [CS50 de Harvard 2023](https://cs50.harvard.edu/x/2023/weeks/) e decidi fazer alguns exerc√≠cios da Semana 1 (C). O exerc√≠cio se chama "Half" e voc√™ pode encontr√°-lo [aqui](https://cs50.harvard.edu/x/2023/problems/1/half/).
---
### Algumas informa√ß√µes e dicas que o exerc√≠cio d√°
Esse exerc√≠cio foi realmente desafiador e tem algumas 'metas de aprendizagem', que seria trabalhar com diferentes tipos de dados, praticar convers√£o de tipos, usar opera√ß√µes matem√°ticas e criar uma fun√ß√£o com par√¢metros de entrada e valor de retorno.

A descri√ß√£o diz o seguinte: "Suponha que voc√™ esteja comendo fora em um restaurante com um amigo e queira dividir a conta igualmente. Voc√™ pode querer antecipar o valor devido antes que a fatura chegue com o imposto adicionado. Neste problema, voc√™ completar√° uma fun√ß√£o para calcular o valor que cada um de voc√™s deve com base no valor da conta, no imposto e na gorjeta."

As dicas s√£o:
- Observe que o imposto e a gorjeta s√£o inseridos como porcentagens. Voc√™ pode querer alter√°-los para valores decimais antes de calcular o total.
- Como a dica √© inserida como `int`, lembre-se de que se voc√™ dividir um `int` por um `int` voc√™ receber√° um `int`!
- A ordem das opera√ß√µes aqui √© exatamente a mesma da √°lgebra, onde a multiplica√ß√£o e a divis√£o s√£o realizadas antes da adi√ß√£o e da subtra√ß√£o.

Essas dicas s√£o boas, especificamente a segunda, pois como vamos utilizar porcentagens, n√£o podemos trabalhar com n√∫meros inteiros na hora de dividir (10 / 100 = 0).

---
Se voc√™ quiser tentar resolver esse exerc√≠cio, acesse: [CS50](https://cs50.dev) no Google Chrome e fa√ßa login com o GitHub.
1. Clique dentro da janela do terminal e execute `cd`.
2. No $prompt, digite `mkdir half`
3. Agora execute `cd half`
4. Em seguida, copie e cole `wget https://cdn.cs50.net/2022/fall/labs/1/half.c` em seu terminal para baixar o c√≥digo de distribui√ß√£o do laborat√≥rio.
5. Voc√™ deve completar a fun√ß√£o, `half` que calcula exatamente metade da conta ap√≥s a adi√ß√£o de impostos e gorjetas, e retorna esse valor.
---
## O exerc√≠cio
Abrindo o arquivo gerado, este √© c√≥digo que teremos que modificar:


![Exerc√≠cio](https://i.ibb.co/CWNkfhR/code.png "Exerc√≠cio")
[Copie o c√≥digo](https://pastebin.com/MShaTx05)

Se tentar testar o c√≥digo: digite `make half` e depois `./half`. Digite os valores para as perguntas e voc√™ ver√° que o resultado ser√° `You will owe 0.00 each!`

Vamos precisar resolver alguns problemas e neste exerc√≠cio deve usar fun√ß√£o criada. Por termos que modificar a fun√ß√£o, por enquanto, esqueceremos a main.

Primeiro, vamos entender algumas coisas nesse c√≥digo, afinal est√° em ingl√™s. Bill significa fatura (e eu fiquei um tempo tentando entender quem era Bill), tax √© o imposto a ser pago e tip √© a gorjeta. Ent√£o n√≥s temos uma fatura que recebe um valor x, que est√° sem imposto e sem gorjeta. Nosso trabalho √© adicionar um imposto sobre essa nossa fatura e depois a gorjeta, somente depois dividir entre "eu" e o amigo.


No c√≥digo, vamos transformar as porcentagens em decimal e, lembrem-se da dica 2, que se dividir um inteiro por outro inteiro, teremos um inteiro, logo, usaremos o `float`, tanto para dividir o imposto e a gorjeta. Ficar√° assim:

![Exerc√≠cio](https://i.ibb.co/dcy51mw/code.png "Exerc√≠cio")
[C√≥digo](https://pastebin.com/F2YhnA0H)

O pr√≥ximo passo ser√° calcular o imposto e taxa sobre a nossa fatura e ap√≥s isso dividir:


![Exerc√≠cio](https://i.ibb.co/ykpBFWy/code.png "Exerc√≠cio")
[C√≥digo](https://pastebin.com/PWN9jALF)

At√© ent√£o, fizemos tudo o que o exerc√≠cio prop√¥s: convertemos inteiro para decimal (float), adicionamos o imposto na fatura primeiro que a gorjeta (o exerc√≠cio pedia para ser nessa ordem) e por fim, divimos a conta igualmente. Se tentarmos compilar e testar vai dar erro:

![Exerc√≠cio](https://i.ibb.co/5MhNgJz/imagem-2024-02-04-142017918.png "Exerc√≠cio")

Foi nesse ponto que eu estagnei, n√£o conseguia achar uma solu√ß√£o por conta pr√≥pria, pesquisei e vi que tem v√≠deos explicando e respostas no Stack OverFlow e Reddit, por exemplo. Inclusive, alguns c√≥digos que estavam diferentes do meu, mas com a base semelhante, foi bom ver que havia mais de uma l√≥gica al√©m da minha. Por√©m, ainda n√£o tinha entendido o que estava errado, at√© perceber que a linha errada.

`float half(float bill, float tax, int tip)`

O correto, nesse caso, seria:

`float half(float bill_amount, float tax_percent, int tip_percent)`

Agora, se compilarmos novamente, funcionar√°. Inclusive, se testar os exemplos que tem na p√°gina do exerc√≠cio, todos funcionar√£o. Nosso c√≥digo no final ficar√° assim:

![Exerc√≠cio](https://i.ibb.co/DQbZN9q/code.png "Exerc√≠cio")
[C√≥digo](https://pastebin.com/0EXKNMzP)

---
## D√∫vida
Agora uma d√∫vida para quem conhece a Linguagem C: observem a linha 7, ela deveria ser igual a linha 19 ou n√£o? Afinal os par√¢metros s√£o diferentes, no meu ponto de vista: bill √© diferente de bill_amount, tax √© diferente de tax_percent e tip √© diferente de tip_percent.
Se der, me tirem essa d√∫vida tamb√©m.

Obrigado e at√© a pr√≥xima!

>> Coment√°rio de Rafatcb:
Testei com seu texto e o problema √© na parte do `wget`. Se voc√™ enviar essa parte com um espa√ßo entre o acento grave e o `wget`, funciona:

```md
` wget https://cdn.cs50.net/2022/fall/labs/1/half.c`
```

Se enviar formatado numa linha separada tamb√©m funcionar√°:

```md
    ```
    wget https://cdn.cs50.net/2022/fall/labs/1/half.c
    ```
```

(n√£o precisa dos espa√ßos no in√≠cio das linhas, s√≥ usei para conseguir renderizar aqui no markdown)

>> Coment√°rio de banridev:
Muito obrigado. Voc√™ me ajudou muito e ainda tomei seu tempo.

consegui postar no TN.

Sucesso e bom domingo!

>> Coment√°rio de Rafatcb:
> Muito obrigado. Voc√™ me ajudou muito e ainda tomei seu tempo.

Acho que voc√™ me confundiu com o @aprendendofelipe. Eu s√≥ fiz o √∫ltimo coment√°rio :sweat_smile: 

De toda forma, estamos aqui para ajudar. Fico feliz que voc√™ conseguiu fazer sua publica√ß√£o. Obrigado pela paci√™ncia!

>> Coment√°rio de banridev:
Pois √©, acabei n√£o percebendo. De qualquer forma, um obrigado aos dois!
</issue_1619_Impedimento de postar conte√∫do>

<issue_1627_Barra de scroll sobrepondo o modal de confirma√ß√£o.>
### Descri√ß√£o

Eu encontrei um problema na p√°gina de publica√ß√£o enquanto testava o editor de MarkDown e ao clicar em cancelar a janela exibida est√° sobreposta pelo scrollbar quando o modo "Escrever apenas" est√° desativado.

![Captura-de-tela-2024-02-16 as 14 46 38](https://github.com/filipedeschamps/tabnews.com.br/assets/28519360/4283c2ac-24c3-4a3f-a9e0-77d3937734f2)


### Passos para reproduzir o problema

1. Logado v√° at√© o URL https://www.tabnews.com.br/publicar
2. Escreve o suficiente para que haja scroll
3. Clique no bot√£o "Sair apenas do modo Escrever"
![Captura-de-tela-2024-02-16 as 14 53 17](https://github.com/filipedeschamps/tabnews.com.br/assets/28519360/caa49060-4ca1-44ac-95b7-29e408879e25)
4. Clique no bot√£o "Cancelar"

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

Atribuir z-index maior para o alerta ou menor para a classe usado pelo ByteMD no controle daquele scroll em espec√≠fico

>> Coment√°rio de Rafatcb:
Obrigado por reportar o problema, @GuiHSilva!

N√£o √© sempre que isso acontece. Um `Dialog` precisa aparecer alguma vez, navegar e ent√£o exibi-lo novamente. Isso porque a `div#__primerPortalRoot__` n√£o √© removida depois de criada, ent√£o a diferen√ßa passa a ser onde o `Dialog` √© renderizado no DOM. Provavelmente esse comportamento surgiu na vers√£o v36.5.0 do Primer.

| Sem problema | Com problema |
| --- | --- |
| ![No fim do DOM](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/41b63880-0735-4616-acaf-0130c72a5c9b) | ![No in√≠cio do DOM](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/65ac33a8-d778-463c-9d43-6118599e3191) |

N√£o encontrei uma solu√ß√£o para deixar a `div` sempre no fim e nem para estilizar, sem fazer uso de "gambiarras".

>> Coment√°rio de Rafatcb:
Pessoal, n√£o mexi nesse issue por quest√µes de tempo/prioridade, mas quando o vi, criei um exemplo m√≠nimo para reproduzir o problema e criei um issue no reposit√≥rio do Primer: https://github.com/primer/react/issues/4280

Eles est√£o abertos a receber uma corre√ß√£o l√°, ent√£o √© mais adequado abrir um PR no reposit√≥rio `primer/react` para depois atualizar a depend√™ncia aqui. O problema est√° [nesse trecho de c√≥digo](https://github.com/primer/react/blob/4b823ff237235564900aeadb81713e984676c5ad/packages/react/src/ConfirmationDialog/ConfirmationDialog.tsx#L151-L157). √â uma √≥tima oportunidade de contribuir em um projeto que usamos tanto no TabNews.
</issue_1627_Barra de scroll sobrepondo o modal de confirma√ß√£o.>

<issue_1630_Retornar resposta da cria√ß√£o de conte√∫do independente do resultado da notifica√ß√£o>
### Descri√ß√£o

Ao criar um novo conte√∫do (`POST /api/v1/contents`), o backend realiza o `commit` da transa√ß√£o e depos envia uma notifica√ß√£o por e-mail. Quando ocorre um erro nessa etapa, o usu√°rio √© alertado que o conte√∫do n√£o foi criado (o que n√£o √© verdade), e pode acabar criando o mesmo conte√∫do v√°rias vezes.

https://github.com/filipedeschamps/tabnews.com.br/blob/60769894251259449bc7f2c964a706955a57557c/pages/api/v1/contents/index.public.js#L170-L175 

### Passos para reproduzir o problema

Em ambiente de desenvolvimento:

1. Modifique a fun√ß√£o `sendReplyEmailToParentUser` para lan√ßar um erro (pode adicionar um `throw new Error()`).
2. Crie um coment√°rio em alguma publica√ß√£o.
3. Voc√™ receber√° uma mensagem de que um erro inesperado ocorreu, mas o coment√°rio ter√° sido criado (sem voc√™ saber).

Em ambiente de homologa√ß√£o/produ√ß√£o, isso s√≥ ocorre quando h√° um problema no envio de e-mail.

### Poss√≠vel solu√ß√£o

Creio que o mais adequado seja n√£o esperar pelo envio de e-mail para responder a requisi√ß√£o. Talvez seja poss√≠vel utilizar o [`waitUntil`](https://vercel.com/docs/functions/edge-middleware/middleware-api#waituntil) para isso, mas n√£o tenho certeza.

>> Coment√°rio de aprendendofelipe:
> Creio que o mais adequado seja n√£o esperar pelo envio de e-mail para responder a requisi√ß√£o. Talvez seja poss√≠vel utilizar o [`waitUntil`](https://vercel.com/docs/functions/edge-middleware/middleware-api#waituntil) para isso, mas n√£o tenho certeza.

Acho que `waitUntil` s√≥ funcionaria na Edge.

Se a ideia √© responder r√°pido com o sucesso na publica√ß√£o, mas manter a lambda rodando para continuar o envio do email, acho que teria que usar *stream*.

Tem tamb√©m outras melhorias que podem ser feitas:

- Processar o envio de email em paralelo ao `filterOutput`.
- Capturar o erro no envio de email e apenas disparar para nosso monitoramento, mas sem retornar o erro para o usu√°rio.
- Configurar um servi√ßo de conting√™ncia para ser usado automaticamente sempre que o principal retornar algum erro. Capturando o erro tamb√©m para o monitoramento.

Sobre um servi√ßo alternativo, o suporte do Resend me respondeu que identificou a causa dos problemas intermitentes que tivemos, e que uma solu√ß√£o seria implementada. Pode ser um bom teste se configurarmod o Resend como principal e o Mailgun como conting√™ncia.

>> Coment√°rio de Rafatcb:
> Acho que `waitUntil` s√≥ funcionaria na Edge.

√â para a Edge, sim. Eu estava em d√∫vida se us√°vamos Edge, serverless ou outra coisa.

As melhorias que voc√™ prop√¥s tamb√©m s√£o √≥timas.

>> Coment√°rio de ErickCReis:
Faz sentido implementar um sistema de fila/mensagens para ficar respons√°vel pelo envio desses emails? A Upstash tem um servi√ßo legal, o [QStash](https://upstash.com/docs/qstash/overall/getstarted), que deve funcionar bem nesse cen√°rio.

---

Comecei a dar uma olhada nessa op√ß√£o e s√≥ para deixar "anotado" encontrei duas op√ß√µes para conseguir utilizar o QStash no ambiente de desenvolvimento sem depender de uma conta:
- [Bunnygram](https://bunnygram.vercel.app/)
- [qstash-simulator](https://github.com/vincentserpoul/qstash-simulator)

>> Coment√°rio de Rafatcb:
Uma fila pode ser √∫til, tendo em vista que futuramente teremos notifica√ß√µes pelo site (https://github.com/filipedeschamps/tabnews.com.br/issues/738), e a fila pode ajudar a garantir/aumentar as chances de entrega da notifica√ß√£o, dependendo de como for implementada. Estou apenas palpitando porque n√£o tenho experi√™ncia pr√°tica com filas.

>> Coment√°rio de mthmcalixto:
@Rafatcb isso aqui pode ser resolvido em https://github.com/filipedeschamps/tabnews.com.br/pull/1701?

>> Coment√°rio de Rafatcb:
@mthmcalixto este issue foi resolvido no PR #1632, enviando a resposta por stream antes do envio do e-mail. Ainda n√£o tive tempo para rever o seu PR, mas suponho que esse problema n√£o tenha voltado.

>> Coment√°rio de Rafatcb:
O Next 15 (RC) anunciou uma fun√ß√£o chamada [`after`](https://rc.nextjs.org/docs/app/api-reference/functions/unstable_after), que ainda est√° em fase experimental.

Estou colocando a label `repescar` no issue para lembrarmos de verificar quando ficar est√°vel. Se funcionar, creio que n√£o precisar√≠amos mais do streaming da resposta.
</issue_1630_Retornar resposta da cria√ß√£o de conte√∫do independente do resultado da notifica√ß√£o>

<issue_1631_[Feature/Melhoria] Migrar do Jest para Vitest>
### Descri√ß√£o

Hoje o TabNews conta com uma quantidade de testes relativamente grande, e como a maior parte deles s√£o testes de integra√ß√£o rodar todos eles acaba demorando alguns minutos, isso impacta n√£o somente o desenvolvimento mas tamb√©m o ambiente de CI.

Com certeza podemos melhorar o fluxo de testes para agilizar alguma coisa, mas provavelmente n√£o deve ser algo simples. 

O [Vitest](https://vitest.dev/) compartilha praticamente a mesma API do Jest por√©m consegue ser muito mais r√°pido.

---

Fiz essa migra√ß√£o no meu [fork do TabNews](https://github.com/ErickCReis/tabnews.com.br/pull/1) e a [action](https://github.com/ErickCReis/tabnews.com.br/actions/runs/7859337643) demorou 2m 8s para finalizar, hoje esse tempo fica na faixa dos 4m.

Se for uma mudan√ßa que faz sentido para o TabNews posso abrir o PR para mostrar os detalhes do processo de migra√ß√£o.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Erick, obrigado pela sugest√£o e pela implementa√ß√£o no seu fork! Nunca usei o Vitest mas j√° ouvi falar bem, e pelos resultados que voc√™ obteve, parece ser uma √≥tima troca.

Estamos adicionando o `eslint-plugin-jest` no PR https://github.com/filipedeschamps/tabnews.com.br/pull/1629, mas imagino que precisar√≠amos trocar pelo [`eslint-plugin-vitest`](https://www.npmjs.com/package/eslint-plugin-vitest). Consegue confirmar essa informa√ß√£o?

Seria interessante tamb√©m testar [isso](https://github.com/filipedeschamps/tabnews.com.br/pull/1611#discussion_r1488348135). Tenho suspeitas que o Vitest lidaria bem com esse cen√°rio, diferente do Jest.

>> Coment√°rio de ErickCReis:
Fiquei meio sem tempo esses √∫ltimos dias, assim que poss√≠vel fa√ßo esses testes @Rafatcb .

Se por acaso outra pessoa quiser seguir com essa melhoria, pode ficar a vontade em pegar o que j√° implementei, a minha branch j√° est√° desatualizada e deve precisar de alguns ajustes depois da sincroniza√ß√£o com a main.

>> Coment√°rio de ErickCReis:
> Estamos adicionando o `eslint-plugin-jest` no PR #1629, mas imagino que precisar√≠amos trocar pelo [`eslint-plugin-vitest`](https://www.npmjs.com/package/eslint-plugin-vitest). Consegue confirmar essa informa√ß√£o?

Sim, foi necess√°rio fazer a troca, existem diferen√ßas entre as regras, mas preferi manter as configura√ß√µes recomendas.

> Seria interessante tamb√©m testar [isso](https://github.com/filipedeschamps/tabnews.com.br/pull/1611#discussion_r1488348135). Tenho suspeitas que o Vitest lidaria bem com esse cen√°rio, diferente do Jest.

Funcionou sem problema, s√≥ foi necess√°rio adicionar um depend√™ncia que lida com os _path alias_ do jsconfig.json

---

Atualizei minha branch e abri o PR com a troca.

Essa foi a diferen√ßa de tempo das actions:

<img width="1074" alt="Captura de Tela 2024-03-04 √†s 21 38 28" src="https://github.com/filipedeschamps/tabnews.com.br/assets/30873873/50de22aa-117e-4b77-b357-847fe8edd236">
</issue_1631_[Feature/Melhoria] Migrar do Jest para Vitest>

<issue_1634_[feat | Melhoria] - Adicionar aba de notifica√ß√µes que avisa quando algu√©m respondeu algum post seu ou a um comet√°rio.>
### Descri√ß√£o

Eu acho que seria interessante uma feature de notifica√ß√£o que avisa o usu√°rio que algu√©m comentou no seu post ou respondeu algum coment√°rio do usu√°rio. Pesquisei e n√£o vi sugest√£o parecida nas issues.

Tive esse problema ontem, algu√©m respondeu um post meu e s√≥ descobri por acaso quando fui visualizar meu post.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@Dione-b, obrigado pela sugest√£o! üí™

Vou fechar ela como duplicidade com a #738, ok? ü§ù

Ontem, no in√≠cio da tarde, experimentamos uma interrup√ß√£o nas notifica√ß√µes por e-mail devido a problemas com o Mailgun.

Para resolver a quest√£o, fizemos a migra√ß√£o para o Resend.

>> Coment√°rio de Dione-b:
> @Dione-b, obrigado pela sugest√£o! üí™
> 
> Vou fechar ela como duplicidade com a #738, ok? ü§ù
> 
> Ontem, no in√≠cio da tarde, experimentamos uma interrup√ß√£o nas notifica√ß√µes por e-mail devido a problemas com o Mailgun.
> 
> Para resolver a quest√£o, fizemos a migra√ß√£o para o Resend.

Ah sim. Eu li por alto a issue e imaginei notifica√ß√£o apenas por email, desculpe pela falta de aten√ß√£o.
</issue_1634_[feat | Melhoria] - Adicionar aba de notifica√ß√µes que avisa quando algu√©m respondeu algum post seu ou a um comet√°rio.>

<issue_1636_[BUGFIX] Dialog de busca n√£o acompanha o color theme>
### Descri√ß√£o

![Captura de tela de 2024-02-25 11-22-22](https://github.com/filipedeschamps/tabnews.com.br/assets/67348001/194d8330-5008-45ae-99eb-1b52107a6484)
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/67348001/04e4890c-6c0f-4ff1-87b9-9ac0fbadf250)

Ao navegar pelo Tabnews percebi que a caixa de dialog do buscador n√£o est√° acomphando o color scheme (est√° setado unicamente para light), assim como tamb√©m apresenta algumas inconsist√™ncias no estilo (e.g. o √≠cone de close est√° levemente diferente do utilizado no componente de dialog em outras partes do sistemas). 

Numa busca simples n√£o consegui encontrar nenhuma issue relatando isso, e ao olhar o c√≥digo percebi que as configura√ß√µes est√£o for√ßando o estilo para "light" mesmo quando trocamos o tema para "dark". 

Gostaria de saber se isso √© um problema ou se h√° alguma raz√£o mais detalhada do porqu√™ estar assim. Caso seja necess√°rio corrigir posso cuidar disso em uma PR ap√≥s a confirma√ß√£o.

### Passos para reproduzir o problema

1. Entre na plataforma no tema "light" e clique na caixa de pesquisa
2. Troque para o tema "dark" e clique na caixa de pesquisa


### Navegadores testados

Chrome, Firefox

### Poss√≠vel solu√ß√£o

Ao inv√©s de setar os estilos unicamente para "light" poderia se utilizar o estilo computado no `useTheme` e deixar a mudan√ßa mais din√¢mica. Talvez tamb√©m seja necess√°rio refatorar algumas coisas do componente `SearchBox`

>> Coment√°rio de Rafatcb:
Gabriel, obrigado pela sugest√£o!

No PR de cria√ß√£o da barra de pesquisa, o Felipe Barso criou um coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/pull/1472#issuecomment-1636227427) explicando o motivo de n√£o ter feito o modo escuro, mas acredito que fa√ßa sentido manter o issue aberto, porque, como foi dito em https://github.com/filipedeschamps/tabnews.com.br/pull/1472#issuecomment-1639005029, aceitamos PRs com essa corre√ß√£o :+1:

> Se algu√©m quiser criar uma estiliza√ß√£o diferente para a busca em modo escuro, √© s√≥ enviar o PR üí™

>> Coment√°rio de aprendendofelipe:
@eng-gabrielscardoso, obrigado pela issue! üí™

@Rafatcb, acredito que seja melhor fechar a issue para n√£o darmos a entender que incentivamos algum PR relacionado.

Se um PR for aberto, ser√° revisado, mas essa busca foi implementada de maneira propositalmente simples por ser um experimento de coleta de dados para uma implementa√ß√£o futura, algo que n√£o est√° nos planos de curto prazo.

Se concordar, pode fechar ü§ù
</issue_1636_[BUGFIX] Dialog de busca n√£o acompanha o color theme>

<issue_1637_[FRONTEND] Cria√ß√£o de Figma unificado>
### Descri√ß√£o

Creio que para melhorar o processo de desenvolvimento do frontend, seria interessante a cria√ß√£o de um Figma unificado, onde se estruturar, prototipar, votar e implementar novas p√°ginas para o sistema

E.g. atualmente acredito que seria muito bom fazer uma atualiza√ß√£o da p√°gina principal de not√≠cias, ent√£o um Figma para isso seria muito bom para:

1. Quem for implementar n√£o perder tempo ou trabalho caso n√£o seja aceito
2. Haja uma transpar√™ncia no que est√° sendo desenvolvido e o caminho para o qual a UI do sistema est√° indo

### Sugest√£o de implementa√ß√£o

Deixo a cargo dos coment√°rios nessa issue

>> Coment√°rio de Rafatcb:
Gabriel, obrigado pela sugest√£o!

J√° surgiram algumas sugest√µes para mudar a interface, mas acho muito improv√°vel isso acontecer, porque uma mudan√ßa grande exige um esfor√ßo maior no desenvolvimento e tamb√©m √© algo muito pessoal: existir√£o pessoas que apontar√£o a interface nova como "melhor", e outras como "pior". √â mais palp√°vel lidarmos com sugest√µes espec√≠ficas onde h√° uma melhoria clara na UI/UX. De toda forma, existe o issue https://github.com/filipedeschamps/tabnews.com.br/issues/951 falando sobre "uma nova interface", que recebeu feedback apenas na √©poca de lan√ßamento do TabNews.

Sobre a sugest√£o de usar o Figma para concentrar a vota√ß√£o e prototipa√ß√£o, acho que n√£o precisamos disso. Como dificilmente ser√° implementada uma mudan√ßa radical, n√£o h√° necessidade de prototipar no Figma toda a interface que o TabNews tem hoje, basta realizar uma sugest√£o mudando o pr√≥prio HTML ou usando alguma ferramenta para transmitir a ideia para as outras pessoas, at√© mesmo o Paint pode servir.

Assim, podemos compartilhar as imagens num issue espec√≠fico do GitHub e os usu√°rios podem reagir e sugerir melhorias. Um exemplo onde isso ocorreu foi no issue https://github.com/filipedeschamps/tabnews.com.br/issues/1510 (ainda n√£o conclu√≠do).

Ent√£o, vou fechar esse issue como n√£o planejado, ok? Mais uma vez, obrigado pela sugest√£o e pelo carinho com o TabNews!
</issue_1637_[FRONTEND] Cria√ß√£o de Figma unificado>

<issue_1639_Visualiza√ß√£o de Diagrama Mermaid bugada em dispositivos m√≥veis>
### Descri√ß√£o

No dia 26/02/2024, publiquei o post [[D√∫vida] Qual a melhor estrat√©gia para reutilizar c√≥digo em diferentes projetos?](https://www.tabnews.com.br/marlon/duvida-qual-a-melhor-estrategia-para-reutilizar-codigo-em-diferentes-projetos), ap√≥s publicar fui dar uma √∫ltima revisada para conferir se estava tudo certinho, por√©m a visualiza√ß√£o no celular estava bugada, eu escrevi a publica√ß√£o pelo PC, tanto ao escrever quanto para visualizar n√£o houve problemas, por√©m no celular sim, testei tamb√©m em um Tablet (Samsung Galaxy Tab S7 FE) e n√£o houve erros.
Utilizo um Web App instalado utilizando o Google Chrome, e testei tamb√©m no Microsoft Edge, abaixo tem um v√≠deo reproduzindo o bug visual:

https://github.com/filipedeschamps/tabnews.com.br/assets/73134662/f900588e-2052-440d-a39b-a06b75808309

Ao abrir o post pela primeira vez ou recarregar a p√°gina, partes da p√°gina ficam repetidas e cortadas, por√©m ao fechar e abrir, o conte√∫do volta a ser exibido normalmente.

---

**Dispositivo:**
- Xiaomi Poco X3 GT
- Android 13 TP1A.220624.014
- MIUI Global 14.0.5
- Chrome 122.0.6261
- Edge 121.0.2277.133 

### Passos para reproduzir o problema

1. Em um dispositivo Android, acessar o post [[D√∫vida] Qual a melhor estrat√©gia para reutilizar c√≥digo em diferentes projetos?](https://www.tabnews.com.br/marlon/duvida-qual-a-melhor-estrategia-para-reutilizar-codigo-em-diferentes-projetos)
2. Recarregue a p√°gina
3. Abra o hist√≥rico de apps abertos e abra novamente o navegador com o post aberto

### Navegadores testados

Chrome, Microsoft Edge

### Poss√≠vel solu√ß√£o

Uso o TabNews no celular h√° meses e nunca tive um bug desse tipo, eu chuto ser os diagramas Mermaid junto com alguma estiliza√ß√£o para o tamanho da tela, j√° que tanto no PC como no Tablet a visualiza√ß√£o est√° normal.

>> Coment√°rio de aprendendofelipe:
@marlonangeli, obrigado por reportar! üí™

O problema ocorre apenas em um dos seus dispositivos? Alguma chance de ser um problema recente com esse dispositivo espec√≠fico? Eu ainda n√£o consegui reproduzir.

Uma informa√ß√£o importante √© que j√° h√° mais de 10 meses desde a √∫ltima atualiza√ß√£o do visualizador de markdown (e do plugin Mermaid).

Agrade√ßo muito se puder fazer mais testes e trazer mais dados. ü§ù

N√£o sei se √© um defeito apenas da grava√ß√£o de tela, mas no v√≠deo √© poss√≠vel ver o mesmo bug ocorrendo com o texto, ent√£o n√£o deve ter rela√ß√£o com os diagramas Mermaid.

Est√° acontecendo apenas com o TabNews? Repare nestes dois pontos do seu v√≠deo:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/7c691dd8-2969-44c9-8a34-e1928e3cdb88)

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/957d2efa-b58d-4666-a12f-cffa76492072)

>> Coment√°rio de Rafatcb:
Eu j√° reparei um problema similar que acontece apenas em dispositivos m√≥veis no Safari (n√£o tenho Mac para testar no PC), com o √≠cone de "ir para o topo". Quando isso acontece, tem a ver com o menu de navega√ß√£o inferior sumindo e aparecendo conforme os gestos feitos.

Eu n√£o consegui reproduzir o problema desse issue, e n√£o sei se tem a mesma causa do que mencionei acima.

>> Coment√°rio de marlonangeli:
Testei novamente aqui, agora tem apenas alguns "engasgos" no in√≠cio, mas ao clicar no bot√£o do usu√°rio voltam a ter os mesmos bugs visuais, segue o v√≠deo abaixo:

https://github.com/filipedeschamps/tabnews.com.br/assets/73134662/a4c1d2c2-f442-45e5-a4c8-9c3415ba0863

Por√©m ao editar a publica√ß√£o aparece erro de sintaxe do Mermaid, sendo que ao criar a publica√ß√£o n√£o apareceu este erro.
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/73134662/a50a6da8-b1b6-4818-8d07-fe41b5e70699)

Eu chuto ser um Mermaid ruim pela minha parte (fiz com Chat GPT üôÑ) e um caso isolado com bugs na renderiza√ß√£o da p√°gina.

Agrade√ßo pelo tempo e aten√ß√£o de voc√™s!

Caso n√£o haja outros casos, podem fechar a Issue üí™.

>> Coment√°rio de Rafatcb:
Bom, como esse problema n√£o foi reportado novamente e n√£o conseguimos reproduzi-lo para investigar e corrigi-lo, vou fechar o issue. Caso mais algu√©m se depare com este problema e consiga fornecer mais informa√ß√µes para trabalharmos nisso, podemos reabrir o issue :+1: 

Obrigado por ter compartilhado o problema com tantos detalhes! Isso deve facilitar caso mais algu√©m se depare com esse bug.
</issue_1639_Visualiza√ß√£o de Diagrama Mermaid bugada em dispositivos m√≥veis>

<issue_1640_Text to speech para deficientes visuais (e pregui√ßosos)>
### Descri√ß√£o

Acho que deveria ter uma bot√£o de text to speech para traduzir o texto escrito em √°udio para facilitar a "leitura" para deficiente visuais (e pregui√ßosos)

### Sugest√£o de implementa√ß√£o

Podemos usar modelos de TTS da open ai, mas isso geraria um custo operacional.
mas tamb√©m podemos pesquisar uma op√ß√£o gratu√≠ta ou uma lib para gerar √°udio em cima de texto

>> Coment√°rio de aprendendofelipe:
@PedroHenriqueM01, voc√™ teve algum problema ao usar alguma ferramenta de Texto-para-Voz com o TabNews?

Poderia dar mais detalhes?

>> Coment√°rio de Rafatcb:
Seria a mesma sugest√£o do issue #1442?

>> Coment√°rio de aprendendofelipe:
> Seria a mesma sugest√£o do issue #1442?

Acredito que sim, mas perguntei por desencargo para saber se houve algum problema com as ferramentas j√° dispon√≠veis.

Vou fechar essa aqui como duplicidade, mas tamb√©m acho que a #1442 poderia ser fechada.

@PedroHenriqueM01, se n√£o for a mesma coisa, podemos reabrir a issue ü§ù
</issue_1640_Text to speech para deficientes visuais (e pregui√ßosos)>

<issue_1643_Falta de entrega de email de recupera√ß√£o de senha>
### Descri√ß√£o

A solicita√ß√£o de *reset* de senha por volta das 12h (UTC-3) apenas foi atendida √†s 17:02:57 (UTC-3). Espero que estes detalhes sejam suficientes para rastrear o ocorrido na data de hoje 06 Mar 2024.

Parece-me que agora est√° tudo ok. Solicitei uma nova recupera√ß√£o de senha √†s 19:12:04 (UTC-3) e a mesma foi atendida quase que imediatamente.


### Passos para reproduzir o problema

1. Com o usu√°rio logado, solicitar nova senha de acesso.
2. Aguardar a chegada do email de recupera√ß√£o de senha
3. Se demorar mais que alguns minutos, suspeite de algo anormal.

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

Verificar os logs do servi√ßo de envio de email para o usu√°rio pr√≥ximo aos hor√°rios indicados.
PS: Aten√ß√£o ao fuso hor√°rio : )

>> Coment√°rio de aprendendofelipe:
@gpoleszuk, obrigado por reportar! üí™

Investiguei os √∫ltimos 15 dias e parece ter sido um caso isolado, mas repassei para o suporte do Resend, pois o sistema deles n√£o retornou nenhum erro pra gente, e nem registrou essa tentativa de envio.

Do resto que analisei, tem dois dados importantes sobre o Resend:

1. Tem cerca de 1% de emails que est√£o retornando, mas tudo registrado normalmente no sistema deles. @filipedeschamps voc√™ tem dados sobre o √≠ndice de emails devolvidos nos envios pelo Mailgun?
2. Tem outros cerca de 1% das tentativas de envio pelo Resend em que obtemos um erro de conex√£o, e nesses casos estamos enviando pelo Mailgun automaticamente e sem problemas. Nesses casos temos os registros do nosso lado.

Obs. Vou editar o t√≠tulo, pois n√£o houve um atraso, e sim uma perda completa da solicita√ß√£o de envio. O que aconteceu mais tarde √© que eu usei a ferramenta de modera√ß√£o do TabNews para solicitar novamente a recupera√ß√£o de senha para o seu usu√°rio. üëç
</issue_1643_Falta de entrega de email de recupera√ß√£o de senha>

<issue_1647_Resultados somem da busca ao voltar e acessar outro resultado>
### Descri√ß√£o

Encontrei um pequeno problema na busca. Quando voc√™ acessa o link de um resultado, e em seguida volta para acessar o link de outro resultado,  todos os resultados somem depois do clique, √© como se a busca desse um restart.

### Passos para reproduzir o problema

Pesquise por algo, clique em um resultado, depois d√™ voltar no navegador, e clique em outro resultado.

### Navegadores testados

Google Chrome para Android

### Poss√≠vel solu√ß√£o

_No response_
</issue_1647_Resultados somem da busca ao voltar e acessar outro resultado>

<issue_1648_Possibilidade de traduzir o pr√≥prio post/coment√°rio>
### Descri√ß√£o

Inspirado pela issue #35.

Eu tinha um post pessoal no site medium falando sobre programa√ß√£o. Como eu gostaria que aquele conte√∫do alcan√ßasse mais pessoas, escrevi o post em ingl√™s por l√°.

Gostaria de sugerir que os posts criados pelos usu√°rios pudessem ser "traduzidos" de uma maneira mais coerente do que utilizando o tradutor do pr√≥prio navegador que as vezes perde alguns conceitos ou troca palavras. E isso seria apenas um extra, nos posts que o(a) autor(a) quisesse/soubesse fazer.

### Sugest√£o de implementa√ß√£o

Minha sugest√£o aqui √© um conceito simples, em rela√ß√£o a implementa√ß√£o, n√£o tenho certeza. 

Pensei em algo como adicionar uma "tag" ou algo assim, no corpo do texto, indicando qual a l√≠ngua em que est√° sendo escrito o texto. Algo como no lan√ßamento de novas vers√µes de apps na loja Google Play:

```
<pt-BR>
Escreva aqui no idioma pt-BR
</pt-BR>
```

E poder√≠amos, ao mostrar os posts, ter um dropdown com as poss√≠veis linguas dos posts. Talvez adicionando isso ao url e no html da pagina para auxiliar motores de busca a classificarem aquele conte√∫do com a lingua certa.

N√£o penso em ter, de momento a funcionalidade do #35, assim como o pr√≥prio Medium, o GitHub e alguns v√°rios outros sites n√£o tem vers√µes com as linguas diferentes que os seus usu√°rios postam, acredito que ao menos o texto poderia ter essa op√ß√£o.

>> Coment√°rio de aprendendofelipe:
@FMorschel, como voc√™ viu com sua publica√ß√£o negativada, conte√∫dos em ingl√™s n√£o s√£o bem recebidos pelos usu√°rios do TabNews.

Talvez um dia chegue o momento de repescar a #35, mas isso n√£o est√° nos planos de m√©dio prazo, por isso vou fechar a issue. ü§ù
</issue_1648_Possibilidade de traduzir o pr√≥prio post/coment√°rio>

<issue_1649_Tabcoins negativos>
### Descri√ß√£o

Eu comecei a usar o site e pelo que eu entendi, se eu n√£o tenho tabcoins eu n√£o poderia utilizar eles.

Eu postei o mesmo conte√∫do ontem tanto em ingl√™s quanto em portugu√™s, nessa ordem. Segue os links:

https://www.tabnews.com.br/fmorschel/great-dart-e-flutter-object-extensions
https://www.tabnews.com.br/fmorschel/otimas-extensoes-pra-objetos-em-dart-e-flutter

Hoje estou com tabcoins negativos.

### Passos para reproduzir o problema

N√£o sei exatamente o que eu fiz de errado aqui, mas ao fazer esse meu segundo post, eu tenho a sensa√ß√£o de que ele tentou "auto curtir" ou algo assim pois eu n√£o tentei por n√£o ter os coins. Ali√°s, tentei mais tarde e ele me diz que n√£o posso dar upvote nas minhas proprias postagens.

![Imagem mostrando o post com um upvote e o login com um tabcoin negativo](https://github.com/filipedeschamps/tabnews.com.br/assets/52160996/4756c5ae-1b91-4535-a2b7-f1bca4a79fe5)


### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@FabricioFFC, sua publica√ß√£o em ingl√™s recebeu votos negativos. Recomendo apagar a publica√ß√£o antes que voc√™ perca mais TabCoins com ela.

Ap√≥s apagar a publica√ß√£o, veja o [FAQ](https://www.tabnews.com.br/faq) e o [Sobre (que √© uma publica√ß√£o do Filipe)](https://www.tabnews.com.br/filipedeschamps/tentando-construir-um-pedaco-de-internet-mais-massa) para entender melhor o TabNews.

Se isso responder suas d√∫vidas, pode fechar a issue, por favor ü§ù

>> Coment√°rio de FMorschel:
Minha publica√ß√£o em ingl√™s est√° com o valor de 0 tabcoins desde o momento em que eu criei ela. Foi minha primeira publica√ß√£o. O valor de TabCoins negativos ocorreu apenas quando eu cirei minha publica√ß√£o em portugu√™s.

>> Coment√°rio de aprendendofelipe:
Sua publica√ß√£o come√ßou com 1 TabCoin, j√° recebeu 2 votos negativos, e provavelmente continuar√° sendo negativada.

O FAQ e a publica√ß√£o do Filipe ajudaram com as d√∫vidas? Quer sugerir alguma melhoria no texto do FAQ?

>> Coment√°rio de FMorschel:
Entendi, acho que vou procurar (ou criar) uma issue. Gostaria de entender melhor por que as pessoas est√£o marcando meu post como negativo. Vou sugerir criar um campo de observa√ß√µes para votos negativos.
</issue_1649_Tabcoins negativos>

<issue_1650_Melhor explicar a mec√¢nica de TabCoins e TabCash>
### Descri√ß√£o

Comecei a utilizar o site de verdade fazem alguns poucos dias, tentei encontar algo mas ainda n√£o ficou muito claro pra mim, como eu recebo TabCoins/TabCash?


### Sugest√£o de implementa√ß√£o

Sugiro fazer um post talvez com um passo a passo explicando o que precisa acontecer para receber TabCoins/TabCash e vincular esse post com um clique nos √≠cones de TabCoin/TabCash.

>> Coment√°rio de FilipeRicardo:
Provavelmente voc√™ n√£o entrou no FAQ, l√° tem tudo explicado como que funciona a din√¢mica dos tabcoins e tabcash, e demais funcionalidades.

https://www.tabnews.com.br/faq

>> Coment√°rio de FMorschel:
Ent√£o fica a minha sugest√£o pra, se acharem v√°lido, pensar um pouco se n√£o teria como fazer isso que mencionei de adicionar essa informa√ß√£o sobre os tabcoins diretamente neles pra facilitar pra usu√°rios novos. Ou trazer essa informa√ß√£o ao finalizar um cadastro, algo assim. 

Considero isso bem importante pois √© algo central na funcionalidade do site e acredito que isso deveria ser mais exposto para novos usu√°rios um pouco mais leigos como eu em rela√ß√£o ao projeto. E que n√£o pensaram em procurar o FAC üòÖ.

Caso discordem, podem fechar a issue.

>> Coment√°rio de kaique-soares:
- Ser√° que dever√≠amos incluir essa proposta na issue #1575?

>> Coment√°rio de FMorschel:
Encontrei essa issue tamb√©m referente ao assunto #1381. Menciono ela nessa outra issue?

>> Coment√°rio de kaique-soares:
- Em linhas gerais n√£o vejo problema em citar a issue que traz a #1381 :+1:

@FMorschel se voc√™ for incluir a sugest√£o feita aqui, na issue que mencionei, talvez seja melhor fechar essa issue aqui e concentrar a discuss√£o l√° :+1: 

O que acham?

>> Coment√°rio de aprendendofelipe:
> Encontrei essa issue tamb√©m referente ao assunto #1381. Menciono ela nessa outra issue?

Acho que n√£o @FMorschel. A #1381 tinha mais foco em auxiliar o desenvolvimento do TabNews, seja para mudan√ßas nas regras e/ou criar o FAQ que ainda n√£o existia. Acredito que seja muita informa√ß√£o para constar em um guia para novos usu√°rios. Para esses, o que est√° no FAQ deveria ser suficiente, ele est√° at√© mais atualizado que a issue. Ent√£o, se o FAQ n√£o estiver claro, ele precisa ser melhorado.

Mas, pelo que entendi, voc√™ n√£o est√° sugerindo melhorias no FAQ, e sim na forma de encontr√°-lo, ent√£o acho que o melhor lugar para isso √© a #1575, como o @kaique-soares sugeriu.

Por isso, vou fechar essa aqui. ü§ù
</issue_1650_Melhor explicar a mec√¢nica de TabCoins e TabCash>

<issue_1651_Informar motivo de voto negativo (opcional)>
### Descri√ß√£o

Eu acho que a p√°gina de [Hist√≥rico de votos recebidos e extrato de TabCoins](https://github.com/filipedeschamps/tabnews.com.br/issues/1341) (e talvez alguma outra enquanto n√£o fica pronta) ficaria melhor se tivesse como visualizar um poss√≠vel motivo de algu√©m ter dado um voto negativo.

Aconteceu comigo o caso presente na issue #1649, onde eu criei um conte√∫do em ingl√™s como uma das minhas primeiras publica√ß√µes no site, e, sem entender bem, comecei a receber votos negativos nessa publica√ß√£o. Apenas entendi o motivo ap√≥s [esse coment√°rio na issue 1648](https://github.com/filipedeschamps/tabnews.com.br/issues/1648#issuecomment-1999640564).

Por esse motivo, acabei de entrar na comunidade e ja estou negativo de TabCoins, o que n√£o √© uma experi√™ncia muito legal para quem chegou na comunidade agora e n√£o teve inten√ß√£o de ferir nenhuma diretriz. Pois ningu√©m comentou na minha publica√ß√£o, e apenas me deram votos negativos, o que, se eu n√£o tivesse ido atr√°s pra entender, teria me desmotivado a participar da comunidade.

### Sugest√£o de implementa√ß√£o

Poder√≠amos implementar uma caixa flutuante ao clicar no voto negativo, que possibilitasse um coment√°rio para o criador do conte√∫do que indicasse o motivo do voto. Poderia ficar vis√≠vel como um coment√°rio no post mesmo, mas indicando pro escritor que essa pessoa escreveu isso, deu um voto negativo no conte√∫do ou algo assim.

>> Coment√°rio de Rafatcb:
@FMorschel obrigado pela sugest√£o!

O @aprendendofelipe chegou a mencionar em https://github.com/filipedeschamps/tabnews.com.br/issues/540#issuecomment-1851120166 uma sugest√£o parecida:

> Sobre as rea√ß√µes, algo que j√° pensei √© de apresentar um menu com op√ß√µes extras logo ap√≥s algu√©m qualificar um conte√∫do, dando a chance de enviar um feedback an√¥nimo para o autor sobre o motivo do voto, seja positivo ou negativo, mas esse feedback sendo totalmente opcional e restrito a quem qualificou.

Se for para ter essa funcionalidade, eu prefiro da forma que foi citada acima (an√¥nima e privada).

O problema de implementar isso de forma privada √© que algu√©m pode enviar uma cr√≠tica que na verdade o p√∫blico geral do TabNews n√£o concorda, mas pelo autor ver a cr√≠tica, acaba achando que ela est√° correta. Algo parecido aconteceu na publica√ß√£o [Ganhei R$ 17.821,989 desenvolvendo jogos em 2023](https://www.tabnews.com.br/coelhucas/ganhei-r-17-821-989-desenvolvendo-jogos-em-2013) (n√£o foi exatamente isso, e a publica√ß√£o ficou melhor depois da cr√≠tica, mas o autor poderia ter apagado a publica√ß√£o por causa dela, se fosse privada e ningu√©m demonstrasse que discorda).

E se for para fazer de forma p√∫blica, j√° temos os coment√°rios hoje que tamb√©m servem para isso e voc√™ n√£o precisa dizer que votou na publica√ß√£o (o que considero um ponto positivo por evitar votos de persegui√ß√£o).

>> Coment√°rio de FMorschel:
Entendo. Apenas sugeri pois no meu caso, recebi votos negativos (no meu primeiro post, simplesmente por ser em ingl√™s) e se eu n√£o tivesse vindo aqui e criado algumas issues, nunca teria descoberto que conte√∫dos em linguas estrangeiras n√£o s√£o bem avaliados pelos usu√°rios hoje. 

Talvez ent√£o alguma forma de direcionar as pessoas para os coment√°rios ap√≥s avalia√ß√µes negativas mas indicando que deveriam ser feitas criticas construt√≠vas para o autor do post? Talvez ao clicar no voto negativo mostrar um aviso amigavel que incentivasse a pessoa a comentar no post tamb√©m para poder auxiliar o autor a escrever melhores textos no futuro? 

N√£o sei bem, mas quem sabe lembrar a pessoa que ao fazer comentarios tamb√©m se recebem TabCoins? Seria uma justificativa "egoista" para a pessoa ser altruista e fazer curadoria tanto de conte√∫do, como de criadores de conte√∫do (autores) que v√£o melhorando os pr√≥ximos textos pelas cr√≠ticas.

>> Coment√°rio de angelo-francisco:
Acho uma boa ideia, pois √© √≥timo saber o motivo, a fim de, geralmente, tentar melhorar como desenvolvedores!
</issue_1651_Informar motivo de voto negativo (opcional)>

<issue_1652_Poder√≠amos vincular uma descri√ß√£o mais detalhada sobre os TabCoins recebidos diariamente no FAQ?>
### Assunto

Outro

### D√∫vida

Poder√≠amos vincular uma descri√ß√£o mais detalhada sobre os TabCoins recebidos diariamente no FAC?
https://www.tabnews.com.br/FelipeBarso/tabnews-agora-com-recompensas-diarias-em-tabcoins

O que temos hoje no FAC:

---

## O que √© TabCoin?
TabCoin √© a moeda de troca no sistema de qualifica√ß√£o de conte√∫dos do TabNews. Voc√™ utiliza seus TabCoins para qualificar conte√∫dos dos outros e, por sua vez, recebe ou perde TabCoins com base nas qualifica√ß√µes recebidas em seus pr√≥prios conte√∫dos.

## Como ganhar TabCoins?
As formas de ganho de TabCoins s√£o:

**Criando um conte√∫do**: existe um algoritmo que leva em considera√ß√£o os TabCoins dos seus conte√∫dos mais recentes para definir quantos TabCoins voc√™ ganhar√° ao criar um novo conte√∫do.
**Recebendo votos positivos**: quando outro usu√°rio avalia positivamente seu conte√∫do.
**Recompensa di√°ria**: voc√™ pode ganhar TabCoins ao acessar o TabNews pelo menos uma vez no dia. Existe um algoritmo que leva em considera√ß√£o as qualifica√ß√µes dos seus conte√∫dos mais recentes e tamb√©m a quantidade de TabCoins que voc√™ possui. Quanto melhor avaliados forem seus conte√∫dos e menos TabCoins voc√™ possuir, mais receber√° na recompensa di√°ria.

>> Coment√°rio de Rafatcb:
@FMorschel obrigado pela sugest√£o!

Vou citar minha opini√£o, que deixei em outro coment√°rio (https://github.com/filipedeschamps/tabnews.com.br/issues/1575#issuecomment-2000655379):

> N√£o queremos explicar com detalhes porque, al√©m de ser algo complicado e mut√°vel, o objetivo n√£o √© que a pessoa busque "a melhor forma de ganhar pontos", e sim que entenda a ideia geral de "qu√£o melhor forem seus conte√∫dos, mais TabCoins voc√™ receber√°".

Acredito que saber a "f√≥rmula exata" n√£o ir√° ajudar a ter um desempenho melhor no TabNews porque envolvem muitas vari√°veis, e se voc√™ tentar otimizar para o ganho de TabCoins, provavelmente ter√° "menos ganhos" do que se agisse de forma natural (mas continuando a focar na qualidade dos conte√∫dos).

Qual seu objetivo com essa proposta? Que necessidade voc√™ possui que deseja resolver? Talvez tenha uma outra solu√ß√£o para o problema que voc√™ encontrou que n√£o seja detalhar exatamente como ganhar TabCoins.

>> Coment√°rio de FMorschel:
N√£o acredito que necessariamente seja preciso passar os √∫ltimos par√°grafos do post que botei o link acima. Mas penso mais nesse trecho:

> ### Como Ser Recompensado?
> Para ganhar os TabCoins extras, os usu√°rios precisam ter recebido mais qualifica√ß√µes positivas do que negativas em suas publica√ß√µes e usar a maior parte dos TabCoins ganhos para qualificar conte√∫dos (n√£o acumular TabCoins).

Hoje no FAC temos:

> **Recompensa di√°ria**: voc√™ pode ganhar TabCoins ao acessar o TabNews pelo menos uma vez no dia. Existe um algoritmo que leva em considera√ß√£o as qualifica√ß√µes dos seus conte√∫dos mais recentes e tamb√©m a quantidade de TabCoins que voc√™ possui. Quanto melhor avaliados forem seus conte√∫dos e menos TabCoins voc√™ possuir, mais receber√° na recompensa di√°ria.

Acredito que talvez removendo do FAC o inicio da segunda frase: 

> [...] **Existe um algoritmo que** leva em considera√ß√£o as [...]

Pois, para mim, soa mais como algo que eu posso aprender e "tirar vantagem" caso eu tenha esse intuito.

E acho que adicionar a informa√ß√£o do post:

> [...] usar a maior parte dos TabCoins ganhos para qualificar conte√∫dos (n√£o acumular TabCoins).

Pois essa parte explica melhor que o objetivo do site n√£o √© acumular TabCoins, mesmo tendo essa op√ß√£o. E talvez indicar juntamente dessa ultima informa√ß√£o, mais uma vez, o objetivo do uso dos TabCoins.

>> Coment√°rio de Rafatcb:
Dizer que tem um algoritmo n√£o deveria dar a impress√£o de que voc√™ pode tirar vantagem, por causa da explica√ß√£o que vem a seguir:

> Quanto melhor avaliados forem seus conte√∫dos e menos TabCoins voc√™ possuir, mais receber√° na recompensa di√°ria.

Ou seja, n√£o h√° como tirar vantagem, apenas produzindo conte√∫dos bem avaliados.

> Pois essa parte explica melhor que o objetivo do site n√£o √© acumular TabCoins, mesmo tendo essa op√ß√£o. E talvez indicar juntamente dessa ultima informa√ß√£o, mais uma vez, o objetivo do uso dos TabCoins.

N√£o vejo como sendo necess√°rio deixar ainda mais expl√≠cito para n√£o acumular TabCoins justamente pela frase que citei anteriormente (_"...e menos TabCoins voc√™ possuir..."_). Inclusive, n√£o acho que o ac√∫mulo de TabCoins seja um problema hoje. Existem usu√°rios que votam pouco, mas n√£o me parece que esse seja o motivo.

>> Coment√°rio de FMorschel:
Obrigado pelas respostas. Vou fechar a issue pois acho que n√£o tenho mais nada a acrescentar.
</issue_1652_Poder√≠amos vincular uma descri√ß√£o mais detalhada sobre os TabCoins recebidos diariamente no FAQ?>

<issue_1653_Tags nas postagens>
### Descri√ß√£o

Estava passando pelo post https://www.tabnews.com.br/filipedeschamps/tabnews-a-diferenca-entre-revelantes-e-recentes do Filipe e me deparei com uma quest√£o que ele levanta ali, sobre talvez a aba de relevantes n√£o ser necessariamente algo que os usu√°rios queiram ver. 

Entendo esse ponto, apenas gostaria de levantar mais um, e se o usu√°rio **quer** ver o conte√∫do mais relevante, como ja pensado, mas pensando em "filtrar" esse conte√∫do para ignorar alguns posts relacionados a tecnologias que o usu√°rio n√£o usa?

Por exemplo, se estou entrando l√° nos relevantes hoje vejo alguns posts sobre [NextJS](https://www.tabnews.com.br/igoroliveiraa/duvida-qual-a-melhor-forma-de-persistir-um-dado-em-next-js), [Docker](https://www.tabnews.com.br/nadojba/iniciando-com-kubernetes-com-kind-e-docker) e [IA](https://www.tabnews.com.br/devJlucassantos/inteligencia-artificial-em-2024-uma-odisseia-no-mundo-real). Mas eu n√£o trabalho com necessariamente nenhuma dessas √°reas. Acho interessante dar uma olhada em coisas fora do seu espectro por poder gerar insights diferentes ou incitar a fazer algo novo, mas eu por exemplo, trabalho com Dart e Flutter. A n√£o ser que a Google lance uma atualiza√ß√£o nova, grande sobre isso, poucos conte√∫dos referentes a isso v√£o parar na pagina de relevantes. 


### Sugest√£o de implementa√ß√£o

Eu gostaria que pudessemos "classificar" os posts com tags (como no StackOverflow por exemplo ou as issues aqui) para que, por exemplo, no meu caso, os posts fossem um pouco mais relevantes pra mim, mas ainda assim relevantes para a comunidade que se importa com aquela "tag".

>> Coment√°rio de aprendendofelipe:
Fechando por duplicidade com #742

>> Coment√°rio de FMorschel:
Desculpe! N√£o encontrei essa issue. Vou seguir ela. Obrigado!
</issue_1653_Tags nas postagens>

<issue_1657_P√°gina De Altera√ß√£o De Email ‚úâÔ∏è>
### Descri√ß√£o
Acredito que dever√≠a existir uma p√°gina para altera√ß√£o de email assim como a de login ou de cadastro, claro eu tamb√©m acho que essa feature deveria ser meio escondido pois eu sei das implica√ß√µes que isso pode trazer.

### Motivo
O motivo de eu sugerir esse recurso √© por porque justamente eu estou precisando dele pois quando eu crie a minha conta eu criei em email qualquer, mas agora eu queria ter algum jeito de passar os "dados" da minha conta para o meu email principal por ele ser mais seguro.

>> Coment√°rio de Rafatcb:
@HarukaYamamoto0 pelo o que eu entendi, voc√™ est√° querendo mudar de e-mail mas acha que isso n√£o √© poss√≠vel hoje, certo?

Existe a p√°gina de [edi√ß√£o do perfil](https://www.tabnews.com.br/perfil) onde, dentre outras coisas, voc√™ pode alterar o seu e-mail. A altera√ß√£o s√≥ ser√° efetivada quando voc√™ clicar no link de confirma√ß√£o que receber√° no e-mail informado.

Pode testar isso e confirmar se √© o que voc√™ precisa?

>> Coment√°rio de HarukaYamamoto0:
Realmente agora eu consegui alterar meu email obg man, abri uma issue sem saber que tinha essa op√ß√£o na p√°gina editar perfil que vergonha skskskks
</issue_1657_P√°gina De Altera√ß√£o De Email ‚úâÔ∏è>

<issue_1659_Facilitar a c√≥pia de √¢ncoras para t√≠tulos de conte√∫dos>
### Descri√ß√£o

O PR #1635 adicionou `id` aos t√≠tulos ( `h1`, `h2` ... `h6`) de um conte√∫do, mas n√£o h√° uma forma f√°cil de copiar a √¢ncora para o t√≠tulo em quest√£o. Essa funcionalidade pode ser √∫til tanto em conte√∫dos criados por usu√°rios (publica√ß√£o, coment√°rio e descri√ß√£o do perfil) como em p√°ginas que utilizam markdown, como o FAQ, Termos de Uso e Museu.

### Sugest√£o de implementa√ß√£o

Devemos dar uma aten√ß√£o extra sobre esse comportamento em dispositivos m√≥veis, ent√£o uma op√ß√£o mais amig√°vel do que exibir algo no `hover` √© um comportamento como o da documenta√ß√£o do [Joi](https://joi.dev/api/?v=17.12.2). O √≠cone usado l√° √© uma prancheta e est√° sempre vis√≠vel, e ao clicar no √≠cone, o link para o t√≠tulo √© copiado.

![Titulo com o √≠cone de uma prancheta do lado direito. Ao clicar, o √≠cone muda para um "verificado".](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/3b5377e7-1e3d-45f8-825f-de3ae42e054d)

Foi sugerido em https://github.com/filipedeschamps/tabnews.com.br/pull/1635#issuecomment-1969029954 usar o √≠cone de compartilhar e chamar o [`navigator.share`](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/share). 

![√çcone de compartilhar](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/15b59483-dac2-48b3-acd1-31521ee5f995)

Por quest√µes de alinhamento de texto, muito provavelmente o melhor local para exibir o √≠cone √© no final do t√≠tulo, mesmo que o √≠cone fique sozinho numa nova linha.

>> Coment√°rio de wendesongomes:
Tava estudando como fazer plugin para o `@bytemd/react` e acabei fazendo o sistema de copiar a ancora, reaproveitei boa parte do codigo do `copy-code-to-clipboard.js` e ficou desta forma:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/7f8a094f-1764-47ab-ad7a-d97284fa5a4f)

>> Coment√°rio de aprendendofelipe:
> acabei fazendo o sistema de copiar a ancora

Para facilitar a utiliza√ß√£o em dispositivos m√≥veis, √© melhor usar o [navigator.share](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/share). O √≠cone utilizado tamb√©m √© mais coerente com "compartilhamento" do que com a a√ß√£o de "copiar".

E o posicionamento do √≠cone alinhado na direita n√£o ajuda tanto no entendimento da funcionalidade. Acho que fica melhor deixar junto ao t√≠tulo. Pode at√© ser na direita, mas logo ap√≥s o texto.

Faz sentido?

>> Coment√°rio de wendesongomes:
Fez sim, vou fazer as altera√ß√µes e coloco aqui novamente.

>> Coment√°rio de wendesongomes:
@aprendendofelipe  Coloquei um gap de 20px e adicionei o `navigator.share.`

Title: Tabnews
Text: Coloquei o titulo do post
url: `${window.location.href.split('#')[0]}#${anchor.id}` fiz desta forma, coloquei um split para se caso a pessoa usar o dialog de ir para algum t√≥pico fica com o # na url e para n√£o ter dois # fiz desta forma

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/597bf72a-3dc3-400e-8a24-c568a826d73f)
</issue_1659_Facilitar a c√≥pia de √¢ncoras para t√≠tulos de conte√∫dos>

<issue_1660_Criar endpoints e p√°ginas para listar eventos de firewall e a√ß√µes da modera√ß√£o>
### Descri√ß√£o

O PR #1638 criou um endpoint `GET /api/v1/events/firewall/[id]` para obter dados relacionados √† um evento gerado pelo firewall interno. Em https://github.com/filipedeschamps/tabnews.com.br/pull/1638#discussion_r1527492197, surgiu a ideia de criar novos endpoints relacionados √† a√ß√µes da modera√ß√£o:

1. `GET /api/v1/events/firewall`: similar ao mencionado anteriormente, por√©m retorna todos os eventos ao inv√©s de um √∫nico. Deve verificar a feature `read:firewall:list` e ter pagina√ß√£o.
2. `GET /api/v1/events/moderations`: dados que podem ser p√∫blicos sobre as atua√ß√µes da modera√ß√£o. Isso precisa ser melhor debatido para entender o que faz sentido exibir e como exibir.
3. `GET /api/v1/events/moderations/[id]`: dados restritos aos moderadores sobre cada uma das atua√ß√µes da modera√ß√£o.

Al√©m dos novos endpoints, precisaremos de novas p√°ginas para exibir esses dados.

### Sugest√£o de implementa√ß√£o

Podemos criar uma p√°gina para a lista de eventos de firewall e outra para a lista de eventos da modera√ß√£o. Talvez seja necess√°rio criar novas p√°ginas para a visualiza√ß√£o de um evento espec√≠fico do firewall e para uma a√ß√£o espec√≠fica da modera√ß√£o, mas podemos experimentar uma visualiza√ß√£o simplificada (hoje n√£o temos nenhum tipo de funcionalidade que a visualiza√ß√£o das informa√ß√µes n√£o seja numa p√°gina espec√≠fica).

A p√°gina com detalhes do evento do firewall pode ter um bot√£o para "desfazer", caso o usu√°rio tenha permiss√£o para isso, j√° que ap√≥s o merge do PR #1638 essa a√ß√£o ser√° feita diretamente pela API, sem uma UI.

As funcionalidades aqui podem ser divididas em mais de um PR, principalmente porque o endpoint `1` √© mais simples, dado que o `GET /api/v1/events/firewall/[id]` j√° est√° pronto (ainda falta o merge do PR), e que os endpoints `2` e `3` precisam de discuss√µes sobre o que ser√° retornado. Al√©m disso, o backend e o frontend podem ser feitos em PRs separados tamb√©m, por pessoas diferentes e em momentos diferentes.

>> Coment√°rio de Rafatcb:
Estava pensando em como poder√≠amos adicionar links na UI para as novas p√°ginas. Com a implementa√ß√£o desse issue, provavelmente surgir√£o duas p√°ginas que podem ter links no menu (por exemplo, `Firewall` e `A√ß√µes da modera√ß√£o`), mas tamb√©m teremos uma p√°gina de `Usu√°rios` futuramente (que talvez seja vis√≠vel apenas para moderadores, ent√£o vamos considerar que a import√¢ncia dela tamb√©m √© baixa, comparando √† `Relevantes` e `Recentes`), e possivelmente surgir√£o outras no futuro.

Uma op√ß√£o √© colocar os links no menu principal (ao lado de `Recentes`) ou no menu hamb√∫rguer (as tr√™s linhas no canto superior direito), de acordo com o tamanho da tela. Por exemplo:

[Tudo no menu superior e no menu hamb√∫rguer](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/3ee688e6-e632-40ae-860e-f34ca833c7dc)

Acho que n√£o fica bom adicionar tudo no `Header` principal, ao lado de `Relevantes` e `Recentes`. Vamos deixar o menu `Usu√°rios` de lado agora porque isso pode ser debatido em outro lugar, apenas mencionei para entendermos que essa lista pode expandir e ficar grande.

O que voc√™s acham mais adequado? Talvez, por essas funcionalidades serem "menos acessadas", deixar no menu hamb√∫rguer? Ou ent√£o, deixar no menu hamb√∫rguer  apenas o `Firewall`, com `A√ß√µes da modera√ß√£o` no rodap√©? (esse link pode at√© ter outro nome, para n√£o ficar em primeiro)

![Firewall no menu hamb√∫rguer, A√ß√µes da modera√ß√£o no rodap√©](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/1dfcc34a-7e1e-446d-8a18-06544d4b85e2)

Essa op√ß√£o me parece melhor do que a primeira.

O link do Firewall ser√° exibido apenas para quem tem permiss√£o. Ele poderia ficar no rodap√©, mas acredito que essa a√ß√£o n√£o precise ficar t√£o escondida, pois pode ser √∫til para o moderador acessar de vez em quando e acompanhar o que est√° acontecendo.

Uma possibilidade tamb√©m √© deixar a p√°gina "A√ß√µes da modera√ß√£o" acess√≠vel pela p√°gina de [Status](https://www.tabnews.com.br/status), j√° que s√£o assuntos mais ou menos relacionados, mas precisaria pensar onde colocar o link. Talvez embaixo da `Rede de qualifica√ß√µes`, que mostra usu√°rios banidos (e essa √© uma "a√ß√£o da modera√ß√£o"):

!["Veja tamb√©m as a√ß√µes da modera√ß√£o", abaixo do grafo de "Rede de qualifica√ß√µes".](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/e1847130-56f1-4c01-a996-7c677c614f0a)

Uma outra op√ß√£o √© n√£o ter p√°gina para `A√ß√µes da modera√ß√£o`, e sim uma lista contendo alguns poucos eventos (talvez por quantidade ou por tempo) que podem ficar na p√°gina Status, mostrando-os de forma resumida. Essa me parece uma boa ideia.

>> Coment√°rio de aprendendofelipe:
> Uma outra op√ß√£o √© n√£o ter p√°gina para `A√ß√µes da modera√ß√£o`, e sim uma lista contendo alguns poucos eventos (talvez por quantidade ou por tempo) que podem ficar na p√°gina Status, mostrando-os de forma resumida. Essa me parece uma boa ideia.

Tamb√©m acho que √© uma boa ideia n√£o ir al√©m de uma pequena lista na p√°gina de status na primeira vers√£o da lista de eventos. Pode n√£o ser uma quantidade fixa de eventos, mas um intervalo de tempo determinado, talvez dois dias ou um pouco mais. Talvez seja ainda melhor mostrar uma tabela com a contagem por tipos de eventos de modera√ß√£o no per√≠odo.

Essa lista √© mais para um usu√°rio qualquer poder investigar o que pode ter acontecido com alguma publica√ß√£o ou conta que deixou de existir. Por sigilo de dados, n√£o d√° para dar muitos detalhes nessa lista p√∫blica, ent√£o acho que a notifica√ß√£o para usu√°rios moderados √© algo mais importante. No #1638 j√° lidamos com os eventos de firewall, mas √© preciso notificar os usu√°rios afetados nos outros tipos de modera√ß√£o.
</issue_1660_Criar endpoints e p√°ginas para listar eventos de firewall e a√ß√µes da modera√ß√£o>

<issue_1664_testes, testes, testes>
### Assunto

Contribui√ß√£o

### D√∫vida

a procura de testes necess√°rios üîç

o que estou pensando:
- o que √© interessante implementar de teste para o projeto? que ainda n√£o existe ou, talvez, precise melhorar o escopo.
- ser√° que tem algum tipo de teste importante, mas, no backlog (ou na mente de algu√©m üòÖ), n√£o teve prioridade?

com isso jogado na mesa üôÉ... faz sentido essa discuss√£o?

ps: √© para meu tcc da p√≥s (n√£o √© meme üòÖ)

>> Coment√°rio de Rafatcb:
@nobregao obrigado pelo interesse!

> o que √© interessante implementar de teste para o projeto? que ainda n√£o existe ou, talvez, precise melhorar o escopo.

N√£o temos nenhum teste no frontend. J√° foi levantado o assunto de criar testes e2e com o Playwright (https://github.com/filipedeschamps/tabnews.com.br/issues/255), e provavelmente esse tipo de teste √© o que teria um impacto mais positivo dentre os poss√≠veis testes a serem criados. Esses testes costumam ser mais lentos, ent√£o tamb√©m seria necess√°rio colocar na balan√ßa e entender o qu√£o demorado realmente s√£o, e quais os fluxos mais importantes para serem testados dessa forma.

N√£o cheguei a investigar o issue mencionado e a implementa√ß√£o para entender se ainda temos impeditivos t√©cnicos quanto √† realizar uma nova implementa√ß√£o hoje.

Al√©m disso, existe o issue https://github.com/filipedeschamps/tabnews.com.br/issues/1405, que √© sobre testes e est√° aberto.

Tamb√©m existem refatora√ß√µes que podem ser feitas em testes existentes, como por exemplo uma que foi mencionada em https://github.com/filipedeschamps/tabnews.com.br/pull/1601#pullrequestreview-1813937412:

> E aproveitando sobre o assunto testes... Eu acho que n√£o estamos adotando uma boa estrat√©gia ao limpar o banco de dados a cada teste. Falo especificamente sobre os testes que s√≥ usam o m√©todo GET.
>
> Testes que podem ser executados com um mesmo conjunto de dados (no banco de dados) poderiam ser agrupados e executados de forma mais r√°pida.
>
> Em alguns casos tamb√©m daria para usar test.each ou describe.each para testes id√™nticos em que s√≥ mudam os dados de entrada e sa√≠da.

---

> ser√° que tem algum tipo de teste importante, mas, no backlog (ou na mente de algu√©m üòÖ), n√£o teve prioridade?

De certa forma, √© quest√£o de prioridade mesmo. Os testes s√£o importantes e as funcionalidades do backend costumam ser cobertas por eles. N√£o me lembro de ter lido outros coment√°rios sobre coisas que podem ser implementadas nos testes e que eu n√£o mencionei acima.

>> Coment√°rio de aprendendofelipe:
> com isso jogado na mesa üôÉ... faz sentido essa discuss√£o?

Acho que faz mais sentido manter a issue aberta se ela focar em pontos espec√≠ficos que precisam ser resolvidos.

Caso a d√∫vida esteja sanada com a excelente resposta do @Rafatcb, pode fechar essa issue, caso contr√°rio, pode manter aberta at√© san√°-la.

Caso queira contribuir com algum desses pontos, sugiro criar uma nova issue mais espec√≠fica (o t√≠tulo √© bastante importante), ou contribuir nas discuss√µes j√° existentes, que podemos reabrir, se for o caso.

> ps: √© para meu tcc da p√≥s (n√£o √© meme üòÖ)

Nesse caso, uma publica√ß√£o no TabNews em que voc√™ fale sobre o seu TCC tamb√©m pode lhe trazer mais material üëç

>> Coment√°rio de nobregao:
a cabe√ßa j√° est√° trabalhando. muito obrigado pelo contexto e ideias @Rafatcb!

@aprendendofelipe acredito que faz sentido e vou fechar por aqui.

objetivo cumprido üéØ
</issue_1664_testes, testes, testes>

<issue_1665_N√£o quebrar links ao alterar nome de usu√°rio>
### Descri√ß√£o

Atualmente, caso voc√™ deseje alterar o seu nome de usu√°rio, temos uma mensagem em que informa que caso ele seja alterado, todos os links ser√£o quebrados.

A ideia √© resolver isso e fazer como por exemplo o github, que, quando voc√™ altera o nome de um reposit√≥rio, mesmo se voc√™ acessar o nome antigo, voc√™ conseguir√° ter acesso.

### Sugest√£o de implementa√ß√£o

Poderiamos ter uma tabela de refer√™ncia de usu√°rios, quando um nome de usu√°rio fosse alterado, seria salvo o antigo nessa tabela e referenciado a tabela do usu√°rio em quest√£o.

Quando algu√©m tentasse acessar um link antigo (como o usu√°rio antigo), checariamos primeiramente se existe algum post com esse usu√°rio e a resposta seria n√£o, pois o nome de usu√°rio mudou, ent√£o, checamos o hist√≥rico de nomes de um usu√°rio com esse determinado nome e encontramos um registro, ent√£o, redirecionamos o link para uma nova p√°gina utilizando o nome atual desse usu√°rio.

Nesse ponto, pensei em uma quest√£o que deve ser analisada:
Meu nome era "a" e mudei para "b", outra pessoa agora poder√° utilizar o nome "a"?

>> Coment√°rio de FilipeRicardo:
Daria para atenuar os efeitos da altera√ß√£o do nome do usu√°rio, sem problemas. A ideia do redirecionador √© perfeitamente aplic√°vel, inclusive sinalizando aos motores de busca a nova URL.

Quanto ao ponto do antigo nome de usu√°rio ser usado, podemos ter dois desfechos.

1) Proibir futuros cadastros com esse usu√°rio,  e manter o redirecionador pra sempre.
**Pr√≥s:** os links n√£o quebrariam em nenhuma hip√≥tese 
**Contras:** o nome de usu√°rio antigo ficaria indispon√≠vel pra sempre

2) Deixar esse nome de usu√°rio numa quarentena, e manter o redirecionador at√© o final da quarentena, dando tempo para os motores de busca absorverem as mudan√ßas, e depois disso o nome de usu√°rio ficaria liberado para ser usado.
**Pr√≥s:** n√£o impactaria os resultados nos buscadores, e o antigo nome de usu√°rio ficaria dispon√≠vel pra uso
**Contras:** os links mencionados em sites de terceiros quebrariam, como j√° acontece hoje.

>> Coment√°rio de marcos-venicius:
Outro problema que √© gerado em cascata com o ponto 1 √© que, se um usu√°rio malicioso altera o nome centenas ou milhares de vezes, temos uma brecha para um ataque onde ele poderia bloquear v√°rios nomes na aplica√ß√£o

>> Coment√°rio de FilipeRicardo:
Daria pra colocar um limite de vezes ou um intervalo de tempo pra coibir o uso inapropriado.

>> Coment√°rio de marcos-venicius:
Sim, isso √© um fato.

Outra coisa √©, tamb√©m dever√≠amos permitir que novas postagens sejam acess√≠veis em links antigos?


N√£o influencia em seguran√ßa, mas √© uma quest√£o interessante tamb√©m.

Acredito que o ideal seria n√£o permitir, porque se n√£o, abre brecha para o usu√°rio continuar fazendo postagens no link antigo.

Exemplo, a pessoa criou um novo post, quando tentar acessar pelo link antigo, ele simplesmente informa que n√£o encontrou nada.

>> Coment√°rio de mthmcalixto:
@marcos-venicius @FilipeRicardo Fiz um [PR](https://github.com/filipedeschamps/tabnews.com.br/pull/1693) sobre mais est√° cedo para isso, ent√£o acredito que isso s√≥ vai mudar em um longo prazo.

Por enquanto todas as URLS v√£o quebrar e como nada √© salvo no Banco de Dados √© imposs√≠vel fazer a recupera√ß√£o mais a frente.

>> Coment√°rio de klawdyo:
Uma ideia seria criar uma desambigua√ß√£o, como acontece com a wikipedia.

1) Antes de retornar o erro 404, pesquise pelo slug da postagem, se ele existe em outros usu√°rios. Caso n√£o exista, retorne o erro. Se existir em pelo menos 1 usu√°rio, mostre a lista de op√ß√µes com uma mensagem dizendo algo assim: A URL n√£o foi encontrada. Ela pode ter sido removida ou o usu√°rio mudou de nome, o que pode ter quebrado o link original. Verifique abaixo as postagens parecidas. A√≠ lista os links com a mesma slug, mudando apenas o usu√°rio.
2) Na p√°gina da postagem, colocar um link de compartilhamento, um est√≠mulo para que o cara use um link fixo, ao inv√©s de um link baseado no usu√°rio, ex.: /post/12312312-1232-1223-4122-1224444444444, Esse link sempre redireciona para a url mais atual. Ent√£o, mesmo que o cara mude, ela sempre vai para o link mais atual. √â interessante que o cara use esse link para postagens em outros sites.
3) Ainda que haja mudan√ßa no nome de usu√°rio e outra pessoa possa vir a us√°-lo, os links para as postagens n√£o devem se repetir. Ou seja, ainda que o cara com um nome reutilizado crie uma postagem que pudesse vir a receber o mesmo link de uma postagem feita pelo usu√°rio antigo do nome, o slug deve considerar esse hist√≥rico. Ou seja, criar um hist√≥rico de links ap√≥s a mudan√ßa para que os pr√≥ximos usu√°rios n√£o consigam repeti-lo e assim o redirecionamento funcionar para sempre.

Observa√ß√µes: Os coment√°rios acima consideram que o `user1` e `user2` poderiam criar postagens com o mesmo slug, tipo: `/user1/teste` e `/user2/teste`, o que eu n√£o sei se √© verdade, mas creio que seja. Se n√£o for, desconsidere.
</issue_1665_N√£o quebrar links ao alterar nome de usu√°rio>

<issue_1666_[Feature] Adicionar uma forma de visualizar melhor as imagens de posts>
### Descri√ß√£o

> Estou abrindo uma nova issue porque n√£o achei nenhuma issue relacionada com esse t√≥pico, mas talvez seja s√≥ desaten√ß√£o, ent√£o pe√ßo desculpas adiantadas para caso j√° exista uma cobrindo esse t√≥pico.

Eu acho que seria bem interessante colocar uma funcionalidade no front-end onde ao clicar em uma imagem de uma publica√ß√£o, ela seja exibida em algum modal para facilitar a visualiza√ß√£o.

### O que essa sugest√£o resolve

Eu pensei nessa funcionalidade agora mesmo enquanto lia esse post: https://www.tabnews.com.br/pierrefreire/minha-jornada-com-rust

Nesse post tem um [coment√°rio](https://www.tabnews.com.br/GMNDS/711d4688-df20-4d94-8476-b6fbe8a5fb67) com uma imagem de diagrama em alta qualidade, mas no computador n√£o da pra ver essa imagem, fica bem dif√≠cil de enxergar. Pra voc√™ conseguir visualizar, voc√™ tem que clicar com o bot√£o direito, abrir imagem em nova guia e ai sim ver a imagem, o que fica meio chatinho de ficar fazendo, j√° que √© necess√°rio voc√™ sair do site do TabNews.

Nos celulares acho que poderia ou n√£o ser √∫til, j√° que tem como voc√™ dar zoom pelo pr√≥prio navegador e visualizar a imagem em maior qualidade, mas no computador n√£o, e mesmo se voc√™ der zoom na p√°gina, a imagem n√£o aumenta, ela √© redimensionada para ocupar o mesmo espa√ßo na tela. (por quest√µes de responsividade).

### Ideia de implementa√ß√£o

Acho que poderia ser algo parecido com o Notion, onde ao clicar duas vezes em cima da imagem, ele abre um modal/dialog com a imagem grande na tela e da a op√ß√£o de dar zoom:

### Imagem em tamanho normal no Notion

![Imagem de tamanho normal](https://github.com/filipedeschamps/tabnews.com.br/assets/82670390/f7e0da60-559c-4bfe-ade9-6e880a268924)

### Modal com imagem redimensionada
![Imagem aumentada](https://github.com/filipedeschamps/tabnews.com.br/assets/82670390/da02365d-cc2a-4184-b560-6c27d6634748)

Mas no caso do TabNews, eu acho que seria melhor apenas um clique em cima da imagem para abri-la.

>> Coment√°rio de kaique-soares:
Ol√° @hiroshimorowaka, obrigado pela sugest√£o :handshake:

> (...) mas no computador n√£o, e mesmo se voc√™ der zoom na p√°gina, a imagem n√£o aumenta, ela √© redimensionada para ocupar o mesmo espa√ßo na tela. (por quest√µes de responsividade).

Por aqui, aplicar um zoom na p√°gina foi suficiente para visualizar o conte√∫do da imagem perfeitamente (sugiro que veja o v√≠deo em tela cheia :+1:)

https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/bd729296-9afe-4092-87a6-36c47bcad988

A issue abaixo est√° relacionada ao assunto, sugiro que veja:
- #1437

>> Coment√°rio de hiroshimorowaka:
Acho que √© mais pelo fato da minha vis√£o ser meio prejudicada ent√£o. 
Eu tava pensando em algo onde voc√™ teria a capacidade dar zoom, tipo assim: 

https://github.com/filipedeschamps/tabnews.com.br/assets/82670390/40ea3a1a-db41-480b-8b8c-d44c63279991

Porque pra eu enxergar o que ta escrito nos quadradinho eu tenho que dar um zoom maior, ai eu prefiro abrir em outra aba e dar zoom. Ent√£o essa sugest√£o me veio a cabe√ßa, mas realmente, s√≥ dar zoom na pagina ou abrir a imagem de forma separada em outra guia resolve tamb√©m kkkkk

>> Coment√°rio de Rafatcb:
Acho que esse problema do zoom continuaria com a implementa√ß√£o desse recurso, caso fosse uma imagem com uma resolu√ß√£o muito grande, certo?

Tendo a concordar com o @kaique-soares. Minha impress√£o √© que faz sentido deixar isso na m√£o do usu√°rio (bastaria fazer `[![descri√ß√£o](imagem)](link para a imagem)`), principalmente porque algumas publica√ß√µes j√° possuem links em imagens, o que deixaria de funcionar com esse novo recurso.

>> Coment√°rio de hiroshimorowaka:
> Tendo a concordar com o @kaique-soares. Minha impress√£o √© que faz sentido deixar isso na m√£o do usu√°rio (bastaria fazer `[![descri√ß√£o](imagem)](link para a imagem)`), principalmente porque algumas publica√ß√µes j√° possuem links em imagens, o que deixaria de funcionar com esse novo recurso.

Realmente, quebraria as imagens com Links, ent√£o acho melhor deixar de lado essa sugest√£o. 
Fica melhor deixar na m√£o do usu√°rio mesmo

>> Coment√°rio de Rafatcb:
Ok, @hiroshimorowaka! Vou fechar este issue, obrigado pela sugest√£o :handshake:
</issue_1666_[Feature] Adicionar uma forma de visualizar melhor as imagens de posts>

<issue_1667_implementar testes e2e para fluxos principais>
### Descri√ß√£o

Houve uma discuss√£o em #255 sobre a implementa√ß√£o desse tipo de teste, mas como faz um tempo e n√£o teve andamento gostaria de priorizar esse desenvolvimento para os fluxos principais.

### Sugest√£o de implementa√ß√£o

Divido em sess√µes para organizar a minha mente kk

### Sobre ferramenta
Na issue foi mencionada o [Playwright](https://playwright.dev/), mas tamb√©m existe [Cypress](https://www.cypress.io/). No artigo [Playwright vs. Cypress ‚Äî Uma An√°lise Detalhada](https://medium.com/@rodrigo.oliveiracabral/playwright-vs-cypress-uma-an%C3%A1lise-detalhada-e7ae66198c95) do [@RodrigoOBC](https://github.com/RodrigoOBC/) cita semelhan√ßas e diferen√ßas. Al√©m de ambas serem open-source, tamb√©m suportam m√∫ltiplos navegadores e geram evid√™ncias de teste.

Pelo contexto atual do que j√° temos, percebo que o Cypress poderia nos atender. Por√©m, com o avan√ßo do projeto, talvez, fa√ßa mais sentindo utilizar o Playwright dado que √© poss√≠vel paralelizar os testes.

Independente da ferramenta √© interessante abstrair a implementa√ß√£o com o uso da abstra√ß√£o Page Objects (mencionado na issue) utilizando Playwright tem [esse exemplo](https://playwright.dev/docs/pom) e Cypress tem [esse aqui](https://docs.cypress.io/guides/end-to-end-testing/protractor-to-cypress#Using-Page-Objects).

### Sobre fluxos
Futucando o projeto localmente pensei nesses fluxos por tipo de usu√°rio:

üò∂‚Äçüå´Ô∏è An√¥nimo
- Visualiza os bot√µes ‚ÄúLogin‚Äù e ‚ÄúCadastrar‚Äù
- Consegue visualizar os conte√∫dos nas abas ‚ÄúRelevantes‚Äù e ‚ÄúRecentes‚Äù
- N√£o pode visualizar nenhuma op√ß√£o de cadastrar conte√∫do
- Consegue visualizar detalhes de um conte√∫do, mas n√£o pode responder. ao tentar responder deve ser redirecionado para login.
- Pode se cadastrar
- Pode realizar login

üôÉ Usu√°rio padr√£o
- Pode publicar nas 2 op√ß√µes dispon√≠veis (barra de t√≠tulo e menu).
- Pode editar e excluir, apenas, suas publica√ß√µes.
- Sobre coment√°rios em publica√ß√µes:
    - Pode comentar em qualquer publica√ß√£o.
    - Pode editar e excluir, apenas, seus coment√°rios.
- Pode visualizar todas suas publica√ß√µes e coment√°rios (menu > meus conte√∫dos)
- Pode editar dados do seu perfil: nome, email, descri√ß√£o e senha.
- Pode marcar como relevante publica√ß√µes e coment√°rios apenas de outros usu√°rios.

üòé Usu√°rio privilegiado
- Pode publicar nas 2 op√ß√µes dispon√≠veis (barra de t√≠tulo e menu)
- Pode editar e excluir publica√ß√µes.
- Pode criar, editar e excluir coment√°rios em publica√ß√µes
- Pode marcar como relevante publica√ß√µes e coment√°rios apenas de outros usu√°rios.

Posso ter me empolgado nesses cen√°rios kk e, com certeza, n√£o pensei em todos os poss√≠veis. Vamos nos somando!

O que acham da ideia? e dos fluxos? fazem sentido?

>> Coment√°rio de Rafatcb:
Os cen√°rios a serem testados devem ser os mais importantes, e vendo "por alto", parece que voc√™ listou bons cen√°rios. Tem alguns detalhes como _Visualiza os bot√µes ‚ÄúLogin‚Äù e ‚ÄúCadastrar‚Äù_ pode ser removido, j√° que isso seria testado pelo _Pode se cadastrar_ e _Pode realizar login_.

J√° usei o Cypress em 2019/20 e n√£o me lembro de ter tido problemas com ele. Nunca usei o Playwright, ent√£o n√£o consigo dizer qual faz mais sentido aqui. N√£o sei se √© t√£o simples migrar entre um e outro quanto foi quando migramos do Jest para o Vitest (https://github.com/filipedeschamps/tabnews.com.br/pull/1642).

Voc√™ j√° teve experi√™ncias com algum dos dois?

Uma op√ß√£o para come√ßar essa implementa√ß√£o √© criar um PR com alguns testes relacionados, que ir√° realizar todo o setup necess√°rio (instala√ß√£o de depend√™ncias e configura√ß√µes), e assim n√£o fica um PR muito denso com v√°rias coisas diferentes para serem analisadas.

---

@aprendendofelipe acha melhor abrir o issue #255 de novo e concentrar todas as informa√ß√µes l√° ou continuar aqui?

>> Coment√°rio de nobregao:
tenho experi√™ncia de estudo.
uma sugest√£o para sairmos do lugar: implementar poucos cen√°rios importantes nas duas ferramentas (em 2 PR diferentes) da√≠ podemos comparar tempo de execu√ß√£o, sintaxe e configura√ß√£o.

caso seja uma ideia a seguir, sugiro seguirmos nessa issue porque a #255 √© focada em playwright.

>> Coment√°rio de Rafatcb:
> uma sugest√£o para sairmos do lugar: implementar poucos cen√°rios importantes nas duas ferramentas (em 2 PR diferentes) da√≠ podemos comparar tempo de execu√ß√£o, sintaxe e configura√ß√£o.

√â o ideal, sim. Assim, j√° descobrimos o que funciona e o que n√£o funciona para nosso caso.

>> Coment√°rio de nobregao:
Vou seguir com isso üí™

>> Coment√°rio de nobregao:
ol√°, seguindo com a discuss√£o dos testes.

o que temos?

`tests/e2e/home.spec.js`:
- Usu√°rio **an√¥nimo** pode ver as abas de relevantes e recentes
- Usu√°rio **padr√£o** pode ver as abas de relevantes e recentes

`tests/e2e/login.spec.js`:
- Usu√°rio que **n√£o existe** n√£o pode fazer login
- Usu√°rio **padr√£o** pode fazer login

`tests/e2e/publish-content.spec.js`:
- Usu√°rio **an√¥nimo** n√£o deve publicar conte√∫do pela header e menu
- Usu√°rio **padr√£o** pode publicar conte√∫do pela header
- Usu√°rio **padr√£o** pode publicar conte√∫do pelo menu

`tests/e2e/register.spec.js`:
- Usu√°rio **an√¥nimo** pode se registrar, valida email e fazer login
- Usu√°rio **padr√£o** logado n√£o pode se registrar com usu√°rio j√° logado

status de outras coisas importantes:
- [x] Execu√ß√£o de testes em CI no browser Desktop Chrome
- [x] Atualizar documenta√ß√£o: como executar localmente por comando e utilizando UI

gostaria de combinar para abrir o PR com esses primeiros testes + documenta√ß√£o, da√≠ os demais e outros cen√°rios que pensarmos posso fazer em outro. o que acham?

>> Coment√°rio de Rafatcb:
Pode abrir o PR quando achar que est√° pronto para mesclar, ou seja, ao ter os testes prontos, a documenta√ß√£o e resolver as revis√µes do PR #1687. Como o Felipe mencionou em https://github.com/filipedeschamps/tabnews.com.br/pull/1687#issuecomment-2143595807, sugiro tamb√©m diminuir a quantidade de commits, para facilitar a revis√£o e separa√ß√£o em etapas do que foi resolvido.

Quanto tempo esses testes levam para serem executados na sua m√°quina? E, como compara√ß√£o, quanto tempo levam todos os outros testes?

>> Coment√°rio de nobregao:
massa! ‚úåÔ∏è 
tenho algumas m√©tricas de dura√ß√£o dessas execu√ß√µes.
na √∫ltima execu√ß√£o da pipeline ([aqui](https://github.com/nobregao/tabnews.com.br/actions/runs/9331292827/job/25685794860)) durou `1m14s` e localmente `1m.1s` ‚¨áÔ∏è 

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/8739782/4bbc69a8-4018-4a51-94af-dd97695c520e)
</issue_1667_implementar testes e2e para fluxos principais>

<issue_1669_Evolu√ß√£o da arquitetura - App Directory/Nextjs>
### Descri√ß√£o

Pensando em evolu√ß√£o do projeto e seguindo as novas vers√µes e recomenda√ß√µes do Next.js, h√° movimentos para migrarmos para app directory? 



### Sugest√£o de implementa√ß√£o

Pensando em evolu√ß√£o do projeto e seguindo as novas vers√µes e recomenda√ß√µes do Next.js, h√° movimentos para migrarmos para app directory? 

Quais impactos?
Ganhamos beneficios com isso?

Levantando apenas como um questionamento para debate aqui...

>> Coment√°rio de aprendendofelipe:
@phricardorj, como o TabNews √© baseado em p√°ginas est√°ticas e com a parte din√¢mica vindo da API, eu n√£o considero a migra√ß√£o para a pasta `/app`, por si s√≥, uma evolu√ß√£o do projeto.

Mas √© natural que isso v√° acontecer de forma incremental conforme forem surgindo necessidades. Talvez a cria√ß√£o de p√°ginas que compartilhem uma parte din√¢mica (ao inv√©s de est√°tica + API) ou, no caso da API, a cria√ß√£o de novas rotas ou melhorias nas existentes.

Por enquanto eu n√£o recomendaria a migra√ß√£o de nenhuma p√°gina s√≥ por migrar. Se n√£o houver nenhum ganho real com a migra√ß√£o, n√£o vale a pena ficarmos t√£o presos ao Next.js.

Faz sentido?

>> Coment√°rio de phricardo:
@aprendendofelipe Opa! Faz sentido sim! Inclusive interessante esse ponto que levantou! Pensando mesmo em manutenibilidade a longo prazo aqui haha! O app directory possu√≠ conven√ß√µes de arquivo interessantes e tamb√©m alguns padr√µes de roteamento avan√ßados que devem facilitar novos contribuidores no futuro. Pensando no TabNews, acho interessante estarmos ligados nisso... Porque queremos deixar ele longevo. 

Mas, concordo com seu ponto! Por essa raz√£o vou fechar essa issue.
</issue_1669_Evolu√ß√£o da arquitetura - App Directory/Nextjs>

<issue_1670_Favoritar / Start ‚≠ê>
### Descri√ß√£o

Estava lendo uma hist√≥ria no TabNews e me deparei com uma situa√ß√£o.

Queria ler novamente certo trecho depois, pra que n√£o precise ficar salvando os textos em outras anota√ß√µes etc.
Minha ideia seria criar uma sess√£o de favoritar aquela pub para poder ler dps ou re-aproveitar o conteudo. ‚≠ê


### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@gusperandio, obrigado pela sugest√£o! üí™

Vou fechar porque o assunto j√° √© abordado na #645 ü§ù
</issue_1670_Favoritar / Start ‚≠ê>

<issue_1672_Busca trazendo resultados fora do tabnews>
### Descri√ß√£o

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/94018427/9cbb8c00-ddba-40cc-bbfd-0b63838368d5)

Como podemos ver, ao buscar um termo qualquer como por exemplo "batata", s√£o trazidos v√°rios resultados de fora da plataforma, diretamente do google.

N√£o sei se isso √© intencional (acredito que n√£o), e no caso, em todas as tabs est√° retornando tudo, tanto em "Todos os resultados" quanto em "GitHub" quanto em "TabNews"

### Passos para reproduzir o problema

1. Clicar no input de pesquisa
2. Digitar um termo qualquer como "batata"

### Navegadores testados

Chrome, Firefox

### Poss√≠vel solu√ß√£o

Poder√≠amos tentar uma estrat√©gia de semantic search, utilizando talvez um langchain, por exemplo.

Talvez, d√™ para configurar no software que est√° sendo utilizado hoje, n√£o tenho certeza.

Mas, acredito que trazer resultados que se limit√£o a aplica√ß√£o seria uma grande melhoria de usabilidade.

>> Coment√°rio de aprendendofelipe:
Os primeiros itens que aparecem na sua imagem n√£o s√£o resultados da busca, e sim propagandas do Google, que √© o servi√ßo de busca que est√° sendo utilizado de forma gratuita, ent√£o tem propaganda.

Note que est√° escrito **Patrocinado** em negrito.

>> Coment√°rio de marcos-venicius:
Sim, isso √© um fato.

Mas, no caso, √© justamente disso que falo.

De ou ter um sistema de busca interno, ou remover esses links patrocinados.

At√© porque, logo mais, os an√∫cios ser√£o dos pr√≥prios usu√°rios, ai ter√° an√∫ncios do google tamb√©m.

Posso estar errado, mas me soa estranho.

>> Coment√°rio de Rafatcb:
Isso √© intencional, apesar de n√£o ser o ideal. Pode ver o que foi pensado ao tomar a decis√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/927#issuecomment-1611655366. Ter um mecanismo de busca assim √© melhor do que n√£o ter, e nenhuma alternativa melhor foi implementada ainda porque os esfor√ßos foram direcionados para outras partes do projeto. 

Para deixar claro, uma melhoria no mecanismo de busca √© sim bem-vinda.

>> Coment√°rio de marcos-venicius:
Hmm. Perfeito, entendi!

>> Coment√°rio de aprendendofelipe:
Show @marcos-venicius, considerando como d√∫vida sanada, ent√£o vou fechar aqui. üëç

Qualquer novidade relacionada √† busca pode ser adicionada l√° na #927, mesmo ela j√° estando fechada, pois a gente pode reabrir. ü§ù
</issue_1672_Busca trazendo resultados fora do tabnews>

<issue_1674_[Ideia] Usar os coment√°rios do TabNews como API/sistema de coment√°rios de blogs e/ou sites terceiros>
### Descri√ß√£o

A minha sugest√£o √©, na medida do poss√≠vel, autoexplicativa pelo t√≠tulo.

Eu imaginei algo estilo Disqus ou o antigo Facebook Comments.

Utilizar o sistema de coment√°rios do TabNews como o sistema de coment√°rios de postagens em blogs pessoais.

Se isso for interessante, implicaria em algo al√©m de um poss√≠vel aumento no consumo da API?

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, @dami-i!

Faz muito tempo que eu n√£o comento em blogs, ent√£o n√£o me lembro como funciona o processo de login para isso. O TabNews precisaria fornecer uma interface parecida com o "Entrar com o Google"?

Uma preocupa√ß√£o minha em situa√ß√µes onde as pessoas falam sobre usar o TabNews como CMS do pr√≥prio blog, e agora com voc√™ sugerindo essa "funcionalidade de coment√°rios", √© que a pessoa que publica (ou comenta) precisa seguir os Termos de Uso do TabNews, e se ferir os termos, pode ser banida e ter todas publica√ß√µes e coment√°rios removidos. 

Al√©m disso, no caso dos coment√°rios, a pessoa pode estar impedida de comentar por causa da pontua√ß√£o negativa e n√£o entender direito, porque essa √© uma din√¢mica externa ao blog que a pessoa est√° lendo.

Um outro ponto √© que, na sua sugest√£o, o autor da publica√ß√£o (do blog) n√£o conseguiria moderar os coment√°rios, e n√£o acredito que fa√ßa sentido criar uma permiss√£o para isso, visto que no TabNews n√£o faz sentido uma pessoa poder remover coment√°rios da publica√ß√£o dela ‚Äî essa responsabilidade fica para o moderador, seguindo como guia os Termos de Uso.

Achei sua ideia legal, mas por conta dos pontos que mencionei acima, acredito que n√£o seja vi√°vel. De toda forma, se o autor do blog escolher listar suas publica√ß√µes do TabNews no blog, ele consegue tamb√©m listar os coment√°rios que a publica√ß√£o teve, apesar de n√£o conseguir permitir que as pessoas comentem ali diretamente pelo blog dele.

Faz sentido?

>> Coment√°rio de dami-i:
@Rafatcb, obrigado por sua resposta.

Faz sentido sim. Eu realmente acho que acrescentaria uma complexidade muito grande ao ecossistema atual e talvez pudesse at√© mesmo fugir dos objetivos do TabNews pro futuro.

Vou fechar a issue. Abra√ßo!
</issue_1674_[Ideia] Usar os coment√°rios do TabNews como API/sistema de coment√°rios de blogs e/ou sites terceiros>

<issue_1675_Adicionar pagina√ß√£o no endpoint /users e criar p√°gina para listar usu√°rios>
### Descri√ß√£o

Conforme mencionado em https://github.com/filipedeschamps/tabnews.com.br/issues/1466#issuecomment-1891098692, criar pagina√ß√£o no endpoint de `GET /api/v1/users` permitir√° fornecer a feature `read:user:list`  aos moderadores, e isso pode ajudar na identifica√ß√£o de contas de spam (que podem levantar suspeitas pelo nome ou pela descri√ß√£o).

Depois da cria√ß√£o do endpoint, ser√° interessante ter uma p√°gina para listar os usu√°rios pelo pr√≥prio site, sem que o moderador precise usar diretamente a API.

Para esse caso de uso, √© interessante ver os usu√°rios por ordem de "criados recentemente" e tamb√©m "atualizados recentemente".

### Sugest√£o de implementa√ß√£o

~O endpoint pode funcionar de forma similar ao `GET /api/v1/contents`, tanto na pagina√ß√£o quanto ao usar `strategy` para definir a ordena√ß√£o.~

A p√°gina pode ser como a de lista de coment√°rios, onde mostra informa√ß√µes sobre o usu√°rio e tamb√©m o in√≠cio da sua descri√ß√£o. ~√â interessante ter uma forma de selecionar diferentes estrat√©gias (ordena√ß√µes) na p√°gina, com um link para cada uma delas (pode ser com [`searchParams`](https://developer.mozilla.org/en-US/docs/Web/API/URL/searchParams)).~

Edit: N√£o h√° mais necessidade de ordena√ß√£o no frontend porque, com a implementa√ß√£o do PR #1676, a API possui apenas uma ordena√ß√£o (atualizados recentemente primeiro).

---

J√° experimentei algumas coisas na implementa√ß√£o do frontend, e acredito que podem ser discutidas antes de abrir um PR, principalmente por alguns pontos s√£o referentes a padr√µes que podem ser utilizados e seguidos em novas funcionalidades do TabNews.

**1. Local do link para a p√°gina de usu√°rios.**

J√° falei um pouco sobre a inser√ß√£o de novos links de p√°ginas em https://github.com/filipedeschamps/tabnews.com.br/issues/1660#issuecomment-2041606971, mas falando especificamente sobre a p√°gina de usu√°rios, como apenas moderadores poder√£o ver isso e √© uma p√°gina que pode ser visitada com certa frequ√™ncia para garantir que est√° tudo em ordem, acredito que o link possa ficar ao lado de `Recentes`:

![Link "Usu√°rios" ao lado direito de "Recentes"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/53883238-ab41-490d-b353-e71a78e0caaf)

E, em telas menores, ser movido para o menu hamb√∫rguer (as tr√™s linhas horizontais no canto superior direito):

![Link "Usu√°rios" num grupo abaixo de "Editar perfil" e acima de "Pesquisar"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/6764bf8b-e841-4b9d-9381-4625edd3e799)

Repare que ele ficou num grupo separado (divis√≥rias acima e abaixo), e tem o mesmo √≠cone de "Meus conte√∫dos". Se houver uma sugest√£o melhor, pode falar nos coment√°rios. Os √≠cones que considerei s√£o os [Octicons](https://primer.style/foundations/icons) do Primer.

**2. Link de cada p√°gina.**

Hoje n√£o temos um padr√£o para isso. As p√°ginas `Relevantes` e `Recentes` possuem links no estilo `/pagina/1`, mas as p√°ginas de conte√∫do do usu√°rio (no perfil) s√£o apenas `/1`. Como o `/usuarios` ser√° um link "no mesmo n√≠vel" do `/recentes` e possivelmente ficar√° pr√≥ximo aos links `Relevantes` e `Recentes`, pensei em seguir o padr√£o de `/pagina/1`.

**3. Redirecionamento em `/usuarios`.**

Podemos utilizar um redirecionamento de `/usu√°rios` para a p√°gina 1, ou seja, para `/usuarios/pagina/1` ou `/usuarios/1` (a depender do ponto anterior). Faz sentido? Esse redirecionamento existe em `/recentes`, `/recentes/comentarios` e `/recentes/todos`, mas n√£o existe em `/usuario/conteudos` e `/usuario/comentarios`.

**4. Exibir a descri√ß√£o**

![Nome do usu√°rio ao lado do n√∫mero na lista, e embaixo a descri√ß√£o, embaixo as informa√ß√µes "Membro h√° 26 minutos, 0 tabcoin, 0 tabcash"](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/98e38176-76e4-4c82-93b9-02acba370321)

Podemos fazer de forma similar ao que acontece na lista de conte√∫dos, juntando o caso de publica√ß√£o e coment√°rio, exibindo o nome do usu√°rio e a descri√ß√£o. Isso permite ver pela pr√≥pria lista se o usu√°rio j√° tem algo suspeito na descri√ß√£o, com base nos primeiros caracteres.

Fazer exatamente assim, traz alguns problemas, como:

* Se o usu√°rio deixar os primeiros 255 caracteres (valor usado na lista de coment√°rios) aceit√°veis, mas come√ßar a ferir os Termos de Uso nos outros, n√£o ser√° poss√≠vel identificar pela p√°gina `/usuarios`.
* Se o usu√°rio adicionar imagens inadequadas, n√£o ser√° poss√≠vel identificar que ele tem imagens na descri√ß√£o, j√° que fazendo da mesma forma que √© feita nos coment√°rios, o markdown √© removido.

<details>
<summary>Com a simplifica√ß√£o do PR #1676 , n√£o √© mais necess√°rio escolher uma ordena√ß√£o pelo cliente, j√° que ter√° apenas a ordena√ß√£o de "atualizados recentemente", ent√£o esses pontos que estou "escondendo" n√£o s√£o mais necess√°rios, deixo apenas para refer√™ncia futura caso o assunto surja novamente.</summary>
**5. Selecionando uma ordena√ß√£o.**

Hoje ainda n√£o temos ordena√ß√£o em nenhuma p√°gina, mas √© algo que ser√° necess√°rio no futuro. Experimentei fazer isso com dois componentes: [`Select`](https://primer.style/components/select) e [`ActionList`](https://primer.style/components/action-list). O primeiro caso foi meu primeiro teste, mas √© um componente para ser usado em formul√°rios, n√£o ficou legal. O segundo caso ficou parecido com os filtros de Issues e PRs do GitHub:

[Selecionando diferentes ordena√ß√µes](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/710f3b72-259e-4c5a-b691-c5aa8f755b12)

Eu gostei do resultado. Veja como fica numa tela maior:

![Lista de usu√°rios com o ActionList antes da lista](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0e59606e-a72c-4682-8198-a37f6ada3056)

**6. Detalhe na lista conforme ordena√ß√£o  (_membro h√° / atualizado h√°_)**

No v√≠deo do ponto anterior, a informa√ß√£o mostrada sobre o usu√°rio √© sempre _Membro h√°_. Caso seja uma ordena√ß√£o com base na data de atualiza√ß√£o, acredito que fa√ßa sentido mostrar _Atualizado h√°_.

**7. URL de ordena√ß√£o.**

Eu gosto da ideia de deixar a URL com base na ordena√ß√£o "compartilh√°vel", usando o `searchParams`. Isso tamb√©m permite a navega√ß√£o por meio dos bot√µes do navegador para voltar ou avan√ßar de p√°gina.

Por exemplo, as URLs podem ser:

* `/usuarios/pagina/1?ordem=criados_novos`
* `/usuarios/pagina/1?ordem=criados_antigos`
* `/usuarios/pagina/1?ordem=atualizados_novos`
* `/usuarios/pagina/1?ordem=atualizados_antigos`

Assim segue um padr√£o no valor `ordem` e est√° em portugu√™s, como todas as URLs do TabNews.

Nenhuma p√°gina usa `searchParams` hoje porque n√£o surgiu a necessidade. O mais pr√≥ximo disso seria o filtro de conte√∫dos recentes feito em  `/recentes/coment√°rios` e `/recentes/todos`, mas acho estranho ter URLs dedicadas para a ordena√ß√£o (algo como `/usuarios/novos`, `/usuarios/antigos`, `/usuarios/atualizados_novos` e `/usuarios/atualizados_antigos`).
</details>

>> Coment√°rio de aprendendofelipe:
> A p√°gina pode ser como a de lista de coment√°rios, onde mostra informa√ß√µes sobre o usu√°rio e tamb√©m o in√≠cio da sua descri√ß√£o.

Vou listar os pontos que acho interessante sempre mostrar. Poderia vir tudo isso da API, mas na lista s√≥ mostrar o que acharem mais importante, e disponibilizar mais detalhes com o hover (ou outra intera√ß√£o melhor):

- Username
- Tempo decorrido desde a cria√ß√£o do usu√°rio
- Tempo decorrido desde a √∫ltima atualiza√ß√£o
- Saldos de TabCoins e TabCash
- Contagem de publica√ß√µes e coment√°rios

Em ver mais:

- Resumo da descri√ß√£o
- As *features* que o usu√°rio possui
- ID

> Hoje n√£o temos um padr√£o para isso. As p√°ginas `Relevantes` e `Recentes` possuem links no estilo `/pagina/1`, mas as p√°ginas de conte√∫do do usu√°rio (no perfil) s√£o apenas `/1`. Como o `/usuarios` ser√° um link "no mesmo n√≠vel" do `/recentes` e possivelmente ficar√° pr√≥ximo aos links `Relevantes` e `Recentes`, pensei em seguir o padr√£o de `/pagina/1`.

Acho que as p√°ginas de modera√ß√£o podem ficar dentro de `/moderacao`, que pode ser uma p√°gina com todas as abas de modera√ß√£o. N√£o acho necess√°rio adicionar o `/pagina`, ent√£o ficaria `/moderacao/usuarios/1`.

> **3. Redirecionamento em `/usuarios`.**

Os redirecionamentos s√£o para compatibilizar com links existentes previamente, ent√£o n√£o vejo necessidade para esses novos caminhos.

> **4. Exibir a descri√ß√£o**

Acho suficiente mostrar s√≥ um resumo da descri√ß√£o na p√°gina que lista usu√°rios, ou at√© mesmo somente ap√≥s alguma intera√ß√£o. Da√≠ poderia ter um `mostrar tudo` para enfim mostrar o markdown quando for necess√°rio.
</issue_1675_Adicionar pagina√ß√£o no endpoint /users e criar p√°gina para listar usu√°rios>

<issue_1679_Exibir tabela de conte√∫dos (links para os t√≠tulos) na publica√ß√£o>
### Assunto

Contribui√ß√£o

### D√∫vida

fiz uma parte de t√≥picos aonde cada titulo ficara como um t√≥pico ao lado (no pc) do texto, isso ajudara a pessoa ir ao titulo q mais o chamou a aten√ß√£o sem precisar scrolar a pagina, com um clique no t√≥pico ele vai para o t√≥pico, no modo celular adicionei os t√≥picos em cima ao bot√£o de rolar para cima, assim ficando visualmente bonito e sem polui√ß√£o na tela do usu√°rio!

Modo Pc
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/280e309d-1604-4151-ab21-2193c4c88dbb)

Modo Celular
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/28c90476-8035-4fa3-bcd5-1a7f2edbc38b)
![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/d7c260ae-c7eb-4210-b4b0-ca67ad6c1c2a)

>> Coment√°rio de Rafatcb:
@wendesongomes obrigado pela sugest√£o! Me pareceu √∫til e interessante. Se n√£o me engano, em 2022/2023 havia mais publica√ß√µes contendo tabela de conte√∫dos, e sua sugest√£o realmente resolveria essa "dor".

Imagino que a solu√ß√£o possa at√© mesmo evoluir para algo como acontece em leitores de PDF, separando em n√≠veis e permitindo esconder/exibir a √°rvore, por exemplo:

![Tabela de conte√∫dos em um leitor de PDF na lateral esquerda, com diferentes n√≠veis de t√≠tulo contendo diferentes tabula√ß√µes.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/9bd4068e-d98d-4b88-8457-33795a49122f)

[Fonte](https://evermap.com/Tutorial_ABM_TOCFromBookmarks.asp).

@wendesongomes o teste que voc√™ fez foi "hard-coded" ou j√° √© din√¢mico, com base no conte√∫do da publica√ß√£o? Precisou criar um plugin do ByteMD?

>> Coment√°rio de wendesongomes:
@Rafatcb eu fiz din√¢mico, quando a pessoa criar um post automaticamente detectar os t√≠tulos em markdown e assim j√° faz os t√≥picos, e reaproveitei tudo que j√° tinha no c√≥digo n√£o precisei adicionar nem um plugin.

>> Coment√°rio de wendesongomes:
Depois de ter feito varias op√ß√µes de design a melhor q eu achei foi colocar ao lado direito como um bot√£o, aonde a pessoa clica e abre um modal na direita.

O porque disto: porque colocando na tela teria que diminuir o tamanho da onde o texto esta e isso deixaria estranho para os usu√°rios, colocando somente um bot√£o, n√£o causaria estranhamento nem descontentamento com algo a mais a tela do usu√°rio.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/82889172/184857e7-8c1e-49d0-a741-e40aa663bfbd)

>> Coment√°rio de Rafatcb:
@wendesongomes eu realmente gostei da sua sugest√£o, e apesar da [sua publica√ß√£o no TabNews](https://www.tabnews.com.br/wendeson/melhoria-nos-posts-com-topicos-para-navegar-melhor-preciso-de-suas-opnioes) n√£o ter muitos coment√°rios, n√£o vi ningu√©m se opor.  Na verdade, [o coment√°rio](https://www.tabnews.com.br/DaniloAbramowicz/d2776569-1364-4bc3-8e14-5532577ee104) que parecia uma oposi√ß√£o, acredito ter sido um mal entendido, j√° que n√£o temos essa funcionalidade. As tabelas de conte√∫do existentes em algumas publica√ß√µes foram feitas de forma manual.

PS: S√≥ agora reparei que tem um √≠ndice no modo de edi√ß√£o do ByteMD, mas tenho quase certeza que n√£o existe uma forma de inseri-lo como conte√∫do sem ser digitando manualmente.

![O √≠ndice no modo de edi√ß√£o fica ao lado direito do conte√∫do que est√° sendo digitado.](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/dcbb01dc-ab12-4646-91b5-062334899848)

Como voc√™ j√° fez a implementa√ß√£o, o que acha de abrir o PR para outras pessoas poderem avaliar e testar tamb√©m?

**Edit:** Acho que pensar nisso agora pode complicar desnecessariamente a implementa√ß√£o, mas consigo imaginar esse menu funcionando tamb√©m como um √≠ndice dos coment√°rios, e talvez dos t√≠tulos em coment√°rios.

>> Coment√°rio de wendesongomes:
@Rafatcb Boa noite, posso mandar um PR sim, qual branch eu coloco?

>> Coment√°rio de Rafatcb:
@wendesongomes vi que voc√™ j√° criou um fork do TabNews. O seu fork precisa estar atualizado (√© poss√≠vel atualizar pela pr√≥pria interface do GitHub no [seu reposit√≥rio](https://github.com/wendesongomes/tabnews.com.br)):

![Exemplo para sincronizar](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/661a4682-f008-4c37-a961-74a54ad9bb99)

Depois disso, pode [abrir um PR](https://github.com/filipedeschamps/tabnews.com.br/compare) apontando do seu fork para o `main` deste reposit√≥rio. No [CONTRIBUTING.md](https://github.com/filipedeschamps/tabnews.com.br/blob/main/CONTRIBUTING.md#enviar-pull-requests) temos algumas informa√ß√µes sobre o processo de PR, mas se surgirem d√∫vidas, pode falar aqui.

>> Coment√°rio de wendesongomes:
@Rafatcb eu fiz la, poderia ver se esta correto pfv?

>> Coment√°rio de Rafatcb:
Apenas para deixar uma refer√™ncia hist√≥rica, descobri hoje que o GitHub tamb√©m tem um tipo de tabela de conte√∫dos:

![Na p√°gina principal do reposit√≥rio, existe um link no canto superior direito, em cima do README, que exibe a tabela de conte√∫dos do README](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/b8f3a834-a875-4713-91f1-b8bff4a28b46)

>> Coment√°rio de wendesongomes:
@Rafatcb fiz uma besteira e acabei fechando o pr e ainda perdi o codigo, mas como tinha refeito a pouco tempo conseguir refazer o codigo, queria saber se tenho q fazer outro pr?

>> Coment√°rio de Rafatcb:
Pessoal, o PR #1686 foi fechado por inatividade, mas cont√©m algumas informa√ß√µes relevantes a serem consideradas na implementa√ß√£o.

Caso algu√©m decida implementar, sugiro experimentar fazer como o GitHub, que mencionei no √∫ltimo coment√°rio, pois √© uma forma menos intrusiva do que o modal lateral, e √© uma mec√¢nica que j√° existe em outras partes do TabNews.

>> Coment√°rio de guilhermeabell:
Opa @Rafatcb  seria apenas resolver os coment√°rios do PR anterior?

>> Coment√°rio de Rafatcb:
@guilhermeabell perd√£o pela demora em responder, apenas li a notifica√ß√£o agora.

Sugiro implementar de forma diferente, como comentei em https://github.com/filipedeschamps/tabnews.com.br/issues/1679#issuecomment-2087832834, porque o padr√£o do GitHub parece melhor do que abrir um modal lateral.

Al√©m disso, pode dar uma lida nos PRs #1684 e #1686 para entender o que havia sido feito e o que aprendemos com a implementa√ß√£o ü§ù
</issue_1679_Exibir tabela de conte√∫dos (links para os t√≠tulos) na publica√ß√£o>

<issue_1681_N√£o √© poss√≠vel editar ou apagar um conte√∫do usando apenas o teclado>
### Descri√ß√£o

Descobri o problema lendo [este coment√°rio](https://www.tabnews.com.br/pedromclaro/f9486ce2-c9af-47dd-817d-b73cdc20b98e) do `pedromclaro`.

Usando apenas o teclado, √© poss√≠vel abrir o menu de a√ß√µes do conte√∫do, mas n√£o √© poss√≠vel edita-lo ou apaga-lo, pois o menu fecha sem realizar uma a√ß√£o.

### Passos para reproduzir o problema

1. Acesse uma publica√ß√£o ou coment√°rio.
2. Use o Tab at√© o foco chegar ao menu do conte√∫do (os tr√™s pontos no canto superior direito do conte√∫do).
3. Pressione espa√ßo ou Enter para exibir o menu de a√ß√µes.
4. O Enter deveria realizar a a√ß√£o que est√° focada, mas apenas fecha o menu.

No menu principal da p√°gina (menu hamb√∫rguer, tr√™s linhas no canto superior direito), est√° funcionando corretamente.

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Abri o issue bem na hora que o @aprendendofelipe [comentou no TabNews](https://www.tabnews.com.br/FelipeBarso/27f417e0-cc9a-464c-b0c5-99613596cb04) que est√° trabalhando na solu√ß√£o.
</issue_1681_N√£o √© poss√≠vel editar ou apagar um conte√∫do usando apenas o teclado>

<issue_1683_Tela de Insight dos Posts e Perfil>
### Descri√ß√£o

# Ideia Base
Que os autores tivessem uma nova tela onde seria poss√≠vel visualizar um gr√°fico de cliques, impress√µes, tempo m√©dio de leitura e etc.

# Sugest√£o de Endpoints
- {base_url}/analisar/Usu√°rio/como_fazer_um_script
- {base_url}/analisar/Usu√°rio

A p√°gina de insight de posts poderia se parecer com a /status do tabnews, assim sendo necess√°rio poucas mudan√ßas no front (eu acho).

![download](https://github.com/filipedeschamps/tabnews.com.br/assets/158287163/70e5a0a7-30bf-4e72-a5ea-bff3dc42235e)



### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@DeuzivanLima, obrigado pela sugest√£o!

Tempo de leitura, ou de sess√£o, √© um tipo de dado que provavelmente nunca coletaremos dos usu√°rios do TabNews.

J√° o alcance das publica√ß√µes √© tema relacionado com #1115, ent√£o vou fechar aqui para manter a conversa centralizada l√°. 

Combinado? ü§ù
</issue_1683_Tela de Insight dos Posts e Perfil>

<issue_1688_Pesquisa de conte√∫do>
### Descri√ß√£o

Algo que eu sinto falta no uso do tabnews hoje √© a pesquisa de conte√∫do, uma pesquisa simples mesmo s√≥ pra conseguirmos filtrar melhor o conte√∫do de interesse.

### Sugest√£o de implementa√ß√£o

Creio que a implementa√ß√£o de uma PrefixSearch seria bem legal de implementar.

>> Coment√°rio de aprendendofelipe:
@FernandoA12, j√° temos uma ferramenta de busca simples, e que atende nossa demanda atual.

Voc√™ encontra ela no Header ou, em telas menores, no menu de usu√°rio.

<img width="187" alt="Captura de Tela 2024-05-07 √†s 13 49 38" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/e73e9e99-1c57-472f-a477-b6b0406d38cf">

<img width="671" alt="Captura de Tela 2024-05-07 √†s 13 47 24" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/47eb5af5-4493-41c5-bbe5-0870b5d15a62">

<img width="419" alt="Captura de Tela 2024-05-07 √†s 13 48 09" src="https://github.com/filipedeschamps/tabnews.com.br/assets/77860630/19fd7c92-294f-42dc-af55-cd05f8754422">


Veja a conversa em #927, e pode acrescentar algo l√° se achar necess√°rio. ü§ù
</issue_1688_Pesquisa de conte√∫do>

<issue_1690_Bloquear cadastro com senhas fracas>
### Descri√ß√£o

Eu acho que permitir o cadastro dos usu√°rios com senhas fracas √© um dos requisitos menos desej√°veis para qualquer aplica√ß√£o web atualmente. Atualmente o tabnews permite essa caracter√≠stica.

### Sugest√£o de implementa√ß√£o

Poder√≠amos criar valida√ß√µes para cria√ß√£o de novos usu√°rios que tentem utilizar senha fraca, sugiro que uma senha forte seja composta por:
- No m√≠nimo 8 caracteres (como √© atualmente)
- Contenha no m√≠nimo 1 caractere min√∫sculo, mai√∫sculo e um especial

De forma opcional vejo a possibilidade de solicitar a atualiza√ß√£o das senhas dos usu√°rios existentes para o novo padr√£o.

>> Coment√°rio de Rafatcb:
Obrigado pela sugest√£o, @kaioenzo :handshake:  Tenho quase certeza que isso j√° foi discutido, mas procurei e n√£o encontrei nada.

Acho que esses requisitos de cria√ß√£o de senha n√£o s√£o interessantes. [Essa resposta](https://ux.stackexchange.com/a/55678/137760) no UX Stack Exchange fala um pouco sobre isso, e a [tirinha do XKCD](https://xkcd.com/936/) deixa mais claro:

![Tirinha explicando que uma senha com 8 caracteres, letras mai√∫sculas e min√∫sculas, pontua√ß√£o e n√∫mero √© mais f√°cil de descobrir por for√ßa bruta do que uma com quatro palavras, que possui maior entropia](https://imgs.xkcd.com/comics/password_strength_2x.png)

Tamb√©m tem [essa resposta](https://security.stackexchange.com/a/238460/250104) do Security Stack Exchange.

A resposta do UX Stack Exchange mencionava que bloquearam as 10 mil senhas mais comuns, o que pode ser mais interessante do que exigir uma "senha dif√≠cil", mas n√£o sei o qu√£o necess√°rio isso √© para o TabNews. E precisar√≠amos filtrar das 10 mil senhas, quais possuem >= 8 caracteres.

>> Coment√°rio de kaioenzo:
@Rafatcb, Entendo a quest√£o de UI, mas acredito termos alternativas para contornar isso, como barras de progresso que mudam de cor e indicam uma evolu√ß√£o durante a cria√ß√£o da senha, motivando o uso. Al√©m de diversas outras op√ß√µes.

Quanto a seguran√ßa, minha principal preocupa√ß√£o, vejo alguns pr√≥s como[ esse artigo ](https://www.cisa.gov/secure-our-world/use-strong-passwords) da Ag√™ncia de Ciber seguran√ßa Americana sugere e tantos outros como [esse post](https://sota.co.uk/why-having-strong-passwords-really-matters/).

Vejo que a implementa√ß√£o de fator de dupla autentica√ß√£o √© uma alternativa ainda melhor!

>> Coment√°rio de mvares:
@Rafatcb, se possivel, eu me ofere√ßo pra fazer o backend e implementar o que voc√™ disse. A parte do frontend seria interessante algu√©m fazer.

Ali√°s, o m√©todo mais aconselh√°vel e robusto que temos poderia ter uma no√ß√£o das senhas mais usadas e caso a **senha** atual do usu√°rio quando for registrar bata com algumas das mais usadas, podemos fazer uma alerta e n√£o manchar a UI.

>> Coment√°rio de Rafatcb:
@kaioenzo temos um issue sobre 2FA (ou MFA): #1171.

@mgrithm obrigado por se prontificar! Antes da implementa√ß√£o, precisamos ter mais claro o que realmente seria ben√©fico para n√£o correr o risco de implementar e ter o PR fechado por n√£o ser algo desejado.

Acredito que ter a medi√ß√£o no frontend talvez seja algo positivo, mas n√£o como requisito, e sim como indicador. Como o TabNews usa o Primer para a UI, costumo ver o comportamento do GitHub e a [documenta√ß√£o do Primer](https://primer.style/) como inspira√ß√£o/refer√™ncia. Infelizmente, n√£o encontrei nada sobre isso na documenta√ß√£o, mas se voc√™ for [editar sua senha no GitHub](https://github.com/settings/security), ver√° isso:

https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0e57531f-d822-4c0f-b380-99c18ec84f25

E a documenta√ß√£o para [criar uma senha forte](https://docs.github.com/pt/authentication/keeping-your-account-and-data-secure/creating-a-strong-password).

Mas veja, n√£o considero que eles fizeram um bom trabalho com isso, porque o usu√°rio pode escolher a senha `aaaaaaa1` e achar que √© forte, quando na verdade √© uma senha simples. No caso do GitHub, o p√∫blico alvo n√£o √© t√£o leigo, ent√£o isso n√£o tem um impacto t√£o negativo, e acredito que o p√∫blico do TabNews tamb√©m tenha mais conhecimento do que o "p√∫blico geral". [Aqui](https://security.stackexchange.com/a/131062/250104) fala um pouco mais sobre o cuidado que precisamos ter para criar uma pol√≠tica de senhas.

No [Wikipedia](https://en.wikipedia.org/wiki/Wikipedia:10,000_most_common_passwords) tem a lista das 10 mil senhas mais comuns, mas n√£o sei o qu√£o comum elas s√£o dentre as pessoas falantes da l√≠ngua portuguesa, por isso comentei que n√£o sei o qu√£o √∫til seria verificar isso no TabNews (e essa verifica√ß√£o, sim, seria no backend).

>> Coment√°rio de gpoleszuk:
@kaioenzo , na minha opini√£o, algo que sinto falta em v√°rios sites onde tenho conta, √© receber um email assim que o login √© realizado com sucesso, indicando detalhes do navegador que acessou e IP origem. Vi isso em um sistema do governo e achei muito bom. O Gmail j√° possui tal funcionalidade dentro da interface do webemail, reportando os 10 √∫ltimos recentes acessos, al√©m de poder enviar a notifica√ß√£o para um email alternativo. Desta forma, se algum intruso conseguir entrar na conta com algum artif√≠cio (senha vazada ou capturada e supondo 2FA desativado), consigo saber quando e de onde partiu. Um outro recurso √© apresentar para o usu√°rio um _banner_ logo ap√≥s o _login_ informando-o detalhes do √∫ltimo acesso assim como faz a plataforma Lattes.

Para aqueles que apreciam senhas f√°ceis mas querem ainda assim mant√™-la forte, a postagem do @Rafatcb √© bem intuitiva. Em vez adotar uma senha com alguns caracteres embaralhados, adote ent√£o uma _passphrase_. A charge na postagem √© bem did√°tica, apresentando um exemplo com as duas propostas.

A for√ßa de senha pode ser primeiramente deixada s√≥ no lado do cliente. Existem alguns algoritmos empregados por v√°rios websites e parece-me que cada um tem uma avalia√ß√£o diferente para uma mesma senha.  Se ainda assim o usu√°rio altera a requisi√ß√£o POST e envia uma senha fraca para o banco, seria o caso de uma suspens√£o tempor√°ria da conta, pois entende-se que √© uma esp√©cie de intrus√£o. Contudo, isso exige uma valida√ß√£o no _backend_.

Para o caso de for√ßa bruta, ap√≥s a terceira tentativa, um email reportando-a √© enviado juntamente com uma confirma√ß√£o de autentica√ß√£o. Por exemplo, pode usar o mesmo c√≥digo que voc√™s usam para confirmar a conta caso ela fique colocada em modo suspenso. O usu√°rio ou precisa esperar um tempo para nova tentativa ou acessar seu email, clicar num _link_ de confirma√ß√£o. Esta ideia de acesso √† conta por link de confirma√ß√£o √© utilizada pelo Facebook, se n√£o me engano, dispensando o uso de senha, mas o 2FA em outro dispositivo precisa estar ativo para garantir o m√≠nimo de seguran√ßa com 2 fatores.

Para alguns usu√°rios, estas funcionalidades podem paracer chateantes, logo poderiam ficar como op√ß√µes em uma √°rea de configura√ß√µes de funcionalidades personalizadas da conta. Cada usu√°rio ativa se desejar.

>> Coment√°rio de Rafatcb:
> Para o caso de for√ßa bruta, ap√≥s a terceira tentativa, um email reportando-a √© enviado juntamente com uma confirma√ß√£o de autentica√ß√£o.

N√£o vejo necessidade disso porque o usu√°rio n√£o pode fazer nada. Veja, por exemplo, as [atividades](https://account.live.com/Activity) da minha conta da Microsoft:

![12 tentativas de login a partir de pa√≠ses diferentes num intervalo de 10 horas](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/75ae7a39-e23e-4f32-aae1-d62482532271)

Ter algu√©m tentando acessar minha conta n√£o significa que eu preciso trocar de senha. A Microsoft nem me avisa desses logins, s√£o dezenas todos os dias, provavelmente tentando usar uma senha minha que j√° vazou em algum lugar. E, quando eu vejo os detalhes de uma tentativa e clico em _"Proteja a sua conta"_, recebo essa mensagem:

![Agradecemos o seu coment√°rio. N√£o se preocupe. Essa tentativa de entrada n√£o foi bem-sucedida. N√£o √© necess√°rio alterar sua senha. Saiba como tornar sua conta mais segura](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0e32b977-3ce0-4590-9428-facf691591da)

Acredito que o sistema deva se defender de n√∫meros altos de tentativas, ou locais suspeitos etc, mas n√£o precisa preocupar o usu√°rio sem necessidade. Inclusive, o fato do TabNews exigir o e-mail para realizar o login, e n√£o o nome de usu√°rio, j√° √© um grande passo para evitar receber esse spam de tentativas de login.

>> Coment√°rio de gpoleszuk:
@Rafatcb, n√£o imaginava que a Microsoft tinha essa interface disponivel com tantos detalhes. Deve fazer uns 2 anos que n√£o acesso mais o hotmail. Nem o Gmail nos mostra toda essa informa√ß√£o muito √∫til. S√≥ de ver a situa√ß√£o de qu√£o visada √© sua conta, refor√ßa ainda mais a necessidade de usar senhas muito fortes. Uma das dicas do Akita √© usar o n√∫mero m√°ximo de caracteres permitido pela plataforma, 2FA ou ainda MFA.

Sei que √© um grande trabalho para implementar essa funcionalidade no Tabnews. Talvez fique para outro momento quando a plataforma se consolidar. Nem todo mundo imagina qu√£o atacada √© uma conta de email por n√£o ter acessos a esses relat√≥rios de tentativa de acesso, ignorando a atual necessidade de que √© mais que obrigat√≥rio utilizar senhas longas e fortes e/ou m√∫ltiplos fatores de autentica√ß√£o. No caso de sua conta, parece que √© um ataque bem distribu√≠do, caso n√£o seja um √∫nico indiv√≠duo chaveando as tentativas atr√°s de uma VPN que possui hosts em diferentes na√ß√µes.

Valeu  por compartlhar esse conhecimento conosco.
</issue_1690_Bloquear cadastro com senhas fracas>

<issue_1694_Marcar um coment√°rio como resposta?>
### Sugest√£o de implementa√ß√£o
Marcar um coment√°rio como resposta

### Descri√ß√£o

Estou fazendo alguns PRs para o TabNews e estava pensando se seria uma boa criar algo como no GitHub, marcar uma resposta como uma resposta marcada, resposta que o usu√°rio queria?

Algo assim:

![alt tela](https://i.ibb.co/vDx3VMX/Captura-de-tela-2024-05-13-164618.png)

Se isso for interresante para os usu√°rios, √© poss√≠vel abrir um PR para adicionar essa funcionabilidade.

O que voc√™s acham?

>> Coment√°rio de daniloabramo:
Eu acho uma id√©ia muito interessante, j√° havia sentindo falta dela em algumas ocasi√µes, mas eu acho que deve ter alguns cuidados na hora de implementar ela.

Diferente do Stack Overflow que utiliza esse atributo como maneira de finalizar a discuss√£o, aqui deveria funcionar como um exemplo a ser seguido, √© o que eu acho.

Al√©m disso, acredito que deveria ter algumas condi√ß√µes para destacar o coment√°rio:
1 - Precisa dois ou mais coment√°rios;
2 - Pode-se destacar apenas um coment√°rio por publica√ß√£o. 
3 - Haver√° um custo de tabcoins para destacar? Ser√° maior do que o custo de 1 tabcoin votar como relevante?
4 - O usu√°rio que tem um coment√°rio destacado receberia esses tabcoins a mais?
5 - Dever√≠amos pensar em alguma trava de seguran√ßa, para que quando um usu√°rio tiver seu coment√°rio destacado n√£o modifique para algo prejudicial depois? 

Outro ponto importante √© o design, acho que poder√≠amos seguir com a borda que destaca quando √© seu coment√°rio na postagem, com um dos tons de azul que a plataforma usa. Al√©m disso, em vez de um √≠cone ‚Äú‚úî‚Äù, talvez um s√≠mbolo de fixado com a mensagem: ‚ÄúFixado pelo Autor‚Äù, seja mais interessante e continue a promover a discuss√£o, em vez de ‚ÄúMarcada como Resposta‚Äù, que leva um tom de encerramento.

>> Coment√°rio de mthmcalixto:
@daniloabramo voc√™ levantou alguns pontos interessantes.

> 3 - Haver√° um custo de tabcoins para destacar? Ser√° maior do que o custo de 1 tabcoin votar como relevante?

Isso pode ser muito bom, assim vai fazer com que as pessoas facam mais coment√°rios, e coment√°rios com maior probalibilidade de ganho ao "responder" a d√∫vida do autor ser√° gratificado.

> 4 - O usu√°rio que tem um coment√°rio destacado receberia esses tabcoins a mais?

Sim, acredito que esse seja o caminho, o autor pode enviar 1,2 tabcoins para a melhor resposta que ele achou relevante, pode fazer at√© um random em valores que ele pode ganhar com base na quantidade de coment√°rios.

> 5 - Dever√≠amos pensar em alguma trava de seguran√ßa, para que quando um usu√°rio tiver seu coment√°rio destacado n√£o modifique para algo prejudicial depois?

Sim, √© a melhor maneira de impedir algu√©m de prejudicar removendo, mas podemos dar a op√ß√£o sem remover os tabcoins do primeiro fixado.

Sobre os outros pontos, √© a melhor forma de se fazer isso mesmo.

> Outro ponto importante √© o design, acho que poder√≠amos seguir com a borda que destaca quando √© seu coment√°rio na postagem, com um dos tons de azul que a plataforma usa. Al√©m disso, em vez de um √≠cone ‚Äú‚úî‚Äù, talvez um s√≠mbolo de fixado com a mensagem: ‚ÄúFixado pelo Autor‚Äù, seja mais interessante e continue a promover a discuss√£o, em vez de ‚ÄúMarcada como Resposta‚Äù, que leva um tom de encerramento.

Eu imagino dessa forma;

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/121470728/a1968620-9e22-4dea-b195-326233cd523d)

>> Coment√°rio de daniloabramo:
Depois de um tempo acabei mudando um pouco de ideia sobre o design, colocar uma caixa em volta pode acabar poluindo e perdendo o clean do Tab News. Al√©m disso, colocar o √≠cone no final do texto pode acabar passando despercebido se o fixado se prolongar bastante. 

Eu elaborei mais algumas sugest√µes, talvez um meio termo entre essas e as que elaborou seja a escolha correta:

V1 Desktop, ponto de vista do autor do coment√°rio:
![v1](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/79a7e46c-aace-4b2a-9d29-fb9de436a36e)

V2 Desktop, ponto de vista do autor do coment√°rio:
![v2](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/456d10db-5014-407f-8003-671269b28090)

V3 Desktop, ponto de vista do leitor:
![v3](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/90758647-4889-4dc3-b8c2-72a51d7950d4)

V4 Desktop, ponto de vista do leitor:
![v4](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/a4458a0f-9b27-4b4e-9838-eb1c022da27a)

V1 Mobile, ponto de vista do autor e leitor:
![v5](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/1479d5e2-e62c-46d7-b3cc-da59ce5cd92d)

V2 Mobile, ponto de vista do autor do coment√°rio:
![v7](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/b87ac6b3-e954-4438-9500-e2ec823c7c9f)

V2 Mobile, ponto de vista do leitor:
![v6](https://github.com/filipedeschamps/tabnews.com.br/assets/142537432/2fa1c31b-ac53-444e-939d-01998f6aba63)

>> Coment√°rio de hkotsubo:
Vou colocar aqui o que [j√° tinha dito no site](https://www.tabnews.com.br/kht/2b50a051-5b41-45cc-aa08-5b5c2c0ff832), para n√£o se perder:

---

N√£o sei se √© uma boa.

O Stack Overflow criou isso e na √©poca parecia uma boa ideia. Mas com o tempo perceberam que muitas vezes n√£o √© o ideal, tanto que h√° um tempo atr√°s ([em **2021**](https://meta.stackexchange.com/q/369568/401803)) mudaram a ordena√ß√£o das respostas: antes a resposta aceita (a que est√° marcada com ‚úî) ficava sempre afixada no topo, mesmo que fosse a menos votada. Agora as respostas s√£o ordenadas por votos, independente do ‚úî.

Isso porque em muitos casos a resposta aceita n√£o era a melhor. O que acontece √© que, em geral, quem pergunta sobre algo √© porque n√£o conhece muito bem o assunto, e portanto √© a pessoa menos qualificada para dizer se aquela resposta √© realmente boa. Para isso, os votos s√£o um indicativo melhor (tamb√©m n√£o √© um sistema perfeito, mas √© melhor do que a indica√ß√£o de uma √∫nica pessoa que geralmente √© quem menos conhece do assunto).

E isso porque o Stack Overflow privilegia perguntas objetivas sobre c√≥digo, ou seja, teoricamente deveria haver pouca margem para subjetividade (mas na pr√°tica, viu-se que n√£o √© bem assim). Agora imagine isso no TabNews, onde muitos posts nem sequer s√£o perguntas de fato, e sim discuss√µes (muitas delas subjetivas) com v√°rias opini√µes diferentes. Qual o valor da pessoa marcar uma resposta opinativa, al√©m de dizer que ela concorda com aquilo?

Porque j√° vi casos de coment√°rios excelentes, com v√°rios votos, mas que s√≥ o autor do post discordava. Neste caso, ele n√£o marcaria este coment√°rio como resposta, s√≥ por pura discord√¢ncia (mesmo que a comunidade tenha avaliado bem). Pra mim, a vota√ß√£o geral √© um indicativo melhor, pois mostra o que a comunidade como um todo achou - e eu entendo que a avalia√ß√£o coletiva gera um valor concreto maior do que a individual.

O autor n√£o √© especial neste sentido, o voto ou a concord√¢ncia dele n√£o valem mais do que os dos outros usu√°rios s√≥ porque foi ele quem fez a pergunta. O conte√∫do gerado aqui √© para todo mundo, ent√£o a avalia√ß√£o de todos deveria ter o mesmo peso. Se o autor concorda com algo, basta votar, e se quiser acrescentar alguma informa√ß√£o relevante, √© s√≥ responder ao coment√°rio.

Entendo que o recurso **deveria** ser usado s√≥ para casos em que h√° um problema de fato a ser resolvido, mas a partir do momento em que estiver dispon√≠vel, com certeza as pessoas usar√£o para marcar respostas que dizem tudo que ela queria ouvir, mesmo que seja o coment√°rio mais prejudicial e/ou menos votado. Por isso eu acho que os votos s√£o um indicativo melhor.


---

Outro ponto √© muitas d√∫vidas que aparecem no site s√£o subjetivas, tipo "_Qual a melhor linguagem/framework?_", "_Devo aprender A ou B?_", "_Qual tecnologia √© mais f√°cil pra conseguir emprego?_" e por a√≠ vai. Ou seja, d√∫vidas subjetivas, cujas respostas ser√£o todas opinativas.

E acaba caindo no problema de no fundo n√£o ter uma resposta certa (o que √© normal em discuss√µes do tipo). E a√≠ a pessoa marca a resposta que gostou mais - geralmente a que confirma o que ela j√° acreditava ser o "certo" (isso √© muito comum em v√°rios sites, n√£o acho que ser√° diferente aqui).

---

Se a ideia √© gratificar quem fez o coment√°rio, j√° existe uma forma de faz√™-lo: votando nele! :-)

E melhor ainda, n√£o √© s√≥ o autor que pode votar, qualquer um pode. Afinal, o conte√∫do tamb√©m pode ser √∫til para outros que est√£o s√≥ lendo a discuss√£o, mas n√£o quiseram participar dela. Por que restringir - ou dar mais peso para - a classifica√ß√£o dos coment√°rios somente para quem criou o post? A ideia do site √© que todos possam avaliar todos.

Al√©m disso, √© poss√≠vel votar mais de uma vez no mesmo coment√°rio (existem alguns limites, se n√£o me engano s√£o 3 votos a cada 72 horas), ent√£o se algo te ajudou muito, basta dar mais votos.

Outro ponto √© que os votos n√£o se limitam a um √∫nico coment√°rio. Por exemplo, se v√°rias pessoas me ajudaram, posso votar em todas. J√° na sua proposta, entendi que o autor tem que escolher apenas um.

Tamb√©m foi comentado que a ideia √© fazer "_com que as pessoas criem mais coment√°rios, mais intera√ß√£o e principalmente, evita coment√°rios curtos_".

O sistema de vota√ß√£o j√° foi pensado para estimular mais coment√°rios de qualidade e foi at√© alterado para evitar os curtos ou ruins: antes qualquer coment√°rio dava pontos, agora precisa ter um m√≠nimo de palavras (n√£o lembro a regra exata) e tamb√©m leva em conta o hist√≥rico recente (se tiver muitos coment√°rios anteriores com pontua√ß√£o boa, vc ganha mais - a f√≥rmula √© complicada e vivia mudando, n√£o sei como est√° hoje).

Enfim, a meu ver a mec√¢nica de votos e TabCoins j√° cobre esses pontos. Al√©m disso, ela √© bem complexa, e eu prefiro focar em ajust√°-la conforme necess√°rio. N√£o sei se precisa criar outro mecanismo paralelo, sendo que o atual j√° parece atender os pontos que vc mencionou, e - na minha opini√£o - com menos restri√ß√µes.

>> Coment√°rio de mthmcalixto:
@hkotsubo, vamos continuar aqui.

Eu continuo entendendo voc√™, mas veja meu pensamento para essa nova modifica√ß√£o.

Entenda que isso n√£o seria necessariamente uma verdade absoluta, como eu mencionei anteriormente, mas sim uma perspectiva relativa.

Ter outros meios de ganho de Tabcoins na minha vis√£o sempre ser√° sempre bem vinda.

A proposta ou ideia nesse caso de marca uma resposta ou fixar pelo autor √© mais para ter mais contexto na publica√ß√£o, como eu disse se o autor gostou, foi v√°lido para ele, ele pode "destacar" aquele coment√°rio, n√£o quer dizer que as pessoas v√£o concordar com aquele coment√°rio.

A ideia de dar a liberdade para outras pessoas podem ser interessante, em vez de fixado pelo autor, "Fixado Pela Comunidade", "Coment√°rio marcado como relevante"... Mas pode entrar a quest√£o, esse coment√°rio ele vai ser destacado por causas dos Tabcoins?

N√£o podemos entrar no modo, "eu estou acostumado assim" e n√£o ter mudan√ßas relevantes.

Deixo aberto para a gente elaborar algo relevante, que vai agregar para a comunidade, tenho certeza que chegaremos em um ponto interessante para implementar essa nova modifica√ß√£o.

>> Coment√°rio de hkotsubo:
> *n√£o seria necessariamente uma verdade absoluta*

Isso eu entendi, e concordo. N√£o estamos aqui pra definir "verdades absolutas".

Meu ponto √© que a partir do momento em que vc d√° um destaque especial para uma resposta (uma borda/cor diferente que seja), ela acaba naturalmente ganhando mais aten√ß√£o. E muita gente pode - at√© mesmo de forma inconsciente - achar que aquela resposta √© "melhor", caso contr√°rio n√£o estaria destacada das demais. Afinal de contas, √© uma "resposta selecionada", ent√£o deve ser melhor, n√©?

√â justamente o problema que o Stack Overflow percebeu: muita gente costuma ler (e copiar sem pensar) apenas a resposta aceita e ignora todo o resto. Mas eu j√° vi **muitos** casos em que as outras respostas eram melhores. Por isso mudaram a ordena√ß√£o para levar em conta apenas os votos, pois entenderam que a avalia√ß√£o coletiva t√™m mais valor do que a individual (nenhuma delas √© perfeita, claro, mas perceberam - depois de mais de 10 anos e alguns milh√µes de posts - que na m√©dia o coletivo tende a errar menos).

Ent√£o mesmo que a inten√ß√£o n√£o seja definir o que √© a "verdade", as pessoas podem acabar entendendo assim. Ou no m√≠nimo v√£o achar que aquela resposta tem alguma coisa especial pra merecer uma apresenta√ß√£o diferenciada - e at√© tem (o autor marcou), mas ser√° que s√≥ isso justifica tal destaque? E quanto mais destaque esta resposta tiver, mais essa impress√£o pode se acentuar.

Acho que podemos pensar em um meio termo: o autor pode at√© marcar um dos coment√°rios, mas esse n√£o ganharia tanto destaque. Poderia ser uma indica√ß√£o discreta, como um pequeno √≠cone abaixo da pontua√ß√£o, por exemplo. E que deixe bem claro que foi o autor que escolheu (pois "resposta selecionada" n√£o deixa claro quem foi que a selecionou).

---

Dito isso, reconhe√ßo que o sistema de votos tamb√©m pode ter um efeito parecido: "_Olha essa resposta com trocentos votos, deve ser melhor, n√©?_" - o que nem sempre √© o caso (no Reddit costuma ser o contr√°rio, por exemplo).

Mas ainda sim, a experi√™ncia de outros sites maiores (principalmente o Stack Overflow), que j√° est√£o no ar h√° anos, com milh√µes de usu√°rios e posts, mostrou que a avalia√ß√£o coletiva tende a errar menos, **desde que os votos sejam bem usados**. Ent√£o eu prefiro focar em melhorar o mecanismo existente, estimular as pessoas a votarem mais e melhor, etc. Acho que isso j√° geraria mais TabCoins para todos, sem precisar de outro mecanismo para ganh√°-los.

> *Ter outros meios de ganho de Tabcoins na minha vis√£o sempre ser√° sempre bem vinda*

N√£o sei. Na minha vis√£o, n√£o pode ser f√°cil demais, sen√£o pode desbalancear as coisas (j√° que este √© um mecanismo essencial para o funcionamento do site). Mas a√≠ j√° √© outra discuss√£o...

---

N√£o me entenda mal, sou totalmente a favor de mudan√ßas.

Por exemplo, na √©poca em que qualquer coment√°rio dava pontos (ou seja, quem escrevia s√≥ "Obrigado" ou "Legal" ganhava 2 pontos s√≥ por postar) eu fui um dos que defenderam ferrenhamente que isso fosse mudado. Ent√£o trocaram para outro sistema que fez os TabCoins ficarem mais escassos e dif√≠ceis de ganhar, e novamente fui um dos que defenderam que isso fosse mudado, pois se antes estava f√°cil demais, agora tinha se tornado muito dif√≠cil, a ponto de desestimular a participa√ß√£o. E s√≥ depois de muita discuss√£o, mudaram para o sistema atual (que me parece mais balanceado do que antes, al√©m de beneficiar quem gera conte√∫do de qualidade com frequ√™ncia).

N√£o participo h√° tanto tempo (somente 1 ano e pouco), mas enfim, essa foi a mudan√ßa mais relevante que acompanhei. Afinal, ela alterou toda a din√¢mica de votos e TabCoins, que s√£o os principais mecanismos de participa√ß√£o do site.

Enfim, contei essa hist√≥ria toda pra pontuar uma coisa: naqueles casos eu s√≥ defendi a mudan√ßa porque vi mais vantagens do que desvantagens em rela√ß√£o a como era. O que n√£o √© o caso aqui, pelos motivos que j√° expliquei.

De qualquer forma, a issue est√° aberta, vamos esperar e ver no que d√° :-)

>> Coment√°rio de Rafatcb:
Eu tendo a concordar com o hkotsubo aqui. Acho que essa implementa√ß√£o n√£o tem muitos pontos positivos e aumenta a complexidade tanto do c√≥digo, quanto da interface e tamb√©m da economia de TabCoins.

Parece que um dos pontos defendidos √© ter mais uma forma de ganhar TabCoins (veja as existentes no [FAQ](https://www.tabnews.com.br/faq#ganhar-tabcoins)), mas hoje acredito que estamos num bom equil√≠brio. Por experi√™ncia pr√≥pria digo que uma publica√ß√£o bem feita por semana, somado ao login di√°rio e mantendo um baixo ac√∫mulo de TabCoins, j√° te deixa numa condi√ß√£o boa de ganho de TabCoins.
</issue_1694_Marcar um coment√°rio como resposta?>

<issue_1695_Melhorar a Exibi√ß√£o de Erros de Autentica√ß√£o>
### Descri√ß√£o

Atualmente, quando os usu√°rios tentam fazer login, a aplica√ß√£o apenas exibe uma mensagem gen√©rica de erro caso ocorram problemas de autentica√ß√£o, como "Dados n√£o conferem". No entanto, essa abordagem n√£o fornece informa√ß√µes detalhadas o suficiente para que os usu√°rios corrijam seus erros facilmente.




### Sugest√£o de implementa√ß√£o

Sugiro aprimorar a forma como os erros de autentica√ß√£o s√£o exibidos, para oferecer uma experi√™ncia mais informativa e √∫til aos usu√°rios. Aqui est√£o algumas sugest√µes:

1. **Exibi√ß√£o Individual de Erros:** Ao inv√©s de uma mensagem gen√©rica, a aplica√ß√£o deve identificar e exibir cada tipo de erro de forma individual. Por exemplo, se o email estiver incorreto, a mensagem deve especificar "Email inv√°lido". Se a senha estiver errada, a mensagem deve indicar "Senha incorreta". Se a senha e o email estiverem incorretos , a mensagem deve especificar "Email e Senha inv√°lidos"

2. **Detalhes Adicionais:** Al√©m de identificar o tipo de erro, a mensagem de erro tamb√©m deve fornecer detalhes adicionais quando poss√≠vel. Por exemplo, se o email fornecido n√£o estiver registrado no sistema, a mensagem pode sugerir isso..

3. **Feedback Orientado para A√ß√£o:** As mensagens de erro devem ser formuladas de maneira a orientar os usu√°rios sobre como corrigir o problema. Por exemplo, se o email estiver incorreto, a mensagem pode incluir uma sugest√£o para verificar se o email foi digitado corretamente. Se a senha estiver incorreta, a mensagem pode encorajar o usu√°rio a tentar novamente, lembrando da contidade m√≠nima de 8 caracteres, ou futuramente se adicionado ao cadastro de usu√°rio, lembrando da sensibilidade a mai√∫sculas/min√∫sculas.

**Benef√≠cios Esperados:**
- Melhor experi√™ncia do usu√°rio durante o processo de autentica√ß√£o.
- Redu√ß√£o da frustra√ß√£o dos usu√°rios ao lidar com problemas de login.
- Aumento da efic√°cia na resolu√ß√£o de erros por parte dos usu√°rios.

**Observa√ß√µes:**
Este √© um passo importante para melhorar a usabilidade e a efic√°cia do processo de autentica√ß√£o em nossa aplica√ß√£o. Implementar essa melhoria n√£o apenas tornar√° mais f√°cil para os usu√°rios corrigir seus erros, mas tamb√©m contribuir√° para uma experi√™ncia geral mais positiva com nossa plataforma.

>> Coment√°rio de Rafatcb:
@esmsena obrigado pela sugest√£o! Voc√™ tem raz√£o quando diz que isso tornaria a usabilidade melhor: para o usu√°rio que esqueceu algo para acessar a conta, ficaria bem mais f√°cil. O ponto √© que o sistema est√° desse jeito por quest√µes de seguran√ßa. Por exemplo:

1. A mensagem de rate-limit no endpoint `/sessions` (para realizar login) √© uma mensagem de "Dados n√£o conferem" e com uma lentid√£o falsa, como se estivesse verificando os dados. https://github.com/filipedeschamps/tabnews.com.br/pull/635
2. A escolha por usar a mesma mensagem de erro foi consciente, e isso faz com que um invasor tenha dificuldade em saber se uma conta com aquele e-mail existe ou n√£o. https://github.com/filipedeschamps/tabnews.com.br/pull/201#issuecomment-1051127268
3. Existe um issue aberto para a requisi√ß√£o de login demorar o mesmo tempo caso o usu√°rio exista ou n√£o. https://github.com/filipedeschamps/tabnews.com.br/issues/186

[Essa resposta](https://security.stackexchange.com/a/62667/250104) no Security Stack Exchange fala um pouco mais sobre isso.

Agora, eu n√£o acho que estamos fazendo do jeito certo. Por exemplo, vamos supor que eu queira acessar a conta de algu√©m que n√£o tenho certeza do e-mail. Pelo login, n√£o consigo descobrir se o e-mail est√° cadastrado, mas pela recupera√ß√£o de senha eu consigo:

![Mensagem "O "email" informado n√£o foi encontrado no sistema." ao tentar recuperar senha](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/b4a22b6e-5a9d-46d5-8b95-54778d1496ab)

E tamb√©m no cadastro, que j√° √© um fluxo mais complicado para a pessoa descobrir se a conta existe, porque num teste de for√ßa bruta acabar√° criando contas sem querer, at√© cair no firewall:

![Mensagem "O email informado j√° est√° sendo usado." ao tentar cadastrar uma conta](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/0f1ebb49-c2fa-45c7-969b-4fdbecee1fd5)

Ent√£o eu acredito que temos duas op√ß√µes:

1. **Mudar as mensagens de erro no login.** Isso impactar√° na mensagem de rate limit, que se for diferente, ficar√° f√°cil de perceber que a pessoa j√° est√° sem cota de requisi√ß√µes.
2. **Mudar as outras mensagens de erro (cadastro e recupera√ß√£o de senha).** No caso de recupera√ß√£o de senha, acho que √© uma pr√°tica comum uma mensagem do tipo _"Um e-mail foi enviado caso a conta exista"_ ou algo parecido. J√° no cadastro, n√£o sei como poderia ficar.

Quem puder contribuir nesse assunto, ser√° √≥timo.

>> Coment√°rio de aprendendofelipe:
Pelo p√∫blico do TabNews, acho que vale a pena priorizar a seguran√ßa ao inv√©s de mostrarmos erros espec√≠ficos em caso de falhas de login.

Tanto que ainda est√° pendente a #186, que tem como uma das inten√ß√µes, evitar qualquer maneira de descobrir se um email j√° est√° cadastrado no sistema, o que implica n√£o s√≥ em falsificar um tempo de valida√ß√£o de senha, mas tamb√©m devolver mensagens padronizadas no cadastro e recupera√ß√£o de senha.

>> Coment√°rio de Rafatcb:
Ent√£o, para organizar aqui, o que precisamos fazer para resolver este issue √©:

- [ ] Mudar a mensagem de erro no cadastro caso o e-mail j√° esteja utilizado. _(n√£o sei qual mensagem utilizar, seria bom ver como outros sites lidam com isso)_
- [ ] Mudar a mensagem na recupera√ß√£o de senha para algo neutro, do tipo _"Um e-mail foi enviado caso a conta exista"_.

Caso algu√©m tenha sugest√µes para a mensagem no cadastro, pode comentar. Acredito que mudar para algo como _"N√£o √© poss√≠vel utilizar este e-mail"_ j√° seja uma mudan√ßa positiva, visto que ainda fica claro qual √© o erro, mas n√£o fica claro se existe uma conta com esse e-mail, ou se uma conta j√° o utilizou e ela foi banida etc. Acho que mudar para algo gen√©rico como _"Dados inv√°lidos, tente novamente"_ ou qualquer coisa assim, seria uma experi√™ncia bem pior.

O que voc√™s acham?

>> Coment√°rio de aprendendofelipe:
@esmsena, voc√™ foi citada na publica√ß√£o sobre as novidades do TabNews üéâ

https://www.tabnews.com.br/FelipeBarso/tabnews-5k-no-github-melhorias-de-seguranca-e-mais-novidades
</issue_1695_Melhorar a Exibi√ß√£o de Erros de Autentica√ß√£o>

<issue_1703_Melhorar processamento dos coment√°rios>
### Descri√ß√£o

N√£o h√° m√≠nimo de caracteres a serem utilizados em um coment√°rio, o que pode trazer problemas a aplica√ß√£o.

### Passos para reproduzir o problema

1. Clique em responder
2. Escreva um coment√°rio com um caractere ou com 2000 caracteres

### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

Deve-se colocar um m√≠nimo de pelo menos 20 caracteres e m√°ximo 2000

>> Coment√°rio de kaique-soares:
@MilenaBaruc, obrigado por reportar mas esse comportamento que voc√™ descreveu √© o esperado mesmo :+1: 

---

> N√£o h√° m√≠nimo de caracteres a serem utilizados em um coment√°rio

A quantidade m√≠nima de caracteres √© definida aqui:
https://github.com/filipedeschamps/tabnews.com.br/blob/74ca3780d80d4562ec5cb4ee49ca321e7c1f8fe2/models/validator.js#L234

E a m√°xima aqui:
https://github.com/filipedeschamps/tabnews.com.br/blob/74ca3780d80d4562ec5cb4ee49ca321e7c1f8fe2/models/validator.js#L235

> Escreva um coment√°rio com um caractere ou com 2000 caracteres

Repare que as condi√ß√µes que voc√™ testou s√£o permitidas :+1: 

---

Fez sentido? Caso sim, acho que podemos fechar essa issue, certo?

>> Coment√°rio de aprendendofelipe:
Em complemento √† resposta do @kaique-soares, o corpo dos coment√°rios segue as mesmas regras das publica√ß√µes *root*, tudo √© tratado como conte√∫do, e isso √© uma caracter√≠stica proposital do TabNews.

Essa caracter√≠stica j√° foi abordada diversas vezes pelo @filipedeschamps, e uma delas acontece na wiki:

https://github.com/filipedeschamps/tabnews.com.br/wiki/016.-Layout-de-dentro-da-not%C3%ADcia

> ...√â importante ser assim, principalmente ter um espa√ßo grande para a pessoa digitar o seu coment√°rio (ter o mesmo espa√ßo que a pessoa teve para criar a not√≠cia principal)...

Outro ponto relacionado √© que, mesmo aceitando a cria√ß√£o de conte√∫dos com um √∫nico caractere, esse conte√∫do n√£o ir√° ganhar TabCoins iniciais (#1267), e muito provavelmente ser√° negativado.

Vou fechar a issue, mas se houver algo a acrescentar, com justificativa para modificar esse comportamento, podemos reabrir o debate ü§ù
</issue_1703_Melhorar processamento dos coment√°rios>

<issue_1710_havera uma vers√£o em ingl√™s ?>
### Assunto

Reposit√≥rio

### D√∫vida

√â um projeto inteiramente pt-br ou ira ter uma vers√£o em ingl√™s ??

>> Coment√°rio de Rafatcb:
Esse assunto foi tratado nos prim√≥rdios do TabNews, no issue https://github.com/filipedeschamps/tabnews.com.br/issues/35, e o Filipe trouxe uma excelente resposta na √©poca (https://github.com/filipedeschamps/tabnews.com.br/issues/35#issuecomment-895587739), onde cito em especial:

> Minha opini√£o sobre internacionalizar o TabNews (e pode ser falta de vis√£o minha e estou super aberto a corre√ß√£o), √© que n√£o ser√° f√°cil lan√ßar um projeto internacional e n√£o tem nada a ver com a quest√£o t√©cnica (nem se fizer agora ou depois tanto faz), tem a ver com **penetra√ß√£o do produto no mercado**. O principal ativo do TabNews n√£o √© a tecnologia, e nem como estamos usando ela para aplicar nossas ideias (TabCoins, Xp, etc...), o principal ativo √© a participa√ß√£o das pessoas aqui no reposit√≥rio, depois participando criando not√≠cias, comentando coisas com valor concreto e participando do fluxo completo de contribui√ß√£o. E a vers√£o brasileira √© a que est√° mais pr√≥xima dessa realidade, pelo fato das pessoas sensacionais que se reuniram ao redor do canal, se tornaram membros e est√£o aqui nesse reposit√≥rio discutindo isso ‚ù§Ô∏è  n√£o tem nada disso constru√≠do no ambiente internacional, e construir isso √© um longo caminho, **longo mesmo**, e um mar vermelho.

Esse assunto foi relembrado em mar√ßo deste ano: https://github.com/filipedeschamps/tabnews.com.br/issues/1648#issuecomment-1999640564

> Talvez um dia chegue o momento de repescar a https://github.com/filipedeschamps/tabnews.com.br/issues/35, mas isso n√£o est√° nos planos de m√©dio prazo, por isso vou fechar a issue. ü§ù

Como a nossa vis√£o n√£o mudou nesses meses, vou fechar este issue e, quando (ou se) chegar o momento, podemos reabrir o #35 e tratar o assunto l√°.

Vamos focar nossos esfor√ßos no p√∫blico falante da l√≠ngua portuguesa, tanto na produ√ß√£o de conte√∫do dentro do TabNews quanto na cria√ß√£o de funcionalidades √∫teis para n√≥s :handshake:

>> Coment√°rio de cardosource:
Entendi, obrigado por repassar
</issue_1710_havera uma vers√£o em ingl√™s ?>

<issue_1714_Implementa√ß√£o do pubsubhubbub na RSS>
### Descri√ß√£o

Recentemente eu estava pesquisando sobre notifica√ß√µes do youtube e encontrei um servi√ßo da google chamado PubSubHubBub, A ideia por tr√°s do PubSubHubbub √© enviar conte√∫do em vez de for√ßar os clientes a pesquis√°-lo, que normalmente √© como as implementa√ß√µes de API e no feed RSS atual s√£o projetadas para funcionar. 

O PubSubHubBub funciona com o servidor ao criar uma nova postagem ele notificar um hub, esse hub distribuir√° as informa√ß√µes para os assinantes por meio de um webhook previamente configurado pelo assinante.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/73259021/737c98d6-8edf-4d5b-b27e-4436f5d38798)

Desse modo isso reduziria a necessidade de chamar o feed RSS para buscar novas postagens, reduzindo o traf√©go ao mesmo tempo que continua mantendo os assinantes informados das atualiza√ß√µes.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de HarukaYamamoto0:
N√£o sou um expect mas realmente, estava dando uma pesquisada aqui a achei o WebSub (nome atual para o PubSubHubBub) um meio bem vi√°vel de poder notificar aos usu√°rios que teve um novo conte√∫do publicado por exemplo, at√© existe a t√©cnica de polling que for√ßa os pr√≥prios usu√°rio ficar olhando se tem um conte√∫do atualizado (eu fazia isso com a api do YouTube), mas sinceramente ficar usando polling eu acho uma m√° pr√°tica.

Eu queria at√© tentar implementar isso, mas t√¥ sem meu pc, mas acredito que se essa feature for implementada, vai aparecer uma grande quantidade de clients, inclusive eu t√¥ fazendo 1 e queria poder adicionar essa funcionalidade nele em vez de ter que fazer polling
</issue_1714_Implementa√ß√£o do pubsubhubbub na RSS>

<issue_1717_Adicionar funcionalidade de Favoritar os posts>
### Descri√ß√£o

Op√ß√£o de favoritar posts

### Sugest√£o de implementa√ß√£o

Eu acho que existisse uma funcionalidade de favoritar os posts para ler mais tarde seria bem interessante, eu sempre me deparo com posts legais, por√©m as vezes n√£o tenho tempo para ler naquele mesmo instante.

>> Coment√°rio de Rafatcb:
@PEAKYCOMMAND, obrigado pela sugest√£o. Estou fechando esse issue para concentrar a discuss√£o sobre essa funcionalidade em https://github.com/filipedeschamps/tabnews.com.br/issues/645, ok? L√° a sugest√£o j√° foi para um pouco al√©m: n√£o apenas ter favoritos, mas sim listas diferentes, com a possibilidade de serem listas p√∫blicas ou particulares.
</issue_1717_Adicionar funcionalidade de Favoritar os posts>

<issue_1718_Tabnews: m√∫ltiplos logins associados ao mesmo endere√ßo Gmail. Detalhes na descri√ß√£o.>
### Assunto

Cria√ß√£o de contas de usu√°rio associadas a um √∫nico email

### D√∫vida

Tempos depois que o Tabnews foi ao ar, notei que n√£o era poss√≠vel criar mais que uma conta associada ao meu email. Contudo, √© poss√≠vel criar m√∫ltiplas contas a partir de um mesmo email Gmail considerando que este webmail n√£o diferencia logins com pontos, ou seja, ele ignora os pontos que existem entre os caracteres do login. Por exemplo, usando os endere√ßos abaixo, tratados todos como iguais pelo Gmail, √© poss√≠vel criar tr√™s contas no Tabnews.

exemplo@gmail.com
ex.em.plo@gmail.com
exem.plo@gmail.com
etc...

At√© o momento desta postagem, o Tabnews trata cada um dos emails acima como diferentes, logo podendo-se vincular v√°rias contas de usu√°rios a um √∫nico endere√ßo de email real com a simples modifica√ß√£o do email no momento do cadastro.

---

Achei interessante comentar este fato percebido, por√©m n√£o sei bem como lidar com esta situa√ß√£o em um ambiente que j√° est√° em produ√ß√£o. Refor√ßo que n√£o testei se outros _webmails_ d√£o o mesmo tratamento para seus _logins_ assim como feito pelo Gmail.

Para esta verifica√ß√£o, acho que criei umas 3 contas no Tabnews que ficaram sem uso. Talvez uma busca em todo banco de dados por contas e suas respectivas contribui√ß√µes ajudem a encontrar aquelas zumbi. Uma notifica√ß√£o poderia se enviada para o usu√°rio avisando-o da inativa√ß√£o da conta e ap√≥s algum tempo sua exclus√£o/reten√ß√£o. Atualmente este procedimento de "garbage collection" tem sido adotada por alguns servi√ßos gratuitos online a fim de expurgar o sistema removendo contas zumbi criadas para testes ou mesmo uso √∫nico, espor√°dico ou mesmo fraudes.

>> Coment√°rio de Rafatcb:
Observa√ß√£o legal, @gpoleszuk . Eu n√£o sabia desse comportamento do Gmail com o `.`, mas lembrei do uso do `+`, conforme explicado [aqui](https://support.google.com/a/users/answer/9282734?hl=en#email-address-variation).

N√£o sei se faz sentido entrarmos nessa briga de gato e rato para proibir esse tipo de uso do e-mail.

>> Coment√°rio de gpoleszuk:
Que bom que tomou conhecimento desse comportamento, @Rafatcb. Certamente, √© uma briga de gato e rato e o rato sempre fica √† frente : ). Valeu por lembrar-nos do recurso "+" disponibilizado pelo Gmail.

>> Coment√°rio de aprendendofelipe:
Dado que existem incont√°veis possibilidades para centralizar o gerenciamento diferentes endere√ßos de email, mesmo de diferentes servi√ßos, e que mesmo se n√£o fosse poss√≠vel centralizar isso, nada impede algu√©m de criar mais de uma conta, ent√£o a preocupa√ß√£o deve ser com o uso indevido de diferentes contas para obter vantagens entre si, sem preocupa√ß√£o se √© uma √∫nica pessoa real por tr√°s das contas ou se s√£o diferentes pessoas que se associaram para obterem vantagens m√∫tuas.

N√£o h√° muitas vantagens em ter acesso a mais de uma conta se n√£o for para manipular os votos. E contas usadas para manipula√ß√£o est√£o ferindo os termos de uso e, por isso, s√£o banidas com frequ√™ncia pela modera√ß√£o. üëç

@gpoleszuk, se sua d√∫vida tiver sido sanada, pode fechar a issue ü§ù
</issue_1718_Tabnews: m√∫ltiplos logins associados ao mesmo endere√ßo Gmail. Detalhes na descri√ß√£o.>

<issue_1721_Mensagem de erro ao tentar publicar novo conte√∫do>
### Descri√ß√£o

Ao tentar publicar um novo conte√∫do, a seguinte mensagem de erro √© apresentada logo ap√≥s clicar no bot√£o "Publicar":

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/53376691/5189eb7a-6825-443b-aab2-18b4b9f2cad8)

A mensagem √© uma resposta dessa requisi√ß√£o:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/53376691/3c72a434-5881-45af-9887-ff7df035976a)


### Passos para reproduzir o problema

## 1. Clique no bot√£o para publicar novo conte√∫do.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/53376691/4780d71f-f53e-4d7a-a8ef-93532dfd7823)

## 2. Adicione t√≠tulo, corpo e fonte.

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/53376691/191c625e-8538-4fac-b3e7-01ccb9569968)

## 3. Clique em "Publicar"

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/53376691/e3b20c63-822a-4f67-9ff1-0076fe7ad76a)

## Conte√∫do para teste

**T√≠tulo:** Pesquisadores de seguran√ßa criam extens√£o falsa para VS Code id√™ntica √† ‚ÄúDracula Official‚Äù, a fim de comprovar como usu√°rios podem ser enganados por hackers devido √† falta de controles rigorosos e revis√µes de c√≥digo por parte da Microsoft.

**Conte√∫do:** A ‚ÄúDarcula‚Äù, criada por Amit Assaraf, Itay Kruk e Idan Dardikman, conseguiu receber o selo ‚Äúverificado‚Äù da loja a partir do registro de um dom√≠nio falso. Ela funciona de maneira id√™ntica √† verdadeira, mas inclui um c√≥digo malicioso capaz de roubar informa√ß√µes confidenciais, como nome do host e sistema operacional, registrando cerca de 2 mil downloads, inclusive por uma empresa estimada em mais de 480 bilh√µes de d√≥lares, que n√£o foi identificada. As informa√ß√µes s√£o do site Bleeping Computer.

**Fonte:** https://www.bleepingcomputer.com/news/security/malicious-vscode-extensions-with-millions-of-installs-discovered/

### Navegadores testados

Chrome, Firefox, Microsoft Edge

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de kaique-soares:
@LuanGregati muito obrigado por reportar :handshake:

Eu fiz um teste com o tamanho do `T√≠tulo` e resultou em `238`:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/92cf829c-9038-4fc1-91df-9aa8c46f581f)

Especulo que voc√™ tenha ca√≠do nesta valida√ß√£o aqui:

https://github.com/filipedeschamps/tabnews.com.br/blob/4d62fc6d87dcbab578dd26349800d3475b003a88/models/validator.js#L208

---

Consegue reduzir o tamanho do `T√≠tulo` e tentar enviar novamente? Na verdade, talvez seja melhor testar em homologa√ß√£o antes.

https://tabnews-git-chore-remove-cross-fetch-tabnews.vercel.app/

>> Coment√°rio de kaique-soares:
@LuanGregati testei em homologa√ß√£o reduzindo o tamanho do `T√≠tulo` e consegui publicar, veja :+1:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/77a0a6e9-5735-49fe-b9f7-3d05f402c820)

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/d228cccf-4962-4081-8fcd-007cad5b2aff)

https://tabnews-git-chore-remove-cross-fetch-tabnews.vercel.app/kaiquesoares/pesquisadores-de-seguranca-criam-extensao-falsa-para-vs-code-identica-a-dracula-official-a-fim-de-comprovar-como-usuarios-podem-ser-enganados-por-hackers-devido-a-falta-de-controles-rigorosos-e-revisoes-de-codigo-por-parte

>> Coment√°rio de Rafatcb:
@LuanGregati obrigado por reportar o problema; e @kaique-soares obrigado por encontrar uma solu√ß√£o alternativa!

Certamente a API n√£o deveria retornar um erro no `slug`, sendo que ela mesma o gerou. Imagino que, caso o `slug` gerado seja grande demais, a fun√ß√£o `getSlug` deveria cortar o final para respeitar a quantidade m√°xima permitida.

>> Coment√°rio de aprendendofelipe:
Obrigado pessoal! üí™

O t√≠tulo ser longo n√£o √© o problema. O limite de tamanho do slug (226) √© menor do que o do t√≠tulo (255), mas ele √© truncado sempre que necess√°rio.

O que est√° causando o problema √© que, ao truncar o slug, ele acabou terminando com h√≠fen, e √© isso que n√£o est√° passando no validador.

Logo mais eu abro o PR com a solu√ß√£o. ü§ù

>> Coment√°rio de kaique-soares:
@aprendendofelipe perfeito!!!

Estava testando kkk:

![image](https://github.com/filipedeschamps/tabnews.com.br/assets/57193392/03b0f577-5a37-4d47-b89a-f365f4d961e5)

>> Coment√°rio de LuanGregati:
Obrigado pelas observa√ß√µes, pessoal! Voc√™s s√£o demais üí™

>> Coment√°rio de aprendendofelipe:
@LuanGregati, problema corrigido no PR #1722, e voc√™ foi citado na publica√ß√£o sobre as novidades: üí™

https://www.tabnews.com.br/FelipeBarso/tabnews-corrigidos-bugs-nos-testes-e-na-geracao-de-slugs üéâ
</issue_1721_Mensagem de erro ao tentar publicar novo conte√∫do>

<issue_1724_Encerramento da parceria com a Vercel>
### Descri√ß√£o

Recebi o seguinte email da Vercel:

<img width="1038" alt="image" src="https://github.com/filipedeschamps/tabnews.com.br/assets/4248081/a7df855b-577e-4813-a13c-80a88953a7df">

N√£o tenho interesse em continuar com a parceria, pois n√£o estamos oferecendo nenhum retorno e provavelmente n√£o iremos fornecer.

### Sugest√£o de implementa√ß√£o

@aprendendofelipe @Rafatcb precisaremos atuar de forma r√°pida para levantar quais recursos estamos estourando l√° na conta da Vercel, fazer uma for√ßa-tarefa para otimizar isso ou at√© remover por completo o uso (como o Analytics, que a gente poderia arranjar uma solu√ß√£o final).

N√£o faria mal avaliar a redu√ß√£o da inst√¢ncia do banco na AWS, que hoje estamos usando `db.t4g.medium` e que est√° nos custando em m√©dia `USD 172` ou `BRL 923` (totalizando aproximadamente `BRL 11.000`) anuais.

>> Coment√°rio de filipedeschamps:
Inclusive, sugiro a gente fazer um levantamento de todos os recursos usados na Vercel e cadastrar aqui na issue para virar hist√≥rico, para repassar isso um dia no curso.dev e depois deixar registrado como otimizamos tudo isso (pode virar conhecimento para comunidade open source).

>> Coment√°rio de aprendendofelipe:
Por enquanto, fora os assentos no time, que s√£o $ 20 por pessoa, temos pouco mais de $ 3 mensais por causa do middleware e $ 56 de Analytics. O resto ficava tudo dentro da cota do plano Pro.

O problema √© que a forma de cobran√ßa da Vercel mudou completamente nas √∫ltimas semanas, ent√£o nosso hist√≥rico n√£o ajuda nada, pois o custo teria sido bem maior pelas novas regras e m√©tricas. Pelo que j√° d√° para estimar do volume atual, acredito que vamos ficar em torno dos $300 que v√£o dar de desconto at√© dezembro.

Para reduzir o custo, acho que a primeira coisa que teremos que fazer, talvez a √∫nica com impacto relevante, ser√° mudar a forma que usamos o cache, diminuindo as revalida√ß√µes baseadas em tempo e passando para revalida√ß√µes sob demanda.

>> Coment√°rio de aprendendofelipe:
Sobre o banco de dados, at√© pelas otimiza√ß√µes que fizemos nos √∫ltimos meses, temos boa margem para diminuir a inst√¢ncia. üëç

E acredito que a Revenue Share n√£o vai aumentar muito a demanda do banco.

### E o sistema pr√≥prio de busca?

O √∫nico impacto imediato seria uma diminui√ß√£o das chances de sucesso no que est√° sendo testado em #1698, que √© usar o pr√≥prio banco para a pesquisa das publica√ß√µes. Diminui as chances, mas ainda pode funcionar. S√≥ que a implementa√ß√£o n√£o chegou ainda no ponto de testar, pois a funcionalidade ainda est√° muito inferior ao que temos hoje, que usa o Google, mas que apresenta publicidades deles.

Se a ferramenta pr√≥pria exigir uma inst√¢ncia do banco mais cara, √© melhor continuar usando o Google, pelo menos por enquanto. Quando valer a penas aumentar nosso custo para remover as propagandas do Google, pode compensar usar o plano pago do Google, que no volume de hoje custaria menos de $ 50, e sem impacto no banco de principal.

>> Coment√°rio de filipedeschamps:
N√£o saberia avaliar quanto ao sistema de busca.

Em paralelo, precisamos avaliar tamb√©m o uso do `Middleware` e `Log Drain` na Vercel ü§ù

>> Coment√°rio de rodrigoKulb:
@filipedeschamps devido ao fluxo de trabalho, ando bem afastado do projeto. Mas, pensando como empres√°rio, acredito que seja necess√°rio uma parceria com algum host de forma "real", colocando um logo no rodap√© e criando uma p√°gina explicando que ele √© um patrocinador da infraestrutura do projeto.

N√£o vejo nenhum problema em ter um parceiro estrat√©gico para um projeto de c√≥digo aberto. √â bem comum algumas empresas quererem patrocinar projetos de c√≥digo aberto.

Nesse caso, a troca seria a visibilidade e a possibilidade de novos clientes.

Fora o Tabnews, acredito que voc√™ pode ter essa parceria de forma clara no curso.dev, at√© porque voc√™ recomenda a Vercel em algumas aulas.

>> Coment√°rio de Rafatcb:
Aproveitando o assunto de Analytics, recebi uma notifica√ß√£o hoje sobre uma discuss√£o que estou inscrito. Agora √© poss√≠vel exportar os Analytics da Vercel em um CSV: https://vercel.com/changelog/csv-export-in-web-analytics

>> Coment√°rio de aprendendofelipe:
Levantei o volume de uso dos recursos da Vercel nos √∫ltimos 30 dias, ordenados do maior custo estimado para o menor. O ideal seria fazer uma m√©dia do uso nos √∫ltimos meses, mas os novos custos s√£o baseados em m√©tricas que antes n√£o eram fornecidas.

Os valores mudam de acordo com a regi√£o, ent√£o estou estimando com os valores do Brasil (gru1), que √© um dos mais caros. Ainda n√£o recebemos faturas no novo padr√£o, pois ele s√≥ passou a valer em 25 de maio.

Recurso | √öltimos 30 dias | Cota inicial | Unidade adicional | Valor em gru1 (USD) | Total (USD) | Observa√ß√µes
-- | :--: | :--: | --: | --: | --: | --
Data Cache Writes | 24M | 2M | 1M | 6,40 | 140,80 | Novo
Fast Origin Transfer | 284GB | 100GB | 1GB | 0,41 | 75,44 | Novo
Web Analytics Events | 326k | 25k | 100k | 14,00 | 56,00 | 
Team seats | 2 | - | 1 | 20,00 | 40,00 | ¬†
Log Drains | 14GB | - | 5GB | 10,00 | 30,00 | Novo
Fast Data Transfer | 45GB | 1GB | 1GB | 0,44 | 21,56 | Novo
Edge Middleware Invocation | 6M | 1M | 1M | 2,40 | 12,00 | Quase quadruplicou o custo
Data Cache Reads | 13M | 10M | 1M | 0,64 | 1,92 | Novo
Function Invocations | 2M | 1M | 1M | 0,60 | 0,60 | Novo
Edge Requests | 8M | 10M | 1M | 3,20 | 0,00 | Novo
Edge Request CPU Duration | 8 minutos | 1 hora | 1 hora | 0,48 | 0,00 | Novo
Function Duration | 160GB-Hour | 1.000GB-Hour | 1 GB-Hour | 0,18 | 0,00 | ¬†
Total estimado | ¬† | ¬† | ¬† | ¬† | 378,32 | ¬†

## Middleware

Mesmo tendo quase quadruplicado o valor, ela nos protege de uma forma que s√≥ seria poss√≠vel em planos mais caros da Vercel e/ou da Cloudflare, ent√£o n√£o deve compensar mudar isso.

## Analytics

Analytics n√£o mudou a forma de cobran√ßa, mas no nosso volume j√° compensa trocar para o plano de $ 50, pois tem 500k eventos inclusos, o que talvez permita incluir de novo os eventos da Home. E se passar de 500k, s√£o $20 para os pr√≥ximos 500k eventos.

Pode ser que outros servi√ßos sejam um pouco mais baratos, mas podem n√£o funcionar corretamente com o Next.js, pois tem que contar navega√ß√µes SPA e diretas junto, e n√£o deve computar as requisi√ß√µes de *prefetch*.

## Dreno dos logs

D√° para desativar o dreno autom√°tico da Vercel e enviar os logs tudo via requisi√ß√µes usando a biblioteca [`next-axiom`](https://github.com/axiomhq/next-axiom). Nesse caso entrar√° no custo de transfer√™ncia de dados, que √© bem menor do que do dreno, mas pode impactar no tempo de resposta das requisi√ß√µes.

Outro caminho, que parece menos interessante, √© configurar para a Vercel enviar apenas uma amostragem, ou seja, enviar uma certa porcentagem dos logs. Se enviar apenas 30%, j√° fica dentro da primeira faixa de 5GB por $ 10, e os 30% s√£o suficientes para analisar o funcionamento normal do sistema, mas em caso de falhas isoladas n√≥s podemos ficar sem logs.

## Cache

Cache √© por onde acho melhor come√ßar, pois representa a maior parte do custo, ent√£o √© o que mais tem potencial de redu√ß√£o. Diminuir as revalida√ß√µes, al√©m de reduzir as "Data Cache Writes", reduz tamb√©m a "Fast Origin Transfer", que s√£o os dados trafegados entre as lambdas e a *edge*, ou seja, diminui os dois itens de maior custo.

## Regi√£o gru1 vs iad1

Outra possibilidade de redu√ß√£o de custos seria mudar nossos servidores para os Estados Unidos. Como o cache √© na Edge, continuar√≠amos com as p√°ginas est√°ticas sendo carregadas no mesmo tempo, pelo menos as que j√° estiverem em cache. O impacto mesmo seria na API, mas possivelmente seria um impacto m√≠nimo.

Fiz um comparativo de valores onde ocultei os itens que tem o mesmo pre√ßo nas duas regi√µes. Fica vis√≠vel que, se reduzirmos bastante os dois primeiros custos, n√£o seria muito vantajoso mudar para iad1. Isso, √© claro, olhando apenas para a Vercel. Como o banco de dados teria que migrar junto, tamb√©m representa uma redu√ß√£o nos custos que deve ser considerada na decis√£o.

M√©trica | Valor gru1 (USD) | Valor iad1 (USD) | Total gru1 (USD) | Total iad1 (USD)
-- | --: | --: | --: | --: 
Data Cache Writes | 6,40 | 4,00 | 140,80 | 88,00
Fast Origin Transfer | 0,41 | 0,06 | 75,44 | 11,04
Fast Data Transfer | 0,44 | 0,15 | 21,56 | 7,35
Edge Middleware Invocation | 2,40 | 1,50 | 12,00 | 7,50
Data Cache Reads | 0,64 | 0,40 | 1,92 | 1,20
Edge Requests | 3,20 | 2,00 | 0,00 | 0,00
Edge Request CPU Duration | 0,48 | 0,30 | 0,00 | 0,00
Total que n√£o depende da regi√£o | ¬† | ¬† | 126,60 | 126,60
Total estimado | ¬† | ¬† | 378,32 | 241,69

>> Coment√°rio de Rafatcb:
√ìtimas tabelas!

> Como o banco de dados teria que migrar junto, tamb√©m representa uma redu√ß√£o nos custos que deve ser considerada na decis√£o.

Considerando que j√° estava nos planos (https://github.com/filipedeschamps/tabnews.com.br/issues/1172), √© uma op√ß√£o vi√°vel.

Como o Filipe mencionou avaliar uma redu√ß√£o na inst√¢ncia do banco, quero compartilhar [essa thread do Hacker News](https://news.ycombinator.com/item?id=40642803) que fala sobre como tirar um melhor proveito das configura√ß√µes de mem√≥ria do PostgreSQL. N√£o sei qual √© o nosso gargalo, mas na thread e no [artigo](https://tembo.io/blog/optimizing-memory-usage) mencionam algumas configura√ß√µes, al√©m do uso do `REINDEX`.

>> Coment√°rio de aprendendofelipe:
### Ainda estamos abaixo de $300 üéâ

No relat√≥rio de uso da Vercel √© poss√≠vel filtrar algumas m√©tricas por regi√£o, o que mostra que nosso maior custo j√° est√° em `iad1`. Leituras e grava√ß√µes de cache aparecem 100% como `iad1`. J√° o tr√°fego tem mais de 40% em regi√µes com o mesmo custo de `iad1`.

Se estiver correto, √© uma √≥tima not√≠cia, pois o custo estimado fica em $294 (ou $288 se mudar para o Analytics Plus). Com isso, continuamos sem custos na Vercel pelos pr√≥ximos meses, j√° que ficamos um pouco abaixo dos $300 que teremos de desconto. E poderemos fazer os ajustes no cache com mais calma, tomando cuidado para n√£o prejudicar a UX.

### Ser√° que √© isso mesmo? ü§î

Ainda n√£o entendi porque o cache est√° todo como `iad1`, sendo que a [documenta√ß√£o](https://vercel.com/docs/pricing/data-cache#data-cache-reads-chart) diz que a cobran√ßa √© pelas regi√µes onde as leituras e grava√ß√µes ocorrem. Nossas fun√ß√µes est√£o configuradas para rodar em `gru1`, e isso deveria valer tamb√©m para a regi√£o onde s√£o executadas as fun√ß√µes que revalidam as p√°ginas est√°ticas (`getStaticProps`). E se fosse pela regi√£o de consumo do cache, estaria dividido em diferentes regi√µes. Tomara que n√£o seja um bug no relat√≥rio.

### Sobre a configura√ß√£o para `gru1`

No painel da Vercel est√° com a configura√ß√£o padr√£o, que √© `iad1`, mas essa configura√ß√£o √© sobrescrita para `gru1`, pois √© o que est√° definido no arquivo `vercel.json`. Na p√°gina de status do TabNews tamb√©m podemos confirmar que nossas fun√ß√µes est√£o em `gru1`, pois √© esse o valor da vari√°vel de ambiente `VERCEL_REGION`.

At√© subi um projeto de teste na Vercel para ler o valor da vari√°vel de ambiente `VERCEL_REGION` nas diferentes situa√ß√µes (API e `getStaticProps`). Usei a mesma configura√ß√£o do TabNews, ou seja, padr√£o `iad1` no painel, mas `gru1` no `vercel.json`. Nos dois ambientes a vari√°vel sempre retornou corretamente o valor `gru1`. E no relat√≥rio de uso ficou como no TabNews, o cache todo em `iad1` e o tr√°fego dividido entre as regi√µes. Ent√£o a d√∫vida permanece se √© um bug no relat√≥rio ou se a documenta√ß√£o est√° errada. Parece que s√≥ vamos descobrir quando a fatura fechar no dia 29.

>> Coment√°rio de filipedeschamps:
Em paralelo, a thread no Hacker News:

https://news.ycombinator.com/item?id=40682711

E isso me chamou aten√ß√£o:

https://news.ycombinator.com/item?id=40685579

>> Coment√°rio de EduContin:
### Poss√≠vel alternativa para migra√ß√£o (Coolify)

Recentemente me deparei com o projeto Coolify no GitHub (https://github.com/coollabsio/coolify). Promete ser uma substitui√ß√£o self-hosted e open-source da Vercel. Muito massa!

>> Coment√°rio de filipedeschamps:
Mais informa√ß√µes sobre o `Coolify` (√© bem interessante mesmo):

https://www.youtube.com/watch?v=SANSysQlS18

https://www.youtube.com/watch?v=ZZ1lnw8D3Qo

Outra alternativa:

https://sst.dev/

>> Coment√°rio de repires:
Outras alternativas:

CapRover: https://www.youtube.com/watch?v=2d2U8tRBFyM

Dockploy: https://www.youtube.com/watch?v=QAQyRyUXfMs

Kubero: https://www.youtube.com/watch?v=3hvdqQoxU70

>> Coment√°rio de filipedeschamps:
Apenas para deixar registrado:

<img width="1756" alt="image" src="https://github.com/user-attachments/assets/58a92b96-25b5-4d7c-ba14-116a6a492228">


@aprendendofelipe depois quando fechar o billing cycle, seria legal se voc√™ trouxesse alguns prints da interface l√° da Vercel com o uso

>> Coment√°rio de aprendendofelipe:
Trago os valores aqui sim... ü§ù

Eu estou acompanhando e est√° mais ou menos como previsto.  Devemos ficar abaixo dos $300 üéâ

>> Coment√°rio de aprendendofelipe:
O ciclo de faturamento fechou hoje e o custo veio zerado por ser menor do que os $300 de desconto. S√≥ que, por ter fechado zerado, omitiram os valores que seriam cobrados se o desconto n√£o existisse. ‚òπÔ∏è

At√© onde vi antes do fechamento, estava um pouco acima de $200. Vou tentar salvar os dados parciais quando estiver perto do fim do novo ciclo.

A utiliza√ß√£o aparece assim:

Produto | Uso
-- | --
Fast Data Transfer | 45,79 GB
Fast Origin Transfer | 201,64 GB
Edge Requests | 6.9M
Edge Request CPU Duration | 10 m
Data Cache Reads | 9.5M
Data Cache Writes | 21M
Function Invocations | 2M
Function Duration | 168.6 GB-Hrs
Edge Middleware Invocations | 4.8M
Log Volume | 12,86 GB
Web Analytics Events | 291K
Bandwidth | 45,79 GB

>> Coment√°rio de filipedeschamps:
```
Edge Requests | 6.9M
Edge Middleware Invocations | 4.8M
```

N√£o sei qual a diferen√ßa entre os dois, mas doidera demais esses valores.

```
Fast Origin Transfer | 201,64 GB
```

Como que a gente pode t√° transferindo tantos `GB`?

---

Em paralelo, at√© hoje eu tenho problema de entrar numa p√°gina e n√£o conseguir pegar o cache dela atualizado :( Inclusive me fez criar o costume de nunca confiar numa p√°gina ao entrar, eu sempre espero alguns segundos e dou refresh uma ou duas vezes (por exemplo, se vejo que na lista apareceu que tem coment√°rio, mas dentro n√£o mostra nada).

>> Coment√°rio de aprendendofelipe:
> ```
> Edge Requests | 6.9M
> Edge Middleware Invocations | 4.8M
> ```
> 
> N√£o sei qual a diferen√ßa entre os dois, mas doidera demais esses valores.

Um √© o total de requisi√ß√µes e o outro √© apenas o que deu match com `/((?!_next/static|va/|favicon|manifest).*)`.

> ```
> Fast Origin Transfer | 201,64 GB
> ```
> 
> Como que a gente pode t√° transferindo tantos `GB`?

Cada atualiza√ß√£o de cache √© replicada para diferentes partes da Edge. A estrat√©gia atual de ficar revalidando mesmo se nada mudou acaba fazendo o tr√°fego de Vercel para Vercel ser maior do que da Vercel para os Clients.

> Em paralelo, at√© hoje eu tenho problema de entrar numa p√°gina e n√£o conseguir pegar o cache dela atualizado :( Inclusive me fez criar o costume de nunca confiar numa p√°gina ao entrar, eu sempre espero alguns segundos e dou refresh uma ou duas vezes (por exemplo, se vejo que na lista apareceu que tem coment√°rio, mas dentro n√£o mostra nada).

Dado que o custo de ficar revalidando o cache a todo momento ficou invi√°vel, vamos precisar revalidar apenas as p√°ginas que mudarem, o que implica j√° revalidar tudo que for necess√°rio quando algo mudar, ent√£o n√£o devemos ter mais inconsist√™ncias devido ao cache desatualizado. Bom, ainda vai acontecer para quem usa a API, mas n√£o mais nas p√°ginas est√°ticas.

>> Coment√°rio de aprendendofelipe:
Complementando sobre o total de requisi√ß√µes...

Aquele √© o n√∫mero que chegou na Vercel (com ou sem cache da Vercel), mas o total de requisi√ß√µes atendidas pela Cloudflare √© um pouco maior, pois tamb√©m tem o n√≠vel de cache deles.

Nos √∫ltimos 30 dias a Cloudflare atendeu 7.91M de requisi√ß√µes. N√£o √© exatamente o mesmo intervalo de tempo, mas serve como compara√ß√£o.

>> Coment√°rio de felipechiodini:
> Outras alternativas:
> 
> CapRover: https://www.youtube.com/watch?v=2d2U8tRBFyM
> 
> Dockploy: https://www.youtube.com/watch?v=QAQyRyUXfMs
> 
> Kubero: https://www.youtube.com/watch?v=3hvdqQoxU70

tenho um servidor rodando esse: https://easypanel.io/

>> Coment√°rio de Rafatcb:
Nossos custos com a Vercel em Analytics, em Junho, foram de US\$ 56 (https://github.com/filipedeschamps/tabnews.com.br/issues/1724#issuecomment-2168729755), isso porque n√£o coletamos eventos na p√°gina principal e na `/publicar` por causa da cota da conta Pro. Esse custo se deu porque:

* 326k visitas = 25k visitas inclusas + 4 \* 100k visitas = 4 \* US\$ 14 = **US\$ 56**

Uma alternativa super simples para diminuir esse custo √© usar o [Web Analytics Plus](https://vercel.com/docs/analytics/limits-and-pricing), que custa US\$ 50, mas cont√©m 500 mil eventos inclusos, ent√£o s√≥ de ativar j√° ter√≠amos uma economia, caso todos os meses tenham mais de 325k visitas. N√£o tenho certeza se √© simples assim porque, se for, parece n√£o fazer nenhum sentido usar o Web Analytics normal no plano Pro gerando 325k √† 500k eventos.

Outra outra plataforma, como o [Tinybird](https://www.tinybird.co/). [A Vercel usa o Tinybird](https://www.tinybird.co/case-studies/vercel-relies-on-tinybird-to-power-their-realtime-user-facing-analytics) para analytics. Eu fiz alguns testes e publiquei uma compara√ß√£o da Vercel x Tinybird no TabNews: [Criei uma API para substituir o Vercel Analytics](https://www.tabnews.com.br/rafael/criei-uma-api-para-substituir-o-vercel-analytics).

Pelas minhas estimativas, √© poss√≠vel economizar usando o Tinybird, al√©m de ter uma flexibilidade maior sobre quais dados coletar, por quanto tempo armazenar e, principalmente, testar aos poucos. O custo do Tinybird n√£o ser√° uma nova conta de US\$ 50 assim que decidirmos usar, pois [ele cobra por armazenamento e processamento de dados](https://www.tinybird.co/pricing). Isso permite usarmos o Tinybird lado a lado do Analytics da Vercel para conseguir estimar os custos no n√≠vel de consumo do TabNews, e tamb√©m desativar o Tinybird a qualquer momento sem pagar uma conta alta.

Acredito que as prote√ß√µes que precisaremos no endpoint de coleta de analytics seriam as mesmas que j√° precisamos hoje, para n√£o abrir a torneira de custos da Vercel.

O risco de testar o Tinybird √© baixo, e o custo inicial iria para o lado do tempo de desenvolvimento da solu√ß√£o.

Tamb√©m existe a op√ß√£o de usar um banco de dados sem adicionar mais uma plataforma, ou seja, usar diretamente o nosso banco na AWS. Imagino que isso seja ainda melhor do que usar o Tinybird, mas aqui j√° n√£o tenho familiaridade para estimar custos; talvez outra pessoa possa confirmar se faz sentido. A implementa√ß√£o deve ser parecida com o que seria necess√°rio para implementar o Tinybird, mudando apenas a parte de leitura e escrita no banco, e tamb√©m a agrega√ß√£o de dados para consumir menos recursos (no Tinybird, isso se d√° por meio de [materialized views](https://www.tinybird.co/docs/publish/materialized-views)).

Outro ponto positivo de n√≥s termos esse tipo de solu√ß√£o mais flex√≠vel √© que a mesma solu√ß√£o poderia ser usada para contar visitas em publica√ß√µes (https://github.com/filipedeschamps/tabnews.com.br/issues/1115).

>> Coment√°rio de aprendendofelipe:
O ciclo de faturamento fecha amanha e j√° estamos com $291.14. Se n√£o passar dos $300, teremos 100% de desconto.

No ciclo anterior, n√£o ficaram vis√≠veis os valores individuais de cada recurso depois do fechamento, mas agora disponibilizaram. Por desencargo, j√° estou salvando aqui os valores parciais.

## Ago/24 Parcial 

<img width="823" alt="Utiliza√ß√£o de recursos da Vercel em ago 24" src="https://github.com/user-attachments/assets/acdee88d-1a4f-4e7a-aeae-e6de190ae51a">

## Jul/24

<img width="823" alt="Utiliza√ß√£o de recursos da Vercel em jul 24" src="https://github.com/user-attachments/assets/e4c7156d-776f-422e-b8bf-6c16abc76b20">

>> Coment√°rio de Rafatcb:
> Para reduzir o custo, acho que a primeira coisa que teremos que fazer, talvez a √∫nica com impacto relevante, ser√° mudar a forma que usamos o cache, diminuindo as revalida√ß√µes baseadas em tempo e passando para revalida√ß√µes sob demanda.

Eu refleti e pesquisei sobre como s√£o as revalida√ß√µes sob demanda. Usando o Pages Router, parece que a forma de fazer isso √© chamando `await res.revalidate('/pagina/para/revalidar/1')`. Em v√°rias situa√ß√µes, isso fica complexo. Por exemplo, ao criar uma nova publica√ß√£o, precisaria revalidar todas p√°ginas `/recentes/pagina/...` e `/recentes/todos/...`, visto que a posi√ß√£o de todas publica√ß√µes mudaria. N√£o parece ter uma forma simples de fazer isso.

Se formos considerar a p√°gina Relevantes, que dificilmente existem mais do que 5 p√°ginas, ent√£o uma forma simples inicial seria revalidar apenas X p√°ginas quando alguma a√ß√£o espec√≠fica ocorre. Por√©m, s√£o v√°rias as a√ß√µes que podem demandar a revalida√ß√£o: novo conte√∫do, voto, mudan√ßa de t√≠tulo da publica√ß√£o, mudan√ßa de slug, remo√ß√£o do conte√∫do, banimento de usu√°rio, mudan√ßa de nome do usu√°rio e talvez outras coisas. Al√©m disso, o tempo tamb√©m influencia na posi√ß√£o das publica√ß√µes relevantes. N√£o tenho certeza se √© poss√≠vel utilizar os dois tipos de revalida√ß√£o na mesma p√°gina porque o comportamento no _cache miss_ √© diferente.

Em p√°ginas de usu√°rios ou das pr√≥prias publica√ß√µes, √© mais simples, mas ainda existem v√°rias a√ß√µes que demandam a revalida√ß√£o. Acho que as p√°ginas de conte√∫dos seriam as "mais simples" dentre as que podem ter um impacto relevante na m√©trica _Data Cache Writes_.

O App Router tem algumas facilidades para a revalida√ß√£o, como as fun√ß√µes [`revalidatePath`](https://nextjs.org/docs/app/api-reference/functions/revalidatePath) e [`revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag), mas ainda precisar√≠amos da mesma l√≥gica condicional para entender o que revalidar.

Na documenta√ß√£o do App Router, tem um artigo bem extenso sobre o assunto e que inclui v√°rios diagramas exemplificando as situa√ß√µes poss√≠veis: [Building Your Application: Caching](https://nextjs.org/docs/app/building-your-application/caching) (cache miss, hit, stale, fetches etc.).

√â esse o caminho mesmo? √â tanta coisa a considerar que n√£o parece certo :thinking: 

---

Aproveitando, √© poss√≠vel estimar o quanto o `prefetch` dos links est√° influenciando em algum consumo dentre os valores citados? Eu acho o `prefetch` no `hover` exagerado. N√£o sei o qu√£o mais lento o site ficaria se o remov√™ssemos, e quanto economizar√≠amos.

De vez em quando eu navego para uma p√°gina e a p√°gina anterior "recarrega" como se eu tivesse visitado ela novamente, n√£o sei se √© algum efeito colateral de quando o `prefetch` √© mais lento do que a navega√ß√£o ou se √© algum outro bug.

>> Coment√°rio de filipedeschamps:
![](https://github.com/user-attachments/assets/63d04684-0b78-48da-a051-49c558dab859)

>> Coment√°rio de repires:
Vercel vs Cloudflare 
Edge requests:
https://www.youtube.com/watch?v=xDu-wACrJlc

>> Coment√°rio de filipedeschamps:
To com uma baita vontade de subir uma infra pr√≥pria, banco local, s√≥ pra ver o que vai dar. Fico imaginando que m√°quina conseguimos numa `Hetzner` da vida por `USD 40`.

>> Coment√°rio de repires:
Free tier cloudflare 

https://youtu.be/DJtOn_Vt1uw?si=50AT5ihuzXBiuRlZ

>> Coment√°rio de luanfvieira:
Self-Hosting Next.js

https://youtu.be/sIVL4JMqRfc

>> Coment√°rio de gpoleszuk:
Pensei na mesma ideia, [luanfvieira](https://github.com/luanfvieira). Outra ideia seria criar uma interface est√°tica assim como temos no hackernews, algo simples, sem muita intelig√™ncia consumindo banda por detr√°s (telemetria, a√ß√µes que ocorrem quando o mouse paira sobre um t√≥pico, etc.). A ideia de um sistema distribu√≠do n√£o seria t√£o ruim tamb√©m. De todas as vezes que acesso o Tabnews, sempre vejo pelo menos umas 6 conex√µes ativas na √°rea de Status. N√£o fa√ßo ideia quantos megabytes o Tabnews tem de publica√ß√µes, mas seria poss√≠vel replicar seu conte√∫do em diferentes nodos que queiram manter um PC ligado pelo menos parte do dia para sincroniza√ß√£o? J√° viram alguma ideia semelhante de, em vez concentrar o conte√∫do do banco de dados em um √∫nico servidor, distribu√≠-lo para _nodos_ volunt√°rios, ficando o servidor central (um PC na Filipe Deschamps Enterprise) respons√°vel por prover a interface e _hashes_ para as assinatura das publica√ß√µes?

>> Coment√°rio de yvesmariano:
> Self-Hosting Next.js
> 
> https://youtu.be/sIVL4JMqRfc

Interessante como tem um v√≠deo oficial da Vercel sobre como hospedar voc√™ mesmo uma aplica√ß√£o Next.js e de como o framework trouxe melhorias na sua nova [vers√£o 15](https://nextjs.org/blog/next-15#improvements-for-self-hosting) para aplica√ß√µes hospedadas em infraestrutura pr√≥pria. Acredito que isso √© um movimento de mercado na busca por solu√ß√µes mais eficientes em quest√£o de custo benef√≠cio, ao mesmo tempo que a Vercel tenta mostrar como sua plataforma √© _developer friendly_.

PS: Vou deixar aqui para quem n√£o leu ainda as [hist√≥rias de terror do serverless](https://serverlesshorrors.com/).

>> Coment√°rio de filipedeschamps:
Para inspirar a gente nesse ponto de custos: https://x.com/levelsio/status/1873484674179436920

>> Coment√°rio de filipedeschamps:
## Invoice de Janeiro
`USD 201,61`
`BRL 1.188,67`

<img width="542" alt="Image" src="https://github.com/user-attachments/assets/c85f5362-d837-46b2-80e6-f862bbfd3d24" />

>> Coment√°rio de mthmcalixto:
> ## Invoice de Janeiro
> `USD 201,61` `BRL 1.188,67`
> 
> <img alt="Image" width="542" src="https://private-user-images.githubusercontent.com/4248081/408521787-c85f5362-d837-46b2-80e6-f862bbfd3d24.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mzk3MzQ4OTEsIm5iZiI6MTczOTczNDU5MSwicGF0aCI6Ii80MjQ4MDgxLzQwODUyMTc4Ny1jODVmNTM2Mi1kODM3LTQ2YjItODBlNi1mODYyYmJmZDNkMjQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDIxNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAyMTZUMTkzNjMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ODVjZTVkNzE3ZjAzOTRhNGUyZWQ1MzYyNjM1OWQ4ODkyNzdmYjg1OTkyYTNjZDRlZGMxMTNjY2NkY2YwMGVmMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.UrtSMZEokztY8rA2WLvbEl5DiE-zd1U69KJ9hnp8F_Y">

O maior problema est√° em ISR Writes, ser√° que √© poss√≠vel encontrar a causa disso, pelo o que eu vi, a Vercel d√° 2M inicialmente e cobra 1M entre $4.00 - $6.40, est√° gravando muita coisa em cache?

Talvez fazer uma solu√ß√£o de https://solutions-on-demand-isr.vercel.app/ ?

>> Coment√°rio de aprendendofelipe:
Com a [otimiza√ß√£o](https://vercel.com/changelog/incremental-static-regeneration-is-now-faster-and-cheaper) recente da Vercel no ISR, nossos custos devem reduzir ainda mais no pr√≥ximo m√™s. Essa melhoria diminuiu significativamente nosso uso de cache ap√≥s 5 de fevereiro e tamb√©m reduziu um pouco a "Fast Origin Transfer", que est√° entre os itens de maior custo e tamb√©m est√° relacionada ao cache.

![Image](https://github.com/user-attachments/assets/369c2bd7-aa55-4837-8251-e3cb76dfcaa7)

![Image](https://github.com/user-attachments/assets/4288bc21-dcd1-45b7-a2d3-d1b6e316600f)



De todo modo, ainda vale o que j√° foi dito:

> Para reduzir o custo, acho que a primeira coisa que teremos que fazer, talvez a √∫nica com impacto relevante, ser√° mudar a forma que usamos o cache, diminuindo as revalida√ß√µes baseadas em tempo e passando para revalida√ß√µes sob demanda.

Em breve, abrirei um PR para tornar nosso c√≥digo compat√≠vel com a App Router. Isso nos permitir√° melhorar o cache, tornando-o mais granular e revalidando apenas o que for realmente modificado em cada p√°gina.

Provavelmente, come√ßaremos pelas p√°ginas de conte√∫dos (`/[username]/[slug]`), que s√£o respons√°veis por 85% do custo de ISR, j√° que s√£o as que sofrem mais revalida√ß√µes desnecess√°rias.

>> Coment√°rio de aprendendofelipe:
Equipe do Next.js est√° planejando criar adaptadores para facilitar a implanta√ß√£o em diferentes provedores:

[RFC: Deployment Adapters API (next.js/discussions#77740)](https://github.com/vercel/next.js/discussions/77740)

>> Coment√°rio de filipedeschamps:
Em paralelo, nossa invoice de Mar√ßo:

`USD 114.25`
`BRL 650.75`


<img width="490" alt="Image" src="https://github.com/user-attachments/assets/10690178-dd3f-4390-a395-2b961716e6bb" />

>> Coment√°rio de aprendendofelipe:
> Em paralelo, nossa invoice de Mar√ßo:
> 
> `USD 114.25` `BRL 650.75`

Mais USD 4.50, n√£o √©? Totalizando USD 119.75

Se entendi direito, em uma fatura separada, cobraram USD 10.00 e estornaram USD 5.50 pelas [mudan√ßas na forma de faturamento do dreno de logs](https://vercel.com/changelog/reduced-log-drains-costs-with-smaller-billable-increments).

No fim, o total do dreno custou ao todo USD 9.16 ao inv√©s dos USD 10.00 que vinha sendo cobrado. A mudan√ßa na forma de pagamento foi √≥tima. N√£o pelos USD 0.84 de desconto, mas porque, se aumentarmos o uso novamente (reduzimos em #1838), o acr√©scimo ser√° suave de acordo com o uso, e n√£o um acr√©scimo de mais USD 10.00. üéâ

>> Coment√°rio de heyjunin:
Fala pessoal, tudo certo?

N√£o fa√ßo parte do time oficial do projeto, mas acompanho e admiro o TabNews desde o in√≠cio. Queria me colocar √† disposi√ß√£o para ajudar com deploys, testes e valida√ß√µes em ambientes externos, caso isso seja √∫til para o roadmap ou para entender melhor o comportamento do projeto em produ√ß√£o.

Uma sugest√£o pr√°tica seria subir a aplica√ß√£o em uma VPS com Coolify, que √© uma plataforma open-source estilo Render/Vercel, mas auto-hospedada. Isso permitiria testar com mais controle os aspectos de performance, CI/CD, deploy automatizado, e uso real em cloud privada.

**O plano seria algo como:**
Provisionar uma VPS (por exemplo, Hetzner CX21 ‚Äî 2 vCPU, 4 GB RAM, SSD NVMe)

1. Instalar o Coolify via Docker, que j√° oferece painel, deploy via GitHub, HTTPS com Let's Encrypt, logs e banco integrado
2. Configurar o projeto com base no docker-compose atual, setando vari√°veis de ambiente e volumes persistentes
3. Subir um PostgreSQL isolado, com persist√™ncia e backup automatizado
4. Ativar deploy automatizado via Git push ou GitHub Webhook
5. Configurar dom√≠nio + HTTPS + logs + health checks
6. Rodar alguns testes de carga (k6, artillery, etc.) pra avaliar gargalos e limites da stack atual.

**Pra dar um paralelo:** o Laracasts que √© uma aplica√ß√£o largamente acessada no mundo dev, rodava at√© pouco tempo em uma VPS com apenas 4GB de RAM e 2 vCPUs. Isso mostra que, com uma arquitetura bem feita (como o TabNews claramente tem), √© totalmente vi√°vel operar em infraestrutura pr√≥pria de forma leve e est√°vel.

Se acharem interessante, posso documentar todo o processo, fazer testes, e at√© abrir um PR com sugest√µes de ajustes para facilitar a auto-hospedagem ‚Äî o que pode ser √∫til pra comunidade ou at√© para ambientes de staging.

Qualquer coisa, s√≥ chamar. Estou por aqui pra somar! üöÄ
</issue_1724_Encerramento da parceria com a Vercel>

<issue_1731_Campo `description` em algumas p√°ginas causa resultados inadequados no Google>
### Descri√ß√£o

Atualmente algumas p√°ginas usam a descri√ß√£o padr√£o do TabNews: `Conte√∫dos com valor concreto para quem trabalha com tecnologia.`, mas quando pesquisamos no Google por `TabNews` e ele mostra alguns links com certo destaque, isso fica estranho:

![Links de destaque: perfil filipedeschamps, Recentes, uma publica√ß√£o, Login e perfil NewsletterOficial. Destes, os perfis e o Login tem a descri√ß√£o padr√£o](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/d8c823ae-9a6c-4b7a-b14c-718ed71ea390)

Ao buscar algo mais espec√≠fico para exibir um desses links, aparece um texto mais adequado:

![Busca pelo perfil mostrando a descri√ß√£o do usu√°rio](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/2f97c187-feae-411a-935b-d002b9ce7411)

### Passos para reproduzir o problema

1. Buscar `TabNews` no Google.
2. Acessar o link.
3. Inspecionar a p√°gina.
4. Verificar a meta-tag `<meta name="description"`.

### Navegadores testados

Firefox

### Poss√≠vel solu√ß√£o

Acredito que devemos verificar o `description` de todas as p√°ginas para identificar quais n√£o est√£o adequados, e corrigir. Em casos mais √≥bvios, como Login, podemos usar um texto simples como "Entrar no TabNews", mas no caso dos usu√°rios n√£o sei se o ideal √© mostrar a descri√ß√£o. Acho que √©, porque n√£o consegui pensar em outra coisa que fa√ßa sentido.

Tamb√©m acho melhor remover a parte do t√≠tulo da descri√ß√£o da p√°gina de uma publica√ß√£o, visto que ele se repete.

---

PS: Este problema n√£o ocorre no Bing, visto que ele n√£o usa o `description` nesse cen√°rio:

![Bing mostrando alguns resultados com um texto que existe na p√°gina](https://github.com/filipedeschamps/tabnews.com.br/assets/26308880/2ce53685-f3f4-4258-a7ca-506df2801568)

>> Coment√°rio de aprendendofelipe:
S√≥ este trecho n√£o ficou claro pra mim:

> Tamb√©m acho melhor remover a parte do t√≠tulo da descri√ß√£o da p√°gina de uma publica√ß√£o, visto que ele se repete.

O que temos hoje nas p√°ginas de conte√∫do √©:

```js
title: `${secureContentFound.title ?? oneLineBody.substring(0, 80)} ¬∑ ${secureContentFound.owner_username}`,
description: oneLineBody,
```

>> Coment√°rio de Rafatcb:
> S√≥ este trecho n√£o ficou claro pra mim:
>
> > Tamb√©m acho melhor remover a parte do t√≠tulo da descri√ß√£o da p√°gina de uma publica√ß√£o, visto que ele se repete.

Ah, eu havia presumido, pelo comportamento das outras p√°ginas, o que havia acontecido com a publica√ß√£o que apareceu na lista. A `description` dela est√° correta:

```html
<meta name="description" content="Ol√° pessoal, tudo bem com voc√™s? Pessoal, comecei a desenvolver um App em Flutter para o TabNews. Para podermos utilizar o TabNews tamb√©m no mobile, j√° que todos aqui, concordamos que o p...">
```

Mas o Google concatenou com o t√≠tulo da publica√ß√£o, ficando: `[Atualizado] Aplicativo TabNews. Ol√° pessoal, tudo bem com ...` Olhando brevemente as tags e comparando com as outras p√°ginas, n√£o entendi de onde ele pegou essa parte.

>> Coment√°rio de aprendendofelipe:
> Olhando brevemente as tags e comparando com as outras p√°ginas, n√£o entendi de onde ele pegou essa parte.

√â o trecho da p√°gina que o Google entendeu que corresponde melhor com o termo buscado. N√£o √© a tag `description`, mas o conte√∫do vis√≠vel da p√°gina, nesse caso, come√ßando pelo t√≠tulo (`h1`) que j√° cont√©m exatamente o termo buscado.

>> Coment√°rio de Jeiel0rbit:
> ### Descri√ß√£o
> 
> Atualmente algumas p√°ginas usam a descri√ß√£o padr√£o do TabNews: `Conte√∫dos com valor concreto para quem trabalha com tecnologia.`, mas quando pesquisamos no Google por `TabNews` e ele mostra alguns links com certo destaque, isso fica estranho:

Havia registrado isso tamb√©m. No entanto, n√£o como voc√™ explicou de forma correta.

#1122
</issue_1731_Campo `description` em algumas p√°ginas causa resultados inadequados no Google>

<issue_1732_Posso implementar a op√ß√£o de Login com github?>
### Assunto

Contribui√ß√£o

### D√∫vida

Eu s√≥ queria perguntar se posso ou n√£o implementar um recurso para o usu√°rio fazer login no website com a conta do github usando a API "Passport"? Estou perguntando porque para isso precisaria cadastrar o site no github Oauth.
![Screenshot_23-6-2024_165029_localhost](https://github.com/filipedeschamps/tabnews.com.br/assets/130857984/8e937369-a465-4d41-9679-0b3151823d5c)

>> Coment√°rio de aprendendofelipe:
@Isidro1234, n√£o precisa pedir autoriza√ß√£o para realizar nenhuma implementa√ß√£o, mas se quer saber primeiro se a ideia tem chances de ser aprovada, ent√£o recomendo que participe da issue relacionada (#922) fornecendo mais detalhes sobre o que est√° pensando e vendo o que a Turma acha da ideia üí™

Vou fechar aqui como duplicada. Combinado? ü§ù

>> Coment√°rio de Isidro1234:
Sim!! obrigado.
</issue_1732_Posso implementar a op√ß√£o de Login com github?>

<issue_1750_Latex em publica√ß√µes>
### Descri√ß√£o

Eu encontrei um poss√≠vel problema na formata√ß√£o de f√≥rmulas latex em textos publicados

### Passos para reproduzir o problema

1. Quando escreve a publica√ß√£o est√° tudo correto
2. Quando publiquei o conte√∫do ficou desconfigurado

Exemplo:

$$
\frac{\text{dream outcome} \times \text{perceive likelihood of achievement}}{\text{time delay} \times \text{effort and sacrifice}} = \text{VALUE}
$$

<img width="1337" alt="Screenshot 2024-07-16 at 13 06 20" src="https://github.com/user-attachments/assets/885f70f6-f1a0-4b32-90cb-cad55a71b127">
<img width="1269" alt="Screenshot 2024-07-16 at 13 06 28" src="https://github.com/user-attachments/assets/5d8a8c34-e2a4-41d1-b726-05771afbf4fb">


### Navegadores testados

Google Chrome (Version 126.0.6478.127 (Official Build) (x86_64))

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
@santigonzaga obrigado por reportar isso.

Para facilitar investiga√ß√µes futuras, deixo aqui o c√≥digo usado no coment√°rio:

```latex
$$
\frac{\text{dream outcome} \times \text{perceive likelihood of achievement}}{\text{time delay} \times \text{effort and sacrifice}} = \text{VALUE}
$$
```

>> Coment√°rio de aprendendofelipe:
@santigonzaga, obrigado por relatar! üí™

√â muito prov√°vel que isso precise ser resolvido diretamente na biblioteca do editor de markdown que utilizamos ([ByteMD](https://www.npmjs.com/package/@bytemd/react)), ou no plugin dela.

S√≥ que est√° parecendo que a manuten√ß√£o dela foi descontinuada, ent√£o n√£o vale a pena lidar com esse ponto isoladamente (mesmo que seja algo do nosso lado), e o que recomendo √© resolvermos a #648 buscando alternativas de editores.

Por isso, vou fechar aqui e isso j√° vai criar um link pra c√° na #648
</issue_1750_Latex em publica√ß√µes>

<issue_1756_P√°gina de an√∫ncio tem link para o pr√≥prio an√∫ncio>
### Descri√ß√£o

Ao acessar diretamente a p√°gina de um an√∫ncio, logo depois do texto foi mostrado um link para o pr√≥prio an√∫ncio:

![ad_inception](https://github.com/user-attachments/assets/55634f59-2ee6-47dd-bfc3-ec7d20e7a67c)

Eu entendo isso como bug, pois n√£o faz muito sentido o an√∫ncio ter um link para ele mesmo.

### Passos para reproduzir o problema

Acessar o link de um an√∫ncio (ex: https://www.tabnews.com.br/filipericardo/agora-e-possivel-usar-seus-tabchash)

Obs: Caso haja mais de um an√∫ncio ativo, pode ser que apare√ßa outro. Mas basta recarregar a p√°gina (F5) que eventualmente aparecer√° o mesmo.

Testei tamb√©m em outro browser, aba an√¥nima, etc, e realmente n√£o acontece o tempo todo. Mas basta recarregar que uma hora aparece.
No momento em que escrevo, h√° 2 an√∫ncios ativos, tem vezes que aparece um, tem vezes que √© o outro.

### Navegadores testados

Chrome, Firefox, Safari

### Poss√≠vel solu√ß√£o

O mais simples seria n√£o mostrar o mesmo an√∫ncio na pr√≥pria p√°gina. Ou ent√£o n√£o mostrar an√∫ncio nenhum quando for a p√°gina de um an√∫ncio.

>> Coment√°rio de aprendendofelipe:
Acredito que nas p√°ginas de an√∫ncios n√£o seja interessante mostrar outros an√∫ncios.

Talvez a exce√ß√£o seja mostrar diferentes an√∫ncios do mesmo autor, caso existam.

>> Coment√°rio de hkotsubo:
> Talvez a exce√ß√£o seja mostrar diferentes an√∫ncios do mesmo autor, caso existam.

N√£o sei se j√° devia abrir exce√ß√µes. A funcionalidade acabou de ser implementada, talvez seja cedo pra sabermos o que faz mais sentido.

Em um primeiro momento podemos simplesmente n√£o mostrar nada. Depois, com o tempo, ir avaliando se faz sentido abrir exce√ß√µes. Por exemplo, se forem raros os casos em que o mesmo usu√°rio tem mais de um an√∫ncio ativo, talvez nem valha a pena ter esta regra.
</issue_1756_P√°gina de an√∫ncio tem link para o pr√≥prio an√∫ncio>

<issue_1762_Limitar an√∫ncios ativos por usu√°rio>
### Descri√ß√£o

No momento em que escrevo, h√° 8 an√∫ncios ativos do mesmo usu√°rio <sup>o fato de ser o criador do site √© indiferente, ou n√£o?</sup>

Atualmente isso corresponde a 80% dos an√∫ncios ativos. Isso n√£o acaba criando um certo desbalanceamento? Claro que, por ter TabCash suficiente, ele teria todo o direito de cri√°-los. Mas at√© que ponto √© ben√©fico que um √∫nico usu√°rio praticamente monopolize os an√∫ncios?

Entendo que a funcionalidade √© nova e ainda estamos entendendo melhor seus impactos no site. S√≥ queria levantar a discuss√£o para ver se meu questionamento faz sentido.

### Sugest√£o de implementa√ß√£o

Talvez seja interessante pensar em limites.

Provavelmente uma quantidade m√°xima de an√∫ncios ativos por usu√°rio, ou n√£o pode ultrapassar determinada porcentagem do total.

E quem sabe combinado com limites de tempo (s√≥ pode criar outro an√∫ncio depois de X horas/dias/etc).

O que acham?

>> Coment√°rio de aprendendofelipe:
Quem tem mais TabCash tem que ter alguma vantagem sobre quem tem menos. Acho que posso pular a justificativa para essa afirma√ß√£o. 

Por enquanto que o valor est√° fixo em 100 TabCash, criar mais an√∫ncios √© a √∫nica forma de aparecer mais. Quando o  valor for vari√°vel, provavelmente vai aparecer mais an√∫ncios de quem optar por investir mais TabCash. √â natural.

Pensando em um sistema de an√∫ncios, n√£o √© nem um pouco interessante limitar a  quantidade de diferentes an√∫ncios de um mesmo anunciante. Concentrar o investimento em um √∫nico an√∫ncio ou diversificar √© uma quest√£o estrat√©gica do anunciante.

Por enquanto o Filipe est√° usando TabCash do usu√°rio dele pra ajudar a testar a funcionalidade. Qualquer um que tenha TabCash suficiente pode fazer o mesmo. Vai aparecer mais vezes os an√∫ncios de quem investir mais. Seja com an√∫ncios iguais ou variados.

Sobre ser o criador do site, n√£o √© indiferente n√£o. A Revenue Share prev√™ que parte das exibi√ß√µes de an√∫ncios seja para custear o pr√≥prio TabNews, ent√£o o Filipe poderia at√© n√£o usar nenhum TabCash se n√£o quisesse, mas a√≠ a gente n√£o estaria testando direito a funcionalidade da forma que ela ser√° para o usu√°rio final.

>> Coment√°rio de aprendendofelipe:
Um outro ponto √© que qualquer regra que beneficie a cria√ß√£o de diferentes usu√°rios por uma mesma pessoa √© algo prejudicial ao TabNews

>> Coment√°rio de hkotsubo:
> Quem tem mais TabCash tem que ter alguma vantagem sobre quem tem menos

Concordo.

Mas ainda sim, √© aceit√°vel que um √∫nico usu√°rio monopolize os an√∫ncios? Eu, por exemplo, poderia criar 29 an√∫ncios agora mesmo. E nada impede que todos sejam sobre a mesma coisa (e n√£o necessariamente com o mesmo texto, por exemplo).

Bom, se vcs n√£o v√™em problema, tudo bem, podemos at√© fechar a *issue*. Mas ainda acho que algum limite poderia ter, pra evitar abusos.

---

> qualquer regra que beneficie a cria√ß√£o de diferentes usu√°rios por uma mesma pessoa √© algo prejudicial ao TabNews

N√£o entendi como minha proposta beneficiaria a cria√ß√£o de v√°rios usu√°rios por uma mesma pessoa. Afinal, um novo usu√°rio come√ßaria sem TabCash, e portanto sem a possibilidade de criar an√∫ncios. A pessoa precisaria primeiro ganhar TabCoins pra depois conseguir votar em algu√©m e ganhar TabCash (claro que poderia usar a conta anterior para votar na nova, mas isso √© trabalho demais pra quem est√° buscando uma forma f√°cil de burlar o sistema).

Ou seja, se existisse um limite, n√£o adiantaria nada criar outro usu√°rio para tentar burlar a regra.

>> Coment√°rio de aprendendofelipe:
> ...√© aceit√°vel que um √∫nico usu√°rio monopolize os an√∫ncios?

N√£o tenho certeza se seu ponto √© sobre a quantidade de an√∫ncios ou se √© sobre a quantidade de exibi√ß√µes. Considerando que os an√∫ncios serem iguais ou diferentes seja uma decis√£o que cabe a cada anunciante, acho que o ponto √© sobre os an√∫ncios de um usu√°rio aparecerem muito mais do que os de outro usu√°rio, independentemente de ser um √∫nico an√∫ncio ou variados desse mesmo usu√°rio.

Em um momento que apenas um √∫nico usu√°rio queira publicar an√∫ncios, nesse momento s√≥ vai aparecer an√∫ncios desse usu√°rio, o bolo ser√° inteiro dele, mas como poderia ser diferente? Foi o que aconteceu no per√≠odo que s√≥ tinha o an√∫ncio do `filipericardo` publicado.

Em momentos que algum usu√°rio decidir investir mais do que os outros usu√°rios, nesse caso vai haver uma exibi√ß√£o maior desse usu√°rio, o que √© justo, ou n√£o? √â o que est√° acontecendo agora, j√° que poucos usu√°rios criaram an√∫ncios, e um deles investiu mais do que os outros.

Em qualquer caso, a exibi√ß√£o de an√∫ncios ser√° uma raz√£o entre o que o usu√°rio investir e o somat√≥rio do que todos os demais investirem. Idealmente teremos muito mais gente anunciando no futuro, ou seja, o bolo ser√° dividido em muito mais peda√ßos, mas alguns v√£o comprar mais peda√ßos do que outros, o que √© normal.

> Eu, por exemplo, poderia criar 29 an√∫ncios agora mesmo. E nada impede que todos sejam sobre a mesma coisa (e n√£o necessariamente com o mesmo texto, por exemplo).

Se isso for interessante para voc√™, pode usar o TabCash como achar mais vantajoso. Voc√™ mereceu eles ü§ù S√≥ n√£o deixe de ser estrat√©gico, pois usar tudo agora n√£o vai aumentar o tamanho do bolo, mas sim diminuir o tamanho de cada peda√ßo. Se for criar an√∫ncios iguais, provavelmente os usu√°rios n√£o v√£o qualificar da mesma forma os diferentes an√∫ncios, mas vai saber, n√©?

Tamb√©m √© bom considerar que os bolos no futuro devem ter peda√ßos menores (tamb√©m podem ser maiores se os visitantes aumentarem), vai depender bastante de como ser√° a disposi√ß√£o dos anunciantes em usar seus TabCash, e das regras que ainda est√£o sendo pensadas. Estamos aprendendo isso agora, mas n√£o me parece fazer sentido limitar a propor√ß√£o de exibi√ß√µes por usu√°rio, e sim pelo saldo de TabCash de cada um.


> Bom, se vcs n√£o v√™em problema, tudo bem, podemos at√© fechar a _issue_. Mas ainda acho que algum limite poderia ter, pra evitar abusos.

O que seria abuso? Voc√™ s√≥ pode comer o bolo inteiro se ningu√©m mais quiser comer o mesmo bolo que voc√™. Na pr√°tica, cada um vai comer mais ou menos bolo, de forma proporcional ao que investir. E s√≥ pode investir mais se realmente contribuiu mais com o TabNews e foi reconhecido pela Turma.

 
> > qualquer regra que beneficie a cria√ß√£o de diferentes usu√°rios por uma mesma pessoa √© algo prejudicial ao TabNews
> 
> N√£o entendi como minha proposta beneficiaria a cria√ß√£o de v√°rios usu√°rios por uma mesma pessoa.

√â claro que usar diferentes usu√°rios j√° abre brecha para muitos abusos, ent√£o vamos tratar apenas o que tem rela√ß√£o com o limite de an√∫ncios.

Se seus 2900 TabCash fossem o resultado do mesmo esfor√ßo que voc√™ j√° teve, mas dividido entre dois usu√°rios, e que isso resultasse em 1500 TabCash para um e 1400 para o outro, a quantidade de an√∫ncios que voc√™ poderia fazer seriam os mesmos 29. Se limitarmos os an√∫ncios por usu√°rio, ent√£o sim haveria uma vantagem em ter 2 ou mais usu√°rios, pois o seu limite real aumentaria de acordo com o n√∫mero de usu√°rios utilizados. Dado que o total de exibi√ß√£o de todos os an√∫ncios independe disso, o que aumentaria a chance de aparecer n√£o seria ter mais TabCash para investir, mas sim ter mais usu√°rios com a quantidade suficiente de TabCash para criar os an√∫ncios.

> Afinal, um novo usu√°rio come√ßaria sem TabCash, e portanto sem a possibilidade de criar an√∫ncios. A pessoa precisaria primeiro ganhar TabCoins pra depois conseguir votar em algu√©m e ganhar TabCash 

E n√£o √© assim, seja com ou sem limite? N√£o entendi a relev√¢ncia desse ponto para a quest√£o.

> ...(claro que poderia usar a conta anterior para votar na nova, mas isso √© trabalho demais pra quem est√° buscando uma forma f√°cil de burlar o sistema).

Aqui est√° tratando de um tipo de abuso real, que combatemos diariamente, mas sem nenhuma rela√ß√£o com a exist√™ncia de limites de an√∫ncios ativos por usu√°rio.
 
> Ou seja, se existisse um limite, n√£o adiantaria nada criar outro usu√°rio para tentar burlar a regra.

N√£o consegui chegar nessa conclus√£o ü§∑

>> Coment√°rio de Rafatcb:
Acho este issue uma preocupa√ß√£o v√°lida, mas voto para observamos a evolu√ß√£o natural do comportamento das pessoas com os an√∫ncios antes de criar essa limita√ß√£o. At√© o momento:

- A funcionalidade existe h√° quase 2 dias completos (48h).
- Apenas um an√∫ncio recebeu voto negativo: o [primeiro an√∫ncio](https://www.tabnews.com.br/filipericardo/agora-e-possivel-usar-seus-tabchash), que est√° com `72` TabCoins, recebeu um voto negativo.
- Apenas tr√™s usu√°rios criaram an√∫ncios: `filipericardo`, `filipedeschamps` e `NewsletterOficial`.
- Temos 10 an√∫ncios ativos, 8 de um √∫nico usu√°rio.

Como por enquanto o an√∫ncio escolhido para ser exibido √© de forma totalmente aleat√≥ria, sem contar a quantidade de TabCash investido, nossa an√°lise √© limitada nesse sentido, e o comportamento dos usu√°rios pode mudar quando essa din√¢mica for inserida. Se optarmos por limitar a quantidade de an√∫ncios, significa que vamos afunilar os caminhos poss√≠veis para os usu√°rios, e podemos tirar conclus√µes erradas sobre como a funcionalidade deve evoluir.

Al√©m de estarmos pensando em aumentar as chances do an√∫ncio ser escolhido conforme possui mais TabCash, o Filipe comentou em https://github.com/filipedeschamps/tabnews.com.br/issues/1491#issuecomment-2226912945

> Isto ir√° fazer a p√°gina `Classificados` mostrar os an√∫ncios que os usu√°rios est√£o investindo mais `tabcash`.

O que, se entendi direito, faria a lista de Classificados n√£o ser mais ordenada pela data de publica√ß√£o (mais novos primeiros), e sim por TabCash (mais TabCash primeiro).

Esses dois pontos me levam a crer que investir a mesma quantidade de TabCash em menos an√∫ncios pode faz√™-los serem vistos mais vezes do que criar v√°rios an√∫ncios com o m√≠nimo de TabCash. Por isso eu gostaria de ver o comportamento evoluindo naturalmente antes de criar essa limita√ß√£o. O que voc√™s acham?

>> Coment√°rio de hkotsubo:
> dividido entre dois usu√°rios, e que isso resultasse em 1500 TabCash para um e 1400 para o outro, a quantidade de an√∫ncios que voc√™ poderia fazer seriam os mesmos 29

Na verdade eu estava pensando em um caso espec√≠fico: um usu√°rio que atingiu o limite de an√∫ncios e s√≥ ent√£o resolve criar outra conta pra tentar burlar.

Neste caso n√£o valeria a pena, pois at√© a nova conta ter TabCash suficiente para criar um an√∫ncio, os anteriores (feitos com a conta original) provavelmente j√° ter√£o expirado e ele j√° poderia criar outros an√∫ncios.

Enfim, foi isso que eu quis dizer com "*se existisse um limite, n√£o adiantaria nada criar outro usu√°rio para tentar burlar a regra*".

No caso da pessoa j√° ter outra conta h√° muito tempo, a√≠ concordo que o limite n√£o resolve.

E indo um pouco al√©m, j√° vi muitos casos de gente que n√£o conseguia mais publicar por ter pontua√ß√£o negativa, e criou outra conta pra poder continuar postando. Todo bloqueio ou limite no fundo √© um "incentivo" (entre aspas bem grandes) para criar outra conta, mas a√≠ acho que j√° √© outra discuss√£o...

>> Coment√°rio de hkotsubo:
> voto para observamos a evolu√ß√£o natural do comportamento das pessoas com os an√∫ncios antes de criar essa limita√ß√£o

> eu gostaria de ver o comportamento evoluindo naturalmente antes de criar essa limita√ß√£o

√â, talvez eu tenha levantando a bola cedo demais.

Podemos deixar a issue "na geladeira" e revisit√°-la no futuro. Pode ser que com o tempo eu at√© mude de ideia, dependendo de como as coisas se desenrolarem...

>> Coment√°rio de aprendendofelipe:
Ok, vou fechar a issue, e pode ser aberta uma nova abordando algum problema relacionado, se surgir, e que demande um debate para encontrar uma solu√ß√£o ü§ù

Se mantermos essa aberta, algu√©m pode gastar energia implementando isso, j√° que o t√≠tulo parece definir um requisito. üëç

>> Coment√°rio de filipedeschamps:
@hkotsubo muito obrigado por ter criado essa issue e parab√©ns a todos por essa √≥tima conversa! ü§ù 

Meu intuito em criar aqueles diversos an√∫ncios, fora testar de verdade a feature, foi para **incentivar** e mostrar aos usu√°rios que √© poss√≠vel e at√© **muito bem vindo** existir an√∫ncios que n√£o s√£o diretamente vinculados a algum produto tradicionalmente **comercial**. Por exemplo quando eu divulgo o [reposit√≥rio do Fogo do Doom](https://www.tabnews.com.br/filipedeschamps/algoritmo-fogo-do-doom-implementado-em-varias-linguagens-de-programacao) ou v√≠deos do meu canal como [este sobre aprender qualquer coisa](https://www.tabnews.com.br/filipedeschamps/3-tecnicas-que-eu-uso-para-aprender-a-programar-qualquer-coisa).

Eu **genuinamente** ficarei muito feliz se as pessoas que n√£o possuem interesse em divulgar algo comercial, utilizem este espa√ßo para divulgar seus projetos pessoais, conte√∫dos ou qualquer coisa que fa√ßa ter valido a pena a contribui√ß√£o que fez de antem√£o ao TabNews. Inclusive, ser√° muito **saud√°vel** para os espa√ßos publicit√°rios se eles tiverem uma mistura entre an√∫ncios comerciais e n√£o comerciais.

Por fim, quanto mais an√∫ncios, melhor vamos testar a feature, mais varia√ß√µes ir√£o existir e mais informa√ß√µes sobre o comportamento das coisas teremos, at√© para evoluir a feature para a **dire√ß√£o certa**. Ent√£o @hkotsubo seria muito legal para a varia√ß√£o dos an√∫ncios se voc√™ tamb√©m divulgasse o [livro que est√° listado aqui no seu perfil do TabNews](https://www.tabnews.com.br/kht) ü§ù 

---

Em paralelo a tudo isso, [mais um usu√°rio criou um an√∫ncio](https://www.tabnews.com.br/FelipeLC/3-dias-gratis-na-melhor-plataforma-de-ad-spy-da-internet) üéâ

>> Coment√°rio de hkotsubo:
@filipedeschamps 
Sim, eu pretendo criar um an√∫ncio do meu livro.

S√≥ estava esperando um pouco pra ver como a funcionalidade era aceita pela comunidade, al√©m de entender um pouco melhor o funcionamento na pr√°tica. Mas em breve criarei sim.
</issue_1762_Limitar an√∫ncios ativos por usu√°rio>

<issue_1770_Implementa√ß√£o de categoriza√ß√£o de posts>
### Descri√ß√£o

Com o objetivo de facilitar a pesquisa sugiro a implementa√ß√£o de classifica√ß√£o de posts por tags/categoria, assim se quis√©ssemos pesquisar por algo relacionado a Java por exemplo, filtrar√≠amos a pesquisa, e assim encontrar√≠amos conte√∫do relacionado aos posts que procuramos.

obs.: n√£o sei se isso conflitua com os objetivos do tabnews
Espero deferimento positivo!!!üåü


### Sugest√£o de implementa√ß√£o

A implementa√ß√£o dessa funcionalidade poderia ser feita adicionando um field a mais aos criar novos posts.

obs.: sou desenvolvedor python e django, conhe√ßo pouco do mundo react, angular ou de qualquer outro framework js, pois uso ele superficialmente nos meus sistemas.

>> Coment√°rio de aprendendofelipe:
@angelo-francisco, obrigado pela sugest√£o! üí™

Vou fechar a issue por ser duplicada com #742 ü§ù
</issue_1770_Implementa√ß√£o de categoriza√ß√£o de posts>

<issue_1774_For√ßar usu√°rio a comentar quando tentar negativar post>
### Descri√ß√£o

Recentemente vi alguns posts sendo negativado sem motivos grandes aparente, abria o post para ver os coment√°rios mas nada, as pessoas negativa sem explicar o porqu√™, ai pensei nisso de quando o usu√°rio for tentar negativar um post ele seja for√ßado a comentar o porqu√™

Poderia at√© ter um textinho como: `Por favor deixe seu feedback para que o autor possa saber em que melhorar` ou algo do tipo

### Sugest√£o de implementa√ß√£o

Poderia at√© ser um modal parecido com o que aparece quando o [corpo da mensagem √© muito pequeno](https://github.com/filipedeschamps/tabnews.com.br/blob/c8e7d6e82dd398d3b83b37e558dae2e52c0d9dc9/pages/interface/components/Content/index.js#L312), n√£o sou muito familiarizado com next e react, mais vi que as transa√ß√µes acontecem no componente [TabCoinButtons](https://github.com/filipedeschamps/tabnews.com.br/blob/c8e7d6e82dd398d3b83b37e558dae2e52c0d9dc9/pages/interface/components/TabCoinButtons/index.js#L48), acredito que daria para fazer algo como buscar nos coment√°rios do post se o usu√°rio j√° comentou, se sim deixava ele negativar caso contr√°rio mostrava o modal para ele pedido para d√° feedback

```js
async function transactTabCoin(transactionType) {
  setIsPosting(true);

  if (!user && !isLoading) {
    router.push(`/login?redirect = $ {
      router.asPath
    }`);
    return;
  }

  // n√£o sei o jeito de fazer isso mais t√° ai
  if (transactionType === "debit") {
    const comments = await fetch(
      "https://www.tabnews.com.br/api/v1/contents/" + 
      `${content.owner_username}/${content.slug}/children`
    )
    const commented = comments
      .map(comment => comment.owner_username)
      .includes(user.username)

    if (!commented) {
      return confirm({
        title: 'Deixe seu feedback',
        content: ( < Flash variant = "warning" >
          ‚ö† Aten√ß√£o: Por favor deixe seu feedback para que o autor possa saber em que melhorar < /Flash >
        ),
        cancelButtonContent: 'Cancelar',
        confirmButtonContent: 'Comentar'
      })
    }
  }
....

```

Apenas um rascunho de c√≥digo, mas √© mais ou menos isso que quero dizer

>> Coment√°rio de HarukaYamamoto0:
vim a perceber agora que existe a issue #1651, que √© parecida com essa, mas estranho porque eu pesquisei antes para ver se tinha alguma relacionada e n√£o havia aparecido antes, mas talvez o peda√ßo de c√≥digo acima venha a calhar para algo

>> Coment√°rio de Rafatcb:
@HarukaYamamoto0 Obrigado pela sugest√£o! Como voc√™ disse, √© uma issue duplicada, ent√£o vou fechar esta. Se desejar, pode comentar para complementar algo na outra issue (#1651), assim mantemos as sugest√µes e discuss√µes num √∫nico lugar üëç
</issue_1774_For√ßar usu√°rio a comentar quando tentar negativar post>

<issue_1776_Problema com testes locais>
### Descri√ß√£o

Eu tentei rodar o projeto localmente, seguindo as instru√ß√µes do readme, mas tanto os testes como o projeto n√£o s√£o rodados.

```bash
npm test

> tabnews.com.br@1.0.0 test
> npm run concurrently -- --hide next -- run


> tabnews.com.br@1.0.0 preconcurrently
> kill-port 3000 && npm run services:up

Process on port 3000 killed

> tabnews.com.br@1.0.0 services:up
> npm run docker:compose -- up -d


> tabnews.com.br@1.0.0 docker:compose
> docker compose --env-file .env -f infra/docker-compose.development.yml up -d

[+] Running 2/0
 ‚úî Container mailcatcher   Running                                                                                 0.0s
 ‚úî Container postgres-dev  Running                                                                                 0.0s

> tabnews.com.br@1.0.0 concurrently
> concurrently -s first -P -k -n next,vitest "npm run next" "vitest {@}" --hide next -- run

--> Sending SIGTERM to other processes..
[vitest] vitest run exited with code SIGTERM`
```

### Passos para reproduzir o problema

1. Clone o projeto
2. Rode o comando `npm install`
3. Rode o comando `npm test`


### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Enzo, depois de `> concurrently -s first -P -k -n next,vitest "npm run next" "vitest {@}" --hide next -- run` voc√™ usou `CTRL+C` para parar o processo?

E ao usar `npm run dev`, voc√™ consegue acessar a aplica√ß√£o em `http://localhost:3000/`?


Aqui, sem interromper o processo, funciona normalmente:

```bash
npm run test

> tabnews.com.br@1.0.0 test
> npm run concurrently -- --hide next -- run


> tabnews.com.br@1.0.0 preconcurrently
> kill-port 3000 && npm run services:up

Process on port 3000 killed

> tabnews.com.br@1.0.0 services:up
> npm run docker:compose -- up -d


> tabnews.com.br@1.0.0 docker:compose
> docker compose --env-file .env -f infra/docker-compose.development.yml up -d

[+] Running 2/0
 ‚úî Container postgres-dev  Running                                                                                            0.0s 
 ‚úî Container mailcatcher   Running                                                                                            0.0s 

> tabnews.com.br@1.0.0 concurrently
> concurrently -s first -P -k -n next,vitest "npm run next" "vitest {@}" --hide next -- run

[vitest] 
[vitest]  RUN  v1.6.0 /home/rafael/Documents/Repositorios/tabnews.com.br
[vitest] 
[vitest]  ‚úì tests/integration/api/v1/contents/post.test.js  (96 tests) 38587ms
[vitest]  ‚úì tests/integration/api/v1/contents/[username]/[slug]/patch.test.js  (91 tests) 9861ms
...
```

>> Coment√°rio de kaioenzo:
Para adicionar contexto, estou no wsl2. 
N√£o executo nenhum comando depois de iniciar o `npm run test`. Com o comando `npm run start` tamb√©m n√£o consigo rodar o projeto:
```
npm run dev

> tabnews.com.br@1.0.0 dev
> npm run services:seed && npm run next && npm run services:stop


> tabnews.com.br@1.0.0 services:seed
> kill-port 3000 && npm run services:up && npm run migration:run && npm run migration:seed

Process on port 3000 killed

> tabnews.com.br@1.0.0 services:up
> npm run docker:compose -- up -d


> tabnews.com.br@1.0.0 docker:compose
> docker compose --env-file .env -f infra/docker-compose.development.yml up -d

[+] Running 2/0
 ‚úî Container postgres-dev  Running                                                                                 0.0s
 ‚úî Container mailcatcher   Running                                                                                 0.0s

> tabnews.com.br@1.0.0 migration:run
> node -r dotenv-expand/config infra/scripts/wait-for-db-connection-ready.js && node-pg-migrate up --envPath ./.env -m infra/migrations/ 2>migrations.log

health check postgres:  /var/run/postgresql:5432 - accepting connections

No migrations to run!
Migrations complete!

> tabnews.com.br@1.0.0 migration:seed
> node -r dotenv-expand/config infra/scripts/seed-database.js

> Seeding database...
------------------------------
> You can now Login to TabNews using the following credentials:
> "admin@admin.com" + "password"
> "user@user.com" + "password"
------------------------------

> Creating Firewall functions...
> Firewall functions created!

> Database seeded!

> tabnews.com.br@1.0.0 next
> next dev

  ‚ñ≤ Next.js 14.2.4
  - Local:        http://localhost:3000
  - Environments: .env
  - Experiments (use with caution):
    ¬∑ scrollRestoration

 ‚úì Starting...

> tabnews.com.br@1.0.0 services:stop
> npm run docker:compose -- stop


> tabnews.com.br@1.0.0 docker:compose
> docker compose --env-file .env -f infra/docker-compose.development.yml stop

[+] Stopping 2/2
 ‚úî Container mailcatcher   Stopped                                                                                 1.1s
 ‚úî Container postgres-dev  Stopped
```

>> Coment√°rio de Rafatcb:
Eu uso o Fedora para rodar o TabNews, mas tamb√©m j√° rodei no Windows, sem WSL. Como nunca usei WSL, ficar√° mais dif√≠cil de te ajudar, principalmente por n√£o acontecer nenhum erro.

Voc√™ j√° conseguiu rodar outro projeto em Next.js no WSL ou √© a sua primeira vez?

Experimente usar esse comando:

```bash
npm run services:seed && npm run next
```

O `npm run dev` tem um ` && npm run services:stop` ao final, que foi executado ap√≥s o `Starting ...` no seu log. N√£o sei se foi porque o comando `npm run next` terminou, n√£o teve nenhum log entre as duas opera√ß√µes. 

Veja o final do meu log, como compara√ß√£o::

```bash
> Database seeded!

> tabnews.com.br@1.0.0 next
> next dev

  ‚ñ≤ Next.js 14.2.4
  - Local:        http://localhost:3000
  - Environments: .env
  - Experiments (use with caution):
    ¬∑ scrollRestoration

 ‚úì Starting...
 ‚úì Ready in 2.1s
 ```

>> Coment√°rio de kaioenzo:
Consegui rodar pelo terminal integrado do docker desktop. De fato no wsl parece ter algum problema que n√£o consegui resolver.

>> Coment√°rio de aprendendofelipe:
@kaioenzo, obrigado por reportar! üí™

Aparentemente o que est√° acontecendo √© que o Next.js est√° sendo encerrado, e isso faz encerrar todo o resto. √â preciso investigar o que est√° encerrando o Next. Se o teste que o @Rafatcb sugeriu tamb√©m n√£o funcionou, tente isto, por favor:

```bash
npm run services:up && npm run migration:run && npm run migration:seed && npm run next
```

Se isso tamb√©m falhar, pode n√£o ser algo com o TabNews. Tente descobrir se o problema √© a porta 3000 ou o Next.js. Est√° conseguindo executar algum outro projeto Next.js em uma porta diferente? Consegue rodar qualquer outro projeto na porta 3000?

---

Aproveito para deixar p√∫blico que estou trabalhando em uma melhoria que vai permitir a utiliza√ß√£o de diferentes arquivos de vari√°veis de ambiente, o que vai facilitar subir os servi√ßos com diferentes configura√ß√µes, por exemplo mudando a porta do servidor Next.js

>> Coment√°rio de aprendendofelipe:
@kaioenzo, descobriu mais alguma coisa?

Consegue fazer um teste usando a branch https://github.com/filipedeschamps/tabnews.com.br/tree/tabnews-config ?

Da√≠ pode usar os comandos normais `npm run dev` ou `npm run test` ü§ùüí™
</issue_1776_Problema com testes locais>

<issue_1777_inconsist√™ncia na contagem de coment√°rios de uma postagem>
### Descri√ß√£o

Boa noite acredito que tenha encontrado a seguinte incosist√™ncia no projeto:

Seja na p√°gina **_/{username}/conteudos/{page-number}_** ou em qualquer outra rota que mostre uma publica√ß√£o feita por um usu√°rio de maneira compacta e/ou reduzida, a contagem de coment√°rios est√° suscet√≠vel a disparidade entre o que √© realmente mostrado em tela quando se abre a publica√ß√£o e o n√∫mero mostrado no contador de coment√°rios. Dessa forma, uma ocorr√™ncia √© a forma compacta dizer que a publica√ß√£o tem 2 coment√°rios e no momento que a mesma √© aberta nenhum √© mostrado em tela. Observe nas imagens a abaixo:

![Screenshot from 2024-08-11 11-23-32](https://github.com/user-attachments/assets/529ee73c-943f-4cff-a60b-66e876ec3d90)

![Screenshot from 2024-08-11 11-23-48](https://github.com/user-attachments/assets/a1dad288-3b43-43c3-b575-a603fbe77426)

Tal erro foi encontrado no ambiente de desenvolvimento e testado brevemente na aplica√ß√£o real que est√° em produ√ß√£o e em ambos ocorreu a mesma inconsist√™ncia.

### Passos para reproduzir o problema

Para reproduzir, deve-se seguir os passos no ambiente de desenvolvimento:

1. Fa√ßa login com a conta user@user.com
2. Crie uma publica√ß√£o
3. Comente algo nessa publica√ß√£o
4. Fa√ßa logout da conta user@user.com
5. Entre com outra conta qualquer, pode ser a admin@admin.com
6. Crie 2 coment√°rios na publica√ß√£o no usu√°rio user@user.com, mas agora respondendo o coment√°rio j√° feito desse mesmo usu√°rio, ou seja, seus coment√°rios come√ßaram um thread de coment√°rios sobre um j√° existente
7. Fa√ßa logout da conta atual, admin@admin.com
8. Entre com a conta user@user.com
9. Apague o primeiro coment√°rio feito, ou seja, o mais em cima
10. Pronto, agora o bug est√° feito, como o coment√°rio principal da thread foi apagado a thread inteira n√£o √© mostrada em tela, entretanto, a contagem de coment√°rios avalia aqueles que n√£o foram apagados mas faziam parte da thread.

Observa-se que a inconsist√™ncia pode necessitar da intera√ß√£o entre dois usu√°rios, mas n√£o √© estritamente necess√°rio. Al√©m disso, n√£o √© preciso que um usu√°rio seja admin, o mesmo apenas foi utilizado no exemplo para n√£o ser necess√°ria a cria√ß√£o de mais usu√°rios no ambiente de desenvolvimento, visto que os dois utilizados j√° existem para testes.

### Navegadores testados

Chrome, Firefox

### Poss√≠vel solu√ß√£o

Uma poss√≠vel solu√ß√£o observada foi a seguinte:

Observou-se ap√≥s uma an√°lise de c√≥digo que a maior parte do bug estava relacionado a uma query de banco de dados que n√£o foi constru√≠da adequadamente. Dessa forma o primeiro passo ser√° a defini√ß√£o aprimorada de tal no arquivo **_/models/content.js_** na fun√ß√£o **findTree**.  Seguindo, ser√° tamb√©m necess√°rio adicionar uma nova condi√ß√£o de tratamento na **flatListToTree** para que threads de m√∫ltiplos coment√°rios deletados n√£o sejam poss√≠veis, ou seja, aparece apenas o coment√°rio pai deletado mais acima poss√≠vel na ancestralidade. Por fim, o resultado final da query deve ser tratado no Frontend para que seja mostrado o coment√°rio deletado de forma mais simplificada, ou seja, sem o conte√∫do e op√ß√µes de resposta, mas com uma flag indicando sua dele√ß√£o em um momento anterior.

Para justificar tal m√©todo, pode-se observar o modelo do Reddit, que utiliza a mesma ideia aplicada na minha solu√ß√£o proposta, de forma que os usu√°rios consigam ver que existia um coment√°rio anteriormente ali, mas o mesmo foi deletado e ainda existem outros em sua thread que n√£o foram e podem ser de relev√¢ncia para aqueles que est√£o lendo a postagem.

>> Coment√°rio de Rafatcb:
@mateusvrs obrigado pela descri√ß√£o bem detalhada! Esse assunto j√° foi abordado em https://github.com/filipedeschamps/tabnews.com.br/issues/1462 e decidimos concentrar o assunto no issue https://github.com/filipedeschamps/tabnews.com.br/issues/1089, que fala sobre o comportamento similar ao Reddit que voc√™ mencionou.

Por isso, vou fechar este issue.

>> Coment√°rio de mateusvrs:
Muito obrigado @Rafatcb, n√£o tinha verificado tal issue.
</issue_1777_inconsist√™ncia na contagem de coment√°rios de uma postagem>

<issue_1784_Existem algumas palavras erradas na p√°gina de: "Sobre trabalhar como freelancer"">
### Descri√ß√£o

Na p√°gina que fala: "Sobre trabalhar como Freelancer " existem pequenos erros na escrita

### Passos para reproduzir o problema

Acessar a p√°gina para contribuidores e apertar em "Sobre como trabalhar como Freelancer"

### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

Poderia sar mudado o HTML envolvido na p√°gina web

>> Coment√°rio de Rafatcb:
Imagino que esteja falando sobre apontar erros ortogr√°ficos durante a escrita do conte√∫do, visto que o conte√∫do que voc√™ mencionou foi criado por um usu√°rio. Como mencionado em https://github.com/filipedeschamps/tabnews.com.br/issues/970#issuecomment-1845179627, isso faz parte do editor de texto que usamos, o ByteMD, e estamos concentrando as discuss√µes sobre isso em https://github.com/filipedeschamps/tabnews.com.br/issues/648, visto que provavelmente resolveremos isso ao trocar de editor.

Se n√£o foi esse problema que voc√™ quis dizer, pode comentar aqui e reabrimos a issue, se necess√°rio.
</issue_1784_Existem algumas palavras erradas na p√°gina de: "Sobre trabalhar como freelancer"">

<issue_1792_feat: Notifica√ß√µes de Engajamento em Postagens>
## Notifica√ß√µes

Implementar um sistema de notifica√ß√µes que permita aos usu√°rios acompanhar o engajamento em suas postagens. As notifica√ß√µes poderiam incluir:
- Coment√°rios recebidos nos posts.
- Men√ß√µes e respostas a seus respectivos posts e coment√°rios.
- N√∫mero de visualiza√ß√µes das postagens.
- Curtidas ou rea√ß√µes nas postagens.


Melhorar a intera√ß√£o entre os usu√°rios e o acompanhamento de suas postagens, promovendo maior engajamento na plataforma.

</br>

## Sugest√£o de implementa√ß√£o

![Captura de tela 2024-09-09 182425](https://github.com/user-attachments/assets/c88dff0e-440a-42c1-81f2-f7838be769a4)


[Link para o Figma](https://www.figma.com/design/BuuAXcHtg9BvrrPBDPdbq9/TabNews---Notification?node-id=0-1&t=tSvgdDhKF2GttOyx-1)

@filipedeschamps

>> Coment√°rio de Rafatcb:
@matheusscode obrigado pela sugest√£o! Vou fechar este issue porque j√° temos uma conversa sobre o assunto de notifica√ß√µes em #738 , mas pe√ßo, por favor, que coloque sua sugest√£o de UI l√° porque ela pode servir para quando esse recurso for implementado.

>> Coment√°rio de matheussfigueiredo:
Fala @Rafatcb, tudo bem! Pode deixar, irei adicionar sim!
</issue_1792_feat: Notifica√ß√µes de Engajamento em Postagens>

<issue_1793_feat: Avatar para Usu√°rios>
### Descri√ß√£o

## Avatar para Usu√°rios

## Descri√ß√£o
Adicionar suporte para os usu√°rios personalizarem seu perfil com um avatar. Isso ajudaria a criar uma identidade visual mais forte, tanto nas postagens quanto nos coment√°rios.

## Motiva√ß√£o
A introdu√ß√£o de avatares tornaria a experi√™ncia do usu√°rio mais personalizada e visualmente atrativa, ajudando na identifica√ß√£o e engajamento entre os membros da comunidade.

@filipedeschamps 

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de kayon-ariel:
Acredito que isso ainda n√£o tenha sido implementado, pois ir√° gerar custos e aumentar a complexidade com storage de imagens.

Posso estar enganado mas pelo que vi, n√£o tem nenhuma funcionalidade que englobe o upload de imagens atualmente.
Teria que ser utilizado algo como S3 da AWS ou min.io.

>> Coment√°rio de ttdsgms:
Isso faz sentido e eu concordo, mas acho que tem como fazer isso mesmo sem um sistema/funcionalidade de upload de imagens e o storage de imagens. Trago ideias que acho que podem solucionar ou contornar esse problema e ainda um b√¥nus: lidando com placeholders.

Como esse texto que eu vou mandar tem muita coisa vou colocar em lista pra ficar mais f√°cil.

1. Gravatar (Minha recomenda√ß√£o final)
2. Conta Google (Uma outra abordagem)
3. Link de URL (Uma outra abordagem, mas que n√£o acho que seria a melhor ideia.)

### 1. Gravatar

Suponho que talvez voc√™s j√° conhe√ßam o Gravatar, que √© um servi√ßo amplamente utilizado para associar uma imagem de perfil a um e-mail. Ele permite que o usu√°rio configure uma foto associada ao seu endere√ßo de e-mail e, em seguida, essa foto seja automaticamente carregada sempre que o e-mail for usado em diferentes sites que utilizam esse servi√ßo. Isso pode ser muito √∫til, j√° que √© uma solu√ß√£o que n√£o depende de armazenar as imagens diretamente no TabNews, mas sim de uma plataforma externa. O Gravatar j√° √© [amplamente adotado em diversas plataformas](https://gravatar.com) e muitos usu√°rios j√° possuem uma conta l√°, o que poderia facilitar a integra√ß√£o com o sistema do TabNews. Sites como o WordPress, Slack, OpenAI com o ChatGPT, Figma, Stack Overflow e at√© o pr√≥prio GitHub usam o Gravatar.

### 2. Conta Google

Al√©m disso, do Gravatar, uma outra abordagem seria usar a **integra√ß√£o com contas Google**. muitas vezes uma conta j√° possui uma foto de perfil associada. Isso pode ser uma boa alternativa, pois al√©m de facilitar o processo de login, a foto de perfil do Google geralmente √© sincronizada automaticamente em diversos servi√ßos que utilizam a plataforma. Com isso, seria poss√≠vel integrar facilmente a imagem de perfil do usu√°rio sem a necessidade de upload manual ou armazenamento adicional de imagens no sistema do TabNews.

### 3. Link de URL

Uma outra abordagem seria permitir que o usu√°rio insira diretamente um link de URL para a sua imagem de perfil. Isso poderia ser feito por meio de um simples campo de input onde o usu√°rio colaria a URL da imagem que deseja utilizar. Apesar de parecer uma solu√ß√£o simples e direta, eu n√£o considero essa a melhor alternativa por alguns motivos.

Primeiramente, existe uma quest√£o de **seguran√ßa**. Permitir URLs externas pode abrir brechas para **ataques de inje√ß√£o**, como o XSS, onde um atacante poderia inserir um link malicioso apontando para um conte√∫do prejudicial. Al√©m disso, **URLs externas podem n√£o ser confi√°veis**: uma imagem hospedada externamente pode ficar indispon√≠vel por diversos motivos (o servidor pode cair, a imagem ser removida, etc.), o que resultaria em um link quebrado, afetando a experi√™ncia do usu√°rio.

Outro problema com URLs externas √© o **controle de privacidade**. N√£o temos como garantir que o conte√∫do da URL fornecida seja adequado ou seguro. Ou seja, √© poss√≠vel que um usu√°rio insira uma imagem que contenha informa√ß√µes sens√≠veis ou inapropriadas, e isso pode gerar complica√ß√µes em rela√ß√£o √† modera√ß√£o de conte√∫do.

Por fim, **performance** tamb√©m pode ser um problema. Se o usu√°rio estiver usando imagens hospedadas em servidores lentos ou em plataformas que n√£o t√™m boa performance de entrega (como servidores de imagens pessoais ou hospedagem gratuita), isso pode impactar a velocidade de carregamento da p√°gina. Como as imagens estariam sendo carregadas de servidores externos, a lat√™ncia da rede pode ser um fator limitante.

Por esses motivos, apesar de ser uma solu√ß√£o simples, eu acredito que essa abordagem traz riscos consider√°veis em termos de seguran√ßa, confiabilidade e performance. √â sempre prefer√≠vel usar solu√ß√µes como Gravatar, contas de redes sociais ou at√© mesmo placeholders, que oferecem mais controle e consist√™ncia para a aplica√ß√£o.

### Ideia b√¥nus: Lidando com placeholders

E para os casos em que os usu√°rios n√£o optarem por adicionar uma foto de perfil, uma alternativa interessante pode ser o uso de **placeholders**. Em vez de for√ßar o upload de uma imagem, podemos recorrer a imagens padr√£o geradas automaticamente, que serviriam como substitutas para perfis sem foto.

Caso a ideia do Gravatar v√° pra frente, acaba que isso que eu vou falar a seguir pode ou n√£o ser descart√°vel porque o pr√≥prio Gravatar tamb√©m oferece um recurso de placeholder. Quando um usu√°rio n√£o configura uma imagem de perfil, o Gravatar exibe uma imagem padr√£o com as iniciais do nome do usu√°rio ou uma vers√£o gen√©rica, dependendo das configura√ß√µes. Esse tipo de fallback pode ser √∫til para garantir que sempre haja uma imagem vis√≠vel, sem precisar for√ßar um upload ou o uso de links externos.

Mas tamb√©m da pra colocar placeholders sem ser a do Gravatar o que traria mais customiza√ß√£o.

Existem v√°rias ferramentas que permitem criar placeholders, inclusive algumas que geram imagens no formato `SVG`. Uma das op√ß√µes mais conhecidas √© o [Via Placeholder](https://via.placeholder.com/128x128), que oferece uma maneira f√°cil de gerar imagens com dimens√µes espec√≠ficas. No entanto, essa ferramenta apresenta algumas limita√ß√µes. Por exemplo, ela n√£o oferece suporte para `SVG` e, al√©m disso, senti que tem apresentado um desempenho um pouco ruim nas √∫ltimas semanas, com lentid√£o nas requisi√ß√µes, o que pode afetar a experi√™ncia do usu√°rio.

Uma solu√ß√£o melhor, que eu recomendaria, √© o [Placehold.co](https://placehold.co). Ele √© muito mais flex√≠vel, oferecendo suporte a uma variedade de formatos, incluindo `SVG` e outros tipos de m√≠dia. O Placehold.co tamb√©m permite uma personaliza√ß√£o mais avan√ßada, como a altera√ß√£o das cores, fontes e at√© mesmo a adi√ß√£o de texto √† imagem, tudo por meio de par√¢metros na URL. Por exemplo, voc√™ pode gerar uma imagem de 128x128px com a inicial "T", com cores personalizadas, como neste exemplo: [Placehold.co Exemplo](https://placehold.co/128x128/00887a/ffffff?text=T). Isso proporciona um n√≠vel de customiza√ß√£o interessante para que o sistema gere imagens √∫nicas e adequadas ao estilo da plataforma.
</issue_1793_feat: Avatar para Usu√°rios>

<issue_1794_Bug no cadastro>
### Descri√ß√£o

Eu encontrei um bug que est√° me impedindo de criar uma conta, eu estava tentando criar uma conta utilizando o navegador safari no MacBook 
![Captura de Tela 2024-09-12 √†s 00 04 31](https://github.com/user-attachments/assets/5ceddf5c-e498-4d5e-8985-d83f168ce128)


### Passos para reproduzir o problema

1. Acesse o site pelo safari
2. Tente cadastrar

### Navegadores testados

Safari

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Fala @huddmax, tudo bem?

Pode nos confirmar se voc√™ j√° estava logado com outro usu√°rio quando tentou realizar o cadastro?

Se estiver com o cookie de sess√£o v√°lido, o sistema identifica qual √© o usu√°rio logado, e que ele n√£o tem a feature `create:user`.

---

Aproveitando...

Recomendamos fortemente que n√£o utilize mais de um usu√°rio, pois isso pode resultar em banimento por viola√ß√£o dos nossos [termos de uso](https://www.tabnews.com.br/termos-de-uso).

E se a inten√ß√£o era realizar algum teste, pe√ßo por favor que utilize a vers√£o de homologa√ß√£o do TabNews. No link abaixo voc√™ visualiza todas os √∫ltimos deploys em homologa√ß√£o. E normalmente algum dos primeiros da lista estar√£o dispon√≠veis para testes:

https://github.com/filipedeschamps/tabnews.com.br/deployments/Preview

>> Coment√°rio de Edson5-spec:
O meu est√° dando erro quando tento trocar o email 
O pograma diz que vai mandar um email de confirma√ß√£o mais o email nunca chega
</issue_1794_Bug no cadastro>

<issue_1795_"web.config" no conte√∫do da publica√ß√£o impedindo postagem>
### Descri√ß√£o

Ao tentar publicar um conte√∫do contendo o trecho: "web.config", recebo o seguinte erro: 

![image](https://github.com/user-attachments/assets/f7a6f033-ce12-4bdc-a393-07020f634683)

O erro persiste em navegadores como Safari (desktop e mobile), Chrome e Opera GX. 

Ao retirar o "." do trecho "web.config", deixando-o como "web config",  a publica√ß√£o √© feita normalmente. 

Ao utilizar um "teste.php", por exemplo, a submiss√£o do conte√∫do ocorre normalmente.

### Passos para reproduzir o problema

Adicionar o trecho "web.config" em alguma publica√ß√£o 

Segue exemplo:

![image](https://github.com/user-attachments/assets/b93e0ac5-10e5-4a59-9690-77f303d2ad26)



### Navegadores testados

Chrome, Safari, Outro

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@SrVinicius, obrigado por reportar! üí™

A prote√ß√£o da Cloudflare bloqueia certas sequ√™ncias de bytes, ent√£o a sa√≠da √© escrever diferente mesmo, como voc√™ fez, pois n√£o podemos abrir m√£o dessa prote√ß√£o.

Por isso, vou fechar a issue ü§ù
</issue_1795_"web.config" no conte√∫do da publica√ß√£o impedindo postagem>

<issue_1796_Guardar os posts que vc mais gosta>
### Descri√ß√£o

Eu acho que seria legal ter uma parte onde os usu√°rios do tabnews consigam guardar os posts que mais gostam pra poder aceder mais tarde sem ter que procurar. 

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de kaique-soares:
@Edson5-spec obrigado pela sugest√£o :muscle: 

- **Acho** que isso j√° est√° sendo discutido na issue #645 

O que acha de fechar essa issue aqui e concentrar a discuss√£o l√°?

>> Coment√°rio de Edson5-spec:
Sem problema
</issue_1796_Guardar os posts que vc mais gosta>

<issue_1797_Nao consigo criar um comentario: Requisi√ß√£o bloqueada pelo Firewall>
### Descri√ß√£o

Bom dia.

Estou tentando criar um comentario em resposta a um comentario no meu post 

https://www.tabnews.com.br/blmayer/pitch-estou-criando-uma-distro-linux-minimalista

porem recebo esse erro:

```
Requisi√ß√£o bloqueada pelo Firewall. Verifique seu equipamento e os dados enviados. Informe ao suporte o valor (cf-ray: 8c4974b89e0ea52b-GRU)
```

Poderiam me ajudar a entender?

Obrigado.

### Passos para reproduzir o problema

1. Crie algum conteudo.
2. espere alguem criar um comentario
3. tentar responder a esse comentario

### Navegadores testados

Outro

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
@blmayer a Cloudflare bloqueia alguns algumas sequ√™ncias de bytes espec√≠ficas com o objetivo de proteger o site. Veja um exemplo de problema similar aqui: https://github.com/filipedeschamps/tabnews.com.br/issues/1619

Para descobrir o ponto exato do problema, voc√™ pode tentar criar uma publica√ß√£o sem t√≠tulo com um trecho do seu coment√°rio. Se der erro de que precisa preencher o t√≠tulo, voc√™ sabe que aquela parte do coment√°rio est√° OK. Se der erro da Cloudflare, v√° diminuindo o texto at√© encontrar qual a parte problem√°tica.

No link acima, o problema era usar o `wget https://...` formatado numa √∫nica linha. Em outro caso mais recente (https://github.com/filipedeschamps/tabnews.com.br/issues/1795), o problema era o texto `web.config`.

>> Coment√°rio de blmayer:
Esse eh o texto que quero publicar:

```
Muito obrigado!

Eu me baseei na LFS (Linux From Scratch), que eh basicamente uma distro generica, tudo compilado. Mas simplifiquei muitas coisas, meio que indo pra mesma direcao da Alpine Linux, outra distro que adoro. Provavelmente fiz alguns erros que vou descobrir mais pra frente.

Algumas diferencas das demais distros, alem das indicadas acima:

- Nao usa initrd
- a pasta root fica em /home/root, como os demais usuarios
- nao uso a pasta /usr, tudo eh direto na /
- usa o /etc/passwd ao inves de /etc/shadow
- nao necessita de bootloaders nos sistemas com EFI

A ideia eh utilizar melhor as ferramentas ja existentes nos sistemas para torna-lo melhor, por ex. uma das coisas que quero fazer eh utilizar o /etc/issue e o /etc/login.defs para uma melhor experiencia de login. E por ai vai.

Vou mante-los informados.
```

>> Coment√°rio de aprendendofelipe:
@blmayer, pode tentar publicar novamente e nos retornar se deu certo?

>> Coment√°rio de blmayer:
Deu certo!

Obrigado senhores!
</issue_1797_Nao consigo criar um comentario: Requisi√ß√£o bloqueada pelo Firewall>

<issue_1799_Rendeiza√ß√£o da pr√© visualiza√ß√£o dos diagramas mermaid ao escrever um coment√°rio>
### Descri√ß√£o

Problema de rendeiza√ß√£o dos diagramas no momento de pr√© visualizar um coment√°rio com os diagramas mermaid.

![image](https://github.com/user-attachments/assets/e631fef6-c5f2-4ccc-86e8-50b4656cc6db)


https://github.com/user-attachments/assets/49530e1f-24b0-42f5-a6ad-3eb941c3806d




(Testado com chrome e firefox)



### Passos para reproduzir o problema

1. Inicie a escrita de um coment√°rio
2. Selecione a op√ß√£o "Timeline" ou outros diagramas.
3. Abra a previsualiza√ß√£o do coment√°rio ver√° que n√£o foi renderizado 
4. Abra uma nova aba no chrome (ou tire o foco do seu navegador clicando na barra de tarefas do windows)
5. Volte para a aba do tabnews do coment√°rio e tudo estar√° renderizado certo

### Navegadores testados

Chrome, Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@gabolera, obrigado por relatar! üí™

Executar os passos no [playground](https://bytemd.js.org/playground/) do ByteMD causa o exato mesmo problema, ent√£o vou fechar aqui e isso j√° vai criar um link pra c√° na #648
</issue_1799_Rendeiza√ß√£o da pr√© visualiza√ß√£o dos diagramas mermaid ao escrever um coment√°rio>

<issue_1800_N√£o consigo trocar o email da minha conta>
### Descri√ß√£o

Quando tento trocar o email da minha conta o tabnews diz que vai mandar um email de confirma√ß√£o mais o email nunca chega.


### Passos para reproduzir o problema

Eu fui no editar perfil e tentei mudar o email 
Tentei no telem√≥vel 

### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Descartando algum problema tempor√°rio com o servi√ßo de email (do nosso ou do seu lado), tamb√©m n√£o vai ser enviado nenhum email se voc√™ estiver tentando usar um endere√ßo que j√° est√° vinculado com outro usu√°rio do TabNews, seja conta ativa ou banida.

Por acaso voc√™ j√° possui conta criada com esse email que est√° tentando usar? Tentou [recuperar a senha](https://www.tabnews.com.br/cadastro/recuperar) da outra conta?

>> Coment√°rio de Edson5-spec:
N√£o tinha criado nenhuma conta com esse email 
Eu criei um email novo e queria trocar tudo para esse email mais o tabnews n√£o t√° mandado o email de confirma√ß√£o

>> Coment√°rio de aprendendofelipe:
@Edson5-spec, n√£o √© problema com o envio de email, mas sim por estar tentando cadastrar um endere√ßo j√° cadastrado. A mensagem s√≥ diz que o email ser√° enviado porque se dissesse que o endere√ßo est√° em uso seria uma brecha de seguran√ßa.

Se n√£o foi um usu√°rio banido, tenta recuperar a senha. Se foi banido, pode tentar tamb√©m, pois ir√° receber o email de recupera√ß√£o, mas n√£o vai conseguir acessar a conta.

Vou fechar a issue, pois o processo de altera√ß√£o do email est√° ocorrendo normalmente, com diversos casos recentes.

Se tiver alguma dificuldade espec√≠fica, envia email para `contato@tabnews.com.br`. ü§ù
</issue_1800_N√£o consigo trocar o email da minha conta>

<issue_1802_Problema na exibi√ß√£o do texto "Retornar ao topo" do bot√£o (ao passar o mouse sobre ele) quando a p√°gina n√£o chegou ao fim do seu conte√∫do.>
### Descri√ß√£o

Encontrei um problema na exibi√ß√£o do texto do bot√£o de retornar ao topo da p√°gina (apenas desktop).

O texto √© exibido acima do bot√£o somente quando a p√°gina ainda chegou ao final do seu conte√∫do!

# P√°gina que n√£o chegou ao final do seu conte√∫do

![image](https://github.com/user-attachments/assets/8191660d-27cb-4aff-bf3a-6be11d28bd44)

# P√°gina que chegou ao final do seu conte√∫do

![image](https://github.com/user-attachments/assets/86ee5608-9b0c-401d-a587-a6b81a5abc05)


### Passos para reproduzir o problema

Em qualquer post (estando logado ou n√£o) fa√ßa o teste da visualiza√ß√£o do texto passando o mouse sobre ele nas 2 situa√ß√µes mencionadas acima (p√°gina no meio do seu conte√∫do e p√°gina no final do seu conte√∫do).

### Navegadores testados

Chrome, Microsoft Edge

### Poss√≠vel solu√ß√£o

O que poderia ser feito √© exibir o texto sempre no topo do bot√£o, como j√° √© feito no momento de quando a p√°gina j√° se encontra no final do seu conte√∫do.

>> Coment√°rio de emerson-oliveira:
@aprendendofelipe , @Rafatcb .Para corrigir esse item, imagine fazer a nivel de componente, mas me surgiu uma d√∫vida, onde ficar o  `@tabnews/ui` √© um repositorio novo ?

>> Coment√°rio de Rafatcb:
@emerson-oliveira √© sim, est√° neste reposit√≥rio: https://github.com/aprendendofelipe/tabnews/.

Acho que para corrigir este bug n√£o precisa mexer no outro reposit√≥rio. Pensei em indicar para este `Tooltip` renderizar sempre para o norte `tooltipDirection="n"`, mas n√£o testei. [Documenta√ß√£o do `IconButton`](https://primer.style/components/icon-button/react/alpha)

>> Coment√°rio de emerson-oliveira:
> @emerson-oliveira √© sim, est√° neste reposit√≥rio: https://github.com/aprendendofelipe/tabnews/.
> 
> Acho que para corrigir este bug n√£o precisa mexer no outro reposit√≥rio. Pensei em indicar para este `Tooltip` renderizar sempre para o norte `tooltipDirection="n"`, mas n√£o testei. [Documenta√ß√£o do `IconButton`](https://primer.style/components/icon-button/react/alpha)

√ìtimo! Vou testar e qualquer novidade aviso no chat
</issue_1802_Problema na exibi√ß√£o do texto "Retornar ao topo" do bot√£o (ao passar o mouse sobre ele) quando a p√°gina n√£o chegou ao fim do seu conte√∫do.>

<issue_1803_Usar Umami para An√°lises de Postagens>
### Descri√ß√£o

### Ol√°, pessoal!

Seria legal usar [API do Umami](https://umami.is/docs/api) para analisar as postagens dos usu√°rios? Views de um t√≥pico etc... o bom √© que n√£o precisa informar um banner de cookies.

>> Coment√°rio de kayon-ariel:
Mostrar um contador de visualiza√ß√µes nos posts seria realmente muuuito √∫til.

>> Coment√°rio de mthmcalixto:
> Mostrar um contador de visualiza√ß√µes nos posts seria realmente muuuito √∫til.

Acredito que seja poss√≠vel fazer j√° que o Umami cobra apenas por eventos, s√£o cliques em locais do site, ele n√£o cobra pela quantidade de views em uma p√°gina.

>> Coment√°rio de mthmcalixto:
Aqui um exemplo de uso:

![image](https://github.com/user-attachments/assets/05d862f0-2b7a-4460-ac16-195f09e03530)

>> Coment√°rio de mthmcalixto:
@Rafatcb Exemplo de chamada:

https://api.umami.is/v1/websites/id-website/metrics

Passando Params:
```
startAt: "timestamp"
endAt: "timestamp"
type: "url"
url: "/post/bla-bla"
```

Retorno:

```
[
  {
    "x": "/post/bla-bla",
    "y": 215
  }
]
```

Pricing; https://umami.is/pricing

>> Coment√°rio de aprendendofelipe:
@mthmcalixto, obrigado pela sugest√£o!

Vou fechar aqui para que o debate se concentrar na #1115 ü§ù
</issue_1803_Usar Umami para An√°lises de Postagens>

<issue_1804_Adicionar uma nova p√°gina para postagens  "Pitch">
### Descri√ß√£o

A ideia seria criar algo exclusivo para postagens "Pitch", remover elas do "relevantes e recentes" e deixar apenas em "Pitch".

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
Vi algumas pessoas reclamando que tem muitos `Pitch`s, e que gostariam de ver menos. A implementa√ß√£o de um conte√∫do `Pitch` j√° est√° meio encaminhada no c√≥digo/banco, mas criar uma aba n√£o ir√° resolver as reclama√ß√µes que citei. O mesmo vale para as reclama√ß√µes sobre a quantidade de publica√ß√µes da `NewsletterOficial`. Digo isso porque todas publica√ß√µes continuariam aparecendo em `Recentes` (`Publica√ß√µes` e `Todos`).

N√£o sei se essa foi a motiva√ß√£o para sua sugest√£o, mas acho importante ter isso em mente para quando desenvolvermos uma implementa√ß√£o.

Um filtro seria bom, e tem v√°rias sugest√µes que parecem demandar isso. Hoje, as listas de conte√∫do s√£o est√°ticas.

>> Coment√°rio de mthmcalixto:
> Vi algumas pessoas reclamando que tem muitos `Pitch`s, e que gostariam de ver menos. A implementa√ß√£o de um conte√∫do `Pitch` j√° est√° meio encaminhada no c√≥digo/banco, mas criar uma aba n√£o ir√° resolver as reclama√ß√µes que citei. O mesmo vale para as reclama√ß√µes sobre a quantidade de publica√ß√µes da `NewsletterOficial`. Digo isso porque todas publica√ß√µes continuariam aparecendo em `Recentes` (`Publica√ß√µes` e `Todos`).
> 
> N√£o sei se essa foi a motiva√ß√£o para sua sugest√£o, mas acho importante ter isso em mente para quando desenvolvermos uma implementa√ß√£o.
> 
> Um filtro seria bom, e tem v√°rias sugest√µes que parecem demandar isso. Hoje, as listas de conte√∫do s√£o est√°ticas.

Exatamente, est√° muito pitch nos relevantes, mas a ideia seria criar uma aba mesmo e deixar apenas os tops l√°, eles v√£o aparecer em recentes normal, mas quando for subir pro topo, v√£o pra aba em vez de ir para relevantes.

Isso valeria para a Newsletter tamb√©m, deixe algo igual o tiktok e youtube:

Youtube:
![image](https://github.com/user-attachments/assets/9c149a51-52df-4253-af75-454bba390509)

Tiktok explorer:
![image](https://github.com/user-attachments/assets/77335ab1-f22a-48d8-b915-609e2b1d5565)

>> Coment√°rio de gpoleszuk:
Boa ideia! Desta forma separa o que s√£o _yellow pages_ e o que √© conte√∫do relevante.

A ideia de criar uma nova aba por hora n√£o parece ser um problema, mas no futuro ter aba para diferentes t√≥picos que v√£o surgir, ir√° carregar a _interface_. N√£o sei se √© poss√≠vel trabalhar com _tags_ (palavras chaves) definidas para cada postagem pelo pr√≥prio criador. Com isso, elas ajudariam a filtrar as publica√ß√µes de um momento em diante. Posso at√© atualizar as publica√ß√µes que j√° fiz usando a nova interface de cria√ß√£o (prevista).

Sou apenas um usu√°rio do Tabnews e n√£o imagino quanto trabalho os desenvolvedores t√™m para implementar essas diferentes ideias que aparecem. Desta forma, deixo meus parab√©ns por disponibilizarem este espa√ßo para pelo menos avaliarem se s√£o fact√≠veis; boas, mas podem aguardar ou mesmo desnecess√°rias ou imposs√≠veis :).

>> Coment√°rio de thonycsdev:
Ando companhando o site desde o lan√ßamento e tem sido algo que me incomoda tamb√©m. Vi alguns posts que parecem vendas de SaaS para gerar um p√∫blico, n√£o concordo com esse tipo de conte√∫do fora da aba de AD. 

Minha sugest√£o pessoal seria uma aba para buscar contribuidores open-source onde o usu√°rio faz seu pitch sobre uma ideia. A comunidade do TabNews/Open-Source podem contribuir com a ideia, podendo gerar at√© melhores resultados do que foi inicialmente previsto.

>> Coment√°rio de ItaloSa:
Acho muito improv√°vel algo desse tipo entrar. A ideia √© que o Tabnews siga mais ou menos o que √© o Hacker News
</issue_1804_Adicionar uma nova p√°gina para postagens  "Pitch">

<issue_1806_Exibir contador de caracteres em tempo real no campo de postagem>
### Descri√ß√£o

Atualmente, o autor de uma postagem s√≥ consegue saber que ultrapassou o limite m√°ximo de caracteres ao tentar enviar a postagem. Isso pode causar frustra√ß√£o e tornar o processo de cria√ß√£o mais demorado, especialmente quando o autor precisa fazer ajustes no texto para respeitar o limite.

Adicionar um contador de caracteres vis√≠vel permitir√° que o autor acompanhe o progresso enquanto digita, garantindo que esteja dentro do limite estabelecido antes de tentar enviar.


### Sugest√£o de implementa√ß√£o

Implementar um contador de caracteres em tempo real no campo de postagem. Esse contador deve mostrar:

- **Quantidade m√°xima de caracteres permitidos:** exibir ao lado do campo de texto o limite total de caracteres aceitos.
- **Quantidade de caracteres digitados:** atualizar dinamicamente enquanto o usu√°rio digita, para que ele saiba quantos caracteres j√° utilizou.

>> Coment√°rio de guilhermeabell:
@aprendendofelipe  @Rafatcb  podemos estipular um limite de caracteres por pub?

>> Coment√°rio de Rafatcb:
@guilhermeabell N√£o sei se entendi sua pergunta. Hoje j√° existe um limite de 20 mil caracteres.

>> Coment√°rio de guilhermeabell:
@Rafatcb  Era exatamente isso que eu gostaria de saber. Assim eu consigo desenvolver o counter na textarea e trazer um comportamento de colorizacao vermelha quando chegar nesse valor.

>> Coment√°rio de guilhermeabell:
@Rafatcb  PR aberto #1813
</issue_1806_Exibir contador de caracteres em tempo real no campo de postagem>

<issue_1808_unknown flag: --env-file>
### Descri√ß√£o

Faz muito tempo que n√£o baixo o reposit√≥rio na minha maquina, fiz pelo meu fork depois pelo reposit√≥rio do Filipe ambos apresentaram o mesmo problema. **unknown flag: --env-file**

### Passos para reproduzir o problema

01 - git clone https://github.com/filipedeschamps/tabnews.com.br/
02 - cd tabnews.com.br/
03 - npm install
04 - npm run dev
![Captura de tela em 2024-10-29 23-47-02](https://github.com/user-attachments/assets/9f8b641e-f7f8-449a-8efa-dabcec743b5e)


### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Fala Rodrig√£o! Bom te ver de novo por aqui! üí™

Alguma chance de estar usando alguma vers√£o antiga do Docker que ainda n√£o aceitava `--env-file`?

Ser√° que precisamos atualizar os requisitos de vers√£o do Docker no README?

>> Coment√°rio de rodrigoKulb:
Grande @aprendendofelipe! Saudades! 

Estou com essas vers√µes aqui:
![Captura de tela em 2024-10-30 11-08-38](https://github.com/user-attachments/assets/a4e0ded1-e505-4751-b0ce-4762768ee680)

Uma quest√£o que percebi √© que a chamada no docker-compose pelo menos aqui no Linux √© com - e n√£o espa√ßo. N√£o sei se com espa√ßo o docker inicia o compose de alguma forma. Mas alterando no package.json ele reconhece o --env-file mas da erro no './infra/docker-compose.development.yml'

![Captura de tela em 2024-10-30 11-12-04](https://github.com/user-attachments/assets/03b13264-9b6b-4df8-a605-3a48eac4b414)

>> Coment√°rio de aprendendofelipe:
> Uma quest√£o que percebi √© que a chamada no docker-compose pelo menos aqui no Linux √© com - e n√£o espa√ßo.

Se n√£o for apenas pela vers√£o antiga, ent√£o voc√™ pode estar no cen√°rio 3 do link abaixo, que n√£o √© mais recomendado, ent√£o sugiro tentar instalar o compose pelos m√©todos 1 ou 2 da documenta√ß√£o (Docker Desktop ou Compose plugin):

https://docs.docker.com/compose/install/

>> Coment√°rio de rodrigoKulb:
show realmente estava faltando o docker-compose-plugin s√£o coisas diferentes:

![Captura de tela em 2024-10-30 13-08-30](https://github.com/user-attachments/assets/fd6275e0-962b-49b2-beda-82dcfbf1dc77)

Acabei resolvendo utilizando essa parte:
https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository

>> Coment√°rio de rodrigoKulb:
finalizando a issue!
</issue_1808_unknown flag: --env-file>

<issue_1809_Salvar/Arquivar publica√ß√µes no estilo Medium>
### Descri√ß√£o

Acho que seria interessante ter uma feature para salvar os posts em algum tipo de pasta assim como o Medium faz. Senti essa necessidade ao encontrar posts muito interessantes e sentir um _medo_ de n√£o lembrar o t√≠tulo do post e n√£o conseguir ach√°-lo novamente.

Sei que √© poss√≠vel achar posts j√° visitados pela pag de coment√°rios publicados, mas sinto que o ideal seria ter algo focado nessa feature.

### Sugest√£o de implementa√ß√£o

## Exemplo - Medium

Segue exemplo de publica√ß√µes salvas/arquivadas no Medium

![image](https://github.com/user-attachments/assets/518d0243-b72c-43d1-b59e-aaf393043099)

>> Coment√°rio de Rafatcb:
@Alan-Graton obrigado pela sugest√£o! J√° temos um issue sobre isso (https://github.com/filipedeschamps/tabnews.com.br/issues/645), ent√£o vou fechar este. Recomendo ler a discuss√£o que ocorreu nos coment√°rios e complementar algo, caso queira.

>> Coment√°rio de Alan-Graton:
@Rafatcb Opa, de boa ^-^ Tinha verificado se j√° havia alguma solicita√ß√£o parecida com a minha, mas acho que n√£o vi a issue #645. Valeuu!
</issue_1809_Salvar/Arquivar publica√ß√µes no estilo Medium>

<issue_1811_FEAT Lista de usu√°rios bloqueados>
### Descri√ß√£o

Acho interessante adicionar uma lista de bloqueio de usu√°rios para que um usu√°rio possa n√£o ver as publica√ß√µes dos usu√°rios que ele decidir bloquear.

Minha sugest√£o seria que ao acessar o perfil da pessoa voc√™ possa ter um bot√£o "bloquear".
No "meu perfil" poder gerenciar quem eu bloqueei e remover o bloqueio.

Isso afetaria a listagem de qualquer conte√∫do dos usu√°rios "bloqueados", por√©m eles poderiam ainda ser vis√≠veis caso eu abra uma publica√ß√£o e tenha coment√°rios desta pessoa bloqueada. A ideia √© bloquear apenas as listagens dos artigos e n√£o o que ocorre dentro do artigo.

Motiva√ß√µes:

1 - Percebo que tem gente criando muita postagem para seu auto-promover com assuntos que para mim s√£o irrelevantes
2 - Tem usu√°rios que postam programaticamente conte√∫do apenas para divulgar links e chamadas para sa√≠da do tabnews que n√£o agregam para o senso de comunidade e discuss√£o que o tabnews se prop√µe a ser

Sei que a curadoria de conte√∫do n√£o √© foco do projeto, mas isso daria a liberdade de que pelo menos eu possa filtrar o que para mim √© relevante e n√£o perca tempo com conte√∫do irrelevante.



### Sugest√£o de implementa√ß√£o

Criar tabela de usu√°rios bloqueados e filtrar nas listagens os autores que o usu√°rio bloqueou.

>> Coment√°rio de matheusrizzati:
Acho uma funcionalidade muito √∫til. Realmente tem alguns posts de usu√°rios espec√≠ficos que n√£o entregam muito valor e seria interessante essa op√ß√£o de poder bloquea-los

>> Coment√°rio de ttdsgms:
> Acho uma funcionalidade muito √∫til. Realmente tem alguns posts de usu√°rios espec√≠ficos que n√£o entregam muito valor e seria interessante essa op√ß√£o de poder bloquea-los

Faz sentido, mas pode ir al√©m. Posts que n√£o entregam valor nenhum poderia ter um bot√£o de n√£o relevante e que n√£o traz em nada para esse post poder descer ainda mais no ranking. Isso al√©m do downvote.

>> Coment√°rio de Muriyoku:
Uma funcionalidade interessante, mas acredito que teria que adicionar uma camada extra na hora de se registrar dentro do Tabnews. Uma vez que o usu√°rio notar que esta sendo bloqueado, ele ir√° criar outra conta em 2 minutos e come√ßa novamente a postar conte√∫do de pouca relev√¢ncia, gerando o mesmo problema ou at√© outro adjacente.

Como o Tabnews n√£o se limita, mas em grande maioria s√£o pessoas da √°rea de tecnologia, poderia exigir uma conta do Github, pois desmotivaria pessoas criando contas fakes e facilitaria esta implementa√ß√£o.

>> Coment√°rio de Rafatcb:
Pessoal, obrigado pela sugest√£o üí™ 

Vou fechar este issue para concentrar a discuss√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/1382, ok? Recomendo que leiam os coment√°rios l√° e adicionem seus pontos na discuss√£o ü§ù

Ressalto que a curadoria da comunidade √© importante, ent√£o se verem alguma publica√ß√£o que realmente n√£o seja relevante, que seja algo ruim, podem negativar. Se a motiva√ß√£o para ignorar a publica√ß√£o √© apenas porque ela fala sobre um assunto que n√£o te interessa, nesse caso **n√£o** faz sentido negativar.
</issue_1811_FEAT Lista de usu√°rios bloqueados>

<issue_1814_Favicon com fundo branco em rotas de api>
### Descri√ß√£o

Ao navegar pelo tabnews percebi que ao acessar rotas de api o favicon tem um fundo branco, diferente das rotas que nao sao de api.

![favicon](https://github.com/user-attachments/assets/b5ee1a84-afdc-4a08-ac02-a359fa78b67d)


### Passos para reproduzir o problema

Acessar qualquer rota de api.

### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

Acredito que a solu√ß√£o seja apenas adicionar um favicon sem fundo
</issue_1814_Favicon com fundo branco em rotas de api>

<issue_1815_Colocar o campo fonte como metatag canonical para informar aos motores de buscar qual √© o conte√∫do original>
### Descri√ß√£o

Notei que todo post a metatag canonical √© a propria url do post no tabnew.

Voc√™s podem adicionar um campo opcional para informar qual √© a canonical url ou usar o campo fonte como canonical url

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@feliperfranco, obrigado pela sugest√£o!

Vou fechar aqui para o debate se concentrar na issue relacionada #860
</issue_1815_Colocar o campo fonte como metatag canonical para informar aos motores de buscar qual √© o conte√∫do original>

<issue_1816_Problemas de caracteres | Editor Markdown>
### Descri√ß√£o

Problema de caracteres ao escrever em makdown em editor do Tabnews.

![bug2](https://github.com/user-attachments/assets/de714e05-6149-49bc-a613-146ff6b124c7)

### Passos para reproduzir o problema

![bug1](https://github.com/user-attachments/assets/29fe1f52-78af-4329-921c-303d5a820ccd)

Digitar no editor de texto no Tabnews: `$ test $` ou `$ test \$`.

### Navegadores testados

Chrome

>> Coment√°rio de aprendendofelipe:
Fala @Jetrom17, n√£o sei se entendi qual √© o bug, pois parece estar tudo de acordo com o esperado.

Lembrando que o cifr√£o (`$`) √© o [caractere usado para escrever f√≥rmulas matem√°ticas](https://github.com/micromark/micromark-extension-math#syntax), ent√£o se precisar adicionar dois deles no seu texto, √© preciso usar o `&#36;` em pelo menos um deles, caso contr√°rio tudo que estiver no meio deles ser√° considerado uma equa√ß√£o.

Exemplos:

```
$ matematica = a + bx $
$ erro de sintaxe \ $
&#36; n√£o cria equa√ß√£o matem√°tica &#36;
$ tamb√©m n√£o cria equa√ß√£o matem√°tica &#36;
```

Resulta em:

![image](https://github.com/user-attachments/assets/2142d736-fd92-4575-8659-108a15fae22f)

__Edit.:__ Tamb√©m d√° para usar `\$`, mas nesse caso n√£o pode existir um `$` anterior no texto.

>> Coment√°rio de Jeiel0rbit:
> Fala @Jetrom17, n√£o sei se entendi qual √© o bug, pois parece estar tudo de acordo com o esperado.

@aprendendofelipe obrigado pelo retorno.

![Screenshot_20241112-133238.png](https://github.com/user-attachments/assets/dafa52ec-24fd-4be9-8555-70fbf4b0d453)

Imagem aparece um texto que irei publicar futuramente, mas o editor detecta como c√°lculo matem√°tico, segundo voc√™. Algo que quero que apare√ßa como texto literal.

>> Coment√°rio de aprendendofelipe:
√â preciso respeitar a sintaxe do nosso editor, que usa `$` para defini√ß√£o de f√≥rmulas matem√°ticas.

Imagino que o que voc√™ pretende escrever seja como abaixo:

```
...ambiente &#36;HOME representa...
...como `cd $HOME`
```

ou


```
...ambiente \$HOME representa...
...como `cd $HOME`
```

e ambos resultam em

![image](https://github.com/user-attachments/assets/a88f0896-c748-447e-bb37-c037d8e46cc5)


Como n√£o √© um bug, mas apenas uma caracter√≠stica do nosso editor/visualizador de markdown, estou fechando a issue ü§ù
</issue_1816_Problemas de caracteres | Editor Markdown>

<issue_1818_Alterar limite de 20000 caracteres ao publicar um conte√∫do>
### Descri√ß√£o

Recentemente tomei coragem e resolvi escrever minha primeira publica√ß√£o na plataforma e dei de cara com:

```json
{
    "name": "ValidationError",
    "message": "\"body\" deve conter no m√°ximo 20000 caracteres.",
    "action": "Ajuste os dados enviados e tente novamente.",
    "status_code": 400,
    "error_id": "df7a4bcc-d68f-4767-a51c-af30ca850e95",
    "request_id": "b5f84fdf-d646-4c11-be30-81b5bcdd1582",
    "error_location_code": "MODEL:VALIDATOR:FINAL_SCHEMA",
    "key": "body",
    "type": "string.max"
}
```

Esse √© o conte√∫do que gostaria de ter publicado: https://github.com/iamseki/postgresql/blob/main/work_mem/tabnews.md e possui  33515 caracteres, cerca de 33kB.

IMHO dependendo do qu√£o profundo o autor quiser ir no conte√∫do, 20k como hard limit me parece baixo. Minha sugest√£o pragm√°tica seria subir esse valor, talvez dobrar para 40k?

E ficou a d√∫vida, existe algum motivo especial pro valor ser 20k? Ter mais previsibilidade em termos de aloca√ß√£o de storage? Defesa contra algum usu√°rio mal intencionado flodar com um texto na casa dos GB?

### Sugest√£o de implementa√ß√£o

Imagino que a abordagem simples seria subir esse valor [aqui](https://github.com/filipedeschamps/tabnews.com.br/blob/c747083cea3380c538dcf570e256a16693da3a96/infra/migrations/1649621949432_create-content-table.js#L33-L37) e [aqui](https://github.com/filipedeschamps/tabnews.com.br/blob/c747083cea3380c538dcf570e256a16693da3a96/models/validator.js#L249), lmk se eu estiver errado.

Outra possibilidade seria aplicar algum algoritmo de compress√£o como Brotli, aqui tem um [benchmark](https://www.ghusse.com/redis/node/compress/does-it-worth-compressing-large-json-in-redis/#brotli-compression) comparando com outros algoritmos, mas tamb√©m tem seus tradeoffs e n√£o sei dizer se vale a pena mas fica aqui a provoca√ß√£o.

>> Coment√°rio de aprendendofelipe:
@iamseki, a escolha do limite de 20 mil caracteres foi definida [nesta discuss√£o](https://github.com/filipedeschamps/tabnews.com.br/pull/262/files#r851394172) e tem se mostrado adequada para o prop√≥sito do TabNews.

√â verdade que certos conte√∫dos podem n√£o caber nesse limite, mas remover completamente qualquer restri√ß√£o n√£o seria uma solu√ß√£o vi√°vel e nem interessante. Esse limite tem sido importante para manter a experi√™ncia do usu√°rio consistente, tanto na cria√ß√£o quanto na leitura dos conte√∫dos.

O limite atual incentiva os autores a organizarem e priorizarem suas ideias, garantindo que as publica√ß√µes sejam focadas no que realmente importa. Para conte√∫dos mais extensos ou com diferentes perspectivas, h√° sempre a possibilidade de dividi-los em m√∫ltiplas publica√ß√µes, o que tamb√©m pode aumentar o engajamento dos leitores.

Al√©m disso, o limite desafia os autores a utilizarem recursos do Markdown de maneira eficiente, como usar tabelas para organizar dados em vez de inserir sequ√™ncias de caracteres (espa√ßos, pontos etc.) para formata√ß√£o.

Manter o limite de 20 mil caracteres me parece adequado para um bom equil√≠brio entre flexibilidade para o autor e uma experi√™ncia clara e acess√≠vel para os leitores.

Faz sentido?

>> Coment√°rio de Rafatcb:
@iamseki j√° enfrentei essa barreira dos 20 mil caracteres algumas vezes. Artigos muito longos s√£o menos lidos, porque demandam mais tempo do leitor. O seu n√£o parece longo, mas tem muito c√≥digo com 4 espa√ßos de identa√ß√£o, e o c√≥digo causa um aumento significativo na contagem de caracteres (j√° passei por isso tamb√©m).

Acho que se voc√™ mudar os 4 espa√ßos para 2, e substituir o query plan por uma imagem do planejamento com um link para um gist (ou outro lugar que considere adequado) com todos os detalhes, j√° conseguir√° ter menos de 20 mil caracteres. Vi que voc√™ cita um site que faz isso e colocou uma print dele, ent√£o seria s√≥ uma quest√£o de adaptar essa parte.

>> Coment√°rio de iamseki:
@aprendendofelipe Obrigado por compartilhar a discuss√£o e @Rafatcb Obrigado pelas dicas! 

Se entendi bem a [discuss√£o](https://github.com/filipedeschamps/tabnews.com.br/pull/262/files#r851394172), a limita√ß√£o do PostgreSQL para tipos `TEXT` √© em termos de storage e n√£o caracteres, [cerca de 1 GB](https://www.postgresql.org/docs/current/datatype-character.html#DATATYPE-CHARACTER), d√° pra testar com:
 
```sql
CREATE TABLE blog_posts (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    content text NOT null
);

INSERT INTO blog_posts (title, content)
VALUES (
    'Sample Blog Post',
    repeat('A', 1024 * 1024)
    -- repeat('A', 1024 * 1024 * 512) || repeat('B', 1024 * 1024 * 512) -- ESTRESSA CEN√ÅRIO COM O LIMITE DE 1 GB
);

SELECT 
	title, 
	pg_size_pretty(pg_column_size(content)::bigint), 
	char_length(content),
	length(content)
FROM blog_posts
WHERE id = 1;

---
id|title           |pg_size_pretty|char_length|length |
--+----------------+--------------+-----------+-------+
 1|Sample Blog Post|12 kB         |    1048576|1048576|
```

Aparentemente 1kk de caracteres foi armazenado tranquilamente, entendo que remover a restri√ß√£o √© uma m√° ideia e que o limite estimula a cria√ß√£o de publica√ß√µes menores, mas ainda acho esse valor conservador e que o ponto do engajamento e tempo de leitura √© muito subjetivo, eu particulamente adoro ler posts grandes e auto-contidos, tamb√©m acho pouco ergon√¥mico ter que escrever o conte√∫do e lembrar de identar com 2 espa√ßos em vez de 4 pra n√£o correr o risco de bater no limite. Eu vou ajustar o post pra se adequar ao limite de 20k anw, caso publica√ß√µes mais densas e profundas se torne relevante para plataforma num futuro plz reabram essa discuss√£o :smile:
</issue_1818_Alterar limite de 20000 caracteres ao publicar um conte√∫do>

<issue_1820_crases podem acabar bloqueando postagens>
### Descri√ß√£o

o bug relatado em #1619, ainda persiste. onde depnedendo do caso <kbd>`</kbd> pode te impedir de fazer postagem, no caso eu tive que remover  completamente c√≥digos de linha simples e trocar por negrito, mesmo com esp√ßaos a direita n√£o resolveu.

### Passos para reproduzir o problema

escreva um texto com exemplos de  <kbd>`</kbd>  ou links dentro de <kbd><></kbd> que pode aparecer impedir a qualquer momento.

![image](https://github.com/user-attachments/assets/05fff6f2-eade-4acb-a62f-36debd1935d5)


### Navegadores testados

Firefox, Safari, Outro

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@RodrigoDornelles, n√£o √© um bug. Viu meu coment√°rio https://github.com/filipedeschamps/tabnews.com.br/issues/1619#issuecomment-1922404509 na issue que voc√™ citou?

Se tem algo na sua publica√ß√£o que a Cloudflare est√° bloqueando, voc√™ precisa remover, ou escrever de outra maneira que n√£o seja bloqueado.

Se tiver dificuldade para descobrir o que est√° sendo bloqueado, poste seu texto aqui pra turma lhe ajudar. ü§ù

>> Coment√°rio de RodrigoDornelles:
@aprendendofelipe 

eu descobri que era justamente acentos, bom eu nunca tive esse tipo de problema em meus sistemas que sempre usei cloudflare, talvez um tipo de pre-santiniza√ß√£o do lado do front para tentar resolver, na tentativa e erro consegui fazer a postagem, mas a mensagem n√£o √© nada amigavel, e pode levar algu√©m que levou tempo a escrever um artigo ou coment√°rio desistir da contribui√ß√£o.

>> Coment√°rio de aprendendofelipe:
Com certeza o problema n√£o era com os acentos, at√© porque sua publica√ß√£o est√° usando acentos normalmente.

Mas que bom que conseguiu publicar ap√≥s remover algum trecho com problema. üéâ

Fechando a aqui ü§ù
</issue_1820_crases podem acabar bloqueando postagens>

<issue_1821_usuario com 5 mil de cashcoins que apenas abusa da plataforma>
### Assunto

Outro

### D√∫vida

existe uma issue #877 sobre reporte de usuarios/postagens, bom, √© um recurso importante, e ao meu ver tem muito usu√°rio que n√£o deveria estar na plataforma, exemplo √© este usu√°rio, **ele apenas usa um google translate e cola no tabnews**, mesmo colocando como a fonte a postagem exatamente original. _(isso √© literalmente plagio)_ usu√°rios leigos sempre d√£o voto cima nesse tipo de postagem pois o autor n√£o especifica que √© uma tradu√ß√£o. isso deveria continuar sendo permetido? para mim √© uma brecha para pessoa poder postar anuncios facilmente sem esfor√ßo.


[![rafael tabnews plagio](https://github.com/user-attachments/assets/c0b79cee-aef7-4852-9665-0dbc127ba7b6)](https://www.tabnews.com.br/rafael/conteudos/1)

>> Coment√°rio de Rafatcb:
Rodrigo, den√∫ncias espec√≠ficas devem ser feitas pelo e-mail `contato@tabnews.com.br`.

Este usu√°rio sou eu e nenhuma publica√ß√£o √© produzida "apenas usando o Google Tradutor e colando no TabNews". Inclusive, sempre √© mencionado que o conte√∫do presente √© proveniente da fonte, √†s vezes com adi√ß√µes minhas no meio dele quando me sinto confort√°vel com o assunto, √†s vezes eu mudo a ordem do conte√∫do para fazer mais sentido, n√£o ficar t√£o longo etc. Se √© um conte√∫do mais simples e direto ao ponto, fa√ßo poucas modifica√ß√µes.

Acho que est√° claro quando o conte√∫do n√£o √© meu. Por exemplo, minhas tr√™s √∫ltimas publica√ß√µes:

> https://www.tabnews.com.br/rafael/coisas-que-voce-nao-deveria-usar-no-postgresql
> Na Wiki do PostgreSQL existe uma [lista de erros comuns](https://wiki.postgresql.org/wiki/Don't_Do_This) (...)
>
> (...) vale a pena ler o documento completo na fonte, visto que vou destacar apenas alguns t√≥picos aqui.

> https://www.tabnews.com.br/rafael/como-o-uber-atualizou-sua-infraestrutura-mysql-da-versao-5-7-para-8-0
> Alguns engenheiros do Uber compartilharam esse processo no blog da empresa, e eu resumi os principais pontos.

> https://www.tabnews.com.br/rafael/41-dicas-de-sql-para-desenvolvedores-solucoes-praticas-para-desafios-comuns
> Vou citar algumas dicas nesta publica√ß√£o, mas recomendo conferir a lista completa no [livro gratuito](https://sqlfordevs.com/ebooks/next-level) (em troca do seu e-mail) e explorar algumas dicas com mais detalhes no [site](https://sqlfordevs.com/tips).

Realmente n√£o ficou claro qual √© o problema aqui. De todo modo, vou fechar o issue por n√£o ser um assunto relacionado ao reposit√≥rio.
</issue_1821_usuario com 5 mil de cashcoins que apenas abusa da plataforma>

<issue_1823_O sistema de tabcoins esta injusto>
### Descri√ß√£o

Sauda√ß√µes,

Estou entrando em contato para tentar entender como seria poss√≠vel, deixar o sistema de avalia√ß√£o de publica√ß√µes menos injusto poss√≠veis. Porque aconteceu um cen√°rio muito estranho, onde uma pessoa interagiu com uma publica√ß√£o minha falando sobre uma suposta superioridade de tecnologia, e outra pessoa comprou esta ideia, que creio eu, dentro do entendimento que tive sobre o projeto n√£o √© o intuito, de criar guerras e guerras tecnol√≥gicas, mas crescer com as discuss√µes e de maneira civilizada entender o que pode ser melhorado ou n√£o. Estes ataques diretos, n√£o produziram um efeito negativo na minha consci√™ncia, mas acredito que n√£o seja algo saud√°vel de fomentar na comunidade.

### Sugest√£o de implementa√ß√£o

Com isto a minha sugest√£o atual √© melhorar o sistema de "karmico" e "darmico" da plataforma, caso isto que eu tenha passado, seja realmente algo que outras pessoas tenham passado e tenha criado algum tipo de impacto negativo, o que interfere no "karma" e caso tenha seguido uma boa linha da condu√ß√£o afeta o sistema "darmico" dela. Isso pode ser utilizado para criar um ranking relevantes de publica√ß√µes e at√© mesmo, servir como meio de frear comportamentos destrutivos e a gera√ß√£o de uma reputa√ß√£o ruim para o tabnews, coisa que transformaria ele em mais uma ferramenta, em que as pessoas fazem coisas n√£o s√£o considerados boas pr√°ticas, e continuam porque n√£o existe nenhum tipo de sistema para evitar isso.

>> Coment√°rio de horticonecta:
N√£o entendi como o sistema pode estar sendo injusto com voc√™, observando suas postagens no tabnews, o que est√° fazendo ser negativado √© publicar conte√∫dos curtos, rasos e que tentam levar o usu√°rio para fora da plataforma, essa n√£o √© uma pr√°tica bem vista na comunidade.  

Al√©m disso, vejo que postou a poucos minutos uma postagem na qual tenta vender uma promessa de dinheiro f√°cil. E a comunidade est√° corretamente negativando a postagem e assim diminuindo a relev√¢ncia dela.

>> Coment√°rio de ktfth:
Excelente, n√£o senti a mesma receptividade, nos coment√°rios da √∫ltima postagem que fiz na plataforma. Por isso a sugest√£o, porque realmente o coment√°rio que foi feito anteriormente me pareceu um pouco estranho e n√£o entendi porque estavam apoiando este tipo de pr√°tica, sem nenhum tipo de explica√ß√£o.

Com isto em mente, e com o que foi explicado, vou me orientar ao uso mais regrado da ferramenta e observar os resultados.
</issue_1823_O sistema de tabcoins esta injusto>

<issue_1824_N√£o est√° ocorrendo o feedback de postagem lida>
### Descri√ß√£o

Gravei um v√≠deo demonstrando o erro, mas basicamente ao clicar, ler ou interagir com uma publica√ß√£o, ao retornar para a aba de recentes ou relevantes, n√£o est√° ocorrendo o feedback de conte√∫do lido. 

https://github.com/user-attachments/assets/917e198c-8dce-4642-bec2-2b3dea75aaa1



### Passos para reproduzir o problema

1 - Acesse o TabNews.
2 - Clique em uma postagem.
3 - Interaja com ela ou n√£o.
4 - Retorne para a aba correspondente a postagem, relevantes ou recentes. 

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de tintinthedev:
Opa. N√£o sei o que rolou a√≠, mas segui os passos aqui e t√° funcionando como deveria, o texto das postagem que acesso fica "cinzento", indicando que j√° as acessei. Talvez tenham resolvido o bug antes mesmo de ver a issue.

>> Coment√°rio de horticonecta:
Hoje abri o tabnews e o erro n√£o ocorreu, provavelmente foi um erro moment√¢neo mesmo.
</issue_1824_N√£o est√° ocorrendo o feedback de postagem lida>

<issue_1825_Sistema de reconhecimento de conquistas e contribui√ß√µes (BADGE)>
### Descri√ß√£o

Fala, turma!

Sou aluno do curso.dev e pensei numa ideia pra alimentar ainda mais esse esp√≠rito `Open source` da comunidade: criar um sistema de reconhecimento pelas conquistas e contribui√ß√µes dos participantes aqui do projeto. A ideia √© "recompensar" com `badges` pra quem realiza a√ß√µes importantes e, assim, incentivar mais pessoas a contribu√≠rem e se envolverem com o projeto.

## Funcionalidades:

1. Badges
  - Quando atingirem certos marcos, os usu√°rios ganhar√£o badges para destacar suas conquistas.
  Pensei em alguns exemplos
   - Badge Iniciante: Primeiro pull request aprovado.
   - Badge de Colaborador ativo: Ac√∫mulo de XX pontos.
   - Badge de Revisor Ouro: 20 pull requests revisados.
   - D√° pra pensar em outras conquistas...

2. Quadro de conquistas:
- O usu√°rio consegue acompanhar seu progresso e ver os badges conquistados.

## Funcionalidades:

- Incentivar o engajamento da comunidade
- Tornar a colabora√ß√£o no projeto mais divertida e recompensadora (ainda mais)
- Valorizar quem se dedica ao projeto.

Fica essa ideia pra gente discutir!! üöÄ

### Sugest√£o de implementa√ß√£o

_No response_
</issue_1825_Sistema de reconhecimento de conquistas e contribui√ß√µes (BADGE)>

<issue_1833_Possivel inconsistencia no cadastro de usu√°rio>
### Assunto

Outro

### D√∫vida

Hoje, fui me cadastrar no TabNews, pois n√£o lembrava se j√° havia realizado cadastro anteriormente ou n√£o, ent√£o fiz o processo como deve ser feito, inseri user name, email e senha existentes e v√°lidos. E nenhuma mesagem de aviso quanto ao cadastro j√° existir foi apresentada, apenas fui redirecionado para a tela dizendo que o cadastro deu bom, e a seguinte mensagem: "Caso o e-mail esteja dispon√≠vel, voc√™ receber√° um link para confirmar seu cadastro e ativar a sua conta."

Mas pensando do ponto de vista do usu√°rio, creio eu que seria melhor a identifica√ß√£o de que este email J√Å est√° cadastrado, neste exemplo, e o avisando disso, pois para mim por exemplo, at√© que eu me lembrasse de que eu no passado j√° poderia ter me cadstrado, me tomou um tempinho procurando um email de confirma√ß√£o, que n√£o chegou :(

Enfim ... abro isso para discuss√£o n√£o √© um bug, mas achei meio estranho n√£o fazer como geralmente √© feito de identificar o e-mail cadastrado e exibir uma mensagem de aviso por exemplo.

![print tela de confirmacao cadastro tabnews](https://github.com/user-attachments/assets/eed02de9-7153-47f5-9b6b-fa907a358861)

>> Coment√°rio de aprendendofelipe:
Fala @FelipeIgansi,

N√≥s n√£o podemos deixar p√∫blica a informa√ß√£o de que um email j√° est√° ou n√£o cadastrado. Apenas o dono do endere√ßo de email pode saber isso. Por isso o aviso:

> "__Caso o e-mail esteja dispon√≠vel__, voc√™ receber√° um link para confirmar seu cadastro e ativar a sua conta."

O endere√ßo pode j√° estar em uso, ou pode estar vinculado com usu√°rios exclu√≠dos/banidos, e nesses casos nenhum email deve ser enviado.
</issue_1833_Possivel inconsistencia no cadastro de usu√°rio>

<issue_1840_Sugest√µes de Altera√ß√µes Gramaticais: Termos de Uso>
### Assunto

Outro

### D√∫vida

Esta issue de d√∫vida n√£o √© uma d√∫vida sobre c√≥digo ou funcionalidade, mas algo como um espa√ßo para discutir a viabilidade do que tenho a propor, algumas altera√ß√µes nos Termos de Uso; nada relacionado √†s permiss√µes ou atribui√ß√µes, mas com a escrita dele. Desde j√° pe√ßo perd√£o se tudo isso soar como chateza da minha parte.

## Altera√ß√µes

### Tabnews

* Item 3: "Iremos dar prefer√™ncia a qualidade do que quantidade e neste ponto em espec√≠fico [...]" -> "Daremos prefer√™ncia √† qualidade sobre quantidade; neste ponto, especificamente, [...]"
* Item 3: "[...] tudo que voc√™ ler dentro do Tabnews ter√° valido a pena, de uma forma ou outra" -> "[...] tudo o que voc√™ ler dentro do Tabnews ter√° valor agregado de alguma forma"
* Item 4: "[...] **nunca ir√°** aplicar [...]" -> "[...] **nunca** aplicar√° [...]" ou "[...] **nunca aplicar√°** [...]"
* Item 4: "[...] ir√° **sempre proteger o usu√°rio** [...]" -> "[...] **sempre proteger√° o usu√°rio** [...]"
* Item 5: "[...] **nunca ir√° vender** [...]" -> "[...] **nunca vender√°** [...]"
* Item 5: "[...] **nunca ir√° compartilhar** [...]" -> "[...] **nunca compartilhar√°** [...]"
* Item 6: "[...] somente ir√° coletar dados [...]" -> "[...] somente coletar√° dados [...]"
* Item 6: "[...] neste ponto √© de quanto menos [...]" -> "[...] neste ponto √©: quanto menos [...]"
* Item 6: "[...] nossa base, logo melhor estaremos [...]" -> "[...] nossa base, logo, melhor estaremos [...]"

### Usu√°rio

* Item 3: "[...] manipular ou movimentar de forma artificial a qualifica√ß√£o das publica√ß√µes [...]" -> seria interessante em algum lugar do termo definir de forma objetiva o que se entende por manipular ou movimentar de forma artificial essa qualifica√ß√£o
* Item 4: "[...] est√° **estritamente proibido** atos [...]" -> "[...] est√£o **estritamente proibidos** atos [...]"
* Item 5: "[...] com foco **exclusivo** comercial [...]" -> "[...] com foco **exclusivamente** comercial [...]"
* Item 6: "[...] que iremos proteger ao m√°ximo [...]" -> "[...] que protegeremos ao m√°ximo [...]"
* Item 6: "[...] n√£o possuem informa√ß√µes [...]" -> "[...] n√£o possuam informa√ß√µes [...]"
* Item 6: "[...] n√£o ir√£o prejudicar outros [...]" -> "[...] n√£o prejudicar√£o outros [...]"
* Item 6: "[...] ser livremente reportados [...]" -> "[...] ser livremente reportadas [...]" - concord√¢ncia com "falhas" e n√£o com "usu√°rios"

### Direitos autorais e propriedade intelectual

* Item 1: "O usu√°rio possui os direitos autorais e se responsabiliza pelos conte√∫dos que publicou na plataforma, incluindo declara possuir os direitos de uso [...]" - frase apresenta ambiguidade quanto ao trecho "incluindo declara possuir"; sugiro algo como "O usu√°rio possui os direitos autorais sobre os conte√∫dos que publicou na plataforma e se responsabiliza integralmente por eles, incluindo a declara√ß√£o de que possui os direitos de uso [...]"
* Item 2: "A marca `TabNews`, junto com o servi√ßo e o dom√≠nio `tabnews.com.br` s√£o propriedades intelectuais de uma empresa que temos localizada no Canad√° chamada `Filipe Deschamps Tech Inc.`." -> "A marca `TabNews`, junto ao servi√ßo e o dom√≠nio `tabnews.com.br` s√£o propriedades intelectuais pertencentes √† `Filipe Deschamps Tech Inc.`, uma empresa localizada no Canad√°."

H√° ainda outras quest√µes como a escrita do termo se assemelhar √† uma reda√ß√£o por se tratar de um documento, n√£o devendo conter a pessoa - seja em primeira "eu, meu" ou n√≥s, nosso" - como por vezes ocorre, contudo, entendo que deve haver um equil√≠brio entre formalidade e facilidade, como o pr√≥prio termo descreve em alguns trechos.

Com tudo isso em mente foi que decidi abrir esta issue, a fim de discutir as poss√≠veis altera√ß√µes. Mais uma vez desculpe se tudo isso parecer apenas um mano sendo chato, mas fiquem √† vontade para comentar se s√£o mudan√ßas v√°lidas ou n√£o h√° necessidade de mudan√ßas. Agrade√ßo o tempo para revisar essa pedrada.

>> Coment√°rio de pedronora:
Eu acredito que s√£o v√°lidas as sugest√µes de aprimoramento do texto do "Termos de uso", sobretudo por se tratar de um documento com conte√∫do jur√≠dico.

N√£o tenho reparos, no momento, √†s sugest√µes de altera√ß√£o propostas pelo @LucasGoncSilva .
</issue_1840_Sugest√µes de Altera√ß√µes Gramaticais: Termos de Uso>

<issue_1841_Dialog de busca quebrado ao clicar rapidamente na barra de busca>
### Descri√ß√£o

Encontrei um problema na barra de busca. Quando clico uma vez na barra de busca, saio dela e clico novamente rapidamente, um di√°logo de busca aparece de forma quebrada e n√£o √© renderizado corretamente.

O resultado foi esse:

![Image](https://github.com/user-attachments/assets/d1fe8090-11da-4f2b-b73e-c1c2fb8eccc0)
![Image](https://github.com/user-attachments/assets/8d57d6c6-5d3f-424a-a252-e68c0f79dfbd)

### Passos para reproduzir o problema

1.  Acesse a p√°gina inicial (logado ou n√£o).
2. Clique uma vez na barra de busca.
3. Saia da barra de busca clicando fora dela.
4. Clique novamente rapidamente na barra de busca.
5. Observe que o di√°logo de busca aparece quebrado.

### Navegadores testados

Brave, Chrome, Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de mthmcalixto:
Isso √†s vezes acontece devido ao uso de um adblocker ou porque o script n√£o foi carregado corretamente.

>> Coment√°rio de gabriel-cmps:
> Isso √†s vezes acontece devido ao uso de um adblocker ou porque o script n√£o foi carregado corretamente.

No Brave, de fato, realizei o teste com um adblocker ativado. No entanto, no Chrome e no Firefox, o teste foi feito sem nenhuma extens√£o que pudesse bloquear scripts.

>> Coment√°rio de tsilmak:
Esse bug √© super chato, quando tento pesquisar algo com o dark mode, quase n√£o d√° para entender nada.

![Image](https://github.com/user-attachments/assets/4b3f2aab-6493-4f7f-93a9-14cff87c365c)

>> Coment√°rio de aprendendofelipe:
Resolvido pelo @Caixetadev no #1870 üéâ

Se notarem que o problema ainda est√° presente, podemos reabrir a issue. ü§ù
</issue_1841_Dialog de busca quebrado ao clicar rapidamente na barra de busca>

<issue_1842_Login e Cadastro de usu√°rio usando a conta do GitHub e/ou LinkedIn>
### Descri√ß√£o

#### **Descri√ß√£o da funcionalidade**  
Adicionar a possibilidade de login e cadastro no TabNews utilizando contas de terceiros, como GitHub e LinkedIn. Essa funcionalidade permitiria que novos usu√°rios acessassem a plataforma de forma mais √°gil e segura, sem a necessidade de criar uma senha ou preencher formul√°rios manuais.

#### **Motiva√ß√£o**  
- **Facilidade de acesso:** Permitir que os usu√°rios entrem rapidamente com uma conta que j√° utilizam frequentemente.  
- **Seguran√ßa:** Reduzir o risco de vulnerabilidades relacionadas ao gerenciamento de senhas.  
- **Engajamento:** Usu√°rios do GitHub e LinkedIn s√£o potenciais criadores e consumidores de conte√∫do t√©cnico, alinhando-se ao p√∫blico-alvo do TabNews.  

#### **Benef√≠cios esperados**  
- Aumento da taxa de convers√£o de novos usu√°rios.  
- Melhor experi√™ncia de usu√°rio, eliminando a necessidade de criar um novo login/senha.  
- Integra√ß√£o com perfis j√° estabelecidos, aumentando a confian√ßa no uso da plataforma.

#### **Como poderia funcionar?**  
1. No formul√°rio de login/cadastro, adicionar bot√µes para "Entrar com GitHub" e "Entrar com LinkedIn".  
2. Utilizar **OAuth 2.0** para autenticar os usu√°rios e obter informa√ß√µes b√°sicas (nome, e-mail, avatar).  
3. Caso seja a primeira vez do usu√°rio, criar automaticamente uma conta no TabNews com base nos dados obtidos.  
4. Garantir a possibilidade de vincular ou desvincular essas contas nas configura√ß√µes do usu√°rio.  

#### **Refer√™ncias**  
- [[GitHub OAuth Documentation](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps)](https://docs.github.com/en/apps/oauth-apps/building-oauth-apps)  
- [[LinkedIn OAuth Documentation](https://learn.microsoft.com/en-us/linkedin/shared/authentication/)](https://learn.microsoft.com/en-us/linkedin/shared/authentication/)  

#### **Poss√≠veis desafios t√©cnicos**  
- Garantir que usu√°rios que j√° possuem conta no TabNews possam vincul√°-las √†s contas do GitHub/LinkedIn sem duplicidade.  
- Implementar boas pr√°ticas de seguran√ßa no fluxo OAuth, como uso de tokens de acesso e refresh tokens.  

#### **Agradecimentos**  
Agrade√ßo desde j√° por considerar essa sugest√£o! Acredito que a funcionalidade poderia ser um diferencial para atrair mais usu√°rios t√©cnicos para a comunidade.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
@castrogusttavo obrigado pela sugest√£o üí™ 

Vou fechar este issue para concentrarmos a discuss√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/922, ok? Recomendo que leia os coment√°rios l√° e adicione seus pontos na discuss√£o ü§ù
</issue_1842_Login e Cadastro de usu√°rio usando a conta do GitHub e/ou LinkedIn>

<issue_1844_Poder responder coment√°rios do pr√≥prio post mesmo com m√° reputa√ß√£o>
### Descri√ß√£o

Ontem, quando criei meu primeiro post: https://www.tabnews.com.br/samuelteixeiras/por-que-usamos-frameworks-e-por-que-eles-sao-uteis, acabei recebendo alguns downvotes.

O que aconteceu depois √© que n√£o consigo responder coment√°rios  do meu pr√≥prio post porque tenho m√° reputa√ß√£o. Acredito que isso gera uma barreira.

Li e entendo que isso protege o Tabnews, mas isso deveria ser desconsiderado na hora de responder o pr√≥prio post. Pelo menos eu acredito que n√£o faria mal ter mais coment√°rios no meu pr√≥prio post. Se for mesmo um post com conte√∫do n√£o relevante, o "dano" ficaria contido no mesmo.

### Sugest√£o de implementa√ß√£o

N√£o bloquear coment√°rios ao responder no pr√≥prio post, se o mesmo tem m√° reputa√ß√£o. 
Acredito que o comentario no caso seria para esclarecer ou continuar a discussao.

>> Coment√°rio de Jeiel0rbit:
Creio que deveria o usu√°rio n√£o votar mais de 1 (uma) vez. Assim √© poss√≠vel dar 3 votos para mais ou para menos com √∫nica conta. 
~~N√£o acredito que usu√°rio possa comentar o pr√≥prio post a n√£o ser para responder algum coment√°rio feito no post.~~ ~~N√£o comentar o pr√≥prio post, simplesmente n√£o fazer sentido.~~ 

Espero ter interpretado de forma correta e n√£o comunicado errado.

>> Coment√°rio de samuelteixeiras:
N√£o seria comentar o pr√≥prio post , mas responder a comentario no pr√≥prio post.
</issue_1844_Poder responder coment√°rios do pr√≥prio post mesmo com m√° reputa√ß√£o>

<issue_1845_Melhores do dia>
### Descri√ß√£o

Em sites como o Product Hunt nos temos o tops to dia, acredito que seria algo interessante de ter no TabNews. 
Se o "Relevantes" ja cumpre esse papel, pode desconsiderar a issue. 

### Sugest√£o de implementa√ß√£o

Usar um mix de tabcoins e n√∫mero de respostas pra definir as top contribui√ß√µes do dia.

>> Coment√°rio de aprendendofelipe:
> Usar um mix de tabcoins e n√∫mero de respostas pra definir as top contribui√ß√µes do dia.

Isso tudo, junto do tempo de publica√ß√£o, √© o que cria a lista de relevantes.
</issue_1845_Melhores do dia>

<issue_1847_Problema com Endere√ßo Relativo>
### Descri√ß√£o

Boa tarde, notei por meio de um [post esse em quest√£o](https://www.tabnews.com.br/ThiagoBrito/aprimore-seu-system-design-com-o-sysdraw-io)
que o tabnews esta utilizando endere√ßo relativo e n√£o endere√ßo absoluto...
isso causa o problema do sistema entender que o link em quest√£o e uma slug

![Image](https://github.com/user-attachments/assets/28d04fd0-78e6-4ed2-94f5-4305348d4d99)

ele fica assim
`https://www.tabnews.com.br/ThiagoBrito/www.sysdraw.io`
e o correto seria assim
`https://www.sysdraw.io`

### Passos para reproduzir o problema

Basta adiciona qualquer link sem o protocolo
exemplo:

www.google.com (assim ele entende que e uma slug e apresenta o problema)

https://google.com (assim ele entende que e uma URL Externa)

### Navegadores testados

Chrome

### Poss√≠vel solu√ß√£o

Caso o usu√°rio n√£o adicione o protocolo o sistema deve adicionar o https:// no inicio do link para resolver o problema

>> Coment√°rio de aprendendofelipe:
O comportamento disso no TabNews √© o mesmo do GitHub e me parece o mais correto.

O controle se o endere√ßo √© absoluto ou relativo fica nas m√£os de quem inserir o link no conte√∫do. √â importante inserir o esquema (`http`, `mailto` etc.) se n√£o for inserir um endere√ßo relativo.
</issue_1847_Problema com Endere√ßo Relativo>

<issue_1848_Alterar nivel de relevancia dos ADS>
### Descri√ß√£o

Andei verificando e j√° ate utilizei os ADS do Tabnews porem eu notei que ele n√£o esta sendo eficiente (na minha percep√ß√£o)
Ent√£o pensei em uma forma de tornar ele mais eficiente, com base no n√≠vel de confian√ßa... mas como assim?

Cada usu√°rio vai ter um n√≠vel de confian√ßa(reputa√ß√£o) tal como ja existe algo similar para usu√°rios e com base nisso tornar
o AD de tal pessoa mais relevante ou n√£o... assim o usu√°rio que contribui sem trapa√ßas ter√° um "engajamento melhor" do seus ADS
al√©m de deixar cada AD com uma "VIDA" de 24h...
sendo para que tem boa reputa√ß√£o o alcance de 24h e desconto no AD e para usu√°rios com reputa√ß√£o baixa 2h de alcance e pre√ßos maiores

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de pultzlucas:
E como que vai ser medida essa reputa√ß√£o do usu√°rio?
</issue_1848_Alterar nivel de relevancia dos ADS>

<issue_1849_Adicionar Visualizador de Visitante √© Nova Categoria>
### Descri√ß√£o

Hoje em dia n√£o e poss√≠vel ver quantas pessoas acessaram tal publica√ß√£o, seria interessante ter um indicador publico de cada post para vermos quantos acesso teve e uma nova sess√£o do lado do Recentes sendo o Em Alta onde os posts com mais acesso ficariam classificados.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Rafatcb:
@cybernerd007 obrigado pela sugest√£o!

Vou fechar esse issue para concentrarmos a discuss√£o em https://github.com/filipedeschamps/tabnews.com.br/issues/1115, que j√° teve um bom andamento com ideias e como poderia funcionar.

Adianto que essa aba "Em Alta" provavelmente n√£o vai ser muito √∫til, porque as publica√ß√µes mais visitadas costumam ser por causa de recomenda√ß√µes do Google, e √†s vezes sequer receberam votos. O Felipe Barso fez uma publica√ß√£o recente com alguns exemplos: [[TabNews] Mais de 2M de visitantes e 5M de visualiza√ß√µes em 2024 üìä](https://www.tabnews.com.br/FelipeBarso/tabnews-mais-de-2m-de-visitantes-e-5m-de-visualizacoes-em-2024)
</issue_1849_Adicionar Visualizador de Visitante √© Nova Categoria>

<issue_1850_Utilizar TabCash como Desconto no Curso.dev>
### Descri√ß√£o

Seria interessante utilizar o TabCash para ganhar desconto no Curso.dev uma forma de incentivar ainda mais os utilizadores fieis que contribui com a comunidade...

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de Muriyoku:
Acredito que haver√° pessoas criando in√∫meros posts de forma automatizada ou gerando coment√°rios sem utilidade alguma apenas para ganhar `TabCash`. 

Sem contar que a equipe por tr√°s do `Curso.dev` ficaria no preju√≠zo caso algu√©m acumulasse tanto ao ponto de ter 100% de desconto.

>> Coment√°rio de cybernerd007:
J√° existe algumas formas de barrar os usu√°rio que fazem o "farm" de TabCash... agora sobre o desconto acredito que se limitado a no m√°ximo 5% sem ser acumulativo seria algo interessante.
</issue_1850_Utilizar TabCash como Desconto no Curso.dev>

<issue_1851_Login Third-Party para utilizar o Tabnews como Login em Sites de Terceiros>
### Descri√ß√£o

Como o Tabnews e o ber√ßo de novas tecnologias e empreendedores nesse mundo virtual oferecer o Login Third-Party por meio do Tabnews seria algo incr√≠vel, passando o Tabnews para um novo patamar al√©m de facilitar que usu√°rio interajam com sistemas feitos pela comunidade.

Assim todos que ja tem uma conta no Tabnews n√£o precise fazer um novo cadastro em um site/aplica√ß√£o da comunidade.

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de cybernerd007:
Recomendo Tomar Essa Implementa√ß√£o com Cuidado Pois o Email do Usuario Posteriormente Poder√° Ser Pedido(Recolhido) Pelo Site Assim Quebrando em Partes a Seguran√ßa dos Dados e Tornando Poss√≠vel um Ataque de For√ßa Bruta na Senha...

>> Coment√°rio de heyjunin:
Oi, tudo certo?

Achei a proposta interessante e concordo que ter o login via Tabnews poderia fortalecer o ecossistema da comunidade. Do ponto de vista t√©cnico, s√≥ queria compartilhar alguns pontos que talvez ajudem a avaliar a viabilidade da ideia:

Hoje o sistema de autentica√ß√£o do Tabnews √© pr√≥prio, usando PostgreSQL direto. Para funcionar como provedor de login para apps de terceiros (tipo ‚ÄúLogin com Tabnews‚Äù), seria necess√°rio implementar um servidor OAuth 2.0 ou OpenID Connect ‚Äî com endpoints para autoriza√ß√£o, gera√ß√£o de tokens, consentimento do usu√°rio, escopos, etc.

Tamb√©m seria importante prever alguma forma de gest√£o para desenvolvedores (ex: cadastro de apps, client_id/client_secret, aprova√ß√£o manual ou autom√°tica de apps, etc.).

Sobre a preocupa√ß√£o com privacidade: faz sentido. Seria essencial garantir que os dados s√≥ sejam compartilhados com consentimento expl√≠cito do usu√°rio (como acontece no login com Google ou GitHub, por exemplo), podendo limitar os escopos e at√© permitir login sem expor o e-mail.

Acho que √© uma ideia bacana, mas que exigiria uma mudan√ßa de escopo consider√°vel no projeto. Talvez valha a pena conversar com os mantenedores pra entender se isso j√° est√° no radar ou se seria algo pra uma futura vers√£o mais voltada a API p√∫blica/SSO.
</issue_1851_Login Third-Party para utilizar o Tabnews como Login em Sites de Terceiros>

<issue_1856_Inconsist√™ncia na renderiza√ß√£o da barra de pesquisa>
### Descri√ß√£o

### **A barra de pesquisa "_Pesquisar com o Google_" tem um comportamento inconsistente durante a renderiza√ß√£o.**

### Em alguns momentos, ela √© exibida corretamente:
![Image](https://github.com/user-attachments/assets/5944ba28-8439-4f79-8725-dde1451336f7)

![Image](https://github.com/user-attachments/assets/833271d4-a769-487a-a3ec-6d4e8df8e34b)



### **Em outros momentos, a renderiza√ß√£o buga e exibe uma vers√£o simplificada**
![Image](https://github.com/user-attachments/assets/8ddcbd64-cafa-41c3-b5c5-2ccf936bc8c6)

![Image](https://github.com/user-attachments/assets/9e4106d5-1946-4fb3-989e-32b16058b25f)


### Passos para reproduzir o problema

Acontece ao clicar pela 2¬™/3¬™ vez na barra de pesquisa
Mas por vezes acontece ao clicar pela 1¬™ vez

### Navegadores testados

Chrome, Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de tsilmak:
Duplicado
</issue_1856_Inconsist√™ncia na renderiza√ß√£o da barra de pesquisa>

<issue_1857_Adi√ß√£o de t√≥picos/palavras-chave em publica√ß√µes>
### Descri√ß√£o

## Descri√ß√£o do novo recurso

A ideia √© possibilitar que o criador de conte√∫do possa adicionar t√≥picos em uma publica√ß√£o. De uma forma parecida como √© feito no [Github](https://docs.github.com/pt/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/classifying-your-repository-with-topics) onde voc√™ pode adicionar t√≥picos no reposit√≥rio para facilitar que outras pessoas o encontre.


## Porque implementar o recurso no TabNews?

As palavras-chave s√£o comum em diversas plataformas que trabalham com conte√∫dos diversificados. Elas facilitam que o usu√°rio encontre o que deseja, al√©m de permitir o agrupamento e categoriza√ß√£o de conte√∫do.

## Exemplo de uso:

T√≠tulo da publica√ß√£o: "Como construir sua pr√≥pria linguagem de programa√ß√£o" .

Poss√≠veis t√≥picos:
- Linguagem de programa√ß√£o
- Fa√ßa voc√™ mesmo
- Compiladores

Na pr√°tica quando o usu√°rio pesquisar por alguns desses t√≥picos a publica√ß√£o aparecer√° na listagem. 

### Sugest√£o de implementa√ß√£o

Pensei em implementar da mesma forma como √© feito no [Github](https://docs.github.com/pt/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/classifying-your-repository-with-topics). 

No formul√°rio de cria√ß√£o de nova publica√ß√£o ser√° adicionado um campo onde o criador da publica√ß√£o pode adicionar os t√≥picos **separados por espa√ßo**. E enquanto o usu√°rio digita um t√≥pico v√£o aparecer sugest√µes para ele de t√≥picos pr√© cadastrados antes (por outros criadores de conte√∫do). Caso o usu√°rio adicione um t√≥pico que ainda n√£o exista, esse t√≥pico √© cadastrado na base.

O que acham desse novo recurso?

>> Coment√°rio de Rafatcb:
@pultzlucas obrigado pela sugest√£o! Vou fechar este issue como duplicado de #742. Caso tenha algum complemento a que foi discutido l√°, pode deixar seu coment√°rio üí™ 

√â um recurso bem desejado.
</issue_1857_Adi√ß√£o de t√≥picos/palavras-chave em publica√ß√µes>

<issue_1858_Tab "Marcados como relevantes">
### Descri√ß√£o

Acho interessante na p√°gina de perfil de usu√°rio adicionar uma tab onde o usu√°rio pode ver todos os posts que ele marcou como relevante (deu um like). Da mesma forma que no Youtube tem a aba "Liked v√≠deos".

Isso ajudaria o usu√°rio a n√£o perder as publica√ß√µes que ele gosta.

![Image](https://github.com/user-attachments/assets/dde809c4-d89b-498f-bb87-70246765c1d7)

### Sugest√£o de implementa√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
@pultzlucas, estou fechando por ser um assunto j√° abordado na #645 ü§ù
</issue_1858_Tab "Marcados como relevantes">

<issue_1861_Possibilidade de seguir um Autor>
### Descri√ß√£o

Hoje mesmo eu estava no TabNews lendo um post muito interessante, entrei no perfil do Autor e vi que ele escreve coisas relevantes e que eu gostaria de receber novas postagens do mesmo autor. Nisso, pensei que a funcionalidade dar um Follow em determinado autor seria √≥timo. Assim o seguidor pode receber diretamente os conte√∫do novos que deseja.

### Sugest√£o de implementa√ß√£o

- Adicionar um bot√£o no perfil do usu√°rio para "Seguir"
- Ao carregar a p√°gina de postagens, se o post pertencer a um autor que o usu√°rio √© inscrito, sinalizar o nome do Autor com uma cor diferente  (Ou algo do tipo).

>> Coment√°rio de Rafatcb:
@pultzlucas obrigado pela sugest√£o! Vou fechar como duplicado do #645, que engloba seguir usu√°rios ou conte√∫do, e ter listas ü§ù 

Se ter alguma sugest√£o complementar, pode comentar l√°!
</issue_1861_Possibilidade de seguir um Autor>

<issue_1863_Adicionar posts - Vagas de Trabalho>
### Descri√ß√£o

Eu estava pensando, seria legal permitir posts apenas para divulgar vagas, estilo os t√≥picos Classificados?

### Sugest√£o de implementa√ß√£o

Algo como:

![Image](https://github.com/user-attachments/assets/1f3714b3-24b6-43cf-a1a3-4d05da6a394e)

![Image](https://github.com/user-attachments/assets/61bfed19-b919-4db2-86b2-1432e7487add)

>> Coment√°rio de Danielalveslira:
Ideia sensacional! ü§© ü§ù

>> Coment√°rio de Muriyoku:
Complementando essa feature, seria interessante adicionar uma para os posts mais relevantes baseados em upvotes. Existem muitos posts que s√£o realmente bons e ficam esquecidos no tempo. Apesar de haver a barra de pesquisa, as vezes ainda √© dif√≠cil encontrar algo pois existem diversos posts duplicados com t√≠tulos semelhantes.

>> Coment√°rio de silviooosilva:
@filipedeschamps Olha aquiii üöÄ
</issue_1863_Adicionar posts - Vagas de Trabalho>

<issue_1869_[SECURITY] Projeto utiliza vers√£o vulner√°vel do Next.js (CVE-2025-29927)>
### Descri√ß√£o

O projeto est√° utilizando a vers√£o `14.2.4` do Next.js, conforme verificado no `package.json`. Esta vers√£o est√° sujeita √† vulnerabilidade cr√≠tica **CVE-2025-29927**, que permite _authorization bypass_ via middleware:

- https://github.com/advisories/GHSA-f82v-jwr5-mffw
- https://nextjs.org/blog/cve-2025-29927

### Evid√™ncia

O arquivo [`middleware.public.js`](https://github.com/filipedeschamps/tabnews.com.br/blob/main/middleware.public.js) indica o uso de middleware, o que pode tornar o projeto afetado por essa falha de seguran√ßa.

Ainda que o site esteja atualmente protegido contra essa falha cr√≠tica do `Next.js` devido prote√ß√µes implementadas pela Vercel, √© prudente realizar a atualiza√ß√£o.

### Passos para reproduzir o problema

1. Utilizar uma aplica√ß√£o Next.js com vers√£o anterior √† 14.2.25.
2. Configurar middleware que realiza valida√ß√µes de autentica√ß√£o/autoriza√ß√£o.
3. Realizar uma requisi√ß√£o maliciosa incluindo o cabe√ßalho x-middleware-subrequest.
4. O middleware pode ser ignorado, permitindo acesso indevido a rotas restritas.

### Navegadores testados

Firefox

### Poss√≠vel solu√ß√£o

Atualizar a depend√™ncia `next` para pelo menos a vers√£o `14.2.25`, que cont√©m o patch para essa falha:

```json
"next": "^14.2.25"

>> Coment√°rio de aprendendofelipe:
@eukaio, temos ci√™ncia da vulnerabilidade j√° corrigida no Next.js, mas, a princ√≠pio, ela n√£o nos afeta. Os passos para reproduzir o problema que voc√™ informou s√£o gen√©ricos, certo?

Caso encontre alguma vulnerabilidade no TabNews, pe√ßo por favor que n√£o abra uma issue, mas nos informe os detalhes via `contato@tabnews.com.br` ou pelo https://github.com/filipedeschamps/tabnews.com.br/security/advisories

Muito obrigado! üí™

>> Coment√°rio de eukaio:
De fato o tabnews atualmente n√£o √© afetado pela vulnerabilidade, conforme relatado na issue, mas apenas por estar no ambiente da Vercel. No meu modo de ver, a seguran√ßa n√£o pode depender exclusivamente do ambiente.

Obrigado pela dica do security advisories, futuros reportes relacionados √† seguran√ßa ser√£o feitos por l√°.

>> Coment√°rio de aprendendofelipe:
Essa vulnerabilidade n√£o nos afetaria mesmo hospedando fora da Vercel, pois a gente nem precisaria do middleware se n√£o estivesse hospedando o TabNews na Vercel.

Caso acredite que isso n√£o seja verdade, por favor, informe os detalhes via canais citados e nos comprometemos a divulgar a sua descoberta ap√≥s a corre√ß√£o da vulnerabilidade. ü§ù

>> Coment√°rio de eukaio:
Vejo de forma diferente. O tabnews como projeto open source n√£o se prop√µe a servir exclusivamente a si pr√≥prio. Ele est√° sujeito a forks e clones para usos diversos. Todos esses projetos, se n√£o hospedados em ambientes protegidos como o da Vercel, estar√£o vulner√°veis. 

Um projeto open source n√£o deve depender exclusivamente de uma infraestrutura fechada para funcionar corretamente, pois isso limita o prop√≥sito open source.
</issue_1869_[SECURITY] Projeto utiliza vers√£o vulner√°vel do Next.js (CVE-2025-29927)>

<issue_1871_Requisi√ß√£o bloqueada pelo Firewall - Bloqueio ao utilizar VPN?>
### Descri√ß√£o

Notei alguns problemas no site ao utilizar vpn (mullvad).

__N√£o funciona:__
- Logar no site;
- Interagir de alguma forma aos posts (up/down votes) ou responder;

__Funciona:__
- Navegar entre postagens.

Mensagem de erro que aparece ao tentar logar ou interagir:

`Requisi√ß√£o bloqueada pelo Firewall. Verifique seu equipamento e os dados enviados. Informe ao suporte o valor (cf-ray: 929be8d31a9bd6f8-IAD)`

Esse bloqueio √© intencional?

### Passos para reproduzir o problema

Testei usando outros pa√≠ses da vpn _(Brasil, USA e etc)_, mas o erro persiste.

**Ao desconectar da vpn, tudo funciona normalmente.**

### Navegadores testados

Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
> Esse bloqueio √© intencional?

Fala @renaldofreire, sim, √© intencional. üëç

Est√£o bloqueadas algumas atividades usando redes com hist√≥ricos de abusos no TabNews, isso inclui algumas VPNs. ü§ù

>> Coment√°rio de renaldofreire:
Obrigado pelo esclarecimento. Fechando o report.
</issue_1871_Requisi√ß√£o bloqueada pelo Firewall - Bloqueio ao utilizar VPN?>

<issue_1872_Atalhos de teclado>
### Descri√ß√£o

Seria interessante ter atalhos de teclado na navega√ß√£o.


### Sugest√£o de implementa√ß√£o

- "/" para acessar a pesquisa;
- setas pra cima e para baixo (ou j e k) para navegar entre os posts;
- ter um atalho de "?" para listar os atalhos dispon√≠veis;
- "N" para novo conte√∫do
- e outros...

Este s√£o alguns que visualizei apenas na listagem de posts. Depois pode abranger a parte de publica√ß√£o.
</issue_1872_Atalhos de teclado>

<issue_1877_Adicionar `.npmrc` com `save-exact=true`>
### Descri√ß√£o

Pelo que pude observar, atualmente o `TabNews` salva suas depend√™ncias sem utilizar os prefixos padr√£o de versionamento sem√¢ntico (^ ou ~), por√©m acredito que isso n√£o est√° documentado nem garantido por nenhuma configura√ß√£o expl√≠cita. A adi√ß√£o desse arquivo ajudaria a:

1. Garantir que todas as depend√™ncias sejam salvas com a vers√£o exata de forma consistente.
2. Melhorar a previsibilidade e reprodutibilidade das instala√ß√µes.

### Sugest√£o de implementa√ß√£o

 Apenas criar um arquivo `.npmrc` na raiz do projeto com a configura√ß√£o: 

```ini
save-exact=true
```

Para refor√ßar uma pr√°tica que j√° est√° sendo seguida no projeto, e talvez servir como ponto central para futuras configura√ß√µes do [`npm`](https://docs.npmjs.com/cli/v8/using-npm/config?utm_source=chatgpt.com) no TabNews.

>> Coment√°rio de aprendendofelipe:
> 1. Garantir que todas as depend√™ncias sejam salvas com a vers√£o exata de forma consistente.

Garantir isso √© uma boa ideia, mas o `save-exact=true` no `.npmrc` garante isso? At√© que facilita por n√£o precisar mais do `-E` no `npm install`, mas a garantia continuaria sendo na hora da revis√£o do PR, n√£o √©?

Talvez o caminho seja usar no CI e no `pre-commit` algo como o [`npm-package-json-lint`](https://www.npmjs.com/package/npm-package-json-lint) com as regras [`prefer-absolute-version-dependencies`](https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-absolute-version-dependencies/) e [`prefer-absolute-version-devDependencies`](https://npmpackagejsonlint.org/docs/rules/dependencies/prefer-absolute-version-devdependencies/).

> 2. Melhorar a previsibilidade e reprodutibilidade das instala√ß√µes.

Isso √© garantido com o `package-lock.json`

>> Coment√°rio de marques-gabriel:
Isso! Na verdade a ideia do arquivo tem o foco maior apenas durante o desenvolvimento realmente, pra n√£o precisar mais do 
  `-E` ou de `--save-exact` no `npm install`.
</issue_1877_Adicionar `.npmrc` com `save-exact=true`>

<issue_1883_Post de artigos via API>
### Descri√ß√£o

Eu estou tentando fazer um post de artigo pela api, mas toda vez que tento eu recebo esse erro `Forbidden - perhaps check your credentials?
Usu√°rio n√£o pode executar esta opera√ß√£o.`, segue a response da api: 
```json
{
 \"name\":\"ForbiddenError\",
 \"message\":\"Usu√°rio n√£o pode executar esta opera√ß√£o.\",
 \"action\":\"Verifique se este usu√°rio possui a feature \\\"create:content\\\".\",
 \"status_code\":403,
 \"error_id\":\"b558ed95-5859-4e1f-b11a-970b04e78367\",
 \"request_id\":\"gru1::zqwnv-1745621515307-7fe2cab317a6\",
 \"error_location_code\":\"MODEL:AUTHORIZATION:CAN_REQUEST:FEATURE_NOT_FOUND\"}
```

### Passos para reproduzir o problema

1. Fiz login usando meu usuario e senha pela rota `https://www.tabnews.com.br/api/v1/sessions`
2. Peguei o token que recebi ao fazer login e coloquei ele como bearer token
3. Defini uma um json com `title`, `body`, `status` e `type`:
 ```
{ "body": { " title": "Testinho", "body": "# Testandiunho\\n## Testantinho2\\n### testandinho3", "status": "published", "type": "content" }, "headers": { "accept": "application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7", "Authorization": "**hidden**" }, "method": "POST", "uri": "https://tabnews.com.br/api/v1/contents", "gzip": true, "rejectUnauthorized": true, "followRedirect": true, "resolveWithFullResponse": true, "followAllRedirects": true, "timeout": 300000, "encoding": null, "json": false, "useStream": true }
 ```
4. Fiz a req POST para rota `https://www.tabnews.com.br/api/v1/contents`
5. Caiu no caso de erro informado

### Navegadores testados

Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Falar @PiluVitu, precisa enviar o header `cookie` com valor `session_id=${token}`.

Mas, por favor, n√£o fa√ßa testes no ambiente de produ√ß√£o. Se cadastre e teste no ambiente de homologa√ß√£o:

https://tabnews-k7o400fai-tabnews.vercel.app/

O link acima √© a vers√£o mais recente, mas cada nova vers√£o do TabNews gera um novo endere√ßo de homologa√ß√£o. Voc√™ pode ver os mais recentes filtrando por `Preview` em:

https://github.com/filipedeschamps/tabnews.com.br/deployments

>> Coment√°rio de PiluVitu:
Muito obrigado pela velocidade na resposta, n√£o sabia do ambiente de homolog üòÖ
</issue_1883_Post de artigos via API>

<issue_1889_Gerenciamento de Tabcash e TabCoins sobre NewsletterOfficial>
### Assunto

Outro

### D√∫vida

![Image](https://github.com/user-attachments/assets/533e1e61-f4cc-4f29-b7c6-3d952b9ac37b)

1. Por quem √© gerenciado? 
2. "Vale a pena tabCash e tabCoins" ser ativado nessa conta? Tudo bem, Filipe Deschamps, √© um usu√°rio como n√≥s, mas NewsletterOfficial transmite uma informa√ß√£o que n√£o √© um usu√°rio, que √© estranho acumular pontua√ß√£o.

>> Coment√°rio de filipedeschamps:
@Jeiel0rbit show, obrigado por trazer isso aqui! Quem faz a gest√£o dessa conta √© o @LuanGregati que faz parte da nossa equipe.

J√° discutimos algumas boas vezes sobre a abordagem da conta da Newsletter e estacionamos em ela ser considerada como um usu√°rio normal que cria conte√∫dos, recebe TabCoins e distribui elas quando fizer sentido (por isso que ela tem TabCash como resultado).

E como n√£o h√° abusos dessa conta, n√£o vejo problema em continuar assim. O que acha?

>> Coment√°rio de LuanGregati:
@Jeiel0rbit, bom dia, meu caro. Al√©m do que o Filipe mencionou, eu tamb√©m busco dar _upvotes_ em coment√°rios e publica√ß√µes relevantes/interessantes no TabNews para poder distribuir as TabCoins, visto que essa conta possui uma grande quantidade devido ao fato de que eu posto not√≠cias de tecnologia durante o dia a partir dela ü§ù

>> Coment√°rio de Jeiel0rbit:
Entendi, realmente n√£o vejo problema em manter. 

Sugiro que haja uma etiqueta ou selo que deixe como algo que diferencia dos demais, talvez uma coluna nova ou em uma rota diferente que exibe apenas as NewsletterOfficial. 
"...para quem n√£o tem tempo de ler not√≠cias." √© um ponto importante. Pois eu acompanho por e-mail, mas e outros que o acompanham pelo TabNews? Em meio aos posts misturados, essas not√≠cias se perdem.
</issue_1889_Gerenciamento de Tabcash e TabCoins sobre NewsletterOfficial>

<issue_1895_Erro a fazer postagem>
### Descri√ß√£o

Encontrei um problema ao tentar fazer um novo post no Tabnews, quando tento publicar aparece a mensagem: "body" deve come√ßar com caracteres vis√≠veis, veja o erro na imagem abaixo:

![](https://i.postimg.cc/6QDLCZ7t/erro.jpg)

O conte√∫do que eu estava tentando publicar esta no reposit√≥rio meu do github de backup de posts, √© um arquivo Readme.md, veja no link:

https://github.com/Lucas-Ed/posts-backup/blob/main/Como%20Enviar%20E-mails%20Usando%20PHPMailer%20e%20Gmail%20no%20XAMPP%20(Ambiente%20de%20Desenvolvimento).md

### Passos para reproduzir o problema

tentar republicar o conte√∫do que eu estava tentando postar para ver o erro que √© gerado !

### Navegadores testados

_No response_

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
Basta remover a quebra de linha do come√ßo da sua publica√ß√£o ü§ù

>> Coment√°rio de Lucas-Ed:
Obrigado, era isso mesmo, removi as quebras de linha e deu certo !
</issue_1895_Erro a fazer postagem>

<issue_1898_reestrutura√ß√£o com TypeScript, Nextjs(appRouter), zod e etc.>
### Assunto

Reposit√≥rio, Contribui√ß√£o, C√≥digo, API, Outro

### D√∫vida

Ol√°, pessoal!

Estou analisando a possibilidade de reestruturar o projeto, com foco em moderniza√ß√£o, manutenibilidade e ader√™ncia √†s tecnologias mais utilizadas atualmente no mercado. Meu objetivo √© realizar uma reescrita completa da base de c√≥digo do front-end utilizando:

TypeScript (ao inv√©s de JavaScript)

Next.js com App Router (vers√£o atual)

Zod para valida√ß√£o de dados.

Novas pr√°ticas com Server Actions, metadata, edge functions e outros recursos recentes

Integra√ß√£o e automa√ß√£o modernas (CI/CD, infraestrutura como c√≥digo, etc.)


Por√©m, para garantir que essa reestrutura√ß√£o seja compat√≠vel com toda a infraestrutura do projeto ‚Äî especialmente a parte de provisionamento de recursos na AWS via Terraform ‚Äî preciso de algumas informa√ß√µes fundamentais:


---

D√∫vidas principais sobre infraestrutura

1. Como √© feito atualmente o provisionamento via Terraform?

H√° algum script dispon√≠vel no reposit√≥rio (ou no package.json) para inicializa√ß√£o/configura√ß√£o dos recursos via Terraform?

H√° algum exemplo ou documenta√ß√£o de como subir a infraestrutura localmente para testes?



2. Quais servi√ßos da AWS est√£o sendo utilizados atualmente?

O projeto provisiona apenas o banco de dados (RDS, DynamoDB, etc.)?

Existe algum outro servi√ßo integrado? (ex: SES para envio de e-mails, S3 para armazenamento, Lambda, API Gateway, etc.)


---

Proposta de melhoria

Caso essa informa√ß√£o n√£o esteja clara no reposit√≥rio, sugiro:

Criar uma se√ß√£o no README explicando o processo de deploy/teste da infraestrutura com Terraform

Adicionar um script no package.json ou Makefile que automatize esse processo

Se poss√≠vel, fornecer um terraform.tfvars.example com os par√¢metros esperados



---

Objetivo final

Meu objetivo com essa iniciativa √© garantir que a reescrita em TypeScript + Next.js (vers√£o atual) esteja totalmente compat√≠vel com a stack atual de deploy e infraestrutura, e que eu possa testar tudo localmente antes de propor um PR oficial.

Agrade√ßo desde j√° e fico √† disposi√ß√£o para colaborar com essa evolu√ß√£o do projeto.

Atenciosamente,

Danilo, github.com/kovarike

>> Coment√°rio de heyjunin:
Oi Danilo, tudo bem?

Muito bacana ver seu interesse em contribuir com o projeto!

Sobre as d√∫vidas que voc√™ levantou, acredito que boa parte das respostas j√° est√£o dispon√≠veis no pr√≥prio reposit√≥rio ‚Äî especialmente nas pastas relacionadas √† infraestrutura e no README. Talvez valha dar uma olhada por l√° antes de avan√ßar. üôÇ

Quanto √† ideia de reescrever toda a base do front-end, entendo totalmente o impulso de modernizar, mas como usu√°rio, a experi√™ncia atual j√° parece bem est√°vel e funcional. Talvez seja o caso de avaliar se uma reestrutura√ß√£o completa √© realmente necess√°ria agora ‚Äî ou se melhorias pontuais j√° trariam um bom ganho com menos impacto.

De qualquer forma, √© √≥timo ver essa iniciativa. Tomara que role uma boa troca com os mantenedores!

Abra√ßo!

>> Coment√°rio de aprendendofelipe:
Ol√°, @kovarike! Tudo certo? Valeu pelo interesse em contribuir! üí™

Mas uma reescrita completa n√£o parece resolver nenhum problema real do TabNews hoje.

Como o projeto √© constru√≠do de forma colaborativa, o ideal √© explorar o c√≥digo, issues e PRs pra entender as decis√µes que j√° rolaram e evitar retrabalho.

Sobre suas d√∫vidas de infraestrutura, d√° pra come√ßar pelo README, rodar o projeto localmente e avaliar se o que voc√™ quer mudar realmente impacta os servi√ßos que v√£o subir via Docker.

Vamos encerrar a issue, mas o projeto segue aberto pra contribui√ß√µes incrementais. ü§ù
</issue_1898_reestrutura√ß√£o com TypeScript, Nextjs(appRouter), zod e etc.>

<issue_1899_Modera√ß√£o de Conte√∫do Patrocinado Edit√°vel>
### Assunto

Outro

### D√∫vida

![Image](https://github.com/user-attachments/assets/66cbebfd-6bee-475f-913f-c2cc24111b98)

Fico pensando ü§î sobre as postagens patrocinadas antigas. √â poss√≠vel editar a quaisquer momento. Imagine conte√∫do v√°lido no primeiro dia, agora imagine ap√≥s 6 meses, conte√∫do que viola as regras. N√£o se limita apenas as postagens patrocinadas, tamb√©m as comuns. Sei que h√° o time de moderadores, mas bem sabemos que h√° muitas pessoas superiores aos olhos humanos das autoridades. 

Existe um plano dentro desse contexto?

>> Coment√°rio de Jeiel0rbit:
P√¥de observar hoje, ao editar em um dos meus links patrocinados com Tabcash, a url n√£o muda. Permanece o t√≠tulo postado pela primeira vez. Pelo teste local com acesso admin, n√£o h√° de fato um controle sobre isso.

1 - Ser√° algo bom adicionar uma redu√ß√£o de Tabcash ao usu√°rio tentar editar o conte√∫do? ü§î

2 - N√£o penalizar, todavia n√£o permitir editar ap√≥s patrocinar. ‚õî

3 - Outro (comente). ‚ÑπÔ∏è

>> Coment√°rio de aprendendofelipe:
> P√¥de observar hoje, ao editar em um dos meus links patrocinados com Tabcash, a url n√£o muda. Permanece o t√≠tulo postado pela primeira vez. Pelo teste local com acesso admin, n√£o h√° de fato um controle sobre isso.

Assim como qualquer conte√∫do, s√≥ d√° para editar o `slug` via API.

> 1 - Ser√° algo bom adicionar uma redu√ß√£o de Tabcash ao usu√°rio tentar editar o conte√∫do? ü§î
> 
> 2 - N√£o penalizar, todavia n√£o permitir editar ap√≥s patrocinar. ‚õî

A Revenue Share ainda est√° como funcionalidade experimental, e por isso os conte√∫dos est√£o permanecendo por tempo indeterminado. Isso provavelmente ir√° mudar. Mais detalhes est√£o nas issues e PRs listados em #1490.

Acredito que o questionamento principal pode ser melhor debatido na issue #877, por isso vou fechar aqui como duplicada. ü§ù

>> Coment√°rio de Jeiel0rbit:
Perfeito, estarei me atualizando.
</issue_1899_Modera√ß√£o de Conte√∫do Patrocinado Edit√°vel>

<issue_1908_`@vitest/coverage-v8` para an√°lise de cobertura de testes>
### Descri√ß√£o

## Cobertura de testes
Atualmente o tabnews n√£o utiliza nenhuma forma de an√°lise de cobertura de testes dentro do projeto, acredito que possa ter sido uma escolha de neg√≥cios mas √© algo que pode complementar positivamente com uma an√°lise mais profunda em todos os arquivos dentro do projeto, j√° que √© poss√≠vel entender de maneira melhor se as linhas de c√≥digo e os m√©todos est√£o todos sendo testados.
Apesar da cobertura n√£o refletir exatamente a qualidade dos testes, √© uma √≥tima ferramenta para direcionar o desenvolvimento de novos testes dentro do projeto, facilitando a escolha de classes ou m√©todos que est√£o precisando de uma maior quantidade de testes. 

### Sugest√£o de implementa√ß√£o

A minha sugest√£o √© utilizar o p≈ïoprio `vitest` com o `@vitest/coverage-v8` para gerar um relat√≥rio completo da cobertura dos testes dentro do projeto.
O comando para rodar a cobertura e gerar o seu relat√≥rio √©: ```npx vitest --coverage```
Isso tamb√©m pode ser implementado dentro dos scripts do projeto a partir do package.json.

Utilizei esse pacote para rodar os teste e tive este resultado para o model user:

![Image](https://github.com/user-attachments/assets/c138c847-f8df-4706-b8ce-b53d09a70a4a)

√â poss√≠vel perceber o resultado de 65,04% de cobertura.

Ap√≥s escrever alguns testes unit√°rios para a fun√ß√£o `update` do model ![`user.js`](https://github.com/filipedeschamps/tabnews.com.br/blob/main/models/user.js), obtive este resultado:

![Image](https://github.com/user-attachments/assets/c5dd0f9e-5d19-42f2-88ff-33e46d5cab45)

O resultado aumentou para 72,03% de cobertura.

>> Coment√°rio de Rafatcb:
O `@vitest/coverage-v8` j√° √© uma depend√™ncia atrav√©s da biblioteca [`@tabnews/config`](https://github.com/aprendendofelipe/tabnews-config), pode conferir o [`package.json`](https://github.com/aprendendofelipe/tabnews-config/blob/main/package.json) dela.

Logo, o comando que voc√™ sugeriu (`npx vitest --coverage`) j√° funciona:

```md
 Test Files  50 passed (50)
      Tests  755 passed | 2 skipped (757)
   Start at  21:29:52
   Duration  219.30s (transform 3.24s, setup 76ms, collect 12.31s, tests 201.47s, environment 677ms, prepare 431ms)

 % Coverage report from v8
------------------------------------------------------------------------|---------|----------|---------|---------|--------------------
File                                                                    | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s  
------------------------------------------------------------------------|---------|----------|---------|---------|--------------------
All files                                                               |    26.9 |    68.85 |   42.69 |    26.9 |                    
 tabnews.com.br                                                         |       0 |        0 |       0 |       0 |                    
  commitlint.config.js                                                  |       0 |        0 |       0 |       0 | 1-3                
  lint-staged.config.js                                                 |       0 |        0 |       0 |       0 | 1-3                
  middleware.public.js                                                  |       0 |        0 |       0 |       0 | 1-76               
  next.config.js                                                        |       0 |        0 |       0 |       0 | 1-121              
 tabnews.com.br/errors                                                  |   52.28 |     37.5 |      30 |   52.28 |                    
  index.js                                                              |   52.28 |     37.5 |      30 |   52.28 | ...138-146,151-161 
...
```

Por isso, estou fechando o issue como resolvido. De toda forma, obrigado pela sugest√£o, @matheusdealcantara. O issue deve facilitar a busca caso outras pessoas tenham a mesma d√∫vida/ideia ü§ù
</issue_1908_`@vitest/coverage-v8` para an√°lise de cobertura de testes>

<issue_1911_E-mail de recupera√ß√£o de senha n√£o chega>
### Descri√ß√£o

Ap√≥s clicar em esquecer a senha, o e-mail de recupera√ß√£o n√£o est√° sendo recebido. O cadastro deve ter sido realizado com sucesso, pois ao tentar cadastrar novamente com o mesmo e-mail, para testar, diz que o username informado j√° est√° cadastrado.

### Passos para reproduzir o problema

1. Clicar em login na p√°gina principal
2. Clicar no link "Esqueceu a senha?"
3. Digitar o e-mail cadastrado na plataforma.
4. Clicar em "Recuperar".

### Navegadores testados

Microsoft Edge e Firefox

### Poss√≠vel solu√ß√£o

_No response_

>> Coment√°rio de aprendendofelipe:
> O cadastro deve ter sido realizado com sucesso, pois ao tentar cadastrar novamente com o mesmo e-mail, para testar, diz que o username informado j√° est√° cadastrado.

Para preservar a privacidade dos usu√°rios, o sistema n√£o informa se um `email` j√° est√° cadastrado, apenas se o `username` est√°, pois √© um dado p√∫blico. Suponho que esteja falando do `fantinel`.

Verifiquei aqui que o email de ativa√ß√£o foi enviado para o endere√ßo utilizado no cadastro, e que ele foi recebido, j√° que a conta foi ativada. S√≥ que, pelo endere√ßo, parece que voc√™ pode ter usado um alias diferente do que queria.

O processo de recupera√ß√£o de senha s√≥ funciona com o endere√ßo exato usado no cadastro. Se voc√™ tentar com um alias diferente, o sistema n√£o vai localizar a conta e n√£o vai enviar nenhum email (e n√£o deve mesmo). At√© o momento, n√£o houve nenhuma solicita√ß√£o de recupera√ß√£o com o email correto.

Estou solicitando uma recupera√ß√£o com o endere√ßo correto por aqui. Voc√™ vai receber no mesmo endere√ßo que recebeu o email de ativa√ß√£o da conta. üëç

Lembre-se de que o login tamb√©m precisa ser feito com o mesmo alias utilizado no cadastro. Quando estiver logado, se quiser, √© poss√≠vel alterar o endere√ßo em "Editar perfil". üòâ

Como n√£o se trata de um bug, estou encerrando a issue. Caso ainda tenha dificuldades, √© s√≥ entrar em contato pelo `contato@tabnews.com.br`. ü§ù
</issue_1911_E-mail de recupera√ß√£o de senha n√£o chega>

<issue_1919_Valida√ß√£o em tempo real de senha na tela de recupera√ß√£o de senha>
### Descri√ß√£o

Eu acho que a p√°gina de recupera√ß√£o de senha ficaria melhor com valida√ß√£o em tempo real das senhas, porque tive dificuldade em identificar rapidamente quando as senhas digitadas n√£o estavam iguais antes de enviar o formul√°rio. Isso evitaria frustra√ß√£o e retrabalho ao usu√°rio, tornando o fluxo mais intuitivo e √°gil.

### Sugest√£o de implementa√ß√£o

Poder√≠amos utilizar useState e useEffect para validar em tempo real se as senhas conferem e exibir uma mensagem (Flash) quando n√£o conferirem, antes de submeter o formul√°rio. Isso aumentaria a usabilidade sem alterar o fluxo do backend.

**Segue exemplo funcional que implementei em um fork e pretendo abrir PR:**

```
jsx
Copy
Edit
// Hook de valida√ß√£o em tempo real:
useEffect(() => {
  if (password !== confirmPassword && (password.length > 0 || confirmPassword.length > 0)) {
    setPasswordMismatchError(true);
  } else {
    setPasswordMismatchError(false);
  }
}, [password, confirmPassword]);
```

Assim, o usu√°rio recebe feedback imediato e evita erro no envio, melhorando a experi√™ncia geral na p√°gina de recupera√ß√£o de senha.
</issue_1919_Valida√ß√£o em tempo real de senha na tela de recupera√ß√£o de senha>

<issue_1925_Implementa√ß√£o da Funcionalidade de Favoritar Postagens>
### Descri√ß√£o

## üìã Descri√ß√£o

Implementa√ß√£o completa da funcionalidade de favoritar postagens no projeto TabNews, permitindo que usu√°rios autenticados marquem postagens como favoritas e gerenciem essas marca√ß√µes.

## üéØ Objetivos

- [x] Criar tabela `favorites` no banco de dados
- [x] Implementar modelo de dados com valida√ß√µes
- [x] Desenvolver endpoints REST para gerenciar favoritos
- [x] Implementar testes unit√°rios seguindo TDD
- [x] Documentar funcionalidade completa

## üîß Funcionalidades Implementadas

### Backend
- **POST** `/api/v1/favorites` - Favoritar uma postagem
- **DELETE** `/api/v1/favorites/[contentId]` - Desfavoritar uma postagem  
- **GET** `/api/v1/user/favorites` - Listar favoritos do usu√°rio

### Banco de Dados
- Tabela `favorites` com relacionamentos para `users` e `contents`
- √çndices otimizados para performance
- Constraints de unicidade e cascade delete

### Modelo de Dados
- Valida√ß√£o de entrada com mensagens claras
- Fun√ß√µes para criar, remover, buscar e contar favoritos
- Suporte a pagina√ß√£o

## üß™ Testes

- ‚úÖ **12 testes unit√°rios** implementados e passando
- ‚úÖ Cobertura completa das fun√ß√µes do modelo
- ‚ùå Testes de integra√ß√£o removidos devido a conflitos com Next.js

## üìä Estrutura T√©cnica

```
models/favorites/index.js                    # Modelo principal
tests/unit/models/favorites.test.js         # Testes unit√°rios
pages/api/v1/favorites/                     # Endpoints REST
infra/migrations/                           # Migration do banco
```

## üîí Seguran√ßa e Valida√ß√µes

- Autentica√ß√£o obrigat√≥ria em todos os endpoints
- Valida√ß√£o de exist√™ncia de conte√∫do
- Preven√ß√£o de favoritos duplicados
- Tratamento de erros com c√≥digos HTTP apropriados

## üìà M√©tricas de Qualidade

- **Cobertura de Testes**: 100% das fun√ß√µes do modelo
- **Performance**: √çndices otimizados no banco
- **Seguran√ßa**: Valida√ß√£o de entrada e autentica√ß√£o
- **Manutenibilidade**: C√≥digo bem estruturado

## üöÄ Pr√≥ximos Passos

1. **Interface do Usu√°rio**: Bot√µes de favoritar/desfavoritar
2. **Contadores**: Mostrar n√∫mero de favoritos nas postagens
3. **Notifica√ß√µes**: Alertar autores quando postagens s√£o favoritadas
4. **Filtros**: Busca e filtros na lista de favoritos

## üìù Documenta√ß√£o

- Relat√≥rio completo em `RELATORIO_FAVORITOS.md`
- Exemplos de uso via cURL
- Estrutura do banco de dados
- Padr√µes arquiteturais utilizados

## üè∑Ô∏è Labels

- `feature`
- `backend`
- `api`
- `database`
- `tdd`
- `testing`

## üìÖ Status

**Conclu√≠do** ‚úÖ

---

**Tempo Estimado**: 8 horas  
**Tempo Real**: 6 horas  
**Metodologia**: TDD (Test-Driven Development)  
**Tecnologias**: Node.js, Next.js, PostgreSQL, Vitest

### Sugest√£o de implementa√ß√£o

_No response_
</issue_1925_Implementa√ß√£o da Funcionalidade de Favoritar Postagens>